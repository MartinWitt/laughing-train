# bookkeeper 
 
# Bad smells
I found 4734 bad smells with 351 repairable:
| ruleID | number | fixable |
| --- | --- | --- |
| PublicFieldAccessedInSynchronizedContext | 662 | false |
| RedundantFieldInitialization | 490 | false |
| BoundedWildcard | 292 | false |
| SystemOutErr | 248 | false |
| SynchronizeOnThis | 235 | false |
| StaticCallOnSubclass | 218 | false |
| ReturnNull | 212 | false |
| UnnecessaryFullyQualifiedName | 134 | false |
| FieldAccessedSynchronizedAndUnsynchronized | 131 | false |
| UnstableTypeUsedInSignature | 131 | false |
| UnstableApiUsage | 122 | false |
| UnusedAssignment | 112 | false |
| AssignmentToMethodParameter | 103 | false |
| Convert2MethodRef | 103 | false |
| ConstantValue | 98 | false |
| UtilityClassWithoutPrivateConstructor | 90 | true |
| OptionalUsedAsFieldOrParameterType | 76 | false |
| Convert2Lambda | 74 | false |
| SizeReplaceableByIsEmpty | 68 | true |
| UnnecessaryQualifierForThis | 62 | false |
| DataFlowIssue | 60 | false |
| NestedAssignment | 48 | false |
| DuplicateThrows | 44 | false |
| CodeBlock2Expr | 44 | true |
| ZeroLengthArrayInitialization | 44 | false |
| UnnecessaryReturn | 41 | true |
| SynchronizationOnLocalVariableOrMethodParameter | 35 | false |
| UnnecessaryLocalVariable | 33 | true |
| DeprecatedIsStillUsed | 33 | false |
| RedundantSuppression | 25 | false |
| StringBufferReplaceableByString | 23 | false |
| EmptyMethod | 23 | false |
| InstanceofCatchParameter | 22 | false |
| FinalStaticMethod | 19 | false |
| IfStatementWithIdenticalBranches | 19 | false |
| WrapperTypeMayBePrimitive | 18 | false |
| NonStrictComparisonCanBeEquality | 18 | true |
| UnnecessarySuperQualifier | 18 | false |
| UnnecessaryContinue | 18 | false |
| ReplaceAssignmentWithOperatorAssignment | 17 | false |
| NonProtectedConstructorInAbstractClass | 17 | true |
| BusyWait | 16 | false |
| PointlessArithmeticExpression | 15 | false |
| DynamicRegexReplaceableByCompiledPattern | 15 | false |
| DefaultAnnotationParam | 15 | false |
| AnonymousHasLambdaAlternative | 14 | false |
| RedundantImplements | 14 | false |
| SimplifyStreamApiCallChains | 13 | false |
| MissingDeprecatedAnnotation | 13 | false |
| UnnecessaryStringEscape | 12 | true |
| IOResource | 11 | false |
| ToArrayCallWithZeroLengthArrayArgument | 10 | true |
| IgnoreResultOfCall | 10 | false |
| RedundantMethodOverride | 10 | false |
| IntegerMultiplicationImplicitCastToLong | 10 | false |
| Anonymous2MethodRef | 10 | false |
| InfiniteLoopStatement | 9 | false |
| OptionalIsPresent | 9 | false |
| PointlessBitwiseExpression | 8 | false |
| StaticPseudoFunctionalStyleMethod | 8 | false |
| ArrayEquality | 8 | false |
| ThrowablePrintStackTrace | 8 | false |
| UnnecessaryModifier | 7 | true |
| ClassNameSameAsAncestorName | 7 | false |
| NonSynchronizedMethodOverridesSynchronizedMethod | 7 | false |
| CharsetObjectCanBeUsed | 7 | false |
| DuplicateBranchesInSwitch | 7 | false |
| ManualMinMaxCalculation | 7 | false |
| ObjectNotify | 6 | false |
| MismatchedCollectionQueryUpdate | 6 | false |
| UseCompareMethod | 6 | false |
| RedundantArrayCreation | 6 | true |
| AbstractClassNeverImplemented | 6 | false |
| SynchronizeOnNonFinalField | 6 | false |
| ConditionCoveredByFurtherCondition | 6 | false |
| StringEquality | 5 | false |
| InnerClassMayBeStatic | 5 | true |
| StringEqualsEmptyString | 5 | false |
| AccessStaticViaInstance | 4 | false |
| IndexOfReplaceableByContains | 4 | false |
| ManualArrayToCollectionCopy | 4 | false |
| OptionalContainsCollection | 4 | false |
| WhileLoopSpinsOnField | 4 | false |
| StringConcatenationInsideStringBufferAppend | 4 | false |
| RedundantLengthCheck | 4 | false |
| MismatchedJavadocCode | 4 | false |
| MismatchedArrayReadWrite | 3 | false |
| WhileCanBeForeach | 3 | false |
| NullableProblems | 3 | false |
| EqualsAndHashcode | 3 | false |
| UnnecessaryInitCause | 3 | false |
| UseBulkOperation | 3 | false |
| NonShortCircuitBoolean | 3 | false |
| NegativeIntConstantInLongContext | 3 | false |
| RedundantStringFormatCall | 3 | false |
| RedundantOperationOnEmptyContainer | 3 | false |
| CatchMayIgnoreException | 3 | false |
| StaticInitializerReferencesSubClass | 2 | false |
| AssignmentToStaticFieldFromInstanceMethod | 2 | false |
| TrivialStringConcatenation | 2 | false |
| UNUSED_IMPORT | 2 | false |
| UnnecessarySemicolon | 2 | false |
| ImplicitArrayToString | 2 | false |
| ComparatorMethodParameterNotUsed | 2 | false |
| ObsoleteCollection | 2 | false |
| OctalLiteral | 2 | false |
| DuplicateExpressions | 2 | false |
| MissortedModifiers | 2 | false |
| SlowListContainsAll | 2 | false |
| OptionalGetWithoutIsPresent | 2 | false |
| NestedSynchronizedStatement | 2 | false |
| Java8MapApi | 2 | false |
| Finalize | 1 | false |
| EmptyStatementBody | 1 | false |
| CommentedOutCode | 1 | false |
| ExplicitArrayFilling | 1 | false |
| UnnecessaryUnboxing | 1 | false |
| SimplifiableBooleanExpression | 1 | false |
| DoubleNegation | 1 | false |
| StringOperationCanBeSimplified | 1 | false |
| MethodOverloadsParentMethod | 1 | false |
| SuspiciousToArrayCall | 1 | false |
| CaughtExceptionImmediatelyRethrown | 1 | false |
| RedundantFileCreation | 1 | false |
| EnumSwitchStatementWhichMissesCases | 1 | false |
| ConditionalBreakInInfiniteLoop | 1 | false |
| JavaLangInvokeHandleSignature | 1 | false |
| MalformedFormatString | 1 | false |
| NonFinalFieldOfException | 1 | false |
| Java8MapForEach | 1 | false |
| AbstractMethodCallInConstructor | 1 | false |
| NonSerializableFieldInSerializableClass | 1 | false |
| AssignmentToForLoopParameter | 1 | false |
| ThreadStartInConstruction | 1 | false |
## RuleId[id=ToArrayCallWithZeroLengthArrayArgument]
### ToArrayCallWithZeroLengthArrayArgument
Call to `toArray()` with pre-sized array argument 'new Op\[successOps.size()\]'
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/metadata/stream/MetaRangeImpl.java`
#### Snippet
```java
            // create stream only when stream doesn't exists
            .If(store.newCompareValue(CompareResult.EQUAL, streamMetadataKey, null))
            .Then(successOps.toArray(new Op[successOps.size()]))
            .build();

```

### ToArrayCallWithZeroLengthArrayArgument
Call to `toArray()` with pre-sized array argument 'new String\[cmdList.size()\]'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/ScriptBasedMapping.java`
#### Snippet
```java
                    dir = new File(userDir);
                }
                ShellCommandExecutor s = new ShellCommandExecutor(cmdList.toArray(new String[cmdList.size()]), dir);
                try {
                    s.execute();
```

### ToArrayCallWithZeroLengthArrayArgument
Call to `toArray()` with pre-sized array argument 'new String\[hosts.size()\]'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/DNS.java`
#### Snippet
```java
            return new String[]{cachedHostname};
        } else {
            return hosts.toArray(new String[hosts.size()]);
        }
    }
```

### ToArrayCallWithZeroLengthArrayArgument
Call to `toArray()` with pre-sized array argument 'new String\[roles.size()\]'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/CertUtils.java`
#### Snippet
```java
                    roles.add(role.trim());
                }
                return roles.toArray(new String[roles.size()]);
            }
        }
```

### ToArrayCallWithZeroLengthArrayArgument
Call to `toArray()` with pre-sized array argument 'new String\[etcdEndpoints.size()\]'
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdMetadataDriverBase.java`
#### Snippet
```java
        synchronized (this) {
            this.client = Client.builder()
                .endpoints(etcdEndpoints.toArray(new String[etcdEndpoints.size()]))
                .build();
        }
```

### ToArrayCallWithZeroLengthArrayArgument
Call to `toArray()` with pre-sized array argument 'new LedgerHandle\[openLedgerHandles.size()\]'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/logsegment/BKLogSegmentEntryReader.java`
#### Snippet
```java
            }
            closeFuture = closePromise = new CompletableFuture<Void>();
            lhsToClose = openLedgerHandles.toArray(new LedgerHandle[openLedgerHandles.size()]);
            // set the exception to cancel pending and subsequent reads
            exception = new ReadCancelledException(getSegment().getZNodeName(), "Reader was closed");
```

### ToArrayCallWithZeroLengthArrayArgument
Call to `toArray()` with pre-sized array argument 'new AsyncLogReader\[readers.size()\]'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKDistributedLogManager.java`
#### Snippet
```java
        @Override
        public CompletableFuture<Void> asyncClose() {
            return Utils.closeSequence(executorService, true, readers.toArray(new AsyncLogReader[readers.size()]))
                    .thenApply(value -> {
                        readers.clear();
```

### ToArrayCallWithZeroLengthArrayArgument
Call to `toArray()` with pre-sized array argument 'new FileStatus\[statusList.size()\]'
in `stream/distributedlog/io/dlfs/src/main/java/org/apache/distributedlog/fs/DLFileSystem.java`
#### Snippet
```java
            }
            Collections.sort(statusList, Comparator.comparing(fileStatus -> fileStatus.getPath().getName()));
            return statusList.toArray(new FileStatus[statusList.size()]);
        } catch (LogNotFoundException e) {
            throw new FileNotFoundException(path.toString());
```

### ToArrayCallWithZeroLengthArrayArgument
Call to `toArray()` with pre-sized array argument 'new String\[serviceHosts.size()\]'
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/net/ServiceURI.java`
#### Snippet
```java
            serviceInfos,
            serviceUser,
            serviceHosts.toArray(new String[serviceHosts.size()]),
            servicePath,
            uri);
```

### ToArrayCallWithZeroLengthArrayArgument
Call to `toArray()` with pre-sized array argument 'new CompletableFuture\[futureList.size()\]'
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/concurrent/FutureUtils.java`
#### Snippet
```java
    public static <T> CompletableFuture<List<T>> collect(List<CompletableFuture<T>> futureList) {
        CompletableFuture<Void> finalFuture =
            CompletableFuture.allOf(futureList.toArray(new CompletableFuture[futureList.size()]));
        return finalFuture.thenApply(result ->
            futureList
```

## RuleId[id=Finalize]
### Finalize
'finalize()' should not be overridden
in `circe-checksum/src/main/java/com/scurrilous/circe/crc/Sse42Crc32C.java`
#### Snippet
```java

    @Override
    protected void finalize() {
        if (config != 0)
            freeConfig(config);
```

## RuleId[id=WrapperTypeMayBePrimitive]
### WrapperTypeMayBePrimitive
Type may be primitive
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/LedgerMetadataSerDe.java`
#### Snippet
```java

                if (parts[1].equals(V1_CLOSED_TAG)) {
                    Long l = Long.parseLong(parts[0]);
                    if (l == V1_IN_RECOVERY_ENTRY_ID) {
                        builder.withInRecoveryState();
```

### WrapperTypeMayBePrimitive
Type may be primitive
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/LongZkLedgerIdGenerator.java`
#### Snippet
```java
                    // Lower bits are full. Need to expand and create another HOB node.
                    try {
                        Long newHighBits = highBits + 1;
                        createHOBPathAndGenerateId(ledgerPrefix, newHighBits.intValue(), cb);
                    } catch (KeeperException e) {
```

### WrapperTypeMayBePrimitive
Type may be primitive
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookies/RecoverCommand.java`
#### Snippet
```java
        boolean skipUnrecoverableLedgers = flags.skipUnrecoverableLedgers;

        Long ledgerId = flags.ledger;
        int replicateRate = flags.replicateRate;

```

### WrapperTypeMayBePrimitive
Type may be primitive
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieShell.java`
#### Snippet
```java
            boolean skipUnrecoverableLedgers = cmdLine.hasOption("sku");

            Long ledgerId = getOptionLedgerIdValue(cmdLine, "ledger", -1);
            int replicationRate = getOptionIntValue(cmdLine, "replicationRate", -1);

```

### WrapperTypeMayBePrimitive
Type may be primitive
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/WeightedRandomSelectionImpl.java`
#### Snippet
```java
        // get the sum total of all the values; this will be used to
        // calculate the weighted probability later on
        Long totalWeight = 0L, min = Long.MAX_VALUE;
        List<WeightedObject> values = new ArrayList<WeightedObject>(map.values());
        Collections.sort(values, new Comparator<WeightedObject>() {
```

### WrapperTypeMayBePrimitive
Type may be primitive
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/Main.java`
#### Snippet
```java
                String sPort = cmdLine.getOptionValue("httpport");
                log.info("Get cmdline http port: {}", sPort);
                Integer iPort = Integer.parseInt(sPort);
                conf.setHttpServerPort(iPort.intValue());
            }
```

### WrapperTypeMayBePrimitive
Type may be primitive
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/http/service/TriggerGCService.java`
#### Snippet
```java
            return response;
        } else if (HttpServer.Method.GET == request.getMethod()) {
            Boolean isInForceGC = bookieServer.getBookie().getLedgerStorage().isInForceGC();
            Pair<String, String> output = Pair.of("is_in_force_gc", isInForceGC.toString());
            String jsonResponse = JsonUtil.toJson(output);
```

### WrapperTypeMayBePrimitive
Type may be primitive
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/http/service/ReadLedgerEntryService.java`
#### Snippet
```java

        if (HttpServer.Method.GET == request.getMethod() && (params != null) && params.containsKey("ledger_id")) {
            Long ledgerId = Long.parseLong(params.get("ledger_id"));
            Long startEntryId = 0L;
            Long endEntryId = -1L;
```

### WrapperTypeMayBePrimitive
Type may be primitive
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/http/service/ReadLedgerEntryService.java`
#### Snippet
```java
        if (HttpServer.Method.GET == request.getMethod() && (params != null) && params.containsKey("ledger_id")) {
            Long ledgerId = Long.parseLong(params.get("ledger_id"));
            Long startEntryId = 0L;
            Long endEntryId = -1L;
            if (params.containsKey("start_entry_id")) {
```

### WrapperTypeMayBePrimitive
Type may be primitive
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/http/service/ReadLedgerEntryService.java`
#### Snippet
```java
            Long ledgerId = Long.parseLong(params.get("ledger_id"));
            Long startEntryId = 0L;
            Long endEntryId = -1L;
            if (params.containsKey("start_entry_id")) {
                startEntryId = Long.parseLong(params.get("start_entry_id"));
```

### WrapperTypeMayBePrimitive
Type may be primitive
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/http/service/ReadLedgerEntryService.java`
#### Snippet
```java

            // Page index should start from 1;
            Integer pageIndex = params.containsKey("page") ? Integer.parseInt(params.get("page")) : -1;
            if (pageIndex > 0) {
                // start and end ledger index for wanted page.
```

### WrapperTypeMayBePrimitive
Type may be primitive
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/http/service/ReadLedgerEntryService.java`
#### Snippet
```java
                // start and end ledger index for wanted page.
                Long startIndexInPage = (pageIndex - 1) * ENTRIES_PER_PAE;
                Long endIndexInPage = startIndexInPage + ENTRIES_PER_PAE - 1;

                if ((startEntryId == 0L) || (startEntryId < startIndexInPage)) {
```

### WrapperTypeMayBePrimitive
Type may be primitive
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/http/service/GetLedgerMetaService.java`
#### Snippet
```java

        if (HttpServer.Method.GET == request.getMethod() && (params != null) && params.containsKey("ledger_id")) {
            Long ledgerId = Long.parseLong(params.get("ledger_id"));

            LedgerManager manager = ledgerManagerFactory.newLedgerManager();
```

### WrapperTypeMayBePrimitive
Type may be primitive
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/http/service/DeleteLedgerService.java`
#### Snippet
```java
                clientConf.addConfiguration(conf);
                BookKeeper bk = new BookKeeper(clientConf);
                Long ledgerId = Long.parseLong(params.get("ledger_id"));

                bk.deleteLedger(ledgerId);
```

### WrapperTypeMayBePrimitive
Type may be primitive
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/http/service/ListBookieInfoService.java`
#### Snippet
```java
             */
            LinkedHashMap<String, String> output = Maps.newLinkedHashMapWithExpectedSize(map.size());
            Long totalFree = 0L, total = 0L;
            for (Map.Entry<BookieId, BookieInfoReader.BookieInfo> infoEntry : map.entrySet()) {
                BookieInfoReader.BookieInfo bInfo = infoEntry.getValue();
```

### WrapperTypeMayBePrimitive
Type may be primitive
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerFragmentReplicator.java`
#### Snippet
```java
            return;
        }
        Long startEntryId = lf.getFirstStoredEntryId();
        Long endEntryId = lf.getLastStoredEntryId();

```

### WrapperTypeMayBePrimitive
Type may be primitive
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerFragmentReplicator.java`
#### Snippet
```java
        }
        Long startEntryId = lf.getFirstStoredEntryId();
        Long endEntryId = lf.getLastStoredEntryId();

        /*
```

### WrapperTypeMayBePrimitive
Type may be primitive
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RackawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
            BookieId address = ensemble.get(idx);
            String region = writeSetWithRegion.get(idx);
            Long lastFailedEntryOnBookie = bookiesHealthInfo.getBookieFailureHistory(address);
            if (null == knownBookies.get(address)) {
                // there isn't too much differences between readonly bookies
```

## RuleId[id=UnnecessaryModifier]
### UnnecessaryModifier
Modifier `public` is redundant for interface members
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/KeyValueStorage.java`
#### Snippet
```java
     * Interface for a batch to be written in the storage.
     */
    public interface Batch extends Closeable {
        void put(byte[] key, byte[] value) throws IOException;

```

### UnnecessaryModifier
Modifier `private` is redundant for enum constructors
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/EnsemblePlacementPolicy.java`
#### Snippet
```java
        private int numVal;

        private PlacementPolicyAdherence(int numVal) {
            this.numVal = numVal;
        }
```

### UnnecessaryModifier
Modifier `private` is redundant for enum constructors
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/metastore/MSException.java`
#### Snippet
```java
        private final String description;

        private Code(int code, String description) {
            this.code = code;
            this.description = description;
```

### UnnecessaryModifier
Modifier `private` is redundant for enum constructors
in `circe-checksum/src/main/java/com/scurrilous/circe/HashSupport.java`
#### Snippet
```java
    private final int priority;

    private HashSupport(int priority) {
        this.priority = priority;
    }
```

### UnnecessaryModifier
Modifier `private` is redundant for enum constructors
in `circe-checksum/src/main/java/com/scurrilous/circe/params/MurmurHash3Variant.java`
#### Snippet
```java
    private final String algorithm;

    private MurmurHash3Variant(String algorithm) {
        this.algorithm = algorithm;
    }
```

### UnnecessaryModifier
Modifier `private` is redundant for enum constructors
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java
        private final int value;

        private TruncationStatus(int value) {
            this.value = value;
        }
```

### UnnecessaryModifier
Modifier `private` is redundant for enum constructors
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java
        public final int value;

        private LogSegmentMetadataVersion(int value) {
            this.value = value;
        }
```

## RuleId[id=MismatchedArrayReadWrite]
### MismatchedArrayReadWrite
Contents of array `reverseSortedItems` are written to, but never read
in `microbenchmarks/src/main/java/org/apache/bookkeeper/bookie/GroupSortBenchmark.java`
#### Snippet
```java
        private final long[] randomItems = new long[N * 4];
        private final long[] sortedItems;
        private final long[] reverseSortedItems = new long[N * 4];
        private final long[] groupSortedItems;
        private final long[] reverseGroupSortedItems = new long[N * 4];
```

### MismatchedArrayReadWrite
Contents of array `tmpArray` are read, but never written to
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/AvailabilityOfEntriesOfLedger.java`
#### Snippet
```java
    public static final AvailabilityOfEntriesOfLedger EMPTY_AVAILABILITYOFENTRIESOFLEDGER;
    static {
        long[] tmpArray = {};
        EMPTY_AVAILABILITYOFENTRIESOFLEDGER = new AvailabilityOfEntriesOfLedger(Arrays.stream(tmpArray).iterator());
    }
```

### MismatchedArrayReadWrite
Contents of array `hardLinkMultSuffix` are written to, but never read
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/HardLink.java`
#### Snippet
```java
    private static String[] hardLinkCommand = {"ln", null, null};
    private static String[] hardLinkMultPrefix = {"ln"};
    private static String[] hardLinkMultSuffix = {null};
    private static String[] getLinkCountCommand = {"stat", "-c%h", null};
    //Unix guarantees at least 32K bytes cmd length.
```

## RuleId[id=PointlessArithmeticExpression]
### PointlessArithmeticExpression
`(long) 1.2 * getEntryLogSizeLimit()` can be replaced with 'getEntryLogSizeLimit()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/ServerConfiguration.java`
#### Snippet
```java
     */
    public long getMinUsableSizeForEntryLogCreation() {
        return this.getLong(MIN_USABLESIZE_FOR_ENTRYLOG_CREATION, (long) 1.2 * getEntryLogSizeLimit());
    }

```

### PointlessArithmeticExpression
`1 * 1024 * 1024` can be replaced with '1024 \* 1024'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/ServerConfiguration.java`
#### Snippet
```java
     */
    public int getRecvByteBufAllocatorSizeMax() {
        return getInt(BYTEBUF_ALLOCATOR_SIZE_MAX, 1 * 1024 * 1024);
    }

```

### PointlessArithmeticExpression
`1 * 60 * 1000L` can be replaced with '60 \* 1000L'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/sasl/TGTRefreshThread.java`
#### Snippet
```java
    // thread will not sleep between refresh attempts any less than 1 minute (60*1000 milliseconds = 1 minute).
    // Change the '1' to e.g. 5, to change this to 5 minutes.
    private static final long MIN_TIME_BEFORE_RELOGIN = 1 * 60 * 1000L;

    private long getRefreshTime(KerberosTicket tgt) {
```

### PointlessArithmeticExpression
`1 * 1024 * 1024 * 1024` can be replaced with '1024 \* 1024 \* 1024'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/BookKeeperConstants.java`
#### Snippet
```java
     * memtable (for performance consideration)
     */
    public static final long MAX_LOG_SIZE_LIMIT = 1 * 1024 * 1024 * 1024;

    public static final String FEATURE_REPP_DISABLE_DURABILITY_ENFORCEMENT = "repp_disable_durability_enforcement";
```

### PointlessArithmeticExpression
`1 * 1024 * 1024` can be replaced with '1024 \* 1024'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/ClientConfiguration.java`
#### Snippet
```java
     */
    public int getClientReceiveBufferSize() {
        return getInt(CLIENT_RECEIVEBUFFER_SIZE, 1 * 1024 * 1024);
    }

```

### PointlessArithmeticExpression
`1 * 1024 * 1024` can be replaced with '1024 \* 1024'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/ClientConfiguration.java`
#### Snippet
```java
     */
    public int getClientSendBufferSize() {
        return getInt(CLIENT_SENDBUFFER_SIZE, 1 * 1024 * 1024);
    }

```

### PointlessArithmeticExpression
`1 * 9` can be replaced with '9'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BKStats.java`
#### Snippet
```java
                bucket = (int) (latency / 10);
            } else if (latency <= 1000) { // 100ms ~ 1000ms
                bucket = 1 * 9 + (int) (latency / 100);
            } else if (latency <= 10000) { // 1s ~ 10s
                bucket = 2 * 9 + (int) (latency / 1000);
```

### PointlessArithmeticExpression
`entry.readerIndex() + 0` can be replaced with 'entry.readerIndex()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/InterleavedLedgerStorage.java`
#### Snippet
```java
    @Override
    public long addEntry(ByteBuf entry) throws IOException {
        long ledgerId = entry.getLong(entry.readerIndex() + 0);
        long entryId = entry.getLong(entry.readerIndex() + 8);
        long lac = entry.getLong(entry.readerIndex() + 16);
```

### PointlessArithmeticExpression
`entry.readerIndex() + 0` can be replaced with 'entry.readerIndex()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/SortedLedgerStorage.java`
#### Snippet
```java
    @Override
    public long addEntry(ByteBuf entry) throws IOException {
        long ledgerId = entry.getLong(entry.readerIndex() + 0);
        long entryId = entry.getLong(entry.readerIndex() + 8);
        long lac = entry.getLong(entry.readerIndex() + 16);
```

### PointlessArithmeticExpression
`entry.readerIndex() + 0` can be replaced with 'entry.readerIndex()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Journal.java`
#### Snippet
```java
    public void logAddEntry(ByteBuf entry, boolean ackBeforeSync, WriteCallback cb, Object ctx)
            throws InterruptedException {
        long ledgerId = entry.getLong(entry.readerIndex() + 0);
        long entryId = entry.getLong(entry.readerIndex() + 8);
        logAddEntry(ledgerId, entryId, entry, ackBeforeSync, cb, ctx);
```

### PointlessArithmeticExpression
`start + 0` can be replaced with 'start'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/IndexPersistenceMgr.java`
#### Snippet
```java
            long rc = 0;
            try {
                rc = fi.write(buffs, entries.get(start + 0).getFirstEntryPosition());
            } catch (FileInfo.FileInfoDeletedException e) {
                throw new Bookie.NoLedgerException(ledger);
```

### PointlessArithmeticExpression
`1 * 1024 * 1024 * 1024` can be replaced with '1024 \* 1024 \* 1024'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/WriteCache.java`
#### Snippet
```java
    public WriteCache(ByteBufAllocator allocator, long maxCacheSize) {
        // Default maxSegmentSize set to 1Gb
        this(allocator, maxCacheSize, 1 * 1024 * 1024 * 1024);
    }

```

### PointlessArithmeticExpression
`1 * 1024 * 1024 * 1024` can be replaced with '1024 \* 1024 \* 1024'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/ReadCache.java`
#### Snippet
```java
    private static final Logger log = LoggerFactory.getLogger(ReadCache.class);

    private static final int DEFAULT_MAX_SEGMENT_SIZE = 1 * 1024 * 1024 * 1024;

    private final List<ByteBuf> cacheSegments;
```

### PointlessArithmeticExpression
`offset + i8 + 0` can be replaced with 'offset + i8'
in `stream/common/src/main/java/org/apache/bookkeeper/common/hash/MurmurHash.java`
#### Snippet
```java
            int i8 = i << 3;

            long k64 = ((long) key.getByte(offset + i8 + 0) & 0xff)
                + (((long) key.getByte(offset + i8 + 1) & 0xff) << 8)
                + (((long) key.getByte(offset + i8 + 2) & 0xff) << 16)
```

### PointlessArithmeticExpression
`offset + i4 + 0` can be replaced with 'offset + i4'
in `stream/common/src/main/java/org/apache/bookkeeper/common/hash/MurmurHash.java`
#### Snippet
```java
            k = k | (data.getByte(offset + i4 + 1) & 0xff);
            k = k << 8;
            k = k | (data.getByte(offset + i4 + 0) & 0xff);
            k *= m;
            k ^= k >>> r;
```

## RuleId[id=EmptyStatementBody]
### EmptyStatementBody
`while` statement has empty body
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java

            /* see startRead and startWrite, they return false once no more IO can be started */
            while (startRead() || startWrite()) {}
            long toWait = testEnd - System.currentTimeMillis();

```

## RuleId[id=WhileCanBeForeach]
### WhileCanBeForeach
`while` loop can be replaced with enhanced 'for'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookie/ReadLedgerCommand.java`
#### Snippet
```java
                Iterator<LedgerEntry> entries = bk.readEntries(flags.ledgerId, flags.firstEntryId, lastEntry)
                                                  .iterator();
                while (entries.hasNext()) {
                    LedgerEntry entry = entries.next();
                    formatEntry(entry, flags.msg);
```

### WhileCanBeForeach
`while` loop can be replaced with enhanced 'for'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/http/service/ReadLedgerEntryService.java`
#### Snippet
```java

            Iterator<LedgerEntry> entries = bka.readEntries(ledgerId, startEntryId, endEntryId).iterator();
            while (entries.hasNext()) {
                LedgerEntry entry = entries.next();
                output.put(Long.valueOf(entry.getEntryId()).toString(), new String(entry.getEntry(), US_ASCII));
```

### WhileCanBeForeach
`while` loop can be replaced with enhanced 'for'
in `bookkeeper-http/vertx-http-server/src/main/java/org/apache/bookkeeper/http/vertx/VertxAbstractHandler.java`
#### Snippet
```java
        Map<String, String> map = new HashMap<>();
        Iterator<Map.Entry<String, String>> iterator = request.params().iterator();
        while (iterator.hasNext()) {
            Map.Entry<String, String> entry = iterator.next();
            map.put(entry.getKey(), entry.getValue());
```

## RuleId[id=StaticInitializerReferencesSubClass]
### StaticInitializerReferencesSubClass
Referencing subclass LongLedgerIdFormatter from superclass LedgerIdFormatter initializer might lead to class loading deadlock
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/LedgerIdFormatter.java`
#### Snippet
```java

    // Used by BKExtentIdByteArray
    public static final LedgerIdFormatter LONG_LEDGERID_FORMATTER = new LongLedgerIdFormatter();

    public static LedgerIdFormatter newLedgerIdFormatter(AbstractConfiguration<?> conf) {
```

### StaticInitializerReferencesSubClass
Referencing subclass StringEntryFormatter from superclass EntryFormatter initializer might lead to class loading deadlock
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/EntryFormatter.java`
#### Snippet
```java
     */
    public abstract void formatEntry(java.io.InputStream input);
    public static final EntryFormatter STRING_FORMATTER = new StringEntryFormatter();

    public static EntryFormatter newEntryFormatter(AbstractConfiguration<?> conf) {
```

## RuleId[id=CommentedOutCode]
### CommentedOutCode
Commented out code (3 lines)
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookieWatcherImpl.java`
#### Snippet
```java
        //    on its znode registration due zookeeper session expire.
        // e. if we want to permanently remove a bookkeeper client, we should watch on the cookies' list.
        // if (bk.getBookieClient() != null) {
        //     bk.getBookieClient().closeClients(deadBookies);
        // }
```

## RuleId[id=AssignmentToStaticFieldFromInstanceMethod]
### AssignmentToStaticFieldFromInstanceMethod
Assignment to static field `timers` from instance context
in `microbenchmarks/src/main/java/org/apache/bookkeeper/stats/codahale/TimerBenchmark.java`
#### Snippet
```java
                // concurrency of timer updates.
                if (timers == null) {
                    timers = new OpStatsLogger[timersPerThread];
                    for (int i = 0; i < timersPerThread; i++) {
                        timers[i] = logger.getOpStatsLogger("test-timer-" + i);
```

### AssignmentToStaticFieldFromInstanceMethod
Assignment to static field `times` from instance context
in `microbenchmarks/src/main/java/org/apache/bookkeeper/stats/codahale/TimerBenchmark.java`
#### Snippet
```java

                    // just a bunch of random response times to not always hit the same bucket
                    times = new long[1000];
                    for (int i = 0; i < times.length; i++) {
                        times[i] = Math.abs(ThreadLocalRandom.current().nextLong() % 1000);
```

## RuleId[id=ObjectNotify]
### ObjectNotify
`notify` should probably be replaced with 'notifyAll()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/SyncThread.java`
#### Snippet
```java
        synchronized (suspensionLock) {
            suspended = false;
            suspensionLock.notify();
        }
    }
```

### ObjectNotify
`notify` should probably be replaced with 'notifyAll()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/MSLedgerManagerFactory.java`
#### Snippet
```java
            finished = true;

            notify();
        }

```

### ObjectNotify
`notify` should probably be replaced with 'notifyAll()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/SyncCallbackUtils.java`
#### Snippet
```java
                lcCtx.setRC(rc);
                lcCtx.setLastConfirmed(lastConfirmed);
                lcCtx.notify();
            }
        }
```

### ObjectNotify
`notify` should probably be replaced with 'notifyAll()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeperAdmin.java`
#### Snippet
```java
                    sync.value = true;
                    resultHolder.set(result);
                    sync.notify();
                }
            }
```

### ObjectNotify
`notify` should probably be replaced with 'notifyAll()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeperAdmin.java`
#### Snippet
```java
                    syncObj.rc = rc;
                    syncObj.value = true;
                    syncObj.notify();
                }
            }
```

### ObjectNotify
`notify` should probably be replaced with 'notifyAll()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeperAdmin.java`
#### Snippet
```java
                syncObject.rc = rc;
                syncObject.value = true;
                syncObject.notify();
            }
        }, sync);
```

## RuleId[id=UnnecessaryQualifierForThis]
### UnnecessaryQualifierForThis
Qualifier `StorageContainerImpl` on 'this' is unnecessary in this context
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/sc/StorageContainerImpl.java`
#### Snippet
```java
                    .intercept(new RoutingHeaderProxyInterceptor())
                    .build();
                return FutureUtils.value(StorageContainerImpl.this);
            } catch (IOException e) {
                log.error("Failed to start the grpc server for storage container ({})", getId(), e);
```

### UnnecessaryQualifierForThis
Qualifier `AsyncSemaphore` on 'this' is unnecessary in this context
in `stream/distributedlog/common/src/main/java/org/apache/distributedlog/common/concurrent/AsyncSemaphore.java`
#### Snippet
```java
                CompletableFuture<Permit> future = FutureUtils.createFuture();
                future.whenComplete((value, cause) -> {
                    synchronized (AsyncSemaphore.this) {
                        waitq.remove(future);
                    }
```

### UnnecessaryQualifierForThis
Qualifier `MetaRangeImpl` on 'this' is unnecessary in this context
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/metadata/stream/MetaRangeImpl.java`
#### Snippet
```java
                    if (txnResult.isSuccess()) {
                        List<Result<byte[], byte[]>> results = txnResult.results();
                        MetaRangeImpl.this.revision = results.get(results.size() - 1).revision();

                        // mark the state to CREATED
```

### UnnecessaryQualifierForThis
Qualifier `MetaRangeImpl` on 'this' is unnecessary in this context
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/metadata/stream/MetaRangeImpl.java`
#### Snippet
```java
                } else {
                    loadMetadata(kvs);
                    return MetaRangeImpl.this;
                }
            }, executor);
```

### UnnecessaryQualifierForThis
Qualifier `PrometheusMetricsProvider` on 'this' is unnecessary in this context
in `stats/bookkeeper-stats-providers/prometheus-metrics-provider/src/main/java/org/apache/bookkeeper/stats/prometheus/PrometheusMetricsProvider.java`
#### Snippet
```java
    @Override
    public StatsLogger getStatsLogger(String scope) {
        return new PrometheusStatsLogger(PrometheusMetricsProvider.this, scope, Collections.emptyMap());
    }

```

### UnnecessaryQualifierForThis
Qualifier `LongPollReadEntryProcessorV3` on 'this' is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/LongPollReadEntryProcessorV3.java`
#### Snippet
```java
                            // When the timeout expires just get whatever is the current
                            // readLastConfirmed
                            LongPollReadEntryProcessorV3.this.scheduleDeferredRead(true);
                    }, readRequest.getTimeOut(), TimeUnit.MILLISECONDS);
                }
```

### UnnecessaryQualifierForThis
Qualifier `ListLedgersCommand` on 'this' is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookie/ListLedgersCommand.java`
#### Snippet
```java
                                     * different threads.
                                     */
                                    synchronized (ListLedgersCommand.this) {
                                        printLedgerMetadata(ledgerId, metadata.getValue(), flags.meta);
                                    }
```

### UnnecessaryQualifierForThis
Qualifier `PerChannelBookieClient` on 'this' is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
    void initTLSHandshake() {
        // create TLS handler
        PerChannelBookieClient parentObj = PerChannelBookieClient.this;
        SocketAddress socketAddress = channel.remoteAddress();
        InetSocketAddress address;
```

### UnnecessaryQualifierForThis
Qualifier `PerChannelBookieClient` on 'this' is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java

        for (GenericCallback<PerChannelBookieClient> pendingOp : oldPendingOps) {
            pendingOp.operationComplete(rc, PerChannelBookieClient.this);
        }
    }
```

### UnnecessaryQualifierForThis
Qualifier `BookieImpl` on 'this' is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieImpl.java`
#### Snippet
```java

        JournalAliveListener journalAliveListener =
                () -> BookieImpl.this.triggerBookieShutdown(ExitCode.BOOKIE_EXCEPTION);
        // instantiate the journals
        journals = Lists.newArrayList();
```

### UnnecessaryQualifierForThis
Qualifier `LedgerHandleAdv` on 'this' is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandleAdv.java`
#### Snippet
```java
                op.cb.addCompleteWithLatency(BookKeeper.getReturnRc(clientCtx.getBookieClient(),
                                                                    BKException.Code.InterruptedException),
                        LedgerHandleAdv.this, op.getEntryId(), 0, op.ctx);
                op.recyclePendAddOpObject();
            }
```

### UnnecessaryQualifierForThis
Qualifier `ReadOnlyLedgerHandle` on 'this' is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadOnlyLedgerHandle.java`
#### Snippet
```java
            .thenCompose((metadata) -> {
                    if (metadata.getValue().isClosed()) {
                        return CompletableFuture.completedFuture(ReadOnlyLedgerHandle.this);
                    } else {
                        return new LedgerRecoveryOp(ReadOnlyLedgerHandle.this, clientCtx)
```

### UnnecessaryQualifierForThis
Qualifier `ReadOnlyLedgerHandle` on 'this' is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadOnlyLedgerHandle.java`
#### Snippet
```java
                        return CompletableFuture.completedFuture(ReadOnlyLedgerHandle.this);
                    } else {
                        return new LedgerRecoveryOp(ReadOnlyLedgerHandle.this, clientCtx)
                            .setEntryListener(listener)
                            .initiate();
```

### UnnecessaryQualifierForThis
Qualifier `LedgerHandle` on 'this' is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
                              final AddCallbackWithLatency cb, final Object ctx) {
        LOG.error("To use this feature Ledger must be created with createLedgerAdv() interface.");
        cb.addCompleteWithLatency(BKException.Code.IllegalOpException, LedgerHandle.this, entryId, 0, ctx);
    }

```

### UnnecessaryQualifierForThis
Qualifier `LedgerHandle` on 'this' is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
                              final AddCallbackWithLatency cb, final Object ctx) {
        LOG.error("To use this feature Ledger must be created with createLedgerAdv() interface.");
        cb.addCompleteWithLatency(BKException.Code.IllegalOpException, LedgerHandle.this, entryId, 0, ctx);
    }

```

### UnnecessaryQualifierForThis
Qualifier `LedgerHandle` on 'this' is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
    public void asyncAddEntry(final long entryId, final byte[] data, final AddCallback cb, final Object ctx) {
        LOG.error("To use this feature Ledger must be created with createLedgerAdv() interface.");
        cb.addCompleteWithLatency(BKException.Code.IllegalOpException, LedgerHandle.this, entryId, 0, ctx);
    }

```

### UnnecessaryQualifierForThis
Qualifier `LedgerHandle` on 'this' is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
            final AddCallback cb, final Object ctx) {
        LOG.error("To use this feature Ledger must be created with createLedgerAdv() interface.");
        cb.addCompleteWithLatency(BKException.Code.IllegalOpException, LedgerHandle.this, entryId, 0, ctx);
    }

```

### UnnecessaryQualifierForThis
Qualifier `LedgerHandle` on 'this' is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
                    }, clientCtx.getMainWorkerPool().chooseThread(ledgerId));
        } else {
            cb.readComplete(Code.ClientClosedException, LedgerHandle.this, null, ctx);
        }
    }
```

### UnnecessaryQualifierForThis
Qualifier `LedgerHandle` on 'this' is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
                            cb.closeComplete(
                                    BKException.getExceptionCode(ex, BKException.Code.UnexpectedConditionException),
                                    LedgerHandle.this, ctx);
                        } else {
                            cb.closeComplete(BKException.Code.OK, LedgerHandle.this, ctx);
```

### UnnecessaryQualifierForThis
Qualifier `LedgerHandle` on 'this' is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
                                    LedgerHandle.this, ctx);
                        } else {
                            cb.closeComplete(BKException.Code.OK, LedgerHandle.this, ctx);
                        }
                    });
```

### UnnecessaryQualifierForThis
Qualifier `LedgerHandle` on 'this' is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
                    });

                    synchronized (LedgerHandle.this) {
                        prevHandleState = handleState;

```

### UnnecessaryQualifierForThis
Qualifier `LedgerHandle` on 'this' is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java

                        // taking the length must occur after draining, as draining changes the length
                        lastEntry = lastAddPushed = LedgerHandle.this.lastAddConfirmed;
                        finalLength = LedgerHandle.this.length;
                        handleState = HandleState.CLOSED;
```

### UnnecessaryQualifierForThis
Qualifier `LedgerHandle` on 'this' is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
                        // taking the length must occur after draining, as draining changes the length
                        lastEntry = lastAddPushed = LedgerHandle.this.lastAddConfirmed;
                        finalLength = LedgerHandle.this.length;
                        handleState = HandleState.CLOSED;
                    }
```

### UnnecessaryQualifierForThis
Qualifier `LedgerHandle` on 'this' is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
                        new MetadataUpdateLoop(
                                clientCtx.getLedgerManager(), getId(),
                                LedgerHandle.this::getVersionedLedgerMetadata,
                                (metadata) -> {
                                    if (metadata.isClosed()) {
```

### UnnecessaryQualifierForThis
Qualifier `LedgerHandle` on 'this' is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
                                            .withLength(finalLength).build();
                                },
                                LedgerHandle.this::setLedgerMetadata)
                                .run().whenComplete((metadata, ex) -> {
                                    if (ex != null) {
```

### UnnecessaryQualifierForThis
Qualifier `LedgerHandle` on 'this' is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
                op.cb.addCompleteWithLatency(BookKeeper.getReturnRc(clientCtx.getBookieClient(),
                                BKException.Code.InterruptedException),
                        LedgerHandle.this, INVALID_ENTRY_ID, 0, op.ctx);
                op.recyclePendAddOpObject();
            }
```

### UnnecessaryQualifierForThis
Qualifier `BookkeeperVerifier` on 'this' is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
            openingLedgers.add(ledger);
            driver.createLedger(newID, ensembleSize, writeQuorum, ackQuorum, (rc) -> {
                synchronized (BookkeeperVerifier.this) {
                    checkReturn(newID, rc);
                    System.out.format("Created new ledger %d%n", newID);
```

### UnnecessaryQualifierForThis
Qualifier `BookkeeperVerifier` on 'this' is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
                    openLedgers.add(ledger);
                    --outstandingWriteCount;
                    BookkeeperVerifier.this.notifyAll();
                }
            });
```

### UnnecessaryQualifierForThis
Qualifier `BookkeeperVerifier` on 'this' is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
                    System.out.format("Closing ledger %d%n", ledger.ledgerID);
                    driver.closeLedger(ledger.ledgerID, (Integer rc) -> {
                        synchronized (BookkeeperVerifier.this) {
                            ledger.setClosed();
                            System.out.format("Closed ledger %d%n", ledger.ledgerID);
```

### UnnecessaryQualifierForThis
Qualifier `BookkeeperVerifier` on 'this' is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
                                    System.out.format("Deleting ledger %d%n", ledgerID);
                                    driver.deleteLedger(ledgerID, (rc2) -> {
                                        synchronized (BookkeeperVerifier.this) {
                                            System.out.format("Deleted ledger %d%n", ledgerID);
                                            cb2.accept(rc2);
```

### UnnecessaryQualifierForThis
Qualifier `BookkeeperVerifier` on 'this' is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
        ledger.incReads();
        driver.readEntries(ledger.ledgerID, start, end, (rc, results) -> {
            synchronized (BookkeeperVerifier.this) {
                if (checkReturn(ledger.ledgerID, rc)) {
                    return;
```

### UnnecessaryQualifierForThis
Qualifier `BookkeeperVerifier` on 'this' is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
                }
                finalLedger.decReads((rc2) -> {
                    synchronized (BookkeeperVerifier.this) {
                        checkReturn(ledger.ledgerID, rc2);
                        System.out.format("Read %d -> %d from ledger %d releasing read%n", start, end, ledger.ledgerID);
```

### UnnecessaryQualifierForThis
Qualifier `BookkeeperVerifier` on 'this' is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
                        System.out.format("Read %d -> %d from ledger %d releasing read%n", start, end, ledger.ledgerID);
                        outstandingReadCount--;
                        BookkeeperVerifier.this.notifyAll();
                    }
                });
```

### UnnecessaryQualifierForThis
Qualifier `Auditor` on 'this' is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/Auditor.java`
#### Snippet
```java
            try {
                waitIfLedgerReplicationDisabled();
                int lostBookieRecoveryDelay = Auditor.this.ledgerUnderreplicationManager
                        .getLostBookieRecoveryDelay();
                List<String> availableBookies = getAvailableBookies();
```

### UnnecessaryQualifierForThis
Qualifier `Auditor` on 'this' is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/Auditor.java`
#### Snippet
```java
            }
            executor.submit(() -> {
                synchronized (Auditor.this) {
                    LOG.info("Shutting down Auditor's Executor");
                    executor.shutdown();
```

### UnnecessaryQualifierForThis
Qualifier `LostBookieRecoveryDelayChangedCb` on 'this' is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/Auditor.java`
#### Snippet
```java
            try {
                Auditor.this.ledgerUnderreplicationManager
                        .notifyLostBookieRecoveryDelayChanged(LostBookieRecoveryDelayChangedCb.this);
            } catch (ReplicationException.NonRecoverableReplicationException nre) {
                LOG.error("Non Recoverable Exception while reading from ZK", nre);
```

### UnnecessaryQualifierForThis
Qualifier `Auditor` on 'this' is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/Auditor.java`
#### Snippet
```java
            try {
                waitIfLedgerReplicationDisabled();
                lostBookieRecoveryDelay = Auditor.this.ledgerUnderreplicationManager
                        .getLostBookieRecoveryDelay();
                // if there is pending auditTask, cancel the task. So that it can be rescheduled
```

### UnnecessaryQualifierForThis
Qualifier `ZooKeeperClient` on 'super' is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/zookeeper/ZooKeeperClient.java`
#### Snippet
```java
        ZooKeeper zkHandle = zk.get();
        if (null == zkHandle) {
            return ZooKeeperClient.super.getState();
        } else {
            return zkHandle.getState();
```

### UnnecessaryQualifierForThis
Qualifier `ZooKeeperClient` on 'super' is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/zookeeper/ZooKeeperClient.java`
#### Snippet
```java
        ZooKeeper zkHandle = zk.get();
        if (null == zkHandle) {
            return ZooKeeperClient.super.toString();
        } else {
            return zkHandle.toString();
```

### UnnecessaryQualifierForThis
Qualifier `BookKeeper` on 'this' is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeper.java`
#### Snippet
```java
                return;
            }
            new LedgerOpenOp(BookKeeper.this, clientStats,
                             lId, digestType, passwd, cb, ctx).initiate();
        } finally {
```

### UnnecessaryQualifierForThis
Qualifier `BookKeeper` on 'this' is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeper.java`
#### Snippet
```java
                return;
            }
            new LedgerCreateOp(BookKeeper.this, ensSize, writeQuorumSize,
                               ackQuorumSize, digestType, passwd, cb, ctx,
                               customMetadata, WriteFlag.NONE, clientStats)
```

### UnnecessaryQualifierForThis
Qualifier `BookKeeper` on 'this' is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeper.java`
#### Snippet
```java
                return;
            }
            new LedgerCreateOp(BookKeeper.this, ensSize, writeQuorumSize,
                               ackQuorumSize, digestType, passwd, cb, ctx,
                               customMetadata, WriteFlag.NONE, clientStats)
```

### UnnecessaryQualifierForThis
Qualifier `BookKeeper` on 'this' is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeper.java`
#### Snippet
```java
                return;
            }
            new LedgerCreateOp(BookKeeper.this, ensSize, writeQuorumSize,
                               ackQuorumSize, digestType, passwd, cb, ctx,
                               customMetadata, WriteFlag.NONE, clientStats)
```

### UnnecessaryQualifierForThis
Qualifier `BookKeeper` on 'this' is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeper.java`
#### Snippet
```java
                return;
            }
            new LedgerOpenOp(BookKeeper.this, clientStats,
                             lId, digestType, passwd, cb, ctx).initiateWithoutRecovery();
        } finally {
```

### UnnecessaryQualifierForThis
Qualifier `BookKeeper` on 'this' is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeper.java`
#### Snippet
```java
                return;
            }
            new LedgerDeleteOp(BookKeeper.this, clientStats, lId, cb, ctx).initiate();
        } finally {
            closeLock.readLock().unlock();
```

### UnnecessaryQualifierForThis
Qualifier `KeyStream` on 'this' is unnecessary in this context
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/helpers/KeyStream.java`
#### Snippet
```java
            List<KeyValue> kvs = getResp.getKvs();
            ByteSequence lkey;
            synchronized (KeyStream.this) {
                hasMore = getResp.isMore();
                lkey = lastKey;
```

### UnnecessaryQualifierForThis
Qualifier `ValueStream` on 'this' is unnecessary in this context
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/helpers/ValueStream.java`
#### Snippet
```java
            .whenComplete((watcher, cause) -> {
                if (null != cause) {
                    synchronized (ValueStream.this) {
                        watchFuture = null;
                    }
```

### UnnecessaryQualifierForThis
Qualifier `KeySetReader` on 'this' is unnecessary in this context
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/helpers/KeySetReader.java`
#### Snippet
```java
        return watchFuture.whenComplete((watcher, cause) -> {
            if (null != cause) {
                synchronized (KeySetReader.this) {
                    watchFuture = null;
                }
```

### UnnecessaryQualifierForThis
Qualifier `BKSyncLogReader` on 'this' is unnecessary in this context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKSyncLogReader.java`
#### Snippet
```java
        readHandler.asyncStartFetchLogSegments()
                .thenApply(logSegments -> {
                    readAheadReader.addStateChangeNotification(BKSyncLogReader.this);
                    readAheadReader.start(logSegments.getValue());
                    return null;
```

### UnnecessaryQualifierForThis
Qualifier `BKLogReadHandler` on 'this' is unnecessary in this context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogReadHandler.java`
#### Snippet
```java
            .thenApply((value) -> {
                // unregister the log segment listener
                metadataStore.unregisterLogSegmentListener(logMetadata.getLogSegmentsPath(), BKLogReadHandler.this);
                return null;
            });
```

### UnnecessaryQualifierForThis
Qualifier `BKLogReadHandler` on 'this' is unnecessary in this context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogReadHandler.java`
#### Snippet
```java
                    .thenCompose(lock -> {
                        try {
                            BKLogReadHandler.this.readLock = lock;
                            LOG.info("acquiring readlock {} at {}", getLockClientId(), getReadLockPath());
                            return acquireLockOnExecutorThread(lock);
```

### UnnecessaryQualifierForThis
Qualifier `SegmentReader` on 'this' is unnecessary in this context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/ReadAheadEntryReader.java`
#### Snippet
```java
                openFuture.thenCompose(reader1 -> reader1.asyncClose()),
                () -> {
                    synchronized (SegmentReader.this) {
                        isClosed = true;
                    }
```

### UnnecessaryQualifierForThis
Qualifier `SegmentReader` on 'this' is unnecessary in this context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/ReadAheadEntryReader.java`
#### Snippet
```java
                openFuture.thenAccept(reader1 -> {
                    reader1.onLogSegmentMetadataUpdated(segment);
                    synchronized (SegmentReader.this) {
                        SegmentReader.this.metadata = segment;
                    }
```

### UnnecessaryQualifierForThis
Qualifier `SegmentReader` on 'this' is unnecessary in this context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/ReadAheadEntryReader.java`
#### Snippet
```java
                    reader1.onLogSegmentMetadataUpdated(segment);
                    synchronized (SegmentReader.this) {
                        SegmentReader.this.metadata = segment;
                    }
                });
```

### UnnecessaryQualifierForThis
Qualifier `LedgerAllocatorPool` on 'this' is unnecessary in this context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/LedgerAllocatorPool.java`
#### Snippet
```java
            Thread.currentThread().interrupt();
            logger.warn("Interrupted on rescuing ledger allocator {} : ", ledgerAllocator.allocatePath, ie);
            synchronized (LedgerAllocatorPool.this) {
                rescueMap.remove(ledgerAllocator.allocatePath);
            }
```

### UnnecessaryQualifierForThis
Qualifier `LedgerAllocatorPool` on 'this' is unnecessary in this context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/LedgerAllocatorPool.java`
#### Snippet
```java
            logger.warn("Failed to rescue ledger allocator {}, retry rescuing it later : ",
                    ledgerAllocator.allocatePath, ioe);
            synchronized (LedgerAllocatorPool.this) {
                rescueMap.remove(ledgerAllocator.allocatePath);
            }
```

### UnnecessaryQualifierForThis
Qualifier `ZKLogSegmentMetadataStore` on 'this' is unnecessary in this context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/ZKLogSegmentMetadataStore.java`
#### Snippet
```java
                        }
                    }
                    zkWatcher = ZKLogSegmentMetadataStore.this;
                }
            } finally {
```

### UnnecessaryQualifierForThis
Qualifier `BKDistributedLogManager` on 'this' is unnecessary in this context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKDistributedLogManager.java`
#### Snippet
```java
        }
        final BKAsyncLogReader reader = new BKAsyncLogReader(
                BKDistributedLogManager.this,
                scheduler,
                fromDLSN.isPresent() ? fromDLSN.get() : DLSN.InitialDLSN,
```

### UnnecessaryQualifierForThis
Qualifier `BKDistributedLogManager` on 'this' is unnecessary in this context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKDistributedLogManager.java`
#### Snippet
```java
        return createWriteHandleFuture.thenCompose(writeHandler -> {
            final BKAsyncLogWriter writer;
            synchronized (BKDistributedLogManager.this) {
                // 2. create the writer with the handler
                writer = new BKAsyncLogWriter(
```

### UnnecessaryQualifierForThis
Qualifier `BKDistributedLogManager` on 'this' is unnecessary in this context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKDistributedLogManager.java`
#### Snippet
```java
                        conf,
                        dynConf,
                        BKDistributedLogManager.this,
                        writeHandler,
                        featureProvider,
```

### UnnecessaryQualifierForThis
Qualifier `ZKSessionLock` on 'this' is unnecessary in this context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/lock/ZKSessionLock.java`
#### Snippet
```java
                // We have to be careful not to block here since doing so blocks the ordered lock
                // state executor which can cause deadlocks depending on how futures are chained.
                ZKSessionLock.this.asyncUnlock(cause);
                // Note re. logging and exceptions: errors are already logged by unlockAsync.
            }
```

### UnnecessaryQualifierForThis
Qualifier `SharedResourceManager` on 'this' is unnecessary in this context
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/SharedResourceManager.java`
#### Snippet
```java
            }
            cached.destroyTask = destroyer.schedule(new LogExceptionRunnable(() -> {
                synchronized (SharedResourceManager.this) {
                    // Refcount may have gone up since the task was scheduled. Re-check it.
                    if (cached.refCount == 0) {
```

## RuleId[id=SizeReplaceableByIsEmpty]
### SizeReplaceableByIsEmpty
`ranges.size() > 0` can be replaced with '!ranges.isEmpty()'
in `stream/clients/java/base/src/main/java/org/apache/bookkeeper/clients/impl/internal/ProtocolInternalUtils.java`
#### Snippet
```java
            "Missing key range [%s - %s)", lastEndKey, Long.MAX_VALUE);
        checkState(
            ranges.size() > 0,
            "No active range found");
        return HashStreamRanges.ofHash(
```

### SizeReplaceableByIsEmpty
`rKey.size() > 0` can be replaced with '!rKey.isEmpty()'
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/kv/TableStoreUtils.java`
#### Snippet
```java

    static boolean hasRKey(ByteString rKey) {
        return null != rKey && rKey.size() > 0;
    }

```

### SizeReplaceableByIsEmpty
`lEndKey.size() > 0` can be replaced with '!lEndKey.isEmpty()'
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/kv/TableStoreImpl.java`
#### Snippet
```java
        byte[] storeKey = newStoreKey(rKey, lKey);
        byte[] storeEndKey = null;
        if (null != lEndKey && lEndKey.size() > 0) {
            storeEndKey = newStoreKey(rKey, lEndKey);
        }
```

### SizeReplaceableByIsEmpty
`lEndKey.size() > 0` can be replaced with '!lEndKey.isEmpty()'
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/kv/TableStoreImpl.java`
#### Snippet
```java
        byte[] storeKey = newStoreKey(rKey, lKey);
        byte[] storeEndKey = null;
        if (null != lEndKey && lEndKey.size() > 0) {
            storeEndKey = newStoreKey(rKey, lEndKey);
        }
```

### SizeReplaceableByIsEmpty
`path.length() == 0` can be replaced with 'path.isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NodeBase.java`
#### Snippet
```java
     */
    public static String normalize(String path) {
        if (path == null || path.length() == 0) {
            return ROOT;
        }
```

### SizeReplaceableByIsEmpty
`args.size() == 0` can be replaced with 'args.isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/ScriptBasedMapping.java`
#### Snippet
```java
        private String runResolveCommand(List<String> args) {
            int loopCount = 0;
            if (args.size() == 0) {
                return null;
            }
```

### SizeReplaceableByIsEmpty
`factoryClassName.length() == 0` can be replaced with 'factoryClassName.isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/auth/AuthProviderFactoryFactory.java`
#### Snippet
```java
        String factoryClassName = conf.getClientAuthProviderFactoryClass();

        if (factoryClassName == null || factoryClassName.length() == 0) {
            return new NullClientAuthProviderFactory();
        }
```

### SizeReplaceableByIsEmpty
`factoryClassName.length() == 0` can be replaced with 'factoryClassName.isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/auth/AuthProviderFactoryFactory.java`
#### Snippet
```java
        String factoryClassName = conf.getBookieAuthProviderFactoryClass();

        if (factoryClassName == null || factoryClassName.length() == 0) {
            return new AuthenticationDisabledAuthProviderFactory();
        }
```

### SizeReplaceableByIsEmpty
`loc.length() == 0` can be replaced with 'loc.isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NetworkTopologyImpl.java`
#### Snippet
```java
         */
        private Node getLoc(String loc) {
            if (loc == null || loc.length() == 0) {
                return this;
            }
```

### SizeReplaceableByIsEmpty
`0 == servers.size()` can be replaced with 'servers.isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/AbstractConfiguration.java`
#### Snippet
```java
    public String getZkServers() {
        List servers = getList(ZK_SERVERS, null);
        if (null == servers || 0 == servers.size()) {
            return null;
        }
```

### SizeReplaceableByIsEmpty
`customMetadata.size() > 0` can be replaced with '!customMetadata.isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/LedgerMetadataSerDe.java`
#### Snippet
```java

            Map<String, byte[]> customMetadata = metadata.getCustomMetadata();
            if (customMetadata.size() > 0) {
                LedgerMetadataFormat.cMetadataMapEntry.Builder cMetadataBuilder =
                    LedgerMetadataFormat.cMetadataMapEntry.newBuilder();
```

### SizeReplaceableByIsEmpty
`customMetadata.size() > 0` can be replaced with '!customMetadata.isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/LedgerMetadataSerDe.java`
#### Snippet
```java

                Map<String, byte[]> customMetadata = metadata.getCustomMetadata();
                if (customMetadata.size() > 0) {
                    LedgerMetadataFormat.cMetadataMapEntry.Builder cMetadataBuilder =
                        LedgerMetadataFormat.cMetadataMapEntry.newBuilder();
```

### SizeReplaceableByIsEmpty
`zkActiveLedgers.size() == 0` can be replaced with 'zkActiveLedgers.isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/AbstractZkLedgerManager.java`
#### Snippet
```java

                // no ledgers found, return directly
                if (zkActiveLedgers.size() == 0) {
                    finalCb.processResult(successRc, null, ctx);
                    return;
```

### SizeReplaceableByIsEmpty
`data.size() == 0` can be replaced with 'data.isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/AbstractHierarchicalLedgerManager.java`
#### Snippet
```java
                            final AsyncCallback.VoidCallback finalCb, final Object context,
                            final int successRc, final int failureRc) {
            if (data == null || data.size() == 0) {
                finalCb.processResult(successRc, null, context);
                return;
```

### SizeReplaceableByIsEmpty
`ledgerRootPath.length() == 0` can be replaced with 'ledgerRootPath.isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/AbstractZkLedgerManagerFactory.java`
#### Snippet
```java
        }

        if (null == ledgerRootPath || ledgerRootPath.length() == 0) {
            throw new IOException("Empty Ledger Root Path.");
        }
```

### SizeReplaceableByIsEmpty
`subject.getPrincipals().size() > 0` can be replaced with '!subject.getPrincipals().isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/sasl/SaslServerState.java`
#### Snippet
```java
        SaslServerCallbackHandler callbackHandler = new SaslServerCallbackHandler(Configuration.getConfiguration(),
            serverConfiguration);
        if (subject.getPrincipals().size() > 0) {
            try {
                final Object[] principals = subject.getPrincipals().toArray();
```

### SizeReplaceableByIsEmpty
`children.size() > 0` can be replaced with '!children.isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/ZkLedgerUnderreplicationManager.java`
#### Snippet
```java
            Collections.shuffle(children);
            List<ACL> zkAcls = ZkUtils.getACLs(conf);
            while (children.size() > 0) {
                String tryChild = children.get(0);
                try {
```

### SizeReplaceableByIsEmpty
`children.size() > 0` can be replaced with '!children.isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/ZkLedgerUnderreplicationManager.java`
#### Snippet
```java
        Collections.shuffle(children);

        while (children.size() > 0) {
            String tryChild = children.get(0);
            String tryPath = parent + "/" + tryChild;
```

### SizeReplaceableByIsEmpty
`curBatch.size() > 0` can be replaced with '!curBatch.isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/ZkLedgerUnderreplicationManager.java`
#### Snippet
```java
            @Override
            public UnderreplicatedLedger next() {
                assert curBatch.size() > 0;
                return curBatch.remove();
            }
```

### SizeReplaceableByIsEmpty
`curBatch.size() > 0` can be replaced with '!curBatch.isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/ZkLedgerUnderreplicationManager.java`
#### Snippet
```java
            @Override
            public boolean hasNext() {
                if (curBatch.size() > 0) {
                    return true;
                }
```

### SizeReplaceableByIsEmpty
`queue.size() > 0` can be replaced with '!queue.isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/ZkLedgerUnderreplicationManager.java`
#### Snippet
```java
                }

                while (queue.size() > 0 && curBatch.size() == 0) {
                    String parent = queue.remove();
                    try {
```

### SizeReplaceableByIsEmpty
`curBatch.size() == 0` can be replaced with 'curBatch.isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/ZkLedgerUnderreplicationManager.java`
#### Snippet
```java
                }

                while (queue.size() > 0 && curBatch.size() == 0) {
                    String parent = queue.remove();
                    try {
```

### SizeReplaceableByIsEmpty
`curBatch.size() > 0` can be replaced with '!curBatch.isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/ZkLedgerUnderreplicationManager.java`
#### Snippet
```java
                    }
                }
                return curBatch.size() > 0;
            }

```

### SizeReplaceableByIsEmpty
`errors.size() > 0` can be replaced with '!errors.isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookie/LocalConsistencyCheckCommand.java`
#### Snippet
```java
        List<LedgerStorage.DetectedInconsistency> errors = ledgerStorage.localConsistencyCheck(
            java.util.Optional.empty());
        if (errors.size() > 0) {
            LOG.info("=== Check returned errors: ===");
            for (LedgerStorage.DetectedInconsistency error : errors) {
```

### SizeReplaceableByIsEmpty
`activeLedgers.size() == 0` can be replaced with 'activeLedgers.isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookie/ListActiveLedgersCommand.java`
#### Snippet
```java

    public void printActiveLedgerOnEntryLog(long logId, List<Long> activeLedgers){
      if (activeLedgers.size() == 0){
        LOG.info("No active ledgers on log file {}", logId);
      } else {
```

### SizeReplaceableByIsEmpty
`ledgersOnEntryLog.size() == 0` can be replaced with 'ledgersOnEntryLog.isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookie/ListActiveLedgersCommand.java`
#### Snippet
```java
              EntryLogMetadata entryLogMetadata = entryLogger.getEntryLogMetadata(cmdFlags.logId);
              List<Long> ledgersOnEntryLog = entryLogMetadata.getLedgersMap().keys();
              if (ledgersOnEntryLog.size() == 0) {
                LOG.info("Ledgers on log file {} is empty", cmdFlags.logId);
              }
```

### SizeReplaceableByIsEmpty
`ledgerList.size() == 0` can be replaced with 'ledgerList.isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/autorecovery/QueryAutoRecoveryStatusCommand.java`
#### Snippet
```java
                }
            }
            if (ledgerList.size() == 0) {
                // NO ledger is being auto recovering
                LOG.info("\t No Ledger is being recovered.");
```

### SizeReplaceableByIsEmpty
`map.size() == 0` can be replaced with 'map.isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookies/InfoCommand.java`
#### Snippet
```java
        try (BookKeeper bk = new BookKeeper(clientConf)) {
            Map<BookieId, BookieInfo> map = bk.getBookieInfo();
            if (map.size() == 0) {
                LOG.info("Failed to retrieve bookie information from any of the bookies");
                bk.close();
```

### SizeReplaceableByIsEmpty
`firstEntryList.size() == 0` can be replaced with 'firstEntryList.isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/IndexInMemPageMgr.java`
#### Snippet
```java
        indexPersistenceManager.flushLedgerHeader(ledger);

        if (null == firstEntryList || firstEntryList.size() == 0) {
            if (LOG.isDebugEnabled()) {
                LOG.debug("Nothing to flush for ledger {}.", ledger);
```

### SizeReplaceableByIsEmpty
`lruCleanPageMap.size() > 0` can be replaced with '!lruCleanPageMap.isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/IndexInMemPageMgr.java`
#### Snippet
```java
                return lep;
            }
            while (lruCleanPageMap.size() > 0) {
                lep = null;
                synchronized (lruCleanPageMap) {
```

### SizeReplaceableByIsEmpty
`dirsMissingData.size() > 0` can be replaced with '!dirsMissingData.isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LegacyCookieValidation.java`
#### Snippet
```java
            }
        }
        if (dirsMissingData.size() > 0 || nonEmptyDirs.size() > 0) {
            log.error("Either not all local directories have cookies or directories being added "
                    + " newly are not empty. "
```

### SizeReplaceableByIsEmpty
`nonEmptyDirs.size() > 0` can be replaced with '!nonEmptyDirs.isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LegacyCookieValidation.java`
#### Snippet
```java
            }
        }
        if (dirsMissingData.size() > 0 || nonEmptyDirs.size() > 0) {
            log.error("Either not all local directories have cookies or directories being added "
                    + " newly are not empty. "
```

### SizeReplaceableByIsEmpty
`0 == logs.size()` can be replaced with 'logs.isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/DefaultEntryLogger.java`
#### Snippet
```java
        }
        // no log file found in this directory
        if (0 == logs.size()) {
            return INVALID_LID;
        }
```

### SizeReplaceableByIsEmpty
`entries.size() != 0` can be replaced with '!entries.isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/IndexPersistenceMgr.java`
#### Snippet
```java
                lastOffset = entries.get(i).getFirstEntry();
            }
            if (entries.size() - start == 0 && entries.size() != 0) {
                LOG.warn("Nothing to write, but there were entries!");
            }
```

### SizeReplaceableByIsEmpty
`errors.size() > 0` can be replaced with '!errors.isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieImpl.java`
#### Snippet
```java
                return;
            }
            if (errors != null && errors.size() > 0) {
                LOG.error("Bookie failed local consistency check:");
                for (LedgerStorage.DetectedInconsistency error : errors) {
```

### SizeReplaceableByIsEmpty
`logs.size() == 0` can be replaced with 'logs.isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieImpl.java`
#### Snippet
```java
        // validate filtered log ids only when we have markedLogId
        if (markedLog.getLogFileId() > 0) {
            if (logs.size() == 0 || logs.get(0) != markedLog.getLogFileId()) {
                String path = journal.getJournalDirectory().getAbsolutePath();
                throw new IOException("Recovery log " + markedLog.getLogFileId() + " is missing at " + path);
```

### SizeReplaceableByIsEmpty
`conf.getAdvertisedAddress().trim().length() > 0` can be replaced with '!conf.getAdvertisedAddress().trim().isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieImpl.java`
#### Snippet
```java
        // Advertised address takes precedence over the listening interface and the
        // useHostNameAsBookieID settings
        if (conf.getAdvertisedAddress() != null && conf.getAdvertisedAddress().trim().length() > 0) {
            String hostAddress = conf.getAdvertisedAddress().trim();
            return new BookieSocketAddress(hostAddress, conf.getBookiePort());
```

### SizeReplaceableByIsEmpty
`ensembles.size() == 0` can be replaced with 'ensembles.isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerMetadataBuilder.java`
#### Snippet
```java

    public LedgerMetadataBuilder withEnsembleSize(int ensembleSize) {
        checkState(ensembles.size() == 0, "Can only set ensemble size before adding ensembles to the builder");
        this.ensembleSize = ensembleSize;
        return this;
```

### SizeReplaceableByIsEmpty
`ensembles.size() > 0` can be replaced with '!ensembles.isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerMetadataImpl.java`
#### Snippet
```java
                       long cToken,
                       Map<String, byte[]> customMetadata) {
        checkArgument(ensembles.size() > 0, "There must be at least one ensemble in the ledger");
        if (state == State.CLOSED) {
            checkArgument(length.isPresent(), "Closed ledger must have a length");
```

### SizeReplaceableByIsEmpty
`data.size() == 0` can be replaced with 'data.isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/MSLedgerManagerFactory.java`
#### Snippet
```java
        public void process(final Set<T> data, final Processor<T> processor, final AsyncCallback.VoidCallback finalCb,
                final Object context, final int successRc, final int failureRc) {
            if (data == null || data.size() == 0) {
                finalCb.processResult(successRc, null, context);
                return;
```

### SizeReplaceableByIsEmpty
`0 == ledgers.size()` can be replaced with 'ledgers.isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/MSLedgerManagerFactory.java`
#### Snippet
```java
                    }

                    if (0 == ledgers.size()) {
                        // process next batch of ledgers
                        asyncProcessLedgers(cursor, processor, finalCb, context, successRc, failureRc);
```

### SizeReplaceableByIsEmpty
`deadBookies.size() > 0` can be replaced with '!deadBookies.isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/DefaultEnsemblePlacementPolicy.java`
#### Snippet
```java
                    this.bookieInfoMap.put(b, new BookieInfo());
                }
                if (deadBookies.size() > 0 || newBookies.size() > 0) {
                    this.weightedSelection.updateMap(this.bookieInfoMap);
                }
```

### SizeReplaceableByIsEmpty
`newBookies.size() > 0` can be replaced with '!newBookies.isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/DefaultEnsemblePlacementPolicy.java`
#### Snippet
```java
                    this.bookieInfoMap.put(b, new BookieInfo());
                }
                if (deadBookies.size() > 0 || newBookies.size() > 0) {
                    this.weightedSelection.updateMap(this.bookieInfoMap);
                }
```

### SizeReplaceableByIsEmpty
`fragments.size() == 0` can be replaced with 'fragments.isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerChecker.java`
#### Snippet
```java
                                GenericCallback<Set<LedgerFragment>> cb,
                                long percentageOfLedgerFragmentToBeVerified) {
        if (fragments.size() == 0) { // no fragments to verify
            cb.operationComplete(BKException.Code.OK, fragments);
            return;
```

### SizeReplaceableByIsEmpty
`leftBookies.size() > 0` can be replaced with '!leftBookies.isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/TopologyAwareEnsemblePlacementPolicy.java`
#### Snippet
```java
            handleBookiesThatLeft(leftBookies);
            handleBookiesThatJoined(joinedBookies);
            if (this.isWeighted && (leftBookies.size() > 0 || joinedBookies.size() > 0)) {
                this.weightedSelection.updateMap(this.bookieInfoMap);
            }
```

### SizeReplaceableByIsEmpty
`joinedBookies.size() > 0` can be replaced with '!joinedBookies.isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/TopologyAwareEnsemblePlacementPolicy.java`
#### Snippet
```java
            handleBookiesThatLeft(leftBookies);
            handleBookiesThatJoined(joinedBookies);
            if (this.isWeighted && (leftBookies.size() > 0 || joinedBookies.size() > 0)) {
                this.weightedSelection.updateMap(this.bookieInfoMap);
            }
```

### SizeReplaceableByIsEmpty
`map.size() == 0` can be replaced with 'map.isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/http/service/ListBookieInfoService.java`
#### Snippet
```java

            Map<BookieId, BookieInfoReader.BookieInfo> map = bk.getBookieInfo();
            if (map.size() == 0) {
                bk.close();
                response.setCode(HttpServer.StatusCode.NOT_FOUND);
```

### SizeReplaceableByIsEmpty
`errors.size() > 0` can be replaced with '!errors.isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/service/ScrubberService.java`
#### Snippet
```java
        try {
            List<LedgerStorage.DetectedInconsistency> errors = ledgerStorage.localConsistencyCheck(scrubRateLimiter);
            if (errors.size() > 0) {
                errorCounter.addCount(errors.size());
                LOG.error("Found inconsistency during localConsistencyCheck:");
```

### SizeReplaceableByIsEmpty
`bookiesToBeAudited.size() == 0` can be replaced with 'bookiesToBeAudited.isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/Auditor.java`
#### Snippet
```java
                // find lost bookies(if any)
                bookiesToBeAudited.addAll(CollectionUtils.subtract(knownBookies, availableBookies));
                if (bookiesToBeAudited.size() == 0) {
                    return;
                }
```

### SizeReplaceableByIsEmpty
`fragments.size() == 0` can be replaced with 'fragments.isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/ReplicationWorker.java`
#### Snippet
```java

            fragments = getUnderreplicatedFragments(lh, conf.getAuditorLedgerVerificationPercentage());
            if (fragments.size() == 0) {
                LOG.info("Ledger replicated successfully. ledger id is: " + ledgerIdToReplicate);
                underreplicationManager.markLedgerReplicated(ledgerIdToReplicate);
```

### SizeReplaceableByIsEmpty
`rackMap.size() == 0` can be replaced with 'rackMap.isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RackawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
            }
        }
        if (rackMap.size() == 0) {
            return null;
        }
```

### SizeReplaceableByIsEmpty
`ledgers.size() == 0` can be replaced with 'ledgers.isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/AuditorTask.java`
#### Snippet
```java

    protected CompletableFuture<?> publishSuspectedLedgersAsync(Collection<String> missingBookies, Set<Long> ledgers) {
        if (null == ledgers || ledgers.size() == 0) {
            // there is no ledgers available for this bookie and just
            // ignoring the bookie failures
```

### SizeReplaceableByIsEmpty
`lostBookies.size() > 0` can be replaced with '!lostBookies.isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/AuditorBookieCheckTask.java`
#### Snippet
```java
                .registerSuccessfulEvent(stopwatch.elapsed(TimeUnit.MILLISECONDS),
                TimeUnit.MILLISECONDS);
        if (lostBookies.size() > 0) {
            try {
                FutureUtils.result(
```

### SizeReplaceableByIsEmpty
`kvs.size() > 0` can be replaced with '!kvs.isEmpty()'
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/helpers/KeyStream.java`
#### Snippet
```java
                hasMore = getResp.isMore();
                lkey = lastKey;
                if (kvs.size() > 0) {
                    lastKey = nextKey = kvs.get(kvs.size() - 1).getKey();
                }
```

### SizeReplaceableByIsEmpty
`kvs.size() > 0` can be replaced with '!kvs.isEmpty()'
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/helpers/KeyStream.java`
#### Snippet
```java
            }
            if (null != lkey
                && kvs.size() > 0
                && UnsignedBytes.lexicographicalComparator().compare(
                    lkey.getBytes(),
```

### SizeReplaceableByIsEmpty
`ledgerFragmentsToRecover.size() == 0` can be replaced with 'ledgerFragmentsToRecover.isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeperAdmin.java`
#### Snippet
```java
                 * multiCallback and return.
                 */
                if (ledgerFragmentsToRecover.size() == 0) {
                    ledgerIterCb.processResult(BKException.Code.OK, null, null);
                    return;
```

### SizeReplaceableByIsEmpty
`0 == map.size()` can be replaced with 'map.isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/metastore/InMemoryMetastoreTable.java`
#### Snippet
```java
            String lastKey, boolean lastInclusive,
            Order order, Set<String> fields) {
        if (0 == map.size()) {
            return new Result<MetastoreCursor>(Code.OK, MetastoreCursor.EMPTY_CURSOR);
        }
```

### SizeReplaceableByIsEmpty
`0 == basename.length()` can be replaced with 'basename.isEmpty()'
in `stats/bookkeeper-stats-providers/codahale-metrics-provider/src/main/java/org/apache/bookkeeper/stats/codahale/FastCodahaleStatsLogger.java`
#### Snippet
```java
    public StatsLogger scope(String scope) {
        String scopeName;
        if (basename == null || 0 == basename.length()) {
            scopeName = scope;
        } else {
```

### SizeReplaceableByIsEmpty
`0 == basename.length()` can be replaced with 'basename.isEmpty()'
in `stats/bookkeeper-stats-providers/codahale-metrics-provider/src/main/java/org/apache/bookkeeper/stats/codahale/CodahaleStatsLogger.java`
#### Snippet
```java
    public StatsLogger scope(String scope) {
        String scopeName;
        if (basename == null || 0 == basename.length()) {
            scopeName = scope;
        } else {
```

### SizeReplaceableByIsEmpty
`records.size() > 0` can be replaced with '!records.isEmpty()'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAsyncLogReader.java`
#### Snippet
```java

        boolean hasReadRecords() {
            return records.size() > 0;
        }

```

### SizeReplaceableByIsEmpty
`entries.size() > 0` can be replaced with '!entries.isEmpty()'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/logsegment/BKLogSegmentEntryReader.java`
#### Snippet
```java

        boolean hasReadEntries() {
            return entries.size() > 0;
        }

```

### SizeReplaceableByIsEmpty
`logName.length() == 0` can be replaced with 'logName.isEmpty()'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/util/DLUtils.java`
#### Snippet
```java
        if (logName == null) {
            throw new InvalidStreamNameException("Log name cannot be null");
        } else if (logName.length() == 0) {
            throw new InvalidStreamNameException("Log name length must be > 0");
        } else if (logName.charAt(0) != '/') {
```

### SizeReplaceableByIsEmpty
`streams.size() == 0` can be replaced with 'streams.isEmpty()'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
            System.out.println("- 0. checking streams under " + uri);
        }
        if (streams.size() == 0) {
            System.out.println("+ 0. nothing to check. quit.");
            return;
```

### SizeReplaceableByIsEmpty
`uris.size() > 0` can be replaced with '!uris.isEmpty()'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/auditor/DLAuditor.java`
#### Snippet
```java
    public Pair<Set<Long>, Set<Long>> collectLedgers(List<URI> uris, List<List<String>> allocationPaths)
            throws IOException {
        checkArgument(uris.size() > 0, "No uri provided to audit");

        String zkServers = validateAndGetZKServers(uris);
```

### SizeReplaceableByIsEmpty
`children.size() > 0` can be replaced with '!children.isEmpty()'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/lock/ZKSessionLock.java`
#### Snippet
```java

                        Collections.sort(children, MEMBER_COMPARATOR);
                        if (children.size() > 0) {
                            asyncParseClientID(zk, lockPath, children.get(0)).whenCompleteAsync(
                                    new FutureEventListener<Pair<String, Long>>() {
```

### SizeReplaceableByIsEmpty
`0 == streams.size()` can be replaced with 'streams.isEmpty()'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                }
            }
            if (0 == streams.size()) {
                return 0;
            }
```

### SizeReplaceableByIsEmpty
`0 == streams.size()` can be replaced with 'streams.isEmpty()'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                }
            }
            if (0 == streams.size()) {
                return 0;
            }
```

### SizeReplaceableByIsEmpty
`0 == streams.size()` can be replaced with 'streams.isEmpty()'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                }
            }
            if (0 == streams.size()) {
                return;
            }
```

## RuleId[id=TrivialStringConcatenation]
### TrivialStringConcatenation
Empty string used in concatenation
in `stream/clients/java/base/src/main/java/org/apache/bookkeeper/clients/impl/container/StorageContainerChannel.java`
#### Snippet
```java
                new StorageContainerException(StatusCode.STALE_GROUP_INFO,
                    "Fetched a stale storage container info : current = " + scInfo.getRevision()
                        + ", fetched = " + endpoint.getRevision() + ""));
            return;
        }
```

### TrivialStringConcatenation
Empty string used in concatenation
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/conf/ConfigDef.java`
#### Snippet
```java
            stream.println("#");
            writeSentence(stream, COMMENT_PREFIX,
                "@since " + key.since() + "");
        }
        // "#"
```

## RuleId[id=FinalStaticMethod]
### FinalStaticMethod
'static' method declared `final`
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/metadata/stream/MetaRangeImpl.java`
#### Snippet
```java
    }

    public static final boolean isMetadataKey(byte[] key) {
        return key.length == (Long.BYTES + 1) && key[Long.BYTES] == METADATA_SEP;
    }
```

### FinalStaticMethod
'static' method declared `final`
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/metadata/stream/MetaRangeImpl.java`
#### Snippet
```java
    }

    public static final byte[] getStreamMetadataEndKey(long streamId) {
        byte[] metadataKey = new byte[Long.BYTES + 1];
        Bytes.toBytes(streamId, metadataKey, 0);
```

### FinalStaticMethod
'static' method declared `final`
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/metadata/stream/MetaRangeImpl.java`
#### Snippet
```java
    }

    public static final byte[] getStreamRangeKey(long streamId, long rangeId) {
        byte[] rangeKey = new byte[2 * Long.BYTES + 1];
        Bytes.toBytes(streamId, rangeKey, 0);
```

### FinalStaticMethod
'static' method declared `final`
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/metadata/stream/MetaRangeImpl.java`
#### Snippet
```java
    private static final byte END_SEP = (byte) 0xff;

    public static final byte[] getStreamMetadataKey(long streamId) {
        byte[] metadataKey = new byte[Long.BYTES + 1];
        Bytes.toBytes(streamId, metadataKey, 0);
```

### FinalStaticMethod
'static' method declared `final`
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/metadata/stream/MetaRangeImpl.java`
#### Snippet
```java
    }

    static final boolean isStreamRangeKey(byte[] key) {
        return key.length == (2 * Long.BYTES + 1) && key[Long.BYTES] == RANGE_SEP;
    }
```

### FinalStaticMethod
'static' method declared `final`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentLongHashSet.java`
#### Snippet
```java
    }

    static final int signSafeMod(long n, int max) {
        return (int) (n & (max - 1));
    }
```

### FinalStaticMethod
'static' method declared `final`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentLongHashSet.java`
#### Snippet
```java
    private static final int R = 47;

    static final long hash(long key) {
        long hash = key * HashMixer;
        hash ^= hash >>> R;
```

### FinalStaticMethod
'static' method declared `final`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentOpenHashSet.java`
#### Snippet
```java
    private static final int R = 47;

    static final <K> long hash(K key) {
        long hash = key.hashCode() * HashMixer;
        hash ^= hash >>> R;
```

### FinalStaticMethod
'static' method declared `final`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentOpenHashSet.java`
#### Snippet
```java
    }

    static final int signSafeMod(long n, int max) {
        return (int) n & (max - 1);
    }
```

### FinalStaticMethod
'static' method declared `final`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentLongHashMap.java`
#### Snippet
```java
    private static final int R = 47;

    static final long hash(long key) {
        long hash = key * HashMixer;
        hash ^= hash >>> R;
```

### FinalStaticMethod
'static' method declared `final`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentLongHashMap.java`
#### Snippet
```java
    }

    static final int signSafeMod(long n, int max) {
        return (int) n & (max - 1);
    }
```

### FinalStaticMethod
'static' method declared `final`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentOpenHashMap.java`
#### Snippet
```java
    private static final int R = 47;

    static final <K> long hash(K key) {
        long hash = key.hashCode() * HashMixer;
        hash ^= hash >>> R;
```

### FinalStaticMethod
'static' method declared `final`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentOpenHashMap.java`
#### Snippet
```java
    }

    static final int signSafeMod(long n, int max) {
        return (int) (n & (max - 1)) << 1;
    }
```

### FinalStaticMethod
'static' method declared `final`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/IndexPersistenceMgr.java`
#### Snippet
```java

    @VisibleForTesting
    public static final String getLedgerName(long ledgerId) {
        int parent = (int) (ledgerId & 0xff);
        int grandParent = (int) ((ledgerId & 0xff00) >> 8);
```

### FinalStaticMethod
'static' method declared `final`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentLongLongHashMap.java`
#### Snippet
```java
    private static final int R = 47;

    static final long hash(long key) {
        long hash = key * HashMixer;
        hash ^= hash >>> R;
```

### FinalStaticMethod
'static' method declared `final`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentLongLongHashMap.java`
#### Snippet
```java
    }

    static final int signSafeMod(long n, int max) {
        return (int) (n & (max - 1)) << 1;
    }
```

### FinalStaticMethod
'static' method declared `final`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentLongLongPairHashMap.java`
#### Snippet
```java
    private static final int R = 47;

    static final long hash(long key1, long key2) {
        long hash = key1 * HashMixer;
        hash ^= hash >>> R;
```

### FinalStaticMethod
'static' method declared `final`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentLongLongPairHashMap.java`
#### Snippet
```java
    }

    static final int signSafeMod(long n, int max) {
        return (int) (n & (max - 1)) << 2;
    }
```

### FinalStaticMethod
'static' method declared `final`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/EmbeddedServer.java`
#### Snippet
```java
     * @return a new embedded server builder
     */
    public static final Builder builder(BookieConfiguration conf) {
        return new Builder(conf);
    }
```

## RuleId[id=NullableProblems]
### NullableProblems
The generated code will use '@org.jetbrains.annotations.NotNull' instead of '@lombok.NonNull'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/http/service/ClusterInfoService.java`
#### Snippet
```java
public class ClusterInfoService implements HttpEndpointService {

    @NonNull
    private final BookKeeperAdmin bka;
    @NonNull
```

### NullableProblems
The generated code will use '@org.jetbrains.annotations.NotNull' instead of '@lombok.NonNull'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/http/service/ClusterInfoService.java`
#### Snippet
```java
    @NonNull
    private final BookKeeperAdmin bka;
    @NonNull
    private final LedgerManagerFactory ledgerManagerFactory;

```

### NullableProblems
The generated code will use '@org.jetbrains.annotations.NotNull' instead of '@lombok.NonNull'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/http/service/BookieInfoService.java`
#### Snippet
```java
@AllArgsConstructor
public class BookieInfoService implements HttpEndpointService {
    @NonNull private final Bookie bookie;

    /**
```

## RuleId[id=ExplicitArrayFilling]
### ExplicitArrayFilling
Can be replaced with single 'Arrays.fill()' method call
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RoundRobinDistributionSchedule.java`
#### Snippet
```java

        private RRQuorumCoverageSet() {
            for (int i = 0; i < covered.length; i++) {
                covered[i] = BKException.Code.UNINITIALIZED;
            }
```

## RuleId[id=IgnoreResultOfCall]
### IgnoreResultOfCall
Result of `InputStream.read()` is ignored
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/HexDumpEntryFormatter.java`
#### Snippet
```java
        try {
            byte[] data = new byte[input.available()];
            input.read(data, 0, data.length);
            formatEntry(data);
        } catch (IOException ie) {
```

### IgnoreResultOfCall
Result of `InputStream.read()` is ignored
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/StringEntryFormatter.java`
#### Snippet
```java
        try {
            byte[] data = new byte[input.available()];
            input.read(data, 0, data.length);
            formatEntry(data);
        } catch (IOException ie) {
```

### IgnoreResultOfCall
Result of `File.list()` is ignored
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieImpl.java`
#### Snippet
```java

            final AtomicBoolean oldDataExists = new AtomicBoolean(false);
            parent.list(new FilenameFilter() {
                    @Override
                    public boolean accept(File dir, String name) {
```

### IgnoreResultOfCall
Result of `ByteArrayInputStream.read()` is ignored
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/PersistentEntryLogMetadataMap.java`
#### Snippet
```java
            datais.set(new DataInputStream(newBais));
        } else {
            localBais.read(value, 0, value.length);
        }
        localBais.reset();
```

### IgnoreResultOfCall
Result of `File.delete()` is ignored
in `circe-checksum/src/main/java/com/scurrilous/circe/utils/NativeUtils.java`
#### Snippet
```java

        File dir = File.createTempFile("native", "");
        dir.delete();
        if (!(dir.mkdir())) {
            throw new IOException("Failed to create temp directory " + dir.getAbsolutePath());
```

### IgnoreResultOfCall
Result of `InputStream.skip()` is ignored
in `stream/distributedlog/io/dlfs/src/main/java/org/apache/distributedlog/fs/DLInputStream.java`
#### Snippet
```java
                return n;
            } else {
                currentRecord.payloadStream.skip(remaining);
                this.pos = endPos - currentRecord.payloadStream.available();
                return n;
```

### IgnoreResultOfCall
Result of `InputStream.skip()` is ignored
in `stream/distributedlog/io/dlfs/src/main/java/org/apache/distributedlog/fs/DLInputStream.java`
#### Snippet
```java
                return true;
            } else {
                this.currentRecord.payloadStream.skip(
                    this.currentRecord.payloadStream.available() - (endPos - position));
                this.pos = position;
```

### IgnoreResultOfCall
Result of `InputStream.skip()` is ignored
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/dlog/DLInputStream.java`
#### Snippet
```java
                return true;
            } else {
                this.currentRecord.payloadStream.skip(
                    this.currentRecord.payloadStream.available() - (endPos - position));
                this.pos = position;
```

### IgnoreResultOfCall
Result of `InputStream.skip()` is ignored
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/dlog/DLInputStream.java`
#### Snippet
```java
                return n;
            } else {
                currentRecord.payloadStream.skip(remaining);
                this.pos = endPos - currentRecord.payloadStream.available();
                return n;
```

### IgnoreResultOfCall
Result of `Integer.parseUnsignedInt()` is ignored
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/net/ServiceURI.java`
#### Snippet
```java
        } else if (parts.length == 2) {
            try {
                Integer.parseUnsignedInt(parts[1]);
            } catch (NumberFormatException nfe) {
                throw new IllegalArgumentException("Invalid hostname : " + hostname);
```

## RuleId[id=AccessStaticViaInstance]
### AccessStaticViaInstance
Static member 'org.apache.bookkeeper.metadata.etcd.EtcdWatchClient.isHaltError(io.grpc.Status)' accessed via instance reference
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdWatchClient.java`
#### Snippet
```java

        Status status = Status.fromThrowable(t);
        if (this.isHaltError(status) || this.isNoLeaderError(status)) {
            this.notifyWatchers(toEtcdException(status));
            this.closeGrpcWatchStreamObserver();
```

### AccessStaticViaInstance
Static member 'org.apache.bookkeeper.metadata.etcd.EtcdWatchClient.isNoLeaderError(io.grpc.Status)' accessed via instance reference
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdWatchClient.java`
#### Snippet
```java

        Status status = Status.fromThrowable(t);
        if (this.isHaltError(status) || this.isNoLeaderError(status)) {
            this.notifyWatchers(toEtcdException(status));
            this.closeGrpcWatchStreamObserver();
```

### AccessStaticViaInstance
Static member 'org.apache.bookkeeper.metadata.etcd.EtcdWatchClient.toWatchCreateRequest(org.apache.bookkeeper.metadata.etcd.EtcdWatcher)' accessed via instance reference
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdWatchClient.java`
#### Snippet
```java
        EtcdWatcher pendingWatcher = this.pendingWatchers.peek();
        if (pendingWatcher != null) {
            return Optional.of(this.toWatchCreateRequest(pendingWatcher));
        }
        return Optional.empty();
```

### AccessStaticViaInstance
Static member 'org.apache.distributedlog.lock.ZKSessionLock.epochUpdater' accessed via instance reference
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/lock/ZKSessionLock.java`
#### Snippet
```java

        // already closed or expired, nothing to cleanup
        this.epochUpdater.incrementAndGet(this);
        if (null != watcher) {
            this.zkClient.unregister(watcher);
```

## RuleId[id=UnnecessaryUnboxing]
### UnnecessaryUnboxing
Unnecessary unboxing
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/Main.java`
#### Snippet
```java
                log.info("Get cmdline http port: {}", sPort);
                Integer iPort = Integer.parseInt(sPort);
                conf.setHttpServerPort(iPort.intValue());
            }

```

## RuleId[id=RedundantMethodOverride]
### RedundantMethodOverride
Method `close()` only delegates to its super method
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/zk/ZKMetadataBookieDriver.java`
#### Snippet
```java

    @Override
    public void close() {
        super.close();
    }
```

### RedundantMethodOverride
Method `hashCode()` only delegates to its super method
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryKeyValue.java`
#### Snippet
```java

    @Override
    public int hashCode() {
        // since this entry is identified by (lid, eid)
        // so just use {@link org.apache.bookkeeper.bookie.EntryKey#hashCode} as the hash code.
```

### RedundantMethodOverride
Method `equals()` only delegates to its super method
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryKeyValue.java`
#### Snippet
```java

    @Override
    public boolean equals(Object other) {
        // since this entry is identified by (lid, eid)
        // so just use {@link org.apache.bookkeeper.bookie.EntryKey#equals}.
```

### RedundantMethodOverride
Method `reorderReadSequence()` only delegates to its super method
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RackawareEnsemblePlacementPolicy.java`
#### Snippet
```java

    @Override
    public DistributionSchedule.WriteSet reorderReadSequence(
            List<BookieId> ensemble,
            BookiesHealthInfo bookiesHealthInfo,
```

### RedundantMethodOverride
Method `reorderReadLACSequence()` only delegates to its super method
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RackawareEnsemblePlacementPolicy.java`
#### Snippet
```java

    @Override
    public DistributionSchedule.WriteSet reorderReadLACSequence(
            List<BookieId> ensemble,
            BookiesHealthInfo bookiesHealthInfo,
```

### RedundantMethodOverride
Method `reorderReadSequence()` is identical to its super method
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ZoneawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java

    @Override
    public DistributionSchedule.WriteSet reorderReadSequence(List<BookieId> ensemble,
            BookiesHealthInfo bookiesHealthInfo, DistributionSchedule.WriteSet writeSet) {
        return writeSet;
```

### RedundantMethodOverride
Method `abort()` only delegates to its super method
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKSyncLogWriter.java`
#### Snippet
```java
     */
    @Override
    public void abort() throws IOException {
        super.abort();
    }
```

### RedundantMethodOverride
Method `parseCommandLine()` only delegates to its super method
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java

        @Override
        protected void parseCommandLine(CommandLine cmdline) throws ParseException {
            super.parseCommandLine(cmdline);
        }
```

### RedundantMethodOverride
Method `equals()` only delegates to its super method
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/collections/RecyclableArrayList.java`
#### Snippet
```java

    @Override
    public boolean equals(Object obj) {
        return super.equals(obj);
    }
```

### RedundantMethodOverride
Method `hashCode()` only delegates to its super method
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/collections/RecyclableArrayList.java`
#### Snippet
```java

    @Override
    public int hashCode() {
        return super.hashCode();
    }
```

## RuleId[id=ClassNameSameAsAncestorName]
### ClassNameSameAsAncestorName
Class name `AbstractConfiguration` is the same as one of its superclass' names
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/AbstractConfiguration.java`
#### Snippet
```java
 */
@Slf4j
public abstract class AbstractConfiguration<T extends AbstractConfiguration>
    extends CompositeConfiguration {

```

### ClassNameSameAsAncestorName
Class name `SafeRunnable` is the same as one of its superclass' names
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/SafeRunnable.java`
#### Snippet
```java
 * A SafeRunnable implementation.
 */
public abstract class SafeRunnable implements org.apache.bookkeeper.common.util.SafeRunnable {

    /**
```

### ClassNameSameAsAncestorName
Class name `Code` is the same as one of its superclass' names
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BKException.java`
#### Snippet
```java
     * The list has been moved to {@link BKException}
     */
    public interface Code extends org.apache.bookkeeper.client.api.BKException.Code {
    }

```

### ClassNameSameAsAncestorName
Class name `BKException` is the same as one of its superclass' names
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BKException.java`
#### Snippet
```java
 */
@SuppressWarnings("serial")
public abstract class BKException extends org.apache.bookkeeper.client.api.BKException {

    public static final Function<Throwable, BKException> HANDLER = cause -> {
```

### ClassNameSameAsAncestorName
Class name `BookKeeper` is the same as one of its superclass' names
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeper.java`
#### Snippet
```java
 * asynchronous calls can be found in the class {@link BKException}.
 */
public class BookKeeper implements org.apache.bookkeeper.client.api.BookKeeper {

    private static final Logger LOG = LoggerFactory.getLogger(BookKeeper.class);
```

### ClassNameSameAsAncestorName
Class name `MathUtils` is the same as one of its superclass' names
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/util/MathUtils.java`
#### Snippet
```java
 * <p>Deprecated since 4.6.0, in favor of using {@link org.apache.bookkeeper.common.util.MathUtils}.
 */
public class MathUtils extends org.apache.bookkeeper.common.util.MathUtils {
}

```

### ClassNameSameAsAncestorName
Class name `Recycler` is the same as one of its superclass' names
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/collections/RecyclableArrayList.java`
#### Snippet
```java
     * An ArrayList recycler.
     */
    public static class Recycler<X>
        extends io.netty.util.Recycler<RecyclableArrayList<X>> {
        @Override
```

## RuleId[id=IntegerMultiplicationImplicitCastToLong]
### IntegerMultiplicationImplicitCastToLong
entrylogMapAccessExpiryTimeInSeconds \* entryLogPerLedgerCounterLimitsMultFactor: integer multiplication implicitly cast to long
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryLogManagerForEntryLogPerLedger.java`
#### Snippet
```java

            ledgerIdEntryLogCounterCacheMap = CacheBuilder.newBuilder()
                    .expireAfterAccess(entrylogMapAccessExpiryTimeInSeconds * entryLogPerLedgerCounterLimitsMultFactor,
                            TimeUnit.SECONDS)
                    .maximumSize(maximumNumberOfActiveEntryLogs * entryLogPerLedgerCounterLimitsMultFactor)
```

### IntegerMultiplicationImplicitCastToLong
maximumNumberOfActiveEntryLogs \* entryLogPerLedgerCounterLimitsMultFactor: integer multiplication implicitly cast to long
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryLogManagerForEntryLogPerLedger.java`
#### Snippet
```java
                    .expireAfterAccess(entrylogMapAccessExpiryTimeInSeconds * entryLogPerLedgerCounterLimitsMultFactor,
                            TimeUnit.SECONDS)
                    .maximumSize(maximumNumberOfActiveEntryLogs * entryLogPerLedgerCounterLimitsMultFactor)
                    .removalListener(new RemovalListener<Long, MutableInt>() {
                        @Override
```

### IntegerMultiplicationImplicitCastToLong
this.conf.getZkTimeout() \* 2: integer multiplication implicitly cast to long
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/ScanAndCompareGarbageCollector.java`
#### Snippet
```java

            // Iterate over all the ledger on the metadata store
            long zkOpTimeoutMs = this.conf.getZkTimeout() * 2;
            LedgerRangeIterator ledgerRangeIterator = ledgerManager
                    .getLedgerRanges(zkOpTimeoutMs);
```

### IntegerMultiplicationImplicitCastToLong
duration \* 1000: integer multiplication implicitly cast to long
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
    public synchronized void run() throws Exception {
        long start = System.currentTimeMillis();
        long testEnd = start + (duration * 1000);
        long testDrainEnd = testEnd + (drainTimeout * 1000);

```

### IntegerMultiplicationImplicitCastToLong
drainTimeout \* 1000: integer multiplication implicitly cast to long
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
        long start = System.currentTimeMillis();
        long testEnd = start + (duration * 1000);
        long testDrainEnd = testEnd + (drainTimeout * 1000);

        /* Keep IO running until testEnd */
```

### IntegerMultiplicationImplicitCastToLong
zkTimeoutSec \* 1000: integer multiplication implicitly cast to long
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LocalDLMEmulator.java`
#### Snippet
```java
    public void start() throws Exception {
        bkStartupThread.start();
        if (!LocalBookKeeper.waitForServerUp(zkEnsemble, zkTimeoutSec * 1000)) {
            throw new Exception("Error starting zookeeper/bookkeeper");
        }
```

### IntegerMultiplicationImplicitCastToLong
2 \* getReadLACLongPollTimeout(): integer multiplication implicitly cast to long
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/DistributedLogConfiguration.java`
#### Snippet
```java
        long readerIdleWarnThresholdMs = getReaderIdleWarnThresholdMillis();
        if (readerIdleWarnThresholdMs > 0) { // NOTE: some test cases set the idle warn threshold to 0
            checkArgument(readerIdleWarnThresholdMs > 2 * getReadLACLongPollTimeout(),
                    "Invalid configuration: ReaderIdleWarnThreshold should be 2x larget than readLACLongPollTimeout");
        }
```

### IntegerMultiplicationImplicitCastToLong
sent \* 1000: integer multiplication implicitly cast to long
in `bookkeeper-benchmark/src/main/java/org/apache/bookkeeper/benchmark/BenchThroughputLatency.java`
#### Snippet
```java
            duration = System.currentTimeMillis() - start;
        }
        throughput = sent * 1000 / getDuration();

        reporter.interrupt();
```

### IntegerMultiplicationImplicitCastToLong
ttlSeconds \* 1000: integer multiplication implicitly cast to long
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/mvcc/MVCCStoreImpl.java`
#### Snippet
```java
            record.getValue().writeLong(newAmount);
            record.setModRev(revision);
            record.setExpireTime(System.currentTimeMillis() + (ttlSeconds * 1000));

            // write the mvcc record back
```

### IntegerMultiplicationImplicitCastToLong
ttlSeconds \* 1000: integer multiplication implicitly cast to long
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/mvcc/MVCCStoreImpl.java`
#### Snippet
```java
            record.setValue(rawValBuf, ValueType.BYTES);
            record.setModRev(revision);
            record.setExpireTime(System.currentTimeMillis() + (ttlSeconds * 1000));

            // write the mvcc record back
```

## RuleId[id=UNUSED_IMPORT]
### UNUSED_IMPORT
Unused import `import java.nio.ByteBuffer;`
in `circe-checksum/src/main/java/com/scurrilous/circe/checksum/Java8IntHash.java`
#### Snippet
```java
import com.scurrilous.circe.crc.StandardCrcProvider;
import io.netty.buffer.ByteBuf;
import java.nio.ByteBuffer;
import java.util.zip.Checksum;

```

### UNUSED_IMPORT
Unused import `import java.util.zip.Checksum;`
in `circe-checksum/src/main/java/com/scurrilous/circe/checksum/Java8IntHash.java`
#### Snippet
```java
import io.netty.buffer.ByteBuf;
import java.nio.ByteBuffer;
import java.util.zip.Checksum;

public class Java8IntHash implements IntHash {
```

## RuleId[id=NestedAssignment]
### NestedAssignment
Result of assignment expression used
in `stream/clients/java/base/src/main/java/org/apache/bookkeeper/clients/impl/container/StorageContainerChannel.java`
#### Snippet
```java
                return rsChannelFuture;
            }
            channelFuture = rsChannelFuture = FutureUtils.createFuture();
        }
        fetchStorageContainerInfo();
```

### NestedAssignment
Result of assignment expression used
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/metadata/stream/MetaRangeImpl.java`
#### Snippet
```java
        }
        this.streamId = streamProps.getStreamId();
        this.cTime = this.mTime = System.currentTimeMillis();

        // 3. create the ranges
```

### NestedAssignment
Result of assignment expression used
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/ScriptBasedMapping.java`
#### Snippet
```java
                File dir = null;
                String userDir;
                if ((userDir = System.getProperty("user.dir")) != null) {
                    dir = new File(userDir);
                }
```

### NestedAssignment
Result of assignment expression used
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/ScriptBasedMapping.java`
#### Snippet
```java
                File dir = null;
                String userDir;
                if ((userDir = System.getProperty("user.dir")) != null) {
                    dir = new File(userDir);
                }
```

### NestedAssignment
Result of assignment expression used
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/Shell.java`
#### Snippet
```java
            char[] buf = new char[512];
            int nRead;
            while ((nRead = lines.read(buf, 0, buf.length)) > 0) {
                output.append(buf, 0, nRead);
            }
```

### NestedAssignment
Result of assignment expression used
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/GarbageCollectorThread.java`
#### Snippet
```java
               + majorCompactionThreshold + ", interval=" + majorCompactionInterval);

        lastMinorCompactionTime = lastMajorCompactionTime = System.currentTimeMillis();
    }

```

### NestedAssignment
Result of assignment expression used
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/IndexInMemPageMgr.java`
#### Snippet
```java
        }
        LedgerEntryPage oldLep;
        if (lep != (oldLep = pageMapAndList.putPage(lep))) {
            // if we grab a clean page, but failed to put it in the cache
            // we should put this page in the free page list so that it
```

### NestedAssignment
Result of assignment expression used
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BufferedReadChannel.java`
#### Snippet
```java
                readBufferStartPosition = currentPosition;
                int readBytes = 0;
                if ((readBytes = validateAndGetFileChannel().read(readBuffer.internalNioBuffer(0, readCapacity),
                        currentPosition)) <= 0) {
                    throw new IOException("Reading from filechannel returned a non-positive value. Short read.");
                }
```

### NestedAssignment
Result of assignment expression used
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LedgerDescriptorImpl.java`
#### Snippet
```java
        CompletableFuture<Boolean> result;
        synchronized (this) {
            result = logFenceResult = FutureUtils.createFuture();
        }
        ByteBuf entry = createLedgerFenceEntry(ledgerId);
```

### NestedAssignment
Result of assignment expression used
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryLogMetadata.java`
#### Snippet
```java
        this.entryLogId = logId;

        totalSize = remainingSize = 0;
    }

```

### NestedAssignment
Result of assignment expression used
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerOpenOp.java`
#### Snippet
```java
                        });
                    } else {
                        lh.lastAddConfirmed = lh.lastAddPushed = lastConfirmed;
                        openComplete(BKException.Code.OK, lh);
                    }
```

### NestedAssignment
Result of assignment expression used
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerRecoveryOp.java`
#### Snippet
```java
                                        .getKey();

                                lh.lastAddPushed = lh.lastAddConfirmed = Math.max(data.getLastAddConfirmed(),
                                        (lastEnsembleEntryId - 1));

                                lh.length = data.getLength();
```

### NestedAssignment
Result of assignment expression used
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerRecoveryOp.java`
#### Snippet
```java
                                lh.length = data.getLength();
                                lh.pendingAddsSequenceHead = lh.lastAddConfirmed;
                                startEntryToRead = endEntryToRead = lh.lastAddConfirmed;
                            }
                            // keep a copy of ledger metadata before proceeding
```

### NestedAssignment
Result of assignment expression used
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ListenerBasedPendingReadOp.java`
#### Snippet
```java
    protected void submitCallback(int code) {
        LedgerEntryRequest request;
        while (!seq.isEmpty() && (request = seq.getFirst()) != null) {
            if (!request.isComplete()) {
                return;
```

### NestedAssignment
Result of assignment expression used
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
        PendingAddOp pendingAddOp;

        while ((pendingAddOp = pendingAddOps.peek()) != null
               && !changingEnsemble) {
            if (!pendingAddOp.completed) {
```

### NestedAssignment
Result of assignment expression used
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
                LedgerMetadata metadata = versionedMetadata.getValue();
                if (metadata.isClosed()) {
                    lastAddConfirmed = lastAddPushed = metadata.getLastEntryId();
                    length = metadata.getLength();
                }
```

### NestedAssignment
Result of assignment expression used
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
        PendingAddOp pendingAddOp;
        List<PendingAddOp> opsDrained = new ArrayList<PendingAddOp>(pendingAddOps.size());
        while ((pendingAddOp = pendingAddOps.poll()) != null) {
            addToLength(-pendingAddOp.entryLength);
            opsDrained.add(pendingAddOp);
```

### NestedAssignment
Result of assignment expression used
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
        LedgerMetadata metadata = versionedMetadata.getValue();
        if (metadata.isClosed()) {
            lastAddConfirmed = lastAddPushed = metadata.getLastEntryId();
            length = metadata.getLength();
        } else {
```

### NestedAssignment
Result of assignment expression used
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
            length = metadata.getLength();
        } else {
            lastAddConfirmed = lastAddPushed = INVALID_ENTRY_ID;
            length = 0;
        }
```

### NestedAssignment
Result of assignment expression used
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java

                        // taking the length must occur after draining, as draining changes the length
                        lastEntry = lastAddPushed = LedgerHandle.this.lastAddConfirmed;
                        finalLength = LedgerHandle.this.length;
                        handleState = HandleState.CLOSED;
```

### NestedAssignment
Result of assignment expression used
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
            final long deadline = startTime + TimeUnit.MILLISECONDS.toNanos(durationMs);

            while (!(writableResult = isWriteSetWritable(writeSet, allowedNonWritableCount))) {
                if (MathUtils.nowInNano() < deadline) {
                    long maxSleep = MathUtils.elapsedMSec(startTime);
```

### NestedAssignment
Result of assignment expression used
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/helpers/KeyStream.java`
#### Snippet
```java
                lkey = lastKey;
                if (kvs.size() > 0) {
                    lastKey = nextKey = kvs.get(kvs.size() - 1).getKey();
                }
            }
```

### NestedAssignment
Result of assignment expression used
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/helpers/ValueStream.java`
#### Snippet
```java
    public CompletableFuture<EtcdWatcher> waitUntilWatched() {
        CompletableFuture<EtcdWatcher> wf;
        while ((wf = getWatchFuture()) == null) {
            try {
                TimeUnit.MILLISECONDS.sleep(100);
```

### NestedAssignment
Result of assignment expression used
in `cpu-affinity/src/main/java/org/apache/bookkeeper/common/util/affinity/impl/NativeUtils.java`
#### Snippet
```java
            }

            while ((read = input.read(buffer)) != -1) {
                out.write(buffer, 0, read);
            }
```

### NestedAssignment
Result of assignment expression used
in `circe-checksum/src/main/java/com/scurrilous/circe/utils/NativeUtils.java`
#### Snippet
```java
            OutputStream out = new FileOutputStream(temp);
            try {
                while ((read = input.read(buffer)) != -1) {
                    out.write(buffer, 0, read);
                }
```

### NestedAssignment
Result of assignment expression used
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKSyncLogReader.java`
#### Snippet
```java
                return closeFuture;
            }
            closeFuture = closePromise = new CompletableFuture<Void>();
            releaseCurrentEntry();
        }
```

### NestedAssignment
Result of assignment expression used
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAbstractLogWriter.java`
#### Snippet
```java
                return closePromise;
            }
            closeFuture = closePromise = new CompletableFuture<Void>();
        }
        cancelTruncation();
```

### NestedAssignment
Result of assignment expression used
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAbstractLogWriter.java`
#### Snippet
```java
                return closePromise;
            }
            closeFuture = closePromise = new CompletableFuture<Void>();
        }
        cancelTruncation();
```

### NestedAssignment
Result of assignment expression used
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAsyncLogReader.java`
#### Snippet
```java
                return closeFuture;
            }
            closePromise = closeFuture = new CompletableFuture<Void>();
            exception = new ReadCancelledException(readHandler.getFullyQualifiedName(), "Reader was closed");
            setLastException(exception);
```

### NestedAssignment
Result of assignment expression used
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAsyncLogReader.java`
#### Snippet
```java

        if (null == readAheadReader) {
            final ReadAheadEntryReader readAheadEntryReader = this.readAheadReader = new ReadAheadEntryReader(
                    getStreamName(),
                    getStartDLSN(),
                    bkDistributedLogManager.getConf(),
                    readHandler,
                    bkDistributedLogManager.getReaderEntryStore(),
                    bkDistributedLogManager.getScheduler(),
                    Ticker.systemTicker(),
                    bkDistributedLogManager.alertStatsLogger);
            readHandler.checkLogStreamExists().whenComplete(new FutureEventListener<Void>() {
                @Override
```

### NestedAssignment
Result of assignment expression used
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/ReadAheadEntryReader.java`
#### Snippet
```java
                                AlertStatsLogger alertStatsLogger) {
        this.streamName = streamName;
        this.fromDLSN = lastDLSN = fromDLSN;
        this.nextEntryPosition = new EntryPosition(
                fromDLSN.getLogSegmentSequenceNo(),
```

### NestedAssignment
Result of assignment expression used
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/ReadAheadEntryReader.java`
#### Snippet
```java
                return closePromise;
            }
            closePromise = closeFuture = new CompletableFuture<Void>();
        }

```

### NestedAssignment
Result of assignment expression used
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogSegmentWriter.java`
#### Snippet
```java
                return closeFuture;
            }
            closePromise = closeFuture = new CompletableFuture<Void>();
        }

```

### NestedAssignment
Result of assignment expression used
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/ZKMetadataAccessor.java`
#### Snippet
```java
                return closePromise;
            }
            closeFuture = closePromise = new CompletableFuture<Void>();
        }
        // NOTE: ownWriterZKC and ownReaderZKC are mostly used by tests
```

### NestedAssignment
Result of assignment expression used
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/logsegment/BKLogSegmentRandomAccessEntryReader.java`
#### Snippet
```java
                return closePromise;
            }
            closeFuture = closePromise = new CompletableFuture<Void>();
        }
        FutureUtils.proxyTo(
```

### NestedAssignment
Result of assignment expression used
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/logsegment/BKLogSegmentEntryReader.java`
#### Snippet
```java
                return closePromise;
            }
            closeFuture = closePromise = new CompletableFuture<Void>();
            lhsToClose = openLedgerHandles.toArray(new LedgerHandle[openLedgerHandles.size()]);
            // set the exception to cancel pending and subsequent reads
```

### NestedAssignment
Result of assignment expression used
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKDistributedLogManager.java`
#### Snippet
```java
                return closePromise;
            }
            closeFuture = closePromise = new CompletableFuture<Void>();
            readHandlerToClose = readHandlerForListener;
        }
```

### NestedAssignment
Result of assignment expression used
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/lock/ZKDistributedLock.java`
#### Snippet
```java
            }
            closed = true;
            closeFuture = closePromise = new CompletableFuture<Void>();
        }
        final CompletableFuture<Void> closeWaiterFuture = new CompletableFuture<Void>();
```

### NestedAssignment
Result of assignment expression used
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/lock/ZKDistributedLock.java`
#### Snippet
```java
            }
            LOG.info("reacquiring lock at {}", lockPath);
            lockReacquireFuture = lockPromise = new CompletableFuture<ZKDistributedLock>();
            lockReacquireFuture.whenComplete(new FutureEventListener<ZKDistributedLock>() {
                @Override
```

### NestedAssignment
Result of assignment expression used
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/metadata/DLMetadata.java`
#### Snippet
```java
        StringBuilder sb = new StringBuilder();
        String line;
        while (null != (line = br.readLine())) {
            sb.append(line);
        }
```

### NestedAssignment
Result of assignment expression used
in `stream/common/src/main/java/org/apache/bookkeeper/common/util/AbstractAutoAsyncCloseable.java`
#### Snippet
```java
                return closeFuture;
            }
            closeFuture = savedFuture = FutureUtils.createFuture();
        }
        closeAsyncOnce(savedFuture);
```

### NestedAssignment
Result of assignment expression used
in `native-io/src/main/java/org/apache/bookkeeper/common/util/nativeio/NativeUtils.java`
#### Snippet
```java
            }

            while ((read = input.read(buffer)) != -1) {
                out.write(buffer, 0, read);
            }
```

### NestedAssignment
Result of assignment expression used
in `bookkeeper-benchmark/src/main/java/org/apache/bookkeeper/benchmark/BenchThroughputLatency.java`
#### Snippet
```java
    public void run() {
        LOG.info("Running...");
        long start = previous = System.currentTimeMillis();

        int sent = 0;
```

### NestedAssignment
Result of assignment expression used
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                            new FileInputStream(new File(cmdline.getOptionValue("lf"))), UTF_8.name()));
                    String line;
                    while ((line = br.readLine()) != null) {
                        ledgers.add(Long.parseLong(line));
                    }
```

### NestedAssignment
Result of assignment expression used
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/journal/AbstractStateStoreWithJournal.java`
#### Snippet
```java
                return closeFuture;
            }
            closeFuture = future = FutureUtils.createFuture();
        }

```

### NestedAssignment
Result of assignment expression used
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/collections/BlockingMpscQueue.java`
#### Snippet
```java

        T t;
        while (items < array.length && (t = poll()) != null) {
            array[items++] = t;
        }
```

### NestedAssignment
Result of assignment expression used
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/collections/BlockingMpscQueue.java`
#### Snippet
```java

        T t;
        while (items < array.length && (t = poll()) != null) {
            array[items++] = t;
        }
```

### NestedAssignment
Result of assignment expression used
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/collections/BlockingMpscQueue.java`
#### Snippet
```java
        }

        if (items == 0 && (t = poll(timeout, unit)) != null) {
            array[items++] = t;
        }
```

## RuleId[id=ReplaceAssignmentWithOperatorAssignment]
### ReplaceAssignmentWithOperatorAssignment
`metadata = metadata | LOGRECORD_FLAGS_END_OF_STREAM` could be simplified to 'metadata \|= LOGRECORD_FLAGS_END_OF_STREAM'
in `stream/distributedlog/protocol/src/main/java/org/apache/distributedlog/LogRecord.java`
#### Snippet
```java
     */
    void setEndOfStream() {
        metadata = metadata | LOGRECORD_FLAGS_END_OF_STREAM;
    }

```

### ReplaceAssignmentWithOperatorAssignment
`metadata = metadata | LOGRECORD_FLAGS_CONTROL_MESSAGE` could be simplified to 'metadata \|= LOGRECORD_FLAGS_CONTROL_MESSAGE'
in `stream/distributedlog/protocol/src/main/java/org/apache/distributedlog/LogRecord.java`
#### Snippet
```java
    @VisibleForTesting
    public void setControl() {
        metadata = metadata | LOGRECORD_FLAGS_CONTROL_MESSAGE;
    }

```

### ReplaceAssignmentWithOperatorAssignment
`metadata = metadata | LOGRECORD_FLAGS_RECORD_SET` could be simplified to 'metadata \|= LOGRECORD_FLAGS_RECORD_SET'
in `stream/distributedlog/protocol/src/main/java/org/apache/distributedlog/LogRecord.java`
#### Snippet
```java
     */
    public void setRecordSet() {
        metadata = metadata | LOGRECORD_FLAGS_RECORD_SET;
    }

```

### ReplaceAssignmentWithOperatorAssignment
`numRanges = numRanges + 1` could be simplified to 'numRanges += 1'
in `stream/proto/src/main/java/org/apache/bookkeeper/stream/protocol/util/ProtoUtils.java`
#### Snippet
```java
        int numRanges = Math.max(2, numInitialRanges);
        if (numRanges % 2 != 0) { // round up to odd number
            numRanges = numRanges + 1;
        }
        long rangeSize = Long.MAX_VALUE / (numRanges / 2);
```

### ReplaceAssignmentWithOperatorAssignment
`count = count + numOfLeaves` could be simplified to 'count += numOfLeaves'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NetworkTopologyImpl.java`
#### Snippet
```java
                        } else {
                            // go to the next child
                            count = count + numOfLeaves;
                        }
                    } else { // it is the excluededNode
```

### ReplaceAssignmentWithOperatorAssignment
`d = d / 1000` could be simplified to 'd /= 1000'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookies/InfoCommand.java`
#### Snippet
```java
        double d = val;
        while (d >= 1000 && cnt < unit.length - 1) {
            d = d / 1000;
            cnt++;
        }
```

### ReplaceAssignmentWithOperatorAssignment
`logId = logId + 1` could be simplified to 'logId += 1'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Journal.java`
#### Snippet
```java
                if (null == logFile) {

                    logId = logId + 1;
                    journalIds = listJournalIds(journalDirectory, null);
                    Long replaceLogId = fileChannelProvider.supportReuseFile() && journalReuseFiles
```

### ReplaceAssignmentWithOperatorAssignment
`size = size - size % LedgerEntryPage.getIndexEntrySize()` could be simplified to 'size -= size % LedgerEntryPage.getIndexEntrySize()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/IndexPersistenceMgr.java`
#### Snippet
```java
            if (0 != size % LedgerEntryPage.getIndexEntrySize()) {
                LOG.warn("Index file of ledger {} is not aligned with index entry size.", ledgerId);
                size = size - size % LedgerEntryPage.getIndexEntrySize();
            }
            // we may not have the last entry in the cache
```

### ReplaceAssignmentWithOperatorAssignment
`flags = flags & ~value` could be simplified to 'flags \&= \~value'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/SingleDirectoryDbLedgerStorage.java`
#### Snippet
```java
                flagsEnum.add(e.getKey());
            }
            flags = flags & ~value;
        }
        checkState(flags == 0, "Unknown storage state flag found " + flags);
```

### ReplaceAssignmentWithOperatorAssignment
`endEntryToRead = endEntryToRead + clientCtx.getConf().recoveryReadBatchSize` could be simplified to 'endEntryToRead += clientCtx.getConf().recoveryReadBatchSize'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerRecoveryOp.java`
#### Snippet
```java
        if (!promise.isDone()) {
            startEntryToRead = endEntryToRead + 1;
            endEntryToRead = endEntryToRead + clientCtx.getConf().recoveryReadBatchSize;
            new RecoveryReadOp(lh, clientCtx, startEntryToRead, endEntryToRead, this, null)
                .initiate();
```

### ReplaceAssignmentWithOperatorAssignment
`d = d / 1000` could be simplified to 'd /= 1000'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/http/service/ListBookieInfoService.java`
#### Snippet
```java
        double d = val;
        while (d >= 1000 && cnt < unit.length - 1) {
            d = d / 1000;
            cnt++;
        }
```

### ReplaceAssignmentWithOperatorAssignment
`k = k << 8` could be simplified to 'k \<\<= 8'
in `stream/common/src/main/java/org/apache/bookkeeper/common/hash/MurmurHash.java`
#### Snippet
```java
            int i4 = i << 2;
            int k = data.getByte(offset + i4 + 3);
            k = k << 8;
            k = k | (data.getByte(offset + i4 + 2) & 0xff);
            k = k << 8;
```

### ReplaceAssignmentWithOperatorAssignment
`k = k | (data.getByte(offset + i4 + 2) & 0xff)` could be simplified to 'k \|= (data.getByte(offset + i4 + 2) \& 0xff)'
in `stream/common/src/main/java/org/apache/bookkeeper/common/hash/MurmurHash.java`
#### Snippet
```java
            int k = data.getByte(offset + i4 + 3);
            k = k << 8;
            k = k | (data.getByte(offset + i4 + 2) & 0xff);
            k = k << 8;
            k = k | (data.getByte(offset + i4 + 1) & 0xff);
```

### ReplaceAssignmentWithOperatorAssignment
`k = k << 8` could be simplified to 'k \<\<= 8'
in `stream/common/src/main/java/org/apache/bookkeeper/common/hash/MurmurHash.java`
#### Snippet
```java
            k = k << 8;
            k = k | (data.getByte(offset + i4 + 2) & 0xff);
            k = k << 8;
            k = k | (data.getByte(offset + i4 + 1) & 0xff);
            k = k << 8;
```

### ReplaceAssignmentWithOperatorAssignment
`k = k | (data.getByte(offset + i4 + 1) & 0xff)` could be simplified to 'k \|= (data.getByte(offset + i4 + 1) \& 0xff)'
in `stream/common/src/main/java/org/apache/bookkeeper/common/hash/MurmurHash.java`
#### Snippet
```java
            k = k | (data.getByte(offset + i4 + 2) & 0xff);
            k = k << 8;
            k = k | (data.getByte(offset + i4 + 1) & 0xff);
            k = k << 8;
            k = k | (data.getByte(offset + i4 + 0) & 0xff);
```

### ReplaceAssignmentWithOperatorAssignment
`k = k << 8` could be simplified to 'k \<\<= 8'
in `stream/common/src/main/java/org/apache/bookkeeper/common/hash/MurmurHash.java`
#### Snippet
```java
            k = k << 8;
            k = k | (data.getByte(offset + i4 + 1) & 0xff);
            k = k << 8;
            k = k | (data.getByte(offset + i4 + 0) & 0xff);
            k *= m;
```

### ReplaceAssignmentWithOperatorAssignment
`k = k | (data.getByte(offset + i4 + 0) & 0xff)` could be simplified to 'k \|= (data.getByte(offset + i4 + 0) \& 0xff)'
in `stream/common/src/main/java/org/apache/bookkeeper/common/hash/MurmurHash.java`
#### Snippet
```java
            k = k | (data.getByte(offset + i4 + 1) & 0xff);
            k = k << 8;
            k = k | (data.getByte(offset + i4 + 0) & 0xff);
            k *= m;
            k ^= k >>> r;
```

## RuleId[id=SimplifiableBooleanExpression]
### SimplifiableBooleanExpression
`(null != client && isRecoverableException(e)) || null == client` can be simplified to 'null == client\|\|isRecoverableException(e)'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/zookeeper/ZooWorker.java`
#### Snippet
```java
                boolean rethrow = true;
                long elapsedTime = MathUtils.elapsedMSec(startTimeNanos);
                if (((null != client && isRecoverableException(e)) || null == client)
                    && retryPolicy.allowRetry(attempts, elapsedTime)) {
                    rethrow = false;
```

## RuleId[id=MismatchedCollectionQueryUpdate]
### MismatchedCollectionQueryUpdate
Contents of collection `batchedArrayBlockingQueue` are updated, but never queried
in `microbenchmarks/src/main/java/org/apache/bookkeeper/common/MpScQueueBenchmark.java`
#### Snippet
```java
        private ArrayBlockingQueue arrayBlockingQueue = new ArrayBlockingQueue<>(QUEUE_SIZE);

        private BatchedArrayBlockingQueue batchedArrayBlockingQueue = new BatchedArrayBlockingQueue<>(QUEUE_SIZE);

        private final Integer[] batchArray = new Integer[1000];
```

### MismatchedCollectionQueryUpdate
Contents of collection `EMPTY_PAGE_MAP` are queried, but never updated
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/IndexInMemPageMgr.java`
#### Snippet
```java
class IndexInMemPageMgr {
    private static final Logger LOG = LoggerFactory.getLogger(IndexInMemPageMgr.class);
    private static final ConcurrentHashMap<Long, LedgerEntryPage> EMPTY_PAGE_MAP =
            new ConcurrentHashMap<Long, LedgerEntryPage>();

```

### MismatchedCollectionQueryUpdate
Contents of collection `tmpDirs` are queried, but never updated
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LocalDLMEmulator.java`
#### Snippet
```java
    private final String zkEnsemble;
    private final URI uri;
    private final List<File> tmpDirs = new ArrayList<File>();
    private final int zkTimeoutSec;
    private final Thread bkStartupThread;
```

### MismatchedCollectionQueryUpdate
Contents of collection `streams` are queried, but never updated
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/ZKLogMetadataStore.java`
#### Snippet
```java
                                    promise.complete(results.iterator());
                                } else if (KeeperException.Code.NONODE.intValue() == rc) {
                                    List<String> streams = Lists.newLinkedList();
                                    promise.complete(streams.iterator());
                                } else {
```

### MismatchedCollectionQueryUpdate
Contents of collection `streams` are queried, but never updated
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/ZKLogMetadataStore.java`
#### Snippet
```java
                        }, null);
                    } else if (KeeperException.Code.NONODE.intValue() == syncRc) {
                        List<String> streams = Lists.newLinkedList();
                        promise.complete(streams.iterator());
                    } else {
```

### MismatchedCollectionQueryUpdate
Contents of collection `subscriptions` are updated, but never queried
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/config/DynamicConfigurationFactory.java`
#### Snippet
```java

    private final Map<String, DynamicDistributedLogConfiguration> dynamicConfigs;
    private final List<ConfigurationSubscription> subscriptions;
    private final ScheduledExecutorService executorService;
    private final int reloadPeriod;
```

## RuleId[id=FieldAccessedSynchronizedAndUnsynchronized]
### FieldAccessedSynchronizedAndUnsynchronized
Field `scInfo` is accessed in both synchronized and unsynchronized contexts
in `stream/clients/java/base/src/main/java/org/apache/bookkeeper/clients/impl/container/StorageContainerChannel.java`
#### Snippet
```java

    @GuardedBy("this")
    private StorageContainerInfo scInfo = null;
    @GuardedBy("this")
    private CompletableFuture<StorageServerChannel> rsChannelFuture = null;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `bookieAddressResolver` is accessed in both synchronized and unsynchronized contexts
in `stream/bk-grpc-name-resolver/src/main/java/org/apache/bookkeeper/grpc/resolver/BKRegistrationNameResolver.java`
#### Snippet
```java
    private boolean shutdown;
    private boolean resolving;
    private BookieAddressResolver bookieAddressResolver;

    BKRegistrationNameResolver(MetadataClientDriver clientDriver,
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `count` is accessed in both synchronized and unsynchronized contexts
in `stream/distributedlog/protocol/src/main/java/org/apache/distributedlog/EnvelopedRecordSetWriter.java`
#### Snippet
```java
    private final int metadata;
    private final int codecCode;
    private int count = 0;
    private ByteBuf recordSetBuffer = null;

```

### FieldAccessedSynchronizedAndUnsynchronized
Field `timers` is accessed in both synchronized and unsynchronized contexts
in `microbenchmarks/src/main/java/org/apache/bookkeeper/stats/codahale/TimerBenchmark.java`
#### Snippet
```java
        public int timersPerThread;

        private static OpStatsLogger[] timers;
        private int timerIdx = 0;

```

### FieldAccessedSynchronizedAndUnsynchronized
Field `times` is accessed in both synchronized and unsynchronized contexts
in `microbenchmarks/src/main/java/org/apache/bookkeeper/stats/codahale/TimerBenchmark.java`
#### Snippet
```java
        private int timerIdx = 0;

        private static long[] times;
        private int timeIdx = 0;

```

### FieldAccessedSynchronizedAndUnsynchronized
Field `servingState` is accessed in both synchronized and unsynchronized contexts
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/metadata/stream/MetaRangeImpl.java`
#### Snippet
```java
    private StreamProperties streamProps;
    private LifecycleState lifecycleState = LifecycleState.UNINIT;
    private ServingState servingState = ServingState.WRITABLE;
    private long cTime = 0L;
    private long mTime = 0L;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `nextRangeId` is accessed in both synchronized and unsynchronized contexts
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/metadata/stream/MetaRangeImpl.java`
#### Snippet
```java
    private long mTime = 0L;

    private long nextRangeId = MIN_DATA_RANGE_ID;
    /**
     * All the ranges in the stream.
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `streamId` is accessed in both synchronized and unsynchronized contexts
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/metadata/stream/MetaRangeImpl.java`
#### Snippet
```java

    @GuardedBy("this")
    private long streamId;
    @GuardedBy("this")
    private StreamProperties streamProps;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `cTime` is accessed in both synchronized and unsynchronized contexts
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/metadata/stream/MetaRangeImpl.java`
#### Snippet
```java
    private LifecycleState lifecycleState = LifecycleState.UNINIT;
    private ServingState servingState = ServingState.WRITABLE;
    private long cTime = 0L;
    private long mTime = 0L;

```

### FieldAccessedSynchronizedAndUnsynchronized
Field `lifecycleState` is accessed in both synchronized and unsynchronized contexts
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/metadata/stream/MetaRangeImpl.java`
#### Snippet
```java
    @GuardedBy("this")
    private StreamProperties streamProps;
    private LifecycleState lifecycleState = LifecycleState.UNINIT;
    private ServingState servingState = ServingState.WRITABLE;
    private long cTime = 0L;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `mTime` is accessed in both synchronized and unsynchronized contexts
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/metadata/stream/MetaRangeImpl.java`
#### Snippet
```java
    private ServingState servingState = ServingState.WRITABLE;
    private long cTime = 0L;
    private long mTime = 0L;

    private long nextRangeId = MIN_DATA_RANGE_ID;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `allocator` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tls/TLSContextFactory.java`
#### Snippet
```java
    private String[] ciphers;
    private volatile SslContext sslContext;
    private ByteBufAllocator allocator;
    private AbstractConfiguration config;
    private FileModifiedTimeUpdater tlsCertificateFilePath, tlsKeyStoreFilePath, tlsKeyStorePasswordFilePath,
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `config` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tls/TLSContextFactory.java`
#### Snippet
```java
    private volatile SslContext sslContext;
    private ByteBufAllocator allocator;
    private AbstractConfiguration config;
    private FileModifiedTimeUpdater tlsCertificateFilePath, tlsKeyStoreFilePath, tlsKeyStorePasswordFilePath,
            tlsTrustStoreFilePath, tlsTrustStorePasswordFilePath;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `type` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tls/TLSContextFactory.java`
#### Snippet
```java

    private static final String TLSCONTEXT_HANDLER_NAME = "tls";
    private NodeType type;
    private String[] protocols;
    private String[] ciphers;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `ciphers` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tls/TLSContextFactory.java`
#### Snippet
```java
    private NodeType type;
    private String[] protocols;
    private String[] ciphers;
    private volatile SslContext sslContext;
    private ByteBufAllocator allocator;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `protocols` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tls/TLSContextFactory.java`
#### Snippet
```java
    private static final String TLSCONTEXT_HANDLER_NAME = "tls";
    private NodeType type;
    private String[] protocols;
    private String[] ciphers;
    private volatile SslContext sslContext;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `ledgerIdGenPath` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/LongZkLedgerIdGenerator.java`
#### Snippet
```java
    private static final Logger LOG = LoggerFactory.getLogger(LongZkLedgerIdGenerator.class);
    private ZooKeeper zk;
    private String ledgerIdGenPath;
    private ZkLedgerIdGenerator shortIdGen;
    private List<String> highOrderDirectories;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `lmFactory` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/zk/ZKMetadataDriverBase.java`
#### Snippet
```java
    // managers
    protected LayoutManager layoutManager;
    protected LedgerManagerFactory lmFactory;

    public String getScheme() {
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `layoutManager` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/zk/ZKMetadataDriverBase.java`
#### Snippet
```java

    // managers
    protected LayoutManager layoutManager;
    protected LedgerManagerFactory lmFactory;

```

### FieldAccessedSynchronizedAndUnsynchronized
Field `conf` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/zk/ZKMetadataDriverBase.java`
#### Snippet
```java

    // URI
    protected AbstractConfiguration<?> conf;
    protected StatsLogger statsLogger;

```

### FieldAccessedSynchronizedAndUnsynchronized
Field `getLinkCountCommand` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/HardLink.java`
#### Snippet
```java
    private static String[] hardLinkMultPrefix = {"ln"};
    private static String[] hardLinkMultSuffix = {null};
    private static String[] getLinkCountCommand = {"stat", "-c%h", null};
    //Unix guarantees at least 32K bytes cmd length.
    //Subtract another 64b to allow for Java 'exec' overhead
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `numSuccessOps` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BKStats.java`
#### Snippet
```java
        long minLatency = Long.MAX_VALUE;
        double totalLatency = 0.0f;
        long numSuccessOps = 0;
        long numFailedOps = 0;
        long[] latencyBuckets = new long[NUM_BUCKETS];
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `maxLatency` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BKStats.java`
#### Snippet
```java
        static final int NUM_BUCKETS = 3 * 9 + 2;

        long maxLatency = 0;
        long minLatency = Long.MAX_VALUE;
        double totalLatency = 0.0f;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `numFailedOps` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BKStats.java`
#### Snippet
```java
        double totalLatency = 0.0f;
        long numSuccessOps = 0;
        long numFailedOps = 0;
        long[] latencyBuckets = new long[NUM_BUCKETS];

```

### FieldAccessedSynchronizedAndUnsynchronized
Field `totalLatency` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BKStats.java`
#### Snippet
```java
        long maxLatency = 0;
        long minLatency = Long.MAX_VALUE;
        double totalLatency = 0.0f;
        long numSuccessOps = 0;
        long numFailedOps = 0;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `minLatency` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BKStats.java`
#### Snippet
```java

        long maxLatency = 0;
        long minLatency = Long.MAX_VALUE;
        double totalLatency = 0.0f;
        long numSuccessOps = 0;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `latencyBuckets` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BKStats.java`
#### Snippet
```java
        long numSuccessOps = 0;
        long numFailedOps = 0;
        long[] latencyBuckets = new long[NUM_BUCKETS];

        OpStats() {}
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `ctx` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieRequestHandler.java`
#### Snippet
```java
    private final ChannelGroup allChannels;

    private ChannelHandlerContext ctx;

    private ByteBuf pendingSendResponses = null;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `ctx` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/AuthHandler.java`
#### Snippet
```java

        class AuthHandshakeCompleteCallback implements AuthCallbacks.GenericCallback<Void> {
            ChannelHandlerContext ctx;

            AuthHandshakeCompleteCallback(ChannelHandlerContext ctx) {
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `allChannels` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieNettyServer.java`
#### Snippet
```java
    final Object suspensionLock = new Object();
    volatile boolean suspended = false;
    ChannelGroup allChannels;
    final BookieSocketAddress bookieAddress;
    final BookieId bookieId;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `uncleanShutdownDetection` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieServer.java`
#### Snippet
```java
    private final Bookie bookie;
    DeathWatcher deathWatcher;
    UncleanShutdownDetection uncleanShutdownDetection;
    private static final Logger LOG = LoggerFactory.getLogger(BookieServer.class);

```

### FieldAccessedSynchronizedAndUnsynchronized
Field `nettyServer` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieServer.java`
#### Snippet
```java
public class BookieServer {
    final ServerConfiguration conf;
    BookieNettyServer nettyServer;
    private volatile boolean running = false;
    private final Bookie bookie;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `exitCode` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieServer.java`
#### Snippet
```java
    private static final Logger LOG = LoggerFactory.getLogger(BookieServer.class);

    int exitCode = ExitCode.OK;

    // request processor
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `requestProcessor` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PacketProcessorBase.java`
#### Snippet
```java
    T request;
    BookieRequestHandler requestHandler;
    BookieRequestProcessor requestProcessor;
    long enqueueNanos;

```

### FieldAccessedSynchronizedAndUnsynchronized
Field `entryLogger` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookie/ReadLogMetadataCommand.java`
#### Snippet
```java
    private LedgerIdFormatter ledgerIdFormatter;

    EntryLogger entryLogger = null;

    public ReadLogMetadataCommand() {
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `entryLogger` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookie/ReadLogCommand.java`
#### Snippet
```java
    private static final Logger LOG = LoggerFactory.getLogger(ReadLogCommand.class);

    private EntryLogger entryLogger;
    private EntryFormatter entryFormatter;
    private LedgerIdFormatter ledgerIdFormatter;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `entryLogMetaMap` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/GarbageCollectorThread.java`
#### Snippet
```java

    // Maps entry log files to the set of ledgers that comprise the file and the size usage per ledger
    private EntryLogMetadataMap entryLogMetaMap;

    private final ScheduledExecutorService gcExecutor;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `preallocation` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryLoggerAllocator.java`
#### Snippet
```java

    private long preallocatedLogId;
    Future<BufferedLogChannel> preallocation = null;
    ExecutorService allocatorExecutor;
    private final ServerConfiguration conf;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `allocatorExecutor` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryLoggerAllocator.java`
#### Snippet
```java
    private long preallocatedLogId;
    Future<BufferedLogChannel> preallocation = null;
    ExecutorService allocatorExecutor;
    private final ServerConfiguration conf;
    private final LedgerDirsManager ledgerDirsManager;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `ledgerId` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LedgerDescriptorImpl.java`
#### Snippet
```java
    private static final Logger LOG = LoggerFactory.getLogger(LedgerDescriptorImpl.class);
    final LedgerStorage ledgerStorage;
    private long ledgerId;
    final byte[] masterKey;

```

### FieldAccessedSynchronizedAndUnsynchronized
Field `fenceEntryPersisted` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LedgerDescriptorImpl.java`
#### Snippet
```java
    final byte[] masterKey;

    private AtomicBoolean fenceEntryPersisted = new AtomicBoolean();
    private CompletableFuture<Boolean> logFenceResult = null;

```

### FieldAccessedSynchronizedAndUnsynchronized
Field `writeBufferStartPosition` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BufferedChannel.java`
#### Snippet
```java
     * The position of the file channel's write pointer.
     */
    protected AtomicLong writeBufferStartPosition = new AtomicLong(0);
    /**
     * The buffer used to write operations.
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `isClosed` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/FileInfo.java`
#### Snippet
```java
    static final long START_OF_DATA = 1024;
    private long size;
    private boolean isClosed;
    private long sizeSinceLastWrite;

```

### FieldAccessedSynchronizedAndUnsynchronized
Field `sizeSinceLastWrite` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/FileInfo.java`
#### Snippet
```java
    private long size;
    private boolean isClosed;
    private long sizeSinceLastWrite;

    // bit map for states of the ledger.
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `entryLogger` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieShell.java`
#### Snippet
```java
    File[] journalDirectories;

    EntryLogger entryLogger = null;
    List<Journal> journals = null;
    EntryFormatter entryFormatter;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `nextId` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/EntryLogIdsImpl.java`
#### Snippet
```java
    private final LedgerDirsManager ledgerDirsManager;
    private final Slogger slog;
    private int nextId;
    private int maxId;

```

### FieldAccessedSynchronizedAndUnsynchronized
Field `maxId` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/EntryLogIdsImpl.java`
#### Snippet
```java
    private final Slogger slog;
    private int nextId;
    private int maxId;

    public EntryLogIdsImpl(LedgerDirsManager ledgerDirsManager,
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `stateManager` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieImpl.java`
#### Snippet
```java
            ConcurrentLongHashMap.<byte[]>newBuilder().autoShrink(true).build();

    protected StateManager stateManager;

    // Expose Stats
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `dirsMonitor` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieImpl.java`
#### Snippet
```java
    protected final Supplier<BookieServiceInfo> bookieServiceInfoProvider;
    private final LedgerDirsManager indexDirsManager;
    LedgerDirsMonitor dirsMonitor;

    private int exitCode = ExitCode.OK;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `lastAccessed` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/TransientLedgerInfo.java`
#### Snippet
```java
    private final LedgerMetadataIndex ledgerIndex;

    private long lastAccessed;

    /**
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `readEntryStats` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectEntryLoggerStats.java`
#### Snippet
```java
              parent = BOOKIE_READ_ENTRY
    )
    private static ThreadLocal<OpStatsLogger> readEntryStats;

    @StatsDoc(
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `readBlockStats` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectEntryLoggerStats.java`
#### Snippet
```java
              help = "Stats for reading blocks from disk"
    )
    private static ThreadLocal<OpStatsLogger> readBlockStats;

    @StatsDoc(
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `currentBlock` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectReader.java`
#### Snippet
```java
    private final int maxSaneEntrySize;
    private final OpStatsLogger readBlockStats;
    private long currentBlock = -1;
    private long currentBlockEnd = -1;
    private long maxOffset;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `currentBlockEnd` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectReader.java`
#### Snippet
```java
    private final OpStatsLogger readBlockStats;
    private long currentBlock = -1;
    private long currentBlockEnd = -1;
    private long maxOffset;
    private boolean closed;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `maxOffset` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectReader.java`
#### Snippet
```java
    private long currentBlock = -1;
    private long currentBlockEnd = -1;
    private long maxOffset;
    private boolean closed;

```

### FieldAccessedSynchronizedAndUnsynchronized
Field `lh` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java`
#### Snippet
```java
    private final BitSet heardFromHostsBitSet;
    private final Set<BookieId> sentToHosts = new HashSet<BookieId>();
    LedgerHandle lh;
    final ClientContext clientCtx;

```

### FieldAccessedSynchronizedAndUnsynchronized
Field `errorCnt` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookieInfoReader.java`
#### Snippet
```java
    private int totalSent = 0;
    private int completedCnt = 0;
    private int errorCnt = 0;

    /**
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `versionedMetadata` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java

    final byte[] ledgerKey;
    private Versioned<LedgerMetadata> versionedMetadata;
    final long ledgerId;
    long lastAddPushed;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `handleState` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
    }

    private HandleState handleState = HandleState.OPEN;
    private final CompletableFuture<Void> closePromise = new CompletableFuture<>();

```

### FieldAccessedSynchronizedAndUnsynchronized
Field `pendingAddOps` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
    boolean changingEnsemble = false;
    final AtomicInteger numEnsembleChanges = new AtomicInteger(0);
    Queue<PendingAddOp> pendingAddOps;
    ExplicitLacFlushPolicy explicitLacFlushPolicy;

```

### FieldAccessedSynchronizedAndUnsynchronized
Field `changingEnsemble` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java

    final Object metadataLock = new Object();
    boolean changingEnsemble = false;
    final AtomicInteger numEnsembleChanges = new AtomicInteger(0);
    Queue<PendingAddOp> pendingAddOps;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `entryId` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
    AddCallbackWithLatency cb;
    Object ctx;
    long entryId;
    int entryLength;

```

### FieldAccessedSynchronizedAndUnsynchronized
Field `allowFailFast` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
    boolean hasRun;
    EnumSet<WriteFlag> writeFlags;
    boolean allowFailFast = false;
    List<BookieId> ensemble;

```

### FieldAccessedSynchronizedAndUnsynchronized
Field `isRecoveryAdd` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
    LedgerHandle lh;
    ClientContext clientCtx;
    boolean isRecoveryAdd = false;
    volatile long requestTimeNanos;
    long qwcLatency; // Quorum Write Completion Latency after response from quorum bookies.
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `lh` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
    boolean completed = false;

    LedgerHandle lh;
    ClientContext clientCtx;
    boolean isRecoveryAdd = false;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `completed` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java

    DistributionSchedule.AckSet ackSet;
    boolean completed = false;

    LedgerHandle lh;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `currentLedgerLength` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
    long writeDelayedStartTime; // min fault domains completion latency after response from ack quorum bookies

    long currentLedgerLength;
    int pendingWriteRequests;
    boolean callbackTriggered;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `clientCtx` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java

    LedgerHandle lh;
    ClientContext clientCtx;
    boolean isRecoveryAdd = false;
    volatile long requestTimeNanos;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `ledgerUnderreplicationManager` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/Auditor.java`
#### Snippet
```java
    private BookieLedgerIndexer bookieLedgerIndexer;
    private LedgerManager ledgerManager;
    private LedgerUnderreplicationManager ledgerUnderreplicationManager;
    private final ScheduledExecutorService executor;
    private List<String> knownBookies = new ArrayList<String>();
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `auditorBookieCheckTask` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/Auditor.java`
#### Snippet
```java
    private final Set<String> bookiesToBeAudited = Sets.newHashSet();
    private volatile int lostBookieRecoveryDelayBeforeChange;
    protected AuditorBookieCheckTask auditorBookieCheckTask;
    protected AuditorTask auditorCheckAllLedgersTask;
    protected AuditorTask auditorPlacementPolicyCheckTask;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `knownBookies` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/Auditor.java`
#### Snippet
```java
    private LedgerUnderreplicationManager ledgerUnderreplicationManager;
    private final ScheduledExecutorService executor;
    private List<String> knownBookies = new ArrayList<String>();
    private final String bookieIdentifier;
    protected volatile Future<?> auditTask;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `layoutManager` is accessed in both synchronized and unsynchronized contexts
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdMetadataDriverBase.java`
#### Snippet
```java

    // managers
    protected LayoutManager layoutManager;
    protected LedgerManagerFactory lmFactory;

```

### FieldAccessedSynchronizedAndUnsynchronized
Field `client` is accessed in both synchronized and unsynchronized contexts
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdMetadataDriverBase.java`
#### Snippet
```java

    // service uri
    protected Client client;
    protected String keyPrefix;

```

### FieldAccessedSynchronizedAndUnsynchronized
Field `conf` is accessed in both synchronized and unsynchronized contexts
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdMetadataDriverBase.java`
#### Snippet
```java
    static final String SCHEME = "etcd";

    protected AbstractConfiguration<?> conf;
    protected StatsLogger statsLogger;

```

### FieldAccessedSynchronizedAndUnsynchronized
Field `bookieHttpServiceProvider` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-http/servlet-http-server/src/main/java/org/apache/bookkeeper/http/servlet/BookieServletHttpServer.java`
#### Snippet
```java
public class BookieServletHttpServer implements HttpServer {
  static final Logger LOG = LoggerFactory.getLogger(BookieServletHttpServer.class);
  private static HttpServiceProvider bookieHttpServiceProvider;
  private static int listenPort = -1;
  private static String listenHost = "0.0.0.0";
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `listenPort` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-http/servlet-http-server/src/main/java/org/apache/bookkeeper/http/servlet/BookieServletHttpServer.java`
#### Snippet
```java
  static final Logger LOG = LoggerFactory.getLogger(BookieServletHttpServer.class);
  private static HttpServiceProvider bookieHttpServiceProvider;
  private static int listenPort = -1;
  private static String listenHost = "0.0.0.0";

```

### FieldAccessedSynchronizedAndUnsynchronized
Field `version` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/metastore/InMemoryMetastoreTable.java`
#### Snippet
```java
     */
    public static class MetadataVersion implements Version {
        int version;

        public MetadataVersion(int v) {
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `scheduler` is accessed in both synchronized and unsynchronized contexts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/metastore/InMemoryMetastoreTable.java`
#### Snippet
```java
    private TreeMap<String, Versioned<Value>> map = null;
    private TreeMap<String, MetastoreWatcher> watcherMap = null;
    private ScheduledExecutorService scheduler;

    public InMemoryMetastoreTable(InMemoryMetaStore metastore, String name) {
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `lastTimeBucket` is accessed in both synchronized and unsynchronized contexts
in `stats/bookkeeper-stats-providers/codahale-metrics-provider/src/main/java/org/apache/bookkeeper/stats/codahale/FastTimer.java`
#### Snippet
```java
    private final Object[] locks; // indexed by [hash]
    private final int[] lastTime;
    private int lastTimeBucket = 0;

    private final int[][] meter;    // indexed by [hash][time]
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `readAheadReader` is accessed in both synchronized and unsynchronized contexts
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKSyncLogReader.java`
#### Snippet
```java

    // readahead reader
    ReadAheadEntryReader readAheadReader = null;

    // idle reader settings
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `minTimestampToKeepOverride` is accessed in both synchronized and unsynchronized contexts
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAbstractLogWriter.java`
#### Snippet
```java
    private CompletableFuture<List<LogSegmentMetadata>> lastTruncationAttempt = null;
    @VisibleForTesting
    private Long minTimestampToKeepOverride = null;

    // Log Segment Writers
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `writeHandler` is accessed in both synchronized and unsynchronized contexts
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAbstractLogWriter.java`
#### Snippet
```java
    protected CompletableFuture<BKLogSegmentWriter> segmentWriterFuture = null;
    protected BKLogSegmentWriter allocatedSegmentWriter = null;
    protected BKLogWriteHandler writeHandler = null;

    BKAbstractLogWriter(DistributedLogConfiguration conf,
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `lastTruncationAttempt` is accessed in both synchronized and unsynchronized contexts
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAbstractLogWriter.java`
#### Snippet
```java

    // Truncation Related
    private CompletableFuture<List<LogSegmentMetadata>> lastTruncationAttempt = null;
    @VisibleForTesting
    private Long minTimestampToKeepOverride = null;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `forceRecovery` is accessed in both synchronized and unsynchronized contexts
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAbstractLogWriter.java`
#### Snippet
```java
    private CompletableFuture<Void> closePromise = null;
    private volatile boolean forceRolling = false;
    private boolean forceRecovery = false;

    // Truncation Related
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `lockStream` is accessed in both synchronized and unsynchronized contexts
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAsyncLogReader.java`
#### Snippet
```java
    protected CompletableFuture<Void> closeFuture = null;

    private boolean lockStream = false;

    private final boolean returnEndOfStreamRecord;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `pendingRequests` is accessed in both synchronized and unsynchronized contexts
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAsyncLogWriter.java`
#### Snippet
```java
    private final boolean streamFailFast;
    private final boolean disableRollOnSegmentError;
    private LinkedList<PendingLogRecord> pendingRequests = null;
    private volatile boolean encounteredError = false;
    private final AtomicReference<Throwable> firstEncounteredError = new AtomicReference<>(null);
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `rollingFuture` is accessed in both synchronized and unsynchronized contexts
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAsyncLogWriter.java`
#### Snippet
```java
    private volatile boolean encounteredError = false;
    private final AtomicReference<Throwable> firstEncounteredError = new AtomicReference<>(null);
    private CompletableFuture<BKLogSegmentWriter> rollingFuture = null;
    private long lastTxId = DistributedLogConstants.INVALID_TXID;

```

### FieldAccessedSynchronizedAndUnsynchronized
Field `entryId` is accessed in both synchronized and unsynchronized contexts
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/EntryPosition.java`
#### Snippet
```java

    private long lssn;
    private long entryId;

    EntryPosition(long lssn, long entryId) {
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `lssn` is accessed in both synchronized and unsynchronized contexts
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/EntryPosition.java`
#### Snippet
```java
class EntryPosition {

    private long lssn;
    private long entryId;

```

### FieldAccessedSynchronizedAndUnsynchronized
Field `readLock` is accessed in both synchronized and unsynchronized contexts
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogReadHandler.java`
#### Snippet
```java

    private final Optional<String> subscriberId;
    private DistributedLock readLock;
    private CompletableFuture<Void> lockAcquireFuture;

```

### FieldAccessedSynchronizedAndUnsynchronized
Field `minDelayBetweenImmediateFlushMs` is accessed in both synchronized and unsynchronized contexts
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogSegmentWriter.java`
#### Snippet
```java
    private volatile boolean controlFlushNeeded = false;
    private boolean immediateFlushEnabled = false;
    private int minDelayBetweenImmediateFlushMs = 0;
    private Stopwatch lastTransmit;
    private boolean streamEnded = false;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `enforceLock` is accessed in both synchronized and unsynchronized contexts
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogSegmentWriter.java`
#### Snippet
```java
            "scheduledFlushException");
    private volatile Exception scheduledFlushException = null;
    private boolean enforceLock = true;
    private CompletableFuture<Void> closeFuture = null;
    private final boolean enableRecordCounts;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `outstandingBytes` is accessed in both synchronized and unsynchronized contexts
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogSegmentWriter.java`
#### Snippet
```java
    private long lastTxId = INVALID_TXID;
    private long lastTxIdAcknowledged = INVALID_TXID;
    private long outstandingBytes = 0;
    private long numFlushesSinceRestart = 0;
    private long numBytes = 0;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `lastTransmit` is accessed in both synchronized and unsynchronized contexts
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogSegmentWriter.java`
#### Snippet
```java
    private boolean immediateFlushEnabled = false;
    private int minDelayBetweenImmediateFlushMs = 0;
    private Stopwatch lastTransmit;
    private boolean streamEnded = false;
    private final ScheduledFuture<?> periodicFlushSchedule;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `requestTimer` is accessed in both synchronized and unsynchronized contexts
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/BKNamespaceDriver.java`
#### Snippet
```java
    //       instantiating readers or writers.
    private EventLoopGroup eventLoopGroup;
    private HashedWheelTimer requestTimer;
    private BookKeeperClientBuilder sharedWriterBKCBuilder;
    private BookKeeperClient writerBKC;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `LOG` is accessed in both synchronized and unsynchronized contexts
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/BKNamespaceDriver.java`
#### Snippet
```java
public class BKNamespaceDriver implements NamespaceDriver {

    private static Logger LOG = LoggerFactory.getLogger(BKNamespaceDriver.class);

    // register itself
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `failureInjector` is accessed in both synchronized and unsynchronized contexts
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/BKNamespaceDriver.java`
#### Snippet
```java
    private OrderedScheduler scheduler;
    private FeatureProvider featureProvider;
    private AsyncFailureInjector failureInjector;
    private StatsLogger statsLogger;
    private StatsLogger perLogStatsLogger;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `sharedReaderZKCBuilder` is accessed in both synchronized and unsynchronized contexts
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/BKNamespaceDriver.java`
#### Snippet
```java
    private ZooKeeperClientBuilder sharedWriterZKCBuilder;
    private ZooKeeperClient writerZKC;
    private ZooKeeperClientBuilder sharedReaderZKCBuilder;
    private ZooKeeperClient readerZKC;
    // NOTE: The actual bookkeeper client is initialized lazily when it is referenced by
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `readerStreamMetadataStore` is accessed in both synchronized and unsynchronized contexts
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/BKNamespaceDriver.java`
#### Snippet
```java
    private LogMetadataStore metadataStore;
    private LogStreamMetadataStore writerStreamMetadataStore;
    private LogStreamMetadataStore readerStreamMetadataStore;

    //
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `allocator` is accessed in both synchronized and unsynchronized contexts
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/BKNamespaceDriver.java`
#### Snippet
```java

    // ledger allocator
    private LedgerAllocator allocator;

    // log segment entry stores
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `readerBKC` is accessed in both synchronized and unsynchronized contexts
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/BKNamespaceDriver.java`
#### Snippet
```java
    private BookKeeperClient writerBKC;
    private BookKeeperClientBuilder sharedReaderBKCBuilder;
    private BookKeeperClient readerBKC;

    // log stream metadata store
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `namespace` is accessed in both synchronized and unsynchronized contexts
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/BKNamespaceDriver.java`
#### Snippet
```java
    private DistributedLogConfiguration conf;
    private DynamicDistributedLogConfiguration dynConf;
    private URI namespace;
    private OrderedScheduler scheduler;
    private FeatureProvider featureProvider;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `conf` is accessed in both synchronized and unsynchronized contexts
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/BKNamespaceDriver.java`
#### Snippet
```java

    // resources (passed from initialization)
    private DistributedLogConfiguration conf;
    private DynamicDistributedLogConfiguration dynConf;
    private URI namespace;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `statsLogger` is accessed in both synchronized and unsynchronized contexts
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/BKNamespaceDriver.java`
#### Snippet
```java
    private FeatureProvider featureProvider;
    private AsyncFailureInjector failureInjector;
    private StatsLogger statsLogger;
    private StatsLogger perLogStatsLogger;
    private String clientId;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `writerBKC` is accessed in both synchronized and unsynchronized contexts
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/BKNamespaceDriver.java`
#### Snippet
```java
    private HashedWheelTimer requestTimer;
    private BookKeeperClientBuilder sharedWriterBKCBuilder;
    private BookKeeperClient writerBKC;
    private BookKeeperClientBuilder sharedReaderBKCBuilder;
    private BookKeeperClient readerBKC;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `sharedWriterZKCBuilder` is accessed in both synchronized and unsynchronized contexts
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/BKNamespaceDriver.java`
#### Snippet
```java
    //       keep builders and their client wrappers here, as they will be used when
    //       instantiating readers or writers.
    private ZooKeeperClientBuilder sharedWriterZKCBuilder;
    private ZooKeeperClient writerZKC;
    private ZooKeeperClientBuilder sharedReaderZKCBuilder;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `readerZKC` is accessed in both synchronized and unsynchronized contexts
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/BKNamespaceDriver.java`
#### Snippet
```java
    private ZooKeeperClient writerZKC;
    private ZooKeeperClientBuilder sharedReaderZKCBuilder;
    private ZooKeeperClient readerZKC;
    // NOTE: The actual bookkeeper client is initialized lazily when it is referenced by
    //       {@link org.apache.distributedlog.BookKeeperClient#get()}. So it is safe to
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `writerStreamMetadataStore` is accessed in both synchronized and unsynchronized contexts
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/BKNamespaceDriver.java`
#### Snippet
```java
    // log stream metadata store
    private LogMetadataStore metadataStore;
    private LogStreamMetadataStore writerStreamMetadataStore;
    private LogStreamMetadataStore readerStreamMetadataStore;

```

### FieldAccessedSynchronizedAndUnsynchronized
Field `writerZKC` is accessed in both synchronized and unsynchronized contexts
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/BKNamespaceDriver.java`
#### Snippet
```java
    //       instantiating readers or writers.
    private ZooKeeperClientBuilder sharedWriterZKCBuilder;
    private ZooKeeperClient writerZKC;
    private ZooKeeperClientBuilder sharedReaderZKCBuilder;
    private ZooKeeperClient readerZKC;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `metadataStore` is accessed in both synchronized and unsynchronized contexts
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/BKNamespaceDriver.java`
#### Snippet
```java

    // log stream metadata store
    private LogMetadataStore metadataStore;
    private LogStreamMetadataStore writerStreamMetadataStore;
    private LogStreamMetadataStore readerStreamMetadataStore;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `dynConf` is accessed in both synchronized and unsynchronized contexts
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/BKNamespaceDriver.java`
#### Snippet
```java
    // resources (passed from initialization)
    private DistributedLogConfiguration conf;
    private DynamicDistributedLogConfiguration dynConf;
    private URI namespace;
    private OrderedScheduler scheduler;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `scheduler` is accessed in both synchronized and unsynchronized contexts
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/BKNamespaceDriver.java`
#### Snippet
```java
    private DynamicDistributedLogConfiguration dynConf;
    private URI namespace;
    private OrderedScheduler scheduler;
    private FeatureProvider featureProvider;
    private AsyncFailureInjector failureInjector;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `eventLoopGroup` is accessed in both synchronized and unsynchronized contexts
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/BKNamespaceDriver.java`
#### Snippet
```java
    //       keep builders and their client wrappers here, as they will be used when
    //       instantiating readers or writers.
    private EventLoopGroup eventLoopGroup;
    private HashedWheelTimer requestTimer;
    private BookKeeperClientBuilder sharedWriterBKCBuilder;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `ledgerIdLeftFromPrevAllocation` is accessed in both synchronized and unsynchronized contexts
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
    OpListener<LedgerHandle> tryObtainListener = null;
    // ledger id left from previous allocation
    Long ledgerIdLeftFromPrevAllocation = null;
    // Allocated Ledger
    LedgerHandle allocatedLh = null;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `flushOpts` is accessed in both synchronized and unsynchronized contexts
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
    protected ColumnFamilyOptions cfOpts;
    protected WriteOptions writeOpts;
    protected FlushOptions flushOpts;

    // states of the store
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `writeOpts` is accessed in both synchronized and unsynchronized contexts
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
    protected DBOptions dbOpts;
    protected ColumnFamilyOptions cfOpts;
    protected WriteOptions writeOpts;
    protected FlushOptions flushOpts;

```

### FieldAccessedSynchronizedAndUnsynchronized
Field `dataCfHandle` is accessed in both synchronized and unsynchronized contexts
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
    protected RocksDB db;
    protected ColumnFamilyHandle metaCfHandle;
    protected ColumnFamilyHandle dataCfHandle;

    // iterators
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `db` is accessed in both synchronized and unsynchronized contexts
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
    // rocksdb state
    protected File dbDir;
    protected RocksDB db;
    protected ColumnFamilyHandle metaCfHandle;
    protected ColumnFamilyHandle dataCfHandle;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `dbOpts` is accessed in both synchronized and unsynchronized contexts
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java

    // options used by rocksdb
    protected DBOptions dbOpts;
    protected ColumnFamilyOptions cfOpts;
    protected WriteOptions writeOpts;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `keyCoder` is accessed in both synchronized and unsynchronized contexts
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
    protected String name;
    protected int ttlSeconds;
    protected Coder<K> keyCoder;
    protected Coder<V> valCoder;

```

### FieldAccessedSynchronizedAndUnsynchronized
Field `ttlSeconds` is accessed in both synchronized and unsynchronized contexts
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
    // parameters for the store
    protected String name;
    protected int ttlSeconds;
    protected Coder<K> keyCoder;
    protected Coder<V> valCoder;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `cfOpts` is accessed in both synchronized and unsynchronized contexts
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
    // options used by rocksdb
    protected DBOptions dbOpts;
    protected ColumnFamilyOptions cfOpts;
    protected WriteOptions writeOpts;
    protected FlushOptions flushOpts;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `checkpointer` is accessed in both synchronized and unsynchronized contexts
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
    private ScheduledExecutorService checkpointScheduler;
    // rocksdb checkpointer
    private RocksCheckpointer checkpointer;

    static {
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `valCoder` is accessed in both synchronized and unsynchronized contexts
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
    protected int ttlSeconds;
    protected Coder<K> keyCoder;
    protected Coder<V> valCoder;

    // rocksdb state
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `metaCfHandle` is accessed in both synchronized and unsynchronized contexts
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
    protected File dbDir;
    protected RocksDB db;
    protected ColumnFamilyHandle metaCfHandle;
    protected ColumnFamilyHandle dataCfHandle;

```

### FieldAccessedSynchronizedAndUnsynchronized
Field `dbDir` is accessed in both synchronized and unsynchronized contexts
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java

    // rocksdb state
    protected File dbDir;
    protected RocksDB db;
    protected ColumnFamilyHandle metaCfHandle;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `name` is accessed in both synchronized and unsynchronized contexts
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java

    // parameters for the store
    protected String name;
    protected int ttlSeconds;
    protected Coder<K> keyCoder;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `checkpointInterval` is accessed in both synchronized and unsynchronized contexts
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/journal/AbstractStateStoreWithJournal.java`
#### Snippet
```java
    // checkpoint
    private ScheduledFuture<?> checkpointTask;
    private Duration checkpointInterval;

    // close state
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `writeIOScheduler` is accessed in both synchronized and unsynchronized contexts
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/journal/AbstractStateStoreWithJournal.java`
#### Snippet
```java
    protected boolean ownWriteScheduler = false;
    protected boolean ownReadScheduler = false;
    protected ScheduledExecutorService writeIOScheduler;
    protected ScheduledExecutorService readIOScheduler;

```

### FieldAccessedSynchronizedAndUnsynchronized
Field `spec` is accessed in both synchronized and unsynchronized contexts
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/journal/AbstractStateStoreWithJournal.java`
#### Snippet
```java

    // spec
    protected StateStoreSpec spec;

    protected boolean ownWriteScheduler = false;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `checkpointTask` is accessed in both synchronized and unsynchronized contexts
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/journal/AbstractStateStoreWithJournal.java`
#### Snippet
```java

    // checkpoint
    private ScheduledFuture<?> checkpointTask;
    private Duration checkpointInterval;

```

## RuleId[id=EqualsAndHashcode]
### EqualsAndHashcode
Class has `equals()` defined but does not define `hashCode()`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/CheckpointSource.java`
#### Snippet
```java
    interface Checkpoint extends Comparable<Checkpoint> {

        Checkpoint MAX = new Checkpoint() {

            @Override
            public int compareTo(Checkpoint o) {
                if (o == MAX) {
                    return 0;
                }
                return 1;
            }

            @Override
            public boolean equals(Object o) {
                return this == o;
            }

            @Override
            public String toString() {
                return "MAX";
            }

        };

        Checkpoint MIN = new Checkpoint() {
```

### EqualsAndHashcode
Class has `equals()` defined but does not define `hashCode()`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/CheckpointSource.java`
#### Snippet
```java
        };

        Checkpoint MIN = new Checkpoint() {
            @Override
            public int compareTo(Checkpoint o) {
                if (o == MIN) {
                    return 0;
                }
                return -1;
            }

            @Override
            public boolean equals(Object o) {
                return this == o;
            }

            @Override
            public String toString() {
                return "MIN";
            }
        };
    }

```

### EqualsAndHashcode
Class has `equals()` defined but does not define `hashCode()`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryMemTable.java`
#### Snippet
```java
     * Entry skip list.
     */
    static class EntrySkipList extends ConcurrentSkipListMap<EntryKey, EntryKeyValue> {
        final Checkpoint cp;
        static final EntrySkipList EMPTY_VALUE = new EntrySkipList(Checkpoint.MAX) {
```

## RuleId[id=PointlessBitwiseExpression]
### PointlessBitwiseExpression
`location >> 32 & 0xFFFFFFFF` can be replaced with 'location \>\> 32'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryLocation.java`
#### Snippet
```java
            .append("ledger=").append(ledger)
            .append(",entry=").append(entry)
            .append(",locationLog=").append(location >> 32 & 0xFFFFFFFF)
            .append(",locationOffset=").append((int) (location & 0xFFFFFFFF))
            .append("}").toString();
```

### PointlessBitwiseExpression
`location & 0xFFFFFFFF` can be replaced with 'location'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryLocation.java`
#### Snippet
```java
            .append(",entry=").append(entry)
            .append(",locationLog=").append(location >> 32 & 0xFFFFFFFF)
            .append(",locationOffset=").append((int) (location & 0xFFFFFFFF))
            .append("}").toString();
    }
```

### PointlessBitwiseExpression
`~(64 - 1)` can be replaced with '-64'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/WriteCache.java`
#### Snippet
```java
    }

    private static final int ALIGN_64_MASK = ~(64 - 1);

    static int align64(int size) {
```

### PointlessBitwiseExpression
`~(ALIGNMENT - 1)` can be replaced with '-ALIGNMENT'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/Buffer.java`
#### Snippet
```java
                       pos, MAX_ALIGNMENT);
        checkArgument(pos >= 0, "position (0x%x) must be positive", pos);
        return (pos + (ALIGNMENT - 1)) & ~(ALIGNMENT - 1);
    }
}
```

### PointlessBitwiseExpression
`~(ALIGNMENT - 1)` can be replaced with '-ALIGNMENT'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/Buffer.java`
#### Snippet
```java
     * alignment */
    public static final int ALIGNMENT = 4096;
    private static final int MAX_ALIGNMENT = Integer.MAX_VALUE & ~(ALIGNMENT - 1);
    static final byte[] PADDING = generatePadding();

```

### PointlessBitwiseExpression
`~(blockSize - 1)` can be replaced with '-blockSize'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectReader.java`
#### Snippet
```java
        final int blockSize = nativeBuffer.size();
        assertValidBlockSize(blockSize);
        final long blockStart = offset & ~(blockSize - 1);

        if (blockStart + blockSize > maxOffset) {
```

### PointlessBitwiseExpression
`location & 0xFFFFFFFF` can be replaced with 'location'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectEntryLogger.java`
#### Snippet
```java
            throws IOException, NoEntryException {
        int logId = (int) (location >> 32);
        int pos = (int) (location & 0xFFFFFFFF);

        long start = System.nanoTime();
```

### PointlessBitwiseExpression
`0x1 << 0` can be replaced with '0x1'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/api/WriteFlag.java`
#### Snippet
```java
     * @see ForceableHandle#force()
     */
    DEFERRED_SYNC(0x1 << 0);

    /**
```

## RuleId[id=SynchronizeOnThis]
### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/clients/java/base/src/main/java/org/apache/bookkeeper/clients/impl/container/StorageContainerChannel.java`
#### Snippet
```java
            log.info("No channel found/created for range server {}. The channel manager must be shutting down."
                + " Stop the process of fetching storage container ({}).", endpoint.getRwEndpoint(), scId);
            synchronized (this) {
                rsChannelFuture.completeExceptionally(
                    new ObjectClosedException("StorageServerChannelManager is closed"));
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/clients/java/base/src/main/java/org/apache/bookkeeper/clients/impl/container/StorageContainerChannel.java`
#### Snippet
```java

        // update the future
        synchronized (this) {
            rsChannelFuture.complete(interceptedChannel);
        }
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/clients/java/base/src/main/java/org/apache/bookkeeper/clients/impl/container/StorageContainerChannel.java`
#### Snippet
```java
    public CompletableFuture<StorageServerChannel> getStorageContainerChannelFuture() {
        CompletableFuture<StorageServerChannel> channelFuture;
        synchronized (this) {
            if (null != rsChannelFuture) {
                return rsChannelFuture;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/clients/java/base/src/main/java/org/apache/bookkeeper/clients/impl/container/StorageContainerChannel.java`
#### Snippet
```java
    private void fetchStorageContainerInfo() {
        long scRevision;
        synchronized (this) {
            if (null == scInfo) {
                scRevision = IRevisioned.ANY_REVISION;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/bk-grpc-name-resolver/src/main/java/org/apache/bookkeeper/grpc/resolver/BKRegistrationNameResolver.java`
#### Snippet
```java
    @Override
    public void shutdown() {
        synchronized (this) {
            if (shutdown) {
                return;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/bk-grpc-name-resolver/src/main/java/org/apache/bookkeeper/grpc/resolver/BKRegistrationNameResolver.java`
#### Snippet
```java
        this.clientDriver.getRegistrationClient().watchWritableBookies(bookies -> {
            Listener savedListener;
            synchronized (this) {
                savedListener = listener;
            }
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/bk-grpc-name-resolver/src/main/java/org/apache/bookkeeper/grpc/resolver/BKRegistrationNameResolver.java`
#### Snippet
```java
                }
            } finally {
                synchronized (this) {
                    resolving = false;
                }
```

### SynchronizeOnThis
Lock operations on a class may have unforeseen side-effects
in `microbenchmarks/src/main/java/org/apache/bookkeeper/stats/codahale/TimerBenchmark.java`
#### Snippet
```java
            }

            synchronized (MyState.class) {
                // timers (and response times) are shared across threads to test
                // concurrency of timer updates.
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/cluster/ZkClusterMetadataStore.java`
#### Snippet
```java
    @Override
    public void watchClusterAssignmentData(Consumer<Void> watcher, Executor executor) {
        synchronized (this) {
            if (assignmentDataCache == null) {
                assignmentDataCache = new org.apache.curator.framework.recipes.cache.NodeCache(client,
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/cluster/ZkClusterMetadataStore.java`
#### Snippet
```java
    @Override
    public void close() {
        synchronized (this) {
            if (closed) {
                return;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/cluster/ZkClusterMetadataStore.java`
#### Snippet
```java
    @Override
    public void unwatchClusterAssignmentData(Consumer<Void> watcher) {
        synchronized (this) {
            NodeCacheListener listener = assignmentDataConsumers.remove(watcher);
            if (null != listener && null != assignmentDataCache) {
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/store/MVCCStoreFactoryImpl.java`
#### Snippet
```java
    public void close() {
        Map<Long, Map<RangeId, MVCCAsyncStore<byte[], byte[]>>> storesToClose;
        synchronized (this) {
            if (closed) {
                return;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/store/MVCCStoreFactoryImpl.java`
#### Snippet
```java
    public CompletableFuture<Void> closeStores(long scId) {
        Map<RangeId, MVCCAsyncStore<byte[], byte[]>> scStores;
        synchronized (this) {
            scStores = stores.remove(scId);
        }
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/store/MVCCStoreFactoryImpl.java`
#### Snippet
```java

    CompletableFuture<MVCCAsyncStore<byte[], byte[]>> newStore(long scId, long streamId, long rangeId, int ttlSeconds) {
        synchronized (this) {
            if (closed) {
                return FutureUtils.exception(new ObjectClosedException("MVCCStoreFactory"));
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/common/src/main/java/org/apache/distributedlog/common/concurrent/AsyncSemaphore.java`
#### Snippet
```java
                CompletableFuture<Permit> future = FutureUtils.createFuture();
                future.whenComplete((value, cause) -> {
                    synchronized (AsyncSemaphore.this) {
                        waitq.remove(future);
                    }
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/metadata/stream/MetaRangeImpl.java`
#### Snippet
```java

        // 2. store the props/configuration
        synchronized (this) {
            this.streamProps = streamProps;
        }
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/server/src/main/java/org/apache/bookkeeper/stream/cluster/StreamCluster.java`
#### Snippet
```java

        while (!success) {
            synchronized (this) {
                bookiePort = nextBookiePort++;
                grpcPort = nextGrpcPort++;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/SubTreeCache.java`
#### Snippet
```java
        @Override
        public void process(WatchedEvent event) {
            synchronized (SubTreeCache.this) {
                handleEvent(event);
                cachedNodes.remove(path);
```

### SynchronizeOnThis
Lock operations on a class may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/sasl/TGTRefreshThread.java`
#### Snippet
```java
        }
        LOG.info("Initiating logout for {}", container.getPrincipal());
        synchronized (Login.class) {
            //clear up the kerberos state. But the tokens are not cleared! As per
            //the Java kerberos login module code, only the kerberos credentials
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieRequestHandler.java`
#### Snippet
```java
    public void userEventTriggered(ChannelHandlerContext ctx, Object evt) throws Exception {
        if (evt == EVENT_FLUSH_ALL_PENDING_RESPONSES) {
            synchronized (this) {
                if (pendingSendResponses != null) {
                    maxPendingResponsesSize = Math.max(maxPendingResponsesSize,
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/LongPollReadEntryProcessorV3.java`
#### Snippet
```java
                    logger.trace("Waiting For LAC Update {}: Timeout {}", previousLAC, readRequest.getTimeOut());
                }
                synchronized (this) {
                    expirationTimerTask = requestTimer.newTimeout(timeout -> {
                            requestProcessor.getBookie().cancelWaitForLastAddConfirmedUpdate(ledgerId, this);
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/AuthHandler.java`
#### Snippet
```java
        @Override
        public void write(ChannelHandlerContext ctx, Object msg, ChannelPromise promise) throws Exception {
            synchronized (this) {
                if (authenticated) {
                    super.write(ctx, msg, promise);
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/AuthHandler.java`
#### Snippet
```java
            public void operationComplete(int rc, Void v) {
                if (rc == BKException.Code.OK) {
                    synchronized (this) {
                        authenticated = true;
                        Object msg = waitingForAuth.poll();
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieClientImpl.java`
#### Snippet
```java
        synchronized void dec() {
            i--;
            notifyAll();
        }

```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieClientImpl.java`
#### Snippet
```java
        synchronized void wait(int limit) throws InterruptedException {
            while (i > limit) {
                wait();
            }
        }
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookie/ListLedgersCommand.java`
#### Snippet
```java
                                     * different threads.
                                     */
                                    synchronized (ListLedgersCommand.this) {
                                        printLedgerMetadata(ledgerId, metadata.getValue(), flags.meta);
                                    }
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
            }

            synchronized (PerChannelBookieClient.this) {
                if (future.isSuccess() && state == ConnectionState.CONNECTING && future.channel().isActive()) {
                    rc = BKException.Code.OK;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
        } else {

            synchronized (this) {
                // check the channel status again under lock
                if (channel != null && state == ConnectionState.CONNECTED) {
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
        }

        synchronized (this) {
            if (state == ConnectionState.CLOSED) {
                if (LOG.isDebugEnabled()) {
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
        LOG.error("TLS failure on: {}, rc: {}", channel, rc);
        Queue<GenericCallback<PerChannelBookieClient>> oldPendingOps;
        synchronized (this) {
            disconnect();
            oldPendingOps = pendingOps;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
        errorOutPendingOps(BKException.Code.BookieHandleNotAvailableException);

        synchronized (this) {
            if (this.channel == ctx.channel()
                && state != ConnectionState.CLOSED) {
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
                    Queue<GenericCallback<PerChannelBookieClient>> oldPendingOps;

                    synchronized (PerChannelBookieClient.this) {
                        if (future.isSuccess() && state == ConnectionState.CONNECTING) {
                            LOG.error("Connection state changed before TLS handshake completed {}/{}", bookieId, state);
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
    void errorOutPendingOps(int rc) {
        Queue<GenericCallback<PerChannelBookieClient>> oldPendingOps;
        synchronized (this) {
            oldPendingOps = pendingOps;
            pendingOps = new ArrayDeque<>();
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
    private void closeInternal(boolean permanent, boolean wait) {
        Channel toClose = null;
        synchronized (this) {
            if (permanent) {
                state = ConnectionState.CLOSED;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryLogManagerForSingleEntryLog.java`
#### Snippet
```java
    void flushRotatedLogs() throws IOException {
        List<BufferedLogChannel> channels = null;
        synchronized (this) {
            channels = rotatedLogChannels;
            rotatedLogChannels = new LinkedList<BufferedLogChannel>();
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryLogManagerForSingleEntryLog.java`
#### Snippet
```java
            } catch (IOException ioe) {
                // rescue from flush exception, add unflushed channels back
                synchronized (this) {
                    if (null == rotatedLogChannels) {
                        rotatedLogChannels = channels;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LedgerDescriptorImpl.java`
#### Snippet
```java
    private CompletableFuture<Boolean> logFenceEntryInJournal(Journal journal) {
        CompletableFuture<Boolean> result;
        synchronized (this) {
            result = logFenceResult = FutureUtils.createFuture();
        }
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryLogManagerForEntryLogPerLedger.java`
#### Snippet
```java
                        @Override
                        public MutableInt load(Long key) throws Exception {
                            synchronized (EntryLogsPerLedgerCounter.this) {
                                return new MutableInt();
                            }
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryLogManagerForEntryLogPerLedger.java`
#### Snippet
```java
                            if ((removedEntryFromCounterMap != null)
                                    && (removedEntryFromCounterMap.getValue() != null)) {
                                synchronized (EntryLogsPerLedgerCounter.this) {
                                    entryLogsPerLedger
                                            .registerSuccessfulValue(removedEntryFromCounterMap.getValue().intValue());
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/TransactionalEntryLogCompactor.java`
#### Snippet
```java
                public void process(long ledgerId, long offset, ByteBuf entry) throws IOException {
                    throttler.acquire(entry.readableBytes());
                    synchronized (TransactionalEntryLogCompactor.this) {
                        long lid = entry.getLong(entry.readerIndex());
                        long entryId = entry.getLong(entry.readerIndex() + 8);
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BufferedChannel.java`
#### Snippet
```java
        int copied = 0;
        boolean shouldForceWrite = false;
        synchronized (this) {
            int len = src.readableBytes();
            while (copied < len) {
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BufferedChannel.java`
#### Snippet
```java
         */
        if (unpersistedBytesBound > 0) {
            synchronized (this) {
                unpersistedBytes.set(writeBuffer.readableBytes());
            }
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/DefaultFileChannel.java`
#### Snippet
```java
    @Override
    public void close() throws IOException {
        synchronized (this) {
            if (randomAccessFile != null) {
                randomAccessFile.close();
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/DefaultFileChannel.java`
#### Snippet
```java
    @Override
    public FileChannel getFileChannel() throws FileNotFoundException {
        synchronized (this) {
            if (randomAccessFile == null) {
                randomAccessFile = new RandomAccessFile(file, "rw");
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/DefaultFileChannel.java`
#### Snippet
```java
    @Override
    public FileDescriptor getFD() throws IOException {
        synchronized (this) {
            if (randomAccessFile == null) {
                throw new IOException("randomAccessFile is null, please initialize it by calling getFileChannel");
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryMemTableWithParallelFlusher.java`
#### Snippet
```java
        AtomicLong flushedSize = new AtomicLong();
        if (this.snapshot.compareTo(checkpoint) < 0) {
            synchronized (this) {
                EntrySkipList keyValues = this.snapshot;

```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/FileInfo.java`
#### Snippet
```java
    public void close(boolean force) throws IOException {
        boolean changed = false;
        synchronized (this) {
            if (isClosed) {
                return;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/FileInfo.java`
#### Snippet
```java
    public ByteBuf getExplicitLac() {
        ByteBuf retLac = null;
        synchronized (this) {
            if (LOG.isDebugEnabled()) {
                LOG.debug("fileInfo:GetLac: {}", explicitLac);
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/FileInfo.java`
#### Snippet
```java
        long lacToReturn;
        boolean changed = false;
        synchronized (this) {
            if (null == this.lac || this.lac < lac) {
                this.lac = lac;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/FileInfo.java`
#### Snippet
```java
    public void setExplicitLac(ByteBuf lac) {
        long explicitLacValue;
        synchronized (this) {
            if (explicitLac == null) {
                explicitLac = ByteBuffer.allocate(lac.capacity());
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/FileInfo.java`
#### Snippet
```java
        boolean returnVal = false;
        boolean changed = false;
        synchronized (this) {
            checkOpen(false);
            if (LOG.isDebugEnabled()) {
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/FileInfo.java`
#### Snippet
```java
            throws IOException {
        checkOpen(false);
        synchronized (this) {
            if (fc == null) {
                return 0;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/FileInfo.java`
#### Snippet
```java
        int rc = 0;
        while (bb.remaining() > 0) {
            synchronized (this) {
                rc = fc.read(bb, start);
            }
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryMemTable.java`
#### Snippet
```java
        if (this.snapshot.compareTo(checkpoint) < 0) {
            long ledger, ledgerGC = -1;
            synchronized (this) {
                EntrySkipList keyValues = this.snapshot;
                if (keyValues.compareTo(checkpoint) < 0) {
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/EntryLogIdsImpl.java`
#### Snippet
```java
    public int nextId() throws IOException {
        while (true) {
            synchronized (this) {
                int current = nextId;
                nextId++;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/TransientLedgerInfo.java`
#### Snippet
```java
    @Override
    public void close() {
        synchronized (this) {
            if (isClosed) {
                return;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/TransientLedgerInfo.java`
#### Snippet
```java
    public void setExplicitLac(ByteBuf lac) {
        long explicitLacValue;
        synchronized (this) {
            if (explicitLac == null) {
                explicitLac = ByteBuffer.allocate(lac.capacity());
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/TransientLedgerInfo.java`
#### Snippet
```java
        long lacToReturn;
        boolean changed = false;
        synchronized (this) {
            if (this.lac == NOT_ASSIGNED_LAC || this.lac < lac) {
                this.lac = lac;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/TransientLedgerInfo.java`
#### Snippet
```java
    public ByteBuf getExplicitLac() {
        ByteBuf retLac = null;
        synchronized (this) {
            if (explicitLac != null) {
                retLac = Unpooled.buffer(explicitLac.capacity());
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/datainteg/DataIntegrityService.java`
#### Snippet
```java
        log.info("Event: {}, interval: {}, intervalUnit: {}",
                        Events.DATA_INTEG_SERVICE_START, interval(), intervalUnit());
        synchronized (this) {
            scheduledFuture = scheduler.scheduleAtFixedRate(() -> {
                    try {
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/datainteg/DataIntegrityService.java`
#### Snippet
```java
    protected void doStop() {
        log.info("Event: {}", Events.DATA_INTEG_SERVICE_STOP);
        synchronized (this) {
            if (scheduledFuture != null) {
                scheduledFuture.cancel(true);
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/datainteg/DataIntegrityService.java`
#### Snippet
```java
    @Override
    protected void doClose() throws IOException {
        synchronized (this) {
            // just in case stop didn't get called, the scheduledfuture
            // would stop the scheduler from shutting down
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectReader.java`
#### Snippet
```java
            checkState(ret >= 0,
                                     "Lseek should throw exception on negative return (%d)", ret);
            synchronized (this) {
                maxOffset = ret;
            }
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectEntryLogger.java`
#### Snippet
```java

        List<Future<?>> outstandingFlushes;
        synchronized (this) {
            outstandingFlushes = this.pendingFlushes;
            this.pendingFlushes = new ArrayList<>();
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectEntryLogger.java`
#### Snippet
```java

        CompletableFuture<Void> flushPromise = new CompletableFuture<>();
        synchronized (this) {
            flushWriter = this.curWriter;
            this.curWriter = null;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectEntryLogger.java`
#### Snippet
```java
    private Future<?> flushCurrent() throws IOException {
        WriterWithMetadata flushWriter;
        synchronized (this) {
            flushWriter = this.curWriter;
        }
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectEntryLogger.java`
#### Snippet
```java

        long offset;
        synchronized (this) {
            if (curWriter != null
                && curWriter.shouldRoll(buf, maxFileSize)) {
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/MSLedgerManagerFactory.java`
#### Snippet
```java
            try {
                while (!finished) {
                    wait();
                }
            } catch (InterruptedException ie) {
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/MSLedgerManagerFactory.java`
#### Snippet
```java
            finished = true;

            notify();
        }

```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/SyncCounter.java`
#### Snippet
```java
        while (i > limit) {
            int prev = i;
            wait();
            if (i == prev) {
                break;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/SyncCounter.java`
#### Snippet
```java
    synchronized void dec() {
        i--;
        notifyAll();
    }

```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandleAdv.java`
#### Snippet
```java

        boolean wasClosed = false;
        synchronized (this) {
            // synchronized on this to ensure that
            // the ledger isn't closed between checking and
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookieInfoReader.java`
#### Snippet
```java
                    new GetBookieInfoCallback() {
                        void processReadInfoComplete(int rc, BookieInfo bInfo, Object ctx) {
                            synchronized (BookieInfoReader.this) {
                                BookieId b = (BookieId) ctx;
                                if (rc != BKException.Code.OK) {
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookieInfoReader.java`
#### Snippet
```java
            @Override
            public void run() {
                synchronized (BookieInfoReader.this) {
                    if (LOG.isDebugEnabled()) {
                        LOG.debug("Running periodic BookieInfo scan");
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadOnlyLedgerHandle.java`
#### Snippet
```java
    CompletableFuture<Versioned<LedgerMetadata>> closeRecovered() {
        long lac, len;
        synchronized (this) {
            lac = lastAddConfirmed;
            len = length;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadOnlyLedgerHandle.java`
#### Snippet
```java
                Version.Occurred occurred = currentMetadata.getVersion().compare(newMetadata.getVersion());
                if (Version.Occurred.BEFORE == occurred) {
                    synchronized (ReadOnlyLedgerHandle.this) {
                        if (setLedgerMetadata(currentMetadata, newMetadata)) {
                            LOG.info("Updated ledger metadata for ledger {} to {}, version {}.",
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java

    boolean setLedgerMetadata(Versioned<LedgerMetadata> expected, Versioned<LedgerMetadata> newMetadata) {
        synchronized (this) {
            // ensure that we only update the metadata if it is the object we expect it to be
            if (versionedMetadata == expected) {
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
        boolean isClosed;
        long lastEntryId;
        synchronized (this) {
            LedgerMetadata metadata = getLedgerMetadata();
            isClosed = metadata.isClosed();
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
        ForceLedgerOp op = new ForceLedgerOp(this, clientCtx.getBookieClient(), getCurrentEnsemble(), result);
        boolean wasClosed = false;
        synchronized (this) {
            // synchronized on this to ensure that
            // the ledger isn't closed between checking and
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
    public void asyncReadExplicitLastConfirmed(final ReadLastConfirmedCallback cb, final Object ctx) {
        boolean isClosed;
        synchronized (this) {
            LedgerMetadata metadata = getLedgerMetadata();
            isClosed = metadata.isClosed();
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
        boolean isClosed;
        long lac;
        synchronized (this) {
            LedgerMetadata metadata = getLedgerMetadata();
            isClosed = metadata.isClosed();
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
        boolean isClosed;
        long lastEntryId;
        synchronized (this) {
            LedgerMetadata metadata = getLedgerMetadata();
            isClosed = metadata.isClosed();
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
                    });

                    synchronized (LedgerHandle.this) {
                        prevHandleState = handleState;

```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java

        boolean wasClosed = false;
        synchronized (this) {
            // synchronized on this to ensure that
            // the ledger isn't closed between checking and
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookieWatcherImpl.java`
#### Snippet
```java
        CompletableFuture<?> writable;
        CompletableFuture<?> readonly;
        synchronized (this) {
            if (initialReadonlyBookiesFuture == null) {
                assert initialWritableBookiesFuture == null;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
        @Override
        public void accept(Integer rc) {
            synchronized (BookkeeperVerifier.this) {
                if (checkReturn(ledger.ledgerID, rc)) {
                    return;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
                    System.out.format("Writes ending at %d complete on ledger %d%n", lastEntry, ledger.ledgerID);
                    ledger.closeWrite(lastEntry, (rc2) -> {
                        synchronized (BookkeeperVerifier.this) {
                            checkReturn(ledger.ledgerID, rc2);
                            System.out.format("Writes ending at %d complete on ledger %d releasing write%n",
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
                                    lastEntry, ledger.ledgerID);
                            --outstandingWriteCount;
                            BookkeeperVerifier.this.notifyAll();
                        }
                    });
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java

            /* atomically wait for either IO to complete or the test to end */
            this.wait(toWait < 0 ? 0 : toWait);
            printThrowExceptions();
        }
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
            }
            long toWait = testDrainEnd - System.currentTimeMillis();
            this.wait(toWait < 0 ? 0 : toWait);
            printThrowExceptions();
        }
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
            openingLedgers.add(ledger);
            driver.createLedger(newID, ensembleSize, writeQuorum, ackQuorum, (rc) -> {
                synchronized (BookkeeperVerifier.this) {
                    checkReturn(newID, rc);
                    System.out.format("Created new ledger %d%n", newID);
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
                    openLedgers.add(ledger);
                    --outstandingWriteCount;
                    BookkeeperVerifier.this.notifyAll();
                }
            });
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
                    System.out.format("Closing ledger %d%n", ledger.ledgerID);
                    driver.closeLedger(ledger.ledgerID, (Integer rc) -> {
                        synchronized (BookkeeperVerifier.this) {
                            ledger.setClosed();
                            System.out.format("Closed ledger %d%n", ledger.ledgerID);
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
                                    System.out.format("Deleting ledger %d%n", ledgerID);
                                    driver.deleteLedger(ledgerID, (rc2) -> {
                                        synchronized (BookkeeperVerifier.this) {
                                            System.out.format("Deleted ledger %d%n", ledgerID);
                                            cb2.accept(rc2);
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
    private synchronized void propagateExceptionToMain(Exception e) {
        errors.add(e);
        this.notifyAll();
    }

```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
        ledger.incReads();
        driver.readEntries(ledger.ledgerID, start, end, (rc, results) -> {
            synchronized (BookkeeperVerifier.this) {
                if (checkReturn(ledger.ledgerID, rc)) {
                    return;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
                }
                finalLedger.decReads((rc2) -> {
                    synchronized (BookkeeperVerifier.this) {
                        checkReturn(ledger.ledgerID, rc2);
                        System.out.format("Read %d -> %d from ledger %d releasing read%n", start, end, ledger.ledgerID);
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
                        System.out.format("Read %d -> %d from ledger %d releasing read%n", start, end, ledger.ledgerID);
                        outstandingReadCount--;
                        BookkeeperVerifier.this.notifyAll();
                    }
                });
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/AuditorElector.java`
#### Snippet
```java
     */
    public void shutdown() throws InterruptedException {
        synchronized (this) {
            if (executor.isShutdown()) {
                return;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/Auditor.java`
#### Snippet
```java

    private void submitShutdownTask() {
        synchronized (this) {
            LOG.info("Executing submitShutdownTask");
            if (executor.isShutdown()) {
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/Auditor.java`
#### Snippet
```java
            }
            executor.submit(() -> {
                synchronized (Auditor.this) {
                    LOG.info("Shutting down Auditor's Executor");
                    executor.shutdown();
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/Auditor.java`
#### Snippet
```java
        // on startup watching available bookie and based on the
        // available bookies determining the bookie failures.
        synchronized (this) {
            if (executor.isShutdown()) {
                return;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/ReplicationWorker.java`
#### Snippet
```java
        LOG.info("Shutting down replication worker");

        synchronized (this) {
            if (!workerRunning) {
                return;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdWatcher.java`
#### Snippet
```java

    void notifyWatchResponse(WatchResponseWithError watchResponse) {
        synchronized (this) {
            if (closed) {
                return;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdWatcher.java`
#### Snippet
```java
    @Override
    public void close() {
        synchronized (this) {
            if (closed) {
                return;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdBookieRegister.java`
#### Snippet
```java
    @Override
    public void close() {
        synchronized (this) {
            if (!running) {
                return;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdBookieRegister.java`
#### Snippet
```java

    private void resetLease() {
        synchronized (this) {
            leaseFuture = new CompletableFuture<>();
        }
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdBookieRegister.java`
#### Snippet
```java
    private void newLeaseIfNeeded() throws MetadataStoreException {
        boolean newLeaseNeeded;
        synchronized (this) {
            newLeaseNeeded = !leaseFuture.isDone();
        }
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdBookieRegister.java`
#### Snippet
```java
            keepAliveFuture = new CompletableFuture<>();
            if (kaListener != null) {
                synchronized (this) {
                    kaListener.close();
                    kaListener = null;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdMetadataBookieDriver.java`
#### Snippet
```java
        RegistrationManager rmToClose;
        EtcdBookieRegister bkRegisterToClose;
        synchronized (this) {
            rmToClose = regMgr;
            regMgr = null;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdMetadataDriverBase.java`
#### Snippet
```java
            etcdEndpoints, keyPrefix);

        synchronized (this) {
            this.client = Client.builder()
                .endpoints(etcdEndpoints.toArray(new String[etcdEndpoints.size()]))
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/helpers/RevisionedConsumer.java`
#### Snippet
```java
    @Override
    public void accept(Versioned<T> versionedVal) {
        synchronized (this) {
            if (localVersion != null
                && Occurred.BEFORE != localVersion.compare(versionedVal.getVersion())) {
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdLedgerManager.java`
#### Snippet
```java
    @Override
    public void close() {
        synchronized (this) {
            if (closed) {
                return;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/helpers/KeyStream.java`
#### Snippet
```java
        ByteSequence beginKey;
        int batchSize = this.batchSize;
        synchronized (this) {
            if (!hasMore) {
                return FutureUtils.value(Collections.emptyList());
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/helpers/KeyStream.java`
#### Snippet
```java
            List<KeyValue> kvs = getResp.getKvs();
            ByteSequence lkey;
            synchronized (KeyStream.this) {
                hasMore = getResp.isMore();
                lkey = lastKey;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/helpers/ValueStream.java`
#### Snippet
```java
    private CompletableFuture<Void> closeOrRewatch(boolean rewatch) {
        CompletableFuture<EtcdWatcher> oldWatcherFuture;
        synchronized (this) {
            oldWatcherFuture = watchFuture;
            if (rewatch && null == closeFuture) {
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/helpers/ValueStream.java`
#### Snippet
```java
    public CompletableFuture<Void> closeAsync() {
        CompletableFuture<Void> future;
        synchronized (this) {
            if (null == closeFuture) {
                closeFuture = closeOrRewatch(false).thenCompose(ignored -> {
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/helpers/ValueStream.java`
#### Snippet
```java
            .whenComplete((watcher, cause) -> {
                if (null != cause) {
                    synchronized (ValueStream.this) {
                        watchFuture = null;
                    }
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/helpers/ValueStream.java`
#### Snippet
```java
            .thenCompose(versionedVal -> {
                long revision = ((LongVersion) versionedVal.getVersion()).getLongVersion();
                synchronized (this) {
                    notifyConsumers(versionedVal);
                }
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/helpers/ValueStream.java`
#### Snippet
```java
    private CompletableFuture<Versioned<T>> getOrRead() {
        boolean shouldRead = false;
        synchronized (this) {
            if (revision < 0L) {
                // the value is never cached.
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/helpers/ValueStream.java`
#### Snippet
```java
            }

            synchronized (this) {
                Versioned<T> localValue = processWatchResponse(watchResponse);
                if (null != localValue) {
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/helpers/KeySetReader.java`
#### Snippet
```java
    public CompletableFuture<Void> closeAsync() {
        CompletableFuture<Void> future;
        synchronized (this) {
            if (null == closeFuture) {
                closeFuture = closeOrRewatch(false).thenCompose(ignored -> {
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/helpers/KeySetReader.java`
#### Snippet
```java
        return watchFuture.whenComplete((watcher, cause) -> {
            if (null != cause) {
                synchronized (KeySetReader.this) {
                    watchFuture = null;
                }
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/helpers/KeySetReader.java`
#### Snippet
```java
    private CompletableFuture<Versioned<Set<T>>> getOrRead() {
        boolean shouldRead = false;
        synchronized (this) {
            if (revision < 0L) {
                // the value is never cached.
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/helpers/KeySetReader.java`
#### Snippet
```java
    private CompletableFuture<Void> closeOrRewatch(boolean rewatch) {
        CompletableFuture<EtcdWatcher> oldWatcherFuture;
        synchronized (this) {
            oldWatcherFuture = watchFuture;
            if (rewatch && null == closeFuture) {
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdWatchClient.java`
#### Snippet
```java
    public CompletableFuture<Void> closeAsync() {
        CompletableFuture<Void> future;
        synchronized (this) {
            if (null == closeFuture) {
                log.info("Closing watch client");
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/EnvelopedEntryWriter.java`
#### Snippet
```java
        satisfyPromises(lssn, entryId);
        ReferenceCountUtil.release(buffer);
        synchronized (this) {
            ReferenceCountUtil.release(finalizedBuffer);
        }
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/EnvelopedEntryWriter.java`
#### Snippet
```java
        cancelPromises(reason);
        ReferenceCountUtil.release(buffer);
        synchronized (this) {
            ReferenceCountUtil.release(finalizedBuffer);
        }
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BookKeeperClient.java`
#### Snippet
```java
        BookKeeper bkcToClose;
        ZooKeeperClient zkcToClose;
        synchronized (this) {
            if (closed) {
                return;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKSyncLogReader.java`
#### Snippet
```java
    public CompletableFuture<Void> asyncClose() {
        CompletableFuture<Void> closePromise;
        synchronized (this) {
            if (null != closeFuture) {
                return closeFuture;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAbstractLogWriter.java`
#### Snippet
```java
    protected BKLogWriteHandler createAndCacheWriteHandler(LedgerMetadata ledgerMetadata)
            throws IOException {
        synchronized (this) {
            if (writeHandler != null) {
                return writeHandler;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAbstractLogWriter.java`
#### Snippet
```java
        boolean success = false;
        try {
            synchronized (this) {
                if (writeHandler == null) {
                    writeHandler = newHandler;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAbstractLogWriter.java`
#### Snippet
```java
    public CompletableFuture<Void> asyncAbort() {
        CompletableFuture<Void> closeFuture;
        synchronized (this) {
            if (null != closePromise) {
                return closePromise;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAbstractLogWriter.java`
#### Snippet
```java
    protected CompletableFuture<Void> closeNoThrow() {
        CompletableFuture<Void> closeFuture;
        synchronized (this) {
            if (null != closePromise) {
                return closePromise;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAbstractLogWriter.java`
#### Snippet
```java
        // skip scheduling if there is task that's already running
        //
        synchronized (this) {
            if (truncationEnabled && ((lastTruncationAttempt == null) || lastTruncationAttempt.isDone())) {
                lastTruncationAttempt = writeHandler.purgeLogSegmentsOlderThanTimestamp(minTimestampToKeep);
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAsyncLogReader.java`
#### Snippet
```java
        ReadCancelledException exception;
        CompletableFuture<Void> closePromise;
        synchronized (this) {
            if (null != closeFuture) {
                return closeFuture;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAsyncLogReader.java`
#### Snippet
```java

                PendingReadRequest nextRequest = null;
                synchronized (this) {
                    nextRequest = pendingRequests.peek();

```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAsyncLogWriter.java`
#### Snippet
```java
    CompletableFuture<Long> flushAndCommit() {
        CompletableFuture<BKLogSegmentWriter> writerFuture;
        synchronized (this) {
            if (null != this.rollingFuture) {
                writerFuture = this.rollingFuture;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAsyncLogWriter.java`
#### Snippet
```java
            public void onSuccess(BKLogSegmentWriter writer) {
                try {
                    synchronized (BKAsyncLogWriter.this) {
                        for (PendingLogRecord pendingLogRecord : pendingRequests) {
                            FailpointUtils.checkFailPoint(FailpointUtils.FailPointName.FP_LogWriterIssuePending);
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAsyncLogWriter.java`
#### Snippet
```java
    protected CompletableFuture<Void> asyncCloseAndComplete() {
        CompletableFuture<BKLogSegmentWriter> logSegmentWriterFuture;
        synchronized (this) {
            logSegmentWriterFuture = this.rollingFuture;
        }
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAsyncLogWriter.java`
#### Snippet
```java
    public CompletableFuture<Void> asyncAbort() {
        CompletableFuture<Void> result = super.asyncAbort();
        synchronized (this) {
            if (pendingRequests != null) {
                for (PendingLogRecord pendingLogRecord : pendingRequests) {
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAsyncLogWriter.java`
#### Snippet
```java
        final Stopwatch stopwatch = Stopwatch.createStarted();
        CompletableFuture<BKLogSegmentWriter> logSegmentWriterFuture;
        synchronized (this) {
            logSegmentWriterFuture = this.rollingFuture;
        }
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAsyncLogWriter.java`
#### Snippet
```java
    void errorOutPendingRequests(Throwable cause, boolean errorOutWriter) {
        final List<PendingLogRecord> pendingRequestsSnapshot;
        synchronized (this) {
            pendingRequestsSnapshot = pendingRequests;
            firstEncounteredError.compareAndSet(null, cause);
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogReadHandler.java`
#### Snippet
```java
    @Override
    public void onSegmentsUpdated(final Versioned<List<String>> segments) {
        synchronized (this) {
            if (lastNotifiedLogSegments.getVersion() != Version.NEW
                    && lastNotifiedLogSegments.getVersion().compare(segments.getVersion()) != Version.Occurred.BEFORE) {
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogReadHandler.java`
#### Snippet
```java
    public CompletableFuture<Void> asyncClose() {
        DistributedLock lockToClose;
        synchronized (this) {
            if (null != lockAcquireFuture && !lockAcquireFuture.isDone()) {
                lockAcquireFuture.cancel(true);
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogReadHandler.java`
#### Snippet
```java
            public void onSuccess(Versioned<List<LogSegmentMetadata>> logSegments) {
                List<LogSegmentMetadata> segmentsToNotify = null;
                synchronized (BKLogReadHandler.this) {
                    Versioned<List<LogSegmentMetadata>> lastLogSegments = lastNotifiedLogSegments;
                    if (lastLogSegments.getVersion() == Version.NEW
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogReadHandler.java`
#### Snippet
```java
     */
    void checkReadLock() throws DLIllegalStateException, LockingException {
        synchronized (this) {
            if ((null == lockAcquireFuture)
                    || (!lockAcquireFuture.isDone())) {
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/ReadAheadEntryReader.java`
#### Snippet
```java
    public CompletableFuture<Void> asyncClose() {
        final CompletableFuture<Void> closeFuture;
        synchronized (this) {
            if (null != closePromise) {
                return closePromise;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/ReadAheadEntryReader.java`
#### Snippet
```java

    private void orderedSubmit(Runnable runnable) {
        synchronized (this) {
            if (null != closePromise) {
                return;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/ReadAheadEntryReader.java`
#### Snippet
```java
                openFuture.thenCompose(reader1 -> reader1.asyncClose()),
                () -> {
                    synchronized (SegmentReader.this) {
                        isClosed = true;
                    }
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/ReadAheadEntryReader.java`
#### Snippet
```java
        @Override
        public void run() {
            synchronized (ReadAheadEntryReader.this) {
                if (null != closePromise) {
                    return;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/ReadAheadEntryReader.java`
#### Snippet
```java
                openFuture.thenAccept(reader1 -> {
                    reader1.onLogSegmentMetadataUpdated(segment);
                    synchronized (SegmentReader.this) {
                        SegmentReader.this.metadata = segment;
                    }
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogWriteHandler.java`
#### Snippet
```java
            final Comparator<LogSegmentMetadata> comparator) {
        CompletableFuture<Versioned<List<LogSegmentMetadata>>> result;
        synchronized (this) {
            if (null == fetchForTruncation) {
                fetchForTruncation = readLogSegmentsFromStore(
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogWriteHandler.java`
#### Snippet
```java
                    LOG.info("Initiating Recovery For {} : {}", getFullyQualifiedName(), segmentList);
                    // if lastLedgerRollingTimeMillis is not updated, we set it to now.
                    synchronized (BKLogWriteHandler.this) {
                        if (lastLedgerRollingTimeMillis < 0) {
                            lastLedgerRollingTimeMillis = Utils.nowInMillis();
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/LedgerAllocatorPool.java`
#### Snippet
```java
    public CompletableFuture<Void> asyncClose() {
        List<LedgerAllocator> allocatorsToClose;
        synchronized (this) {
            allocatorsToClose = Lists.newArrayListWithExpectedSize(
                    pendingList.size() + allocatingList.size() + obtainMap.size());
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/LedgerAllocatorPool.java`
#### Snippet
```java
                                                     final Transaction.OpListener<LedgerHandle> listener) {
        final SimpleLedgerAllocator allocator;
        synchronized (this) {
            if (allocatingList.isEmpty()) {
                return FutureUtils.exception(new IOException("No ledger allocator available under " + poolPath + "."));
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/LedgerAllocatorPool.java`
#### Snippet
```java
    public CompletableFuture<Void> delete() {
        List<LedgerAllocator> allocatorsToDelete;
        synchronized (this) {
            allocatorsToDelete = Lists.newArrayListWithExpectedSize(
                    pendingList.size() + allocatingList.size() + obtainMap.size());
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/LedgerAllocatorPool.java`
#### Snippet
```java

    void abortObtain(SimpleLedgerAllocator allocator) {
        synchronized (this) {
            LedgerHandle lh = reverseObtainMap.remove(allocator);
            if (null != lh) {
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/LedgerAllocatorPool.java`
#### Snippet
```java
            @Override
            public void onSuccess(LedgerHandle lh) {
                synchronized (LedgerAllocatorPool.this) {
                    obtainMap.put(lh, allocator);
                    reverseObtainMap.put(allocator, lh);
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/LedgerAllocatorPool.java`
#### Snippet
```java
    public void allocate() throws IOException {
        SimpleLedgerAllocator allocator;
        synchronized (this) {
            if (pendingList.isEmpty()) {
                // if no ledger allocator available, we should fail it immediately,
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/LedgerAllocatorPool.java`
#### Snippet
```java
        try {
            allocator.allocate();
            synchronized (this) {
                allocatingList.addLast(allocator);
            }
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/LedgerAllocatorPool.java`
#### Snippet
```java
    private void rescueAllocator(final SimpleLedgerAllocator ledgerAllocator) throws DLInterruptedException {
        SimpleLedgerAllocator oldAllocator;
        synchronized (this) {
            oldAllocator = rescueMap.put(ledgerAllocator.allocatePath, ledgerAllocator);
        }
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/LedgerAllocatorPool.java`
#### Snippet
```java
            Thread.currentThread().interrupt();
            logger.warn("Interrupted on rescuing ledger allocator {} : ", ledgerAllocator.allocatePath, ie);
            synchronized (LedgerAllocatorPool.this) {
                rescueMap.remove(ledgerAllocator.allocatePath);
            }
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/LedgerAllocatorPool.java`
#### Snippet
```java
            logger.warn("Failed to rescue ledger allocator {}, retry rescuing it later : ",
                    ledgerAllocator.allocatePath, ioe);
            synchronized (LedgerAllocatorPool.this) {
                rescueMap.remove(ledgerAllocator.allocatePath);
            }
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/LedgerAllocatorPool.java`
#### Snippet
```java
                        retry = true;
                    }
                    synchronized (LedgerAllocatorPool.this) {
                        rescueMap.remove(ledgerAllocator.allocatePath);
                        if (null != newAllocator) {
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/LedgerAllocatorPool.java`
#### Snippet
```java

    void confirmObtain(SimpleLedgerAllocator allocator) {
        synchronized (this) {
            LedgerHandle lh = reverseObtainMap.remove(allocator);
            if (null != lh) {
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/LedgerAllocatorPool.java`
#### Snippet
```java
            }
        }
        synchronized (this) {
            pendingList.addLast(allocator);
        }
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogSegmentWriter.java`
#### Snippet
```java
        final BKTransmitPacket packetPreviousSaved;
        final BKTransmitPacket packetCurrentSaved;
        synchronized (this) {
            packetPreviousSaved = packetPrevious;
            packetCurrentSaved = new BKTransmitPacket(recordSetWriter);
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogSegmentWriter.java`
#### Snippet
```java
    private CompletableFuture<Void> closeInternal(boolean abort) {
        CompletableFuture<Void> closePromise;
        synchronized (this) {
            if (null != closeFuture) {
                return closeFuture;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogSegmentWriter.java`
#### Snippet
```java
        transmitLock.lock();
        try {
            synchronized (this) {
                checkWriteLock();
                // If transmitResult is anything other than BKException.Code.OK, it means that the
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogSegmentWriter.java`
#### Snippet
```java
            }

            synchronized (this) {
                // update the transmit timestamp
                lastTransmitNanos = MathUtils.nowInNano();
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogSegmentWriter.java`
#### Snippet
```java
            EntryBuffer recordSet = transmitPacket.getRecordSet();
            if (recordSet.hasUserRecords()) {
                synchronized (this) {
                    lastTxIdAcknowledged = Math.max(lastTxIdAcknowledged, recordSet.getMaxTxId());
                }
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogSegmentWriter.java`
#### Snippet
```java
        boolean cancelPendingPromises = false;
        EntryBuffer recordSet = transmitPacket.getRecordSet();
        synchronized (this) {
            if (transmitResultUpdater.compareAndSet(this, BKException.Code.OK, rc)) {
                // If this is the first time we are setting an error code in the transmitResult then
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogSegmentWriter.java`
#### Snippet
```java
            // try to cancel the current packet;
            final BKTransmitPacket packetCurrentSaved;
            synchronized (this) {
                packetCurrentSaved = new BKTransmitPacket(recordSetWriter);
                recordSetWriter = newRecordSetWriter();
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogSegmentWriter.java`
#### Snippet
```java
     */
    public CompletableFuture<Long> markEndOfStream() {
        synchronized (this) {
            try {
                writeEndOfStreamMarker();
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogSegmentWriter.java`
#### Snippet
```java
                @Override
                public void run() {
                    synchronized (this) {
                        scheduledFutureRefUpdater.set(BKLogSegmentWriter.this, null);
                        try {
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/ZKMetadataAccessor.java`
#### Snippet
```java
    public CompletableFuture<Void> asyncClose() {
        CompletableFuture<Void> closeFuture;
        synchronized (this) {
            if (null != closePromise) {
                return closePromise;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/logsegment/BKLogSegmentRandomAccessEntryReader.java`
#### Snippet
```java
    public CompletableFuture<Void> asyncClose() {
        final CompletableFuture<Void> closeFuture;
        synchronized (this) {
            if (null != closePromise) {
                return closePromise;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
    public void onAbort(Throwable t) {
        OpListener<LedgerHandle> listenerToNotify;
        synchronized (this) {
            listenerToNotify = tryObtainListener;
            if (t instanceof KeeperException
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
    private CompletableFuture<Void> closeInternal(boolean cleanup) {
        CompletableFuture<Void> closePromise;
        synchronized (this) {
            if (null != closeFuture) {
                return closeFuture;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
        OpListener<LedgerHandle> listenerToNotify = null;
        LedgerHandle lhToNotify = null;
        synchronized (this) {
            if (Phase.HANDING_OVER == phase) {
                setPhase(Phase.HANDED_OVER);
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/logsegment/BKLogSegmentEntryReader.java`
#### Snippet
```java
    private void issueLongPollRead(CacheEntry cacheEntry) {
        // register the read as outstanding reads
        synchronized (this) {
            this.outstandingLongPoll = cacheEntry;
        }
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/logsegment/BKLogSegmentEntryReader.java`
#### Snippet
```java
        ReadCancelledException exception;
        LedgerHandle[] lhsToClose;
        synchronized (this) {
            if (null != closePromise) {
                return closePromise;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/logsegment/BKLogSegmentEntryReader.java`
#### Snippet
```java

    private void releaseAllCachedEntries() {
        synchronized (this) {
            CacheEntry entry = readAheadEntries.poll();
            while (null != entry) {
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/logsegment/BKLogSegmentEntryReader.java`
#### Snippet
```java
            CacheEntry entry;
            boolean hitEndOfLogSegment;
            synchronized (this) {
                entry = readAheadEntries.peek();
                hitEndOfLogSegment = (null == entry) && isEndOfLogSegment();
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/logsegment/BKLogSegmentEntryReader.java`
#### Snippet
```java
    private void prefetchIfNecessary() {
        List<CacheEntry> entriesToFetch;
        synchronized (this) {
            if (cachedEntries >= maxPrefetchEntries) {
                return;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/logsegment/BKLogSegmentEntryReader.java`
#### Snippet
```java
    private void onReadEntryDone(boolean success) {
        // we successfully read an entry
        synchronized (this) {
            --numOutstandingEntries;
        }
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/logsegment/BKLogSegmentEntryReader.java`
#### Snippet
```java

        void setDone(boolean success) {
            synchronized (this) {
                this.done = true;
            }
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/logsegment/BKLogSegmentEntryReader.java`
#### Snippet
```java

        void completeExceptionally(int rc) {
            synchronized (this) {
                if (done) {
                    return;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/logsegment/BKLogSegmentEntryReader.java`
#### Snippet
```java

    private void onEntriesConsumed(int numEntries) {
        synchronized (this) {
            cachedEntries -= numEntries;
        }
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/logsegment/BKLogSegmentEntryReader.java`
#### Snippet
```java
        // switch to new ledger handle if the log segment is moved to completed.
        CacheEntry longPollRead = null;
        synchronized (this) {
            if (isClosed()) {
                lh.asyncClose(new AsyncCallback.CloseCallback() {
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/logsegment/BKLogSegmentEntryReader.java`
#### Snippet
```java
                release(entry);
            }
            synchronized (this) {
                if (done) {
                    return;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/federated/FederatedZKLogMetadataStore.java`
#### Snippet
```java
            // update the sub namespace cache
            CompletableFuture<Set<String>> newLogsPromise;
            synchronized (this) {
                if (logsFuture.isDone()) { // the promise is already satisfied
                    try {
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKDistributedLogManager.java`
#### Snippet
```java

        CompletableFuture<BKLogWriteHandler> createWriteHandleFuture;
        synchronized (this) {
            // 1. create the locked write handler
            createWriteHandleFuture = asyncCreateWriteHandler(true, ledgerMetadata);
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKDistributedLogManager.java`
#### Snippet
```java
        return createWriteHandleFuture.thenCompose(writeHandler -> {
            final BKAsyncLogWriter writer;
            synchronized (BKDistributedLogManager.this) {
                // 2. create the writer with the handler
                writer = new BKAsyncLogWriter(
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKDistributedLogManager.java`
#### Snippet
```java
        CompletableFuture<Void> closeFuture;
        BKLogReadHandler readHandlerToClose;
        synchronized (this) {
            if (null != closePromise) {
                return closePromise;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKDistributedLogManager.java`
#### Snippet
```java

    public void checkClosedOrInError(String operation) throws AlreadyClosedException {
        synchronized (this) {
            if (null != closePromise) {
                throw new AlreadyClosedException("Executing " + operation + " on already closed DistributedLogManager");
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/lock/ZKDistributedLock.java`
#### Snippet
```java
    public CompletableFuture<Void> asyncClose() {
        final CompletableFuture<Void> closePromise;
        synchronized (this) {
            if (closed) {
                return closeFuture;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/lock/ZKDistributedLock.java`
#### Snippet
```java
                @Override
                public void onFailure(Throwable cause) {
                    synchronized (ZKDistributedLock.this) {
                        if (cause instanceof LockingException) {
                            lockReacquireException = (LockingException) cause;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/lock/ZKDistributedLock.java`
#### Snippet
```java
                @Override
                public void onSuccess(LockWaiter waiter) {
                    synchronized (ZKDistributedLock.this) {
                        if (closed) {
                            LOG.info("Skipping acquiring lock {} since it is already closed", lockPath);
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/lock/ZKDistributedLock.java`
#### Snippet
```java
            @Override
            public void onSuccess(SessionLock lock) {
                synchronized (ZKDistributedLock.this) {
                    if (closed) {
                        LOG.info("Skipping tryLocking lock {} since it is already closed", lockPath);
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/lock/ZKDistributedLock.java`
#### Snippet
```java
                    }
                }
                synchronized (ZKDistributedLock.this) {
                    internalLock = lock;
                    internalLock.setLockListener(ZKDistributedLock.this);
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/lock/ZKDistributedLock.java`
#### Snippet
```java
        final Stopwatch stopwatch = Stopwatch.createStarted();
        CompletableFuture<ZKDistributedLock> lockPromise;
        synchronized (this) {
            if (closed) {
                throw newLockClosedException();
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/lock/ZKDistributedLock.java`
#### Snippet
```java
                public void onSuccess(ZKDistributedLock lock) {
                    // if re-acquire successfully, clear the state.
                    synchronized (ZKDistributedLock.this) {
                        lockReacquireFuture = null;
                    }
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/common/src/main/java/org/apache/bookkeeper/common/grpc/proxy/ProxyCall.java`
#### Snippet
```java
        public void onMessage(RespT message) {
            serverCall.sendMessage(message);
            synchronized (this) {
                if (serverCall.isReady()) {
                    serverCallListener.clientCall.request(1);
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/common/src/main/java/org/apache/bookkeeper/common/grpc/proxy/ProxyCall.java`
#### Snippet
```java
        public void onMessage(ReqT message) {
            clientCall.sendMessage(message);
            synchronized (this) {
                if (clientCall.isReady()) {
                    clientCallListener.serverCall.request(1);
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/common/src/main/java/org/apache/bookkeeper/common/util/AbstractAutoAsyncCloseable.java`
#### Snippet
```java
    public CompletableFuture<Void> closeAsync() {
        CompletableFuture<Void> savedFuture;
        synchronized (this) {
            if (null != closeFuture) {
                return closeFuture;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/common/src/main/java/org/apache/bookkeeper/common/resolver/AbstractNameResolver.java`
#### Snippet
```java
        public void run() {
            Listener savedListener;
            synchronized (AbstractNameResolver.this) {
                if (shutdown) {
                    return;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/common/src/main/java/org/apache/bookkeeper/common/resolver/AbstractNameResolver.java`
#### Snippet
```java
                savedListener.onAddresses(servers, Attributes.EMPTY);
            } finally {
                synchronized (AbstractNameResolver.this) {
                    resolving = false;
                }
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/distributedlog/io/dlfs/src/main/java/org/apache/distributedlog/fs/DLOutputStream.java`
#### Snippet
```java
    private CompletableFuture<DLSN> writeControlRecord() {
        LogRecord record;
        synchronized (this) {
            record = new LogRecord(writePos, Unpooled.wrappedBuffer(CONTROL_RECORD_CONTENT));
            record.setControl();
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-benchmark/src/main/java/org/apache/bookkeeper/benchmark/BenchBookie.java`
#### Snippet
```java
            count++;
            if (count >= waitingCount) {
                notifyAll();
            }
        }
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-benchmark/src/main/java/org/apache/bookkeeper/benchmark/BenchBookie.java`
#### Snippet
```java
            while (this.count < count) {
                waitingCount = count;
                wait(1000);
            }
            waitingCount = Integer.MAX_VALUE;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-benchmark/src/main/java/org/apache/bookkeeper/benchmark/BenchBookie.java`
#### Snippet
```java
            }
            complete = true;
            notifyAll();
        }
        public synchronized void resetComplete() {
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-benchmark/src/main/java/org/apache/bookkeeper/benchmark/BenchBookie.java`
#### Snippet
```java
        public synchronized void waitForComplete() throws InterruptedException {
            while (!complete) {
                wait();
            }
        }
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-benchmark/src/main/java/org/apache/bookkeeper/benchmark/BenchThroughputLatency.java`
#### Snippet
```java
            Thread.currentThread().interrupt();
        }
        synchronized (this) {
            duration = System.currentTimeMillis() - start;
        }
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVAsyncStore.java`
#### Snippet
```java
    @Override
    public CompletableFuture<Void> put(K key, V value) {
        synchronized (this) {
            if (!isInitialized) {
                return uninitializedException();
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVAsyncStore.java`
#### Snippet
```java
    @Override
    public CompletableFuture<V> get(K key) {
        synchronized (this) {
            if (!isInitialized) {
                return uninitializedException();
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/mvcc/MVCCAsyncBytesStoreImpl.java`
#### Snippet
```java
    @Override
    public CompletableFuture<DeleteResult<byte[], byte[]>> delete(DeleteOp<byte[], byte[]> op) {
        synchronized (this) {
            if (!isInitialized) {
                return FutureUtils.exception(new InvalidStateStoreException("State store is not initialized yet."));
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/mvcc/MVCCAsyncBytesStoreImpl.java`
#### Snippet
```java
    @Override
    public CompletableFuture<PutResult<byte[], byte[]>> put(PutOp<byte[], byte[]> op) {
        synchronized (this) {
            if (!isInitialized) {
                return FutureUtils.exception(new InvalidStateStoreException("State store is not initialized yet."));
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/mvcc/MVCCAsyncBytesStoreImpl.java`
#### Snippet
```java
    @Override
    public CompletableFuture<TxnResult<byte[], byte[]>> txn(TxnOp<byte[], byte[]> op) {
        synchronized (this) {
            if (!isInitialized) {
                return FutureUtils.exception(new InvalidStateStoreException("State store is not initialized yet."));
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/mvcc/MVCCAsyncBytesStoreImpl.java`
#### Snippet
```java
    @Override
    public CompletableFuture<RangeResult<byte[], byte[]>> range(RangeOp<byte[], byte[]> rangeOp) {
        synchronized (this) {
            if (!isInitialized) {
                return FutureUtils.exception(new InvalidStateStoreException("State store is not initialized yet."));
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/mvcc/MVCCAsyncBytesStoreImpl.java`
#### Snippet
```java
    @Override
    public CompletableFuture<IncrementResult<byte[], byte[]>> increment(IncrementOp<byte[], byte[]> op) {
        synchronized (this) {
            if (!isInitialized) {
                return FutureUtils.exception(new InvalidStateStoreException("State store is not initialized yet."));
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/dlog/DLOutputStream.java`
#### Snippet
```java
    private CompletableFuture<DLSN> writeControlRecord() {
        LogRecord record;
        synchronized (this) {
            record = new LogRecord(writePos, Unpooled.wrappedBuffer(CONTROL_RECORD_CONTENT));
            record.setControl();
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/journal/AbstractStateStoreWithJournal.java`
#### Snippet
```java
    public CompletableFuture<Void> closeAsync() {
        CompletableFuture<Void> future;
        synchronized (this) {
            if (null != closeFuture) {
                return closeFuture;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/journal/AbstractStateStoreWithJournal.java`
#### Snippet
```java

    private CompletableFuture<DLSN> getLastDLSN(StateStoreSpec spec) {
        synchronized (this) {
            if (null != closeFuture) {
                return FutureUtils.exception(new StateStoreClosedException(name()));
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/journal/AbstractStateStoreWithJournal.java`
#### Snippet
```java
        metadata.setComponent("state-store");
        return logManager.openAsyncLogWriter(metadata).thenComposeAsync(w -> {
            synchronized (this) {
                writer = w;
                nextRevision = writer.getLastTxId();
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/journal/AbstractStateStoreWithJournal.java`
#### Snippet
```java
        }).thenCompose(dlsn -> {
            AsyncLogWriter w;
            synchronized (this) {
                w = writer;
            }
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/journal/AbstractStateStoreWithJournal.java`
#### Snippet
```java

    private void replayLoop(AsyncLogReader reader) {
        synchronized (this) {
            if (null != closeFuture) {
                reader.asyncClose();
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/journal/AbstractStateStoreWithJournal.java`
#### Snippet
```java

    private CompletableFuture<DLSN> initializeJournalWriter(StateStoreSpec spec) {
        synchronized (this) {
            if (null != closeFuture) {
                return FutureUtils.exception(new StateStoreClosedException(name()));
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/journal/AbstractStateStoreWithJournal.java`
#### Snippet
```java
        metadata.setComponent("state-store");
        return logManager.openAsyncLogWriter(metadata).thenComposeAsync(w -> {
            synchronized (this) {
                writer = w;
                nextRevision = writer.getLastTxId();
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/journal/AbstractStateStoreWithJournal.java`
#### Snippet
```java
    private <T> CompletableFuture<T> executeIO(ScheduledExecutorService scheduler,
                                               Callable<T> callable) {
        synchronized (this) {
            if (null != closeFuture) {
                return FutureUtils.exception(new StateStoreClosedException(name()));
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/journal/AbstractStateStoreWithJournal.java`
#### Snippet
```java
                               DLSN endDLSN,
                               CompletableFuture<Void> future) {
        synchronized (this) {
            if (null != closeFuture) {
                FutureUtils.completeExceptionally(future, new StateStoreClosedException(name()));
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/journal/AbstractStateStoreWithJournal.java`
#### Snippet
```java
                               CompletableFuture<Void> future,
                               long startingTxId) {
        synchronized (this) {
            if (null != closeFuture) {
                FutureUtils.completeExceptionally(future, new StateStoreClosedException(name()));
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/SharedResourceManager.java`
#### Snippet
```java
            }
            cached.destroyTask = destroyer.schedule(new LogExceptionRunnable(() -> {
                synchronized (SharedResourceManager.this) {
                    // Refcount may have gone up since the task was scheduled. Re-check it.
                    if (cached.refCount == 0) {
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/Watchable.java`
#### Snippet
```java
    public <R> void notifyWatchers(Function<R, T> valueFn, R value) {
        RecyclableArrayList<Watcher<T>> watchersLocal;
        synchronized (this) {
            watchersLocal = watchers;
            watchers = recycler.newInstance();
```

## RuleId[id=DuplicateThrows]
### DuplicateThrows
There is a more general exception, 'java.io.IOException', in the throws list already.
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/sasl/SaslServerState.java`
#### Snippet
```java
    public SaslServerState(
        ServerConfiguration serverConfiguration, Subject subject, Pattern allowedIdsPattern)
        throws IOException, SaslException, LoginException {
        this.allowedIdsPattern = allowedIdsPattern;
        saslServer = createSaslServer(subject, serverConfiguration);
```

### DuplicateThrows
There is a more general exception, 'java.io.IOException', in the throws list already.
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/sasl/SaslServerState.java`
#### Snippet
```java

    private SaslServer createSaslServer(final Subject subject, ServerConfiguration serverConfiguration)
        throws SaslException, IOException {

        SaslServerCallbackHandler callbackHandler = new SaslServerCallbackHandler(Configuration.getConfiguration(),
```

### DuplicateThrows
There is a more general exception, 'java.io.IOException', in the throws list already.
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Bookie.java`
#### Snippet
```java
    void setExplicitLac(ByteBuf entry, WriteCallback writeCallback, Object ctx, byte[] masterKey)
            throws IOException, InterruptedException, BookieException;
    ByteBuf getExplicitLac(long ledgerId) throws IOException, NoLedgerException, BookieException;

    // these can probably be moved out and called directly on ledgerdirmanager
```

### DuplicateThrows
There is a more general exception, 'java.io.IOException', in the throws list already.
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Bookie.java`
#### Snippet
```java
            throws IOException, NoLedgerException, BookieException;
    long readLastAddConfirmed(long ledgerId) throws IOException, BookieException;
    PrimitiveIterator.OfLong getListOfEntriesOfLedger(long ledgerId) throws IOException, NoLedgerException;

    /**
```

### DuplicateThrows
There is a more general exception, 'java.io.IOException', in the throws list already.
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Bookie.java`
#### Snippet
```java
    // TODO: Shouldn't this be async?
    ByteBuf readEntry(long ledgerId, long entryId)
            throws IOException, NoLedgerException, BookieException;
    long readLastAddConfirmed(long ledgerId) throws IOException, BookieException;
    PrimitiveIterator.OfLong getListOfEntriesOfLedger(long ledgerId) throws IOException, NoLedgerException;
```

### DuplicateThrows
There is a more general exception, 'java.io.IOException', in the throws list already.
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LedgerDescriptor.java`
#### Snippet
```java
    static LedgerDescriptor createReadOnly(long ledgerId,
                                           LedgerStorage ledgerStorage)
            throws IOException, Bookie.NoLedgerException {
        if (!ledgerStorage.ledgerExists(ledgerId)) {
            throw new Bookie.NoLedgerException(ledgerId);
```

### DuplicateThrows
There is a more general exception, 'java.io.IOException', in the throws list already.
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieFileChannel.java`
#### Snippet
```java
     * @return
     */
    FileChannel getFileChannel() throws FileNotFoundException, IOException;

    /**
```

### DuplicateThrows
There is a more general exception, 'java.io.IOException', in the throws list already.
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/HandleFactoryImpl.java`
#### Snippet
```java

    @Override
    public LedgerDescriptor getReadOnlyHandle(final long ledgerId) throws IOException, Bookie.NoLedgerException {
        LedgerDescriptor handle = readOnlyLedgers.get(ledgerId);

```

### DuplicateThrows
There is a more general exception, 'java.io.IOException', in the throws list already.
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Cookie.java`
#### Snippet
```java
     * @throws IOException
     */
    public static Cookie readFromDirectory(File directory) throws IOException, FileNotFoundException {
        File versionFile = new File(directory, BookKeeperConstants.VERSION_FILENAME);
        try (BufferedReader reader = new BufferedReader(
```

### DuplicateThrows
There is a more general exception, 'java.io.IOException', in the throws list already.
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/HandleFactory.java`
#### Snippet
```java

    LedgerDescriptor getReadOnlyHandle(long ledgerId)
            throws IOException, Bookie.NoLedgerException;
}

```

### DuplicateThrows
There is a more general exception, 'java.io.IOException', in the throws list already.
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/DefaultEntryLogger.java`
#### Snippet
```java
    @Override
    public ByteBuf readEntry(long ledgerId, long entryId, long entryLocation)
            throws IOException, Bookie.NoEntryException {
        return internalReadEntry(ledgerId, entryId, entryLocation, true /* validateEntry */);
    }
```

### DuplicateThrows
There is a more general exception, 'java.io.IOException', in the throws list already.
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/DefaultEntryLogger.java`
#### Snippet
```java

    private ByteBuf internalReadEntry(long ledgerId, long entryId, long location, boolean validateEntry)
            throws IOException, Bookie.NoEntryException {
        long entryLogId = logIdForOffset(location);
        long pos = posForOffset(location);
```

### DuplicateThrows
There is a more general exception, 'java.io.IOException', in the throws list already.
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/DefaultEntryLogger.java`
#### Snippet
```java

    @Override
    public ByteBuf readEntry(long location) throws IOException, Bookie.NoEntryException {
        return internalReadEntry(location, -1L, -1L, false /* validateEntry */);
    }
```

### DuplicateThrows
There is a more general exception, 'java.io.IOException', in the throws list already.
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/EntryLogger.java`
#### Snippet
```java
     */
    ByteBuf readEntry(long entryLocation)
            throws IOException, NoEntryException;
    /**
     * Read an entry from an entrylog location, and verify that is matches the
```

### DuplicateThrows
There is a more general exception, 'java.io.IOException', in the throws list already.
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/EntryLogger.java`
#### Snippet
```java
     */
    ByteBuf readEntry(long ledgerId, long entryId, long entryLocation)
            throws IOException, NoEntryException;

    /**
```

### DuplicateThrows
There is a more general exception, 'java.io.IOException', in the throws list already.
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/IndexPersistenceMgr.java`
#### Snippet
```java
    private void writeBuffers(Long ledger,
                              List<LedgerEntryPage> entries, FileInfo fi,
                              int start, int count) throws IOException, Bookie.NoLedgerException {
        if (LOG.isTraceEnabled()) {
            LOG.trace("Writing {} buffers of {}", count, Long.toHexString(ledger));
```

### DuplicateThrows
There is a more general exception, 'java.io.IOException', in the throws list already.
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/IndexPersistenceMgr.java`
#### Snippet
```java
    }

    private void moveLedgerIndexFile(Long l, FileInfo fi) throws NoWritableLedgerDirException, IOException {
        File newLedgerIndexFile = getNewLedgerIndexFile(l, getLedgerDirForLedger(fi));
        try {
```

### DuplicateThrows
There is a more general exception, 'java.io.IOException', in the throws list already.
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieImpl.java`
#### Snippet
```java

    public ByteBuf readEntry(long ledgerId, long entryId)
            throws IOException, NoLedgerException, BookieException {
        long requestNanos = MathUtils.nowInNano();
        boolean success = false;
```

### DuplicateThrows
There is a more general exception, 'java.io.IOException', in the throws list already.
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieImpl.java`
#### Snippet
```java
    }

    public OfLong getListOfEntriesOfLedger(long ledgerId) throws IOException, NoLedgerException {
        long requestNanos = MathUtils.nowInNano();
        boolean success = false;
```

### DuplicateThrows
There is a more general exception, 'java.io.IOException', in the throws list already.
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieImpl.java`
#### Snippet
```java
    }

    public ByteBuf getExplicitLac(long ledgerId) throws IOException, Bookie.NoLedgerException, BookieException {
        ByteBuf lac;
        LedgerDescriptor handle = handles.getReadOnlyHandle(ledgerId);
```

### DuplicateThrows
There is a more general exception, 'java.io.IOException', in the throws list already.
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/LogReader.java`
#### Snippet
```java
     * @return a bytebuf. The caller must release.
     */
    ByteBuf readEntryAt(int offset) throws IOException, EOFException;

    @Override
```

### DuplicateThrows
There is a more general exception, 'java.io.IOException', in the throws list already.
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/LogReader.java`
#### Snippet
```java
     * @return a bytebuf. The caller must release.
     */
    ByteBuf readBufferAt(long offset, int size) throws IOException, EOFException;

    void readIntoBufferAt(ByteBuf buffer, long offset, int size) throws IOException, EOFException;
```

### DuplicateThrows
There is a more general exception, 'java.io.IOException', in the throws list already.
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/LogReader.java`
#### Snippet
```java
     * @return the integer at that offset.
     */
    int readIntAt(long offset) throws IOException, EOFException;

    /**
```

### DuplicateThrows
There is a more general exception, 'java.io.IOException', in the throws list already.
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/LogReader.java`
#### Snippet
```java
     * @return the long at that offset.
     */
    long readLongAt(long offset) throws IOException, EOFException;

    /**
```

### DuplicateThrows
There is a more general exception, 'java.io.IOException', in the throws list already.
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/LogReader.java`
#### Snippet
```java
    ByteBuf readBufferAt(long offset, int size) throws IOException, EOFException;

    void readIntoBufferAt(ByteBuf buffer, long offset, int size) throws IOException, EOFException;

    /**
```

### DuplicateThrows
There is a more general exception, 'java.io.IOException', in the throws list already.
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectReader.java`
#### Snippet
```java

    @Override
    public int readIntAt(long offset) throws IOException, EOFException {
        assertValidOffset(offset);
        synchronized (nativeBuffer) {
```

### DuplicateThrows
There is a more general exception, 'java.io.IOException', in the throws list already.
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectReader.java`
#### Snippet
```java

    @Override
    public void readIntoBufferAt(ByteBuf buffer, long offset, int size) throws IOException, EOFException {
        assertValidOffset(offset);
        synchronized (nativeBuffer) {
```

### DuplicateThrows
There is a more general exception, 'java.io.IOException', in the throws list already.
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectReader.java`
#### Snippet
```java
    }

    private int readBytesIntoBuf(ByteBuf buf, long offset, int size) throws IOException, EOFException {
        synchronized (nativeBuffer) {
            if (offset < currentBlock || offset >= currentBlockEnd) {
```

### DuplicateThrows
There is a more general exception, 'java.io.IOException', in the throws list already.
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectReader.java`
#### Snippet
```java

    @Override
    public ByteBuf readEntryAt(int offset) throws IOException, EOFException {
        assertValidEntryOffset(offset);
        int sizeOffset = offset - Integer.BYTES;
```

### DuplicateThrows
There is a more general exception, 'java.io.IOException', in the throws list already.
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectReader.java`
#### Snippet
```java

    @Override
    public long readLongAt(long offset) throws IOException, EOFException {
        assertValidOffset(offset);
        synchronized (nativeBuffer) {
```

### DuplicateThrows
There is a more general exception, 'java.io.IOException', in the throws list already.
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectReader.java`
#### Snippet
```java

    @Override
    public ByteBuf readBufferAt(long offset, int size) throws IOException, EOFException {
        ByteBuf buf = allocator.buffer(size);
        try {
```

### DuplicateThrows
There is a more general exception, 'java.io.IOException', in the throws list already.
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectEntryLogger.java`
#### Snippet
```java

    private ByteBuf internalReadEntry(long ledgerId, long entryId, long location, boolean validateEntry)
            throws IOException, NoEntryException {
        int logId = (int) (location >> 32);
        int pos = (int) (location & 0xFFFFFFFF);
```

### DuplicateThrows
There is a more general exception, 'java.io.IOException', in the throws list already.
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectEntryLogger.java`
#### Snippet
```java
    @Override
    public ByteBuf readEntry(long ledgerId, long entryId, long entryLocation)
            throws IOException, NoEntryException {
        return internalReadEntry(ledgerId, entryId, entryLocation, true);
    }
```

### DuplicateThrows
There is a more general exception, 'java.io.IOException', in the throws list already.
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectEntryLogger.java`
#### Snippet
```java
    @Override
    public ByteBuf readEntry(long entryLocation)
            throws IOException, NoEntryException {
        return internalReadEntry(-1L, -1L, entryLocation, false);
    }
```

### DuplicateThrows
There is a more general exception, 'java.io.IOException', in the throws list already.
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/EnvelopedEntryWriter.java`
#### Snippet
```java

    @Override
    public synchronized ByteBuf getBuffer() throws InvalidEnvelopedEntryException, IOException {
        if (null == finalizedBuffer) {
            finalizedBuffer = finalizeBuffer();
```

### DuplicateThrows
There is a more general exception, 'java.io.IOException', in the throws list already.
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKDistributedLogNamespace.java`
#### Snippet
```java
    @Override
    public void createLog(String logName)
            throws InvalidStreamNameException, IOException {
        checkState();
        logName = validateAndNormalizeName(logName);
```

### DuplicateThrows
There is a more general exception, 'java.io.IOException', in the throws list already.
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKDistributedLogNamespace.java`
#### Snippet
```java
                                         Optional<DynamicDistributedLogConfiguration> dynamicLogConf,
                                         Optional<StatsLogger> perStreamStatsLogger)
            throws InvalidStreamNameException, IOException {
        checkState();
        logName = validateAndNormalizeName(logName);
```

### DuplicateThrows
There is a more general exception, 'java.io.IOException', in the throws list already.
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKDistributedLogNamespace.java`
#### Snippet
```java
    @Override
    public void deleteLog(String logName)
            throws InvalidStreamNameException, LogNotFoundException, IOException {
        checkState();
        logName = validateAndNormalizeName(logName);
```

### DuplicateThrows
There is a more general exception, 'java.io.IOException', in the throws list already.
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKDistributedLogNamespace.java`
#### Snippet
```java
    @Override
    public void deleteLog(String logName)
            throws InvalidStreamNameException, LogNotFoundException, IOException {
        checkState();
        logName = validateAndNormalizeName(logName);
```

### DuplicateThrows
There is a more general exception, 'java.io.IOException', in the throws list already.
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKDistributedLogNamespace.java`
#### Snippet
```java
    @Override
    public DistributedLogManager openLog(String logName)
            throws InvalidStreamNameException, IOException {
        return openLog(logName,
                Optional.empty(),
```

### DuplicateThrows
There is a more general exception, 'java.io.IOException', in the throws list already.
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogSegmentWriter.java`
#### Snippet
```java

        @Override
        public ByteBuf getBuffer() throws InvalidEnvelopedEntryException, IOException {
            throw new IOException("GetBuffer is not supported.");
        }
```

### DuplicateThrows
There is a more general exception, 'java.io.IOException', in the throws list already.
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/BKNamespaceDriver.java`
#### Snippet
```java
    @Override
    public org.apache.distributedlog.api.MetadataAccessor getMetadataAccessor(String streamName)
            throws InvalidStreamNameException, IOException {
        if (getBkdlConfig().isFederatedNamespace()) {
            throw new UnsupportedOperationException();
```

### DuplicateThrows
There is a more general exception, 'java.io.IOException', in the throws list already.
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/namespace/NamespaceDriver.java`
#### Snippet
```java
    @SuppressWarnings("deprecation")
    org.apache.distributedlog.api.MetadataAccessor getMetadataAccessor(String streamName)
            throws InvalidStreamNameException, IOException;

    /**
```

### DuplicateThrows
There is a more general exception, 'java.io.IOException', in the throws list already.
in `stream/distributedlog/io/dlfs/src/main/java/org/apache/distributedlog/fs/DLFileSystem.java`
#### Snippet
```java

    @Override
    public FileStatus[] listStatus(Path path) throws FileNotFoundException, IOException {
        String logName = getStreamName(path);
        try {
```

## RuleId[id=UnstableTypeUsedInSignature]
### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NodeBase.java`
#### Snippet
```java
     * @return the path of a node
     */
    public static String getPath(Node node) {
        return node.getNetworkLocation() + PATH_SEPARATOR_STR + node.getName();
    }
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NodeBase.java`
#### Snippet
```java
     */
    @Override
    public void setParent(Node parent) {
        this.parent = parent;
    }
```

### UnstableTypeUsedInSignature
Field must be marked with '@com.google.common.annotations.Beta' annotation because its type references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NodeBase.java`
#### Snippet
```java
    protected String location; //string representation of this node's location
    protected int level; //which level of the tree the node resides
    protected Node parent; //its parent

    /**
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NodeBase.java`
#### Snippet
```java
    /** @return this node's parent */
    @Override
    public Node getParent() {
        return parent;
    }
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NodeBase.java`
#### Snippet
```java
     * @param level this node's level in the tree
     */
    public NodeBase(String name, String location, Node parent, int level) {
        set(name, normalize(location));
        this.parent = parent;
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.DNSToSwitchMapping'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NetUtils.java`
#### Snippet
```java
    }

    public static String resolveNetworkLocation(DNSToSwitchMapping dnsResolver,
                                                BookieSocketAddress addr) {
        List<String> names = new ArrayList<String>(1);
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NetworkTopology.java`
#### Snippet
```java
     *          remove the node from network topology
     */
    void remove(Node node);

    /**
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NetworkTopology.java`
#### Snippet
```java
     *          add the node to network topology
     */
    void add(Node node);

    /**
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NetworkTopology.java`
#### Snippet
```java
     * @return
     */
    Node getNode(String loc);

    /**
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NetworkTopology.java`
#### Snippet
```java
     * @return nodes under a location
     */
    Set<Node> getLeaves(String loc);

    /**
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NetworkTopology.java`
#### Snippet
```java
     * @return number of available nodes
     */
    int countNumOfAvailableNodes(String scope, Collection<Node> excludedNodes);
}

```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NetworkTopology.java`
#### Snippet
```java
     * @return true if <i>node</i> is already in the network topology, otherwise false.
     */
    boolean contains(Node node);

    /**
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.DNSToSwitchMapping'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/CachedDNSToSwitchMapping.java`
#### Snippet
```java
   * @param rawMapping the raw mapping to cache
   */
  public CachedDNSToSwitchMapping(DNSToSwitchMapping rawMapping) {
    this.rawMapping = rawMapping;
  }
```

### UnstableTypeUsedInSignature
Field must be marked with '@com.google.common.annotations.Beta' annotation because its type references unstable type 'org.apache.bookkeeper.net.DNSToSwitchMapping'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/CachedDNSToSwitchMapping.java`
#### Snippet
```java
   * The uncached mapping.
   */
  protected final DNSToSwitchMapping rawMapping;

  /**
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.DNSToSwitchMapping'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/AbstractDNSToSwitchMapping.java`
#### Snippet
```java
     * is not derived from this class.
     */
    public static boolean isMappingSingleSwitch(DNSToSwitchMapping mapping) {
        return mapping != null && mapping instanceof AbstractDNSToSwitchMapping
                && ((AbstractDNSToSwitchMapping) mapping).isSingleSwitch();
```

### UnstableTypeUsedInSignature
Field must be marked with '@com.google.common.annotations.Beta' annotation because its type references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/StabilizeNetworkTopology.java`
#### Snippet
```java
    protected final HashedWheelTimer timer;
    // statuses
    protected final ConcurrentMap<Node, NodeStatus> nodeStatuses;
    // stabilize period seconds
    protected final long stabilizePeriodMillis;
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/StabilizeNetworkTopology.java`
#### Snippet
```java

    @Override
    public boolean contains(Node node) {
        return impl.contains(node);
    }
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/StabilizeNetworkTopology.java`
#### Snippet
```java

    @Override
    public int countNumOfAvailableNodes(String scope, Collection<Node> excludedNodes) {
        return impl.countNumOfAvailableNodes(scope, excludedNodes);
    }
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/StabilizeNetworkTopology.java`
#### Snippet
```java

    @Override
    public Set<Node> getLeaves(String loc) {
        return impl.getLeaves(loc);
    }
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/StabilizeNetworkTopology.java`
#### Snippet
```java

    @Override
    public Node getNode(String loc) {
        return impl.getNode(loc);
    }
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/StabilizeNetworkTopology.java`
#### Snippet
```java

    @Override
    public void remove(Node node) {
        updateNode(node, true);
        timer.newTimeout(new RemoveNodeTask(node), stabilizePeriodMillis, TimeUnit.MILLISECONDS);
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/StabilizeNetworkTopology.java`
#### Snippet
```java

    @Override
    public void add(Node node) {
        updateNode(node, false);
        this.impl.add(node);
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NetworkTopologyImpl.java`
#### Snippet
```java
     * node1 or node2 do not belong to the cluster
     */
    public boolean isOnSameRack(Node node1, Node node2) {
        if (node1 == null || node2 == null) {
            return false;
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NetworkTopologyImpl.java`
#### Snippet
```java
     */
    @Override
    public Node getNode(String loc) {
        netlock.readLock().lock();
        try {
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NetworkTopologyImpl.java`
#### Snippet
```java

    @Override
    public Set<Node> getLeaves(String scope) {
        netlock.readLock().lock();
        try {
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NetworkTopologyImpl.java`
#### Snippet
```java
     * @return a newly allocated list with all the node's children
     */
    public List<Node> getDatanodesInRack(String loc) {
        netlock.readLock().lock();
        try {
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NetworkTopologyImpl.java`
#### Snippet
```java
     */
    @Override
    public void add(Node node) {
        if (node == null) {
            return;
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NetworkTopologyImpl.java`
#### Snippet
```java
     */
    @Override
    public void remove(Node node) {
        if (node == null) {
            return;
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NetworkTopologyImpl.java`
#### Snippet
```java
     */
    @Override
    public boolean contains(Node node) {
        if (node == null) {
            return false;
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NetworkTopologyImpl.java`
#### Snippet
```java
     * Swap two array items.
     */
    protected static void swap(Node[] nodes, int i, int j) {
        Node tempNode;
        tempNode = nodes[j];
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NetworkTopologyImpl.java`
#### Snippet
```java
     * @see #isOnSameRack(Node, Node)
     */
    protected boolean isSameParents(Node node1, Node node2) {
        return node1.getParent() == node2.getParent();
    }
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NetworkTopologyImpl.java`
#### Snippet
```java
     *  or {@link Integer#MAX_VALUE} if node1 or node2 do not belong to the cluster
     */
    public int getDistance(Node node1, Node node2) {
        if (node1 == node2) {
            return 0;
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NetworkTopologyImpl.java`
#### Snippet
```java
     * @param nodes the list of nodes containing data for the reader
     */
    public void pseudoSortByDistance(Node reader, Node[] nodes) {
        int tempIndex = 0;
        int localRackNode = -1;
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NetworkTopologyImpl.java`
#### Snippet
```java
     * Return false directly as not aware of NodeGroup, to be override in sub-class.
     */
    public boolean isOnSameNodeGroup(Node node1, Node node2) {
        return false;
    }
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NetworkTopologyImpl.java`
#### Snippet
```java
     * @see #getNode(String)
     */
    protected Node getNodeForNetworkLocation(Node node) {
        return getNode(node.getNetworkLocation());
    }
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NetworkTopologyImpl.java`
#### Snippet
```java
     * @return the chosen node
     */
    public Node chooseRandom(String scope) {
        netlock.readLock().lock();
        try {
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NetworkTopologyImpl.java`
#### Snippet
```java

    @Override
    public int countNumOfAvailableNodes(String scope, Collection<Node> excludedNodes) {
        boolean isExcluded = false;
        if (scope.startsWith(INVERSE)) {
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'com.google.common.util.concurrent.RateLimiter'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/InterleavedLedgerStorage.java`
#### Snippet
```java
    @Override
    @SuppressFBWarnings("RCN_REDUNDANT_NULLCHECK_WOULD_HAVE_BEEN_A_NPE")
    public List<DetectedInconsistency> localConsistencyCheck(Optional<RateLimiter> rateLimiter) throws IOException {
        long checkStart = MathUtils.nowInNano();
        LOG.info("Starting localConsistencyCheck");
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.DNSToSwitchMapping'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LocalBookieEnsemblePlacementPolicy.java`
#### Snippet
```java

    @Override
    public EnsemblePlacementPolicy initialize(ClientConfiguration conf,
                                              Optional<DNSToSwitchMapping> optionalDnsResolver,
                                              HashedWheelTimer hashedWheelTimer,
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'com.google.common.util.concurrent.RateLimiter'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/SortedLedgerStorage.java`
#### Snippet
```java

    @Override
    public List<DetectedInconsistency> localConsistencyCheck(Optional<RateLimiter> rateLimiter) throws IOException {
        return interleavedLedgerStorage.localConsistencyCheck(rateLimiter);
    }
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'com.google.common.util.concurrent.RateLimiter'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LedgerStorage.java`
#### Snippet
```java
     * @throws IOException
     */
    default List<DetectedInconsistency> localConsistencyCheck(Optional<RateLimiter> rateLimiter) throws IOException {
        return new ArrayList<>();
    }
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.DNSToSwitchMapping'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ZoneawareEnsemblePlacementPolicy.java`
#### Snippet
```java

    @Override
    public EnsemblePlacementPolicy initialize(ClientConfiguration conf,
            Optional<DNSToSwitchMapping> optionalDnsResolver, HashedWheelTimer timer,
            FeatureProvider featureProvider,
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.DNSToSwitchMapping'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/DefaultEnsemblePlacementPolicy.java`
#### Snippet
```java

    @Override
    public EnsemblePlacementPolicy initialize(ClientConfiguration conf,
                                       Optional<DNSToSwitchMapping> optionalDnsResolver,
                                       HashedWheelTimer hashedWheelTimer,
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.DNSToSwitchMapping'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/EnsemblePlacementPolicy.java`
#### Snippet
```java
     * @since 4.5
     */
    EnsemblePlacementPolicy initialize(ClientConfiguration conf,
                                       Optional<DNSToSwitchMapping> optionalDnsResolver,
                                       HashedWheelTimer hashedWheelTimer,
```

### UnstableTypeUsedInSignature
Class must be marked with '@com.google.common.annotations.Beta' annotation because its declaration references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ITopologyAwareEnsemblePlacementPolicy.java`
#### Snippet
```java
     * Ensemble used to hold the result of an ensemble selected for placement.
     */
    interface Ensemble<T extends Node> {

        /**
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ITopologyAwareEnsemblePlacementPolicy.java`
#### Snippet
```java
     * @throws BKException.BKNotEnoughBookiesException
     */
    T selectFromNetworkLocation(Set<String> excludeRacks,
                                Set<Node> excludeBookies,
                                Predicate<BookieNode> predicate,
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ITopologyAwareEnsemblePlacementPolicy.java`
#### Snippet
```java
     * @throws BKNotEnoughBookiesException
     */
    T selectFromNetworkLocation(String networkLoc,
                                Set<String> excludeRacks,
                                Set<Node> excludeBookies,
```

### UnstableTypeUsedInSignature
Class must be marked with '@com.google.common.annotations.Beta' annotation because its declaration references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ITopologyAwareEnsemblePlacementPolicy.java`
#### Snippet
```java
     * Predicate used when choosing an ensemble.
     */
    interface Predicate<T extends Node> {
        boolean apply(T candidate, Ensemble<T> chosenBookies);
    }
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ITopologyAwareEnsemblePlacementPolicy.java`
#### Snippet
```java
     * @throws BKException.BKNotEnoughBookiesException
     */
    T selectFromNetworkLocation(String networkLoc,
                                Set<Node> excludeBookies,
                                Predicate<T> predicate,
```

### UnstableTypeUsedInSignature
Class must be marked with '@com.google.common.annotations.Beta' annotation because its declaration references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ITopologyAwareEnsemblePlacementPolicy.java`
#### Snippet
```java
@InterfaceAudience.Private
@InterfaceStability.Evolving
public interface ITopologyAwareEnsemblePlacementPolicy<T extends Node> extends EnsemblePlacementPolicy {
    /**
     * Predicate used when choosing an ensemble.
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.DNSToSwitchMapping'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RackawareEnsemblePlacementPolicy.java`
#### Snippet
```java

    @Override
    protected RackawareEnsemblePlacementPolicy initialize(DNSToSwitchMapping dnsResolver,
                                                          HashedWheelTimer timer,
                                                          boolean reorderReadsRandom,
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RackawareEnsemblePlacementPolicy.java`
#### Snippet
```java

    @Override
    public BookieNode selectFromNetworkLocation(
            String networkLoc,
            Set<Node> excludeBookies,
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RackawareEnsemblePlacementPolicy.java`
#### Snippet
```java

    @Override
    public BookieNode selectFromNetworkLocation(
            String networkLoc,
            Set<String> excludeRacks,
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RackawareEnsemblePlacementPolicy.java`
#### Snippet
```java

    @Override
    public BookieNode selectFromNetworkLocation(
            Set<String> excludeRacks,
            Set<Node> excludeBookies,
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RegionAwareEnsemblePlacementPolicy.java`
#### Snippet
```java
    }

    protected List<BookieNode> selectRandomFromRegions(Set<String> availableRegions,
                                            int numBookies,
                                            Set<Node> excludeBookies,
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.DNSToSwitchMapping'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RegionAwareEnsemblePlacementPolicy.java`
#### Snippet
```java

    @Override
    public RegionAwareEnsemblePlacementPolicy initialize(ClientConfiguration conf,
                                                         Optional<DNSToSwitchMapping> optionalDnsResolver,
                                                         HashedWheelTimer timer,
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RegionAwareEnsemblePlacementPolicy.java`
#### Snippet
```java
    }

    protected BookieNode replaceFromRack(BookieNode bookieNodeToReplace,
                                         Set<Node> excludeBookies,
                                         Predicate<BookieNode> predicate,
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.DNSToSwitchMapping'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/api/BookKeeperBuilder.java`
#### Snippet
```java
     * @return client builder
     */
    BookKeeperBuilder dnsResolver(DNSToSwitchMapping dnsResolver);

    /**
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.DNSToSwitchMapping'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/impl/BookKeeperBuilderImpl.java`
#### Snippet
```java

    @Override
    public BookKeeperBuilder dnsResolver(DNSToSwitchMapping dnsResolver) {
        builder.dnsResolver(dnsResolver);
        return this;
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.DNSToSwitchMapping'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ZoneawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java

    @Override
    public EnsemblePlacementPolicy initialize(ClientConfiguration conf,
            Optional<DNSToSwitchMapping> optionalDnsResolver, HashedWheelTimer timer, FeatureProvider featureProvider,
            StatsLogger statsLogger, BookieAddressResolver bookieAddressResolver) {
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ZoneawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java

    @Override
    public BookieNode selectFromNetworkLocation(String networkLoc, Set<Node> excludeBookies,
            org.apache.bookkeeper.client.ITopologyAwareEnsemblePlacementPolicy.Predicate<BookieNode> predicate,
            org.apache.bookkeeper.client.ITopologyAwareEnsemblePlacementPolicy.Ensemble<BookieNode> ensemble,
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ZoneawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java

    @Override
    public BookieNode selectFromNetworkLocation(Set<String> excludeRacks, Set<Node> excludeBookies,
            org.apache.bookkeeper.client.ITopologyAwareEnsemblePlacementPolicy.Predicate<BookieNode> predicate,
            org.apache.bookkeeper.client.ITopologyAwareEnsemblePlacementPolicy.Ensemble<BookieNode> ensemble,
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ZoneawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java

    @Override
    public BookieNode selectFromNetworkLocation(String networkLoc, Set<String> excludeRacks, Set<Node> excludeBookies,
            org.apache.bookkeeper.client.ITopologyAwareEnsemblePlacementPolicy.Predicate<BookieNode> predicate,
            org.apache.bookkeeper.client.ITopologyAwareEnsemblePlacementPolicy.Ensemble<BookieNode> ensemble,
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RackawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java

    @Override
    public BookieNode selectFromNetworkLocation(String networkLoc,
                                                   Set<String> excludeRacks,
                                                   Set<Node> excludeBookies,
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RackawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
     * @throws BKNotEnoughBookiesException
     */
    protected List<BookieNode> selectRandom(int numBookies,
                                            Set<Node> excludeBookies,
                                            Predicate<BookieNode> predicate,
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RackawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
     * @return chosen bookie.
     */
    protected BookieNode selectRandomFromRack(String netPath, Set<Node> excludeBookies, Predicate<BookieNode> predicate,
            Ensemble<BookieNode> ensemble) throws BKNotEnoughBookiesException {
        WeightedRandomSelection<BookieNode> wRSelection = null;
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RackawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
    }

    protected List<BookieNode> selectRandomInternal(List<BookieNode> bookiesToSelectFrom,
                                                    int numBookies,
                                                    Set<Node> excludeBookies,
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RackawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java

    @Override
    public BookieNode selectFromNetworkLocation(
            String networkLoc,
            Set<Node> excludeBookies,
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.Node'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RackawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
     */
    @Override
    public BookieNode selectFromNetworkLocation(Set<String> excludeRacks,
                                                   Set<Node> excludeBookies,
                                                   Predicate<BookieNode> predicate,
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.DNSToSwitchMapping'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RackawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java

    @Override
    public RackawareEnsemblePlacementPolicyImpl initialize(ClientConfiguration conf,
                                                           Optional<DNSToSwitchMapping> optionalDnsResolver,
                                                           HashedWheelTimer timer,
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.DNSToSwitchMapping'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RackawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
     * @return initialized ensemble placement policy
     */
    protected RackawareEnsemblePlacementPolicyImpl initialize(DNSToSwitchMapping dnsResolver,
                                                              HashedWheelTimer timer,
                                                              boolean reorderReadsRandom,
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.DNSToSwitchMapping'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeper.java`
#### Snippet
```java
         * @since 4.5
         */
        public Builder dnsResolver(DNSToSwitchMapping dnsResolver) {
            this.dnsResolver = dnsResolver;
            return this;
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.DNSToSwitchMapping'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeper.java`
#### Snippet
```java
    }

    protected EnsemblePlacementPolicy initializeEnsemblePlacementPolicy(ClientConfiguration conf,
                                                                      DNSToSwitchMapping dnsResolver,
                                                                      HashedWheelTimer timer,
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.distributedlog.logsegment.LogSegmentEntryStore'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/ReadUtils.java`
#### Snippet
```java
     * @return a future with last record.
     */
    public static CompletableFuture<LogRecordWithDLSN> asyncReadLastRecord(
            final String streamName,
            final LogSegmentMetadata l,
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.distributedlog.logsegment.LogSegmentEntryStore'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/ReadUtils.java`
#### Snippet
```java
     * @return found log record. none if all transaction ids are less than provided <code>transactionId</code>.
     */
    public static CompletableFuture<Optional<LogRecordWithDLSN>> getLogRecordNotLessThanTxId(
            final String logName,
            final LogSegmentMetadata segment,
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.distributedlog.logsegment.LogSegmentEntryStore'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/ReadUtils.java`
#### Snippet
```java
     * @return a future with last record.
     */
    public static CompletableFuture<LogRecordWithDLSN> asyncReadFirstUserRecord(
            final String streamName,
            final LogSegmentMetadata l,
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.DNSToSwitchMapping'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/DistributedLogConfiguration.java`
#### Snippet
```java
     * @see #getEnsemblePlacementDnsResolverClass()
     */
    public DistributedLogConfiguration setEnsemblePlacementDnsResolverClass(
            Class<? extends DNSToSwitchMapping> dnsResolverClass) {
        setProperty(BKDL_ENSEMBLE_PLACEMENT_DNS_RESOLVER_CLASS, dnsResolverClass.getName());
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.DNSToSwitchMapping'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/DistributedLogConfiguration.java`
#### Snippet
```java
     * @see #getRowAwareEnsemblePlacementEnabled()
     */
    public Class<? extends DNSToSwitchMapping> getEnsemblePlacementDnsResolverClass()
            throws ConfigurationException {
        Class<? extends DNSToSwitchMapping> defaultResolverCls;
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.distributedlog.util.Transaction'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/LedgerAllocatorDelegator.java`
#### Snippet
```java

    @Override
    public CompletableFuture<LedgerHandle> tryObtain(Transaction<Object> txn,
                                          OpListener<LedgerHandle> listener) {
        return this.allocator.tryObtain(txn, listener);
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.distributedlog.util.Transaction.Op'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/zk/ZKTransaction.java`
#### Snippet
```java

    @Override
    public void addOp(Op<Object> operation) {
        if (done.get()) {
            throw new IllegalStateException("Add an operation to a finished transaction");
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.distributedlog.callback.NamespaceListener'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKDistributedLogNamespace.java`
#### Snippet
```java

    @Override
    public void registerNamespaceListener(NamespaceListener listener) {
        driver.getLogMetadataStore().registerNamespaceListener(listener);
    }
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.distributedlog.util.Transaction.OpListener'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/zk/ZKVersionedSetOp.java`
#### Snippet
```java
    private final OpListener<Version> listener;

    public ZKVersionedSetOp(Op op,
                            @Nullable OpListener<Version> opListener) {
        super(op);
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.distributedlog.util.Transaction.OpListener'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/zk/DefaultZKOp.java`
#### Snippet
```java
public class DefaultZKOp extends ZKOp {

    public static DefaultZKOp of(Op op, OpListener<Void> listener) {
        return new DefaultZKOp(op, listener);
    }
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.distributedlog.callback.NamespaceListener'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/api/namespace/Namespace.java`
#### Snippet
```java
     *          listener to receive stream updates under the namespace
     */
    void registerNamespaceListener(NamespaceListener listener);

    /**
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.distributedlog.util.Transaction'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/LedgerAllocatorPool.java`
#### Snippet
```java

    @Override
    public CompletableFuture<LedgerHandle> tryObtain(final Transaction<Object> txn,
                                                     final Transaction.OpListener<LedgerHandle> listener) {
        final SimpleLedgerAllocator allocator;
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.bookkeeper.net.DNSToSwitchMapping'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/net/NetUtils.java`
#### Snippet
```java
     * @return dns resolver
     */
    public static DNSToSwitchMapping getDNSResolver(Class<? extends DNSToSwitchMapping> resolverCls,
                                                    String hostRegionOverrides) {
        // first try to construct the dns resolver with overrides
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.distributedlog.callback.NamespaceListener'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/ZKLogMetadataStore.java`
#### Snippet
```java

    @Override
    public void registerNamespaceListener(NamespaceListener listener) {
        this.nsWatcher.registerListener(listener);
    }
```

### UnstableTypeUsedInSignature
Field must be marked with '@com.google.common.annotations.Beta' annotation because its type references unstable type 'org.apache.distributedlog.metadata.LogStreamMetadataStore'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/BKNamespaceDriver.java`
#### Snippet
```java
    // log stream metadata store
    private LogMetadataStore metadataStore;
    private LogStreamMetadataStore writerStreamMetadataStore;
    private LogStreamMetadataStore readerStreamMetadataStore;

```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.distributedlog.metadata.LogStreamMetadataStore'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/BKNamespaceDriver.java`
#### Snippet
```java

    @Override
    public LogStreamMetadataStore getLogStreamMetadataStore(Role role) {
        if (Role.WRITER == role) {
            return writerStreamMetadataStore;
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.distributedlog.metadata.LogMetadataStore'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/BKNamespaceDriver.java`
#### Snippet
```java

    @Override
    public LogMetadataStore getLogMetadataStore() {
        return metadataStore;
    }
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.distributedlog.logsegment.LogSegmentEntryStore'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/BKNamespaceDriver.java`
#### Snippet
```java

    @Override
    public LogSegmentEntryStore getLogSegmentEntryStore(Role role) {
        if (Role.WRITER == role) {
            return getWriterEntryStore();
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.distributedlog.metadata.LogStreamMetadataStore'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/BKNamespaceDriver.java`
#### Snippet
```java

    @VisibleForTesting
    public LogStreamMetadataStore getWriterStreamMetadataStore() {
        return writerStreamMetadataStore;
    }
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.distributedlog.logsegment.LogSegmentEntryWriter'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/logsegment/BKLogSegmentEntryStore.java`
#### Snippet
```java

    @Override
    public Allocator<LogSegmentEntryWriter, Object> newLogSegmentAllocator(
            LogMetadataForWriter logMetadata,
            DynamicDistributedLogConfiguration dynConf,
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.distributedlog.logsegment.LogSegmentEntryReader'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/logsegment/BKLogSegmentEntryStore.java`
#### Snippet
```java

    @Override
    public CompletableFuture<LogSegmentEntryReader> openReader(LogSegmentMetadata segment,
                                                    long startEntryId) {
        BookKeeper bk;
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.distributedlog.logsegment.LogSegmentEntryWriter'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/logsegment/BKLogSegmentEntryStore.java`
#### Snippet
```java

    @Override
    public Allocator<LogSegmentEntryWriter, Object> newLogSegmentAllocator(
            LogMetadataForWriter logMetadata,
            DynamicDistributedLogConfiguration dynConf) throws IOException {
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.distributedlog.util.Transaction'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/ZKLogSegmentMetadataStore.java`
#### Snippet
```java

    @Override
    public void storeMaxLogSegmentSequenceNumber(Transaction<Object> txn,
                                                 LogMetadata logMetadata,
                                                 Versioned<Long> lssn,
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.distributedlog.util.Transaction'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/ZKLogSegmentMetadataStore.java`
#### Snippet
```java

    @Override
    public void createLogSegment(Transaction<Object> txn,
                                 LogSegmentMetadata segment,
                                 OpListener<Void> listener) {
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.distributedlog.util.Transaction'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/ZKLogSegmentMetadataStore.java`
#### Snippet
```java

    @Override
    public void storeMaxTxnId(Transaction<Object> txn,
                              LogMetadataForWriter logMetadata,
                              Versioned<Long> transactionId,
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.distributedlog.util.Transaction'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/ZKLogSegmentMetadataStore.java`
#### Snippet
```java

    @Override
    public void updateLogSegment(Transaction<Object> txn, LogSegmentMetadata segment) {
        byte[] finalisedData = segment.getFinalisedData().getBytes(UTF_8);
        Op updateOp = Op.setData(segment.getZkPath(), finalisedData, -1);
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.distributedlog.util.Transaction'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/ZKLogSegmentMetadataStore.java`
#### Snippet
```java

    @Override
    public Transaction<Object> transaction() {
        return new ZKTransaction(zkc);
    }
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.distributedlog.util.Transaction'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/ZKLogSegmentMetadataStore.java`
#### Snippet
```java

    @Override
    public void deleteLogSegment(Transaction<Object> txn,
                                 final LogSegmentMetadata segment,
                                 final OpListener<Void> listener) {
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.distributedlog.util.Transaction'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java

    @Override
    public synchronized CompletableFuture<LedgerHandle> tryObtain(final Transaction<Object> txn,
                                                                  final OpListener<LedgerHandle> listener) {
        if (Phase.ERROR == phase) {
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.distributedlog.util.Transaction'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/util/Allocator.java`
#### Snippet
```java
     * @return future result returning <i>R</i> that would be obtained under transaction <code>txn</code>.
     */
    CompletableFuture<R> tryObtain(Transaction<T> txn, OpListener<R> listener);

}
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.distributedlog.logsegment.LogSegmentEntryReader.StateChangeListener'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/logsegment/BKLogSegmentEntryReader.java`
#### Snippet
```java

    @Override
    public LogSegmentEntryReader unregisterListener(StateChangeListener listener) {
        stateChangeListeners.remove(listener);
        return this;
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.distributedlog.logsegment.LogSegmentEntryReader.StateChangeListener'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/logsegment/BKLogSegmentEntryReader.java`
#### Snippet
```java

    @Override
    public LogSegmentEntryReader registerListener(StateChangeListener listener) {
        stateChangeListeners.add(listener);
        return this;
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.distributedlog.callback.NamespaceListener'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/federated/FederatedZKLogMetadataStore.java`
#### Snippet
```java

    @Override
    public void registerNamespaceListener(NamespaceListener listener) {
        registerListener(listener);
    }
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.distributedlog.logsegment.LogSegmentMetadataStore'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/metadata/DryrunLogSegmentMetadataStoreUpdater.java`
#### Snippet
```java
public class DryrunLogSegmentMetadataStoreUpdater extends LogSegmentMetadataStoreUpdater {

    public DryrunLogSegmentMetadataStoreUpdater(DistributedLogConfiguration conf,
                                                LogSegmentMetadataStore metadataStore) {
        super(conf, metadataStore);
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.distributedlog.util.Transaction'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/metadata/DryrunLogSegmentMetadataStoreUpdater.java`
#### Snippet
```java

    @Override
    public Transaction<Object> transaction() {
        return new Transaction<Object>() {
            @Override
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.distributedlog.util.Transaction'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/metadata/MetadataUpdater.java`
#### Snippet
```java
     * @return log segment that truncation status is set to truncated.
     */
    LogSegmentMetadata setLogSegmentTruncated(Transaction<Object> txn, LogSegmentMetadata segment);

    /**
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.distributedlog.util.Transaction'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/metadata/MetadataUpdater.java`
#### Snippet
```java
     * @return transaction
     */
    Transaction<Object> transaction();

    /**
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.distributedlog.util.Transaction'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/metadata/MetadataUpdater.java`
#### Snippet
```java
     * @return log segment that truncation status has been set to partially truncated
     */
    LogSegmentMetadata setLogSegmentPartiallyTruncated(Transaction<Object> txn,
                                                       LogSegmentMetadata segment,
                                                       DLSN minActiveDLSN);
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.distributedlog.logsegment.LogSegmentEntryStore'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/namespace/NamespaceDriver.java`
#### Snippet
```java
     * @throws IOException when failed to open log segment entry store.
     */
    LogSegmentEntryStore getLogSegmentEntryStore(Role role);

    /**
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.distributedlog.metadata.LogStreamMetadataStore'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/namespace/NamespaceDriver.java`
#### Snippet
```java
     * @return the log stream metadata store
     */
    LogStreamMetadataStore getLogStreamMetadataStore(Role role);

    /**
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.distributedlog.metadata.LogMetadataStore'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/namespace/NamespaceDriver.java`
#### Snippet
```java
     * @return the log metadata store
     */
    LogMetadataStore getLogMetadataStore();

    /**
```

### UnstableTypeUsedInSignature
Field must be marked with '@com.google.common.annotations.Beta' annotation because its type references unstable type 'org.apache.distributedlog.callback.NamespaceListener'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/namespace/NamespaceWatcher.java`
#### Snippet
```java
public abstract class NamespaceWatcher {

    protected final CopyOnWriteArraySet<NamespaceListener> listeners =
            new CopyOnWriteArraySet<NamespaceListener>();

```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.distributedlog.callback.NamespaceListener'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/namespace/NamespaceWatcher.java`
#### Snippet
```java
     *          listener to remove from namespace watcher
     */
    public void unregisterListener(NamespaceListener listener) {
        listeners.remove(listener);
    }
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.distributedlog.callback.NamespaceListener'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/namespace/NamespaceWatcher.java`
#### Snippet
```java
     *          listener to add
     */
    public void registerListener(NamespaceListener listener) {
        if (listeners.add(listener)) {
            watchNamespaceChanges();
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.distributedlog.util.Transaction'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/metadata/LogSegmentMetadataStoreUpdater.java`
#### Snippet
```java
    }

    protected void addNewSegmentAndDeleteOldSegment(Transaction<Object> txn,
                                                    LogSegmentMetadata newSegment,
                                                    LogSegmentMetadata oldSegment) {
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.distributedlog.logsegment.LogSegmentMetadataStore'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/metadata/LogSegmentMetadataStoreUpdater.java`
#### Snippet
```java
    static final Logger LOG = LoggerFactory.getLogger(LogSegmentMetadataStoreUpdater.class);

    public static MetadataUpdater createMetadataUpdater(DistributedLogConfiguration conf,
                                                        LogSegmentMetadataStore metadataStore) {
        return new LogSegmentMetadataStoreUpdater(conf, metadataStore);
```

### UnstableTypeUsedInSignature
Field must be marked with '@com.google.common.annotations.Beta' annotation because its type references unstable type 'org.apache.distributedlog.logsegment.LogSegmentMetadataStore'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/metadata/LogSegmentMetadataStoreUpdater.java`
#### Snippet
```java
    }

    protected final LogSegmentMetadataStore metadataStore;
    protected final LogSegmentMetadata.LogSegmentMetadataVersion metadataVersion;

```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.distributedlog.util.Transaction'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/metadata/LogSegmentMetadataStoreUpdater.java`
#### Snippet
```java

    @Override
    public LogSegmentMetadata setLogSegmentPartiallyTruncated(Transaction<Object> txn,
                                                              LogSegmentMetadata segment,
                                                              DLSN minActiveDLSN) {
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.distributedlog.util.Transaction'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/metadata/LogSegmentMetadataStoreUpdater.java`
#### Snippet
```java

    @Override
    public LogSegmentMetadata setLogSegmentTruncated(Transaction<Object> txn, LogSegmentMetadata segment) {
        final LogSegmentMetadata newSegment = segment.mutator()
            .setTruncationStatus(LogSegmentMetadata.TruncationStatus.TRUNCATED)
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.distributedlog.util.Transaction'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/metadata/LogSegmentMetadataStoreUpdater.java`
#### Snippet
```java

    @Override
    public Transaction<Object> transaction() {
        return metadataStore.transaction();
    }
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.distributedlog.logsegment.LogSegmentMetadataStore'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/metadata/LogSegmentMetadataStoreUpdater.java`
#### Snippet
```java
    protected final LogSegmentMetadata.LogSegmentMetadataVersion metadataVersion;

    protected LogSegmentMetadataStoreUpdater(DistributedLogConfiguration conf,
                                             LogSegmentMetadataStore metadataStore) {
        this.metadataStore = metadataStore;
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.distributedlog.util.Transaction'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/metadata/ZKLogStreamMetadataStore.java`
#### Snippet
```java

    @Override
    public Transaction<Object> newTransaction() {
        return new ZKTransaction(zooKeeperClient);
    }
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.distributedlog.logsegment.LogSegmentMetadataStore'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/metadata/ZKLogStreamMetadataStore.java`
#### Snippet
```java

    @Override
    public LogSegmentMetadataStore getLogSegmentMetadataStore() {
        return logSegmentStore;
    }
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'org.apache.distributedlog.logsegment.LogSegmentMetadataStore'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
        }

        protected LogSegmentMetadataStore getLogSegmentMetadataStore() throws IOException {
            return getNamespace()
                    .getNamespaceDriver()
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'com.google.common.util.concurrent.ListenableScheduledFuture'
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/BoundedScheduledExecutorService.java`
#### Snippet
```java

    @Override
    public ListenableScheduledFuture<?> scheduleWithFixedDelay(Runnable command,
                                                               long initialDelay, long delay, TimeUnit unit) {
        this.checkQueue(1);
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'com.google.common.util.concurrent.ListenableScheduledFuture'
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/BoundedScheduledExecutorService.java`
#### Snippet
```java

    @Override
    public <V> ListenableScheduledFuture<V> schedule(Callable<V> callable, long delay, TimeUnit unit) {
        this.checkQueue(1);
        return this.thread.schedule(callable, delay, unit);
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'com.google.common.util.concurrent.ListenableScheduledFuture'
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/BoundedScheduledExecutorService.java`
#### Snippet
```java

    @Override
    public ListenableScheduledFuture<?> schedule(Runnable command, long delay, TimeUnit unit) {
        this.checkQueue(1);
        return this.thread.schedule(command, delay, unit);
```

### UnstableTypeUsedInSignature
Method must be marked with '@com.google.common.annotations.Beta' annotation because its signature references unstable type 'com.google.common.util.concurrent.ListenableScheduledFuture'
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/BoundedScheduledExecutorService.java`
#### Snippet
```java

    @Override
    public ListenableScheduledFuture<?> scheduleAtFixedRate(Runnable command,
                                                            long initialDelay, long period, TimeUnit unit) {
        this.checkQueue(1);
```

## RuleId[id=UnusedAssignment]
### UnusedAssignment
Variable `logger` initializer `null` is redundant
in `microbenchmarks/src/main/java/org/apache/bookkeeper/stats/codahale/TimerBenchmark.java`
#### Snippet
```java
            System.exit(1);
        }
        StatsLogger logger = null;
        if (args[0].equalsIgnoreCase("codahale")) {
            logger = new CodahaleMetricsProvider().getStatsLogger("test");
```

### UnusedAssignment
The value `null` assigned to `times` is never used
in `microbenchmarks/src/main/java/org/apache/bookkeeper/stats/codahale/TimerBenchmark.java`
#### Snippet
```java
            timers[i % timers.length].registerFailedEvent(times[i % times.length], TimeUnit.MILLISECONDS);
        }
        times = null; // let it become garbage
        System.out.println("Done.");
        System.out.println("Now run 'jmap -histo:live <pid>' on this JVM to get a heap histogram, then kill this JVM.");
```

### UnusedAssignment
Variable `servingState` initializer `ServingState.WRITABLE` is redundant
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/metadata/stream/MetaRangeImpl.java`
#### Snippet
```java
    private StreamProperties streamProps;
    private LifecycleState lifecycleState = LifecycleState.UNINIT;
    private ServingState servingState = ServingState.WRITABLE;
    private long cTime = 0L;
    private long mTime = 0L;
```

### UnusedAssignment
Variable `nextRangeId` initializer `MIN_DATA_RANGE_ID` is redundant
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/metadata/stream/MetaRangeImpl.java`
#### Snippet
```java
    private long mTime = 0L;

    private long nextRangeId = MIN_DATA_RANGE_ID;
    /**
     * All the ranges in the stream.
```

### UnusedAssignment
Variable `cTime` initializer `0L` is redundant
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/metadata/stream/MetaRangeImpl.java`
#### Snippet
```java
    private LifecycleState lifecycleState = LifecycleState.UNINIT;
    private ServingState servingState = ServingState.WRITABLE;
    private long cTime = 0L;
    private long mTime = 0L;

```

### UnusedAssignment
Variable `lifecycleState` initializer `LifecycleState.UNINIT` is redundant
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/metadata/stream/MetaRangeImpl.java`
#### Snippet
```java
    @GuardedBy("this")
    private StreamProperties streamProps;
    private LifecycleState lifecycleState = LifecycleState.UNINIT;
    private ServingState servingState = ServingState.WRITABLE;
    private long cTime = 0L;
```

### UnusedAssignment
Variable `mTime` initializer `0L` is redundant
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/metadata/stream/MetaRangeImpl.java`
#### Snippet
```java
    private ServingState servingState = ServingState.WRITABLE;
    private long cTime = 0L;
    private long mTime = 0L;

    private long nextRangeId = MIN_DATA_RANGE_ID;
```

### UnusedAssignment
The value `null` assigned to `this.code` is never used
in `stream/api/src/main/java/org/apache/bookkeeper/api/kv/impl/result/ResultImpl.java`
#### Snippet
```java

    protected void reset() {
        this.code = null;
        this.revision = -1L;
        this.code = Code.UNEXPECTED;
```

### UnusedAssignment
Variable `kmf` initializer `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tls/TLSContextFactory.java`
#### Snippet
```java
            String keyStorePasswordPath) throws SecurityException, KeyStoreException, NoSuchAlgorithmException,
            CertificateException, IOException, UnrecoverableKeyException, InvalidKeySpecException {
        KeyManagerFactory kmf = null;

        if (Strings.isNullOrEmpty(keyStoreLocation)) {
```

### UnusedAssignment
Variable `ledgerIdGenPath` initializer `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/ZkLedgerIdGenerator.java`
#### Snippet
```java

    public static String createLedgerPrefix(String ledgersPath, String idGenZnodeName) {
        String ledgerIdGenPath = null;
        if (StringUtils.isBlank(idGenZnodeName)) {
            ledgerIdGenPath = ledgersPath;
```

### UnusedAssignment
Variable `zkActiveLedgers` initializer `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/FlatLedgerManager.java`
#### Snippet
```java
                    return;
                }
                Set<Long> zkActiveLedgers = null;

                try {
```

### UnusedAssignment
Variable `hasMoreElements` initializer `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/LegacyHierarchicalLedgerManager.java`
#### Snippet
```java
        private synchronized void preload() throws IOException {
            while (nextRange == null && !iteratorDone) {
                boolean hasMoreElements = false;
                try {
                    if (l1NodesIter == null) {
```

### UnusedAssignment
Variable `ledgerNodes` initializer `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/LegacyHierarchicalLedgerManager.java`
#### Snippet
```java
                       .append(level1).append("/").append(level2);
            String nodePath = nodeBuilder.toString();
            List<String> ledgerNodes = null;
            try {
                ledgerNodes = ZkUtils.getChildrenInSingleNode(zk, nodePath, zkOpTimeoutMs);
```

### UnusedAssignment
Variable `password` initializer `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/sasl/SaslClientState.java`
#### Snippet
```java
    static class ClientCallbackHandler implements CallbackHandler {

        private String password = null;

        public ClientCallbackHandler(String password) {
```

### UnusedAssignment
Variable `password` initializer `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/sasl/SASLBookieAuthProviderFactory.java`
#### Snippet
```java
    private static class ClientCallbackHandler implements CallbackHandler {

        private String password = null;

        public ClientCallbackHandler(String password) {
```

### UnusedAssignment
Variable `lastSequenceStart` initializer `INVALID_ENTRYID` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/AvailabilityOfEntriesOfLedger.java`
#### Snippet
```java
        private final long firstSequenceStart;
        private final int sequenceSize;
        private long lastSequenceStart = INVALID_ENTRYID;
        private int sequencePeriod;
        private boolean isSequenceGroupClosed = false;
```

### UnusedAssignment
Variable `data` initializer `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/ZkLedgerUnderreplicationManager.java`
#### Snippet
```java
            String znode = getUrLedgerZnode(ledgerId);
            UnderreplicatedLedgerFormat.Builder builder = UnderreplicatedLedgerFormat.newBuilder();
            byte[] data = null;
            try {
                data = zkc.getData(znode, false, null);
```

### UnusedAssignment
Variable `returnEntryId` initializer `INVALID_ELEMENT` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/IteratorUtility.java`
#### Snippet
```java
                }

                long returnEntryId = INVALID_ELEMENT;
                if (curIter1Element != INVALID_ELEMENT && curIter2Element != INVALID_ELEMENT) {
                    if (curIter1Element == curIter2Element) {
```

### UnusedAssignment
Variable `returnEntry` initializer `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/IteratorUtility.java`
#### Snippet
```java
                }

                T returnEntry = null;
                if (curIter1Entry != null && curIter2Entry != null) {
                    int compareValue = comparator.compare(curIter1Entry, curIter2Entry);
```

### UnusedAssignment
Variable `canonDir` initializer `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/DiskChecker.java`
#### Snippet
```java
            return true;
        }
        File canonDir = null;
        try {
            canonDir = dir.getCanonicalFile();
```

### UnusedAssignment
Variable `availabilityOfEntriesOfLedger` initializer `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/GetListOfEntriesOfLedgerProcessorV3.java`
#### Snippet
```java
        }
        StatusCode status = StatusCode.EOK;
        AvailabilityOfEntriesOfLedger availabilityOfEntriesOfLedger = null;
        try {
            availabilityOfEntriesOfLedger = new AvailabilityOfEntriesOfLedger(
```

### UnusedAssignment
Variable `status` initializer `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/WriteLacProcessorV3.java`
#### Snippet
```java
        };

        StatusCode status = null;
        ByteBuffer lacToAdd = writeLacRequest.getBody().asReadOnlyByteBuffer();
        byte[] masterKey = writeLacRequest.getMasterKey().toByteArray();
```

### UnusedAssignment
Variable `status` initializer `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/ForceLedgerProcessorV3.java`
#### Snippet
```java
            sendResponse(status, resp, requestProcessor.getRequestStats().getForceLedgerRequestStats());
        };
        StatusCode status = null;
        try {
            requestProcessor.getBookie().forceLedger(ledgerId, wcb, requestHandler);
```

### UnusedAssignment
Variable `status` initializer `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/WriteEntryProcessorV3.java`
#### Snippet
```java
        }
        final boolean ackBeforeSync = writeFlags.contains(WriteFlag.DEFERRED_SYNC);
        StatusCode status = null;
        byte[] masterKey = addRequest.getMasterKey().toByteArray();
        ByteBuf entryToAdd = Unpooled.wrappedBuffer(addRequest.getBody().asReadOnlyByteBuffer());
```

### UnusedAssignment
Variable `timeoutTimerTask` initializer `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/Shell.java`
#### Snippet
```java
        ProcessBuilder builder = new ProcessBuilder(getExecString());
        Timer timeOutTimer = null;
        ShellTimeoutTimerTask timeoutTimerTask = null;
        timedOut = new AtomicBoolean(false);
        completed = new AtomicBoolean(false);
```

### UnusedAssignment
Variable `updateByteBufferMethod` initializer `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/checksum/DirectMemoryCRC32Digest.java`
#### Snippet
```java
        // Access CRC32 class private native methods to compute the crc on the ByteBuf direct memory,
        // without necessity to convert to a nio ByteBuffer.
        Method updateByteBufferMethod = null;
        Method updateBytesMethod = null;
        try {
```

### UnusedAssignment
Variable `updateBytesMethod` initializer `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/checksum/DirectMemoryCRC32Digest.java`
#### Snippet
```java
        // without necessity to convert to a nio ByteBuffer.
        Method updateByteBufferMethod = null;
        Method updateBytesMethod = null;
        try {
            updateByteBufferMethod = CRC32.class.getDeclaredMethod("updateByteBuffer", int.class, long.class, int.class,
```

### UnusedAssignment
Variable `masterKey` initializer `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieProtoEncoding.java`
#### Snippet
```java

        private static byte[] readMasterKey(ByteBuf packet) {
            byte[] masterKey = null;

            // check if the master key is an empty master key
```

### UnusedAssignment
Variable `ledgerId` initializer `-1` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieProtoEncoding.java`
#### Snippet
```java

            // packet format is different between ADDENTRY and READENTRY
            long ledgerId = -1;
            long entryId = BookieProtocol.INVALID_ENTRY_ID;

```

### UnusedAssignment
Variable `entryId` initializer `BookieProtocol.INVALID_ENTRY_ID` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieProtoEncoding.java`
#### Snippet
```java
            // packet format is different between ADDENTRY and READENTRY
            long ledgerId = -1;
            long entryId = BookieProtocol.INVALID_ENTRY_ID;

            switch (opCode) {
```

### UnusedAssignment
Variable `result` initializer `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookie/InitCommand.java`
#### Snippet
```java
    public boolean apply(ServerConfiguration conf, CliFlags cmdFlags) {

        boolean result = false;
        try {
            result = BookKeeperAdmin.initBookie(conf);
```

### UnusedAssignment
Variable `request` initializer `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
                                   byte[] masterKey,
                                   boolean allowFastFail) {
        Object request = null;
        CompletionKey completionKey = null;
        if (useV2WireProtocol) {
```

### UnusedAssignment
Variable `completionKey` initializer `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
                                   boolean allowFastFail) {
        Object request = null;
        CompletionKey completionKey = null;
        if (useV2WireProtocol) {
            request = BookieProtocol.ReadRequest.create(BookieProtocol.CURRENT_PROTOCOL_VERSION,
```

### UnusedAssignment
Variable `request` initializer `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java

    public void readLac(final long ledgerId, ReadLacCallback cb, Object ctx) {
        Object request = null;
        CompletionKey completionKey = null;
        if (useV2WireProtocol) {
```

### UnusedAssignment
Variable `completionKey` initializer `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
    public void readLac(final long ledgerId, ReadLacCallback cb, Object ctx) {
        Object request = null;
        CompletionKey completionKey = null;
        if (useV2WireProtocol) {
            request = BookieProtocol.ReadRequest.create(BookieProtocol.CURRENT_PROTOCOL_VERSION,
```

### UnusedAssignment
Variable `toClose` initializer `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java

    private void closeInternal(boolean permanent, boolean wait) {
        Channel toClose = null;
        synchronized (this) {
            if (permanent) {
```

### UnusedAssignment
Variable `request` initializer `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
    void addEntry(final long ledgerId, byte[] masterKey, final long entryId, ByteBufList toSend, WriteCallback cb,
                  Object ctx, final int options, boolean allowFastFail, final EnumSet<WriteFlag> writeFlags) {
        Object request = null;
        CompletionKey completionKey = null;
        if (useV2WireProtocol) {
```

### UnusedAssignment
Variable `completionKey` initializer `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
                  Object ctx, final int options, boolean allowFastFail, final EnumSet<WriteFlag> writeFlags) {
        Object request = null;
        CompletionKey completionKey = null;
        if (useV2WireProtocol) {
            if (writeFlags.contains(WriteFlag.DEFERRED_SYNC)) {
```

### UnusedAssignment
Variable `readInstanceId` initializer `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookies/InstanceIdCommand.java`
#### Snippet
```java
        try {
            runFunctionWithRegistrationManager(conf, rm -> {
                String readInstanceId = null;
                try {
                    readInstanceId = rm.getClusterInstanceId();
```

### UnusedAssignment
Variable `cookie` initializer `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/cookie/AdminCommand.java`
#### Snippet
```java
        return runFunctionWithRegistrationManager(bkConf, rm -> {
            try {
                Versioned<Cookie> cookie = null;
                try {
                    cookie = Cookie.readFromRegistrationManager(rm, bookieAddress);
```

### UnusedAssignment
Variable `oldCookie` initializer `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/cookie/AdminCommand.java`
#### Snippet
```java
                String newBookieId = BookieImpl.getBookieId(conf).toString();
                // read oldcookie
                Versioned<Cookie> oldCookie = null;
                try {
                    conf.setUseHostNameAsBookieID(!useHostname);
```

### UnusedAssignment
Variable `channels` initializer `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryLogManagerForSingleEntryLog.java`
#### Snippet
```java
    @Override
    void flushRotatedLogs() throws IOException {
        List<BufferedLogChannel> channels = null;
        synchronized (this) {
            channels = rotatedLogChannels;
```

### UnusedAssignment
Variable `entry` initializer `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/IndexInMemPageMgr.java`
#### Snippet
```java
                    Iterator<Map.Entry<EntryKey, LedgerEntryPage>> iterator = lruCleanPageMap.entrySet().iterator();

                    Map.Entry<EntryKey, LedgerEntryPage> entry = null;
                    while (iterator.hasNext()) {
                        entry = iterator.next();
```

### UnusedAssignment
Variable `readBytes` initializer `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BufferedReadChannel.java`
#### Snippet
```java
                // We don't have it in the buffer, so put necessary data in the buffer
                readBufferStartPosition = currentPosition;
                int readBytes = 0;
                if ((readBytes = validateAndGetFileChannel().read(readBuffer.internalNioBuffer(0, readCapacity),
                        currentPosition)) <= 0) {
```

### UnusedAssignment
Variable `address` initializer `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Cookie.java`
#### Snippet
```java
    public void writeToRegistrationManager(RegistrationManager rm, ServerConfiguration conf, Version version)
            throws BookieException {
        BookieId address = null;
        try {
            address = BookieImpl.getBookieId(conf);
```

### UnusedAssignment
Variable `address` initializer `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Cookie.java`
#### Snippet
```java
                                              ServerConfiguration conf,
                                              Version version) throws BookieException {
        BookieId address = null;
        try {
            address = BookieImpl.getBookieId(conf);
```

### UnusedAssignment
Variable `layoutVersion` initializer `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Cookie.java`
#### Snippet
```java
    private static Builder parse(BufferedReader reader) throws IOException {
        Builder cBuilder = Cookie.newBuilder();
        int layoutVersion = 0;
        String line = reader.readLine();
        if (null == line) {
```

### UnusedAssignment
Variable `phaseName` initializer `""` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/TransactionalEntryLogCompactor.java`
#### Snippet
```java
     */
    abstract static class CompactionPhase {
        private String phaseName = "";

        CompactionPhase(String phaseName) {
```

### UnusedAssignment
Variable `ledgersInMetadata` initializer `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/ScanAndCompareGarbageCollector.java`
#### Snippet
```java
            LedgerRangeIterator ledgerRangeIterator = ledgerManager
                    .getLedgerRanges(zkOpTimeoutMs);
            Set<Long> ledgersInMetadata = null;
            long start;
            long end = -1;
```

### UnusedAssignment
Variable `metadata` initializer `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/ScanAndCompareGarbageCollector.java`
#### Snippet
```java
            boolean done = false;
            AtomicBoolean isBookieInEnsembles = new AtomicBoolean(false);
            Versioned<LedgerMetadata> metadata = null;
            while (!done) {
                start = end + 1;
```

### UnusedAssignment
Variable `length` initializer `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryKeyValue.java`
#### Snippet
```java
    private final byte [] bytes;
    private int offset = 0; // start offset of entry blob
    private int length = 0; // length of entry blob

    /**
```

### UnusedAssignment
Variable `offset` initializer `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryKeyValue.java`
#### Snippet
```java
public class EntryKeyValue extends EntryKey {
    private final byte [] bytes;
    private int offset = 0; // start offset of entry blob
    private int length = 0; // length of entry blob

```

### UnusedAssignment
Variable `fc` initializer `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/DefaultEntryLogger.java`
#### Snippet
```java


        BufferedReadChannel fc = null;
        int entrySize = -1;
        try {
```

### UnusedAssignment
Variable `entrySize` initializer `-1` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/DefaultEntryLogger.java`
#### Snippet
```java

        BufferedReadChannel fc = null;
        int entrySize = -1;
        try {
            fc = getFCForEntryInternal(ledgerId, entryId, entryLogId, pos);
```

### UnusedAssignment
Variable `pageEntriesIteratorNonFinal` initializer `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LedgerCacheImpl.java`
#### Snippet
```java
    @Override
    public OfLong getEntriesIterator(long ledgerId) throws IOException {
        Iterator<LedgerCache.PageEntries> pageEntriesIteratorNonFinal = null;
        try {
            pageEntriesIteratorNonFinal = listEntries(ledgerId).iterator();
```

### UnusedAssignment
Variable `phaserTerminatedAbruptly` initializer `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryMemTableWithParallelFlusher.java`
#### Snippet
```java
                    }

                    boolean phaserTerminatedAbruptly = false;
                    try {
                        /*
```

### UnusedAssignment
Variable `changed` initializer `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/FileInfo.java`
#### Snippet
```java
     */
    public void close(boolean force) throws IOException {
        boolean changed = false;
        synchronized (this) {
            if (isClosed) {
```

### UnusedAssignment
Variable `rc` initializer `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/FileInfo.java`
#### Snippet
```java
        }
        int total = 0;
        int rc = 0;
        while (bb.remaining() > 0) {
            synchronized (this) {
```

### UnusedAssignment
Variable `result` initializer `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryMemTable.java`
#### Snippet
```java
     */
    public EntryKeyValue getLastEntry(long ledgerId) throws IOException {
        EntryKey result = null;
        EntryKey key = new EntryKey(ledgerId, Long.MAX_VALUE);
        long startTimeNanos = MathUtils.nowInNano();
```

### UnusedAssignment
Variable `value` initializer `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryMemTable.java`
#### Snippet
```java
    public EntryKeyValue getEntry(long ledgerId, long entryId) throws IOException {
        EntryKey key = new EntryKey(ledgerId, entryId);
        EntryKeyValue value = null;
        long startTimeNanos = MathUtils.nowInNano();
        boolean success = false;
```

### UnusedAssignment
Variable `size` initializer `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryMemTable.java`
#### Snippet
```java
    public long addEntry(long ledgerId, long entryId, final ByteBuffer entry, final CacheCallback cb)
            throws IOException {
        long size = 0;
        long startTimeNanos = MathUtils.nowInNano();
        boolean success = false;
```

### UnusedAssignment
Variable `rc` initializer `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/IndexPersistenceMgr.java`
#### Snippet
```java
        long totalWritten = 0;
        while (buffs[buffs.length - 1].remaining() > 0) {
            long rc = 0;
            try {
                rc = fi.write(buffs, entries.get(start + 0).getFirstEntryPosition());
```

### UnusedAssignment
Variable `dbFilePath` initializer `""` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/KeyValueStorageRocksDB.java`
#### Snippet
```java
        this.emptyBatch = new WriteBatch();

        String dbFilePath = "";
        if (dbConfigType == DbConfigType.EntryLocation) {
            dbFilePath = conf.getEntryLocationRocksdbConf();
```

### UnusedAssignment
Variable `confirm` initializer `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieImpl.java`
#### Snippet
```java
            if (journalDirFiles != null && journalDirFiles.length != 0) {
                try {
                    boolean confirm = false;
                    if (!isInteractive) {
                        // If non interactive and force is set, then delete old
```

### UnusedAssignment
Variable `errors` initializer `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieImpl.java`
#### Snippet
```java
        if (conf.isLocalConsistencyCheckOnStartup()) {
            LOG.info("Running local consistency check on startup prior to accepting IO.");
            List<LedgerStorage.DetectedInconsistency> errors = null;
            try {
                errors = ledgerStorage.localConsistencyCheck(Optional.empty());
```

### UnusedAssignment
Variable `hostAddress` initializer `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieImpl.java`
#### Snippet
```java
                    + hostName + " for interface: " + iface);
        }
        String hostAddress = null;
        InetAddress iAddress = inetAddr.getAddress();
        if (conf.getUseHostNameAsBookieID()) {
```

### UnusedAssignment
Variable `bytesRead` initializer `-1` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectReader.java`
#### Snippet
```java
        long bytesToRead = Math.min(blockSize, bytesAvailable);
        long bytesOutstanding = bytesToRead;
        long bytesRead = -1;
        try {
            while (true) {
```

### UnusedAssignment
Variable `startTime` initializer `-1` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/SingleDirectoryDbLedgerStorage.java`
#### Snippet
```java
        // Only a single flush operation can happen at a time
        flushMutex.lock();
        long startTime = -1;
        try {
            startTime = MathUtils.nowInNano();
```

### UnusedAssignment
Variable `inserted` initializer `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/SingleDirectoryDbLedgerStorage.java`
#### Snippet
```java
        // rest of the time, we can have multiple thread using the optimistic lock here without interfering.
        long stamp = writeCacheRotationLock.tryOptimisticRead();
        boolean inserted = false;

        inserted = writeCache.put(ledgerId, entryId, entry);
```

### UnusedAssignment
Variable `median` initializer `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/WeightedRandomSelectionImpl.java`
#### Snippet
```java
        }

        double median = 0;
        if (totalWeight == 0) {
            // all the values are zeros; assign a value of 1 to all and the totalWeight equal
```

### UnusedAssignment
Variable `allowFailFast` initializer `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java`
#### Snippet
```java
    boolean parallelRead = false;
    final AtomicBoolean complete = new AtomicBoolean(false);
    boolean allowFailFast = false;

    abstract class LedgerEntryRequest implements SpeculativeRequestExecutor, AutoCloseable {
```

### UnusedAssignment
Variable `isEnsembleAdheringToPlacementPolicy` initializer `PlacementPolicyAdherence.FAIL` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookieWatcherImpl.java`
#### Snippet
```java
        EnsemblePlacementPolicy.PlacementResult<BookieId> replaceBookieResponse;
        BookieId socketAddress;
        PlacementPolicyAdherence isEnsembleAdheringToPlacementPolicy = PlacementPolicyAdherence.FAIL;
        try {
            // we exclude the quarantined bookies also first
```

### UnusedAssignment
Variable `zonesToExclude` initializer `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ZoneawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
                    throws BKNotEnoughBookiesException {
        BookieId bookieToReplace = currentEnsemble.get(bookieToReplaceIndex);
        Set<String> zonesToExclude = null;
        Set<BookieNode> bookiesToConsiderAfterExcludingZonesAndUDs = null;
        for (int numberOfNeighborsToConsider = (desiredNumZonesPerWriteQuorumForThisEnsemble
```

### UnusedAssignment
Variable `areAckedBookiesAdheringToPlacementPolicy` initializer `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ZoneawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
        HashSet<String> zonesOfAckedBookies = new HashSet<>();
        int minNumZonesPerWriteQuorumForThisEnsemble = Math.min(writeQuorumSize, minNumZonesPerWriteQuorum);
        boolean areAckedBookiesAdheringToPlacementPolicy = false;
        ReentrantReadWriteLock.ReadLock readLock = rwLock.readLock();
        readLock.lock();
```

### UnusedAssignment
Variable `hasURLedgers` initializer `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/http/service/ListUnderReplicatedLedgerService.java`
#### Snippet
```java

            try {
                boolean hasURLedgers = false;
                List<Long> outputLedgers = null;
                Map<Long, List<String>> outputLedgersWithMissingReplica = null;
```

### UnusedAssignment
Variable `storage` initializer `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/EmbeddedServer.java`
#### Snippet
```java

            // bookie takes ownership of storage, so shuts it down
            LedgerStorage storage = null;
            DataIntegrityCheck integCheck = null;

```

### UnusedAssignment
Variable `fragmentSplitLastEntry` initializer `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerFragmentReplicator.java`
#### Snippet
```java
        }

        long fragmentSplitLastEntry = 0;
        for (int i = 0; i < splitsWithFullEntries; i++) {
            fragmentSplitLastEntry = (firstEntryId + rereplicationEntryBatchSize) - 1;
```

### UnusedAssignment
Variable `lastEntry` initializer `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/streaming/LedgerInputStream.java`
#### Snippet
```java
    private ByteBuffer bytebuff;
    byte[] bbytes;
    long lastEntry = 0;
    int increment = 50;
    int defaultSize = 1024 * 1024; // 1MB default size
```

### UnusedAssignment
Variable `ledgerSeq` initializer `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/streaming/LedgerInputStream.java`
#### Snippet
```java
    int increment = 50;
    int defaultSize = 1024 * 1024; // 1MB default size
    Enumeration<LedgerEntry> ledgerSeq = null;

    /**
```

### UnusedAssignment
The value `true` assigned to `isRecoveryOpen` is never used
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/ReplicationWorker.java`
#### Snippet
```java
                                        fragment.getEnsemble(), ledgerId);
                                lh = admin.openLedger(ledgerId);
                                isRecoveryOpen = true;
                                break;
                            }
```

### UnusedAssignment
Variable `enforceDurability` initializer `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RackawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
    protected BookieNode localNode;
    protected boolean reorderReadsRandom = false;
    protected boolean enforceDurability = false;
    protected int stabilizePeriodSeconds = 0;
    protected int reorderThresholdPendingRequests = 0;
```

### UnusedAssignment
Variable `ledgerRange` initializer `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/AuditorReplicasCheckTask.java`
#### Snippet
```java
        final Semaphore maxConcurrentSemaphore = new Semaphore(MAX_CONCURRENT_REPLICAS_CHECK_LEDGER_REQUESTS);
        while (true) {
            LedgerManager.LedgerRange ledgerRange = null;
            try {
                if (ledgerRangeIterator.hasNext()) {
```

### UnusedAssignment
Variable `map` initializer `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/metastore/InMemoryMetastoreTable.java`
#### Snippet
```java

    private String name;
    private TreeMap<String, Versioned<Value>> map = null;
    private TreeMap<String, MetastoreWatcher> watcherMap = null;
    private ScheduledExecutorService scheduler;
```

### UnusedAssignment
Variable `watcherMap` initializer `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/metastore/InMemoryMetastoreTable.java`
#### Snippet
```java
    private String name;
    private TreeMap<String, Versioned<Value>> map = null;
    private TreeMap<String, MetastoreWatcher> watcherMap = null;
    private ScheduledExecutorService scheduler;

```

### UnusedAssignment
Variable `response` initializer `null` is redundant
in `bookkeeper-http/vertx-http-server/src/main/java/org/apache/bookkeeper/http/vertx/VertxAbstractHandler.java`
#### Snippet
```java
            .setParams(convertParams(httpRequest))
            .setBody(context.body().asString());
        HttpServiceResponse response = null;
        try {
            response = httpEndpointService.handle(request);
```

### UnusedAssignment
Variable `updateBytes` initializer `null` is redundant
in `circe-checksum/src/main/java/com/scurrilous/circe/checksum/Java9IntHash.java`
#### Snippet
```java
    static {
        boolean hasJava9CRC32C = false;
        Method updateBytes = null;
        Method updateDirectByteBuffer = null;

```

### UnusedAssignment
Variable `updateDirectByteBuffer` initializer `null` is redundant
in `circe-checksum/src/main/java/com/scurrilous/circe/checksum/Java9IntHash.java`
#### Snippet
```java
        boolean hasJava9CRC32C = false;
        Method updateBytes = null;
        Method updateDirectByteBuffer = null;

        try {
```

### UnusedAssignment
Variable `logRecord` initializer `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/AppendOnlyStreamReader.java`
#### Snippet
```java

        LogReader skipReader = dlm.getInputStream(position);
        LogRecordWithInputStream logRecord = null;
        try {
            logRecord = nextLogRecord(skipReader);
```

### UnusedAssignment
Variable `nextRequest` initializer `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAsyncLogReader.java`
#### Snippet
```java
                }

                PendingReadRequest nextRequest = null;
                synchronized (this) {
                    nextRequest = pendingRequests.peek();
```

### UnusedAssignment
Variable `lockStream` initializer `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAsyncLogReader.java`
#### Snippet
```java
    protected CompletableFuture<Void> closeFuture = null;

    private boolean lockStream = false;

    private final boolean returnEndOfStreamRecord;
```

### UnusedAssignment
Variable `result` initializer `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAsyncLogWriter.java`
#### Snippet
```java
        // The passed in writer may be stale since we acquire the writer outside of sync
        // lock. If we recently rolled and the new writer is cached, use that instead.
        CompletableFuture<DLSN> result = null;
        BKLogSegmentWriter w;
        try {
```

### UnusedAssignment
Variable `conf` initializer `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LocalDLMEmulator.java`
#### Snippet
```java

        public LocalDLMEmulator build() throws Exception {
            ServerConfiguration conf = null;
            if (serverConf.isPresent()) {
                conf = serverConf.get();
```

### UnusedAssignment
Variable `zkPort` initializer `DEFAULT_ZK_PORT` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LocalDLMEmulator.java`
#### Snippet
```java

            String zkHost = DEFAULT_ZK_HOST;
            int zkPort = DEFAULT_ZK_PORT;
            if (args.length == 1) {
                zkPort = Integer.parseInt(args[0]);
```

### UnusedAssignment
Variable `requestPos` initializer `0` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/AppendOnlyStreamWriter.java`
#### Snippet
```java
    final long[] syncPos = new long[1];
    BKAsyncLogWriter logWriter;
    long requestPos = 0;

    public AppendOnlyStreamWriter(BKAsyncLogWriter logWriter, long pos) {
```

### UnusedAssignment
Variable `pos` initializer `0` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/AppendOnlyStreamWriter.java`
#### Snippet
```java

    public void force(boolean metadata) throws IOException {
        long pos = 0;
        try {
            pos = FutureUtils.result(logWriter.flushAndCommit());
```

### UnusedAssignment
Variable `dynConf` initializer `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKDistributedLogNamespace.java`
#### Snippet
```java
        mergedConfiguration.loadStreamConf(logConfiguration);
        // If dynamic config was not provided, default to a static view of the global configuration.
        DynamicDistributedLogConfiguration dynConf = null;
        if (dynamicLogConfiguration.isPresent()) {
            dynConf = dynamicLogConfiguration.get();
```

### UnusedAssignment
Variable `outstandingGauge` initializer `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/zk/LimitedPermitManager.java`
#### Snippet
```java
    volatile int epoch = 0;
    private StatsLogger statsLogger = null;
    private Gauge<Number> outstandingGauge = null;

    public LimitedPermitManager(int concurrency, int period, TimeUnit timeUnit,
```

### UnusedAssignment
Variable `statsLogger` initializer `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/zk/LimitedPermitManager.java`
#### Snippet
```java
        AtomicIntegerFieldUpdater.newUpdater(LimitedPermitManager.class, "epoch");
    volatile int epoch = 0;
    private StatsLogger statsLogger = null;
    private Gauge<Number> outstandingGauge = null;

```

### UnusedAssignment
Variable `future` initializer `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogSegmentWriter.java`
#### Snippet
```java
        // writeInternal will always set a count regardless of whether it was
        // incremented or not.
        CompletableFuture<DLSN> future = null;
        try {
            // increment the position for the record to write
```

### UnusedAssignment
Variable `lastTxId` initializer `INVALID_TXID` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogSegmentWriter.java`
#### Snippet
```java
    private DLSN lastDLSN = DLSN.InvalidDLSN;
    private final long startTxId;
    private long lastTxId = INVALID_TXID;
    private long lastTxIdAcknowledged = INVALID_TXID;
    private long outstandingBytes = 0;
```

### UnusedAssignment
Variable `streamWriteLimiter` initializer `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogSegmentWriter.java`
#### Snippet
```java

        // set up a write limiter
        PermitLimiter streamWriteLimiter = null;
        if (conf.getPerWriterOutstandingWriteLimit() < 0) {
            streamWriteLimiter = PermitLimiter.NULL_PERMIT_LIMITER;
```

### UnusedAssignment
Variable `immediateFlushEnabled` initializer `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogSegmentWriter.java`
#### Snippet
```java
    // add confirmed
    private volatile boolean controlFlushNeeded = false;
    private boolean immediateFlushEnabled = false;
    private int minDelayBetweenImmediateFlushMs = 0;
    private Stopwatch lastTransmit;
```

### UnusedAssignment
Variable `lastTxIdAcknowledged` initializer `INVALID_TXID` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogSegmentWriter.java`
#### Snippet
```java
    private final long startTxId;
    private long lastTxId = INVALID_TXID;
    private long lastTxIdAcknowledged = INVALID_TXID;
    private long outstandingBytes = 0;
    private long numFlushesSinceRestart = 0;
```

### UnusedAssignment
Variable `nextRequest` initializer `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/logsegment/BKLogSegmentEntryReader.java`
#### Snippet
```java
        long scheduleCountLocal = scheduleCountUpdater.get(this);
        while (true) {
            PendingReadRequest nextRequest = null;
            synchronized (readQueue) {
                nextRequest = readQueue.peek();
```

### UnusedAssignment
Variable `longPollRead` initializer `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/logsegment/BKLogSegmentEntryReader.java`
#### Snippet
```java
        }
        // switch to new ledger handle if the log segment is moved to completed.
        CacheEntry longPollRead = null;
        synchronized (this) {
            if (isClosed()) {
```

### UnusedAssignment
Variable `metadataFormatVersion` initializer `0` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/metadata/DLMetadata.java`
#### Snippet
```java

    // metadata format version
    private int metadataFormatVersion = 0;
    // underlying dl type
    private String dlType;
```

### UnusedAssignment
Variable `writePos` initializer `0L` is redundant
in `stream/distributedlog/io/dlfs/src/main/java/org/apache/distributedlog/fs/DLOutputStream.java`
#### Snippet
```java
    // positions
    private final long[] syncPos = new long[1];
    private long writePos = 0L;

    // state
```

### UnusedAssignment
Variable `id` initializer `0` is redundant
in `bookkeeper-benchmark/src/main/java/org/apache/bookkeeper/benchmark/BenchBookie.java`
#### Snippet
```java
        BookKeeper bkc = null;
        LedgerHandle lh = null;
        long id = 0;
        try {
            bkc = new BookKeeper(zkServers);
```

### UnusedAssignment
Variable `numberOfLedgers` initializer `1` is redundant
in `bookkeeper-benchmark/src/main/java/org/apache/bookkeeper/benchmark/BenchThroughputLatency.java`
#### Snippet
```java

    Semaphore sem;
    int numberOfLedgers = 1;
    final int sendLimit;
    final long[] latencies;
```

### UnusedAssignment
Variable `count` initializer `0` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
            DistributedLogManager dlm = getNamespace().openLog(getStreamName());
            try {
                long count = 0;
                if (null == endDLSN) {
                    count = countToLastRecord(dlm);
```

### UnusedAssignment
Variable `writePos` initializer `0L` is redundant
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/dlog/DLOutputStream.java`
#### Snippet
```java
    // positions
    private final long[] syncPos = new long[1];
    private long writePos = 0L;

    // state
```

### UnusedAssignment
Variable `rawEndKey` initializer `NULL_END_KEY` is redundant
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/mvcc/MVCCStoreImpl.java`
#### Snippet
```java
        // raw key
        byte[] rawKey = (null != key) ? keyCoder.encode(key) : NULL_START_KEY;
        byte[] rawEndKey = NULL_END_KEY;
        if (null == endKey) {
            // point lookup
```

## RuleId[id=IndexOfReplaceableByContains]
### IndexOfReplaceableByContains
`OS_NAME.indexOf("mac") >= 0` can be replaced with 'OS_NAME.contains("mac")'
in `circe-checksum/src/main/java/com/scurrilous/circe/utils/NativeUtils.java`
#### Snippet
```java
    public static String libType() {

        if (OS_NAME.indexOf("mac") >= 0) {
            return "jnilib";
        } else if (OS_NAME.indexOf("nix") >= 0 || OS_NAME.indexOf("nux") >= 0 || OS_NAME.indexOf("aix") > 0) {
```

### IndexOfReplaceableByContains
`OS_NAME.indexOf("nix") >= 0` can be replaced with 'OS_NAME.contains("nix")'
in `circe-checksum/src/main/java/com/scurrilous/circe/utils/NativeUtils.java`
#### Snippet
```java
        if (OS_NAME.indexOf("mac") >= 0) {
            return "jnilib";
        } else if (OS_NAME.indexOf("nix") >= 0 || OS_NAME.indexOf("nux") >= 0 || OS_NAME.indexOf("aix") > 0) {
            return "so";
        } else if (OS_NAME.indexOf("win") >= 0) {
```

### IndexOfReplaceableByContains
`OS_NAME.indexOf("nux") >= 0` can be replaced with 'OS_NAME.contains("nux")'
in `circe-checksum/src/main/java/com/scurrilous/circe/utils/NativeUtils.java`
#### Snippet
```java
        if (OS_NAME.indexOf("mac") >= 0) {
            return "jnilib";
        } else if (OS_NAME.indexOf("nix") >= 0 || OS_NAME.indexOf("nux") >= 0 || OS_NAME.indexOf("aix") > 0) {
            return "so";
        } else if (OS_NAME.indexOf("win") >= 0) {
```

### IndexOfReplaceableByContains
`OS_NAME.indexOf("win") >= 0` can be replaced with 'OS_NAME.contains("win")'
in `circe-checksum/src/main/java/com/scurrilous/circe/utils/NativeUtils.java`
#### Snippet
```java
        } else if (OS_NAME.indexOf("nix") >= 0 || OS_NAME.indexOf("nux") >= 0 || OS_NAME.indexOf("aix") > 0) {
            return "so";
        } else if (OS_NAME.indexOf("win") >= 0) {
            return "dll";
        }
```

## RuleId[id=DoubleNegation]
### DoubleNegation
Double negation in `response.isSucceeded() != (Version.NEW != cookieData.getVersion())`
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdRegistrationManager.java`
#### Snippet
```java
        }
        TxnResponse response = msResult(txn.commit());
        if (response.isSucceeded() != (Version.NEW != cookieData.getVersion())) {
            throw new MetadataStoreException(
                "Conflict on writing cookie for bookie " + bookieId);
```

## RuleId[id=ManualArrayToCollectionCopy]
### ManualArrayToCollectionCopy
Manual array to collection copy
in `stream/api/src/main/java/org/apache/bookkeeper/api/kv/impl/op/TxnOpBuilderImpl.java`
#### Snippet
```java
            successOps = Lists.newArrayList();
        }
        for (Op<K, V> op : ops) {
            successOps.add(op);
        }
```

### ManualArrayToCollectionCopy
Manual array to collection copy
in `stream/api/src/main/java/org/apache/bookkeeper/api/kv/impl/op/TxnOpBuilderImpl.java`
#### Snippet
```java
            compareOps = Lists.newArrayList();
        }
        for (CompareOp<K, V> cmp : cmps) {
            compareOps.add(cmp);
        }
```

### ManualArrayToCollectionCopy
Manual array to collection copy
in `stream/api/src/main/java/org/apache/bookkeeper/api/kv/impl/op/TxnOpBuilderImpl.java`
#### Snippet
```java
            failureOps = Lists.newArrayList();
        }
        for (Op<K, V> op : ops) {
            failureOps.add(op);
        }
```

### ManualArrayToCollectionCopy
Manual array to collection copy
in `stream/common/src/main/java/org/apache/bookkeeper/common/resolver/ServiceNameResolverProvider.java`
#### Snippet
```java
                // create a static resolver taking the list of servers.
                List<String> hostList = new ArrayList<>();
                for (String host : hosts) {
                    hostList.add(host);
                }
```

## RuleId[id=UnnecessarySemicolon]
### UnnecessarySemicolon
Unnecessary semicolon `;`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/Header.java`
#### Snippet
```java
        buf.setInt(LOGFILE_LEGACY_HEADER_SIZE, (buf.capacity() - LOGFILE_LEGACY_HEADER_SIZE) - Integer.BYTES);
        buf.setLong(LOGFILE_LEGACY_HEADER_SIZE + Integer.BYTES, LogMetadata.INVALID_LID);
    };
    static int extractVersion(ByteBuf header) throws IOException {
        assertFingerPrint(header);
```

### UnnecessarySemicolon
Unnecessary semicolon `;`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/datainteg/DataIntegrityCheckImpl.java`
#### Snippet
```java
        enum State {
            MISSING, ERROR, OK
        };

        static LedgerResult missing(long ledgerId) {
```

## RuleId[id=SimplifyStreamApiCallChains]
### SimplifyStreamApiCallChains
Can be replaced with 'java.util.HashSet' constructor
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookie/RegenerateInterleavedStorageIndexFileCommand.java`
#### Snippet
```java
        }

        Set<Long> ledgerIds = flags.ledgerIds.stream().collect(Collectors.toSet());

        LOG.info("=== Rebuilding index file for {} ===", ledgerIds);
```

### SimplifyStreamApiCallChains
''stream().forEach()'' can be replaced with 'forEach()'' (may change semantics)
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryLogManagerForEntryLogPerLedger.java`
#### Snippet
```java
        Map<File, MutableInt> writableLedgerDirFrequency = new HashMap<File, MutableInt>();
        writableLedgerDirs.stream()
                .forEach((ledgerDir) -> writableLedgerDirFrequency.put(ledgerDir, new MutableInt()));
        for (BufferedLogChannelWithDirInfo logChannelWithDirInfo : replicaOfCurrentLogChannels.values()) {
            File parentDirOfCurrentLogChannel = logChannelWithDirInfo.getLogChannel().getLogFile().getParentFile();
```

### SimplifyStreamApiCallChains
''stream().forEach()'' can be replaced with 'forEach()'' (may change semantics)
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/DbLedgerStorage.java`
#### Snippet
```java
    @Override
    public void forceGC() {
        ledgerStorageList.stream().forEach(SingleDirectoryDbLedgerStorage::forceGC);
    }

```

### SimplifyStreamApiCallChains
''stream().forEach()'' can be replaced with 'forEach()'' (may change semantics)
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/DbLedgerStorage.java`
#### Snippet
```java
    @Override
    public void suspendMinorGC() {
        ledgerStorageList.stream().forEach(SingleDirectoryDbLedgerStorage::suspendMinorGC);
    }

```

### SimplifyStreamApiCallChains
''stream().forEach()'' can be replaced with 'forEach()'' (may change semantics)
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/DbLedgerStorage.java`
#### Snippet
```java
    @Override
    public void resumeMajorGC() {
        ledgerStorageList.stream().forEach(SingleDirectoryDbLedgerStorage::resumeMajorGC);
    }

```

### SimplifyStreamApiCallChains
''stream().forEach()'' can be replaced with 'forEach()'' (may change semantics)
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/DbLedgerStorage.java`
#### Snippet
```java
    @Override
    public void resumeMinorGC() {
        ledgerStorageList.stream().forEach(SingleDirectoryDbLedgerStorage::resumeMinorGC);
    }

```

### SimplifyStreamApiCallChains
''stream().forEach()'' can be replaced with 'forEach()'' (may change semantics)
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/DbLedgerStorage.java`
#### Snippet
```java
    @Override
    public void suspendMajorGC() {
        ledgerStorageList.stream().forEach(SingleDirectoryDbLedgerStorage::suspendMajorGC);
    }

```

### SimplifyStreamApiCallChains
''stream().forEach()'' can be replaced with 'forEach()'' (may change semantics)
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/DbLedgerStorage.java`
#### Snippet
```java
    @Override
    public void forceGC(Boolean forceMajor, Boolean forceMinor) {
        ledgerStorageList.stream().forEach(s -> s.forceGC(forceMajor, forceMinor));
    }

```

### SimplifyStreamApiCallChains
Can be replaced with 'collection.toArray()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/UpdateLedgerOp.java`
#### Snippet
```java
        }

        CompletableFuture.allOf(outstanding.stream().toArray(CompletableFuture[]::new))
            .whenComplete((res, ex) -> {
                    if (ex != null) {
```

### SimplifyStreamApiCallChains
'!Stream.anyMatch(...)' can be replaced with 'noneMatch()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/Main.java`
#### Snippet
```java
            for (File j : journalDirs) {
                File cur = BookieImpl.getCurrentDirectory(j);
                if (!dirs.stream().anyMatch(f -> f.equals(cur))) {
                    BookieImpl.checkDirectoryStructure(cur);
                    dirs.add(cur);
```

### SimplifyStreamApiCallChains
'!Stream.anyMatch(...)' can be replaced with 'noneMatch()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/Main.java`
#### Snippet
```java
            for (File l : ledgerDirs) {
                File cur = BookieImpl.getCurrentDirectory(l);
                if (!dirs.stream().anyMatch(f -> f.equals(cur))) {
                    BookieImpl.checkDirectoryStructure(cur);
                    dirs.add(cur);
```

### SimplifyStreamApiCallChains
'!Stream.anyMatch(...)' can be replaced with 'noneMatch()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/Main.java`
#### Snippet
```java
            for (File i : indexDirs) {
                File cur = BookieImpl.getCurrentDirectory(i);
                if (!dirs.stream().anyMatch(f -> f.equals(cur))) {
                    BookieImpl.checkDirectoryStructure(cur);
                    dirs.add(cur);
```

### SimplifyStreamApiCallChains
Can be replaced with 'java.util.HashSet' constructor
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/RocksdbCheckpointTask.java`
#### Snippet
```java
        }
        Set<String> allSsts = checkpointStore.listFiles(RocksUtils.getDestSstsPath(dbPrefix))
            .stream()
            .collect(Collectors.toSet());

        Set<String> toDelete = Sets.difference(allSsts, sstsToKeep);
```

## RuleId[id=StringOperationCanBeSimplified]
### StringOperationCanBeSimplified
`toLowerCase()` call can be replaced with 'equalsIgnoreCase()'
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/net/ServiceURI.java`
#### Snippet
```java
            }
            return hostname;
        } else if (parts.length == 1 && serviceName.toLowerCase().equals(SERVICE_BK)) {
            return hostname + ":" + SERVICE_BK_PORT;
        } else {
```

## RuleId[id=OptionalContainsCollection]
### OptionalContainsCollection
'Optional' contains array `byte[]`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerMetadataBuilder.java`
#### Snippet
```java

    private Optional<DigestType> digestType = Optional.empty();
    private Optional<byte[]> password = Optional.empty();

    private long ctime = -1;
```

### OptionalContainsCollection
'Optional' contains array `byte[]`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerMetadataImpl.java`
#### Snippet
```java
                       Map<Long, List<BookieId>> ensembles,
                       Optional<DigestType> digestType,
                       Optional<byte[]> password,
                       long ctime,
                       boolean storeCtime,
```

### OptionalContainsCollection
'Optional' contains collection `Set`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeperAdmin.java`
#### Snippet
```java
                List<BookieId> ensemble,
                Set<Integer> bookieIndexesToRereplicate,
                Optional<Set<BookieId>> excludedBookies)
            throws BKException.BKNotEnoughBookiesException {
        // target bookies to replicate
```

### OptionalContainsCollection
'Optional' contains collection `Set`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeperAdmin.java`
#### Snippet
```java
        Map<Integer, BookieId> targetBookieAddresses = null;
        if (LedgerFragment.ReplicateType.DATA_LOSS == ledgerFragment.getReplicateType()) {
            Optional<Set<BookieId>> excludedBookies = Optional.empty();
            targetBookieAddresses = getReplacementBookiesByIndexes(lh, ledgerFragment.getEnsemble(),
                    ledgerFragment.getBookiesIndexes(), excludedBookies);
```

## RuleId[id=MethodOverloadsParentMethod]
### MethodOverloadsParentMethod
Method `wait()` overloads a compatible method of a superclass, when overriding might have been intended
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieClientImpl.java`
#### Snippet
```java
        }

        synchronized void wait(int limit) throws InterruptedException {
            while (i > limit) {
                wait();
```

## RuleId[id=NonSynchronizedMethodOverridesSynchronizedMethod]
### NonSynchronizedMethodOverridesSynchronizedMethod
Unsynchronized method `getCause()` overrides synchronized method
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/UncheckedConfigurationException.java`
#### Snippet
```java
     */
    @Override
    public ConfigurationException getCause() {
        return (ConfigurationException) super.getCause();
    }
```

### NonSynchronizedMethodOverridesSynchronizedMethod
Unsynchronized method `fillInStackTrace()` overrides synchronized method
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieException.java`
#### Snippet
```java

        @Override
        public Throwable fillInStackTrace() {
            // Since this exception is a way to signal a specific condition and it's triggered and very specific points,
            // we can disable stack traces.
```

### NonSynchronizedMethodOverridesSynchronizedMethod
Unsynchronized method `flush()` overrides synchronized method
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/SlowBufferedChannel.java`
#### Snippet
```java

    @Override
    public void flush() throws IOException {
        delayMs(flushDelay);
        super.flush();
```

### NonSynchronizedMethodOverridesSynchronizedMethod
Unsynchronized method `close()` overrides synchronized method
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/zookeeper/ZooKeeperClient.java`
#### Snippet
```java

    @Override
    public void close() throws InterruptedException {
        closed.set(true);
        connectExecutor.shutdown();
```

### NonSynchronizedMethodOverridesSynchronizedMethod
Unsynchronized method `close()` overrides synchronized method
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdMetadataBookieDriver.java`
#### Snippet
```java

    @Override
    public void close() {
        RegistrationManager rmToClose;
        EtcdBookieRegister bkRegisterToClose;
```

### NonSynchronizedMethodOverridesSynchronizedMethod
Unsynchronized method `fillInStackTrace()` overrides synchronized method
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/SingleThreadExecutor.java`
#### Snippet
```java
        }
        @Override
        public Throwable fillInStackTrace() {
            // Avoid the stack traces to be generated for this exception. This is done
            // because when rejectExecution=true, there could be many such exceptions
```

### NonSynchronizedMethodOverridesSynchronizedMethod
Unsynchronized method `put()` overrides synchronized method
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/mvcc/MVCCStoreImpl.java`
#### Snippet
```java

    @Override
    public void put(K key, V value) {
        throw new UnsupportedOperationException("Please use #put(PutOp op) instead");
    }
```

## RuleId[id=PublicFieldAccessedInSynchronizedContext]
### PublicFieldAccessedInSynchronizedContext
Non-private field `timersPerThread` accessed in synchronized context
in `microbenchmarks/src/main/java/org/apache/bookkeeper/stats/codahale/TimerBenchmark.java`
#### Snippet
```java
                // concurrency of timer updates.
                if (timers == null) {
                    timers = new OpStatsLogger[timersPerThread];
                    for (int i = 0; i < timersPerThread; i++) {
                        timers[i] = logger.getOpStatsLogger("test-timer-" + i);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `timersPerThread` accessed in synchronized context
in `microbenchmarks/src/main/java/org/apache/bookkeeper/stats/codahale/TimerBenchmark.java`
#### Snippet
```java
                if (timers == null) {
                    timers = new OpStatsLogger[timersPerThread];
                    for (int i = 0; i < timersPerThread; i++) {
                        timers[i] = logger.getOpStatsLogger("test-timer-" + i);
                    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.lastPresentTime` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/StabilizeNetworkTopology.java`
#### Snippet
```java

        synchronized long getLastPresentTime() {
            return this.lastPresentTime;
        }
    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `tentativeToRemove` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/StabilizeNetworkTopology.java`
#### Snippet
```java

        synchronized boolean isTentativeToRemove() {
            return tentativeToRemove;
        }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.tentativeToRemove` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/StabilizeNetworkTopology.java`
#### Snippet
```java

        synchronized NodeStatus updateStatus(boolean tentativeToRemove) {
            this.tentativeToRemove = tentativeToRemove;
            if (!this.tentativeToRemove) {
                this.lastPresentTime = System.currentTimeMillis();
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.tentativeToRemove` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/StabilizeNetworkTopology.java`
#### Snippet
```java
        synchronized NodeStatus updateStatus(boolean tentativeToRemove) {
            this.tentativeToRemove = tentativeToRemove;
            if (!this.tentativeToRemove) {
                this.lastPresentTime = System.currentTimeMillis();
            }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.lastPresentTime` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/StabilizeNetworkTopology.java`
#### Snippet
```java
            this.tentativeToRemove = tentativeToRemove;
            if (!this.tentativeToRemove) {
                this.lastPresentTime = System.currentTimeMillis();
            }
            return this;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `nextRange` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/FlatLedgerManager.java`
#### Snippet
```java

            private synchronized void preload() throws IOException {
                if (nextRange != null) {
                    return;
                }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `nextRange` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/FlatLedgerManager.java`
#### Snippet
```java
                            ZkUtils.getChildrenInSingleNode(zk, ledgerRootPath, zkOpTimeoutMs),
                            ledgerRootPath);
                    nextRange = new LedgerRange(zkActiveLedgers);
                } catch (KeeperException.NoNodeException e) {
                    throw new IOException("Path does not exist: " + ledgerRootPath, e);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `nextRange` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/FlatLedgerManager.java`
#### Snippet
```java
            public synchronized boolean hasNext() throws IOException {
                preload();
                return nextRange != null && nextRange.size() > 0 && !nextCalled;
            }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `nextRange` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/FlatLedgerManager.java`
#### Snippet
```java
            public synchronized boolean hasNext() throws IOException {
                preload();
                return nextRange != null && nextRange.size() > 0 && !nextCalled;
            }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `nextCalled` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/FlatLedgerManager.java`
#### Snippet
```java
            public synchronized boolean hasNext() throws IOException {
                preload();
                return nextRange != null && nextRange.size() > 0 && !nextCalled;
            }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `nextCalled` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/FlatLedgerManager.java`
#### Snippet
```java
                    throw new NoSuchElementException();
                }
                nextCalled = true;
                return nextRange;
            }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `nextRange` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/FlatLedgerManager.java`
#### Snippet
```java
                }
                nextCalled = true;
                return nextRange;
            }
        };
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.serverConf` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/zk/ZKMetadataBookieDriver.java`
#### Snippet
```java
                        conf.getZkRetryBackoffMaxMs(), conf.getZkRetryBackoffMaxRetries()),
            Optional.empty());
        this.serverConf = conf;
        this.statsLogger = statsLogger;
        return this;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.statsLogger` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/zk/ZKMetadataBookieDriver.java`
#### Snippet
```java
            Optional.empty());
        this.serverConf = conf;
        this.statsLogger = statsLogger;
        return this;
    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `serverConf` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/zk/ZKMetadataBookieDriver.java`
#### Snippet
```java
    @Override
    public synchronized RegistrationManager createRegistrationManager() {
        return new ZKRegistrationManager(serverConf, zk);
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `zk` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/zk/ZKMetadataBookieDriver.java`
#### Snippet
```java
    @Override
    public synchronized RegistrationManager createRegistrationManager() {
        return new ZKRegistrationManager(serverConf, zk);
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `regClient` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/zk/ZKMetadataClientDriver.java`
#### Snippet
```java
    @Override
    public synchronized void close() {
        if (null != regClient) {
            regClient.close();
            regClient = null;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `regClient` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/zk/ZKMetadataClientDriver.java`
#### Snippet
```java
    public synchronized void close() {
        if (null != regClient) {
            regClient.close();
            regClient = null;
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `regClient` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/zk/ZKMetadataClientDriver.java`
#### Snippet
```java
        if (null != regClient) {
            regClient.close();
            regClient = null;
        }
        super.close();
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `regClient` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/zk/ZKMetadataClientDriver.java`
#### Snippet
```java
    @Override
    public synchronized RegistrationClient getRegistrationClient() {
        if (null == regClient) {
            regClient = new ZKRegistrationClient(
                zk,
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `regClient` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/zk/ZKMetadataClientDriver.java`
#### Snippet
```java
    public synchronized RegistrationClient getRegistrationClient() {
        if (null == regClient) {
            regClient = new ZKRegistrationClient(
                zk,
                ledgersRootPath,
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `zk` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/zk/ZKMetadataClientDriver.java`
#### Snippet
```java
        if (null == regClient) {
            regClient = new ZKRegistrationClient(
                zk,
                ledgersRootPath,
                scheduler,
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `ledgersRootPath` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/zk/ZKMetadataClientDriver.java`
#### Snippet
```java
            regClient = new ZKRegistrationClient(
                zk,
                ledgersRootPath,
                scheduler,
                bookieAddressTracking);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `scheduler` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/zk/ZKMetadataClientDriver.java`
#### Snippet
```java
                zk,
                ledgersRootPath,
                scheduler,
                bookieAddressTracking);
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `bookieAddressTracking` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/zk/ZKMetadataClientDriver.java`
#### Snippet
```java
                ledgersRootPath,
                scheduler,
                bookieAddressTracking);
        }
        return regClient;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `regClient` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/zk/ZKMetadataClientDriver.java`
#### Snippet
```java
                bookieAddressTracking);
        }
        return regClient;
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.statsLogger` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/zk/ZKMetadataClientDriver.java`
#### Snippet
```java
                conf.getZkRetryBackoffMaxRetries()),
            optionalCtx);
        this.statsLogger = statsLogger;
        this.clientConf = conf;
        this.scheduler = scheduler;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.clientConf` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/zk/ZKMetadataClientDriver.java`
#### Snippet
```java
            optionalCtx);
        this.statsLogger = statsLogger;
        this.clientConf = conf;
        this.scheduler = scheduler;
        this.bookieAddressTracking = conf.getEnableBookieAddressTracking();
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.scheduler` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/zk/ZKMetadataClientDriver.java`
#### Snippet
```java
        this.statsLogger = statsLogger;
        this.clientConf = conf;
        this.scheduler = scheduler;
        this.bookieAddressTracking = conf.getEnableBookieAddressTracking();
        return this;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.bookieAddressTracking` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/zk/ZKMetadataClientDriver.java`
#### Snippet
```java
        this.clientConf = conf;
        this.scheduler = scheduler;
        this.bookieAddressTracking = conf.getEnableBookieAddressTracking();
        return this;
    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lmFactory` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/zk/ZKMetadataDriverBase.java`
#### Snippet
```java
    public synchronized LedgerManagerFactory getLedgerManagerFactory()
            throws MetadataException {
        if (null == lmFactory) {
            try {
                lmFactory = AbstractZkLedgerManagerFactory.newLedgerManagerFactory(
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lmFactory` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/zk/ZKMetadataDriverBase.java`
#### Snippet
```java
        if (null == lmFactory) {
            try {
                lmFactory = AbstractZkLedgerManagerFactory.newLedgerManagerFactory(
                    conf,
                    layoutManager);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `conf` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/zk/ZKMetadataDriverBase.java`
#### Snippet
```java
            try {
                lmFactory = AbstractZkLedgerManagerFactory.newLedgerManagerFactory(
                    conf,
                    layoutManager);
            } catch (IOException e) {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `layoutManager` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/zk/ZKMetadataDriverBase.java`
#### Snippet
```java
                lmFactory = AbstractZkLedgerManagerFactory.newLedgerManagerFactory(
                    conf,
                    layoutManager);
            } catch (IOException e) {
                throw new MetadataException(
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lmFactory` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/zk/ZKMetadataDriverBase.java`
#### Snippet
```java
            }
        }
        return lmFactory;
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `pendingWatchers` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/SubTreeCache.java`
#### Snippet
```java
     */
    public synchronized void registerWatcher(Watcher watcher) {
        pendingWatchers.add(watcher);
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `cachedNodes` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/SubTreeCache.java`
#### Snippet
```java
            synchronized (SubTreeCache.this) {
                handleEvent(event);
                cachedNodes.remove(path);
            }
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `cachedNodes` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/SubTreeCache.java`
#### Snippet
```java
     */
    public synchronized List<String> getChildren(String path) throws KeeperException, InterruptedException {
        SubTreeNode node = cachedNodes.get(path);
        if (null == node) {
            node = new SubTreeNode(path);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `provider` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/SubTreeCache.java`
#### Snippet
```java
        if (null == node) {
            node = new SubTreeNode(path);
            node.setChildren(provider.getChildren(path, node));
            cachedNodes.put(path, node);
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `cachedNodes` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/SubTreeCache.java`
#### Snippet
```java
            node = new SubTreeNode(path);
            node.setChildren(provider.getChildren(path, node));
            cachedNodes.put(path, node);
        }
        return node.getChildren();
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `pendingWatchers` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/SubTreeCache.java`
#### Snippet
```java

    private synchronized void handleEvent(WatchedEvent event) {
        Set<Watcher> toReturn = pendingWatchers;
        for (Watcher watcher: pendingWatchers) {
            watcher.process(event);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `pendingWatchers` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/SubTreeCache.java`
#### Snippet
```java
    private synchronized void handleEvent(WatchedEvent event) {
        Set<Watcher> toReturn = pendingWatchers;
        for (Watcher watcher: pendingWatchers) {
            watcher.process(event);
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `pendingWatchers` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/SubTreeCache.java`
#### Snippet
```java
            watcher.process(event);
        }
        pendingWatchers.clear();
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `pendingWatchers` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/SubTreeCache.java`
#### Snippet
```java
     */
    public synchronized void cancelWatcher(Watcher watcher) {
        pendingWatchers.remove(watcher);
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `map` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/SynchronizedHashMultiMap.java`
#### Snippet
```java

    public synchronized void put(K k, V v) {
        map.computeIfAbsent(k.hashCode(), (ignore) -> new HashSet<>()).add(Pair.of(k, v));
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `map` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/SynchronizedHashMultiMap.java`
#### Snippet
```java

    public synchronized int removeIf(BiPredicate<K, V> predicate) {
        int removedSum = map.values().stream().mapToInt(
                pairs -> {
                    int removed = 0;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `map` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/SynchronizedHashMultiMap.java`
#### Snippet
```java
                    return removed;
                }).sum();
        map.values().removeIf((s) -> s.isEmpty());
        return removedSum;
    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `map` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/SynchronizedHashMultiMap.java`
#### Snippet
```java

    public synchronized Optional<K> getAnyKey() {
        return map.values().stream().findAny().flatMap(pairs -> pairs.stream().findAny().map(p -> p.getLeft()));
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `map` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/SynchronizedHashMultiMap.java`
#### Snippet
```java

    public synchronized Optional<V> removeAny(K k) {
        Set<Pair<K, V>> set = map.getOrDefault(k.hashCode(), Collections.emptySet());
        Optional<Pair<K, V>> pair = set.stream().filter(p -> p.getLeft().equals(k)).findAny();
        pair.ifPresent(p -> set.remove(p));
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `totalLatency` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BKStats.java`
#### Snippet
```java
                return;
            }
            totalLatency += latency;
            ++numSuccessOps;
            if (latency < minLatency) {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `numSuccessOps` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BKStats.java`
#### Snippet
```java
            }
            totalLatency += latency;
            ++numSuccessOps;
            if (latency < minLatency) {
                minLatency = latency;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `minLatency` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BKStats.java`
#### Snippet
```java
            totalLatency += latency;
            ++numSuccessOps;
            if (latency < minLatency) {
                minLatency = latency;
            }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `minLatency` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BKStats.java`
#### Snippet
```java
            ++numSuccessOps;
            if (latency < minLatency) {
                minLatency = latency;
            }
            if (latency > maxLatency) {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `maxLatency` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BKStats.java`
#### Snippet
```java
                minLatency = latency;
            }
            if (latency > maxLatency) {
                maxLatency = latency;
            }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `maxLatency` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BKStats.java`
#### Snippet
```java
            }
            if (latency > maxLatency) {
                maxLatency = latency;
            }
            int bucket;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `latencyBuckets` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BKStats.java`
#### Snippet
```java
                bucket = 3 * 9 + 1;
            }
            ++latencyBuckets[bucket];
        }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.maxLatency` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BKStats.java`
#### Snippet
```java
         */
        public synchronized void copyOf(OpStats other) {
            this.maxLatency = other.maxLatency;
            this.minLatency = other.minLatency;
            this.totalLatency = other.totalLatency;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.minLatency` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BKStats.java`
#### Snippet
```java
        public synchronized void copyOf(OpStats other) {
            this.maxLatency = other.maxLatency;
            this.minLatency = other.minLatency;
            this.totalLatency = other.totalLatency;
            this.numSuccessOps = other.numSuccessOps;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.totalLatency` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BKStats.java`
#### Snippet
```java
            this.maxLatency = other.maxLatency;
            this.minLatency = other.minLatency;
            this.totalLatency = other.totalLatency;
            this.numSuccessOps = other.numSuccessOps;
            this.numFailedOps = other.numFailedOps;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.numSuccessOps` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BKStats.java`
#### Snippet
```java
            this.minLatency = other.minLatency;
            this.totalLatency = other.totalLatency;
            this.numSuccessOps = other.numSuccessOps;
            this.numFailedOps = other.numFailedOps;
            System.arraycopy(other.latencyBuckets, 0, this.latencyBuckets, 0, this.latencyBuckets.length);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.numFailedOps` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BKStats.java`
#### Snippet
```java
            this.totalLatency = other.totalLatency;
            this.numSuccessOps = other.numSuccessOps;
            this.numFailedOps = other.numFailedOps;
            System.arraycopy(other.latencyBuckets, 0, this.latencyBuckets, 0, this.latencyBuckets.length);
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.latencyBuckets` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BKStats.java`
#### Snippet
```java
            this.numSuccessOps = other.numSuccessOps;
            this.numFailedOps = other.numFailedOps;
            System.arraycopy(other.latencyBuckets, 0, this.latencyBuckets, 0, this.latencyBuckets.length);
        }
    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.latencyBuckets` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BKStats.java`
#### Snippet
```java
            this.numSuccessOps = other.numSuccessOps;
            this.numFailedOps = other.numFailedOps;
            System.arraycopy(other.latencyBuckets, 0, this.latencyBuckets, 0, this.latencyBuckets.length);
        }
    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `numFailedOps` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BKStats.java`
#### Snippet
```java
         */
        public synchronized void incrementFailedOps() {
            ++numFailedOps;
        }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lastPhaseStartTime` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/LongPollReadEntryProcessorV3.java`
#### Snippet
```java
            }

            registerEvent(timeout, requestProcessor.getRequestStats().getLongPollWaitStats(), lastPhaseStartTime);
            lastPhaseStartTime.reset().start();
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lastPhaseStartTime` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/LongPollReadEntryProcessorV3.java`
#### Snippet
```java

            registerEvent(timeout, requestProcessor.getRequestStats().getLongPollWaitStats(), lastPhaseStartTime);
            lastPhaseStartTime.reset().start();
        }
    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `authenticated` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/AuthHandler.java`
#### Snippet
```java
        public void write(ChannelHandlerContext ctx, Object msg, ChannelPromise promise) throws Exception {
            synchronized (this) {
                if (authenticated) {
                    super.write(ctx, msg, promise);
                    super.flush(ctx);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `authenticated` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/AuthHandler.java`
#### Snippet
```java
                if (rc == BKException.Code.OK) {
                    synchronized (this) {
                        authenticated = true;
                        Object msg = waitingForAuth.poll();
                        while (msg != null) {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `ctx` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/AuthHandler.java`
#### Snippet
```java
                        Object msg = waitingForAuth.poll();
                        while (msg != null) {
                            ctx.writeAndFlush(msg);
                            msg = waitingForAuth.poll();
                        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `suspended` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieNettyServer.java`
#### Snippet
```java
    void resumeProcessing() {
        synchronized (suspensionLock) {
            suspended = false;
            for (Channel channel : allChannels) {
                channel.config().setAutoRead(true);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `allChannels` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieNettyServer.java`
#### Snippet
```java
        synchronized (suspensionLock) {
            suspended = false;
            for (Channel channel : allChannels) {
                channel.config().setAutoRead(true);
            }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `suspended` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieNettyServer.java`
#### Snippet
```java
                protected void initChannel(SocketChannel ch) throws Exception {
                    synchronized (suspensionLock) {
                        while (suspended) {
                            suspensionLock.wait();
                        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `suspended` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieNettyServer.java`
#### Snippet
```java
    void suspendProcessing() {
        synchronized (suspensionLock) {
            suspended = true;
            for (Channel channel : allChannels) {
                // To suspend processing in the bookie, submit a task
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `allChannels` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieNettyServer.java`
#### Snippet
```java
        synchronized (suspensionLock) {
            suspended = true;
            for (Channel channel : allChannels) {
                // To suspend processing in the bookie, submit a task
                // that keeps the event loop busy until resume is
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `suspended` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieNettyServer.java`
#### Snippet
```java
                protected void initChannel(LocalChannel ch) throws Exception {
                    synchronized (suspensionLock) {
                        while (suspended) {
                            suspensionLock.wait();
                        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.nettyServer` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieServer.java`
#### Snippet
```java
    public synchronized void shutdown() {
        LOG.info("Shutting down BookieServer");
        this.nettyServer.shutdown();
        if (!running) {
            return;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `exitCode` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieServer.java`
#### Snippet
```java
        }
        this.requestProcessor.close();
        exitCode = bookie.shutdown();
        uncleanShutdownDetection.registerCleanShutdown();
        running = false;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `uncleanShutdownDetection` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieServer.java`
#### Snippet
```java
        this.requestProcessor.close();
        exitCode = bookie.shutdown();
        uncleanShutdownDetection.registerCleanShutdown();
        running = false;
    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `requestProcessor` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PacketProcessorBase.java`
#### Snippet
```java
            if (!requestProcessor.isBlacklisted(channel)) {
                synchronized (channel) {
                    if (!channel.isWritable() && !requestProcessor.isBlacklisted(channel)) {
                        final long waitUntilNanos = writeNanos + TimeUnit.MILLISECONDS.toNanos(timeOut);
                        while (!channel.isWritable() && MathUtils.nowInNano() < waitUntilNanos) {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `requestProcessor` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PacketProcessorBase.java`
#### Snippet
```java
                        }
                        if (!channel.isWritable()) {
                            requestProcessor.blacklistChannel(channel);
                            requestProcessor.handleNonWritableChannel(channel);
                        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `requestProcessor` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PacketProcessorBase.java`
#### Snippet
```java
                        if (!channel.isWritable()) {
                            requestProcessor.blacklistChannel(channel);
                            requestProcessor.handleNonWritableChannel(channel);
                        }
                    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `entryLogger` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookie/ReadLogMetadataCommand.java`
#### Snippet
```java
    private synchronized void initEntryLogger(ServerConfiguration conf) throws IOException {
        // provide read only entry logger
        if (null == entryLogger) {
            entryLogger = new ReadOnlyDefaultEntryLogger(conf);
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `entryLogger` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookie/ReadLogMetadataCommand.java`
#### Snippet
```java
        // provide read only entry logger
        if (null == entryLogger) {
            entryLogger = new ReadOnlyDefaultEntryLogger(conf);
        }
    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `journals` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookie/ReadJournalCommand.java`
#### Snippet
```java

    private synchronized List<Journal> getJournals(ServerConfiguration conf) throws IOException {
        if (null == journals) {
            journals = Lists.newArrayListWithCapacity(conf.getJournalDirs().length);
            int idx = 0;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `journals` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookie/ReadJournalCommand.java`
#### Snippet
```java
    private synchronized List<Journal> getJournals(ServerConfiguration conf) throws IOException {
        if (null == journals) {
            journals = Lists.newArrayListWithCapacity(conf.getJournalDirs().length);
            int idx = 0;
            for (File journalDir : conf.getJournalDirs()) {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `journals` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookie/ReadJournalCommand.java`
#### Snippet
```java
            int idx = 0;
            for (File journalDir : conf.getJournalDirs()) {
                journals.add(new Journal(idx++, new File(journalDir, BookKeeperConstants.CURRENT_DIR), conf,
                         new LedgerDirsManager(conf, conf.getLedgerDirs(),
                               new DiskChecker(conf.getDiskUsageThreshold(), conf.getDiskUsageWarnThreshold()))));
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `journals` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookie/ReadJournalCommand.java`
#### Snippet
```java
            }
        }
        return journals;
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `state` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java

            synchronized (PerChannelBookieClient.this) {
                if (future.isSuccess() && state == ConnectionState.CONNECTING && future.channel().isActive()) {
                    rc = BKException.Code.OK;
                    channel = future.channel();
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `channel` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
                if (future.isSuccess() && state == ConnectionState.CONNECTING && future.channel().isActive()) {
                    rc = BKException.Code.OK;
                    channel = future.channel();
                    if (shFactory != null) {
                        LOG.info("Successfully connected to bookie: {} {} initiate TLS", bookieId, future.channel());
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `state` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
                    } else {
                        LOG.info("Successfully connected to bookie: {} {}", bookieId, future.channel());
                        state = ConnectionState.CONNECTED;
                        activeNonTlsChannelCounter.inc();
                    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `state` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
                        activeNonTlsChannelCounter.inc();
                    }
                } else if (future.isSuccess() && state == ConnectionState.START_TLS) {
                    rc = BKException.Code.OK;
                    LOG.info("Successfully connected to bookie using TLS: " + bookieId);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `state` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
                    LOG.info("Successfully connected to bookie using TLS: " + bookieId);

                    state = ConnectionState.CONNECTED;
                    AuthHandler.ClientSideHandler authHandler = future.channel().pipeline()
                            .get(AuthHandler.ClientSideHandler.class);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `state` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
                    authHandler.authProvider.onProtocolUpgrade();
                    activeTlsChannelCounter.inc();
                } else if (future.isSuccess() && (state == ConnectionState.CLOSED
                    || state == ConnectionState.DISCONNECTED)) {
                    LOG.warn("Closed before connection completed, clean up: {}, current state {}",
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `state` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
                    activeTlsChannelCounter.inc();
                } else if (future.isSuccess() && (state == ConnectionState.CLOSED
                    || state == ConnectionState.DISCONNECTED)) {
                    LOG.warn("Closed before connection completed, clean up: {}, current state {}",
                            future.channel(), state);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `state` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
                    || state == ConnectionState.DISCONNECTED)) {
                    LOG.warn("Closed before connection completed, clean up: {}, current state {}",
                            future.channel(), state);
                    closeChannel(future.channel());
                    rc = BKException.Code.BookieHandleNotAvailableException;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `channel` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
                    closeChannel(future.channel());
                    rc = BKException.Code.BookieHandleNotAvailableException;
                    channel = null;
                } else if (future.isSuccess() && state == ConnectionState.CONNECTED) {
                    if (LOG.isDebugEnabled()) {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `state` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
                    rc = BKException.Code.BookieHandleNotAvailableException;
                    channel = null;
                } else if (future.isSuccess() && state == ConnectionState.CONNECTED) {
                    if (LOG.isDebugEnabled()) {
                        LOG.debug("Already connected with another channel({}), so close the new channel({})", channel,
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `channel` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
                } else if (future.isSuccess() && state == ConnectionState.CONNECTED) {
                    if (LOG.isDebugEnabled()) {
                        LOG.debug("Already connected with another channel({}), so close the new channel({})", channel,
                                future.channel());
                    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `channel` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
                        closeChannel(failedChannel);
                    }
                    channel = null;
                    if (state != ConnectionState.CLOSED) {
                        state = ConnectionState.DISCONNECTED;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `state` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
                    }
                    channel = null;
                    if (state != ConnectionState.CLOSED) {
                        state = ConnectionState.DISCONNECTED;
                    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `state` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
                    channel = null;
                    if (state != ConnectionState.CLOSED) {
                        state = ConnectionState.DISCONNECTED;
                    }
                    failedConnectionCounter.inc();
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `channel` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
            synchronized (this) {
                // check the channel status again under lock
                if (channel != null && state == ConnectionState.CONNECTED) {
                    completeOpNow = true;
                    opRc = BKException.Code.OK;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `state` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
            synchronized (this) {
                // check the channel status again under lock
                if (channel != null && state == ConnectionState.CONNECTED) {
                    completeOpNow = true;
                    opRc = BKException.Code.OK;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `state` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
                    completeOpNow = true;
                    opRc = BKException.Code.OK;
                } else if (state == ConnectionState.CLOSED) {
                    completeOpNow = true;
                    opRc = BKException.Code.BookieHandleNotAvailableException;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `state` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
                    pendingOps.add(op);

                    if (state == ConnectionState.CONNECTING
                        || state == ConnectionState.START_TLS) {
                        // the connection request has already been sent and it is waiting for the response.
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `state` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java

                    if (state == ConnectionState.CONNECTING
                        || state == ConnectionState.START_TLS) {
                        // the connection request has already been sent and it is waiting for the response.
                        return;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `state` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
                    }
                    // switch state to connecting and do connection attempt
                    state = ConnectionState.CONNECTING;
                }
            }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `state` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java

        synchronized (this) {
            if (state == ConnectionState.CLOSED) {
                if (LOG.isDebugEnabled()) {
                    LOG.debug("Unexpected exception caught by bookie client channel handler, "
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.channel` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java

        synchronized (this) {
            if (this.channel == ctx.channel()
                && state != ConnectionState.CLOSED) {
                state = ConnectionState.DISCONNECTED;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `state` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
        synchronized (this) {
            if (this.channel == ctx.channel()
                && state != ConnectionState.CLOSED) {
                state = ConnectionState.DISCONNECTED;
            }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `state` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
            if (this.channel == ctx.channel()
                && state != ConnectionState.CLOSED) {
                state = ConnectionState.DISCONNECTED;
            }
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `state` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java

                    synchronized (PerChannelBookieClient.this) {
                        if (future.isSuccess() && state == ConnectionState.CONNECTING) {
                            LOG.error("Connection state changed before TLS handshake completed {}/{}", bookieId, state);
                            rc = BKException.Code.BookieHandleNotAvailableException;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `state` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
                    synchronized (PerChannelBookieClient.this) {
                        if (future.isSuccess() && state == ConnectionState.CONNECTING) {
                            LOG.error("Connection state changed before TLS handshake completed {}/{}", bookieId, state);
                            rc = BKException.Code.BookieHandleNotAvailableException;
                            closeChannel(channel);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `channel` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
                            LOG.error("Connection state changed before TLS handshake completed {}/{}", bookieId, state);
                            rc = BKException.Code.BookieHandleNotAvailableException;
                            closeChannel(channel);
                            channel = null;
                            if (state != ConnectionState.CLOSED) {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `channel` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
                            rc = BKException.Code.BookieHandleNotAvailableException;
                            closeChannel(channel);
                            channel = null;
                            if (state != ConnectionState.CLOSED) {
                                state = ConnectionState.DISCONNECTED;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `state` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
                            closeChannel(channel);
                            channel = null;
                            if (state != ConnectionState.CLOSED) {
                                state = ConnectionState.DISCONNECTED;
                            }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `state` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
                            channel = null;
                            if (state != ConnectionState.CLOSED) {
                                state = ConnectionState.DISCONNECTED;
                            }
                        } else if (future.isSuccess() && state == ConnectionState.START_TLS) {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `state` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
                                state = ConnectionState.DISCONNECTED;
                            }
                        } else if (future.isSuccess() && state == ConnectionState.START_TLS) {
                            rc = BKException.Code.OK;
                            LOG.info("Successfully connected to bookie using TLS: " + bookieId);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `state` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
                            LOG.info("Successfully connected to bookie using TLS: " + bookieId);

                            state = ConnectionState.CONNECTED;
                            AuthHandler.ClientSideHandler authHandler = future.get().pipeline()
                                    .get(AuthHandler.ClientSideHandler.class);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `state` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
                            activeTlsChannelCounter.inc();
                        } else if (future.isSuccess()
                                && (state == ConnectionState.CLOSED || state == ConnectionState.DISCONNECTED)) {
                            LOG.warn("Closed before TLS handshake completed, clean up: {}, current state {}",
                                    channel, state);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `state` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
                            activeTlsChannelCounter.inc();
                        } else if (future.isSuccess()
                                && (state == ConnectionState.CLOSED || state == ConnectionState.DISCONNECTED)) {
                            LOG.warn("Closed before TLS handshake completed, clean up: {}, current state {}",
                                    channel, state);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `channel` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
                                && (state == ConnectionState.CLOSED || state == ConnectionState.DISCONNECTED)) {
                            LOG.warn("Closed before TLS handshake completed, clean up: {}, current state {}",
                                    channel, state);
                            closeChannel(channel);
                            rc = BKException.Code.BookieHandleNotAvailableException;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `state` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
                                && (state == ConnectionState.CLOSED || state == ConnectionState.DISCONNECTED)) {
                            LOG.warn("Closed before TLS handshake completed, clean up: {}, current state {}",
                                    channel, state);
                            closeChannel(channel);
                            rc = BKException.Code.BookieHandleNotAvailableException;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `channel` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
                            LOG.warn("Closed before TLS handshake completed, clean up: {}, current state {}",
                                    channel, state);
                            closeChannel(channel);
                            rc = BKException.Code.BookieHandleNotAvailableException;
                            channel = null;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `channel` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
                            closeChannel(channel);
                            rc = BKException.Code.BookieHandleNotAvailableException;
                            channel = null;
                        } else if (future.isSuccess() && state == ConnectionState.CONNECTED) {
                            if (LOG.isDebugEnabled()) {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `state` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
                            rc = BKException.Code.BookieHandleNotAvailableException;
                            channel = null;
                        } else if (future.isSuccess() && state == ConnectionState.CONNECTED) {
                            if (LOG.isDebugEnabled()) {
                                LOG.debug("Already connected with another channel({}), "
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `channel` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
                                LOG.debug("Already connected with another channel({}), "
                                                + "so close the new channel({})",
                                        channel, channel);
                            }
                            closeChannel(channel);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `channel` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
                                LOG.debug("Already connected with another channel({}), "
                                                + "so close the new channel({})",
                                        channel, channel);
                            }
                            closeChannel(channel);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `channel` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
                                        channel, channel);
                            }
                            closeChannel(channel);
                            return; // pendingOps should have been completed when other channel connected
                        } else {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `channel` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
                        } else {
                            LOG.error("TLS handshake failed with bookie: {}/{}, current state {} : ",
                                    channel, bookieId, state, future.cause());
                            rc = BKException.Code.SecurityException;
                            closeChannel(channel);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `state` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
                        } else {
                            LOG.error("TLS handshake failed with bookie: {}/{}, current state {} : ",
                                    channel, bookieId, state, future.cause());
                            rc = BKException.Code.SecurityException;
                            closeChannel(channel);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `channel` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
                                    channel, bookieId, state, future.cause());
                            rc = BKException.Code.SecurityException;
                            closeChannel(channel);
                            channel = null;
                            if (state != ConnectionState.CLOSED) {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `channel` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
                            rc = BKException.Code.SecurityException;
                            closeChannel(channel);
                            channel = null;
                            if (state != ConnectionState.CLOSED) {
                                state = ConnectionState.DISCONNECTED;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `state` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
                            closeChannel(channel);
                            channel = null;
                            if (state != ConnectionState.CLOSED) {
                                state = ConnectionState.DISCONNECTED;
                            }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `state` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
                            channel = null;
                            if (state != ConnectionState.CLOSED) {
                                state = ConnectionState.DISCONNECTED;
                            }
                            failedTlsHandshakeCounter.inc();
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `state` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
        synchronized (this) {
            if (permanent) {
                state = ConnectionState.CLOSED;
            } else if (state != ConnectionState.CLOSED) {
                state = ConnectionState.DISCONNECTED;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `state` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
            if (permanent) {
                state = ConnectionState.CLOSED;
            } else if (state != ConnectionState.CLOSED) {
                state = ConnectionState.DISCONNECTED;
            }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `state` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
                state = ConnectionState.CLOSED;
            } else if (state != ConnectionState.CLOSED) {
                state = ConnectionState.DISCONNECTED;
            }
            toClose = channel;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `channel` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
                state = ConnectionState.DISCONNECTED;
            }
            toClose = channel;
            channel = null;
            makeWritable();
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `channel` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
            }
            toClose = channel;
            channel = null;
            makeWritable();
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.running` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/GarbageCollectorThread.java`
#### Snippet
```java
    @SuppressFBWarnings("SWL_SLEEP_WITH_LOCK_HELD")
    public synchronized void shutdown() throws InterruptedException {
        if (!this.running) {
            return;
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.running` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/GarbageCollectorThread.java`
#### Snippet
```java
        }

        this.running = false;
        // Interrupt GC executor thread
        gcExecutor.shutdownNow();
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `rotatedLogChannels` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryLogManagerForSingleEntryLog.java`
#### Snippet
```java
        activeLogChannel = logChannel;
        if (hasToRotateLogChannel != null) {
            rotatedLogChannels.add(hasToRotateLogChannel);
        }
    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `rotatedLogChannels` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryLogManagerForSingleEntryLog.java`
#### Snippet
```java
        List<BufferedLogChannel> channels = null;
        synchronized (this) {
            channels = rotatedLogChannels;
            rotatedLogChannels = new LinkedList<BufferedLogChannel>();
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `rotatedLogChannels` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryLogManagerForSingleEntryLog.java`
#### Snippet
```java
        synchronized (this) {
            channels = rotatedLogChannels;
            rotatedLogChannels = new LinkedList<BufferedLogChannel>();
        }
        if (null == channels) {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `rotatedLogChannels` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryLogManagerForSingleEntryLog.java`
#### Snippet
```java
                // rescue from flush exception, add unflushed channels back
                synchronized (this) {
                    if (null == rotatedLogChannels) {
                        rotatedLogChannels = channels;
                    } else {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `rotatedLogChannels` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryLogManagerForSingleEntryLog.java`
#### Snippet
```java
                synchronized (this) {
                    if (null == rotatedLogChannels) {
                        rotatedLogChannels = channels;
                    } else {
                        rotatedLogChannels.addAll(0, channels);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `rotatedLogChannels` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryLogManagerForSingleEntryLog.java`
#### Snippet
```java
                        rotatedLogChannels = channels;
                    } else {
                        rotatedLogChannels.addAll(0, channels);
                    }
                }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `invocationCount` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BufferedReadChannel.java`
#### Snippet
```java

    public synchronized int read(ByteBuf dest, long pos, int length) throws IOException {
        invocationCount++;
        long currentPosition = pos;
        long eof = validateAndGetFileChannel().size();
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `readBufferStartPosition` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BufferedReadChannel.java`
#### Snippet
```java
        while (length > 0) {
            // Check if the data is in the buffer, if so, copy it.
            if (readBufferStartPosition <= currentPosition
                    && currentPosition < readBufferStartPosition + readBuffer.readableBytes()) {
                int posInBuffer = (int) (currentPosition - readBufferStartPosition);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `readBufferStartPosition` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BufferedReadChannel.java`
#### Snippet
```java
            // Check if the data is in the buffer, if so, copy it.
            if (readBufferStartPosition <= currentPosition
                    && currentPosition < readBufferStartPosition + readBuffer.readableBytes()) {
                int posInBuffer = (int) (currentPosition - readBufferStartPosition);
                int bytesToCopy = Math.min(length, readBuffer.readableBytes() - posInBuffer);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `readBufferStartPosition` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BufferedReadChannel.java`
#### Snippet
```java
            if (readBufferStartPosition <= currentPosition
                    && currentPosition < readBufferStartPosition + readBuffer.readableBytes()) {
                int posInBuffer = (int) (currentPosition - readBufferStartPosition);
                int bytesToCopy = Math.min(length, readBuffer.readableBytes() - posInBuffer);
                dest.writeBytes(readBuffer, posInBuffer, bytesToCopy);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `cacheHitCount` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BufferedReadChannel.java`
#### Snippet
```java
                currentPosition += bytesToCopy;
                length -= bytesToCopy;
                cacheHitCount++;
            } else if (currentPosition >= eof) {
                // here we reached eof.
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `readBufferStartPosition` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BufferedReadChannel.java`
#### Snippet
```java
            } else {
                // We don't have it in the buffer, so put necessary data in the buffer
                readBufferStartPosition = currentPosition;
                int readBytes = 0;
                if ((readBytes = validateAndGetFileChannel().read(readBuffer.internalNioBuffer(0, readCapacity),
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `preallocation` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryLoggerAllocator.java`
#### Snippet
```java

    private synchronized void closePreAllocateLog() {
        if (preallocation != null) {
            // if preallocate new log success, release the file channel
            try {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `preallocation` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryLoggerAllocator.java`
#### Snippet
```java
            } else {
                // allocate directly to response request
                if (null == preallocation){
                    bc = allocateNewLog(dirForNextEntryLog);
                } else {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `preallocation` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryLoggerAllocator.java`
#### Snippet
```java
                    // has a preallocated entry log
                    try {
                        bc = preallocation.get();
                    } catch (ExecutionException ee) {
                        if (ee.getCause() instanceof IOException) {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `preallocation` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryLoggerAllocator.java`
#### Snippet
```java
                }
                // preallocate a new log in background upon every call
                preallocation = allocatorExecutor.submit(() -> allocateNewLog(dirForNextEntryLog));
                return bc;
            }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `allocatorExecutor` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryLoggerAllocator.java`
#### Snippet
```java
                }
                // preallocate a new log in background upon every call
                preallocation = allocatorExecutor.submit(() -> allocateNewLog(dirForNextEntryLog));
                return bc;
            }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `running` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Journal.java`
#### Snippet
```java
    public synchronized void shutdown() {
        try {
            if (!running) {
                return;
            }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `running` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Journal.java`
#### Snippet
```java
            forceWriteThread.shutdown();

            running = false;
            this.interrupt();
            this.join();
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `position` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BufferedChannel.java`
#### Snippet
```java
                }
            }
            position += copied;
            if (doRegularFlushes) {
                unpersistedBytes.addAndGet(copied);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `writeBufferStartPosition` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BufferedChannel.java`
#### Snippet
```java
        } while (toWrite.hasRemaining());
        writeBuffer.clear();
        writeBufferStartPosition.set(fileChannel.position());
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `writeBufferStartPosition` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BufferedChannel.java`
#### Snippet
```java
        while (length > 0) {
            // check if it is in the write buffer
            if (writeBuffer != null && writeBufferStartPosition.get() <= pos) {
                int positionInBuffer = (int) (pos - writeBufferStartPosition.get());
                int bytesToCopy = Math.min(writeBuffer.writerIndex() - positionInBuffer, dest.writableBytes());
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `writeBufferStartPosition` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BufferedChannel.java`
#### Snippet
```java
            // check if it is in the write buffer
            if (writeBuffer != null && writeBufferStartPosition.get() <= pos) {
                int positionInBuffer = (int) (pos - writeBufferStartPosition.get());
                int bytesToCopy = Math.min(writeBuffer.writerIndex() - positionInBuffer, dest.writableBytes());

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `writeBufferStartPosition` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BufferedChannel.java`
#### Snippet
```java
                pos += bytesToCopy;
                length -= bytesToCopy;
            } else if (writeBuffer == null && writeBufferStartPosition.get() <= pos) {
                // here we reach the end
                break;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `readBufferStartPosition` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BufferedChannel.java`
#### Snippet
```java
                break;
                // first check if there is anything we can grab from the readBuffer
            } else if (readBufferStartPosition <= pos && pos < readBufferStartPosition + readBuffer.writerIndex()) {
                int positionInBuffer = (int) (pos - readBufferStartPosition);
                int bytesToCopy = Math.min(readBuffer.writerIndex() - positionInBuffer, dest.writableBytes());
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `readBufferStartPosition` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BufferedChannel.java`
#### Snippet
```java
                break;
                // first check if there is anything we can grab from the readBuffer
            } else if (readBufferStartPosition <= pos && pos < readBufferStartPosition + readBuffer.writerIndex()) {
                int positionInBuffer = (int) (pos - readBufferStartPosition);
                int bytesToCopy = Math.min(readBuffer.writerIndex() - positionInBuffer, dest.writableBytes());
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `readBufferStartPosition` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BufferedChannel.java`
#### Snippet
```java
                // first check if there is anything we can grab from the readBuffer
            } else if (readBufferStartPosition <= pos && pos < readBufferStartPosition + readBuffer.writerIndex()) {
                int positionInBuffer = (int) (pos - readBufferStartPosition);
                int bytesToCopy = Math.min(readBuffer.writerIndex() - positionInBuffer, dest.writableBytes());
                dest.writeBytes(readBuffer, positionInBuffer, bytesToCopy);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `readBufferStartPosition` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BufferedChannel.java`
#### Snippet
```java
                // let's read it
            } else {
                readBufferStartPosition = pos;

                int readBytes = fileChannel.read(readBuffer.internalNioBuffer(0, readCapacity),
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `readBufferStartPosition` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BufferedChannel.java`
#### Snippet
```java

                int readBytes = fileChannel.read(readBuffer.internalNioBuffer(0, readCapacity),
                        readBufferStartPosition);
                if (readBytes <= 0) {
                    throw new IOException("Reading from filechannel returned a non-positive value. Short read.");
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `logFileId` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LogMark.java`
#### Snippet
```java

    public synchronized void writeLogMark(ByteBuffer bb) {
        bb.putLong(logFileId);
        bb.putLong(logFileOffset);
    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `logFileOffset` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LogMark.java`
#### Snippet
```java
    public synchronized void writeLogMark(ByteBuffer bb) {
        bb.putLong(logFileId);
        bb.putLong(logFileOffset);
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `logFileId` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LogMark.java`
#### Snippet
```java
        StringBuilder sb = new StringBuilder();

        sb.append("LogMark: logFileId - ").append(logFileId)
                .append(" , logFileOffset - ").append(logFileOffset);

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `logFileOffset` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LogMark.java`
#### Snippet
```java

        sb.append("LogMark: logFileId - ").append(logFileId)
                .append(" , logFileOffset - ").append(logFileOffset);

        return sb.toString();
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.logFileId` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LogMark.java`
#### Snippet
```java

    public synchronized int compare(LogMark other) {
        long ret = this.logFileId - other.getLogFileId();
        if (ret == 0) {
            ret = this.logFileOffset - other.getLogFileOffset();
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.logFileOffset` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LogMark.java`
#### Snippet
```java
        long ret = this.logFileId - other.getLogFileId();
        if (ret == 0) {
            ret = this.logFileOffset - other.getLogFileOffset();
        }
        return (ret < 0) ? -1 : ((ret > 0) ? 1 : 0);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `logFileOffset` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LogMark.java`
#### Snippet
```java

    public synchronized long getLogFileOffset() {
        return logFileOffset;
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.logFileId` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LogMark.java`
#### Snippet
```java

    public synchronized void setLogMark(long logFileId, long logFileOffset) {
        this.logFileId = logFileId;
        this.logFileOffset = logFileOffset;
    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.logFileOffset` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LogMark.java`
#### Snippet
```java
    public synchronized void setLogMark(long logFileId, long logFileOffset) {
        this.logFileId = logFileId;
        this.logFileOffset = logFileOffset;
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `logFileId` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LogMark.java`
#### Snippet
```java

    public synchronized long getLogFileId() {
        return logFileId;
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `logFileId` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LogMark.java`
#### Snippet
```java

    public synchronized void readLogMark(ByteBuffer bb) {
        logFileId = bb.getLong();
        logFileOffset = bb.getLong();
    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `logFileOffset` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LogMark.java`
#### Snippet
```java
    public synchronized void readLogMark(ByteBuffer bb) {
        logFileId = bb.getLong();
        logFileOffset = bb.getLong();
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `addDelay` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/SlowBufferedChannel.java`
#### Snippet
```java
    @Override
    public synchronized void write(ByteBuf src) throws IOException {
        delayMs(addDelay);
        super.write(src);
    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `getDelay` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/SlowBufferedChannel.java`
#### Snippet
```java
    @Override
    public synchronized int read(ByteBuf dest, long pos) throws IOException {
        delayMs(getDelay);
        return super.read(dest, pos);
    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.snapshot` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryMemTableWithParallelFlusher.java`
#### Snippet
```java
        if (this.snapshot.compareTo(checkpoint) < 0) {
            synchronized (this) {
                EntrySkipList keyValues = this.snapshot;

                Phaser pendingNumOfLedgerFlushes = new Phaser(1);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `mode` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/FileInfo.java`
#### Snippet
```java
            }

            fc = new RandomAccessFile(lf, mode).getChannel();
            size = fc.size();
            sizeSinceLastWrite = size;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.headerVersion` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/FileInfo.java`
#### Snippet
```java
                throw new IOException("Incompatible ledger version " + version + " while reading header for " + lf);
            }
            this.headerVersion = version;

            int length = bb.getInt();
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `masterKey` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/FileInfo.java`
#### Snippet
```java
                throw new BufferUnderflowException();
            }
            masterKey = new byte[length];
            bb.get(masterKey);
            stateBits = bb.getInt();
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `masterKey` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/FileInfo.java`
#### Snippet
```java
            }
            masterKey = new byte[length];
            bb.get(masterKey);
            stateBits = bb.getInt();

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.headerVersion` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/FileInfo.java`
#### Snippet
```java
            stateBits = bb.getInt();

            if (this.headerVersion >= V1) {
                int explicitLacBufLength = bb.getInt();
                if (explicitLacBufLength == 0) {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `masterKey` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/FileInfo.java`
#### Snippet
```java
    public synchronized byte[] getMasterKey() throws IOException {
        checkOpen(false);
        return masterKey;
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `mode` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/FileInfo.java`
#### Snippet
```java
            throw new IOException("Failed to rename " + rlocFile + " to " + newFile);
        }
        fc = new RandomAccessFile(newFile, mode).getChannel();
        lf = newFile;
        deleted = false;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `masterKey` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/FileInfo.java`
#### Snippet
```java
        }
        boolean exists = lf.exists();
        if (masterKey == null && !exists) {
            throw new IOException(lf + " not found");
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `mode` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/FileInfo.java`
#### Snippet
```java
                // delayed the creation of parents directories
                checkParents(lf);
                fc = new RandomAccessFile(lf, mode).getChannel();
                size = fc.size();
                if (size == 0) {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `masterKey` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/FileInfo.java`
#### Snippet
```java
            } catch (BufferUnderflowException buf) {
                LOG.warn("Exception when reading header of {}.", lf, buf);
                if (null != masterKey) {
                    LOG.warn("Attempting to write header of {} again.", lf);
                    writeHeader();
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.snapshot` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryMemTable.java`
#### Snippet
```java
            long ledger, ledgerGC = -1;
            synchronized (this) {
                EntrySkipList keyValues = this.snapshot;
                if (keyValues.compareTo(checkpoint) < 0) {
                    for (EntryKey key : keyValues.keySet()) {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `entryLogger` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieShell.java`
#### Snippet
```java

    private synchronized void initEntryLogger() throws IOException {
        if (null == entryLogger) {
            // provide read only entry logger
            entryLogger = new ReadOnlyDefaultEntryLogger(bkConf);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `entryLogger` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieShell.java`
#### Snippet
```java
        if (null == entryLogger) {
            // provide read only entry logger
            entryLogger = new ReadOnlyDefaultEntryLogger(bkConf);
        }
    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `dirsMonitor` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieImpl.java`
#### Snippet
```java
        }
        //Start DiskChecker thread
        dirsMonitor.start();

        // replay journals
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `stateManager` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieImpl.java`
#### Snippet
```java
        // since bookie server use running as a flag to tell bookie server whether it is alive
        // if setting it in bookie thread, the watcher might run before bookie thread.
        stateManager.initState();

        try {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `stateManager` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieImpl.java`
#### Snippet
```java

        try {
            stateManager.registerBookie(true).get();
        } catch (Exception e) {
            LOG.error("Couldn't register bookie with zookeeper, shutting down : ", e);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `nativeBuffer` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectWriter.java`
#### Snippet
```java
    public void position(long offset) throws IOException {
        synchronized (bufferLock) {
            if (nativeBuffer != null && nativeBuffer.position() > 0) {
                flushBuffer();
            }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `nativeBuffer` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectWriter.java`
#### Snippet
```java
    public void position(long offset) throws IOException {
        synchronized (bufferLock) {
            if (nativeBuffer != null && nativeBuffer.position() > 0) {
                flushBuffer();
            }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.offset` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectWriter.java`
#### Snippet
```java
                                      .toString());
            }
            this.offset = offset;
        }
    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.offset` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectWriter.java`
#### Snippet
```java
    public long position() {
        synchronized (bufferLock) {
            return this.offset + (nativeBuffer != null ? nativeBuffer.position() : 0);
        }
    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `nativeBuffer` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectWriter.java`
#### Snippet
```java
    public long position() {
        synchronized (bufferLock) {
            return this.offset + (nativeBuffer != null ? nativeBuffer.position() : 0);
        }
    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `nativeBuffer` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectWriter.java`
#### Snippet
```java
    public long position() {
        synchronized (bufferLock) {
            return this.offset + (nativeBuffer != null ? nativeBuffer.position() : 0);
        }
    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `nativeBuffer` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectWriter.java`
#### Snippet
```java
    public int writeDelimited(ByteBuf buf) throws IOException {
        synchronized (bufferLock) {
            if (!nativeBuffer.hasSpace(serializedSize(buf))) {
                flushBuffer();
            }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `nativeBuffer` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectWriter.java`
#### Snippet
```java
                                      .toString());
            }
            nativeBuffer.writeInt(readable);
            nativeBuffer.writeByteBuf(buf);
            return (int) bufferPosition;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `nativeBuffer` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectWriter.java`
#### Snippet
```java
            }
            nativeBuffer.writeInt(readable);
            nativeBuffer.writeByteBuf(buf);
            return (int) bufferPosition;
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.nativeBuffer` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectWriter.java`
#### Snippet
```java
    private void flushBuffer() throws IOException {
        synchronized (bufferLock) {
            if (this.nativeBuffer != null) {
                int bytesToWrite = this.nativeBuffer.padToAlignment();
                if (bytesToWrite == 0) {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.nativeBuffer` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectWriter.java`
#### Snippet
```java
        synchronized (bufferLock) {
            if (this.nativeBuffer != null) {
                int bytesToWrite = this.nativeBuffer.padToAlignment();
                if (bytesToWrite == 0) {
                    return;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.nativeBuffer` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectWriter.java`
#### Snippet
```java
                }

                Buffer bufferToFlush = this.nativeBuffer;
                this.nativeBuffer = null;

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.nativeBuffer` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectWriter.java`
#### Snippet
```java

                Buffer bufferToFlush = this.nativeBuffer;
                this.nativeBuffer = null;

                long offsetToWrite = offset;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `offset` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectWriter.java`
#### Snippet
```java
                this.nativeBuffer = null;

                long offsetToWrite = offset;
                offset += bytesToWrite;

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `offset` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectWriter.java`
#### Snippet
```java

                long offsetToWrite = offset;
                offset += bytesToWrite;

                Future<?> f = writeExecutor.submit(() -> {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.nativeBuffer` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectWriter.java`
#### Snippet
```java
                // otherwise it could try to acquire a buffer without kicking off
                // a subroutine that will free another
                this.nativeBuffer = bufferPool.acquire();
            }
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `nativeBuffer` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectWriter.java`
#### Snippet
```java
    public void close() throws IOException {
        synchronized (bufferLock) {
            if (nativeBuffer != null && nativeBuffer.position() > 0) {
                flush();
            }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `nativeBuffer` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectWriter.java`
#### Snippet
```java
    public void close() throws IOException {
        synchronized (bufferLock) {
            if (nativeBuffer != null && nativeBuffer.position() > 0) {
                flush();
            }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `nativeBuffer` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectWriter.java`
#### Snippet
```java
        }
        synchronized (bufferLock) {
            bufferPool.release(nativeBuffer);
            nativeBuffer = null;
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `nativeBuffer` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectWriter.java`
#### Snippet
```java
        synchronized (bufferLock) {
            bufferPool.release(nativeBuffer);
            nativeBuffer = null;
        }
    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `i` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/SyncCounter.java`
#### Snippet
```java

    synchronized void block(int limit) throws InterruptedException {
        while (i > limit) {
            int prev = i;
            wait();
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `i` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/SyncCounter.java`
#### Snippet
```java
    synchronized void block(int limit) throws InterruptedException {
        while (i > limit) {
            int prev = i;
            wait();
            if (i == prev) {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `i` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/SyncCounter.java`
#### Snippet
```java
            int prev = i;
            wait();
            if (i == prev) {
                break;
            }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `i` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/SyncCounter.java`
#### Snippet
```java

    synchronized void inc() {
        i++;
        total++;
    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `total` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/SyncCounter.java`
#### Snippet
```java
    synchronized void inc() {
        i++;
        total++;
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `total` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/SyncCounter.java`
#### Snippet
```java

    synchronized int total() {
        return total;
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `i` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/SyncCounter.java`
#### Snippet
```java

    synchronized void dec() {
        i--;
        notifyAll();
    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `finished` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/MSLedgerManagerFactory.java`
#### Snippet
```java
        public synchronized void block() {
            try {
                while (!finished) {
                    wait();
                }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.rc` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/MSLedgerManagerFactory.java`
#### Snippet
```java

        public synchronized void complete(int rc, T value) {
            this.rc = rc;
            this.value = value;
            finished = true;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.value` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/MSLedgerManagerFactory.java`
#### Snippet
```java
        public synchronized void complete(int rc, T value) {
            this.rc = rc;
            this.value = value;
            finished = true;

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `finished` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/MSLedgerManagerFactory.java`
#### Snippet
```java
            this.rc = rc;
            this.value = value;
            finished = true;

            notify();
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `value` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/MSLedgerManagerFactory.java`
#### Snippet
```java

        public synchronized T getResult() {
            return value;
        }
    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `rc` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/MSLedgerManagerFactory.java`
#### Snippet
```java

        public synchronized int getRetCode() {
            return rc;
        }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `pendingAddOps` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandleAdv.java`
#### Snippet
```java
                long currentLength = addToLength(op.payload.readableBytes());
                op.setLedgerLength(currentLength);
                pendingAddOps.add(op);
            } else {
                wasClosed = true;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `numPendings` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java`
#### Snippet
```java
            // if received all responses or this entry doesn't meet quorum write, complete the request.

            --numPendings;
            if (isRecoveryRead && numBookiesMissingEntry >= requiredBookiesMissingEntryForRecovery) {
                /* For recovery, report NoSuchEntry as soon as wQ-aQ+1 bookies report that they do not
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `numBookiesMissingEntry` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java`
#### Snippet
```java

            --numPendings;
            if (isRecoveryRead && numBookiesMissingEntry >= requiredBookiesMissingEntryForRecovery) {
                /* For recovery, report NoSuchEntry as soon as wQ-aQ+1 bookies report that they do not
                 * have the entry */
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `numPendings` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java`
#### Snippet
```java
                 * have the entry */
                fail(BKException.Code.NoSuchEntryException);
            } else if (numPendings == 0) {
                // if received all responses, complete the request.
                fail(firstError);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `firstError` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java`
#### Snippet
```java
            } else if (numPendings == 0) {
                // if received all responses, complete the request.
                fail(firstError);
            }
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `nextReplicaIndexToReadFrom` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java`
#### Snippet
```java

        private synchronized int getNextReplicaIndexToReadFrom() {
            return nextReplicaIndexToReadFrom;
        }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `firstError` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java`
#### Snippet
```java
         */
        synchronized void logErrorAndReattemptRead(int bookieIndex, BookieId host, String errMsg, int rc) {
            if (BKException.Code.OK == firstError
                || BKException.Code.NoSuchEntryException == firstError
                || BKException.Code.NoSuchLedgerExistsException == firstError) {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `firstError` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java`
#### Snippet
```java
        synchronized void logErrorAndReattemptRead(int bookieIndex, BookieId host, String errMsg, int rc) {
            if (BKException.Code.OK == firstError
                || BKException.Code.NoSuchEntryException == firstError
                || BKException.Code.NoSuchLedgerExistsException == firstError) {
                firstError = rc;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `firstError` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java`
#### Snippet
```java
            if (BKException.Code.OK == firstError
                || BKException.Code.NoSuchEntryException == firstError
                || BKException.Code.NoSuchLedgerExistsException == firstError) {
                firstError = rc;
            } else if (BKException.Code.BookieHandleNotAvailableException == firstError
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `firstError` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java`
#### Snippet
```java
                || BKException.Code.NoSuchEntryException == firstError
                || BKException.Code.NoSuchLedgerExistsException == firstError) {
                firstError = rc;
            } else if (BKException.Code.BookieHandleNotAvailableException == firstError
                       && BKException.Code.NoSuchEntryException != rc
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `firstError` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java`
#### Snippet
```java
                || BKException.Code.NoSuchLedgerExistsException == firstError) {
                firstError = rc;
            } else if (BKException.Code.BookieHandleNotAvailableException == firstError
                       && BKException.Code.NoSuchEntryException != rc
                       && BKException.Code.NoSuchLedgerExistsException != rc) {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `firstError` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java`
#### Snippet
```java
                // returned we need to update firstError to indicate that it might be a valid read but just
                // failed.
                firstError = rc;
            }
            if (BKException.Code.NoSuchEntryException == rc
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `numBookiesMissingEntry` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java`
#### Snippet
```java
            if (BKException.Code.NoSuchEntryException == rc
                || BKException.Code.NoSuchLedgerExistsException == rc) {
                ++numBookiesMissingEntry;
                if (LOG.isDebugEnabled()) {
                    LOG.debug("No such entry found on bookie.  L{} E{} bookie: {}",
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lh` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java`
#### Snippet
```java
                if (LOG.isDebugEnabled()) {
                    LOG.debug("No such entry found on bookie.  L{} E{} bookie: {}",
                            lh.ledgerId, eId, host);
                }
            } else {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lh` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java`
#### Snippet
```java
                if (LOG.isInfoEnabled()) {
                    LOG.info("{} while reading L{} E{} from bookie: {}",
                            errMsg, lh.ledgerId, eId, host);
                }
            }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lh` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java`
#### Snippet
```java
            }

            lh.recordReadErrorOnBookie(bookieIndex);
        }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `nextReplicaIndexToReadFrom` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java`
#### Snippet
```java

        synchronized BookieId sendNextRead() {
            if (nextReplicaIndexToReadFrom >= getLedgerMetadata().getWriteQuorumSize()) {
                // we are done, the read has failed from all replicas, just fail the
                // read
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `firstError` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java`
#### Snippet
```java
                // we are done, the read has failed from all replicas, just fail the
                // read
                fail(firstError);
                return null;
            }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `nextReplicaIndexToReadFrom` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java`
#### Snippet
```java
            // ToDo: pick replica with writable PCBC. ISSUE #1239
            // https://github.com/apache/bookkeeper/issues/1239
            int replica = nextReplicaIndexToReadFrom;
            int bookieIndex = writeSet.get(nextReplicaIndexToReadFrom);
            nextReplicaIndexToReadFrom++;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `nextReplicaIndexToReadFrom` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java`
#### Snippet
```java
            // https://github.com/apache/bookkeeper/issues/1239
            int replica = nextReplicaIndexToReadFrom;
            int bookieIndex = writeSet.get(nextReplicaIndexToReadFrom);
            nextReplicaIndexToReadFrom++;

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `nextReplicaIndexToReadFrom` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java`
#### Snippet
```java
            int replica = nextReplicaIndexToReadFrom;
            int bookieIndex = writeSet.get(nextReplicaIndexToReadFrom);
            nextReplicaIndexToReadFrom++;

            try {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `numBookiesMissingEntry` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java`
#### Snippet
```java
            erroredReplicas.set(replica);

            if (isRecoveryRead && (numBookiesMissingEntry >= requiredBookiesMissingEntryForRecovery)) {
                /* For recovery, report NoSuchEntry as soon as wQ-aQ+1 bookies report that they do not
                 * have the entry */
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `nextReplicaIndexToReadFrom` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java`
#### Snippet
```java
        @Override
        synchronized BookieId maybeSendSpeculativeRead(BitSet heardFrom) {
            if (nextReplicaIndexToReadFrom >= getLedgerMetadata().getWriteQuorumSize()) {
                return null;
            }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `nextReplicaIndexToReadFrom` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadLastConfirmedAndEntryOp.java`
#### Snippet
```java
        @Override
        synchronized BookieId maybeSendSpeculativeRead(BitSet heardFrom) {
            if (nextReplicaIndexToReadFrom >= getLedgerMetadata().getEnsembleSize()) {
                return null;
            }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `firstError` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadLastConfirmedAndEntryOp.java`
#### Snippet
```java

        private synchronized void translateAndSetFirstError(int rc) {
            if (BKException.Code.OK == firstError
                || BKException.Code.NoSuchEntryException == firstError
                || BKException.Code.NoSuchLedgerExistsException == firstError) {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `firstError` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadLastConfirmedAndEntryOp.java`
#### Snippet
```java
        private synchronized void translateAndSetFirstError(int rc) {
            if (BKException.Code.OK == firstError
                || BKException.Code.NoSuchEntryException == firstError
                || BKException.Code.NoSuchLedgerExistsException == firstError) {
                firstError = rc;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `firstError` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadLastConfirmedAndEntryOp.java`
#### Snippet
```java
            if (BKException.Code.OK == firstError
                || BKException.Code.NoSuchEntryException == firstError
                || BKException.Code.NoSuchLedgerExistsException == firstError) {
                firstError = rc;
            } else if (BKException.Code.BookieHandleNotAvailableException == firstError
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `firstError` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadLastConfirmedAndEntryOp.java`
#### Snippet
```java
                || BKException.Code.NoSuchEntryException == firstError
                || BKException.Code.NoSuchLedgerExistsException == firstError) {
                firstError = rc;
            } else if (BKException.Code.BookieHandleNotAvailableException == firstError
                && BKException.Code.NoSuchEntryException != rc
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `firstError` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadLastConfirmedAndEntryOp.java`
#### Snippet
```java
                || BKException.Code.NoSuchLedgerExistsException == firstError) {
                firstError = rc;
            } else if (BKException.Code.BookieHandleNotAvailableException == firstError
                && BKException.Code.NoSuchEntryException != rc
                && BKException.Code.NoSuchLedgerExistsException != rc) {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `firstError` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadLastConfirmedAndEntryOp.java`
#### Snippet
```java
                // if other exception rather than NoSuchEntryException is returned
                // we need to update firstError to indicate that it might be a valid read but just failed.
                firstError = rc;
            }
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `numMissedEntryReads` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadLastConfirmedAndEntryOp.java`
#### Snippet
```java
                    lh.registerOperationFailureOnBookie(host, entryImpl.getEntryId());
                }
                ++numMissedEntryReads;
            }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `numPendings` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadLastConfirmedAndEntryOp.java`
#### Snippet
```java
        synchronized void logErrorAndReattemptRead(int bookieIndex, BookieId host, String errMsg, int rc) {
            super.logErrorAndReattemptRead(bookieIndex, host, errMsg, rc);
            --numPendings;
            // if received all responses or this entry doesn't meet quorum write, complete the request.
            if (numMissedEntryReads > maxMissedReadsAllowed || numPendings == 0) {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `numMissedEntryReads` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadLastConfirmedAndEntryOp.java`
#### Snippet
```java
            --numPendings;
            // if received all responses or this entry doesn't meet quorum write, complete the request.
            if (numMissedEntryReads > maxMissedReadsAllowed || numPendings == 0) {
                if (BKException.Code.BookieHandleNotAvailableException == firstError
                        && numMissedEntryReads > maxMissedReadsAllowed) {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `numPendings` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadLastConfirmedAndEntryOp.java`
#### Snippet
```java
            --numPendings;
            // if received all responses or this entry doesn't meet quorum write, complete the request.
            if (numMissedEntryReads > maxMissedReadsAllowed || numPendings == 0) {
                if (BKException.Code.BookieHandleNotAvailableException == firstError
                        && numMissedEntryReads > maxMissedReadsAllowed) {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `firstError` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadLastConfirmedAndEntryOp.java`
#### Snippet
```java
            // if received all responses or this entry doesn't meet quorum write, complete the request.
            if (numMissedEntryReads > maxMissedReadsAllowed || numPendings == 0) {
                if (BKException.Code.BookieHandleNotAvailableException == firstError
                        && numMissedEntryReads > maxMissedReadsAllowed) {
                    firstError = BKException.Code.NoSuchEntryException;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `numMissedEntryReads` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadLastConfirmedAndEntryOp.java`
#### Snippet
```java
            if (numMissedEntryReads > maxMissedReadsAllowed || numPendings == 0) {
                if (BKException.Code.BookieHandleNotAvailableException == firstError
                        && numMissedEntryReads > maxMissedReadsAllowed) {
                    firstError = BKException.Code.NoSuchEntryException;
                }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `firstError` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadLastConfirmedAndEntryOp.java`
#### Snippet
```java
                if (BKException.Code.BookieHandleNotAvailableException == firstError
                        && numMissedEntryReads > maxMissedReadsAllowed) {
                    firstError = BKException.Code.NoSuchEntryException;
                }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `firstError` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadLastConfirmedAndEntryOp.java`
#### Snippet
```java
                }

                fail(firstError);
            }
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `firstError` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadLastConfirmedAndEntryOp.java`
#### Snippet
```java

        synchronized int getFirstError() {
            return firstError;
        }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `nextReplicaIndexToReadFrom` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadLastConfirmedAndEntryOp.java`
#### Snippet
```java

        private synchronized int getNextReplicaIndexToReadFrom() {
            return nextReplicaIndexToReadFrom;
        }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `nextReplicaIndexToReadFrom` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadLastConfirmedAndEntryOp.java`
#### Snippet
```java

        synchronized BookieId sendNextRead() {
            if (nextReplicaIndexToReadFrom >= getLedgerMetadata().getEnsembleSize()) {
                // we are done, the read has failed from all replicas, just fail the
                // read
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `firstError` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadLastConfirmedAndEntryOp.java`
#### Snippet
```java
                // Do it a bit pessimistically, only when finished trying all replicas
                // to check whether we received more missed reads than requiredBookiesMissingEntryForRecovery
                if (BKException.Code.BookieHandleNotAvailableException == firstError
                        && numMissedEntryReads > maxMissedReadsAllowed) {
                    firstError = BKException.Code.NoSuchEntryException;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `numMissedEntryReads` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadLastConfirmedAndEntryOp.java`
#### Snippet
```java
                // to check whether we received more missed reads than requiredBookiesMissingEntryForRecovery
                if (BKException.Code.BookieHandleNotAvailableException == firstError
                        && numMissedEntryReads > maxMissedReadsAllowed) {
                    firstError = BKException.Code.NoSuchEntryException;
                }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `firstError` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadLastConfirmedAndEntryOp.java`
#### Snippet
```java
                if (BKException.Code.BookieHandleNotAvailableException == firstError
                        && numMissedEntryReads > maxMissedReadsAllowed) {
                    firstError = BKException.Code.NoSuchEntryException;
                }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `firstError` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadLastConfirmedAndEntryOp.java`
#### Snippet
```java
                }

                fail(firstError);
                return null;
            }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `nextReplicaIndexToReadFrom` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadLastConfirmedAndEntryOp.java`
#### Snippet
```java
            }

            int replica = nextReplicaIndexToReadFrom;
            int bookieIndex = orderedEnsemble.get(nextReplicaIndexToReadFrom);
            nextReplicaIndexToReadFrom++;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `nextReplicaIndexToReadFrom` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadLastConfirmedAndEntryOp.java`
#### Snippet
```java

            int replica = nextReplicaIndexToReadFrom;
            int bookieIndex = orderedEnsemble.get(nextReplicaIndexToReadFrom);
            nextReplicaIndexToReadFrom++;

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `nextReplicaIndexToReadFrom` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadLastConfirmedAndEntryOp.java`
#### Snippet
```java
            int replica = nextReplicaIndexToReadFrom;
            int bookieIndex = orderedEnsemble.get(nextReplicaIndexToReadFrom);
            nextReplicaIndexToReadFrom++;

            try {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lastAddConfirmed` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadOnlyLedgerHandle.java`
#### Snippet
```java
        long lac, len;
        synchronized (this) {
            lac = lastAddConfirmed;
            len = length;
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `length` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadOnlyLedgerHandle.java`
#### Snippet
```java
        synchronized (this) {
            lac = lastAddConfirmed;
            len = length;
        }
        LOG.info("Closing recovered ledger {} at entry {}", getId(), lac);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `startEntryToRead` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerRecoveryOp.java`
#### Snippet
```java
                                lh.length = data.getLength();
                                lh.pendingAddsSequenceHead = lh.lastAddConfirmed;
                                startEntryToRead = endEntryToRead = lh.lastAddConfirmed;
                            }
                            // keep a copy of ledger metadata before proceeding
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `endEntryToRead` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerRecoveryOp.java`
#### Snippet
```java
                                lh.length = data.getLength();
                                lh.pendingAddsSequenceHead = lh.lastAddConfirmed;
                                startEntryToRead = endEntryToRead = lh.lastAddConfirmed;
                            }
                            // keep a copy of ledger metadata before proceeding
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lastAddConfirmed` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java

    synchronized void updateLastConfirmed(long lac, long len) {
        if (lac > lastAddConfirmed) {
            lastAddConfirmed = lac;
            lacUpdateHitsCounter.inc();
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lastAddConfirmed` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
    synchronized void updateLastConfirmed(long lac, long len) {
        if (lac > lastAddConfirmed) {
            lastAddConfirmed = lac;
            lacUpdateHitsCounter.inc();
        } else {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lastAddPushed` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
            lacUpdateMissesCounter.inc();
        }
        lastAddPushed = Math.max(lastAddPushed, lac);
        length = Math.max(length, len);
    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lastAddPushed` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
            lacUpdateMissesCounter.inc();
        }
        lastAddPushed = Math.max(lastAddPushed, lac);
        length = Math.max(length, len);
    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `length` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
        }
        lastAddPushed = Math.max(lastAddPushed, lac);
        length = Math.max(length, len);
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `length` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
        }
        lastAddPushed = Math.max(lastAddPushed, lac);
        length = Math.max(length, len);
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lastAddConfirmed` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
                LedgerMetadata metadata = versionedMetadata.getValue();
                if (metadata.isClosed()) {
                    lastAddConfirmed = lastAddPushed = metadata.getLastEntryId();
                    length = metadata.getLength();
                }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lastAddPushed` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
                LedgerMetadata metadata = versionedMetadata.getValue();
                if (metadata.isClosed()) {
                    lastAddConfirmed = lastAddPushed = metadata.getLastEntryId();
                    length = metadata.getLength();
                }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `length` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
                if (metadata.isClosed()) {
                    lastAddConfirmed = lastAddPushed = metadata.getLastEntryId();
                    length = metadata.getLength();
                }
                return true;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.length` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
    @Override
    public synchronized long getLength() {
        return this.length;
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.length` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
     */
    synchronized long addToLength(long delta) {
        this.length += delta;
        return this.length;
    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.length` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
    synchronized long addToLength(long delta) {
        this.length += delta;
        return this.length;
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `changingEnsemble` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
        List<BookieId> origEnsemble = null;
        synchronized (metadataLock) {
            if (changingEnsemble) {
                delayedWriteFailedBookies.putAll(failedBookies);
            } else {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `changingEnsemble` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
                delayedWriteFailedBookies.putAll(failedBookies);
            } else {
                changingEnsemble = true;
                triggerLoop = true;

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lastAddConfirmed` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
            isClosed = metadata.isClosed();
            if (isClosed) {
                lastAddConfirmed = metadata.getLastEntryId();
                length = metadata.getLength();
            }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `length` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
            if (isClosed) {
                lastAddConfirmed = metadata.getLastEntryId();
                length = metadata.getLength();
            }
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lastAddConfirmed` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
    @Override
    public synchronized long getLastAddConfirmed() {
        return lastAddConfirmed;
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lastAddPushed` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
    @Override
    public synchronized long getLastAddPushed() {
        return lastAddPushed;
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.lastAddConfirmed` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java

    synchronized void setLastAddConfirmed(long lac) {
        this.lastAddConfirmed = lac;
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `changingEnsemble` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
                                LOG.info("New Ensemble: {} for ledger: {}", newEnsemble, ledgerId);

                                changingEnsemble = false;
                            }
                        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `pendingAddOps` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
    synchronized List<PendingAddOp> drainPendingAddsAndAdjustLength() {
        PendingAddOp pendingAddOp;
        List<PendingAddOp> opsDrained = new ArrayList<PendingAddOp>(pendingAddOps.size());
        while ((pendingAddOp = pendingAddOps.poll()) != null) {
            addToLength(-pendingAddOp.entryLength);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `pendingAddOps` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
        PendingAddOp pendingAddOp;
        List<PendingAddOp> opsDrained = new ArrayList<PendingAddOp>(pendingAddOps.size());
        while ((pendingAddOp = pendingAddOps.poll()) != null) {
            addToLength(-pendingAddOp.entryLength);
            opsDrained.add(pendingAddOp);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lastAddPushed` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java

                        // taking the length must occur after draining, as draining changes the length
                        lastEntry = lastAddPushed = LedgerHandle.this.lastAddConfirmed;
                        finalLength = LedgerHandle.this.length;
                        handleState = HandleState.CLOSED;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `LedgerHandle.this.lastAddConfirmed` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java

                        // taking the length must occur after draining, as draining changes the length
                        lastEntry = lastAddPushed = LedgerHandle.this.lastAddConfirmed;
                        finalLength = LedgerHandle.this.length;
                        handleState = HandleState.CLOSED;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `LedgerHandle.this.length` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
                        // taking the length must occur after draining, as draining changes the length
                        lastEntry = lastAddPushed = LedgerHandle.this.lastAddConfirmed;
                        finalLength = LedgerHandle.this.length;
                        handleState = HandleState.CLOSED;
                    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lastAddPushed` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
            // updating lastAddPushed
            if (isHandleWritable()) {
                long entryId = ++lastAddPushed;
                long currentLedgerLength = addToLength(op.payload.readableBytes());
                op.setEntryId(entryId);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `pendingAddOps` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
                op.setEntryId(entryId);
                op.setLedgerLength(currentLedgerLength);
                pendingAddOps.add(op);
            } else {
                wasClosed = true;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `hasRun` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
         * joy that goes along with that.
         */
        if (hasRun && callbackTriggered) {
            ReferenceCountUtil.release(toSend);
            toSend = null;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `callbackTriggered` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
         * joy that goes along with that.
         */
        if (hasRun && callbackTriggered) {
            ReferenceCountUtil.release(toSend);
            toSend = null;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `toSend` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
         */
        if (hasRun && callbackTriggered) {
            ReferenceCountUtil.release(toSend);
            toSend = null;
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `toSend` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        if (hasRun && callbackTriggered) {
            ReferenceCountUtil.release(toSend);
            toSend = null;
        }
        // only recycle a pending add op after it has been run.
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `hasRun` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        }
        // only recycle a pending add op after it has been run.
        if (hasRun && toSend == null && pendingWriteRequests == 0) {
            recyclePendAddOpObject();
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `toSend` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        }
        // only recycle a pending add op after it has been run.
        if (hasRun && toSend == null && pendingWriteRequests == 0) {
            recyclePendAddOpObject();
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `pendingWriteRequests` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        }
        // only recycle a pending add op after it has been run.
        if (hasRun && toSend == null && pendingWriteRequests == 0) {
            recyclePendAddOpObject();
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `completed` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java

    synchronized void timeoutQuorumWait() {
        if (completed) {
            return;
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `addEntrySuccessBookies` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        }

        if (addEntrySuccessBookies.size() >= lh.getLedgerMetadata().getAckQuorumSize()) {
            // If ackQuorum number of bookies have acknowledged the write but still not complete, indicates
            // failures due to not having been written to enough fault domains. Increment corresponding
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lh` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        }

        if (addEntrySuccessBookies.size() >= lh.getLedgerMetadata().getAckQuorumSize()) {
            // If ackQuorum number of bookies have acknowledged the write but still not complete, indicates
            // failures due to not having been written to enough fault domains. Increment corresponding
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `clientCtx` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
            // failures due to not having been written to enough fault domains. Increment corresponding
            // counter.
            clientCtx.getClientStats().getWriteTimedOutDueToNotEnoughFaultDomains().inc();
        }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lh` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        }

        lh.handleUnrecoverableErrorDuringAdd(BKException.Code.AddEntryQuorumTimeoutException);
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lh` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
    synchronized void submitCallback(final int rc) {
        if (LOG.isDebugEnabled()) {
            LOG.debug("Submit callback (lid:{}, eid: {}). rc:{}", lh.getId(), entryId, rc);
        }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `entryId` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
    synchronized void submitCallback(final int rc) {
        if (LOG.isDebugEnabled()) {
            LOG.debug("Submit callback (lid:{}, eid: {}). rc:{}", lh.getId(), entryId, rc);
        }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `requestTimeNanos` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        }

        long latencyNanos = MathUtils.elapsedNanos(requestTimeNanos);
        if (rc != BKException.Code.OK) {
            clientCtx.getClientStats().getAddOpLogger().registerFailedEvent(latencyNanos, TimeUnit.NANOSECONDS);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `clientCtx` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        long latencyNanos = MathUtils.elapsedNanos(requestTimeNanos);
        if (rc != BKException.Code.OK) {
            clientCtx.getClientStats().getAddOpLogger().registerFailedEvent(latencyNanos, TimeUnit.NANOSECONDS);
            LOG.error("Write of ledger entry to quorum failed: L{} E{}",
                      lh.getId(), entryId);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lh` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
            clientCtx.getClientStats().getAddOpLogger().registerFailedEvent(latencyNanos, TimeUnit.NANOSECONDS);
            LOG.error("Write of ledger entry to quorum failed: L{} E{}",
                      lh.getId(), entryId);
        } else {
            clientCtx.getClientStats().getAddOpLogger().registerSuccessfulEvent(latencyNanos, TimeUnit.NANOSECONDS);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `entryId` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
            clientCtx.getClientStats().getAddOpLogger().registerFailedEvent(latencyNanos, TimeUnit.NANOSECONDS);
            LOG.error("Write of ledger entry to quorum failed: L{} E{}",
                      lh.getId(), entryId);
        } else {
            clientCtx.getClientStats().getAddOpLogger().registerSuccessfulEvent(latencyNanos, TimeUnit.NANOSECONDS);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `clientCtx` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
                      lh.getId(), entryId);
        } else {
            clientCtx.getClientStats().getAddOpLogger().registerSuccessfulEvent(latencyNanos, TimeUnit.NANOSECONDS);
        }
        cb.addCompleteWithLatency(rc, lh, entryId, qwcLatency, ctx);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `cb` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
            clientCtx.getClientStats().getAddOpLogger().registerSuccessfulEvent(latencyNanos, TimeUnit.NANOSECONDS);
        }
        cb.addCompleteWithLatency(rc, lh, entryId, qwcLatency, ctx);
        callbackTriggered = true;

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lh` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
            clientCtx.getClientStats().getAddOpLogger().registerSuccessfulEvent(latencyNanos, TimeUnit.NANOSECONDS);
        }
        cb.addCompleteWithLatency(rc, lh, entryId, qwcLatency, ctx);
        callbackTriggered = true;

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `entryId` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
            clientCtx.getClientStats().getAddOpLogger().registerSuccessfulEvent(latencyNanos, TimeUnit.NANOSECONDS);
        }
        cb.addCompleteWithLatency(rc, lh, entryId, qwcLatency, ctx);
        callbackTriggered = true;

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `qwcLatency` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
            clientCtx.getClientStats().getAddOpLogger().registerSuccessfulEvent(latencyNanos, TimeUnit.NANOSECONDS);
        }
        cb.addCompleteWithLatency(rc, lh, entryId, qwcLatency, ctx);
        callbackTriggered = true;

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `ctx` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
            clientCtx.getClientStats().getAddOpLogger().registerSuccessfulEvent(latencyNanos, TimeUnit.NANOSECONDS);
        }
        cb.addCompleteWithLatency(rc, lh, entryId, qwcLatency, ctx);
        callbackTriggered = true;

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `callbackTriggered` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        }
        cb.addCompleteWithLatency(rc, lh, entryId, qwcLatency, ctx);
        callbackTriggered = true;

        maybeRecycle();
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `hasRun` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
     */
    public synchronized void initiate() {
        hasRun = true;
        if (callbackTriggered) {
            // this should only be true if the request was failed due
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `callbackTriggered` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
    public synchronized void initiate() {
        hasRun = true;
        if (callbackTriggered) {
            // this should only be true if the request was failed due
            // to another request ahead in the pending queue,
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.requestTimeNanos` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        }

        this.requestTimeNanos = MathUtils.nowInNano();
        checkNotNull(lh);
        checkNotNull(lh.macManager);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lh` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java

        this.requestTimeNanos = MathUtils.nowInNano();
        checkNotNull(lh);
        checkNotNull(lh.macManager);

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lh` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        this.requestTimeNanos = MathUtils.nowInNano();
        checkNotNull(lh);
        checkNotNull(lh.macManager);

        this.toSend = lh.macManager.computeDigestAndPackageForSending(
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.toSend` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        checkNotNull(lh.macManager);

        this.toSend = lh.macManager.computeDigestAndPackageForSending(
                entryId, lh.lastAddConfirmed, currentLedgerLength,
                payload);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lh` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        checkNotNull(lh.macManager);

        this.toSend = lh.macManager.computeDigestAndPackageForSending(
                entryId, lh.lastAddConfirmed, currentLedgerLength,
                payload);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `entryId` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java

        this.toSend = lh.macManager.computeDigestAndPackageForSending(
                entryId, lh.lastAddConfirmed, currentLedgerLength,
                payload);
        // ownership of RefCounted ByteBuf was passed to computeDigestAndPackageForSending
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lh` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java

        this.toSend = lh.macManager.computeDigestAndPackageForSending(
                entryId, lh.lastAddConfirmed, currentLedgerLength,
                payload);
        // ownership of RefCounted ByteBuf was passed to computeDigestAndPackageForSending
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `currentLedgerLength` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java

        this.toSend = lh.macManager.computeDigestAndPackageForSending(
                entryId, lh.lastAddConfirmed, currentLedgerLength,
                payload);
        // ownership of RefCounted ByteBuf was passed to computeDigestAndPackageForSending
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `payload` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        this.toSend = lh.macManager.computeDigestAndPackageForSending(
                entryId, lh.lastAddConfirmed, currentLedgerLength,
                payload);
        // ownership of RefCounted ByteBuf was passed to computeDigestAndPackageForSending
        payload = null;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `payload` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
                payload);
        // ownership of RefCounted ByteBuf was passed to computeDigestAndPackageForSending
        payload = null;

        // We are about to send. Check if we need to make an ensemble change
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lh` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        // We are about to send. Check if we need to make an ensemble change
        // because of delayed write errors
        lh.maybeHandleDelayedWriteBookieFailure();

        // Iterate over set and trigger the sendWriteRequests
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lh` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java

        // Iterate over set and trigger the sendWriteRequests
        for (int i = 0; i < lh.distributionSchedule.getWriteQuorumSize(); i++) {
            sendWriteRequest(ensemble, lh.distributionSchedule.getWriteSetBookieIndex(entryId, i));
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `ensemble` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        // Iterate over set and trigger the sendWriteRequests
        for (int i = 0; i < lh.distributionSchedule.getWriteQuorumSize(); i++) {
            sendWriteRequest(ensemble, lh.distributionSchedule.getWriteSetBookieIndex(entryId, i));
        }
    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lh` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        // Iterate over set and trigger the sendWriteRequests
        for (int i = 0; i < lh.distributionSchedule.getWriteQuorumSize(); i++) {
            sendWriteRequest(ensemble, lh.distributionSchedule.getWriteSetBookieIndex(entryId, i));
        }
    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `entryId` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        // Iterate over set and trigger the sendWriteRequests
        for (int i = 0; i < lh.distributionSchedule.getWriteQuorumSize(); i++) {
            sendWriteRequest(ensemble, lh.distributionSchedule.getWriteSetBookieIndex(entryId, i));
        }
    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `pendingWriteRequests` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
    public synchronized void writeComplete(int rc, long ledgerId, long entryId, BookieId addr, Object ctx) {
        int bookieIndex = (Integer) ctx;
        --pendingWriteRequests;

        if (!ensemble.get(bookieIndex).equals(addr)) {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `ensemble` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        --pendingWriteRequests;

        if (!ensemble.get(bookieIndex).equals(addr)) {
            // ensemble has already changed, failure of this addr is immaterial
            if (LOG.isDebugEnabled()) {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `ackSet` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        boolean ackQuorum = false;
        if (BKException.Code.OK == rc) {
            ackQuorum = ackSet.completeBookieAndCheck(bookieIndex);
            addEntrySuccessBookies.add(ensemble.get(bookieIndex));
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `addEntrySuccessBookies` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        if (BKException.Code.OK == rc) {
            ackQuorum = ackSet.completeBookieAndCheck(bookieIndex);
            addEntrySuccessBookies.add(ensemble.get(bookieIndex));
        }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `ensemble` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        if (BKException.Code.OK == rc) {
            ackQuorum = ackSet.completeBookieAndCheck(bookieIndex);
            addEntrySuccessBookies.add(ensemble.get(bookieIndex));
        }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `completed` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        }

        if (completed) {
            if (rc != BKException.Code.OK) {
                // Got an error after satisfying AQ. This means we are under replicated at the create itself.
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `clientCtx` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
                // Got an error after satisfying AQ. This means we are under replicated at the create itself.
                // Update the stat to reflect it.
                clientCtx.getClientStats().getAddOpUrCounter().inc();
                if (!clientCtx.getConf().disableEnsembleChangeFeature.isAvailable()
                        && !clientCtx.getConf().delayEnsembleChange) {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `clientCtx` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
                // Update the stat to reflect it.
                clientCtx.getClientStats().getAddOpUrCounter().inc();
                if (!clientCtx.getConf().disableEnsembleChangeFeature.isAvailable()
                        && !clientCtx.getConf().delayEnsembleChange) {
                    lh.notifyWriteFailed(bookieIndex, addr);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `clientCtx` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
                clientCtx.getClientStats().getAddOpUrCounter().inc();
                if (!clientCtx.getConf().disableEnsembleChangeFeature.isAvailable()
                        && !clientCtx.getConf().delayEnsembleChange) {
                    lh.notifyWriteFailed(bookieIndex, addr);
                }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lh` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
                if (!clientCtx.getConf().disableEnsembleChangeFeature.isAvailable()
                        && !clientCtx.getConf().delayEnsembleChange) {
                    lh.notifyWriteFailed(bookieIndex, addr);
                }
            }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lh` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        case BKException.Code.ClientClosedException:
            // bookie client is closed.
            lh.errorOutPendingAdds(rc);
            return;
        case BKException.Code.IllegalOpException:
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lh` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        case BKException.Code.IllegalOpException:
            // illegal operation requested, like using unsupported feature in v2 protocol
            lh.handleUnrecoverableErrorDuringAdd(rc);
            return;
        case BKException.Code.LedgerFencedException:
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lh` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
            LOG.warn("Fencing exception on write: L{} E{} on {}",
                    ledgerId, entryId, addr);
            lh.handleUnrecoverableErrorDuringAdd(rc);
            return;
        case BKException.Code.UnauthorizedAccessException:
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lh` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
            LOG.warn("Unauthorized access exception on write: L{} E{} on {}",
                    ledgerId, entryId, addr);
            lh.handleUnrecoverableErrorDuringAdd(rc);
            return;
        default:
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `clientCtx` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
            return;
        default:
            if (clientCtx.getConf().delayEnsembleChange) {
                if (ackSet.failBookieAndCheck(bookieIndex, addr)
                        || rc == BKException.Code.WriteOnReadOnlyBookieException) {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `ackSet` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        default:
            if (clientCtx.getConf().delayEnsembleChange) {
                if (ackSet.failBookieAndCheck(bookieIndex, addr)
                        || rc == BKException.Code.WriteOnReadOnlyBookieException) {
                    Map<Integer, BookieId> failedBookies = ackSet.getFailedBookies();
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `ackSet` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
                if (ackSet.failBookieAndCheck(bookieIndex, addr)
                        || rc == BKException.Code.WriteOnReadOnlyBookieException) {
                    Map<Integer, BookieId> failedBookies = ackSet.getFailedBookies();
                    LOG.warn("Failed to write entry ({}, {}) to bookies {}, handling failures.",
                            ledgerId, entryId, failedBookies);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lh` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
                            ledgerId, entryId, failedBookies);
                    // we can't meet ack quorum requirement, trigger ensemble change.
                    lh.handleBookieFailure(failedBookies);
                } else if (LOG.isDebugEnabled()) {
                    LOG.debug("Failed to write entry ({}, {}) to bookie ({}, {}),"
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lh` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
                LOG.warn("Failed to write entry ({}, {}) to bookie ({}, {}): {}",
                        ledgerId, entryId, bookieIndex, addr, BKException.getMessage(rc));
                lh.handleBookieFailure(ImmutableMap.of(bookieIndex, addr));
            }
            return;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `completed` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        }

        if (ackQuorum && !completed) {
            if (clientCtx.getConf().enforceMinNumFaultDomainsForWrite
                && !(clientCtx.getPlacementPolicy()
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `clientCtx` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java

        if (ackQuorum && !completed) {
            if (clientCtx.getConf().enforceMinNumFaultDomainsForWrite
                && !(clientCtx.getPlacementPolicy()
                              .areAckedBookiesAdheringToPlacementPolicy(addEntrySuccessBookies,
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `clientCtx` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        if (ackQuorum && !completed) {
            if (clientCtx.getConf().enforceMinNumFaultDomainsForWrite
                && !(clientCtx.getPlacementPolicy()
                              .areAckedBookiesAdheringToPlacementPolicy(addEntrySuccessBookies,
                                                                        lh.getLedgerMetadata().getWriteQuorumSize(),
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `addEntrySuccessBookies` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
            if (clientCtx.getConf().enforceMinNumFaultDomainsForWrite
                && !(clientCtx.getPlacementPolicy()
                              .areAckedBookiesAdheringToPlacementPolicy(addEntrySuccessBookies,
                                                                        lh.getLedgerMetadata().getWriteQuorumSize(),
                                                                        lh.getLedgerMetadata().getAckQuorumSize()))) {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lh` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
                && !(clientCtx.getPlacementPolicy()
                              .areAckedBookiesAdheringToPlacementPolicy(addEntrySuccessBookies,
                                                                        lh.getLedgerMetadata().getWriteQuorumSize(),
                                                                        lh.getLedgerMetadata().getAckQuorumSize()))) {
                LOG.warn("Write success for entry ID {} delayed, not acknowledged by bookies in enough fault domains",
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lh` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
                              .areAckedBookiesAdheringToPlacementPolicy(addEntrySuccessBookies,
                                                                        lh.getLedgerMetadata().getWriteQuorumSize(),
                                                                        lh.getLedgerMetadata().getAckQuorumSize()))) {
                LOG.warn("Write success for entry ID {} delayed, not acknowledged by bookies in enough fault domains",
                         entryId);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `clientCtx` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
                         entryId);
                // Increment to indicate write did not complete due to not enough fault domains
                clientCtx.getClientStats().getWriteDelayedDueToNotEnoughFaultDomains().inc();

                // Only do this for the first time.
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `writeDelayedStartTime` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java

                // Only do this for the first time.
                if (writeDelayedStartTime == -1) {
                    writeDelayedStartTime = MathUtils.nowInNano();
                }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `writeDelayedStartTime` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
                // Only do this for the first time.
                if (writeDelayedStartTime == -1) {
                    writeDelayedStartTime = MathUtils.nowInNano();
                }
            } else {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `completed` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
                }
            } else {
                completed = true;
                this.qwcLatency = MathUtils.elapsedNanos(requestTimeNanos);

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.qwcLatency` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
            } else {
                completed = true;
                this.qwcLatency = MathUtils.elapsedNanos(requestTimeNanos);

                if (writeDelayedStartTime != -1) {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `requestTimeNanos` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
            } else {
                completed = true;
                this.qwcLatency = MathUtils.elapsedNanos(requestTimeNanos);

                if (writeDelayedStartTime != -1) {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `writeDelayedStartTime` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
                this.qwcLatency = MathUtils.elapsedNanos(requestTimeNanos);

                if (writeDelayedStartTime != -1) {
                    clientCtx.getClientStats()
                             .getWriteDelayedDueToNotEnoughFaultDomainsLatency()
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `clientCtx` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java

                if (writeDelayedStartTime != -1) {
                    clientCtx.getClientStats()
                             .getWriteDelayedDueToNotEnoughFaultDomainsLatency()
                             .registerSuccessfulEvent(MathUtils.elapsedNanos(writeDelayedStartTime),
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `writeDelayedStartTime` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
                    clientCtx.getClientStats()
                             .getWriteDelayedDueToNotEnoughFaultDomainsLatency()
                             .registerSuccessfulEvent(MathUtils.elapsedNanos(writeDelayedStartTime),
                                                      TimeUnit.NANOSECONDS);
                }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.ensemble` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
    synchronized void unsetSuccessAndSendWriteRequest(List<BookieId> ensemble, int bookieIndex) {
        // update the ensemble
        this.ensemble = ensemble;

        if (toSend == null) {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `toSend` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        this.ensemble = ensemble;

        if (toSend == null) {
            // this addOp hasn't yet had its mac computed. When the mac is
            // computed, its write requests will be sent, so no need to send it
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lh` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        //
        // We call sendAddSuccessCallback when unsetting t cover this case.
        if (!lh.distributionSchedule.hasEntry(entryId, bookieIndex)) {
            lh.sendAddSuccessCallbacks();
            return;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `entryId` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        //
        // We call sendAddSuccessCallback when unsetting t cover this case.
        if (!lh.distributionSchedule.hasEntry(entryId, bookieIndex)) {
            lh.sendAddSuccessCallbacks();
            return;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lh` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        // We call sendAddSuccessCallback when unsetting t cover this case.
        if (!lh.distributionSchedule.hasEntry(entryId, bookieIndex)) {
            lh.sendAddSuccessCallbacks();
            return;
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `callbackTriggered` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        }

        if (callbackTriggered) {
            return;
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lh` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java

        if (LOG.isDebugEnabled()) {
            LOG.debug("Unsetting success for ledger: " + lh.ledgerId + " entry: " + entryId + " bookie index: "
                      + bookieIndex);
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `entryId` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java

        if (LOG.isDebugEnabled()) {
            LOG.debug("Unsetting success for ledger: " + lh.ledgerId + " entry: " + entryId + " bookie index: "
                      + bookieIndex);
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `ackSet` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        // increment our number of responses that are pending, since we are
        // going to unset this success
        if (!ackSet.removeBookieAndCheck(bookieIndex)) {
            // unset completed if this results in loss of ack quorum
            completed = false;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `completed` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        if (!ackSet.removeBookieAndCheck(bookieIndex)) {
            // unset completed if this results in loss of ack quorum
            completed = false;
        }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `entryId` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java

    public synchronized void recyclePendAddOpObject() {
        entryId = LedgerHandle.INVALID_ENTRY_ID;
        currentLedgerLength = -1;
        if (payload != null) {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `currentLedgerLength` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
    public synchronized void recyclePendAddOpObject() {
        entryId = LedgerHandle.INVALID_ENTRY_ID;
        currentLedgerLength = -1;
        if (payload != null) {
            ReferenceCountUtil.release(payload);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `payload` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        entryId = LedgerHandle.INVALID_ENTRY_ID;
        currentLedgerLength = -1;
        if (payload != null) {
            ReferenceCountUtil.release(payload);
            payload = null;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `payload` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        currentLedgerLength = -1;
        if (payload != null) {
            ReferenceCountUtil.release(payload);
            payload = null;
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `payload` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        if (payload != null) {
            ReferenceCountUtil.release(payload);
            payload = null;
        }
        cb = null;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `cb` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
            payload = null;
        }
        cb = null;
        ctx = null;
        ensemble = null;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `ctx` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        }
        cb = null;
        ctx = null;
        ensemble = null;
        ackSet.recycle();
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `ensemble` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        cb = null;
        ctx = null;
        ensemble = null;
        ackSet.recycle();
        ackSet = null;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `ackSet` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        ctx = null;
        ensemble = null;
        ackSet.recycle();
        ackSet = null;
        lh = null;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `ackSet` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        ensemble = null;
        ackSet.recycle();
        ackSet = null;
        lh = null;
        clientCtx = null;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lh` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        ackSet.recycle();
        ackSet = null;
        lh = null;
        clientCtx = null;
        isRecoveryAdd = false;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `clientCtx` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        ackSet = null;
        lh = null;
        clientCtx = null;
        isRecoveryAdd = false;
        completed = false;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `isRecoveryAdd` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        lh = null;
        clientCtx = null;
        isRecoveryAdd = false;
        completed = false;
        pendingWriteRequests = 0;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `completed` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        clientCtx = null;
        isRecoveryAdd = false;
        completed = false;
        pendingWriteRequests = 0;
        callbackTriggered = false;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `pendingWriteRequests` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        isRecoveryAdd = false;
        completed = false;
        pendingWriteRequests = 0;
        callbackTriggered = false;
        hasRun = false;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `callbackTriggered` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        completed = false;
        pendingWriteRequests = 0;
        callbackTriggered = false;
        hasRun = false;
        allowFailFast = false;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `hasRun` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        pendingWriteRequests = 0;
        callbackTriggered = false;
        hasRun = false;
        allowFailFast = false;
        writeFlags = null;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `allowFailFast` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        callbackTriggered = false;
        hasRun = false;
        allowFailFast = false;
        writeFlags = null;
        addEntrySuccessBookies.clear();
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `writeFlags` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        hasRun = false;
        allowFailFast = false;
        writeFlags = null;
        addEntrySuccessBookies.clear();
        writeDelayedStartTime = -1;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `addEntrySuccessBookies` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        allowFailFast = false;
        writeFlags = null;
        addEntrySuccessBookies.clear();
        writeDelayedStartTime = -1;

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `writeDelayedStartTime` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        writeFlags = null;
        addEntrySuccessBookies.clear();
        writeDelayedStartTime = -1;

        recyclerHandle.recycle(this);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `bbytes` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/streaming/LedgerOutputStream.java`
#### Snippet
```java
        if (!makeSpace(len)) {
            // lets try making the buffer bigger
            bbytes = new byte[len];
            bytebuff = ByteBuffer.wrap(bbytes);
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `bbytes` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/streaming/LedgerOutputStream.java`
#### Snippet
```java
            // lets try making the buffer bigger
            bbytes = new byte[len];
            bytebuff = ByteBuffer.wrap(bbytes);
        }
        bytebuff.put(b, off, len);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `bbytes` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/streaming/LedgerOutputStream.java`
#### Snippet
```java
            byte[] b = new byte[bytebuff.position()];
            LOG.info("Comment: flushing with params " + " " + bytebuff.position());
            System.arraycopy(bbytes, 0, b, 0, bytebuff.position());
            try {
                lh.addEntry(b);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `bbytes` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/streaming/LedgerInputStream.java`
#### Snippet
```java
            int bcopied = bytebuff.remaining();
            int tocopy = Math.min(bcopied, len);
            System.arraycopy(bbytes, bytebuff.position(), b, off, tocopy);
            bytebuff.position(bytebuff.position() + tocopy);
            return tocopy;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `ledgerSeq` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/streaming/LedgerInputStream.java`
#### Snippet
```java
    private synchronized boolean refill() throws IOException {
        bytebuff.clear();
        if (!ledgerSeq.hasMoreElements() && lastEntry >= lh.getLastAddConfirmed()) {
            return false;
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lastEntry` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/streaming/LedgerInputStream.java`
#### Snippet
```java
    private synchronized boolean refill() throws IOException {
        bytebuff.clear();
        if (!ledgerSeq.hasMoreElements() && lastEntry >= lh.getLastAddConfirmed()) {
            return false;
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `ledgerSeq` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/streaming/LedgerInputStream.java`
#### Snippet
```java
            return false;
        }
        if (!ledgerSeq.hasMoreElements()) {
            // do refill
            long last = Math.min(lastEntry + increment, lh.getLastAddConfirmed());
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lastEntry` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/streaming/LedgerInputStream.java`
#### Snippet
```java
        if (!ledgerSeq.hasMoreElements()) {
            // do refill
            long last = Math.min(lastEntry + increment, lh.getLastAddConfirmed());
            try {
                ledgerSeq = lh.readEntries(lastEntry + 1, last);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `increment` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/streaming/LedgerInputStream.java`
#### Snippet
```java
        if (!ledgerSeq.hasMoreElements()) {
            // do refill
            long last = Math.min(lastEntry + increment, lh.getLastAddConfirmed());
            try {
                ledgerSeq = lh.readEntries(lastEntry + 1, last);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `ledgerSeq` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/streaming/LedgerInputStream.java`
#### Snippet
```java
            long last = Math.min(lastEntry + increment, lh.getLastAddConfirmed());
            try {
                ledgerSeq = lh.readEntries(lastEntry + 1, last);
            } catch (BKException bk) {
                IOException ie = new IOException(bk.getMessage());
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lastEntry` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/streaming/LedgerInputStream.java`
#### Snippet
```java
            long last = Math.min(lastEntry + increment, lh.getLastAddConfirmed());
            try {
                ledgerSeq = lh.readEntries(lastEntry + 1, last);
            } catch (BKException bk) {
                IOException ie = new IOException(bk.getMessage());
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lastEntry` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/streaming/LedgerInputStream.java`
#### Snippet
```java
                Thread.currentThread().interrupt();
            }
            lastEntry = last;
        }
        LedgerEntry le = ledgerSeq.nextElement();
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `ledgerSeq` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/streaming/LedgerInputStream.java`
#### Snippet
```java
            lastEntry = last;
        }
        LedgerEntry le = ledgerSeq.nextElement();
        bbytes = le.getEntry();
        bytebuff = ByteBuffer.wrap(bbytes);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `bbytes` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/streaming/LedgerInputStream.java`
#### Snippet
```java
        }
        LedgerEntry le = ledgerSeq.nextElement();
        bbytes = le.getEntry();
        bytebuff = ByteBuffer.wrap(bbytes);
        return true;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `bbytes` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/streaming/LedgerInputStream.java`
#### Snippet
```java
        LedgerEntry le = ledgerSeq.nextElement();
        bbytes = le.getEntry();
        bytebuff = ByteBuffer.wrap(bbytes);
        return true;
    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `bbytes` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/streaming/LedgerInputStream.java`
#### Snippet
```java
            // cannot used gets because of
            // the underflow/overflow exceptions
            System.arraycopy(bbytes, bytebuff.position(), b, 0, tocopy);
            bytebuff.position(bytebuff.position() + tocopy);
            return tocopy;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `regMgr` accessed in synchronized context
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdMetadataBookieDriver.java`
#### Snippet
```java
        EtcdBookieRegister bkRegisterToClose;
        synchronized (this) {
            rmToClose = regMgr;
            regMgr = null;
            bkRegisterToClose = bkRegister;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `regMgr` accessed in synchronized context
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdMetadataBookieDriver.java`
#### Snippet
```java
        synchronized (this) {
            rmToClose = regMgr;
            regMgr = null;
            bkRegisterToClose = bkRegister;
            bkRegister = null;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `bkRegister` accessed in synchronized context
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdMetadataBookieDriver.java`
#### Snippet
```java
            rmToClose = regMgr;
            regMgr = null;
            bkRegisterToClose = bkRegister;
            bkRegister = null;
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `bkRegister` accessed in synchronized context
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdMetadataBookieDriver.java`
#### Snippet
```java
            regMgr = null;
            bkRegisterToClose = bkRegister;
            bkRegister = null;
        }
        if (null != rmToClose) {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `bkRegister` accessed in synchronized context
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdMetadataBookieDriver.java`
#### Snippet
```java
    @Override
    public synchronized RegistrationManager createRegistrationManager() {
        if (null == bkRegister) {
            bkRegister = new EtcdBookieRegister(
                client.getLeaseClient(),
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `bkRegister` accessed in synchronized context
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdMetadataBookieDriver.java`
#### Snippet
```java
    public synchronized RegistrationManager createRegistrationManager() {
        if (null == bkRegister) {
            bkRegister = new EtcdBookieRegister(
                client.getLeaseClient(),
                TimeUnit.MILLISECONDS.toSeconds(conf.getZkTimeout())
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `client` accessed in synchronized context
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdMetadataBookieDriver.java`
#### Snippet
```java
        if (null == bkRegister) {
            bkRegister = new EtcdBookieRegister(
                client.getLeaseClient(),
                TimeUnit.MILLISECONDS.toSeconds(conf.getZkTimeout())
            ).start();
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `conf` accessed in synchronized context
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdMetadataBookieDriver.java`
#### Snippet
```java
            bkRegister = new EtcdBookieRegister(
                client.getLeaseClient(),
                TimeUnit.MILLISECONDS.toSeconds(conf.getZkTimeout())
            ).start();
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `regMgr` accessed in synchronized context
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdMetadataBookieDriver.java`
#### Snippet
```java
            ).start();
        }
        if (null == regMgr) {
            regMgr = new EtcdRegistrationManager(
                client,
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `regMgr` accessed in synchronized context
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdMetadataBookieDriver.java`
#### Snippet
```java
        }
        if (null == regMgr) {
            regMgr = new EtcdRegistrationManager(
                client,
                keyPrefix,
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `client` accessed in synchronized context
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdMetadataBookieDriver.java`
#### Snippet
```java
        if (null == regMgr) {
            regMgr = new EtcdRegistrationManager(
                client,
                keyPrefix,
                bkRegister
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `keyPrefix` accessed in synchronized context
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdMetadataBookieDriver.java`
#### Snippet
```java
            regMgr = new EtcdRegistrationManager(
                client,
                keyPrefix,
                bkRegister
            );
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `bkRegister` accessed in synchronized context
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdMetadataBookieDriver.java`
#### Snippet
```java
                client,
                keyPrefix,
                bkRegister
            );
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `regMgr` accessed in synchronized context
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdMetadataBookieDriver.java`
#### Snippet
```java
            );
        }
        return regMgr;
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.conf` accessed in synchronized context
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdMetadataBookieDriver.java`
#### Snippet
```java
            throws MetadataException {
        super.initialize(conf, statsLogger);
        this.conf = conf;
        this.statsLogger = statsLogger;
        return null;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.statsLogger` accessed in synchronized context
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdMetadataBookieDriver.java`
#### Snippet
```java
        super.initialize(conf, statsLogger);
        this.conf = conf;
        this.statsLogger = statsLogger;
        return null;
    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.client` accessed in synchronized context
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdMetadataDriverBase.java`
#### Snippet
```java

        synchronized (this) {
            this.client = Client.builder()
                .endpoints(etcdEndpoints.toArray(new String[etcdEndpoints.size()]))
                .build();
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lmFactory` accessed in synchronized context
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdMetadataDriverBase.java`
#### Snippet
```java
    public synchronized LedgerManagerFactory getLedgerManagerFactory()
            throws MetadataException {
        if (null == lmFactory) {
            try {
                lmFactory = new EtcdLedgerManagerFactory();
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lmFactory` accessed in synchronized context
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdMetadataDriverBase.java`
#### Snippet
```java
        if (null == lmFactory) {
            try {
                lmFactory = new EtcdLedgerManagerFactory();
                lmFactory.initialize(conf, layoutManager, EtcdLedgerManagerFactory.VERSION);
            } catch (IOException ioe) {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lmFactory` accessed in synchronized context
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdMetadataDriverBase.java`
#### Snippet
```java
            try {
                lmFactory = new EtcdLedgerManagerFactory();
                lmFactory.initialize(conf, layoutManager, EtcdLedgerManagerFactory.VERSION);
            } catch (IOException ioe) {
                throw new MetadataException(
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `conf` accessed in synchronized context
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdMetadataDriverBase.java`
#### Snippet
```java
            try {
                lmFactory = new EtcdLedgerManagerFactory();
                lmFactory.initialize(conf, layoutManager, EtcdLedgerManagerFactory.VERSION);
            } catch (IOException ioe) {
                throw new MetadataException(
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `layoutManager` accessed in synchronized context
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdMetadataDriverBase.java`
#### Snippet
```java
            try {
                lmFactory = new EtcdLedgerManagerFactory();
                lmFactory.initialize(conf, layoutManager, EtcdLedgerManagerFactory.VERSION);
            } catch (IOException ioe) {
                throw new MetadataException(
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lmFactory` accessed in synchronized context
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdMetadataDriverBase.java`
#### Snippet
```java
            }
        }
        return lmFactory;
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lmFactory` accessed in synchronized context
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdMetadataDriverBase.java`
#### Snippet
```java
    @Override
    public synchronized void close() {
        if (null != lmFactory) {
            try {
                lmFactory.close();
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lmFactory` accessed in synchronized context
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdMetadataDriverBase.java`
#### Snippet
```java
        if (null != lmFactory) {
            try {
                lmFactory.close();
            } catch (IOException e) {
                log.error("Failed to close ledger manager factory", e);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lmFactory` accessed in synchronized context
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdMetadataDriverBase.java`
#### Snippet
```java
                log.error("Failed to close ledger manager factory", e);
            }
            lmFactory = null;
        }
        if (null != client) {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `client` accessed in synchronized context
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdMetadataDriverBase.java`
#### Snippet
```java
            lmFactory = null;
        }
        if (null != client) {
            client.close();
            client = null;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `client` accessed in synchronized context
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdMetadataDriverBase.java`
#### Snippet
```java
        }
        if (null != client) {
            client.close();
            client = null;
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `client` accessed in synchronized context
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdMetadataDriverBase.java`
#### Snippet
```java
        if (null != client) {
            client.close();
            client = null;
        }
    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `regClient` accessed in synchronized context
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdMetadataClientDriver.java`
#### Snippet
```java
    @Override
    public synchronized void close() {
        if (null != regClient) {
            regClient.close();
            regClient = null;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `regClient` accessed in synchronized context
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdMetadataClientDriver.java`
#### Snippet
```java
    public synchronized void close() {
        if (null != regClient) {
            regClient.close();
            regClient = null;
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `regClient` accessed in synchronized context
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdMetadataClientDriver.java`
#### Snippet
```java
        if (null != regClient) {
            regClient.close();
            regClient = null;
        }
        super.close();
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `regClient` accessed in synchronized context
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdMetadataClientDriver.java`
#### Snippet
```java
    @Override
    public synchronized RegistrationClient getRegistrationClient() {
        if (null == regClient) {
            regClient = new EtcdRegistrationClient(keyPrefix, client);
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `regClient` accessed in synchronized context
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdMetadataClientDriver.java`
#### Snippet
```java
    public synchronized RegistrationClient getRegistrationClient() {
        if (null == regClient) {
            regClient = new EtcdRegistrationClient(keyPrefix, client);
        }
        return regClient;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `keyPrefix` accessed in synchronized context
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdMetadataClientDriver.java`
#### Snippet
```java
    public synchronized RegistrationClient getRegistrationClient() {
        if (null == regClient) {
            regClient = new EtcdRegistrationClient(keyPrefix, client);
        }
        return regClient;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `client` accessed in synchronized context
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdMetadataClientDriver.java`
#### Snippet
```java
    public synchronized RegistrationClient getRegistrationClient() {
        if (null == regClient) {
            regClient = new EtcdRegistrationClient(keyPrefix, client);
        }
        return regClient;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `regClient` accessed in synchronized context
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdMetadataClientDriver.java`
#### Snippet
```java
            regClient = new EtcdRegistrationClient(keyPrefix, client);
        }
        return regClient;
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `localVersion` accessed in synchronized context
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/helpers/RevisionedConsumer.java`
#### Snippet
```java
    public void accept(Versioned<T> versionedVal) {
        synchronized (this) {
            if (localVersion != null
                && Occurred.BEFORE != localVersion.compare(versionedVal.getVersion())) {
                return;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `localVersion` accessed in synchronized context
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/helpers/RevisionedConsumer.java`
#### Snippet
```java
        synchronized (this) {
            if (localVersion != null
                && Occurred.BEFORE != localVersion.compare(versionedVal.getVersion())) {
                return;
            }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `localVersion` accessed in synchronized context
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/helpers/RevisionedConsumer.java`
#### Snippet
```java
                return;
            }
            localVersion = versionedVal.getVersion();
        }
        consumer.accept(versionedVal);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `version` accessed in synchronized context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/metastore/InMemoryMetastoreTable.java`
#### Snippet
```java

        public synchronized MetadataVersion incrementVersion() {
            ++version;
            return this;
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `metrics` accessed in synchronized context
in `stats/bookkeeper-stats-providers/codahale-metrics-provider/src/main/java/org/apache/bookkeeper/stats/codahale/CodahaleMetricsProvider.java`
#### Snippet
```java

    public synchronized MetricRegistry getMetrics() {
        return metrics;
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `metrics` accessed in synchronized context
in `stats/bookkeeper-stats-providers/codahale-metrics-provider/src/main/java/org/apache/bookkeeper/stats/codahale/CodahaleMetricsProvider.java`
#### Snippet
```java

    synchronized void initIfNecessary() {
        if (metrics == null) {
            metrics = new MetricRegistry();
            metrics.registerAll(new MemoryUsageGaugeSet());
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `metrics` accessed in synchronized context
in `stats/bookkeeper-stats-providers/codahale-metrics-provider/src/main/java/org/apache/bookkeeper/stats/codahale/CodahaleMetricsProvider.java`
#### Snippet
```java
    synchronized void initIfNecessary() {
        if (metrics == null) {
            metrics = new MetricRegistry();
            metrics.registerAll(new MemoryUsageGaugeSet());
            metrics.registerAll(new GarbageCollectorMetricSet());
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `metrics` accessed in synchronized context
in `stats/bookkeeper-stats-providers/codahale-metrics-provider/src/main/java/org/apache/bookkeeper/stats/codahale/CodahaleMetricsProvider.java`
#### Snippet
```java
        if (metrics == null) {
            metrics = new MetricRegistry();
            metrics.registerAll(new MemoryUsageGaugeSet());
            metrics.registerAll(new GarbageCollectorMetricSet());
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `metrics` accessed in synchronized context
in `stats/bookkeeper-stats-providers/codahale-metrics-provider/src/main/java/org/apache/bookkeeper/stats/codahale/CodahaleMetricsProvider.java`
#### Snippet
```java
            metrics = new MetricRegistry();
            metrics.registerAll(new MemoryUsageGaugeSet());
            metrics.registerAll(new GarbageCollectorMetricSet());
        }
    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `maxSeqNo` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/MaxLogSegmentSequenceNo.java`
#### Snippet
```java

    synchronized long getSequenceNumber() {
        return maxSeqNo;
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.version` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/MaxLogSegmentSequenceNo.java`
#### Snippet
```java

    synchronized MaxLogSegmentSequenceNo update(Version version, long logSegmentSeqNo) {
        if (version.compare(this.version) == Version.Occurred.AFTER) {
            this.version = version;
            this.maxSeqNo = logSegmentSeqNo;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.version` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/MaxLogSegmentSequenceNo.java`
#### Snippet
```java
    synchronized MaxLogSegmentSequenceNo update(Version version, long logSegmentSeqNo) {
        if (version.compare(this.version) == Version.Occurred.AFTER) {
            this.version = version;
            this.maxSeqNo = logSegmentSeqNo;
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.maxSeqNo` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/MaxLogSegmentSequenceNo.java`
#### Snippet
```java
        if (version.compare(this.version) == Version.Occurred.AFTER) {
            this.version = version;
            this.maxSeqNo = logSegmentSeqNo;
        }
        return this;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `version` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/MaxLogSegmentSequenceNo.java`
#### Snippet
```java

    public synchronized Versioned<Long> getVersionedData(long seqNo) {
        return new Versioned<Long>(seqNo, version);
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `version` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/MaxLogSegmentSequenceNo.java`
#### Snippet
```java

    synchronized Version getVersion() {
        return version;
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `readAheadReader` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKSyncLogReader.java`
#### Snippet
```java
        // no record is returned, check if the reader becomes idle
        if (null == record && shouldCheckIdleReader) {
            if (readAheadReader.getNumCachedEntries() <= 0
                    && readAheadReader.isReaderIdle(idleErrorThresholdMillis, TimeUnit.MILLISECONDS)) {
                markReaderAsIdle();
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `readAheadReader` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKSyncLogReader.java`
#### Snippet
```java
        if (null == record && shouldCheckIdleReader) {
            if (readAheadReader.getNumCachedEntries() <= 0
                    && readAheadReader.isReaderIdle(idleErrorThresholdMillis, TimeUnit.MILLISECONDS)) {
                markReaderAsIdle();
            }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `segmentWriter` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAbstractLogWriter.java`
#### Snippet
```java

    protected synchronized BKLogSegmentWriter getCachedLogWriter() {
        return segmentWriter;
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `allocatedSegmentWriter` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAbstractLogWriter.java`
#### Snippet
```java
    protected synchronized BKLogSegmentWriter removeAllocatedLogWriter() {
        try {
            return allocatedSegmentWriter;
        } finally {
            allocatedSegmentWriter = null;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `allocatedSegmentWriter` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAbstractLogWriter.java`
#### Snippet
```java
            return allocatedSegmentWriter;
        } finally {
            allocatedSegmentWriter = null;
        }
    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `writeHandler` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAbstractLogWriter.java`
#### Snippet
```java
            throws IOException {
        synchronized (this) {
            if (writeHandler != null) {
                return writeHandler;
            }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `writeHandler` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAbstractLogWriter.java`
#### Snippet
```java
        synchronized (this) {
            if (writeHandler != null) {
                return writeHandler;
            }
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `writeHandler` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAbstractLogWriter.java`
#### Snippet
```java
        try {
            synchronized (this) {
                if (writeHandler == null) {
                    writeHandler = newHandler;
                    success = true;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `writeHandler` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAbstractLogWriter.java`
#### Snippet
```java
            synchronized (this) {
                if (writeHandler == null) {
                    writeHandler = newHandler;
                    success = true;
                }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `writeHandler` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAbstractLogWriter.java`
#### Snippet
```java
                    success = true;
                }
                return writeHandler;
            }
        } finally {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `segmentWriterFuture` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAbstractLogWriter.java`
#### Snippet
```java

    protected synchronized CompletableFuture<BKLogSegmentWriter> getCachedLogWriterFuture() {
        return segmentWriterFuture;
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `allocatedSegmentWriter` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAbstractLogWriter.java`
#### Snippet
```java

    protected synchronized BKLogSegmentWriter getAllocatedLogWriter() {
        return allocatedSegmentWriter;
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `segmentWriter` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAbstractLogWriter.java`
#### Snippet
```java
    protected synchronized BKLogSegmentWriter removeCachedLogWriter() {
        try {
            return segmentWriter;
        } finally {
            segmentWriter = null;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `segmentWriter` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAbstractLogWriter.java`
#### Snippet
```java
            return segmentWriter;
        } finally {
            segmentWriter = null;
            segmentWriterFuture = null;
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `segmentWriterFuture` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAbstractLogWriter.java`
#### Snippet
```java
        } finally {
            segmentWriter = null;
            segmentWriterFuture = null;
        }
    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.segmentWriter` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAbstractLogWriter.java`
#### Snippet
```java

    protected synchronized void cacheLogWriter(BKLogSegmentWriter logWriter) {
        this.segmentWriter = logWriter;
        this.segmentWriterFuture = FutureUtils.value(logWriter);
    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.segmentWriterFuture` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAbstractLogWriter.java`
#### Snippet
```java
    protected synchronized void cacheLogWriter(BKLogSegmentWriter logWriter) {
        this.segmentWriter = logWriter;
        this.segmentWriterFuture = FutureUtils.value(logWriter);
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.allocatedSegmentWriter` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAbstractLogWriter.java`
#### Snippet
```java

    protected synchronized void cacheAllocatedLogWriter(BKLogSegmentWriter logWriter) {
        this.allocatedSegmentWriter = logWriter;
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `writeHandler` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAbstractLogWriter.java`
#### Snippet
```java

    protected synchronized BKLogWriteHandler getCachedWriteHandler() {
        return writeHandler;
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `closeFuture` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAsyncLogReader.java`
#### Snippet
```java
    public synchronized void scheduleBackgroundRead() {
        // if the reader is already closed, we don't need to schedule background read again.
        if (null != closeFuture) {
            return;
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `closeFuture` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAsyncLogReader.java`
#### Snippet
```java
        CompletableFuture<Void> closePromise;
        synchronized (this) {
            if (null != closeFuture) {
                return closeFuture;
            }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `closeFuture` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAsyncLogReader.java`
#### Snippet
```java
        synchronized (this) {
            if (null != closeFuture) {
                return closeFuture;
            }
            closePromise = closeFuture = new CompletableFuture<Void>();
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `closeFuture` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAsyncLogReader.java`
#### Snippet
```java
                return closeFuture;
            }
            closePromise = closeFuture = new CompletableFuture<Void>();
            exception = new ReadCancelledException(readHandler.getFullyQualifiedName(), "Reader was closed");
            setLastException(exception);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lastNotifiedLogSegments` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogReadHandler.java`
#### Snippet
```java
    public void onSegmentsUpdated(final Versioned<List<String>> segments) {
        synchronized (this) {
            if (lastNotifiedLogSegments.getVersion() != Version.NEW
                    && lastNotifiedLogSegments.getVersion().compare(segments.getVersion()) != Version.Occurred.BEFORE) {
                // the log segments has been read, and it is possibly a retry from last segments update
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lastNotifiedLogSegments` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogReadHandler.java`
#### Snippet
```java
        synchronized (this) {
            if (lastNotifiedLogSegments.getVersion() != Version.NEW
                    && lastNotifiedLogSegments.getVersion().compare(segments.getVersion()) != Version.Occurred.BEFORE) {
                // the log segments has been read, and it is possibly a retry from last segments update
                return;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lastNotifiedLogSegments` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogReadHandler.java`
#### Snippet
```java
                List<LogSegmentMetadata> segmentsToNotify = null;
                synchronized (BKLogReadHandler.this) {
                    Versioned<List<LogSegmentMetadata>> lastLogSegments = lastNotifiedLogSegments;
                    if (lastLogSegments.getVersion() == Version.NEW
                            || lastLogSegments.getVersion().compare(logSegments.getVersion())
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lastNotifiedLogSegments` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogReadHandler.java`
#### Snippet
```java
                            || lastLogSegments.getVersion().compare(logSegments.getVersion())
                            == Version.Occurred.BEFORE) {
                        lastNotifiedLogSegments = logSegments;
                        segmentsToNotify = logSegments.getValue();
                    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `enablePermits` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/zk/LimitedPermitManager.java`
#### Snippet
```java
    @Override
    public synchronized Permit acquirePermit() {
        if (!enablePermits) {
            return new EpochPermit(PermitState.DISABLED, epochUpdater.get(this));
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.enablePermits` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/zk/LimitedPermitManager.java`
#### Snippet
```java
        int epoch = epochUpdater.getAndIncrement(this);
        if (epoch == ((EpochPermit) permit).getEpoch()) {
            this.enablePermits = false;
            LOG.info("EnablePermits = {}, Epoch = {}.", this.enablePermits, epoch);
            return true;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.enablePermits` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/zk/LimitedPermitManager.java`
#### Snippet
```java
        if (epoch == ((EpochPermit) permit).getEpoch()) {
            this.enablePermits = false;
            LOG.info("EnablePermits = {}, Epoch = {}.", this.enablePermits, epoch);
            return true;
        } else {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.enablePermits` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/zk/LimitedPermitManager.java`
#### Snippet
```java
    synchronized void forceSetAllowPermits(boolean allowPermits) {
        int epoch = epochUpdater.getAndIncrement(this);
        this.enablePermits = allowPermits;
        LOG.info("EnablePermits = {}, Epoch = {}.", this.enablePermits, epoch);
    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.enablePermits` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/zk/LimitedPermitManager.java`
#### Snippet
```java
        int epoch = epochUpdater.getAndIncrement(this);
        this.enablePermits = allowPermits;
        LOG.info("EnablePermits = {}, Epoch = {}.", this.enablePermits, epoch);
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lastLedgerRollingTimeMillis` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogWriteHandler.java`
#### Snippet
```java
                    // if lastLedgerRollingTimeMillis is not updated, we set it to now.
                    synchronized (BKLogWriteHandler.this) {
                        if (lastLedgerRollingTimeMillis < 0) {
                            lastLedgerRollingTimeMillis = Utils.nowInMillis();
                        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `lastLedgerRollingTimeMillis` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogWriteHandler.java`
#### Snippet
```java
                    synchronized (BKLogWriteHandler.this) {
                        if (lastLedgerRollingTimeMillis < 0) {
                            lastLedgerRollingTimeMillis = Utils.nowInMillis();
                        }
                    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `closePromise` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/ZKMetadataAccessor.java`
#### Snippet
```java
        CompletableFuture<Void> closeFuture;
        synchronized (this) {
            if (null != closePromise) {
                return closePromise;
            }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `closePromise` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/ZKMetadataAccessor.java`
#### Snippet
```java
        synchronized (this) {
            if (null != closePromise) {
                return closePromise;
            }
            closeFuture = closePromise = new CompletableFuture<Void>();
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `closePromise` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/ZKMetadataAccessor.java`
#### Snippet
```java
                return closePromise;
            }
            closeFuture = closePromise = new CompletableFuture<Void>();
        }
        // NOTE: ownWriterZKC and ownReaderZKC are mostly used by tests
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `closePromise` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/ZKMetadataAccessor.java`
#### Snippet
```java

    public synchronized void checkClosedOrInError(String operation) throws AlreadyClosedException {
        if (null != closePromise) {
            throw new AlreadyClosedException("Executing " + operation + " on already closed ZKMetadataAccessor");
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `initialized` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/BKNamespaceDriver.java`
#### Snippet
```java
                                                   String clientId,
                                                   int regionId) throws IOException {
        if (initialized) {
            return this;
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `initialized` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/BKNamespaceDriver.java`
#### Snippet
```java
        initializeOtherResources();

        initialized = true;

        LOG.info("Initialized BK namespace driver: clientId = {}, regionId = {}, federated = {}.",
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `version` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java

    private synchronized void setVersion(LongVersion newVersion) {
        Version.Occurred occurred = newVersion.compare(version);
        if (occurred == Version.Occurred.AFTER) {
            LOG.info("Ledger allocator for {} moved version from {} to {}.",
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `version` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
        if (occurred == Version.Occurred.AFTER) {
            LOG.info("Ledger allocator for {} moved version from {} to {}.",
                allocatePath, version, newVersion);
            version = newVersion;
        } else {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `version` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
            LOG.info("Ledger allocator for {} moved version from {} to {}.",
                allocatePath, version, newVersion);
            version = newVersion;
        } else {
            LOG.warn("Ledger allocator for {} received an old version {}, current version is {}.",
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `version` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
        } else {
            LOG.warn("Ledger allocator for {} received an old version {}, current version is {}.",
                allocatePath, newVersion, version);
        }
    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `phase` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
    @Override
    public synchronized void allocate() throws IOException {
        if (Phase.ERROR == phase) {
            throw new AllocationException(Phase.ERROR, "Error on ledger allocator for " + allocatePath);
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `phase` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
            throw new AllocationException(Phase.ERROR, "Error on ledger allocator for " + allocatePath);
        }
        if (Phase.HANDED_OVER == phase) {
            // issue an allocate request when ledger is already handed over.
            allocateLedger(ledgerMetadata);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `ledgerMetadata` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
        if (Phase.HANDED_OVER == phase) {
            // issue an allocate request when ledger is already handed over.
            allocateLedger(ledgerMetadata);
        }
    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `version` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java

    private synchronized LongVersion getVersion() {
        return version;
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `closeFuture` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
        CompletableFuture<Void> closePromise;
        synchronized (this) {
            if (null != closeFuture) {
                return closeFuture;
            }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `closeFuture` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
        synchronized (this) {
            if (null != closeFuture) {
                return closeFuture;
            }
            closePromise = new CompletableFuture<Void>();
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `closeFuture` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
            }
            closePromise = new CompletableFuture<Void>();
            closeFuture = closePromise;
        }
        if (!cleanup) {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `phase` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
        LedgerHandle lhToNotify = null;
        synchronized (this) {
            if (Phase.HANDING_OVER == phase) {
                setPhase(Phase.HANDED_OVER);
                setVersion(zkVersion);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `tryObtainListener` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
                setPhase(Phase.HANDED_OVER);
                setVersion(zkVersion);
                listenerToNotify = tryObtainListener;
                lhToNotify = allocatedLh;
                // reset the state
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `allocatedLh` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
                setVersion(zkVersion);
                listenerToNotify = tryObtainListener;
                lhToNotify = allocatedLh;
                // reset the state
                allocatedLh = null;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `allocatedLh` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
                lhToNotify = allocatedLh;
                // reset the state
                allocatedLh = null;
                allocatePromise = null;
                tryObtainTxn = null;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `allocatePromise` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
                // reset the state
                allocatedLh = null;
                allocatePromise = null;
                tryObtainTxn = null;
                tryObtainListener = null;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `tryObtainTxn` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
                allocatedLh = null;
                allocatePromise = null;
                tryObtainTxn = null;
                tryObtainListener = null;
                // mark flag to issue an allocation request
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `tryObtainListener` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
                allocatePromise = null;
                tryObtainTxn = null;
                tryObtainListener = null;
                // mark flag to issue an allocation request
                shouldAllocate = true;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `allocatePromise` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java

    private synchronized void failAllocation(Throwable cause) {
        allocatePromise.completeExceptionally(cause);
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `phase` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
    private synchronized void allocateLedger(LedgerMetadata ledgerMetadata) {
        // make sure previous allocation is already handed over.
        if (Phase.HANDED_OVER != phase) {
            LOG.error("Trying allocate ledger for {} in phase {}, giving up.", allocatePath, phase);
            return;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `phase` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
        // make sure previous allocation is already handed over.
        if (Phase.HANDED_OVER != phase) {
            LOG.error("Trying allocate ledger for {} in phase {}, giving up.", allocatePath, phase);
            return;
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `allocatePromise` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
        }
        setPhase(Phase.ALLOCATING);
        allocatePromise = new CompletableFuture<LedgerHandle>();
        QuorumConfig quorumConfig = quorumConfigProvider.getQuorumConfig();
        bkc.createLedger(
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `closeFuture` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java

    private synchronized boolean isClosing() {
        return closeFuture != null;
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `ledgerIdLeftFromPrevAllocation` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java

    private synchronized void deleteLedgerLeftFromPreviousAllocationIfNecessary() {
        if (null != ledgerIdLeftFromPrevAllocation) {
            LOG.info("Deleting allocated-but-unused ledger left from previous allocation {}.",
                    ledgerIdLeftFromPrevAllocation);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `ledgerIdLeftFromPrevAllocation` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
        if (null != ledgerIdLeftFromPrevAllocation) {
            LOG.info("Deleting allocated-but-unused ledger left from previous allocation {}.",
                    ledgerIdLeftFromPrevAllocation);
            deleteLedger(ledgerIdLeftFromPrevAllocation);
            ledgerIdLeftFromPrevAllocation = null;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `ledgerIdLeftFromPrevAllocation` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
            LOG.info("Deleting allocated-but-unused ledger left from previous allocation {}.",
                    ledgerIdLeftFromPrevAllocation);
            deleteLedger(ledgerIdLeftFromPrevAllocation);
            ledgerIdLeftFromPrevAllocation = null;
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `ledgerIdLeftFromPrevAllocation` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
                    ledgerIdLeftFromPrevAllocation);
            deleteLedger(ledgerIdLeftFromPrevAllocation);
            ledgerIdLeftFromPrevAllocation = null;
        }
    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `tryObtainListener` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
        OpListener<LedgerHandle> listenerToNotify;
        synchronized (this) {
            listenerToNotify = tryObtainListener;
            if (t instanceof KeeperException
                    && ((KeeperException) t).code() == KeeperException.Code.BADVERSION) {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `phase` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
                setPhase(Phase.ERROR);
            } else {
                if (Phase.HANDING_OVER == phase) {
                    setPhase(Phase.ALLOCATED);
                    tryObtainTxn = null;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `tryObtainTxn` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
                if (Phase.HANDING_OVER == phase) {
                    setPhase(Phase.ALLOCATED);
                    tryObtainTxn = null;
                    tryObtainListener = null;
                }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `tryObtainListener` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
                    setPhase(Phase.ALLOCATED);
                    tryObtainTxn = null;
                    tryObtainListener = null;
                }
            }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `phase` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
    public synchronized CompletableFuture<LedgerHandle> tryObtain(final Transaction<Object> txn,
                                                                  final OpListener<LedgerHandle> listener) {
        if (Phase.ERROR == phase) {
            return FutureUtils.exception(new AllocationException(Phase.ERROR,
                    "Error on allocating ledger under " + allocatePath));
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `phase` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
                    "Error on allocating ledger under " + allocatePath));
        }
        if (Phase.HANDING_OVER == phase || Phase.HANDED_OVER == phase || null != tryObtainTxn) {
            return FutureUtils.exception(new ConcurrentObtainException(phase,
                    "Ledger handle is handling over to another thread : " + phase));
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `phase` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
                    "Error on allocating ledger under " + allocatePath));
        }
        if (Phase.HANDING_OVER == phase || Phase.HANDED_OVER == phase || null != tryObtainTxn) {
            return FutureUtils.exception(new ConcurrentObtainException(phase,
                    "Ledger handle is handling over to another thread : " + phase));
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `tryObtainTxn` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
                    "Error on allocating ledger under " + allocatePath));
        }
        if (Phase.HANDING_OVER == phase || Phase.HANDED_OVER == phase || null != tryObtainTxn) {
            return FutureUtils.exception(new ConcurrentObtainException(phase,
                    "Ledger handle is handling over to another thread : " + phase));
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `phase` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
        }
        if (Phase.HANDING_OVER == phase || Phase.HANDED_OVER == phase || null != tryObtainTxn) {
            return FutureUtils.exception(new ConcurrentObtainException(phase,
                    "Ledger handle is handling over to another thread : " + phase));
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `phase` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
        if (Phase.HANDING_OVER == phase || Phase.HANDED_OVER == phase || null != tryObtainTxn) {
            return FutureUtils.exception(new ConcurrentObtainException(phase,
                    "Ledger handle is handling over to another thread : " + phase));
        }
        tryObtainTxn = txn;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `tryObtainTxn` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
                    "Ledger handle is handling over to another thread : " + phase));
        }
        tryObtainTxn = txn;
        tryObtainListener = listener;
        if (null != allocatedLh) {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `tryObtainListener` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
        }
        tryObtainTxn = txn;
        tryObtainListener = listener;
        if (null != allocatedLh) {
            completeAllocation(allocatedLh);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `allocatedLh` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
        tryObtainTxn = txn;
        tryObtainListener = listener;
        if (null != allocatedLh) {
            completeAllocation(allocatedLh);
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `allocatedLh` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
        tryObtainListener = listener;
        if (null != allocatedLh) {
            completeAllocation(allocatedLh);
        }
        return allocatePromise;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `allocatePromise` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
            completeAllocation(allocatedLh);
        }
        return allocatePromise;
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `allocatedLh` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java

    private synchronized void completeAllocation(LedgerHandle lh) {
        allocatedLh = lh;
        if (null == tryObtainTxn) {
            return;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `tryObtainTxn` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
    private synchronized void completeAllocation(LedgerHandle lh) {
        allocatedLh = lh;
        if (null == tryObtainTxn) {
            return;
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `version` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
        }
        org.apache.zookeeper.Op zkSetDataOp = org.apache.zookeeper.Op.setData(
                allocatePath, DistributedLogConstants.EMPTY_BYTES, (int) version.getLongVersion());
        ZKVersionedSetOp commitOp = new ZKVersionedSetOp(zkSetDataOp, this);
        tryObtainTxn.addOp(commitOp);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `tryObtainTxn` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
                allocatePath, DistributedLogConstants.EMPTY_BYTES, (int) version.getLongVersion());
        ZKVersionedSetOp commitOp = new ZKVersionedSetOp(zkSetDataOp, this);
        tryObtainTxn.addOp(commitOp);
        setPhase(Phase.HANDING_OVER);
        allocatePromise.complete(lh);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `allocatePromise` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
        tryObtainTxn.addOp(commitOp);
        setPhase(Phase.HANDING_OVER);
        allocatePromise.complete(lh);
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.phase` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java

    private synchronized void setPhase(Phase phase) {
        this.phase = phase;
        LOG.info("Ledger allocator {} moved to phase {} : version = {}.",
            allocatePath, phase, version);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `version` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
        this.phase = phase;
        LOG.info("Ledger allocator {} moved to phase {} : version = {}.",
            allocatePath, phase, version);
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `cachedEntries` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/logsegment/BKLogSegmentEntryReader.java`
#### Snippet
```java
        List<CacheEntry> entriesToFetch;
        synchronized (this) {
            if (cachedEntries >= maxPrefetchEntries) {
                return;
            }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `numOutstandingEntries` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/logsegment/BKLogSegmentEntryReader.java`
#### Snippet
```java
            }
            // we don't have enough entries, do prefetch
            int numEntriesToFetch = numPrefetchEntries - numOutstandingEntries;
            if (numEntriesToFetch <= 0) {
                return;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `cachedEntries` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/logsegment/BKLogSegmentEntryReader.java`
#### Snippet
```java
            entriesToFetch = new ArrayList<CacheEntry>(numEntriesToFetch);
            for (int i = 0; i < numEntriesToFetch; i++) {
                if (cachedEntries >= maxPrefetchEntries) {
                    break;
                }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `numOutstandingEntries` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/logsegment/BKLogSegmentEntryReader.java`
#### Snippet
```java
                entriesToFetch.add(entry);
                readAheadEntries.add(entry);
                ++numOutstandingEntries;
                ++cachedEntries;
                ++nextEntryId;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `cachedEntries` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/logsegment/BKLogSegmentEntryReader.java`
#### Snippet
```java
                readAheadEntries.add(entry);
                ++numOutstandingEntries;
                ++cachedEntries;
                ++nextEntryId;
            }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `numOutstandingEntries` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/logsegment/BKLogSegmentEntryReader.java`
#### Snippet
```java
        // we successfully read an entry
        synchronized (this) {
            --numOutstandingEntries;
        }
        // notify reader that there is entry ready
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `cachedEntries` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/logsegment/BKLogSegmentEntryReader.java`
#### Snippet
```java
    private void onEntriesConsumed(int numEntries) {
        synchronized (this) {
            cachedEntries -= numEntries;
        }
        prefetchIfNecessary();
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `logsFuture` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/federated/FederatedZKLogMetadataStore.java`
#### Snippet
```java

        synchronized CompletableFuture<Set<String>> getLogs() {
            return logsFuture;
        }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `logsFuture` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/federated/FederatedZKLogMetadataStore.java`
#### Snippet
```java
            CompletableFuture<Set<String>> newLogsPromise;
            synchronized (this) {
                if (logsFuture.isDone()) { // the promise is already satisfied
                    try {
                        oldLogs = FutureUtils.result(logsFuture);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `logsFuture` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/federated/FederatedZKLogMetadataStore.java`
#### Snippet
```java
                if (logsFuture.isDone()) { // the promise is already satisfied
                    try {
                        oldLogs = FutureUtils.result(logsFuture);
                    } catch (Exception e) {
                        logger.error("Unexpected exception when getting logs from a satisified future of {} : ",
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `logsFuture` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/federated/FederatedZKLogMetadataStore.java`
#### Snippet
```java
                                uri, e);
                    }
                    logsFuture = new CompletableFuture<Set<String>>();
                }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `logsFuture` accessed in synchronized context
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/federated/FederatedZKLogMetadataStore.java`
#### Snippet
```java
                    log2Locations.remove(logName, uri);
                }
                newLogsPromise = logsFuture;
            }
            newLogsPromise.complete(newLogs);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `complete` accessed in synchronized context
in `bookkeeper-benchmark/src/main/java/org/apache/bookkeeper/benchmark/BenchBookie.java`
#### Snippet
```java
        }
        public synchronized void resetComplete() {
            complete = false;
        }
        public synchronized void waitForComplete() throws InterruptedException {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `count` accessed in synchronized context
in `bookkeeper-benchmark/src/main/java/org/apache/bookkeeper/benchmark/BenchBookie.java`
#### Snippet
```java
                LOG.error("Got error " + rc);
            }
            count++;
            if (count >= waitingCount) {
                notifyAll();
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `count` accessed in synchronized context
in `bookkeeper-benchmark/src/main/java/org/apache/bookkeeper/benchmark/BenchBookie.java`
#### Snippet
```java
            }
            count++;
            if (count >= waitingCount) {
                notifyAll();
            }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `waitingCount` accessed in synchronized context
in `bookkeeper-benchmark/src/main/java/org/apache/bookkeeper/benchmark/BenchBookie.java`
#### Snippet
```java
            }
            count++;
            if (count >= waitingCount) {
                notifyAll();
            }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.count` accessed in synchronized context
in `bookkeeper-benchmark/src/main/java/org/apache/bookkeeper/benchmark/BenchBookie.java`
#### Snippet
```java
        }
        public synchronized void waitFor(int count) throws InterruptedException {
            while (this.count < count) {
                waitingCount = count;
                wait(1000);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `waitingCount` accessed in synchronized context
in `bookkeeper-benchmark/src/main/java/org/apache/bookkeeper/benchmark/BenchBookie.java`
#### Snippet
```java
        public synchronized void waitFor(int count) throws InterruptedException {
            while (this.count < count) {
                waitingCount = count;
                wait(1000);
            }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `waitingCount` accessed in synchronized context
in `bookkeeper-benchmark/src/main/java/org/apache/bookkeeper/benchmark/BenchBookie.java`
#### Snippet
```java
                wait(1000);
            }
            waitingCount = Integer.MAX_VALUE;
        }
    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `complete` accessed in synchronized context
in `bookkeeper-benchmark/src/main/java/org/apache/bookkeeper/benchmark/BenchBookie.java`
#### Snippet
```java
                LOG.error("Got error " + rc);
            }
            complete = true;
            notifyAll();
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `complete` accessed in synchronized context
in `bookkeeper-benchmark/src/main/java/org/apache/bookkeeper/benchmark/BenchBookie.java`
#### Snippet
```java
        }
        public synchronized void waitForComplete() throws InterruptedException {
            while (!complete) {
                wait();
            }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `duration` accessed in synchronized context
in `bookkeeper-benchmark/src/main/java/org/apache/bookkeeper/benchmark/BenchThroughputLatency.java`
#### Snippet
```java
    long duration = -1;
    public synchronized long getDuration() {
        return duration;
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `duration` accessed in synchronized context
in `bookkeeper-benchmark/src/main/java/org/apache/bookkeeper/benchmark/BenchThroughputLatency.java`
#### Snippet
```java
        }
        synchronized (this) {
            duration = System.currentTimeMillis() - start;
        }
        throughput = sent * 1000 / getDuration();
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `isInitialized` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVAsyncStore.java`
#### Snippet
```java
    public CompletableFuture<Void> put(K key, V value) {
        synchronized (this) {
            if (!isInitialized) {
                return uninitializedException();
            }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `isInitialized` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVAsyncStore.java`
#### Snippet
```java
    public CompletableFuture<V> get(K key) {
        synchronized (this) {
            if (!isInitialized) {
                return uninitializedException();
            }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `isInitialized` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/mvcc/MVCCAsyncBytesStoreImpl.java`
#### Snippet
```java
    public CompletableFuture<DeleteResult<byte[], byte[]>> delete(DeleteOp<byte[], byte[]> op) {
        synchronized (this) {
            if (!isInitialized) {
                return FutureUtils.exception(new InvalidStateStoreException("State store is not initialized yet."));
            }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `isInitialized` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/mvcc/MVCCAsyncBytesStoreImpl.java`
#### Snippet
```java
    public CompletableFuture<PutResult<byte[], byte[]>> put(PutOp<byte[], byte[]> op) {
        synchronized (this) {
            if (!isInitialized) {
                return FutureUtils.exception(new InvalidStateStoreException("State store is not initialized yet."));
            }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `isInitialized` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/mvcc/MVCCAsyncBytesStoreImpl.java`
#### Snippet
```java
    public CompletableFuture<TxnResult<byte[], byte[]>> txn(TxnOp<byte[], byte[]> op) {
        synchronized (this) {
            if (!isInitialized) {
                return FutureUtils.exception(new InvalidStateStoreException("State store is not initialized yet."));
            }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `isInitialized` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/mvcc/MVCCAsyncBytesStoreImpl.java`
#### Snippet
```java
    public CompletableFuture<RangeResult<byte[], byte[]>> range(RangeOp<byte[], byte[]> rangeOp) {
        synchronized (this) {
            if (!isInitialized) {
                return FutureUtils.exception(new InvalidStateStoreException("State store is not initialized yet."));
            }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `isInitialized` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/mvcc/MVCCAsyncBytesStoreImpl.java`
#### Snippet
```java
    public CompletableFuture<IncrementResult<byte[], byte[]>> increment(IncrementOp<byte[], byte[]> op) {
        synchronized (this) {
            if (!isInitialized) {
                return FutureUtils.exception(new InvalidStateStoreException("State store is not initialized yet."));
            }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.name` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
            "local state store directory is not configured");

        this.name = spec.getName();

        this.cleanupLocalStoreDirEnable = spec.isLocalStorageCleanupEnable();
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.ttlSeconds` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java

        this.cleanupLocalStoreDirEnable = spec.isLocalStorageCleanupEnable();
        this.ttlSeconds = spec.getTtlSeconds();

        // initialize the coders
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.keyCoder` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java

        // initialize the coders
        this.keyCoder = (Coder<K>) spec.getKeyCoder();
        this.valCoder = (Coder<V>) spec.getValCoder();

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.valCoder` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
        // initialize the coders
        this.keyCoder = (Coder<K>) spec.getKeyCoder();
        this.valCoder = (Coder<V>) spec.getValCoder();

        cleanupLocalStoreDir(spec.getLocalStateStoreDir());
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `dbDir` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
            checkpointer = new RocksCheckpointer(
                name(),
                dbDir,
                db,
                checkpointStore,
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `db` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
                name(),
                dbDir,
                db,
                checkpointStore,
                true,
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.isInitialized` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
        }

        this.isInitialized = true;
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.name` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
    @Override
    public synchronized String name() {
        return this.name;
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `keyCoder` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
        updateLastRevision(revision);

        byte[] keyBytes = keyCoder.encode(key);
        V oldVal = getRaw(key, keyBytes);
        if (null != oldVal) {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `keyCoder` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
        checkStoreOpen();

        byte[] keyBytes = keyCoder.encode(key);
        return getRaw(key, keyBytes);
    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `db` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
    @Override
    public synchronized void flush() throws StateStoreException {
        if (null == db) {
            return;
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `db` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
        }
        try {
            db.flush(flushOpts);
        } catch (RocksDBException e) {
            throw new StateStoreException("Exception on flushing rocksdb from store " + name, e);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `flushOpts` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
        }
        try {
            db.flush(flushOpts);
        } catch (RocksDBException e) {
            throw new StateStoreException("Exception on flushing rocksdb from store " + name, e);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `name` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
            db.flush(flushOpts);
        } catch (RocksDBException e) {
            throw new StateStoreException("Exception on flushing rocksdb from store " + name, e);
        }
    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `db` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
        checkStoreOpen();

        RocksIterator rocksIter = db.newIterator(dataCfHandle);
        if (null == from) {
            rocksIter.seekToFirst();
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `dataCfHandle` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
        checkStoreOpen();

        RocksIterator rocksIter = db.newIterator(dataCfHandle);
        if (null == from) {
            rocksIter.seekToFirst();
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `keyCoder` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
            rocksIter.seekToFirst();
        } else {
            byte[] fromBytes = keyCoder.encode(from);
            rocksIter.seek(fromBytes);
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `name` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
        KVIterator<K, V> kvIter;
        if (null == to) {
            kvIter = new RocksdbKVIterator(name, rocksIter, keyCoder, valCoder);
        } else {
            kvIter = new RocksdbRangeIterator(name, rocksIter, keyCoder, valCoder, to);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `keyCoder` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
        KVIterator<K, V> kvIter;
        if (null == to) {
            kvIter = new RocksdbKVIterator(name, rocksIter, keyCoder, valCoder);
        } else {
            kvIter = new RocksdbRangeIterator(name, rocksIter, keyCoder, valCoder, to);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `valCoder` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
        KVIterator<K, V> kvIter;
        if (null == to) {
            kvIter = new RocksdbKVIterator(name, rocksIter, keyCoder, valCoder);
        } else {
            kvIter = new RocksdbRangeIterator(name, rocksIter, keyCoder, valCoder, to);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `name` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
            kvIter = new RocksdbKVIterator(name, rocksIter, keyCoder, valCoder);
        } else {
            kvIter = new RocksdbRangeIterator(name, rocksIter, keyCoder, valCoder, to);
        }
        kvIters.add(kvIter);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `keyCoder` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
            kvIter = new RocksdbKVIterator(name, rocksIter, keyCoder, valCoder);
        } else {
            kvIter = new RocksdbRangeIterator(name, rocksIter, keyCoder, valCoder, to);
        }
        kvIters.add(kvIter);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `valCoder` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
            kvIter = new RocksdbKVIterator(name, rocksIter, keyCoder, valCoder);
        } else {
            kvIter = new RocksdbRangeIterator(name, rocksIter, keyCoder, valCoder, to);
        }
        kvIters.add(kvIter);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `closed` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
    @Override
    public synchronized void close() {
        if (closed) {
            return;
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `closed` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
            return;
        }
        closed = true;

        if (null != checkpointer) {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `dbOpts` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java

        // release options
        RocksUtils.close(dbOpts);
        RocksUtils.close(writeOpts);
        RocksUtils.close(flushOpts);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `writeOpts` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
        // release options
        RocksUtils.close(dbOpts);
        RocksUtils.close(writeOpts);
        RocksUtils.close(flushOpts);
        RocksUtils.close(cfOpts);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `flushOpts` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
        RocksUtils.close(dbOpts);
        RocksUtils.close(writeOpts);
        RocksUtils.close(flushOpts);
        RocksUtils.close(cfOpts);

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `cfOpts` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
        RocksUtils.close(writeOpts);
        RocksUtils.close(flushOpts);
        RocksUtils.close(cfOpts);

        cleanupLocalStoreDir(dbDir);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `dbDir` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
        RocksUtils.close(cfOpts);

        cleanupLocalStoreDir(dbDir);
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `writeOpts` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java

            try {
                getDb().write(writeOpts, batch);
            } catch (RocksDBException e) {
                throw new StateStoreRuntimeException("Error while executing a multi operation from store " + name, e);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `name` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
                getDb().write(writeOpts, batch);
            } catch (RocksDBException e) {
                throw new StateStoreRuntimeException("Error while executing a multi operation from store " + name, e);
            } finally {
                RocksUtils.close(batch);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `keyCoder` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
        updateLastRevision(revision);

        byte[] keyBytes = keyCoder.encode(key);
        V val = getRaw(key, keyBytes);
        putRaw(key, keyBytes, null, revision);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `keyCoder` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
        updateLastRevision(revision);

        byte[] keyBytes = keyCoder.encode(key);
        putRaw(key, keyBytes, value, revision);
    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `db` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
    @VisibleForTesting
    public synchronized RocksDB getDb() {
        return db;
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `name` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
    @Override
    public synchronized void checkpoint() {
        log.info("Checkpoint local state store {} at revision {}", name, getLastRevision());
        byte[] checkpointAtRevisionBytes = new byte[Long.BYTES];
        System.arraycopy(lastRevisionBytes, 0, checkpointAtRevisionBytes, 0, checkpointAtRevisionBytes.length);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `closeFuture` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/journal/AbstractStateStoreWithJournal.java`
#### Snippet
```java
        CompletableFuture<Void> future;
        synchronized (this) {
            if (null != closeFuture) {
                return closeFuture;
            }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `closeFuture` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/journal/AbstractStateStoreWithJournal.java`
#### Snippet
```java
        synchronized (this) {
            if (null != closeFuture) {
                return closeFuture;
            }
            closeFuture = future = FutureUtils.createFuture();
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `closeFuture` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/journal/AbstractStateStoreWithJournal.java`
#### Snippet
```java
                return closeFuture;
            }
            closeFuture = future = FutureUtils.createFuture();
        }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `closeFuture` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/journal/AbstractStateStoreWithJournal.java`
#### Snippet
```java
    private CompletableFuture<DLSN> getLastDLSN(StateStoreSpec spec) {
        synchronized (this) {
            if (null != closeFuture) {
                return FutureUtils.exception(new StateStoreClosedException(name()));
            }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `closeFuture` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/journal/AbstractStateStoreWithJournal.java`
#### Snippet
```java
    private void replayLoop(AsyncLogReader reader) {
        synchronized (this) {
            if (null != closeFuture) {
                reader.asyncClose();
                return;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `closeFuture` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/journal/AbstractStateStoreWithJournal.java`
#### Snippet
```java
    private CompletableFuture<DLSN> initializeJournalWriter(StateStoreSpec spec) {
        synchronized (this) {
            if (null != closeFuture) {
                return FutureUtils.exception(new StateStoreClosedException(name()));
            }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `closeFuture` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/journal/AbstractStateStoreWithJournal.java`
#### Snippet
```java
                                               Callable<T> callable) {
        synchronized (this) {
            if (null != closeFuture) {
                return FutureUtils.exception(new StateStoreClosedException(name()));
            }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `closeFuture` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/journal/AbstractStateStoreWithJournal.java`
#### Snippet
```java
                               CompletableFuture<Void> future) {
        synchronized (this) {
            if (null != closeFuture) {
                FutureUtils.completeExceptionally(future, new StateStoreClosedException(name()));
                return;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `isInitialized` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/journal/AbstractStateStoreWithJournal.java`
#### Snippet
```java

    private synchronized void markInitialized(AsyncLogReader reader) {
        isInitialized = true;
        // schedule periodical checkpoint
        if (null != checkpointInterval) {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `writeIOScheduler` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/journal/AbstractStateStoreWithJournal.java`
#### Snippet
```java
        if (null != checkpointInterval) {
            long checkpointIntervalMs = checkpointInterval.toMillis();
            checkpointTask = writeIOScheduler.scheduleAtFixedRate(
                () -> localStore.checkpoint(),
                checkpointIntervalMs,
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `spec` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/journal/AbstractStateStoreWithJournal.java`
#### Snippet
```java
                TimeUnit.MILLISECONDS);
        }
        if (spec.isReadonly()) {
            replayLoop(reader);
        } else {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `closeFuture` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/journal/AbstractStateStoreWithJournal.java`
#### Snippet
```java
                               long startingTxId) {
        synchronized (this) {
            if (null != closeFuture) {
                FutureUtils.completeExceptionally(future, new StateStoreClosedException(name()));
                return;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `keyCoder` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/mvcc/MVCCStoreImpl.java`
#### Snippet
```java

        // raw key
        byte[] rawKey = (null != key) ? keyCoder.encode(key) : NULL_START_KEY;
        byte[] rawEndKey = NULL_END_KEY;
        if (null == endKey) {
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `valCoder` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/mvcc/MVCCStoreImpl.java`
#### Snippet
```java
                        recordFactory,
                        key,
                        valCoder)));
                }
                result.more(false);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `keyCoder` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/mvcc/MVCCStoreImpl.java`
#### Snippet
```java
            }
        } else {
            rawEndKey = keyCoder.encode(endKey);
        }
        Pair<byte[], byte[]> realRange = getRealRange(rawKey, rawEndKey);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `name` accessed in synchronized context
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/mvcc/MVCCStoreImpl.java`
#### Snippet
```java
                if (Code.OK != result.code()) {
                    throw new MVCCStoreException(result.code(),
                        "Failed to retrieve key from store " + name + " : code = " + result.code());
                }
                if (result.count() <= 0) {
```

## RuleId[id=RedundantSuppression]
### RedundantSuppression
Redundant suppression
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/conf/ConfigDef.java`
#### Snippet
```java
     */
    @SuppressWarnings("unchecked")
    public static ConfigDef of(Class configClass) {
        ConfigDef.Builder builder = ConfigDef.builder();

```

### RedundantSuppression
Redundant suppression
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/conf/ConfigKey.java`
#### Snippet
```java
     */
    @SuppressWarnings("unchecked")
    public Class<?> getClass(Configuration conf) {
        checkArgument(type() == Type.CLASS, "'" + name() + "' is NOT a CLASS setting");
        try {
```

### RedundantSuppression
Redundant suppression
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/ReflectionUtils.java`
#### Snippet
```java
     */
    @SuppressWarnings("unchecked")
    public static <T> T newInstance(String clsName, Class<T> xface) {
        Class<?> theCls;
        try {
```

### RedundantSuppression
Redundant suppression
in `bookkeeper-http/servlet-http-server/src/main/java/org/apache/bookkeeper/http/servlet/BookieHttpServiceServlet.java`
#### Snippet
```java
   */
  @SuppressWarnings("unchecked")
  Map<String, String> httpServletParams(HttpServletRequest request) {
    Map<String, String> map = new HashMap<>();
    for (Enumeration<String> param = request.getParameterNames();
```

### RedundantSuppression
Redundant suppression
in `bookkeeper-http/vertx-http-server/src/main/java/org/apache/bookkeeper/http/vertx/VertxAbstractHandler.java`
#### Snippet
```java
     */
    @SuppressWarnings("unchecked")
    Map<String, String> convertParams(HttpServerRequest request) {
        Map<String, String> map = new HashMap<>();
        Iterator<Map.Entry<String, String>> iterator = request.params().iterator();
```

### RedundantSuppression
Redundant suppression
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryLogManagerForEntryLogPerLedger.java`
#### Snippet
```java
            }
        }
        @SuppressWarnings("unchecked")
        Optional<Entry<File, MutableInt>> ledgerDirWithLeastNumofCurrentLogs = writableLedgerDirFrequency.entrySet()
                .stream().min(Map.Entry.comparingByValue());
        return ledgerDirWithLeastNumofCurrentLogs.get().getKey();
    }
```

### RedundantSuppression
Redundant suppression
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeper.java`
#### Snippet
```java
    @SuppressWarnings("deprecation")
    @VisibleForTesting
    BookKeeper(ClientConfiguration conf,
                       ZooKeeper zkc,
                       EventLoopGroup eventLoopGroup,
```

### RedundantSuppression
Redundant suppression
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeperAdmin.java`
#### Snippet
```java
     */
    @SuppressWarnings("unchecked")
    public LedgerHandle openLedgerNoRecovery(final long lId)
            throws InterruptedException, BKException {
        CompletableFuture<LedgerHandle> future = new CompletableFuture<>();
```

### RedundantSuppression
Redundant suppression
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeperAdmin.java`
#### Snippet
```java
        @Override
        @SuppressWarnings("unchecked")
        public void processResult(int rc, String s, Object ctx) {
            SyncCallbackUtils.finish(rc, null, sync);
        }
```

### RedundantSuppression
Redundant suppression
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookieInfoReader.java`
#### Snippet
```java

        @SuppressWarnings("unchecked")
        public Collection<BookieId> getPartialScanTargets() {
            return CollectionUtils.subtract(mostRecentlyReportedBookies, infoMap.keySet());
        }
```

### RedundantSuppression
Redundant suppression
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/DefaultEnsemblePlacementPolicy.java`
#### Snippet
```java
                    this.bookieInfoMap.remove(b);
                }
                @SuppressWarnings("unchecked")
                Collection<BookieId> newBookies = CollectionUtils.subtract(writableBookies, knownBookies);
                for (BookieId b : newBookies) {
                    this.bookieInfoMap.put(b, new BookieInfo());
```

### RedundantSuppression
Redundant suppression
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/AbstractConfiguration.java`
#### Snippet
```java
     */
    @SuppressWarnings("unchecked")
    public void loadConf(URL confURL) throws ConfigurationException {
        PropertiesConfiguration loadedConf = new PropertiesConfiguration(confURL);
        for (Iterator<String> iter = loadedConf.getKeys(); iter.hasNext(); ) {
```

### RedundantSuppression
Redundant suppression
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/AbstractConfiguration.java`
#### Snippet
```java
     */
    @SuppressWarnings("unchecked")
    public void loadConf(CompositeConfiguration baseConf) {
        for (Iterator<String> iter = baseConf.getKeys(); iter.hasNext(); ) {
            String key = iter.next();
```

### RedundantSuppression
Redundant suppression
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/ClientConfiguration.java`
#### Snippet
```java
     */
    @SuppressWarnings("deprecation")
    public int getAddEntryTimeout() {
        return getInt(ADD_ENTRY_TIMEOUT_SEC, getReadTimeout());
    }
```

### RedundantSuppression
Redundant suppression
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/ClientConfiguration.java`
#### Snippet
```java
     */
    @SuppressWarnings("deprecation")
    public int getReadEntryTimeout() {
        return getInt(READ_ENTRY_TIMEOUT_SEC, getReadTimeout());
    }
```

### RedundantSuppression
Redundant suppression
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/discover/ZKRegistrationClient.java`
#### Snippet
```java
    @SuppressWarnings("unchecked")
    @VisibleForTesting
    static BookieServiceInfo deserializeBookieServiceInfo(BookieId bookieId, byte[] bookieServiceInfo)
            throws IOException {
        if (bookieServiceInfo == null || bookieServiceInfo.length == 0) {
```

### RedundantSuppression
Redundant suppression
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/AbstractZkLedgerManagerFactory.java`
#### Snippet
```java
    @SuppressWarnings("deprecation")
    @Override
    public void format(AbstractConfiguration<?> conf, LayoutManager layoutManager)
            throws InterruptedException, KeeperException, IOException {
        try (AbstractZkLedgerManager ledgerManager = (AbstractZkLedgerManager) newLedgerManager()) {
```

### RedundantSuppression
Redundant suppression
in `stats/bookkeeper-stats-providers/codahale-metrics-provider/src/main/java/org/apache/bookkeeper/stats/codahale/CodahaleMetricsProvider.java`
#### Snippet
```java
 */
@SuppressWarnings("deprecation")
public class CodahaleMetricsProvider implements StatsProvider {

    static final Logger LOG = LoggerFactory.getLogger(CodahaleMetricsProvider.class);
```

### RedundantSuppression
Redundant suppression
in `stats/bookkeeper-stats-providers/codahale-metrics-provider/src/main/java/org/apache/bookkeeper/stats/codahale/FastCodahaleMetricsProvider.java`
#### Snippet
```java
 */
@SuppressWarnings("deprecation")
public class FastCodahaleMetricsProvider extends CodahaleMetricsProvider {

    @Override
```

### RedundantSuppression
Redundant suppression
in `stream/bk-grpc-name-resolver/src/main/java/org/apache/bookkeeper/grpc/resolver/BKRegistrationNameResolverProvider.java`
#### Snippet
```java
// finalizes their API.
@Slf4j
public class BKRegistrationNameResolverProvider extends NameResolverFactoryProvider {

    @Override
```

### RedundantSuppression
Redundant suppression
in `stream/clients/java/base/src/main/java/org/apache/bookkeeper/clients/impl/channel/StorageServerChannel.java`
#### Snippet
```java
     */
    @SuppressWarnings("deprecation")
    public StorageServerChannel(Endpoint endpoint,
                                Optional<String> token,
                                boolean usePlainText,
```

### RedundantSuppression
Redundant suppression
in `stream/clients/java/base/src/main/java/org/apache/bookkeeper/clients/impl/internal/LocationClientImpl.java`
#### Snippet
```java

    @SuppressWarnings("deprecation")
    public LocationClientImpl(StorageClientSettings settings,
                              OrderedScheduler scheduler) {
        this.settings = settings;
```

### RedundantSuppression
Redundant suppression
in `stream/distributedlog/common/src/main/java/org/apache/distributedlog/common/config/ConcurrentBaseConfiguration.java`
#### Snippet
```java
 */
@SuppressWarnings("unchecked")
public class ConcurrentBaseConfiguration extends ConcurrentConfiguration {
}

```

### RedundantSuppression
Redundant suppression
in `stream/distributedlog/common/src/main/java/org/apache/distributedlog/common/config/ConcurrentConstConfiguration.java`
#### Snippet
```java
 */
@SuppressWarnings("unchecked")
public class ConcurrentConstConfiguration extends ConcurrentBaseConfiguration {
    public ConcurrentConstConfiguration(Configuration conf) {
        checkNotNull(conf);
```

### RedundantSuppression
Redundant suppression
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/config/DynamicDistributedLogConfiguration.java`
#### Snippet
```java
 */
@SuppressWarnings("unchecked")
public class DynamicDistributedLogConfiguration extends ConcurrentBaseConfiguration {

    private final ConcurrentBaseConfiguration defaultConfig;
```

## RuleId[id=UnnecessaryInitCause]
### UnnecessaryInitCause
Unnecessary `Throwable.initCause()` call
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookies/RecoverCommand.java`
#### Snippet
```java
            } else {
                BKException bke = new BKException.MetaStoreException();
                bke.initCause(bke);
                throw bke;
            }
```

### UnnecessaryInitCause
Unnecessary `Throwable.initCause()` call
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/api/BKException.java`
#### Snippet
```java
        } else {
            BKException ex = new BKException(Code.UnexpectedConditionException);
            ex.initCause(cause);
            return ex;
        }
```

### UnnecessaryInitCause
Unnecessary `Throwable.initCause()` call
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/streaming/LedgerInputStream.java`
#### Snippet
```java
            } catch (BKException bk) {
                IOException ie = new IOException(bk.getMessage());
                ie.initCause(bk);
                throw ie;
            } catch (InterruptedException ie) {
```

## RuleId[id=NonStrictComparisonCanBeEquality]
### NonStrictComparisonCanBeEquality
Can be replaced with equality
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/ZkLedgerAuditorManager.java`
#### Snippet
```java

                List<String> children = zkc.getChildren(getVotePath(""), false);
                if (0 >= children.size()) {
                    throw new IllegalArgumentException(
                            "At least one bookie server should present to elect the Auditor!");
```

### NonStrictComparisonCanBeEquality
Can be replaced with equality
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieShell.java`
#### Snippet
```java
            ReadLogMetadataCommand.ReadLogMetadataFlags flags = new ReadLogMetadataCommand.ReadLogMetadataFlags();
            String[] leftArgs = cmdLine.getArgs();
            if (leftArgs.length <= 0) {
                LOG.error("ERROR: missing entry log id or entry log file name");
                printUsage();
```

### NonStrictComparisonCanBeEquality
Can be replaced with equality
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieShell.java`
#### Snippet
```java
        public int runCmd(CommandLine cmdLine) throws Exception {
            String[] leftArgs = cmdLine.getArgs();
            if (leftArgs.length <= 0) {
                System.err.println("ERROR: missing entry log id or entry log file name");
                printUsage();
```

### NonStrictComparisonCanBeEquality
Can be replaced with equality
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieShell.java`
#### Snippet
```java
    @Override
    public int run(String[] args) throws Exception {
        if (args.length <= 0) {
            printShellUsage();
            return -1;
```

### NonStrictComparisonCanBeEquality
Can be replaced with equality
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieShell.java`
#### Snippet
```java
        public int runCmd(CommandLine cmdLine) throws Exception {
            String[] leftArgs = cmdLine.getArgs();
            if (leftArgs.length <= 0) {
                System.err.println("ERROR: missing journal id or journal file name");
                printUsage();
```

### NonStrictComparisonCanBeEquality
Can be replaced with equality
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/DefaultEnsemblePlacementPolicy.java`
#### Snippet
```java
            throws BKNotEnoughBookiesException {
        ArrayList<BookieId> newBookies = new ArrayList<BookieId>(ensembleSize);
        if (ensembleSize <= 0) {
            return PlacementResult.of(newBookies, PlacementPolicyAdherence.FAIL);
        }
```

### NonStrictComparisonCanBeEquality
Can be replaced with equality
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/Etcd64bitIdGenerator.java`
#### Snippet
```java
        txn.commit()
            .thenAccept(txnResponse -> {
                if (txnResponse.getGetResponses().size() <= 0) {
                    cb.operationComplete(Code.UnexpectedConditionException, null);
                } else {
```

### NonStrictComparisonCanBeEquality
Can be replaced with equality
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeperAdmin.java`
#### Snippet
```java
    private static boolean containBookiesInLastEnsemble(LedgerMetadata lm,
                                                        Set<BookieId> bookies) {
        if (lm.getAllEnsembles().size() <= 0) {
            return false;
        }
```

### NonStrictComparisonCanBeEquality
Can be replaced with equality
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java
    String getSegmentName() {
        String[] parts = this.zkPath.split("/");
        if (parts.length <= 0) {
            throw new IllegalStateException("ZK Path is not valid");
        }
```

### NonStrictComparisonCanBeEquality
Can be replaced with equality
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/net/DNSResolverForRacks.java`
#### Snippet
```java
    protected String resolveToNetworkLocation(String domainName) {
        String[] parts = domainName.split("\\.");
        if (parts.length <= 0) {
            return DEFAULT_RACK;
        }
```

### NonStrictComparisonCanBeEquality
Can be replaced with equality
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/net/DNSResolverForRows.java`
#### Snippet
```java
    protected String resolveToNetworkLocation(String domainName) {
        String[] parts = domainName.split("\\.");
        if (parts.length <= 0) {
            return DEFAULT_ROW;
        }
```

### NonStrictComparisonCanBeEquality
Can be replaced with equality
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/federated/FederatedZKLogMetadataStore.java`
#### Snippet
```java
    private String getNamespaceFromZkPath(String zkPath) throws UnexpectedException {
        String[] parts = zkPath.split(SUB_NAMESPACE_PREFIX);
        if (parts.length <= 0) {
            throw new UnexpectedException("Invalid namespace @ " + zkPath);
        }
```

### NonStrictComparisonCanBeEquality
Can be replaced with equality
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/util/DLUtils.java`
#### Snippet
```java
            }
        }
        if (found <= -1) {
            return -1;
        }
```

### NonStrictComparisonCanBeEquality
Can be replaced with equality
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/Tool.java`
#### Snippet
```java
    public static void main(String[] args) {
        int rc = -1;
        if (args.length <= 0) {
            System.err.println("No tool to run.");
            System.err.println();
```

### NonStrictComparisonCanBeEquality
Can be replaced with equality
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/Tool.java`
#### Snippet
```java

    public int run(String[] args) throws Exception {
        if (args.length <= 0) {
            printToolUsage();
            return -1;
```

### NonStrictComparisonCanBeEquality
Can be replaced with equality
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
        protected int runCmd(CommandLine cmdline) throws Exception {
            String[] args = cmdline.getArgs();
            if (args.length <= 0) {
                System.err.println("No distributedlog uri specified.");
                printUsage();
```

### NonStrictComparisonCanBeEquality
Can be replaced with equality
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
            }
            String[] args = cmdline.getArgs();
            if (args.length <= 0) {
                System.err.println("No distributedlog uri specified.");
                printUsage();
```

### NonStrictComparisonCanBeEquality
Can be replaced with equality
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/RocksCheckpointer.java`
#### Snippet
```java
        String dbPrefix, CheckpointStore checkpointStore) {
        List<CheckpointInfo> checkpoints = getCheckpoints(dbPrefix, checkpointStore);
        if (checkpoints.size() <= 0) {
            // Even if there are not checkpoints available, there should be a
            // nullCheckpoint in the list
```

## RuleId[id=OptionalUsedAsFieldOrParameterType]
### OptionalUsedAsFieldOrParameterType
`Optional` used as type for parameter 'token'
in `stream/clients/java/base/src/main/java/org/apache/bookkeeper/clients/impl/channel/StorageServerChannel.java`
#### Snippet
```java
    @VisibleForTesting
    public StorageServerChannel(ManagedChannel channel,
                                Optional<String> token) {
        this((Channel) channel, token);
    }
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for parameter 'token'
in `stream/clients/java/base/src/main/java/org/apache/bookkeeper/clients/impl/channel/StorageServerChannel.java`
#### Snippet
```java
    @SuppressWarnings("deprecation")
    public StorageServerChannel(Endpoint endpoint,
                                Optional<String> token,
                                boolean usePlainText,
                                EndpointResolver endpointResolver) {
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for field 'token'
in `stream/clients/java/base/src/main/java/org/apache/bookkeeper/clients/impl/channel/StorageServerChannel.java`
#### Snippet
```java
    }

    private final Optional<String> token;
    private final Channel channel;
    private final StorageServerChannel interceptedServerChannel;
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for field 'interceptor'
in `stream/clients/java/base/src/main/java/org/apache/bookkeeper/clients/impl/channel/StorageServerChannel.java`
#### Snippet
```java
        return new Function<Endpoint, StorageServerChannel>() {

            private final Optional<MonitoringClientInterceptor> interceptor =
                settings.statsLogger().map(statsLogger ->
                    MonitoringClientInterceptor.create(statsLogger, true));
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for parameter 'token'
in `stream/clients/java/base/src/main/java/org/apache/bookkeeper/clients/impl/channel/StorageServerChannel.java`
#### Snippet
```java

    private StorageServerChannel(Channel channel,
                                 Optional<String> token,
                                 StorageServerChannel interceptedServerChannel) {
        this.token = token;
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for parameter 'token'
in `stream/clients/java/base/src/main/java/org/apache/bookkeeper/clients/impl/channel/StorageServerChannel.java`
#### Snippet
```java

    protected StorageServerChannel(Channel channel,
                                   Optional<String> token) {
        this(channel, token, null);
    }
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for parameter 'token'
in `stream/clients/java/base/src/main/java/org/apache/bookkeeper/clients/utils/GrpcUtils.java`
#### Snippet
```java
     * @return a configured grpc stub.
     */
    public static <T extends AbstractStub<T>> T configureGrpcStub(T stub, Optional<String> token) {
        return token.map(t -> {
            Metadata metadata = new Metadata();
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for field 'maxWaiters'
in `stream/distributedlog/common/src/main/java/org/apache/distributedlog/common/concurrent/AsyncSemaphore.java`
#### Snippet
```java
public class AsyncSemaphore {

    private final Optional<Integer> maxWaiters;

    private final Permit semaphorePermit = new Permit() {
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for field 'closed'
in `stream/distributedlog/common/src/main/java/org/apache/distributedlog/common/concurrent/AsyncSemaphore.java`
#### Snippet
```java

    @GuardedBy("this")
    private Optional<Throwable> closed = Optional.empty();
    @GuardedBy("this")
    private final LinkedList<CompletableFuture<Permit>> waitq;
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for parameter 'maxWaiters'
in `stream/distributedlog/common/src/main/java/org/apache/distributedlog/common/concurrent/AsyncSemaphore.java`
#### Snippet
```java

    public AsyncSemaphore(int initialPermits,
                          Optional<Integer> maxWaiters) {
        this.availablePermits = initialPermits;
        this.waitq = new LinkedList<>();
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for field 'poolMxBeanOp'
in `stats/bookkeeper-stats-providers/prometheus-metrics-provider/src/main/java/org/apache/bookkeeper/stats/prometheus/PrometheusMetricsProvider.java`
#### Snippet
```java
     */
    private static final AtomicLong directMemoryUsage;
    private static final Optional<BufferPoolMXBean> poolMxBeanOp;
    private static final Supplier<Double> getDirectMemoryUsage;

```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for field 'socketAddress'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/BookieSocketAddress.java`
#### Snippet
```java
    private final String hostname;
    private final int port;
    private final Optional<InetSocketAddress> socketAddress;

    // Constructor that takes in both a port.
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for parameter 'ctx'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/MetadataClientDriver.java`
#### Snippet
```java
                                    ScheduledExecutorService scheduler,
                                    StatsLogger statsLogger,
                                    Optional<Object> ctx)
        throws MetadataException;

```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for parameter 'metadataStoreCtime'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/LedgerMetadataSerDe.java`
#### Snippet
```java
    public LedgerMetadata parseConfig(byte[] bytes,
                                      long ledgerId,
                                      Optional<Long> metadataStoreCtime) throws IOException {
        if (log.isDebugEnabled()) {
            log.debug("Deserializing {}", Base64.getEncoder().encodeToString(bytes));
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for parameter 'metadataStoreCtime'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/LedgerMetadataSerDe.java`
#### Snippet
```java
    }

    private static LedgerMetadata parseVersion2Config(long ledgerId, InputStream is, Optional<Long> metadataStoreCtime)
            throws IOException {
        LedgerMetadataBuilder builder = LedgerMetadataBuilder.create()
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for parameter 'metadataStoreCtime'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/LedgerMetadataSerDe.java`
#### Snippet
```java
    }

    private static LedgerMetadata parseVersion3Config(long ledgerId, InputStream is, Optional<Long> metadataStoreCtime)
            throws IOException {
        LedgerMetadataBuilder builder = LedgerMetadataBuilder.create()
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for parameter 'optionalCtx'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/zk/ZKMetadataDriverBase.java`
#### Snippet
```java
                              StatsLogger statsLogger,
                              RetryPolicy zkRetryPolicy,
                              Optional<Object> optionalCtx) throws MetadataException {
        this.conf = conf;
        this.acls = ZkUtils.getACLs(conf);
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for parameter 'ledgerZNodeVersion'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/ZkLedgerUnderreplicationManager.java`
#### Snippet
```java
        private final Optional<Integer> ledgerZNodeVersion;

        Lock(String lockZNode, Optional<Integer> ledgerZNodeVersion) {
            this.lockZNode = lockZNode;
            this.ledgerZNodeVersion = ledgerZNodeVersion;
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for field 'ledgerZNodeVersion'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/ZkLedgerUnderreplicationManager.java`
#### Snippet
```java
    private static class Lock {
        private final String lockZNode;
        private final Optional<Integer> ledgerZNodeVersion;

        Lock(String lockZNode, Optional<Integer> ledgerZNodeVersion) {
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for field 'lacUpdateTimestamp'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/ReadLastConfirmedAndEntryContext.java`
#### Snippet
```java
    final BookieId bookie;
    long lac = LedgerHandle.INVALID_ENTRY_ID;
    Optional<Long> lacUpdateTimestamp = Optional.empty();

    public ReadLastConfirmedAndEntryContext(int bookieIndex, BookieId bookie) {
```

### OptionalUsedAsFieldOrParameterType
`Optional`> used as type for field 'blacklistedChannels'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieRequestProcessor.java`
#### Snippet
```java

    // to temporary blacklist channels
    final Optional<Cache<Channel, Boolean>> blacklistedChannels;
    final Consumer<Channel> onResponseTimeout;

```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for field 'lastAddConfirmedUpdateTime'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/LongPollReadEntryProcessorV3.java`
#### Snippet
```java

    private final Long previousLAC;
    private Optional<Long> lastAddConfirmedUpdateTime = Optional.empty();

    // long poll execution state
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for parameter 'rateLimiter'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LedgerStorage.java`
#### Snippet
```java
     * @throws IOException
     */
    default List<DetectedInconsistency> localConsistencyCheck(Optional<RateLimiter> rateLimiter) throws IOException {
        return new ArrayList<>();
    }
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for field 'digestType'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerMetadataBuilder.java`
#### Snippet
```java
    private TreeMap<Long, List<BookieId>> ensembles = new TreeMap<>();

    private Optional<DigestType> digestType = Optional.empty();
    private Optional<byte[]> password = Optional.empty();

```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for field 'password'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerMetadataBuilder.java`
#### Snippet
```java

    private Optional<DigestType> digestType = Optional.empty();
    private Optional<byte[]> password = Optional.empty();

    private long ctime = -1;
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for field 'lastEntryId'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerMetadataBuilder.java`
#### Snippet
```java

    private State state = State.OPEN;
    private Optional<Long> lastEntryId = Optional.empty();
    private Optional<Long> length = Optional.empty();

```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for field 'length'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerMetadataBuilder.java`
#### Snippet
```java
    private State state = State.OPEN;
    private Optional<Long> lastEntryId = Optional.empty();
    private Optional<Long> length = Optional.empty();

    private TreeMap<Long, List<BookieId>> ensembles = new TreeMap<>();
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for parameter 'lastEntryId'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerMetadataImpl.java`
#### Snippet
```java
                       int ackQuorumSize,
                       State state,
                       Optional<Long> lastEntryId,
                       Optional<Long> length,
                       Map<Long, List<BookieId>> ensembles,
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for parameter 'length'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerMetadataImpl.java`
#### Snippet
```java
                       State state,
                       Optional<Long> lastEntryId,
                       Optional<Long> length,
                       Map<Long, List<BookieId>> ensembles,
                       Optional<DigestType> digestType,
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for parameter 'digestType'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerMetadataImpl.java`
#### Snippet
```java
                       Optional<Long> length,
                       Map<Long, List<BookieId>> ensembles,
                       Optional<DigestType> digestType,
                       Optional<byte[]> password,
                       long ctime,
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for parameter 'password'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerMetadataImpl.java`
#### Snippet
```java
                       Map<Long, List<BookieId>> ensembles,
                       Optional<DigestType> digestType,
                       Optional<byte[]> password,
                       long ctime,
                       boolean storeCtime,
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for parameter 'firstException'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/datainteg/EntryCopierImpl.java`
#### Snippet
```java
                                    ImmutableList<Integer> writeSet,
                                    CompletableFuture<ByteBuf> promise,
                                    Optional<Throwable> firstException) {
            if (attempt >= writeSet.size()) {
                promise.completeExceptionally(
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for field 'readLACSpeculativeRequestPolicy'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ClientInternalConf.java`
#### Snippet
```java

    final Optional<SpeculativeRequestExecutionPolicy> readSpeculativeRequestPolicy;
    final Optional<SpeculativeRequestExecutionPolicy> readLACSpeculativeRequestPolicy;

    final int explicitLacInterval;
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for field 'readSpeculativeRequestPolicy'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ClientInternalConf.java`
#### Snippet
```java
    final boolean delayEnsembleChange;

    final Optional<SpeculativeRequestExecutionPolicy> readSpeculativeRequestPolicy;
    final Optional<SpeculativeRequestExecutionPolicy> readLACSpeculativeRequestPolicy;

```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for parameter 'currentStickyBookieIndex'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/EnsemblePlacementPolicy.java`
#### Snippet
```java
     * @since 4.9
     */
    default int getStickyReadBookieIndex(LedgerMetadata metadata, Optional<Integer> currentStickyBookieIndex) {
        if (!currentStickyBookieIndex.isPresent()) {
            // Pick one bookie randomly from the current ensemble as the initial
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for parameter 'optionalDnsResolver'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/EnsemblePlacementPolicy.java`
#### Snippet
```java
     */
    EnsemblePlacementPolicy initialize(ClientConfiguration conf,
                                       Optional<DNSToSwitchMapping> optionalDnsResolver,
                                       HashedWheelTimer hashedWheelTimer,
                                       FeatureProvider featureProvider,
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for field 'scrubRateLimiter'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/service/ScrubberService.java`
#### Snippet
```java
    private final Random rng = new Random();
    private final long scrubPeriod;
    private final Optional<RateLimiter> scrubRateLimiter;
    private final AtomicBoolean stop = new AtomicBoolean(false);
    private final LedgerStorage ledgerStorage;
```

### OptionalUsedAsFieldOrParameterType
`Optional`> used as type for parameter 'excludedBookies'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeperAdmin.java`
#### Snippet
```java
                List<BookieId> ensemble,
                Set<Integer> bookieIndexesToRereplicate,
                Optional<Set<BookieId>> excludedBookies)
            throws BKException.BKNotEnoughBookiesException {
        // target bookies to replicate
```

### OptionalUsedAsFieldOrParameterType
`Optional`> used as type for parameter 'rangeRouterOverride'
in `stream/clients/java/kv/src/main/java/org/apache/bookkeeper/clients/impl/kv/PByteBufTableImpl.java`
#### Snippet
```java
                             ScheduledExecutorService executor,
                             TableRangeFactory<ByteBuf, ByteBuf> factory,
                             Optional<RangeRouter<ByteBuf>> rangeRouterOverride) {
        this.streamName = streamName;
        this.props = props;
```

### OptionalUsedAsFieldOrParameterType
`Optional`> used as type for parameter 'clazz'
in `bookkeeper-slogger/api/src/main/java/org/apache/bookkeeper/slogger/AbstractSlogger.java`
#### Snippet
```java
    }

    protected abstract Slogger newSlogger(Optional<Class<?>> clazz, Iterable<Object> parent);
    protected abstract void doLog(Level level, Enum<?> event, String message,
                                  Throwable throwable, List<Object> keyValues);
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for parameter 'featureProvider'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BookKeeperClientBuilder.java`
#### Snippet
```java
    }

    public synchronized BookKeeperClientBuilder featureProvider(Optional<FeatureProvider> featureProvider) {
        this.featureProvider = featureProvider;
        return this;
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for field 'featureProvider'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BookKeeperClientBuilder.java`
#### Snippet
```java
    private HashedWheelTimer requestTimer = null;
    // feature provider
    private Optional<FeatureProvider> featureProvider = Optional.empty();

    // Cached BookKeeper Client
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for parameter 'featureProvider'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BookKeeperClient.java`
#### Snippet
```java
                     HashedWheelTimer requestTimer,
                     StatsLogger statsLogger,
                     Optional<FeatureProvider> featureProvider) {
        this.conf = conf;
        this.name = name;
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for field 'featureProvider'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BookKeeperClient.java`
#### Snippet
```java
    private final boolean ownZK;
    // feature provider
    private final Optional<FeatureProvider> featureProvider;

    @SuppressWarnings("deprecation")
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for field 'startTransactionId'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKSyncLogReader.java`
#### Snippet
```java
    private final int maxReadAheadWaitTime;
    private CompletableFuture<Void> closeFuture;
    private final Optional<Long> startTransactionId;
    private boolean positioned = false;
    private Entry.Reader currentEntry = null;
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for parameter 'startTransactionId'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKSyncLogReader.java`
#### Snippet
```java
                    BKDistributedLogManager bkdlm,
                    DLSN startDLSN,
                    Optional<Long> startTransactionId,
                    StatsLogger statsLogger) throws IOException {
        this.bkdlm = bkdlm;
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for parameter 'subscriberId'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAsyncLogReader.java`
#### Snippet
```java
                     OrderedScheduler scheduler,
                     DLSN startDLSN,
                     Optional<String> subscriberId,
                     boolean returnEndOfStreamRecord,
                     StatsLogger statsLogger) {
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for parameter 'prevFoundRecord'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/ReadUtils.java`
#### Snippet
```java
            final List<LogRecordWithDLSN> searchResults,
            final int nWays,
            final Optional<LogRecordWithDLSN> prevFoundRecord,
            final CompletableFuture<Optional<LogRecordWithDLSN>> promise) {
        int found = -1;
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for parameter 'prevFoundRecord'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/ReadUtils.java`
#### Snippet
```java
            final List<Long> entriesToSearch,
            final int nWays,
            final Optional<LogRecordWithDLSN> prevFoundRecord,
            final CompletableFuture<Optional<LogRecordWithDLSN>> promise) {
        final List<CompletableFuture<LogRecordWithDLSN>> searchResults =
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for field 'serverConf'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LocalDLMEmulator.java`
#### Snippet
```java
        private int zkPort = DEFAULT_ZK_PORT;
        private boolean shouldStartZK = true;
        private Optional<ServerConfiguration> serverConf = Optional.empty();

        public Builder numBookies(int numBookies) {
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for parameter 'streamConfiguration'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/DistributedLogConfiguration.java`
#### Snippet
```java
     * @param streamConfiguration stream configuration overrides
     */
    public void loadStreamConf(Optional<DistributedLogConfiguration> streamConfiguration) {
        if (!streamConfiguration.isPresent()) {
            return;
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for parameter 'subscriberId'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogReadHandler.java`
#### Snippet
```java
     */
    BKLogReadHandler(LogMetadataForReader logMetadata,
                     Optional<String> subscriberId,
                     DistributedLogConfiguration conf,
                     DynamicDistributedLogConfiguration dynConf,
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for field 'subscriberId'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogReadHandler.java`
#### Snippet
```java
    protected final DynamicDistributedLogConfiguration dynConf;

    private final Optional<String> subscriberId;
    private DistributedLock readLock;
    private CompletableFuture<Void> lockAcquireFuture;
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for parameter 'logConfiguration'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKDistributedLogNamespace.java`
#### Snippet
```java
            URI uri,
            String nameOfLogStream,
            Optional<DistributedLogConfiguration> logConfiguration,
            Optional<DynamicDistributedLogConfiguration> dynamicLogConfiguration)
        throws InvalidStreamNameException, IOException {
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for parameter 'dynamicLogConfiguration'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKDistributedLogNamespace.java`
#### Snippet
```java
            String nameOfLogStream,
            Optional<DistributedLogConfiguration> logConfiguration,
            Optional<DynamicDistributedLogConfiguration> dynamicLogConfiguration)
        throws InvalidStreamNameException, IOException {
        // Make sure the name is well formed
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for parameter 'logConf'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/api/namespace/Namespace.java`
#### Snippet
```java
     */
    DistributedLogManager openLog(String logName,
                                  Optional<DistributedLogConfiguration> logConf,
                                  Optional<DynamicDistributedLogConfiguration> dynamicLogConf,
                                  Optional<StatsLogger> perStreamStatsLogger)
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for parameter 'dynamicLogConf'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/api/namespace/Namespace.java`
#### Snippet
```java
    DistributedLogManager openLog(String logName,
                                  Optional<DistributedLogConfiguration> logConf,
                                  Optional<DynamicDistributedLogConfiguration> dynamicLogConf,
                                  Optional<StatsLogger> perStreamStatsLogger)
            throws InvalidStreamNameException, LogNotFoundException, IOException;
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for parameter 'perStreamStatsLogger'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/api/namespace/Namespace.java`
#### Snippet
```java
                                  Optional<DistributedLogConfiguration> logConf,
                                  Optional<DynamicDistributedLogConfiguration> dynamicLogConf,
                                  Optional<StatsLogger> perStreamStatsLogger)
            throws InvalidStreamNameException, LogNotFoundException, IOException;

```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for field 'nsOptional'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/ZKLogMetadataStore.java`
#### Snippet
```java

    final URI namespace;
    final Optional<URI> nsOptional;
    final ZooKeeperClient zkc;
    final ZKNamespaceWatcher nsWatcher;
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for parameter 'featureProviderOptional'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/BKNamespaceDriver.java`
#### Snippet
```java
                                                     EventLoopGroup eventLoopGroup,
                                                     HashedWheelTimer requestTimer,
                                                     Optional<FeatureProvider> featureProviderOptional,
                                                     StatsLogger statsLogger) {
        BookKeeperClientBuilder builder = BookKeeperClientBuilder.newBuilder()
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for parameter 'fromDLSN'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKDistributedLogManager.java`
#### Snippet
```java
    }

    protected CompletableFuture<AsyncLogReader> getAsyncLogReaderWithLock(final Optional<DLSN> fromDLSN,
                                                               final Optional<String> subscriberId) {
        if (!fromDLSN.isPresent() && !subscriberId.isPresent()) {
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for parameter 'subscriberId'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKDistributedLogManager.java`
#### Snippet
```java

    protected CompletableFuture<AsyncLogReader> getAsyncLogReaderWithLock(final Optional<DLSN> fromDLSN,
                                                               final Optional<String> subscriberId) {
        if (!fromDLSN.isPresent() && !subscriberId.isPresent()) {
            return FutureUtils.exception(new UnexpectedException("Neither from dlsn nor subscriber id is provided."));
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for parameter 'subscriberId'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKDistributedLogManager.java`
#### Snippet
```java
    }

    synchronized BKLogReadHandler createReadHandler(Optional<String> subscriberId,
                                                    boolean isHandleForReading) {
        return createReadHandler(
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for parameter 'subscriberId'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKDistributedLogManager.java`
#### Snippet
```java
    }

    synchronized BKLogReadHandler createReadHandler(Optional<String> subscriberId,
                                                    AsyncNotification notification,
                                                    boolean isHandleForReading) {
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for parameter 'resourcesCloseable'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKDistributedLogManager.java`
#### Snippet
```java
                            StatsLogger statsLogger,
                            StatsLogger perLogStatsLogger,
                            Optional<AsyncCloseable> resourcesCloseable) {
        this.name = name;
        this.conf = conf;
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for parameter 'subscriberId'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKDistributedLogManager.java`
#### Snippet
```java
    }

    synchronized BKLogReadHandler createReadHandler(Optional<String> subscriberId) {
        return createReadHandler(subscriberId, false);
    }
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for field 'resourcesCloseable'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKDistributedLogManager.java`
#### Snippet
```java

    // resource to close
    private final Optional<AsyncCloseable> resourcesCloseable;

    /**
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for parameter 'fromTxnId'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKDistributedLogManager.java`
#### Snippet
```java
    }

    LogReader getInputStreamInternal(DLSN fromDLSN, Optional<Long> fromTxnId)
            throws IOException {
        LOG.info("Create sync reader starting from {}", fromDLSN);
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for parameter 'readerId'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/metadata/LogStreamMetadataStore.java`
#### Snippet
```java
     */
    CompletableFuture<DistributedLock> createReadLock(LogMetadataForReader metadata,
                                           Optional<String> readerId);

    /**
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for parameter 'subscriberId'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/metadata/LogMetadataForReader.java`
#### Snippet
```java
     * @return read lock path
     */
    public String getReadLockPath(Optional<String> subscriberId) {
        if (subscriberId.isPresent()) {
            return logRootPath + SUBSCRIBERS_PATH + "/" + subscriberId.get() + READ_LOCK_PATH;
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for field 'completedLatencyMicros'
in `stream/common/src/main/java/org/apache/bookkeeper/common/grpc/stats/ServerStats.java`
#### Snippet
```java
    private final Counter streamMessagesReceived;
    private final Counter streamMessagesSent;
    private final Optional<OpStatsLogger> completedLatencyMicros;

    private ServerStats(StatsLogger rootStatsLogger,
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for field 'completedLatencyMicros'
in `stream/common/src/main/java/org/apache/bookkeeper/common/grpc/stats/ClientStats.java`
#### Snippet
```java
    private final Counter streamMessagesReceived;
    private final Counter streamMessagesSent;
    private final Optional<OpStatsLogger> completedLatencyMicros;

    private ClientStats(StatsLogger rootStatsLogger,
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for parameter 'parentPathShouldNotCreate'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/util/Utils.java`
#### Snippet
```java
        final ZooKeeperClient zkc,
        final String pathToCreate,
        final Optional<String> parentPathShouldNotCreate,
        final byte[] data,
        final List<ACL> acl,
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for parameter 'parentPathShouldNotCreate'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/util/Utils.java`
#### Snippet
```java
        final ZooKeeperClient zkc,
        final String pathToCreate,
        final Optional<String> parentPathShouldNotCreate,
        final byte[] data,
        final List<ACL> acl,
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for parameter 'confLocal'
in `stream/distributedlog/io/dlfs/src/main/java/org/apache/distributedlog/fs/DLFileSystem.java`
#### Snippet
```java
    private FSDataOutputStream append(Path path,
                                      int bufferSize,
                                      Optional<DistributedLogConfiguration> confLocal)
            throws IOException {
        try {
```

### OptionalUsedAsFieldOrParameterType
`Optional` used as type for parameter 'segmentStorePath'
in `stream/storage/api/src/main/java/org/apache/bookkeeper/stream/storage/api/cluster/ClusterMetadataStore.java`
#### Snippet
```java
     * @return true if successfully initialized cluster, otherwise false.
     */
    boolean initializeCluster(int numStorageContainers, Optional<String> segmentStorePath);

    /**
```

## RuleId[id=CharsetObjectCanBeUsed]
### CharsetObjectCanBeUsed
UTF_8 can be used instead
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/LedgerMetadataSerDe.java`
#### Snippet
```java
            writeHeader(os, METADATA_FORMAT_VERSION_1);

            try (PrintWriter writer = new PrintWriter(new OutputStreamWriter(os, UTF_8.name()))) {
                writer.append(String.valueOf(metadata.getWriteQuorumSize())).append(LINE_SPLITTER);
                writer.append(String.valueOf(metadata.getEnsembleSize())).append(LINE_SPLITTER);
```

### CharsetObjectCanBeUsed
UTF_8 can be used instead
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/LedgerMetadataSerDe.java`
#### Snippet
```java

        LedgerMetadataFormat.Builder formatBuilder = LedgerMetadataFormat.newBuilder();
        try (InputStreamReader reader = new InputStreamReader(is, UTF_8.name())) {
            TextFormat.merge(reader, formatBuilder);
        }
```

### CharsetObjectCanBeUsed
UTF_8 can be used instead
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/LedgerMetadataSerDe.java`
#### Snippet
```java
        try (ByteArrayOutputStream os = new ByteArrayOutputStream()) {
            writeHeader(os, METADATA_FORMAT_VERSION_2);
            try (PrintWriter writer = new PrintWriter(new OutputStreamWriter(os, UTF_8.name()))) {
                /***********************************************************************
                 * WARNING: Do not modify to add fields.
```

### CharsetObjectCanBeUsed
UTF_8 can be used instead
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/LedgerMetadataSerDe.java`
#### Snippet
```java

    private static LedgerMetadata parseVersion1Config(long ledgerId, InputStream is) throws IOException {
        try (BufferedReader reader = new BufferedReader(new InputStreamReader(is, UTF_8.name()))) {
            LedgerMetadataBuilder builder = LedgerMetadataBuilder.create()
                    .withId(ledgerId)
```

### CharsetObjectCanBeUsed
StandardCharsets.UTF_8 can be used instead
in `bookkeeper-http/servlet-http-server/src/main/java/org/apache/bookkeeper/http/servlet/BookieHttpServiceServlet.java`
#### Snippet
```java
                                .setMethod(httpServerMethod(httpRequest))
                                .setParams(httpServletParams(httpRequest))
                                .setBody(IOUtils.toString(httpRequest.getInputStream(), "UTF-8"));
    String uri = httpRequest.getRequestURI();
    HttpServiceResponse response;
```

### CharsetObjectCanBeUsed
UTF_8 can be used instead
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java

        void dumpLedgers(Set<Long> ledgers, File targetFile) throws Exception {
            PrintWriter pw = new PrintWriter(new OutputStreamWriter(new FileOutputStream(targetFile), UTF_8.name()));
            try {
                for (Long ledger : ledgers) {
```

### CharsetObjectCanBeUsed
UTF_8 can be used instead
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java

                    br = new BufferedReader(new InputStreamReader(
                            new FileInputStream(new File(cmdline.getOptionValue("lf"))), UTF_8.name()));
                    String line;
                    while ((line = br.readLine()) != null) {
```

## RuleId[id=SystemOutErr]
### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `microbenchmarks/src/main/java/org/apache/bookkeeper/stats/codahale/TimerBenchmark.java`
#### Snippet
```java
        if (args.length != 1
                || (!args[0].equalsIgnoreCase("codahale") && !args[0].equalsIgnoreCase("fast"))) {
            System.out.println("usage: " + TimerBenchmark.class.getCanonicalName() + " <codahale|fast>");
            System.exit(1);
        }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `microbenchmarks/src/main/java/org/apache/bookkeeper/stats/codahale/TimerBenchmark.java`
#### Snippet
```java
            logger = new FastCodahaleMetricsProvider().getStatsLogger("test");
        }
        System.out.println("Using " + logger.getClass().getCanonicalName());
        System.out.println("Creating 1000 OpStatsLoggers (2000 Timers) and updating each of them 1000 times ...");
        OpStatsLogger[] timers = new OpStatsLogger[1000];
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `microbenchmarks/src/main/java/org/apache/bookkeeper/stats/codahale/TimerBenchmark.java`
#### Snippet
```java
        }
        System.out.println("Using " + logger.getClass().getCanonicalName());
        System.out.println("Creating 1000 OpStatsLoggers (2000 Timers) and updating each of them 1000 times ...");
        OpStatsLogger[] timers = new OpStatsLogger[1000];
        for (int i = 0; i < timers.length; i++) {
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `microbenchmarks/src/main/java/org/apache/bookkeeper/stats/codahale/TimerBenchmark.java`
#### Snippet
```java
        }
        times = null; // let it become garbage
        System.out.println("Done.");
        System.out.println("Now run 'jmap -histo:live <pid>' on this JVM to get a heap histogram, then kill this JVM.");
        while (true) {
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `microbenchmarks/src/main/java/org/apache/bookkeeper/stats/codahale/TimerBenchmark.java`
#### Snippet
```java
        times = null; // let it become garbage
        System.out.println("Done.");
        System.out.println("Now run 'jmap -histo:live <pid>' on this JVM to get a heap histogram, then kill this JVM.");
        while (true) {
            try {
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/HexDumpEntryFormatter.java`
#### Snippet
```java
    public void formatEntry(byte[] data) {
        try {
            HexDump.dump(data, 0, System.out, 0);
        } catch (ArrayIndexOutOfBoundsException e) {
            System.out.println("Warn: Index is outside the data array's bounds : " + e.getMessage());
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/HexDumpEntryFormatter.java`
#### Snippet
```java
            HexDump.dump(data, 0, System.out, 0);
        } catch (ArrayIndexOutOfBoundsException e) {
            System.out.println("Warn: Index is outside the data array's bounds : " + e.getMessage());
        } catch (IllegalArgumentException e) {
            System.out.println("Warn: The output stream is null : " + e.getMessage());
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/HexDumpEntryFormatter.java`
#### Snippet
```java
            System.out.println("Warn: Index is outside the data array's bounds : " + e.getMessage());
        } catch (IllegalArgumentException e) {
            System.out.println("Warn: The output stream is null : " + e.getMessage());
        } catch (IOException e) {
            System.out.println("Warn: Something has gone wrong writing the data to stream : " + e.getMessage());
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/HexDumpEntryFormatter.java`
#### Snippet
```java
            System.out.println("Warn: The output stream is null : " + e.getMessage());
        } catch (IOException e) {
            System.out.println("Warn: Something has gone wrong writing the data to stream : " + e.getMessage());
        }
    }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/HexDumpEntryFormatter.java`
#### Snippet
```java
            formatEntry(data);
        } catch (IOException ie) {
            System.out.println("Warn: Unreadable entry : " + ie.getMessage());
        }
    }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/IOUtils.java`
#### Snippet
```java
    public static boolean confirmPrompt(String prompt) throws IOException {
        while (true) {
            System.out.print(prompt + " (Y or N) ");
            StringBuilder responseBuilder = new StringBuilder();
            while (true) {
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/IOUtils.java`
#### Snippet
```java
                return false;
            }
            System.out.println("Invalid input: " + response);
            // else ask them again
        }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/StringEntryFormatter.java`
#### Snippet
```java
            formatEntry(data);
        } catch (IOException ie) {
            System.out.println("Warn: Unreadable entry : " + ie.getMessage());
        }
    }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/StringEntryFormatter.java`
#### Snippet
```java
    @Override
    public void formatEntry(byte[] data) {
        System.out.println(ByteString.copyFrom(data).toStringUtf8());
    }

```

### SystemOutErr
Uses of `System.err` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/LocalBookKeeper.java`
#### Snippet
```java

    private static void usage() {
        System.err.println(
                "Usage: LocalBookKeeper number-of-bookies [path to bookie config] "
                + "[path to create ZK data directory at] [path to LocalBookiesConfigDir]");
```

### SystemOutErr
Uses of `System.err` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieClientImpl.java`
#### Snippet
```java
    public static void main(String[] args) throws NumberFormatException, IOException, InterruptedException {
        if (args.length != 3) {
            System.err.println("USAGE: BookieClient bookieHost port ledger#");
            return;
        }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieClientImpl.java`
#### Snippet
```java
        }
        counter.wait(0);
        System.out.println("Total = " + counter.total());
        scheduler.shutdown();
        eventLoopGroup.shutdownGracefully();
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieClientImpl.java`
#### Snippet
```java
                counter.dec();
                if (rc != 0) {
                    System.out.println("rc = " + rc + " for " + entry + "@" + ledger);
                }
            }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookie/LedgerCommand.java`
#### Snippet
```java
    private boolean dumpLedgerInfo(long ledgerId, ServerConfiguration conf) {
        try {
            DbLedgerStorage.readLedgerIndexEntries(ledgerId, conf, (currentEntry, entryLodId, position) -> System.out
                    .println("entry " + currentEntry + "\t:\t(log: " + entryLodId + ", pos: " + position + ")"));
        } catch (IOException e) {
```

### SystemOutErr
Uses of `System.err` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookie/LedgerCommand.java`
#### Snippet
```java
                    .println("entry " + currentEntry + "\t:\t(log: " + entryLodId + ", pos: " + position + ")"));
        } catch (IOException e) {
            System.err.printf("ERROR: initializing dbLedgerStorage %s", e.getMessage());
            return false;
        }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookie/LedgerCommand.java`
#### Snippet
```java

    private void printInfoLine(String mes) {
        System.out.println(mes);
    }
}
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/cookie/CreateCookieCommand.java`
#### Snippet
```java

    public CreateCookieCommand(Flags flags) {
        this(flags, System.out);
    }

```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/cookie/GetCookieCommand.java`
#### Snippet
```java

    public GetCookieCommand(Flags flags) {
        this(flags, System.out);
    }

```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/cookie/UpdateCookieCommand.java`
#### Snippet
```java

    public UpdateCookieCommand(Flags flags) {
        this(flags, System.out);
    }

```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/cookie/DeleteCookieCommand.java`
#### Snippet
```java

    public DeleteCookieCommand(Flags flags) {
        this(flags, System.out);
    }

```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/cookie/GenerateCookieCommand.java`
#### Snippet
```java

    public GenerateCookieCommand(Flags flags) {
        this(flags, System.out);
    }

```

### SystemOutErr
Uses of `System.err` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieShell.java`
#### Snippet
```java
            String[] leftArgs = cmdLine.getArgs();
            if (leftArgs.length <= 0) {
                System.err.println("ERROR: missing entry log id or entry log file name");
                printUsage();
                return -1;
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieShell.java`
#### Snippet
```java

    void printInfoLine(String s) {
        System.out.println(s);
    }

```

### SystemOutErr
Uses of `System.err` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieShell.java`
#### Snippet
```java
            Command cmd = commands.get(cmdName);
            if (null == cmd) {
                System.err.println("Unknown command " + cmdName);
                printShellUsage();
                return -1;
```

### SystemOutErr
Uses of `System.err` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieShell.java`
#### Snippet
```java

    void printErrorLine(String s) {
        System.err.println(s);
    }

```

### SystemOutErr
Uses of `System.err` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieShell.java`
#### Snippet
```java
        Command cmd = commands.get(cmdName);
        if (null == cmd) {
            System.err.println("ERROR: Unknown command " + cmdName);
            printShellUsage();
            return -1;
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieShell.java`
#### Snippet
```java

    void printLedgerMetadata(long ledgerId, LedgerMetadata md, boolean printMeta) {
        System.out.println("ledgerID: " + ledgerIdFormatter.formatLedgerId(ledgerId));
        if (printMeta) {
            System.out.println(md.toString());
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieShell.java`
#### Snippet
```java
        System.out.println("ledgerID: " + ledgerIdFormatter.formatLedgerId(ledgerId));
        if (printMeta) {
            System.out.println(md.toString());
        }
    }
```

### SystemOutErr
Uses of `System.err` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieShell.java`
#### Snippet
```java
            String[] leftArgs = cmdLine.getArgs();
            if (leftArgs.length <= 0) {
                System.err.println("ERROR: missing journal id or journal file name");
                printUsage();
                return -1;
```

### SystemOutErr
Uses of `System.err` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieShell.java`
#### Snippet
```java
            final long ledgerId = getOptionLedgerIdValue(cmdLine, "ledgerid", -1);
            if (ledgerId == -1) {
                System.err.println("Must specify a ledger id");
                return -1;
            }
```

### SystemOutErr
Uses of `System.err` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieShell.java`
#### Snippet
```java
            }
            if (cmdLine.hasOption("dumptofile") && cmdLine.hasOption("restorefromfile")) {
                System.err.println("Only one of --dumptofile and --restorefromfile can be specified");
                return -2;
            }
```

### SystemOutErr
Uses of `System.err` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieShell.java`
#### Snippet
```java
            }
            if (args.length > 1) {
                System.err.println("The provided bookie dest " + args[1] + " will be ignored!");
            }
            boolean query = cmdLine.hasOption("q");
```

### SystemOutErr
Uses of `System.err` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieShell.java`
#### Snippet
```java

    private void printShellUsage() {
        System.err.println("Usage: bookkeeper shell [-localbookie [<host:port>]] [-ledgeridformat <hex/long/uuid>] "
                + "[-entryformat <hex/string>] [-conf configuration] <command>");
        System.err.println("where command is one of:");
```

### SystemOutErr
Uses of `System.err` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieShell.java`
#### Snippet
```java
        System.err.println("Usage: bookkeeper shell [-localbookie [<host:port>]] [-ledgeridformat <hex/long/uuid>] "
                + "[-entryformat <hex/string>] [-conf configuration] <command>");
        System.err.println("where command is one of:");
        List<String> commandNames = new ArrayList<String>();
        for (Command c : commands.values()) {
```

### SystemOutErr
Uses of `System.err` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieShell.java`
#### Snippet
```java
        Collections.sort(commandNames);
        for (String s : commandNames) {
            System.err.println(s);
        }
    }
```

### SystemOutErr
Uses of `System.err` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieShell.java`
#### Snippet
```java
                return ledgerIdFormatter.readLedgerId(val);
            } catch (IllegalArgumentException iae) {
                System.err.println("ERROR: invalid value for option " + option + " : " + val);
                return defaultVal;
            }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieShell.java`
#### Snippet
```java
        long entryId = entry.getEntryId();
        long entrySize = entry.getLength();
        System.out.println("--------- Lid=" + ledgerIdFormatter.formatLedgerId(ledgerId) + ", Eid=" + entryId
                + ", EntrySize=" + entrySize + " ---------");
        if (printMsg) {
```

### SystemOutErr
Uses of `System.err` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieShell.java`
#### Snippet
```java
                return Integer.parseInt(val);
            } catch (NumberFormatException nfe) {
                System.err.println("ERROR: invalid value for option " + option + " : " + val);
                return defaultVal;
            }
```

### SystemOutErr
Uses of `System.err` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieShell.java`
#### Snippet
```java
                return Long.parseLong(val);
            } catch (NumberFormatException nfe) {
                System.err.println("ERROR: invalid value for option " + option + " : " + val);
                return defaultVal;
            }
```

### SystemOutErr
Uses of `System.err` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieShell.java`
#### Snippet
```java
        public void printUsage() {
            HelpFormatter hf = new HelpFormatter();
            System.err.println(cmdName + ": " + getDescription());
            hf.printHelp(getUsage(), getOptions());
        }
```

### SystemOutErr
Uses of `System.err` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/Main.java`
#### Snippet
```java
        } catch (IllegalArgumentException iae) {
            log.error("Error parsing command line arguments : ", iae);
            System.err.println(iae.getMessage());
            printUsage();
            throw iae;
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/DirectBookkeeperDriver.java`
#### Snippet
```java
                return;
            }
            System.out.format("Got handle for read %d -> %d on ledger %d%n", firstEntryID, lastEntryID, ledgerID);
            lh.asyncReadEntries(firstEntryID, lastEntryID, (rc1, lh1, seq, ctx1) -> {
                System.out.format("Read cb %d -> %d on ledger %d%n", firstEntryID, lastEntryID, ledgerID);
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/DirectBookkeeperDriver.java`
#### Snippet
```java
            System.out.format("Got handle for read %d -> %d on ledger %d%n", firstEntryID, lastEntryID, ledgerID);
            lh.asyncReadEntries(firstEntryID, lastEntryID, (rc1, lh1, seq, ctx1) -> {
                System.out.format("Read cb %d -> %d on ledger %d%n", firstEntryID, lastEntryID, ledgerID);
                ArrayList<byte[]> results = new ArrayList<>();
                if (rc1 == 0) {
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/DirectBookkeeperDriver.java`
#### Snippet
```java
                        results.add(seq.nextElement().getEntry());
                    }
                    System.out.format("About to close handle for read %d -> %d on ledger %d%n",
                            firstEntryID, lastEntryID, ledgerID);
                }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/DirectBookkeeperDriver.java`
#### Snippet
```java
                }
                lh.asyncClose((rc2, lh2, ctx2) -> {
                    System.out.format("Closed handle for read %d -> %d on ledger %d result %d%n",
                            firstEntryID, lastEntryID, ledgerID, rc2);
                    cb.accept(rc1 == 0 ? rc2 : rc1, results);
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
                ++completed;
                if (toWaitFor == completed) {
                    System.out.format("Writes ending at %d complete on ledger %d%n", lastEntry, ledger.ledgerID);
                    ledger.closeWrite(lastEntry, (rc2) -> {
                        synchronized (BookkeeperVerifier.this) {
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
                        synchronized (BookkeeperVerifier.this) {
                            checkReturn(ledger.ledgerID, rc2);
                            System.out.format("Writes ending at %d complete on ledger %d releasing write%n",
                                    lastEntry, ledger.ledgerID);
                            --outstandingWriteCount;
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
        while ((System.currentTimeMillis() < testDrainEnd)
                && (outstandingReadCount > 0 || outstandingWriteCount > 0)) {
            System.out.format("reads: %d, writes: %d%n", outstandingReadCount, outstandingWriteCount);
            System.out.format("openingLedgers:%n");
            for (LedgerInfo li: openingLedgers) {
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
                && (outstandingReadCount > 0 || outstandingWriteCount > 0)) {
            System.out.format("reads: %d, writes: %d%n", outstandingReadCount, outstandingWriteCount);
            System.out.format("openingLedgers:%n");
            for (LedgerInfo li: openingLedgers) {
                System.out.format(
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
            System.out.format("openingLedgers:%n");
            for (LedgerInfo li: openingLedgers) {
                System.out.format(
                        "Ledger %d has reads: %d, writes: %d%n",
                        li.ledgerID,
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
                        li.writesInProgress.size());
            }
            System.out.format("openLedgers:%n");
            for (LedgerInfo li: openLedgers) {
                System.out.format(
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
            System.out.format("openLedgers:%n");
            for (LedgerInfo li: openLedgers) {
                System.out.format(
                        "Ledger %d has reads: %d, writes: %d%n",
                        li.ledgerID,
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
                        li.writesInProgress.size());
            }
            System.out.format("liveLedgers:%n");
            for (LedgerInfo li: liveLedgers) {
                System.out.format(
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
            System.out.format("liveLedgers:%n");
            for (LedgerInfo li: liveLedgers) {
                System.out.format(
                        "Ledger %d has reads: %d, writes: %d%n",
                        li.ledgerID,
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
        if (BKException.Code.OK != rc) {
            String error = String.format("Got error %d on ledger %d", rc, ledgerID);
            System.out.println(error);
            propagateExceptionToMain(BKException.create(rc));
            return true;
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
        if (!errors.isEmpty()) {
            for (Exception e: errors) {
                System.out.format("Error found: %s%n", e.toString());
                e.printStackTrace();
            }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
        private void checkOpComplete(Consumer<Integer> cb) {
            if (readsInProgress == 0 && writesInProgress.isEmpty() && onLastOp != null) {
                System.out.format("checkOpComplete: done%n");
                onLastOp.accept(cb);
                onLastOp = null;
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
                onLastOp = null;
            } else {
                System.out.format(
                        "checkOpComplete: ledger %d, writesInProgress %s, readsInProgress %d%n",
                        ledgerID,
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
        private void checkWriteComplete(Consumer<Integer> cb) {
            if (writesInProgress.isEmpty() && onLastWrite != null) {
                System.out.format("checkWriteComplete: done%n");
                onLastWrite.accept(cb);
                onLastWrite = null;
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
                onLastWrite = null;
            } else {
                System.out.format(
                        "checkWriteComplete: ledger %d, writesInProgress %s%n",
                        ledgerID,
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
    private synchronized boolean startWrite() {
        if (outstandingWriteCount > targetConcurrentWrites) {
            System.out.format("Write paused, too many outstanding writes%n");
            /* Caller should release lock and wait for outstandingWriteCount to fall */
            return false;
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
            /* Not enough open ledgers, open a new one -- counts as a write */
            long newID = getNextLedgerID();
            System.out.format("Creating new ledger %d%n", newID);
            LedgerInfo ledger = new LedgerInfo(newID, opRand.nextLong());
            openingLedgers.add(ledger);
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
                synchronized (BookkeeperVerifier.this) {
                    checkReturn(newID, rc);
                    System.out.format("Created new ledger %d%n", newID);
                    openingLedgers.remove(ledger);
                    openLedgers.add(ledger);
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
            return true;
        } else if (openLedgers.isEmpty()) {
            System.out.format("Not starting a write, no open ledgers, already opening the limit%n");
            /* Caller should release lock and wait for openLedgers to be populated */
            return false;
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
            ArrayList<EntryInfo> toWrite = ledger.getNextEntries(targetWriteGroup);
            long lastEntry = toWrite.get(toWrite.size() - 1).getEntryID();
            System.out.format(
                    "Writing entries %d -> %d to ledger %d%n",
                    toWrite.get(0).getEntryID(),
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
            if (lastEntry >= targetLedgerEntries) {
                /* Remove this ledger from the writable list, mark for closing once all open writes complete */
                System.out.format("Marking ledger %d for close%n", ledger.ledgerID);
                openLedgers.remove(ledger);
                liveLedgers.add(ledger);
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
                liveLedgers.add(ledger);
                ledger.onLastWriteComplete((rc) -> checkReturn(ledger.ledgerID, rc), (Consumer<Integer> cb) -> {
                    System.out.format("Closing ledger %d%n", ledger.ledgerID);
                    driver.closeLedger(ledger.ledgerID, (Integer rc) -> {
                        synchronized (BookkeeperVerifier.this) {
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
                        synchronized (BookkeeperVerifier.this) {
                            ledger.setClosed();
                            System.out.format("Closed ledger %d%n", ledger.ledgerID);

                            if (liveLedgers.size() >= targetLedgers) {
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
                                LedgerInfo toDelete = getRandomLedger(liveLedgers);
                                final long ledgerID = toDelete.ledgerID;
                                System.out.format("Marking ledger %d for deletion%n", ledgerID);
                                liveLedgers.remove(toDelete);
                                toDelete.onLastOpComplete(cb, (Consumer<Integer> cb2) -> {
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
                                liveLedgers.remove(toDelete);
                                toDelete.onLastOpComplete(cb, (Consumer<Integer> cb2) -> {
                                    System.out.format("Deleting ledger %d%n", ledgerID);
                                    driver.deleteLedger(ledgerID, (rc2) -> {
                                        synchronized (BookkeeperVerifier.this) {
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
                                    driver.deleteLedger(ledgerID, (rc2) -> {
                                        synchronized (BookkeeperVerifier.this) {
                                            System.out.format("Deleted ledger %d%n", ledgerID);
                                            cb2.accept(rc2);
                                        }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
        void openWrite(long entryID) {
            writesInProgress.add(entryID);
            System.out.format("Open writes, %s%n", writesInProgress);
        }

```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
    private synchronized boolean startRead() {
        if (outstandingReadCount > targetConcurrentReads) {
            System.out.format("Not starting another read, enough in progress%n");
            /* Caller should exit and wait for outstandingReadCount to fall */
            return false;
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
        if (!openLedgers.isEmpty() && (opRand.nextDouble() > coldToHotRatio)) {
            ledger = getRandomLedger(openLedgers);
            System.out.format("Reading from open ledger %d%n", ledger.ledgerID);
        } else if (!liveLedgers.isEmpty()) {
            ledger = getRandomLedger(liveLedgers);
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
        } else if (!liveLedgers.isEmpty()) {
            ledger = getRandomLedger(liveLedgers);
            System.out.format("Reading from cold ledger %d%n", ledger.ledgerID);
        } else {
            /* No readable ledgers, either startWrite can make progress, or there are already ledgers
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
        long lastEntryCompleted = ledger.getConfirmedLAC();
        if (lastEntryCompleted <= 0) {
            System.out.format("No readable entries in ledger %d, let's wait%n", ledger.ledgerID);
            /* Either startWrite can make progress or there are already a bunch in progress */
            return false;
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
        long start = Math.abs(opRand.nextLong() % lastEntryCompleted);
        long end = start + targetReadGroup > lastEntryCompleted ? lastEntryCompleted : start + targetReadGroup;
        System.out.format("Reading %d -> %d from ledger %d%n", start, end, ledger.ledgerID);
        LedgerInfo finalLedger = ledger;
        ledger.incReads();
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
                    return;
                }
                System.out.format("Read %d -> %d from ledger %d complete%n", start, end, ledger.ledgerID);
                long current = start;
                LedgerInfo.EntryIterator iterator = finalLedger.getIterator();
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
                    synchronized (BookkeeperVerifier.this) {
                        checkReturn(ledger.ledgerID, rc2);
                        System.out.format("Read %d -> %d from ledger %d releasing read%n", start, end, ledger.ledgerID);
                        outstandingReadCount--;
                        BookkeeperVerifier.this.notifyAll();
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
        void incReads() {
            readsInProgress++;
            System.out.format("Inc reads to %d%n", readsInProgress);
        }

```

### SystemOutErr
Uses of `System.err` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/AutoRecoveryMain.java`
#### Snippet
```java
            LOG.error("Error parsing command line arguments : ", iae);
            if (iae.getMessage() != null) {
                System.err.println(iae.getMessage());
            }
            printUsage();
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `bookkeeper-slogger/api/src/main/java/org/apache/bookkeeper/slogger/ConsoleSlogger.java`
#### Snippet
```java
        builder.append("}");

        System.out.println(builder);
    }

```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stats/utils/src/main/java/org/apache/bookkeeper/stats/utils/StatsDocGenerator.java`
#### Snippet
```java
        Writer writer;
        if (Strings.isNullOrEmpty(file)) {
            writer = new OutputStreamWriter(System.out, UTF_8);
        } else {
            writer = new OutputStreamWriter(new FileOutputStream(file), UTF_8);
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LocalDLMEmulator.java`
#### Snippet
```java
                        localDlm.teardown();
                        FileUtils.forceDeleteOnExit(zkDir);
                        System.out.println("ByeBye!");
                    } catch (Exception e) {
                        // do nothing
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LocalDLMEmulator.java`
#### Snippet
```java
        try {
            if (args.length < 1) {
                System.out.println("Usage: LocalDLEmulator [<zk_host>] <zk_port>");
                System.exit(-1);
            }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LocalDLMEmulator.java`
#### Snippet
```java
            localDlm.start();

            System.out.println(String.format(
                "DistributedLog Sandbox is running now. You could access distributedlog://%s:%s",
                zkHost,
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LocalDLMEmulator.java`
#### Snippet
```java
                zkPort));
        } catch (Exception ex) {
            System.out.println("Exception occurred running emulator " + ex);
        }
    }
```

### SystemOutErr
Uses of `System.err` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/Tool.java`
#### Snippet
```java
            Command command = commands.get(cmdName);
            if (null == command) {
                System.err.println("Unknown command " + cmdName);
                printToolUsage();
                return -1;
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/Tool.java`
#### Snippet
```java
     */
    protected static void println(String msg) {
        System.out.println(msg);
    }

```

### SystemOutErr
Uses of `System.err` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/Tool.java`
#### Snippet
```java
        int rc = -1;
        if (args.length <= 0) {
            System.err.println("No tool to run.");
            System.err.println();
            System.err.println("Usage : Tool <tool_class_name> <options>");
```

### SystemOutErr
Uses of `System.err` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/Tool.java`
#### Snippet
```java
        if (args.length <= 0) {
            System.err.println("No tool to run.");
            System.err.println();
            System.err.println("Usage : Tool <tool_class_name> <options>");
            System.exit(-1);
```

### SystemOutErr
Uses of `System.err` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/Tool.java`
#### Snippet
```java
            System.err.println("No tool to run.");
            System.err.println();
            System.err.println("Usage : Tool <tool_class_name> <options>");
            System.exit(-1);
        }
```

### SystemOutErr
Uses of `System.err` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/Tool.java`
#### Snippet
```java
            rc = tool.run(newArgs);
        } catch (Throwable t) {
            System.err.println("Fail to run tool " + toolClass + " : ");
            t.printStackTrace();
        }
```

### SystemOutErr
Uses of `System.err` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/Tool.java`
#### Snippet
```java
        Command cmd = commands.get(cmdName);
        if (null == cmd) {
            System.err.println("ERROR: Unknown command " + cmdName);
            printToolUsage();
            return -1;
```

### SystemOutErr
Uses of `System.err` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
            String[] args = cmdline.getArgs();
            if (args.length <= 0) {
                System.err.println("No distributedlog uri specified.");
                printUsage();
                return -1;
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
            }
            if (null == bkdlConfig) {
                System.out.println("No bookkeeper is bound to " + uri);
                return 0;
            } else {
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
                return 0;
            } else {
                System.out.println("There is bookkeeper bound to " + uri + " : ");
                System.out.println();
                System.out.println(bkdlConfig);
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
            } else {
                System.out.println("There is bookkeeper bound to " + uri + " : ");
                System.out.println();
                System.out.println(bkdlConfig);
                System.out.println();
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
                System.out.println("There is bookkeeper bound to " + uri + " : ");
                System.out.println();
                System.out.println(bkdlConfig);
                System.out.println();
                if (!force && !IOUtils.confirmPrompt("Do you want to unbind " + uri + " :\n")) {
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
                System.out.println();
                System.out.println(bkdlConfig);
                System.out.println();
                if (!force && !IOUtils.confirmPrompt("Do you want to unbind " + uri + " :\n")) {
                    return 0;
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
            }
            DLMetadata.unbind(uri);
            System.out.println("Unbound on " + uri + ".");
            return 0;
        }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
                    LogSegmentMetadataStoreUpdater.createMetadataUpdater(getConf(),
                            getLogSegmentMetadataStore());
            System.out.println("List of streams : ");
            System.out.println(streams);
            if (!IOUtils.confirmPrompt("Do you want to repair all these streams (Y/N):")) {
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
                            getLogSegmentMetadataStore());
            System.out.println("List of streams : ");
            System.out.println(streams);
            if (!IOUtils.confirmPrompt("Do you want to repair all these streams (Y/N):")) {
                return -1;
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
        }
        if (verbose) {
            System.out.println("- 0. checking streams under " + uri);
        }
        if (streams.size() == 0) {
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
        }
        if (streams.size() == 0) {
            System.out.println("+ 0. nothing to check. quit.");
            return;
        }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
                checkStreams(namespace, streams, scheduler, concurrency);
        if (verbose) {
            System.out.println("+ 0. " + streamCandidates.size() + " corrupted streams found.");
        }
        if (interactive && !IOUtils.confirmPrompt("Do you want to fix all "
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
        }
        if (verbose) {
            System.out.println("- 1. repairing " + streamCandidates.size() + " corrupted streams.");
        }
        for (StreamCandidate candidate : streamCandidates.values()) {
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
            if (!repairStream(metadataUpdater, candidate, verbose, interactive)) {
                if (verbose) {
                    System.out.println("* 1. aborted repairing corrupted streams.");
                }
                return;
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
        }
        if (verbose) {
            System.out.println("+ 1. repaired " + streamCandidates.size() + " corrupted streams.");
        }
    }
```

### SystemOutErr
Uses of `System.err` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
            if (null == bkdlConfig.getACLRootPath()) {
                // acl isn't enabled for this namespace.
                System.err.println("ACL isn't enabled for namespace " + getUri());
                return -1;
            }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
                                        boolean interactive) throws Exception {
        if (verbose) {
            System.out.println("Stream " + streamCandidate.streamName + " : ");
            for (LogSegmentCandidate segmentCandidate : streamCandidate.segmentCandidates) {
                System.out.println("  " + segmentCandidate.metadata.getLogSegmentSequenceNumber()
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
            System.out.println("Stream " + streamCandidate.streamName + " : ");
            for (LogSegmentCandidate segmentCandidate : streamCandidate.segmentCandidates) {
                System.out.println("  " + segmentCandidate.metadata.getLogSegmentSequenceNumber()
                        + " : metadata = " + segmentCandidate.metadata + ", last dlsn = "
                        + segmentCandidate.lastRecord.getDlsn());
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
                        + segmentCandidate.lastRecord.getDlsn());
            }
            System.out.println("-------------------------------------------");
        }
        if (interactive && !IOUtils.confirmPrompt("Do you want to fix the stream "
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
                    metadataUpdater.updateLastRecord(segmentCandidate.metadata, segmentCandidate.lastRecord));
            if (verbose) {
                System.out.println(" Fixed segment " + segmentCandidate.metadata.getLogSegmentSequenceNumber() + " : ");
                System.out.println("    old metadata : " + segmentCandidate.metadata);
                System.out.println("    new metadata : " + newMetadata);
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
            if (verbose) {
                System.out.println(" Fixed segment " + segmentCandidate.metadata.getLogSegmentSequenceNumber() + " : ");
                System.out.println("    old metadata : " + segmentCandidate.metadata);
                System.out.println("    new metadata : " + newMetadata);
            }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
                System.out.println(" Fixed segment " + segmentCandidate.metadata.getLogSegmentSequenceNumber() + " : ");
                System.out.println("    old metadata : " + segmentCandidate.metadata);
                System.out.println("    new metadata : " + newMetadata);
            }
        }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
        }
        if (verbose) {
            System.out.println("-------------------------------------------");
        }
        return true;
```

### SystemOutErr
Uses of `System.err` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
            boolean isQuery = cmdline.hasOption("q");
            if (!isQuery && (!cmdline.hasOption("l") || !cmdline.hasOption("s"))) {
                System.err.println("Error: Neither zkServers nor ledgersPath specified for bookkeeper environment.");
                printUsage();
                return -1;
```

### SystemOutErr
Uses of `System.err` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
            String[] args = cmdline.getArgs();
            if (args.length <= 0) {
                System.err.println("No distributedlog uri specified.");
                printUsage();
                return -1;
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
                }
                if (null == bkdlConfig) {
                    System.out.println("No bookkeeper is bound to " + uri);
                } else {
                    System.out.println("There is bookkeeper bound to " + uri + " : ");
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
                    System.out.println("No bookkeeper is bound to " + uri);
                } else {
                    System.out.println("There is bookkeeper bound to " + uri + " : ");
                    System.out.println();
                    System.out.println(bkdlConfig);
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
                } else {
                    System.out.println("There is bookkeeper bound to " + uri + " : ");
                    System.out.println();
                    System.out.println(bkdlConfig);
                    System.out.println();
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
                    System.out.println("There is bookkeeper bound to " + uri + " : ");
                    System.out.println();
                    System.out.println(bkdlConfig);
                    System.out.println();
                    if (!isQuery) {
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
                    System.out.println();
                    System.out.println(bkdlConfig);
                    System.out.println();
                    if (!isQuery) {
                        if (newBKDLConfig.equals(bkdlConfig)) {
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
                    if (!isQuery) {
                        if (newBKDLConfig.equals(bkdlConfig)) {
                            System.out.println("No bookkeeper binding needs to be updated. Quit.");
                            return 0;
                        } else if (!newBKDLConfig.isFederatedNamespace() && bkdlConfig.isFederatedNamespace()) {
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
                            return 0;
                        } else if (!newBKDLConfig.isFederatedNamespace() && bkdlConfig.isFederatedNamespace()) {
                            System.out.println("You can't turn a federated namespace back to non-federated.");
                            return 0;
                        } else {
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
                }
                if (isQuery) {
                    System.out.println("Done.");
                    return 0;
                }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
                    try {
                        dlMetadata.create(uri);
                        System.out.println("Created binding on " + uri + ".");
                    } catch (IOException ie) {
                        System.err.println("Failed to create binding on " + uri + " : " + ie.getMessage());
```

### SystemOutErr
Uses of `System.err` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
                        System.out.println("Created binding on " + uri + ".");
                    } catch (IOException ie) {
                        System.err.println("Failed to create binding on " + uri + " : " + ie.getMessage());
                    }
                } else {
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
                    try {
                        dlMetadata.update(uri);
                        System.out.println("Updated binding on " + uri + " : ");
                        System.out.println();
                        System.out.println(newBKDLConfig.toString());
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
                        dlMetadata.update(uri);
                        System.out.println("Updated binding on " + uri + " : ");
                        System.out.println();
                        System.out.println(newBKDLConfig.toString());
                        System.out.println();
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
                        System.out.println("Updated binding on " + uri + " : ");
                        System.out.println();
                        System.out.println(newBKDLConfig.toString());
                        System.out.println();
                    } catch (IOException ie) {
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
                        System.out.println();
                        System.out.println(newBKDLConfig.toString());
                        System.out.println();
                    } catch (IOException ie) {
                        System.err.println("Failed to update binding on " + uri + " : " + ie.getMessage());
```

### SystemOutErr
Uses of `System.err` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
                        System.out.println();
                    } catch (IOException ie) {
                        System.err.println("Failed to update binding on " + uri + " : " + ie.getMessage());
                    }
                }
```

### SystemOutErr
Uses of `System.err` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
            if (null == bkdlConfig.getACLRootPath()) {
                // acl isn't enabled for this namespace.
                System.err.println("ACL isn't enabled for namespace " + getUri());
                return -1;
            }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
            List<LogSegmentMetadata> segments = dlm.getLogSegments();
            if (verbose) {
                System.out.println("LogSegments for " + streamName + " : ");
                for (LogSegmentMetadata segment : segments) {
                    System.out.println(segment.getLogSegmentSequenceNumber() + "\t: " + segment);
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
                System.out.println("LogSegments for " + streamName + " : ");
                for (LogSegmentMetadata segment : segments) {
                    System.out.println(segment.getLogSegmentSequenceNumber() + "\t: " + segment);
                }
            }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
            LOG.info("Fixed {} : {} -> {} ", streamName, inprogressSegment, newSegment);
            if (verbose) {
                System.out.println("Fixed " + streamName + " : " + inprogressSegment.getZNodeName()
                                   + " -> " + newSegment.getZNodeName());
                System.out.println("\t old: " + inprogressSegment);
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
                System.out.println("Fixed " + streamName + " : " + inprogressSegment.getZNodeName()
                                   + " -> " + newSegment.getZNodeName());
                System.out.println("\t old: " + inprogressSegment);
                System.out.println("\t new: " + newSegment);
                System.out.println();
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
                                   + " -> " + newSegment.getZNodeName());
                System.out.println("\t old: " + inprogressSegment);
                System.out.println("\t new: " + newSegment);
                System.out.println();
            }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
                System.out.println("\t old: " + inprogressSegment);
                System.out.println("\t new: " + newSegment);
                System.out.println();
            }
        } finally {
```

### SystemOutErr
Uses of `System.err` should probably be replaced with more robust logging
in `bookkeeper-benchmark/src/main/java/org/apache/bookkeeper/benchmark/TestClient.java`
#### Snippet
```java
                    @Override
                    public void run() {
                        System.err.println("Timing out benchmark after " + timeout + "ms");
                        System.exit(-1);
                    }
```

### SystemOutErr
Uses of `System.err` should probably be replaced with more robust logging
in `bookkeeper-benchmark/src/main/java/org/apache/bookkeeper/benchmark/BenchThroughputLatency.java`
#### Snippet
```java
                    @Override
                    public void run() {
                        System.err.println("Timing out benchmark after " + timeout + "ms");
                        System.exit(-1);
                    }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                List<LogSegmentMetadata> segmentsToRepair = inspectLogSegments(bkc, segments);
                if (segmentsToRepair.isEmpty()) {
                    System.out.println("The stream is good. No log segments to repair.");
                    return 0;
                }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                    return 0;
                }
                System.out.println(segmentsToRepair.size() + " segments to repair : ");
                System.out.println(segmentsToRepair);
                System.out.println();
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                }
                System.out.println(segmentsToRepair.size() + " segments to repair : ");
                System.out.println(segmentsToRepair);
                System.out.println();
                if (!IOUtils.confirmPrompt("Do you want to repair them (Y/N): ")) {
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                System.out.println(segmentsToRepair.size() + " segments to repair : ");
                System.out.println(segmentsToRepair);
                System.out.println();
                if (!IOUtils.confirmPrompt("Do you want to repair them (Y/N): ")) {
                    return 0;
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java

        private void dumpRecord(LogRecord record) {
            System.out.println("------------------------------------------------");
            if (record instanceof LogRecordWithDLSN) {
                System.out.println("Record (txn = " + record.getTransactionId() + ", bytes = "
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
            System.out.println("------------------------------------------------");
            if (record instanceof LogRecordWithDLSN) {
                System.out.println("Record (txn = " + record.getTransactionId() + ", bytes = "
                        + record.getPayload().length + ", dlsn = "
                        + ((LogRecordWithDLSN) record).getDlsn() + ", sequence id = "
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                        + ((LogRecordWithDLSN) record).getSequenceId() + ")");
            } else {
                System.out.println("Record (txn = " + record.getTransactionId() + ", bytes = "
                        + record.getPayload().length + ")");
            }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                        + record.getPayload().length + ")");
            }
            System.out.println();

            if (skipPayload) {
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java

            if (printHex) {
                System.out.println(Hex.encodeHexString(record.getPayload()));
            } else {
                System.out.println(new String(record.getPayload(), UTF_8));
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                System.out.println(Hex.encodeHexString(record.getPayload()));
            } else {
                System.out.println(new String(record.getPayload(), UTF_8));
            }
        }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
            currentSet = updatedSet;

            System.out.println("Old streams : ");
            for (String stream : oldStreams) {
                System.out.println(stream);
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
            System.out.println("Old streams : ");
            for (String stream : oldStreams) {
                System.out.println(stream);
            }

```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
            }

            System.out.println("New streams : ");
            for (String stream : newStreams) {
                System.out.println(stream);
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
            System.out.println("New streams : ");
            for (String stream : newStreams) {
                System.out.println(stream);
            }

```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
            }

            System.out.println();
        }

```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                byte[] bytes = dlsn.serializeBytes();
                String hexString = Hex.encodeHexString(bytes);
                System.out.println(hexString);
            } else {
                System.out.println(dlsn.serialize());
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                System.out.println(hexString);
            } else {
                System.out.println(dlsn.serialize());
            }
            return 0;
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                pw.close();
            }
            System.out.println("Dump " + ledgers.size() + " ledgers to file : " + targetFile);
        }

```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
            Enumeration<LedgerEntry> entries = lh.readEntries(fromEntryId, untilEntryId);
            long i = fromEntryId;
            System.out.println("Entries:");
            while (entries.hasMoreElements()) {
                LedgerEntry entry = entries.nextElement();
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
            while (entries.hasMoreElements()) {
                LedgerEntry entry = entries.nextElement();
                System.out.println("\t" + i  + "(eid=" + entry.getEntryId() + ")\t: ");
                Entry.Reader reader = Entry.newBuilder()
                        .setLogSegmentInfo(0L, 0L)
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                return 0;
            }
            System.out.println("Streams : " + streams);
            if (!getForce() && !IOUtils.confirmPrompt("Do you want to truncate " + streams.size() + " streams ?")) {
                return 0;
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                for (LogSegmentMetadata segment : segments) {
                    if (getLedgerID() == segment.getLogSegmentId()) {
                        System.out.println("Found ledger " + getLedgerID() + " at log segment "
                                + segment + " for stream '" + logName + "'");
                        return true;
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
            try {
                long spaceUsage = dlAuditor.calculateLedgerSpaceUsage(uri);
                System.out.println("bookkeeper ledgers space usage \t " + spaceUsage);
            } finally {
                dlAuditor.close();
```

### SystemOutErr
Uses of `System.err` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                parseCommandLine(commandLine);
            } catch (ParseException pe) {
                System.err.println("ERROR: failed to parse commandline : '" + pe.getMessage() + "'");
                printUsage();
                return -1;
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
        private void printEppStatsHeader(DistributedLogManager dlm) throws Exception {
            String label = "Ledger Placement :";
            System.out.println(label);
            Map<BookieId, Integer> totals = new HashMap<BookieId, Integer>();
            List<LogSegmentMetadata> segments = dlm.getLogSegments();
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
            }
            for (Map.Entry<BookieId, Integer> entry : entries) {
                System.out.println(String.format("%" + width + "s\t%6.2f%%\t\t%d",
                        entry.getKey(), entry.getValue() * 1.0 / totalEntries, entry.getValue()));
            }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
            try {
                long lac = lh.readLastConfirmed();
                System.out.println("LastAddConfirmed: " + lac);
            } finally {
                lh.close();
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                                        LogSegmentMetadata segment) throws Exception {
            if (segment.isInProgress()) {
                System.out.println("Skip inprogress log segment " + segment);
                return;
            }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                throw new IOException("No record found in entry " + lac + " for " + segment);
            }
            System.out.println("Updating last record for " + segment + " to " + lastRecord);
            if (!IOUtils.confirmPrompt("Do you want to make this change (Y/N): ")) {
                return;
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                                            LogSegmentMetadata metadata) throws Exception {
            if (metadata.isInProgress()) {
                System.out.println("Skip inprogress log segment " + metadata);
                return true;
            }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                }
                if (lastEntryId != lh.getLastAddConfirmed()) {
                    System.out.println("Inconsistent Last Add Confirmed Found for LogSegment "
                            + metadata.getLogSegmentSequenceNumber() + ": ");
                    System.out.println("\t metadata: " + metadata);
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                    System.out.println("Inconsistent Last Add Confirmed Found for LogSegment "
                            + metadata.getLogSegmentSequenceNumber() + ": ");
                    System.out.println("\t metadata: " + metadata);
                    System.out.println("\t lac in ledger metadata is " + lh.getLastAddConfirmed()
                            + ", but lac in bookies is " + lastEntryId);
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                            + metadata.getLogSegmentSequenceNumber() + ": ");
                    System.out.println("\t metadata: " + metadata);
                    System.out.println("\t lac in ledger metadata is " + lh.getLastAddConfirmed()
                            + ", but lac in bookies is " + lastEntryId);
                    return false;
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
            }
            if (numRead == 0) {
                System.out.println("No records.");
            } else {
                System.out.println("------------------------------------------------");
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                System.out.println("No records.");
            } else {
                System.out.println("------------------------------------------------");
            }
        }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                        @Override
                        public void onFailure(Throwable cause) {
                            System.out.println("Failed to delete subscriber for stream " + s);
                            cause.printStackTrace();
                            countDownLatch.countDown();
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                    try {
                        if (!FutureUtils.result(writer.truncate(dlsn))) {
                            System.out.println("Failed to truncate.");
                        }
                        return 0;
```

### SystemOutErr
Uses of `System.err` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                }
            } catch (Exception ex) {
                System.err.println("Failed to truncate " + ex);
                return 1;
            } finally {
```

### SystemOutErr
Uses of `System.err` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                parseCommandLine(commandLine);
            } catch (ParseException pe) {
                System.err.println("ERROR: failed to parse commandline : '" + pe.getMessage() + "'");
                printUsage();
                return -1;
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                try {
                    DLSN lastDLSN = FutureUtils.result(dlm.getLastDLSNAsync());
                    System.out.println("Last DLSN : " + lastDLSN);
                    if (null == fromDLSN) {
                        reader = dlm.getAsyncLogReader(fromTxnId);
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                    }
                } catch (LogNotFoundException lee) {
                    System.out.println("No stream found to dump records.");
                    return 0;
                }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                }
                try {
                    System.out.println(String.format("Dump records for %s (from = %s, dump"
                            + " count = %d, total records = %d)", getStreamName(), startOffset, count, totalCount));

```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                    throw new IOException("Failed to read entry " + eid);
                }
                System.out.println("\t" + eid + "\t:");
                for (LedgerReader.ReadResult<Long> rr : readResults) {
                    System.out.println("\tbookie=" + rr.getBookieAddress());
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                System.out.println("\t" + eid + "\t:");
                for (LedgerReader.ReadResult<Long> rr : readResults) {
                    System.out.println("\tbookie=" + rr.getBookieAddress());
                    System.out.println("\t-------------------------------");
                    if (BKException.Code.OK == rr.getResultCode()) {
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                for (LedgerReader.ReadResult<Long> rr : readResults) {
                    System.out.println("\tbookie=" + rr.getBookieAddress());
                    System.out.println("\t-------------------------------");
                    if (BKException.Code.OK == rr.getResultCode()) {
                        System.out.println("Eid = " + rr.getEntryId() + ", Lac = " + rr.getValue());
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                    System.out.println("\t-------------------------------");
                    if (BKException.Code.OK == rr.getResultCode()) {
                        System.out.println("Eid = " + rr.getEntryId() + ", Lac = " + rr.getValue());
                    } else {
                        System.out.println("status = " + BKException.getMessage(rr.getResultCode()));
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                        System.out.println("Eid = " + rr.getEntryId() + ", Lac = " + rr.getValue());
                    } else {
                        System.out.println("status = " + BKException.getMessage(rr.getResultCode()));
                    }
                    System.out.println("\t-------------------------------");
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                        System.out.println("status = " + BKException.getMessage(rr.getResultCode()));
                    }
                    System.out.println("\t-------------------------------");
                }
            }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
            generateStreams(streamPrefix, streamExpression);
            if (streams.isEmpty()) {
                System.out.println("Nothing to create.");
                return 0;
            }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                                                        allocationExecutor);
                                        allocator.delete();
                                        System.out.println("Deleted allocator pool : " + poolPath + " .");
                                    } catch (IOException ioe) {
                                        System.err.println("Failed to delete allocator pool "
```

### SystemOutErr
Uses of `System.err` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                                        System.out.println("Deleted allocator pool : " + poolPath + " .");
                                    } catch (IOException ioe) {
                                        System.err.println("Failed to delete allocator pool "
                                                + poolPath + " : " + ioe.getMessage());
                                    }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                                }
                                doneLatch.countDown();
                                System.out.println("Thread " + tid + " is done.");
                            }
                        });
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                    }
                } else {
                    System.out.println("No entries.");
                }
            } finally {
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
            printHeader(dlm);
            if (listSegments) {
                System.out.println("Ledgers : ");
                List<LogSegmentMetadata> segments = dlm.getLogSegments();
                for (LogSegmentMetadata segment : segments) {
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                    new TreeMap<String, List<Pair<LogSegmentMetadata, List<String>>>>();
            inspectStreams(corruptedCandidates);
            System.out.println("Corrupted Candidates : ");
            if (printStreamsOnly) {
                System.out.println(corruptedCandidates.keySet());
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
            System.out.println("Corrupted Candidates : ");
            if (printStreamsOnly) {
                System.out.println(corruptedCandidates.keySet());
                return 0;
            }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
            for (Map.Entry<String, List<Pair<LogSegmentMetadata,
                    List<String>>>> entry : corruptedCandidates.entrySet()) {
                System.out.println(entry.getKey() + " : \n");
                for (Pair<LogSegmentMetadata, List<String>> pair : entry.getValue()) {
                    System.out.println("\t - " + pair.getLeft());
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                System.out.println(entry.getKey() + " : \n");
                for (Pair<LogSegmentMetadata, List<String>> pair : entry.getValue()) {
                    System.out.println("\t - " + pair.getLeft());
                    if (printInprogressOnly && dumpEntries) {
                        int i = 0;
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                        int i = 0;
                        for (String entryData : pair.getRight()) {
                            System.out.println("\t" + i + "\t: " + entryData);
                            ++i;
                        }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                    }
                }
                System.out.println();
            }
            return 0;
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                return 0;
            }
            System.out.println("Streams : " + streams);
            if (!getForce() && !IOUtils.confirmPrompt("Do you want to delete subscriber "
                + subscriberId + " for " + streams.size() + " streams ?")) {
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                                    int numLedgersDeleted = numLedgers.incrementAndGet();
                                    if (numLedgersDeleted % 1000 == 0) {
                                        System.out.println("Deleted " + numLedgersDeleted + " ledgers.");
                                    }
                                } catch (BKException.BKNoSuchLedgerExistsOnMetadataServerException e) {
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                                    int numLedgersDeleted = numLedgers.incrementAndGet();
                                    if (numLedgersDeleted % 1000 == 0) {
                                        System.out.println("Deleted " + numLedgersDeleted + " ledgers.");
                                    }
                                } catch (Exception e) {
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                            }
                            doneLatch.countDown();
                            System.out.println("Thread " + tid + " quits");
                        }
                    });
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
        @Override
        protected int runSimpleCmd() throws Exception {
            System.out.println(DLSN.deserialize(base64Dlsn));
            return 0;
        }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                        try {
                            inspectStreams(streams, tid, numStreamsPerThreads, corruptedCandidates);
                            System.out.println("Thread " + tid + " finished.");
                        } catch (Exception e) {
                            System.err.println("Thread " + tid + " quits with exception : " + e.getMessage());
```

### SystemOutErr
Uses of `System.err` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                            System.out.println("Thread " + tid + " finished.");
                        } catch (Exception e) {
                            System.err.println("Thread " + tid + " quits with exception : " + e.getMessage());
                        }
                    }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                        try {
                            truncateStreams(namespace, streams, tid, numStreamsPerThreads);
                            System.out.println("Thread " + tid + " finished.");
                        } catch (IOException e) {
                            System.err.println("Thread " + tid + " quits with exception : " + e.getMessage());
```

### SystemOutErr
Uses of `System.err` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                            System.out.println("Thread " + tid + " finished.");
                        } catch (IOException e) {
                            System.err.println("Thread " + tid + " quits with exception : " + e.getMessage());
                        }
                    }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                String logName = logs.next();
                if (processLog(logName)) {
                    System.out.println("Found ledger " + getLedgerID() + " at log stream '" + logName + "'");
                }
            }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java

        private void printLedgerRow(LogSegmentMetadata segment) throws Exception {
            System.out.println(segment.getLogSegmentSequenceNumber() + "\t: " + segment);
        }

```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                        try {
                            deleteSubscriber(namespace, streams, tid, numStreamsPerThreads);
                            System.out.println("Thread " + tid + " finished.");
                        } catch (Exception e) {
                            System.err.println("Thread " + tid + " quits with exception : " + e.getMessage());
```

### SystemOutErr
Uses of `System.err` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                            System.out.println("Thread " + tid + " finished.");
                        } catch (Exception e) {
                            System.err.println("Thread " + tid + " quits with exception : " + e.getMessage());
                        }
                    }
```

### SystemOutErr
Uses of `System.err` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                parseCommandLine(commandLine);
            } catch (ParseException pe) {
                System.err.println("ERROR: failed to parse commandline : '" + pe.getMessage() + "'");
                printUsage();
                return -1;
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
            LogRecordWithDLSN record = reader.nextRecord();
            while (null != record) {
                System.out.println("\t" + record);
                if (!skipPayload) {
                    if (printHex) {
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                if (!skipPayload) {
                    if (printHex) {
                        System.out.println(Hex.encodeHexString(record.getPayload()));
                    } else {
                        System.out.println(new String(record.getPayload(), UTF_8));
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                        System.out.println(Hex.encodeHexString(record.getPayload()));
                    } else {
                        System.out.println(new String(record.getPayload(), UTF_8));
                    }
                }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                    }
                }
                System.out.println();
                record = reader.nextRecord();
            }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                    count = countFromStartToEnd(dlm);
                }
                System.out.println("total is " + count + " records.");
                return 0;
            } finally {
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
        protected void printStreams(Namespace namespace) throws Exception {
            Iterator<String> streams = namespace.getLogs();
            System.out.println("Streams under " + getUri() + " : ");
            System.out.println("--------------------------------");
            while (streams.hasNext()) {
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
            Iterator<String> streams = namespace.getLogs();
            System.out.println("Streams under " + getUri() + " : ");
            System.out.println("--------------------------------");
            while (streams.hasNext()) {
                String streamName = streams.next();
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
            while (streams.hasNext()) {
                String streamName = streams.next();
                System.out.println(streamName);
                if (!printMetadata) {
                    continue;
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                }
                if (printHex) {
                    System.out.println(Hex.encodeHexString(metadata));
                } else {
                    System.out.println(new String(metadata, UTF_8));
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                    System.out.println(Hex.encodeHexString(metadata));
                } else {
                    System.out.println(new String(metadata, UTF_8));
                }
                System.out.println();
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                    System.out.println(new String(metadata, UTF_8));
                }
                System.out.println();
            }
            System.out.println("--------------------------------");
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                System.out.println();
            }
            System.out.println("--------------------------------");
        }
    }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
        private void printSpaceUsage(Map<String, Long> spaceMap) throws Exception {
            for (Map.Entry<String, Long> entry : spaceMap.entrySet()) {
                System.out.println(entry.getKey() + "\t" + entry.getValue());
            }
        }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                    LogRecordWithDLSN record = reader.readNext(false);
                    LogRecordWithDLSN preRecord = record;
                    System.out.println("first record : " + record);
                    while (null != record) {
                        if (record.getDlsn().compareTo(endDLSN) > 0) {
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                        record = reader.readNext(false);
                    }
                    System.out.println("last record : " + preRecord);
                } finally {
                    reader.close();
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                        if (BKException.Code.DigestMatchException == rr.getResultCode()) {
                            if (printHeader) {
                                System.out.println("\t" + eid + "\t:");
                                printHeader = false;
                            }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                                printHeader = false;
                            }
                            System.out.println("\tbookie=" + rr.getBookieAddress());
                            System.out.println("\t-------------------------------");
                            System.out.println("status = " + BKException.getMessage(rr.getResultCode()));
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                            }
                            System.out.println("\tbookie=" + rr.getBookieAddress());
                            System.out.println("\t-------------------------------");
                            System.out.println("status = " + BKException.getMessage(rr.getResultCode()));
                            System.out.println("\t-------------------------------");
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                            System.out.println("\tbookie=" + rr.getBookieAddress());
                            System.out.println("\t-------------------------------");
                            System.out.println("status = " + BKException.getMessage(rr.getResultCode()));
                            System.out.println("\t-------------------------------");
                        }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                            System.out.println("\t-------------------------------");
                            System.out.println("status = " + BKException.getMessage(rr.getResultCode()));
                            System.out.println("\t-------------------------------");
                        }
                    } else {
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                    } else {
                        if (printHeader) {
                            System.out.println("\t" + eid + "\t:");
                            printHeader = false;
                        }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                            printHeader = false;
                        }
                        System.out.println("\tbookie=" + rr.getBookieAddress());
                        System.out.println("\t-------------------------------");
                        if (BKException.Code.OK == rr.getResultCode()) {
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                        }
                        System.out.println("\tbookie=" + rr.getBookieAddress());
                        System.out.println("\t-------------------------------");
                        if (BKException.Code.OK == rr.getResultCode()) {
                            Entry.Reader reader = Entry.newBuilder()
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                            printEntry(reader);
                        } else {
                            System.out.println("status = " + BKException.getMessage(rr.getResultCode()));
                        }
                        System.out.println("\t-------------------------------");
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                            System.out.println("status = " + BKException.getMessage(rr.getResultCode()));
                        }
                        System.out.println("\t-------------------------------");
                    }
                }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                            + " lastDlsn=%s, endOfStreamMarked=%b, recordCount=%d)",
                firstTxnId, lastTxnId, getDlsnName(firstDlsn), getDlsnName(lastDlsn), endOfStreamMarked, recordCount);
            System.out.println(result);
            if (listEppStats) {
                printEppStatsHeader(dlm);
```

## RuleId[id=ImplicitArrayToString]
### ImplicitArrayToString
Implicit call to 'toString()' on array `wanted`
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
                    if (!cfNames.contains(wanted) && cfNames.contains(other)) {
                        throw new StateStoreException(String.format("{}: expected {} column family, found {}",
                                dbDir.getAbsolutePath(), wanted, other));
                    }
                }
```

### ImplicitArrayToString
Implicit call to 'toString()' on array `other`
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
                    if (!cfNames.contains(wanted) && cfNames.contains(other)) {
                        throw new StateStoreException(String.format("{}: expected {} column family, found {}",
                                dbDir.getAbsolutePath(), wanted, other));
                    }
                }
```

## RuleId[id=DynamicRegexReplaceableByCompiledPattern]
### DynamicRegexReplaceableByCompiledPattern
`matches()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/BookieId.java`
#### Snippet
```java
    private static void validateBookieId(String id) {
        Objects.requireNonNull(id, "BookieId cannot be null");
        if (!(id.matches("[a-zA-Z0-9:-_.\\-]+"))
                || "readonly".equalsIgnoreCase(id)) {
            throw new IllegalArgumentException("BookieId " + id + " is not valid");
```

### DynamicRegexReplaceableByCompiledPattern
`replace()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/AbstractConfiguration.java`
#### Snippet
```java
                    "zk+%s://%s%s",
                    ledgerManagerType,
                    zkServers.replace(",", ";"),
                    getZkLedgersRootPath());
            }
```

### DynamicRegexReplaceableByCompiledPattern
`replace()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/LongZkLedgerIdGenerator.java`
#### Snippet
```java
            .map((t) -> {
                    try {
                        return Long.parseLong(t.replace(hobPrefix, ""));
                    } catch (NumberFormatException e) {
                        return null;
```

### DynamicRegexReplaceableByCompiledPattern
`replace()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/LongZkLedgerIdGenerator.java`
#### Snippet
```java
                    .map((t) -> {
                            try {
                                return Long.parseLong(t.replace(hobPrefix, ""));
                            } catch (NumberFormatException e) {
                                return null;
```

### DynamicRegexReplaceableByCompiledPattern
`replace()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/zk/ZKMetadataDriverBase.java`
#### Snippet
```java
            throw new IllegalArgumentException("Invalid metadata service URI format: " + uri);
        }
        return authority.replace(";", ",");
    }

```

### DynamicRegexReplaceableByCompiledPattern
`split()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/HardLink.java`
#### Snippet
```java
      }
      if (OS_TYPE == OSType.OS_TYPE_SOLARIS) {
        String[] result = inpMsg.split("\\s+");
        return Integer.parseInt(result[1]);
      } else {
```

### DynamicRegexReplaceableByCompiledPattern
`replace()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/ZkUtils.java`
#### Snippet
```java
            public void processResult(int rc, String path, Object ctx) {
                if (rc == Code.OK.intValue()) {
                    String parent = new File(originalPath).getParent().replace("\\", "/");
                    zk.getData(parent, false, (dRc, dPath, dCtx, data, stat) -> {
                        if (Code.OK.intValue() == dRc && (stat != null && stat.getNumChildren() == 0)) {
```

### DynamicRegexReplaceableByCompiledPattern
`replace()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/ZkUtils.java`
#### Snippet
```java
                // create mode is persistent since ephemeral nodes can't be
                // parents
                String parent = new File(originalPath).getParent().replace("\\", "/");
                asyncCreateFullPathOptimistic(zk, parent, new byte[0], acl,
                        CreateMode.PERSISTENT, new StringCallback() {
```

### DynamicRegexReplaceableByCompiledPattern
`replace()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/DefaultEntryLogger.java`
#### Snippet
```java
        String newSuffix = ".log." + DefaultEntryLogger.logId2HexString(compactingLogId)
            + TransactionalEntryLogCompactor.COMPACTED_SUFFIX;
        String hardLinkFilename = filename.replace(TransactionalEntryLogCompactor.COMPACTING_SUFFIX, newSuffix);
        return new File(dir, hardLinkFilename);
    }
```

### DynamicRegexReplaceableByCompiledPattern
`split()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/DefaultEntryLogger.java`
#### Snippet
```java

            for (File f : files) {
                Long entryLogId = Long.parseLong(f.getName().split(".log")[0], 16);
                entryLogs.add(entryLogId);
            }
```

### DynamicRegexReplaceableByCompiledPattern
`replace()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/IndexPersistenceMgr.java`
#### Snippet
```java
                                // name is the HexString representation of the
                                // ledgerId.
                                String ledgerIdInHex = index.getName().replace(RLOC, "").replace(IDX, "");
                                long ledgerId = Long.parseLong(ledgerIdInHex, 16);
                                if (index.getName().endsWith(RLOC)) {
```

### DynamicRegexReplaceableByCompiledPattern
`replace()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/IndexPersistenceMgr.java`
#### Snippet
```java
                                // name is the HexString representation of the
                                // ledgerId.
                                String ledgerIdInHex = index.getName().replace(RLOC, "").replace(IDX, "");
                                long ledgerId = Long.parseLong(ledgerIdInHex, 16);
                                if (index.getName().endsWith(RLOC)) {
```

### DynamicRegexReplaceableByCompiledPattern
`split()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `cpu-affinity/src/main/java/org/apache/bookkeeper/common/util/affinity/impl/ProcessorsInfo.java`
#### Snippet
```java
        ProcessorsInfo pi = new ProcessorsInfo();

        for (String cpu : cpuInfoString.split("\n\n")) {
            int cpuId = -1;
            int coreId = -1;
```

### DynamicRegexReplaceableByCompiledPattern
`replace()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/BKNamespaceDriver.java`
#### Snippet
```java
     */
    public static String getZKServersFromDLUri(URI uri) {
        return uri.getAuthority().replace(";", ",");
    }

```

### DynamicRegexReplaceableByCompiledPattern
`split()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/federated/FederatedZKLogMetadataStore.java`
#### Snippet
```java

    private String getNamespaceFromZkPath(String zkPath) throws UnexpectedException {
        String[] parts = zkPath.split(SUB_NAMESPACE_PREFIX);
        if (parts.length <= 0) {
            throw new UnexpectedException("Invalid namespace @ " + zkPath);
```

## RuleId[id=ComparatorMethodParameterNotUsed]
### ComparatorMethodParameterNotUsed
Comparator never returns negative value
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/CheckpointSource.java`
#### Snippet
```java

            @Override
            public int compareTo(Checkpoint o) {
                if (o == MAX) {
                    return 0;
```

### ComparatorMethodParameterNotUsed
Comparator never returns positive value
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/CheckpointSource.java`
#### Snippet
```java
        Checkpoint MIN = new Checkpoint() {
            @Override
            public int compareTo(Checkpoint o) {
                if (o == MIN) {
                    return 0;
```

## RuleId[id=SuspiciousToArrayCall]
### SuspiciousToArrayCall
Array of type 'org.apache.distributedlog.io.AsyncCloseable\[\]' expected, 'org.apache.distributedlog.api.AsyncLogReader\[\]' found
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKDistributedLogManager.java`
#### Snippet
```java
        @Override
        public CompletableFuture<Void> asyncClose() {
            return Utils.closeSequence(executorService, true, readers.toArray(new AsyncLogReader[readers.size()]))
                    .thenApply(value -> {
                        readers.clear();
```

## RuleId[id=NonProtectedConstructorInAbstractClass]
### NonProtectedConstructorInAbstractClass
Constructor `AbstractHierarchicalLedgerManager()` of an abstract class should not be declared 'public'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/AbstractHierarchicalLedgerManager.java`
#### Snippet
```java
     *          ZooKeeper Client Handle
     */
    public AbstractHierarchicalLedgerManager(AbstractConfiguration conf, ZooKeeper zk) {
        super(conf, zk);
    }
```

### NonProtectedConstructorInAbstractClass
Constructor `OrderedGenericCallback()` of an abstract class should not be declared 'public'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/OrderedGenericCallback.java`
#### Snippet
```java
     *                    should run on.
     */
    public OrderedGenericCallback(OrderedExecutor executor, long orderingKey) {
        this.executor = executor;
        this.orderingKey = orderingKey;
```

### NonProtectedConstructorInAbstractClass
Constructor `DiskException()` of an abstract class should not be declared 'public'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/DiskChecker.java`
#### Snippet
```java
     */
    public abstract static class DiskException extends IOException {
        public DiskException(String msg) {
            super(msg);
        }
```

### NonProtectedConstructorInAbstractClass
Constructor `PacketProcessorBaseV3()` of an abstract class should not be declared 'public'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PacketProcessorBaseV3.java`
#### Snippet
```java
    final long enqueueNanos;

    public PacketProcessorBaseV3(Request request, BookieRequestHandler requestHandler,
                                 BookieRequestProcessor requestProcessor) {
        this.request = request;
```

### NonProtectedConstructorInAbstractClass
Constructor `Shell()` of an abstract class should not be declared 'public'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/Shell.java`
#### Snippet
```java
     *        command.
     */
    public Shell(long interval) {
        this.interval = interval;
        this.lastTime = (interval < 0) ? 0 : -interval;
```

### NonProtectedConstructorInAbstractClass
Constructor `Shell()` of an abstract class should not be declared 'public'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/Shell.java`
#### Snippet
```java
    private volatile AtomicBoolean completed;

    public Shell() {
        this(0L);
    }
```

### NonProtectedConstructorInAbstractClass
Constructor `DigestManager()` of an abstract class should not be declared 'public'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/checksum/DigestManager.java`
#### Snippet
```java
    final int macCodeLength;

    public DigestManager(long ledgerId, boolean useV2Protocol, ByteBufAllocator allocator) {
        this.ledgerId = ledgerId;
        this.useV2Protocol = useV2Protocol;
```

### NonProtectedConstructorInAbstractClass
Constructor `CompletionValue()` of an abstract class should not be declared 'public'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
        protected long startTime;

        public CompletionValue(String operationName,
                               Object ctx,
                               long ledgerId, long entryId,
```

### NonProtectedConstructorInAbstractClass
Constructor `BookieException()` of an abstract class should not be declared 'public'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieException.java`
#### Snippet
```java
    private final int code;

    public BookieException(int code) {
        super();
        this.code = code;
```

### NonProtectedConstructorInAbstractClass
Constructor `BookieException()` of an abstract class should not be declared 'public'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieException.java`
#### Snippet
```java
    }

    public BookieException(int code, Throwable t) {
        super(t);
        this.code = code;
```

### NonProtectedConstructorInAbstractClass
Constructor `BookieException()` of an abstract class should not be declared 'public'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieException.java`
#### Snippet
```java
    }

    public BookieException(int code, String reason, Throwable t) {
        super(reason, t);
        this.code = code;
```

### NonProtectedConstructorInAbstractClass
Constructor `BookieException()` of an abstract class should not be declared 'public'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieException.java`
#### Snippet
```java
    }

    public BookieException(int code, String reason) {
        super(reason);
        this.code = code;
```

### NonProtectedConstructorInAbstractClass
Constructor `AbstractLogCompactor()` of an abstract class should not be declared 'public'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/AbstractLogCompactor.java`
#### Snippet
```java
    protected final LogRemovalListener logRemovalListener;

    public AbstractLogCompactor(ServerConfiguration conf, LogRemovalListener logRemovalListener) {
        this.conf = conf;
        this.throttler = new Throttler(conf);
```

### NonProtectedConstructorInAbstractClass
Constructor `AbstractHttpHandlerFactory()` of an abstract class should not be declared 'public'
in `bookkeeper-http/http-server/src/main/java/org/apache/bookkeeper/http/AbstractHttpHandlerFactory.java`
#### Snippet
```java
     * @param httpServiceProvider the http service provider
     */
    public AbstractHttpHandlerFactory(HttpServiceProvider httpServiceProvider) {
        this.httpServiceProvider = httpServiceProvider;
    }
```

### NonProtectedConstructorInAbstractClass
Constructor `HttpRouter()` of an abstract class should not be declared 'public'
in `bookkeeper-http/http-server/src/main/java/org/apache/bookkeeper/http/HttpRouter.java`
#### Snippet
```java
    private final Map<String, Handler> endpointHandlers = new HashMap<>();

    public HttpRouter(AbstractHttpHandlerFactory<Handler> handlerFactory) {
        this.endpointHandlers.put(HEARTBEAT, handlerFactory.newHandler(HttpServer.ApiType.HEARTBEAT));
        this.endpointHandlers.put(SERVER_CONFIG, handlerFactory.newHandler(HttpServer.ApiType.SERVER_CONFIG));
```

### NonProtectedConstructorInAbstractClass
Constructor `DNSResolver()` of an abstract class should not be declared 'public'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/net/DNSResolver.java`
#### Snippet
```java
     *          pairs of host-region mapping separated by ';'
     */
    public DNSResolver(String hostRegionOverrides) {
        if (StringUtils.isNotBlank(hostRegionOverrides)) {
            // Host Region Overrides are of the form
```

### NonProtectedConstructorInAbstractClass
Constructor `DNSResolver()` of an abstract class should not be declared 'public'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/net/DNSResolver.java`
#### Snippet
```java
     * Construct the default dns resolver without host-region overrides.
     */
    public DNSResolver() {
        this("");
    }
```

## RuleId[id=CaughtExceptionImmediatelyRethrown]
### CaughtExceptionImmediatelyRethrown
Caught exception `e` is immediately rethrown
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/mvcc/MVCCStoreImpl.java`
#### Snippet
```java
        try {
            record = getKeyRecord(key, rawKey);
        } catch (StateStoreRuntimeException e) {
            throw e;
        }
```

## RuleId[id=AssignmentToMethodParameter]
### AssignmentToMethodParameter
Assignment to method parameter `nextRangeId`
in `stream/proto/src/main/java/org/apache/bookkeeper/stream/protocol/util/ProtoUtils.java`
#### Snippet
```java
                endKey = Long.MAX_VALUE;
            }
            long rangeId = nextRangeId++;
            RangeProperties props = RangeProperties.newBuilder()
                .setStartHashKey(startKey)
```

### AssignmentToMethodParameter
Assignment to method parameter `path`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NodeBase.java`
#### Snippet
```java
     */
    public NodeBase(String path) {
        path = normalize(path);
        int index = path.lastIndexOf(PATH_SEPARATOR);
        if (index == -1) {
```

### AssignmentToMethodParameter
Assignment to method parameter `distanceFromLeaves`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NodeBase.java`
#### Snippet
```java
            }
            node = parent;
            distanceFromLeaves--;
        }
        return node.getNetworkLocation();
```

### AssignmentToMethodParameter
Assignment to method parameter `names`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/CachedDNSToSwitchMapping.java`
#### Snippet
```java
  public List<String> resolve(List<String> names) {
    // normalize all input names to be in the form of IP addresses
    names = NetUtils.normalizeHostNames(names);

    List <String> result = new ArrayList<String>(names.size());
```

### AssignmentToMethodParameter
Assignment to method parameter `leafIndex`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NetworkTopologyImpl.java`
#### Snippet
```java
                    if (excludedIndex != -1 && leafIndex >= 0) {
                        // excluded node is one of the children so adjust the leaf index
                        leafIndex = leafIndex >= excludedIndex ? leafIndex + 1 : leafIndex;
                    }
                }
```

### AssignmentToMethodParameter
Assignment to method parameter `excludedNode`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NetworkTopologyImpl.java`
#### Snippet
```java
                    } else { // it is the excluededNode
                        // skip it and set the excludedNode to be null
                        excludedNode = null;
                    }
                }
```

### AssignmentToMethodParameter
Assignment to method parameter `loc`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NetworkTopologyImpl.java`
#### Snippet
```java
        netlock.readLock().lock();
        try {
            loc = NodeBase.normalize(loc);
            if (!NodeBase.ROOT.equals(loc)) {
                loc = loc.substring(1);
```

### AssignmentToMethodParameter
Assignment to method parameter `loc`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NetworkTopologyImpl.java`
#### Snippet
```java
            loc = NodeBase.normalize(loc);
            if (!NodeBase.ROOT.equals(loc)) {
                loc = loc.substring(1);
            }
            return clusterMap.getLoc(loc);
```

### AssignmentToMethodParameter
Assignment to method parameter `excludedScope`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NetworkTopologyImpl.java`
#### Snippet
```java
            }
            if (!excludedScope.startsWith(scope)) {
                excludedScope = null;
            }
        }
```

### AssignmentToMethodParameter
Assignment to method parameter `loc`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NetworkTopologyImpl.java`
#### Snippet
```java
        netlock.readLock().lock();
        try {
            loc = NodeBase.normalize(loc);
            if (!NodeBase.ROOT.equals(loc)) {
                loc = loc.substring(1);
```

### AssignmentToMethodParameter
Assignment to method parameter `loc`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NetworkTopologyImpl.java`
#### Snippet
```java
            loc = NodeBase.normalize(loc);
            if (!NodeBase.ROOT.equals(loc)) {
                loc = loc.substring(1);
            }
            InnerNode rack = (InnerNode) clusterMap.getLoc(loc);
```

### AssignmentToMethodParameter
Assignment to method parameter `scope`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NetworkTopologyImpl.java`
#### Snippet
```java
        if (scope.startsWith(INVERSE)) {
            isExcluded = true;
            scope = scope.substring(1);
        }
        scope = NodeBase.normalize(scope);
```

### AssignmentToMethodParameter
Assignment to method parameter `scope`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NetworkTopologyImpl.java`
#### Snippet
```java
            scope = scope.substring(1);
        }
        scope = NodeBase.normalize(scope);
        int count = 0; // the number of nodes in both scope & excludedNodes
        netlock.readLock().lock();
```

### AssignmentToMethodParameter
Assignment to method parameter `leftFactoryClass`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/AbstractZkLedgerManagerFactory.java`
#### Snippet
```java
    private static boolean isSameLedgerManagerFactory(
            AbstractConfiguration<?> conf, String leftFactoryClass, String rightFactoryClass) {
        leftFactoryClass = normalizedLedgerManagerFactoryClassName(
            leftFactoryClass,
            conf.getShadedLedgerManagerFactoryClassPrefix(),
```

### AssignmentToMethodParameter
Assignment to method parameter `rightFactoryClass`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/AbstractZkLedgerManagerFactory.java`
#### Snippet
```java
            conf.getShadedLedgerManagerFactoryClassPrefix(),
            conf.isShadedLedgerManagerFactoryClassAllowed());
        rightFactoryClass = normalizedLedgerManagerFactoryClassName(
            rightFactoryClass,
            conf.getShadedLedgerManagerFactoryClassPrefix(),
```

### AssignmentToMethodParameter
Assignment to method parameter `factoryClass`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/AbstractZkLedgerManagerFactory.java`
#### Snippet
```java
            String lmType = conf.getLedgerManagerType();
            if (lmType == null) {
                factoryClass = HierarchicalLedgerManagerFactory.class;
            } else {
                if (FlatLedgerManagerFactory.NAME.equals(lmType)) {
```

### AssignmentToMethodParameter
Assignment to method parameter `factoryClass`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/AbstractZkLedgerManagerFactory.java`
#### Snippet
```java
            } else {
                if (FlatLedgerManagerFactory.NAME.equals(lmType)) {
                    factoryClass = FlatLedgerManagerFactory.class;
                } else if (HierarchicalLedgerManagerFactory.NAME.equals(lmType)) {
                    factoryClass = HierarchicalLedgerManagerFactory.class;
```

### AssignmentToMethodParameter
Assignment to method parameter `factoryClass`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/AbstractZkLedgerManagerFactory.java`
#### Snippet
```java
                    factoryClass = FlatLedgerManagerFactory.class;
                } else if (HierarchicalLedgerManagerFactory.NAME.equals(lmType)) {
                    factoryClass = HierarchicalLedgerManagerFactory.class;
                } else if (LongHierarchicalLedgerManagerFactory.NAME.equals(lmType)) {
                    factoryClass = LongHierarchicalLedgerManagerFactory.class;
```

### AssignmentToMethodParameter
Assignment to method parameter `factoryClass`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/AbstractZkLedgerManagerFactory.java`
#### Snippet
```java
                    factoryClass = HierarchicalLedgerManagerFactory.class;
                } else if (LongHierarchicalLedgerManagerFactory.NAME.equals(lmType)) {
                    factoryClass = LongHierarchicalLedgerManagerFactory.class;
                } else {
                    throw new IOException("Unknown ledger manager type: "
```

### AssignmentToMethodParameter
Assignment to method parameter `length`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/ZeroBuffer.java`
#### Snippet
```java
        while (length > zeroBytes.length) {
            dst.put(zeroBytes);
            length -= zeroBytes.length;
        }
        if (length > 0) {
```

### AssignmentToMethodParameter
Assignment to method parameter `bucket`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentLongHashSet.java`
#### Snippet
```java
                // Cleanup all the buckets that were in `DeletedKey` state,
                // so that we can reduce unnecessary expansions
                bucket = (bucket - 1) & (table.length - 1);
                while (table[bucket] == DeletedItem) {
                    table[bucket] = EmptyItem;
```

### AssignmentToMethodParameter
Assignment to method parameter `bucket`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentLongHashSet.java`
#### Snippet
```java
                    --usedBuckets;

                    bucket = (bucket - 1) & (table.length - 1);
                }
            } else {
```

### AssignmentToMethodParameter
Assignment to method parameter `bucket`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentOpenHashMap.java`
#### Snippet
```java
                // Cleanup all the buckets that were in `DeletedKey` state,
                // so that we can reduce unnecessary expansions
                bucket = (bucket - 2) & (table.length - 1);
                while (table[bucket] == DeletedKey) {
                    table[bucket] = EmptyKey;
```

### AssignmentToMethodParameter
Assignment to method parameter `bucket`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentOpenHashMap.java`
#### Snippet
```java
                    --usedBuckets;

                    bucket = (bucket - 2) & (table.length - 1);
                }
            } else {
```

### AssignmentToMethodParameter
Assignment to method parameter `value`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentOpenHashMap.java`
#### Snippet
```java

                        if (value == null) {
                            value = valueProvider.apply(key);
                        }

```

### AssignmentToMethodParameter
Assignment to method parameter `rc`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookkeeperInternalCallbacks.java`
#### Snippet
```java
                LOG.error("For getListOfEntriesOfLedger expected ledgerId in the response: {} actual ledgerId: {}",
                        ledgerIdOfTheRequest, ledgerIdOfTheResponse);
                rc = BKException.Code.ReadException;
            }
            finish(rc, availabilityOfEntriesOfLedger, this);
```

### AssignmentToMethodParameter
Assignment to method parameter `entryId`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/LongPollReadEntryProcessorV3.java`
#### Snippet
```java
                readResponseBuilder.setMaxLAC(knownLAC);
                if (knownLAC > previousLAC) {
                    entryId = previousLAC + 1;
                    readResponseBuilder.setMaxLAC(knownLAC);
                    if (lastAddConfirmedUpdateTime.isPresent()) {
```

### AssignmentToMethodParameter
Assignment to method parameter `entryId`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/InterleavedLedgerStorage.java`
#### Snippet
```java
         */
        if (entryId == BookieProtocol.LAST_ADD_CONFIRMED) {
            entryId = ledgerCache.getLastEntry(ledgerId);
        }

```

### AssignmentToMethodParameter
Assignment to method parameter `length`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BufferedReadChannel.java`
#### Snippet
```java
                dest.writeBytes(readBuffer, posInBuffer, bytesToCopy);
                currentPosition += bytesToCopy;
                length -= bytesToCopy;
                cacheHitCount++;
            } else if (currentPosition >= eof) {
```

### AssignmentToMethodParameter
Assignment to method parameter `pos`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BufferedChannel.java`
#### Snippet
```java

                dest.writeBytes(writeBuffer, positionInBuffer, bytesToCopy);
                pos += bytesToCopy;
                length -= bytesToCopy;
            } else if (writeBuffer == null && writeBufferStartPosition.get() <= pos) {
```

### AssignmentToMethodParameter
Assignment to method parameter `length`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BufferedChannel.java`
#### Snippet
```java
                dest.writeBytes(writeBuffer, positionInBuffer, bytesToCopy);
                pos += bytesToCopy;
                length -= bytesToCopy;
            } else if (writeBuffer == null && writeBufferStartPosition.get() <= pos) {
                // here we reach the end
```

### AssignmentToMethodParameter
Assignment to method parameter `pos`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BufferedChannel.java`
#### Snippet
```java
                int bytesToCopy = Math.min(readBuffer.writerIndex() - positionInBuffer, dest.writableBytes());
                dest.writeBytes(readBuffer, positionInBuffer, bytesToCopy);
                pos += bytesToCopy;
                length -= bytesToCopy;
                // let's read it
```

### AssignmentToMethodParameter
Assignment to method parameter `length`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BufferedChannel.java`
#### Snippet
```java
                dest.writeBytes(readBuffer, positionInBuffer, bytesToCopy);
                pos += bytesToCopy;
                length -= bytesToCopy;
                // let's read it
            } else {
```

### AssignmentToMethodParameter
Assignment to method parameter `fileName`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/DefaultEntryLogger.java`
#### Snippet
```java
    static long fileName2LogId(String fileName) {
        if (fileName != null && fileName.contains(".")) {
            fileName = fileName.split("\\.")[0];
        }
        try {
```

### AssignmentToMethodParameter
Assignment to method parameter `size`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/FileInfo.java`
#### Snippet
```java
        }
        if (size > fc.size()) {
            size = fc.size();
        }
        File rlocFile = new File(newFile.getParentFile(), newFile.getName() + IndexPersistenceMgr.RLOC);
```

### AssignmentToMethodParameter
Assignment to method parameter `start`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/FileInfo.java`
#### Snippet
```java
            total += rc;
            // should move read position
            start += rc;
        }
        return total;
```

### AssignmentToMethodParameter
Assignment to method parameter `ledgerStorage`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieImpl.java`
#### Snippet
```java

        if (null == ledgerStorage) {
            ledgerStorage = BookieResources.createLedgerStorage(conf, null,
                                                                ledgerDirsManager,
                                                                indexDirsManager,
```

### AssignmentToMethodParameter
Assignment to method parameter `ledgerData`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/LedgerMetadataIndex.java`
#### Snippet
```java

    public void set(long ledgerId, LedgerData ledgerData) throws IOException {
        ledgerData = LedgerData.newBuilder(ledgerData).setExists(true).build();

        ReentrantLock lock = lockForLedger(ledgerId);
```

### AssignmentToMethodParameter
Assignment to method parameter `size`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectReader.java`
#### Snippet
```java
            while (size > 0) {
                int bytesRead = readBytesIntoBuf(buffer, offset, size);
                size -= bytesRead;
                offset += bytesRead;
            }
```

### AssignmentToMethodParameter
Assignment to method parameter `offset`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectReader.java`
#### Snippet
```java
                int bytesRead = readBytesIntoBuf(buffer, offset, size);
                size -= bytesRead;
                offset += bytesRead;
            }
        }
```

### AssignmentToMethodParameter
Assignment to method parameter `firstEntryId`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/SingleDirectoryDbLedgerStorage.java`
#### Snippet
```java

                    count++;
                    firstEntryId++;
                    size += entry.readableBytes();

```

### AssignmentToMethodParameter
Assignment to method parameter `bucket`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentLongLongHashMap.java`
#### Snippet
```java

                // Cleanup all the buckets that were in `DeletedKey` state, so that we can reduce unnecessary expansions
                bucket = (bucket - 2) & (table.length - 1);
                while (table[bucket] == DeletedKey) {
                    table[bucket] = EmptyKey;
```

### AssignmentToMethodParameter
Assignment to method parameter `bucket`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentLongLongHashMap.java`
#### Snippet
```java
                    --usedBuckets;

                    bucket = (bucket - 2) & (table.length - 1);
                }
            } else {
```

### AssignmentToMethodParameter
Assignment to method parameter `value`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentLongLongHashMap.java`
#### Snippet
```java

                        if (value == ValueNotFound) {
                            value = valueProvider.apply(key);
                        }

```

### AssignmentToMethodParameter
Assignment to method parameter `bucket`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentLongLongPairHashMap.java`
#### Snippet
```java
                // Cleanup all the buckets that were in `DeletedKey` state,
                // so that we can reduce unnecessary expansions
                bucket = (bucket - 4) & (table.length - 1);
                while (table[bucket] == DeletedKey) {
                    table[bucket] = EmptyKey;
```

### AssignmentToMethodParameter
Assignment to method parameter `bucket`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentLongLongPairHashMap.java`
#### Snippet
```java
                    --usedBuckets;

                    bucket = (bucket - 4) & (table.length - 1);
                }
            } else {
```

### AssignmentToMethodParameter
Assignment to method parameter `ensembleSize`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/DefaultEnsemblePlacementPolicy.java`
#### Snippet
```java
                    }
                    newBookies.add(b);
                    --ensembleSize;
                    if (ensembleSize == 0) {
                        return PlacementResult.of(newBookies,
```

### AssignmentToMethodParameter
Assignment to method parameter `ensembleSize`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/DefaultEnsemblePlacementPolicy.java`
#### Snippet
```java
                }
                newBookies.add(bookie);
                --ensembleSize;
                if (ensembleSize == 0) {
                    return PlacementResult.of(newBookies,
```

### AssignmentToMethodParameter
Assignment to method parameter `rc`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadLacOp.java`
#### Snippet
```java
                LOG.error("Mac mismatch while reading  ledger: " + ledgerId + " LAC from bookie: "
                        + currentEnsemble.get(bookieIndex));
                rc = BKException.Code.DigestMatchException;
            }
        }
```

### AssignmentToMethodParameter
Assignment to method parameter `rc`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerRecoveryOp.java`
#### Snippet
```java
                    LOG.error("Unexpected to recovery add entry {} as entry {} for ledger {}.",
                            entry.getEntryId(), (lh.lastAddPushed + 1), lh.getId());
                    rc = BKException.Code.UnexpectedConditionException;
                }
            }
```

### AssignmentToMethodParameter
Assignment to method parameter `allowedNonWritableCount`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
                                       int allowedNonWritableCount) {
        if (allowedNonWritableCount < 0) {
            allowedNonWritableCount = 0;
        }

```

### AssignmentToMethodParameter
Assignment to method parameter `startIndex`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RackawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
        for (int i = 0; i < bookies.size(); i++) {
            if (startIndex == bookies.size()) {
                startIndex = 0;
            }
            bookieIds[startIndex++] = bookies.get(i);
```

### AssignmentToMethodParameter
Assignment to method parameter `startIndex`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RackawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
                startIndex = 0;
            }
            bookieIds[startIndex++] = bookies.get(i);
        }
        return Lists.newArrayList(bookieIds);
```

### AssignmentToMethodParameter
Assignment to method parameter `bookiesToSelectFrom`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RackawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
            // If the list is null, we need to select from the entire knownBookies set
            wRSelection = this.weightedSelection;
            bookiesToSelectFrom = new ArrayList<BookieNode>(knownBookies.values());
        }
        if (isWeighted) {
```

### AssignmentToMethodParameter
Assignment to method parameter `numBookies`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RackawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
                excludeBookies.add(bookie);
                newBookies.add(bookie);
                --numBookies;
            }
        }
```

### AssignmentToMethodParameter
Assignment to method parameter `excludeBookies`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RackawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
        rwLock.readLock().lock();
        try {
            excludeBookies = addDefaultRackBookiesIfMinNumRacksIsEnforced(excludeBookies);
            excludeBookies.addAll(currentEnsemble);
            BookieNode bn = knownBookies.get(bookieToReplace);
```

### AssignmentToMethodParameter
Assignment to method parameter `shutDownTask`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/AuditorBookieCheckTask.java`
#### Snippet
```java
        try {
            auditBookies();
            shutDownTask = false;
        } catch (BKException bke) {
            LOG.error("Exception getting bookie list", bke);
```

### AssignmentToMethodParameter
Assignment to method parameter `rc`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeperAdmin.java`
#### Snippet
```java
                                LOG.warn("Failed to recover ledger: {} : {}, skip recover it.", lId,
                                    BKException.codeLogger(rc));
                                rc = BKException.Code.OK;
                            } else {
                                LOG.error("Failed to recover ledger {} : {}", lId, BKException.codeLogger(rc));
```

### AssignmentToMethodParameter
Assignment to method parameter `availabilityOfEntriesOfLedger`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/AuditorReplicasCheckTask.java`
#### Snippet
```java
                     * considered as empty AvailabilityOfEntriesOfLedger.
                     */
                    availabilityOfEntriesOfLedger = AvailabilityOfEntriesOfLedger.EMPTY_AVAILABILITYOFENTRIESOFLEDGER;
                } else {
                    LOG.warn("Unable to GetListOfEntriesOfLedger for ledger: {} from: {}", ledgerInRange,
```

### AssignmentToMethodParameter
Assignment to method parameter `lastKey`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/metastore/InMemoryMetastoreTable.java`
#### Snippet
```java
            myMap = map;
            if (EMPTY_END_KEY == lastKey || lastKey.compareTo(myMap.lastKey()) > 0) {
                lastKey = myMap.lastKey();
                lastInclusive = true;
            }
```

### AssignmentToMethodParameter
Assignment to method parameter `lastInclusive`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/metastore/InMemoryMetastoreTable.java`
#### Snippet
```java
            if (EMPTY_END_KEY == lastKey || lastKey.compareTo(myMap.lastKey()) > 0) {
                lastKey = myMap.lastKey();
                lastInclusive = true;
            }
            if (EMPTY_START_KEY == firstKey || firstKey.compareTo(myMap.firstKey()) < 0) {
```

### AssignmentToMethodParameter
Assignment to method parameter `firstKey`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/metastore/InMemoryMetastoreTable.java`
#### Snippet
```java
            }
            if (EMPTY_START_KEY == firstKey || firstKey.compareTo(myMap.firstKey()) < 0) {
                firstKey = myMap.firstKey();
                firstInclusive = true;
            }
```

### AssignmentToMethodParameter
Assignment to method parameter `firstInclusive`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/metastore/InMemoryMetastoreTable.java`
#### Snippet
```java
            if (EMPTY_START_KEY == firstKey || firstKey.compareTo(myMap.firstKey()) < 0) {
                firstKey = myMap.firstKey();
                firstInclusive = true;
            }
            if (firstKey.compareTo(lastKey) <= 0) {
```

### AssignmentToMethodParameter
Assignment to method parameter `lastKey`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/metastore/InMemoryMetastoreTable.java`
#### Snippet
```java
            myMap = map.descendingMap();
            if (EMPTY_START_KEY == lastKey || lastKey.compareTo(myMap.lastKey()) < 0) {
                lastKey = myMap.lastKey();
                lastInclusive = true;
            }
```

### AssignmentToMethodParameter
Assignment to method parameter `lastInclusive`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/metastore/InMemoryMetastoreTable.java`
#### Snippet
```java
            if (EMPTY_START_KEY == lastKey || lastKey.compareTo(myMap.lastKey()) < 0) {
                lastKey = myMap.lastKey();
                lastInclusive = true;
            }
            if (EMPTY_END_KEY == firstKey || firstKey.compareTo(myMap.firstKey()) > 0) {
```

### AssignmentToMethodParameter
Assignment to method parameter `firstKey`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/metastore/InMemoryMetastoreTable.java`
#### Snippet
```java
            }
            if (EMPTY_END_KEY == firstKey || firstKey.compareTo(myMap.firstKey()) > 0) {
                firstKey = myMap.firstKey();
                firstInclusive = true;
            }
```

### AssignmentToMethodParameter
Assignment to method parameter `firstInclusive`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/metastore/InMemoryMetastoreTable.java`
#### Snippet
```java
            if (EMPTY_END_KEY == firstKey || firstKey.compareTo(myMap.firstKey()) > 0) {
                firstKey = myMap.firstKey();
                firstInclusive = true;
            }
            if (firstKey.compareTo(lastKey) >= 0) {
```

### AssignmentToMethodParameter
Assignment to method parameter `fields`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/metastore/InMemoryMetastoreTable.java`
#### Snippet
```java
            Value newValue = new Value();
            if (ALL_FIELDS == fields) {
                fields = value.getFields();
            }
            for (String f : fields) {
```

### AssignmentToMethodParameter
Assignment to method parameter `value`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/metastore/InMemoryMetastoreTable.java`
#### Snippet
```java
                newValue.setField(f, value.getField(f));
            }
            value = newValue;
        }

```

### AssignmentToMethodParameter
Assignment to method parameter `version`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/metastore/InMemoryMetastoreTable.java`
#### Snippet
```java
        if (Version.ANY != version && Version.NEW != version) {
            if (version instanceof MetadataVersion) {
                version = new MetadataVersion(((MetadataVersion) version).version);
            } else {
                throw new IllegalStateException("Wrong version type.");
```

### AssignmentToMethodParameter
Assignment to method parameter `crc`
in `circe-checksum/src/main/java/com/scurrilous/circe/crc/NormalIntCrc.java`
#### Snippet
```java
    protected int resumeRaw(int crc, byte[] input, int index, int length) {
        for (int i = 0; i < length; ++i)
            crc = table[((crc >>> (bitWidth - 8)) ^ input[index + i]) & 0xff] ^ (crc << 8);
        return crc & widthMask;
    }
```

### AssignmentToMethodParameter
Assignment to method parameter `crc`
in `circe-checksum/src/main/java/com/scurrilous/circe/crc/ReflectedIntCrc.java`
#### Snippet
```java
    protected int resumeRaw(int crc, byte[] input, int index, int length) {
        for (int i = 0; i < length; ++i)
            crc = table[(crc ^ input[index + i]) & 0xff] ^ (crc >>> 8);
        return crc;
    }
```

### AssignmentToMethodParameter
Assignment to method parameter `poly`
in `circe-checksum/src/main/java/com/scurrilous/circe/crc/ReflectedIntCrc.java`
#### Snippet
```java
        super(algorithm, width, init, xorOut);

        poly = reflect(poly);
        for (int i = 0; i < 256; ++i) {
            int crc = i;
```

### AssignmentToMethodParameter
Assignment to method parameter `duration`
in `stats/bookkeeper-stats-providers/codahale-metrics-provider/src/main/java/org/apache/bookkeeper/stats/codahale/FastTimer.java`
#### Snippet
```java
        if (duration < 1) {
            // we can't time anything that took less than 1 ns (caller gave us wrong value)
            duration = 1;
        }
        int h = getHash();
```

### AssignmentToMethodParameter
Assignment to method parameter `seconds`
in `stats/bookkeeper-stats-providers/codahale-metrics-provider/src/main/java/org/apache/bookkeeper/stats/codahale/FastTimer.java`
#### Snippet
```java
     */
    public double getRate(int seconds) {
        seconds = Math.min(seconds, timeWindow - 2);
        int t = getNow(getHash()) - 1; // start from last completed second
        int secFrom = t - seconds;
```

### AssignmentToMethodParameter
Assignment to method parameter `crc`
in `circe-checksum/src/main/java/com/scurrilous/circe/crc/ReflectedLongCrc.java`
#### Snippet
```java
    protected long resumeRaw(long crc, byte[] input, int index, int length) {
        for (int i = 0; i < length; ++i)
            crc = table[(int) (crc ^ input[index + i]) & 0xff] ^ (crc >>> 8);
        return crc;
    }
```

### AssignmentToMethodParameter
Assignment to method parameter `poly`
in `circe-checksum/src/main/java/com/scurrilous/circe/crc/ReflectedLongCrc.java`
#### Snippet
```java
        super(algorithm, width, init, xorOut);

        poly = reflect(poly);
        for (int i = 0; i < 256; ++i) {
            long crc = i;
```

### AssignmentToMethodParameter
Assignment to method parameter `crc`
in `circe-checksum/src/main/java/com/scurrilous/circe/crc/NormalByteCrc.java`
#### Snippet
```java
    protected int resumeRaw(int crc, byte[] input, int index, int length) {
        for (int i = 0; i < length; ++i)
            crc = table[(crc << (8 - bitWidth)) ^ (input[index + i] & 0xff)] & 0xff;
        return crc;
    }
```

### AssignmentToMethodParameter
Assignment to method parameter `crc`
in `circe-checksum/src/main/java/com/scurrilous/circe/crc/NormalLongCrc.java`
#### Snippet
```java
    protected long resumeRaw(long crc, byte[] input, int index, int length) {
        for (int i = 0; i < length; ++i)
            crc = table[(int) ((crc >>> (bitWidth - 8)) ^ input[index + i]) & 0xff] ^ (crc << 8);
        return crc & widthMask;
    }
```

### AssignmentToMethodParameter
Assignment to method parameter `logName`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKDistributedLogNamespace.java`
#### Snippet
```java
            throws InvalidStreamNameException, IOException {
        checkState();
        logName = validateAndNormalizeName(logName);
        URI uri = Utils.ioResult(driver.getLogMetadataStore().createLog(logName));
        Utils.ioResult(driver.getLogStreamMetadataStore(WRITER).getLog(uri, logName, true, true));
```

### AssignmentToMethodParameter
Assignment to method parameter `nameOfLogStream`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKDistributedLogNamespace.java`
#### Snippet
```java
        // Make sure the name is well formed
        checkState();
        nameOfLogStream = validateAndNormalizeName(nameOfLogStream);

        DistributedLogConfiguration mergedConfiguration = new DistributedLogConfiguration();
```

### AssignmentToMethodParameter
Assignment to method parameter `logName`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKDistributedLogNamespace.java`
#### Snippet
```java
            throws InvalidStreamNameException, IOException {
        checkState();
        logName = validateAndNormalizeName(logName);
        Optional<URI> uri = Utils.ioResult(driver.getLogMetadataStore().getLogLocation(logName));
        if (!uri.isPresent()) {
```

### AssignmentToMethodParameter
Assignment to method parameter `logName`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKDistributedLogNamespace.java`
#### Snippet
```java
            throws InvalidStreamNameException, LogNotFoundException, IOException {
        checkState();
        logName = validateAndNormalizeName(logName);
        Optional<URI> uri = Utils.ioResult(driver.getLogMetadataStore().getLogLocation(logName));
        if (!uri.isPresent()) {
```

### AssignmentToMethodParameter
Assignment to method parameter `logNamePrefix`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKDistributedLogNamespace.java`
#### Snippet
```java
    public Iterator<String> getLogs(String logNamePrefix) throws IOException {
        checkState();
        logNamePrefix = validateAndNormalizeName(logNamePrefix);
        return Utils.ioResult(driver.getLogMetadataStore().getLogs(logNamePrefix));
    }
```

### AssignmentToMethodParameter
Assignment to method parameter `streamName`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/BKNamespaceDriver.java`
#### Snippet
```java
        }
        checkState();
        streamName = validateAndNormalizeName(streamName);
        return new ZKMetadataAccessor(
                streamName,
```

### AssignmentToMethodParameter
Assignment to method parameter `rc`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/logsegment/BKLogSegmentEntryReader.java`
#### Snippet
```java
                                 Object ctx) {
            if (failureInjector.shouldInjectCorruption(entryId, entryId)) {
                rc = BKException.Code.DigestMatchException;
            }
            processReadEntries(rc, lh, entries, ctx);
```

### AssignmentToMethodParameter
Assignment to method parameter `rc`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/logsegment/BKLogSegmentEntryReader.java`
#### Snippet
```java
                                                      Object ctx) {
            if (failureInjector.shouldInjectCorruption(this.entryId, this.entryId)) {
                rc = BKException.Code.DigestMatchException;
            }
            processReadEntry(rc, entryId, entry, ctx);
```

### AssignmentToMethodParameter
Assignment to method parameter `v`
in `stream/common/src/main/java/org/apache/bookkeeper/common/util/VarInt.java`
#### Snippet
```java
        do {
            result++;
            v >>>= 7;
        } while (v != 0);
        return result;
```

### AssignmentToMethodParameter
Assignment to method parameter `v`
in `stream/common/src/main/java/org/apache/bookkeeper/common/util/VarInt.java`
#### Snippet
```java
            // Encode next 7 bits + terminator bit
            long bits = v & 0x7F;
            v >>>= 7;
            int b = (int) (bits | ((v != 0) ? 0x80 : 0));
            buf.write(b);
```

### AssignmentToMethodParameter
Assignment to method parameter `h`
in `stream/common/src/main/java/org/apache/bookkeeper/common/hash/Murmur3.java`
#### Snippet
```java

    private static long fmix64(long h) {
        h ^= (h >>> 33);
        h *= 0xff51afd7ed558ccdL;
        h ^= (h >>> 33);
```

### AssignmentToMethodParameter
Assignment to method parameter `h`
in `stream/common/src/main/java/org/apache/bookkeeper/common/hash/Murmur3.java`
#### Snippet
```java
    private static long fmix64(long h) {
        h ^= (h >>> 33);
        h *= 0xff51afd7ed558ccdL;
        h ^= (h >>> 33);
        h *= 0xc4ceb9fe1a85ec53L;
```

### AssignmentToMethodParameter
Assignment to method parameter `h`
in `stream/common/src/main/java/org/apache/bookkeeper/common/hash/Murmur3.java`
#### Snippet
```java
        h ^= (h >>> 33);
        h *= 0xff51afd7ed558ccdL;
        h ^= (h >>> 33);
        h *= 0xc4ceb9fe1a85ec53L;
        h ^= (h >>> 33);
```

### AssignmentToMethodParameter
Assignment to method parameter `h`
in `stream/common/src/main/java/org/apache/bookkeeper/common/hash/Murmur3.java`
#### Snippet
```java
        h *= 0xff51afd7ed558ccdL;
        h ^= (h >>> 33);
        h *= 0xc4ceb9fe1a85ec53L;
        h ^= (h >>> 33);
        return h;
```

### AssignmentToMethodParameter
Assignment to method parameter `h`
in `stream/common/src/main/java/org/apache/bookkeeper/common/hash/Murmur3.java`
#### Snippet
```java
        h ^= (h >>> 33);
        h *= 0xc4ceb9fe1a85ec53L;
        h ^= (h >>> 33);
        return h;
    }
```

### AssignmentToMethodParameter
Assignment to method parameter `entryId`
in `bookkeeper-benchmark/src/main/java/org/apache/bookkeeper/benchmark/BenchThroughputLatency.java`
#### Snippet
```java
        // we need to use the id passed in the context in the case of
        // multiple ledgers, and it works even with one ledger
        entryId = context.id;
        long newTime = System.nanoTime() - context.localStartTime;

```

### AssignmentToMethodParameter
Assignment to method parameter `executor`
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/OrderedScheduler.java`
#### Snippet
```java
    protected ListeningScheduledExecutorService addExecutorDecorators(ExecutorService executor) {
        if (!(executor instanceof ListeningScheduledExecutorService)) {
            executor = new BoundedScheduledExecutorService((ScheduledThreadPoolExecutor) executor, 0);
        }
        return new OrderedSchedulerDecoratedThread((ListeningScheduledExecutorService) executor);
```

### AssignmentToMethodParameter
Assignment to method parameter `offset`
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/collections/BatchedArrayBlockingQueue.java`
#### Snippet
```java
        while (len > 0) {
            int published = internalPutAll(a, offset, len);
            offset += published;
            len -= published;
        }
```

### AssignmentToMethodParameter
Assignment to method parameter `len`
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/collections/BatchedArrayBlockingQueue.java`
#### Snippet
```java
            int published = internalPutAll(a, offset, len);
            offset += published;
            len -= published;
        }
    }
```

### AssignmentToMethodParameter
Assignment to method parameter `rawKey`
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/mvcc/MVCCStoreImpl.java`
#### Snippet
```java
        } else {
            Pair<byte[], byte[]> realRange = getRealRange(rawKey, rawEndKey);
            rawKey = realRange.getLeft();
            rawEndKey = realRange.getRight();

```

### AssignmentToMethodParameter
Assignment to method parameter `rawEndKey`
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/mvcc/MVCCStoreImpl.java`
#### Snippet
```java
            Pair<byte[], byte[]> realRange = getRealRange(rawKey, rawEndKey);
            rawKey = realRange.getLeft();
            rawEndKey = realRange.getRight();

            getKeyRecords(
```

### AssignmentToMethodParameter
Assignment to method parameter `endKey`
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/mvcc/MVCCStoreImpl.java`
#### Snippet
```java
            } else {
                Pair<byte[], byte[]> realRange = getRealRange(key, endKey);
                endKey = realRange.getRight();
                ++endKey[endKey.length - 1];
                batch.deleteRange(realRange.getLeft(), endKey);
```

### AssignmentToMethodParameter
Assignment to method parameter `rawKey`
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/mvcc/MVCCStoreImpl.java`
#### Snippet
```java
                        return null;
                    }
                    rawKey = iter.key();
                }
                if (isNullEndKey) {
```

### AssignmentToMethodParameter
Assignment to method parameter `rawEndKey`
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/mvcc/MVCCStoreImpl.java`
#### Snippet
```java
                        return null;
                    }
                    rawEndKey = iter.key();
                }
            }
```

## RuleId[id=SynchronizationOnLocalVariableOrMethodParameter]
### SynchronizationOnLocalVariableOrMethodParameter
Synchronization on local variable `listenerSet`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/AbstractZkLedgerManager.java`
#### Snippet
```java
                }
            }
            synchronized (listenerSet) {
                listenerSet.add(listener);
            }
```

### SynchronizationOnLocalVariableOrMethodParameter
Synchronization on local variable `listenerSet`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/AbstractZkLedgerManager.java`
#### Snippet
```java
        Set<LedgerMetadataListener> listenerSet = listeners.get(ledgerId);
        if (listenerSet != null) {
            synchronized (listenerSet) {
                if (listenerSet.remove(listener)) {
                    if (LOG.isDebugEnabled()) {
```

### SynchronizationOnLocalVariableOrMethodParameter
Synchronization on local variable `listenerSet`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/AbstractZkLedgerManager.java`
#### Snippet
```java
            Set<LedgerMetadataListener> listenerSet = listeners.get(ledgerId);
            if (null != listenerSet) {
                synchronized (listenerSet){
                    if (LOG.isDebugEnabled()) {
                        LOG.debug("Removed ledger metadata listeners on ledger {} : {}",
```

### SynchronizationOnLocalVariableOrMethodParameter
Synchronization on local variable `listenerSet`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/AbstractZkLedgerManager.java`
#### Snippet
```java
                    // notify `null` as indicator that a ledger is deleted
                    // make this behavior consistent with `NodeDeleted` watched event.
                    synchronized (listenerSet) {
                        for (LedgerMetadataListener listener : listenerSet) {
                            listener.onChanged(ledgerId, null);
```

### SynchronizationOnLocalVariableOrMethodParameter
Synchronization on local variable `channel`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PacketProcessorBaseV3.java`
#### Snippet
```java
        if (timeOut >= 0 && !channel.isWritable()) {
            if (!requestProcessor.isBlacklisted(channel)) {
                synchronized (channel) {
                    if (!channel.isWritable() && !requestProcessor.isBlacklisted(channel)) {
                        final long waitUntilNanos = writeNanos + TimeUnit.MILLISECONDS.toNanos(timeOut);
```

### SynchronizationOnLocalVariableOrMethodParameter
Synchronization on local variable `channel`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PacketProcessorBase.java`
#### Snippet
```java
        if (timeOut >= 0 && !channel.isWritable()) {
            if (!requestProcessor.isBlacklisted(channel)) {
                synchronized (channel) {
                    if (!channel.isWritable() && !requestProcessor.isBlacklisted(channel)) {
                        final long waitUntilNanos = writeNanos + TimeUnit.MILLISECONDS.toNanos(timeOut);
```

### SynchronizationOnLocalVariableOrMethodParameter
Synchronization on local variable `status`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieStatus.java`
#### Snippet
```java
            return null;
        }
        synchronized (status) {
            status.layoutVersion = Integer.parseInt(parts[0].trim());
            if (status.layoutVersion == 1 && parts.length == 3) {
```

### SynchronizationOnLocalVariableOrMethodParameter
Synchronization on local variable `status`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieStatus.java`
#### Snippet
```java
                BookieStatus status = readFromFile(statusFile);
                if (null != status) {
                    synchronized (status) {
                        if (status.lastUpdateTime > this.lastUpdateTime) {
                            this.lastUpdateTime = status.lastUpdateTime;
```

### SynchronizationOnLocalVariableOrMethodParameter
Synchronization on local variable `bc`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/DefaultEntryLogger.java`
#### Snippet
```java
        BufferedLogChannel bc = entryLogManager.getCurrentLogIfPresent(entryLogId);
        if (null != bc) {
            synchronized (bc) {
                if (pos + buff.writableBytes() >= bc.getFileChannelPosition()) {
                    return bc.read(buff, pos);
```

### SynchronizationOnLocalVariableOrMethodParameter
Synchronization on local variable `handle`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieImpl.java`
#### Snippet
```java
        try {
            LedgerDescriptor handle = getLedgerForEntry(entry, masterKey);
            synchronized (handle) {
                entrySize = entry.readableBytes();
                addEntryInternal(handle, entry, false /* ackBeforeSync */, cb, ctx, masterKey);
```

### SynchronizationOnLocalVariableOrMethodParameter
Synchronization on local variable `handle`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieImpl.java`
#### Snippet
```java
            long ledgerId = entry.getLong(entry.readerIndex());
            LedgerDescriptor handle = handles.getHandle(ledgerId, masterKey);
            synchronized (handle) {
                entry.markReaderIndex();
                handle.setExplicitLac(entry);
```

### SynchronizationOnLocalVariableOrMethodParameter
Synchronization on local variable `handle`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieImpl.java`
#### Snippet
```java
        ByteBuf lac;
        LedgerDescriptor handle = handles.getReadOnlyHandle(ledgerId);
        synchronized (handle) {
            lac = handle.getExplicitLac();
        }
```

### SynchronizationOnLocalVariableOrMethodParameter
Synchronization on local variable `handle`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieImpl.java`
#### Snippet
```java
        try {
            LedgerDescriptor handle = getLedgerForEntry(entry, masterKey);
            synchronized (handle) {
                if (handle.isFenced()) {
                    throw BookieException
```

### SynchronizationOnLocalVariableOrMethodParameter
Synchronization on local variable `listenerSet`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/MSLedgerManagerFactory.java`
#### Snippet
```java
            Set<LedgerMetadataListener> listenerSet = listeners.get(ledgerId);
            if (listenerSet != null) {
                synchronized (listenerSet) {
                    if (listenerSet.remove(listener)) {
                        LOG.info("Unregistered ledger metadata listener {} on ledger {}.", listener, ledgerId);
```

### SynchronizationOnLocalVariableOrMethodParameter
Synchronization on local variable `listenerSet`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/MSLedgerManagerFactory.java`
#### Snippet
```java
                    }
                }
                synchronized (listenerSet) {
                    listenerSet.add(listener);
                }
```

### SynchronizationOnLocalVariableOrMethodParameter
Synchronization on local variable `listenerSet`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/MSLedgerManagerFactory.java`
#### Snippet
```java
                Set<LedgerMetadataListener> listenerSet = listeners.get(ledgerId);
                if (listenerSet != null) {
                    synchronized (listenerSet) {
                        for (LedgerMetadataListener l : listenerSet){
                            unregisterLedgerMetadataListener(ledgerId, l);
```

### SynchronizationOnLocalVariableOrMethodParameter
Synchronization on local variable `lcCtx`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/SyncCallbackUtils.java`
#### Snippet
```java
            LedgerHandle.LastConfirmedCtx lcCtx = (LedgerHandle.LastConfirmedCtx) ctx;

            synchronized (lcCtx) {
                lcCtx.setRC(rc);
                lcCtx.setLastConfirmed(lastConfirmed);
```

### SynchronizationOnLocalVariableOrMethodParameter
Synchronization on method parameter `lh`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerRecoveryOp.java`
#### Snippet
```java
             * be added again when processing the call to add it.
             */
            synchronized (lh) {
                lh.length = entry.getLength() - (long) data.length;
                // check whether entry id is expected, so we won't overwritten any entries by mistake
```

### SynchronizationOnLocalVariableOrMethodParameter
Synchronization on local variable `ctx`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
        LastConfirmedCtx ctx = new LastConfirmedCtx();
        asyncReadLastConfirmed(new SyncReadLastConfirmedCallback(), ctx);
        synchronized (ctx) {
            while (!ctx.ready()) {
                ctx.wait();
```

### SynchronizationOnLocalVariableOrMethodParameter
Synchronization on local variable `ctx`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
        LastConfirmedCtx ctx = new LastConfirmedCtx();
        asyncReadExplicitLastConfirmed(new SyncReadLastConfirmedCallback(), ctx);
        synchronized (ctx) {
            while (!ctx.ready()) {
                ctx.wait();
```

### SynchronizationOnLocalVariableOrMethodParameter
Synchronization on local variable `ctx`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
        LastConfirmedCtx ctx = new LastConfirmedCtx();
        asyncTryReadLastConfirmed(new SyncReadLastConfirmedCallback(), ctx);
        synchronized (ctx) {
            while (!ctx.ready()) {
                ctx.wait();
```

### SynchronizationOnLocalVariableOrMethodParameter
Synchronization on method parameter `listeners`
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdRegistrationClient.java`
#### Snippet
```java
    ) {
        Consumer<Versioned<Set<BookieId>>> consumer;
        synchronized (listeners) {
            consumer = listeners.get(listener);
            if (null != consumer) {
```

### SynchronizationOnLocalVariableOrMethodParameter
Synchronization on local variable `sync`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeperAdmin.java`
#### Snippet
```java

        // Wait for the async method to complete.
        synchronized (sync) {
            while (!sync.value) {
                sync.wait();
```

### SynchronizationOnLocalVariableOrMethodParameter
Synchronization on local variable `syncObj`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeperAdmin.java`
#### Snippet
```java
                LOG.info("Recover bookie operation completed with rc: {}", BKException.codeLogger(rc));
                SyncObject syncObj = (SyncObject) ctx;
                synchronized (syncObj) {
                    syncObj.rc = rc;
                    syncObj.value = true;
```

### SynchronizationOnLocalVariableOrMethodParameter
Synchronization on local variable `syncObject`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeperAdmin.java`
#### Snippet
```java
            LOG.info("Recover bookie for {} completed with rc : {}", lid, BKException.codeLogger(rc));
            SyncObject syncObject = (SyncObject) ctx;
            synchronized (syncObject) {
                syncObject.rc = rc;
                syncObject.value = true;
```

### SynchronizationOnLocalVariableOrMethodParameter
Synchronization on local variable `sync`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeperAdmin.java`
#### Snippet
```java

        // Wait for the async method to complete.
        synchronized (sync) {
            while (!sync.value) {
                sync.wait();
```

### SynchronizationOnLocalVariableOrMethodParameter
Synchronization on local variable `watchers`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/zk/ZKWatcherManager.java`
#### Snippet
```java
            return;
        }
        synchronized (watchers) {
            if (watchers.remove(watcher)) {
                allWatchesGauge.decrement();
```

### SynchronizationOnLocalVariableOrMethodParameter
Synchronization on local variable `watchers`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/zk/ZKWatcherManager.java`
#### Snippet
```java
            watchers = (null == oldWatchers) ? newWatchers : oldWatchers;
        }
        synchronized (watchers) {
            if (childWatches.get(path) == watchers) {
                if (watchers.add(watcher)) {
```

### SynchronizationOnLocalVariableOrMethodParameter
Synchronization on local variable `watcherSet`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/zk/ZKWatcherManager.java`
#### Snippet
```java
        Set<Watcher> savedAllWatches = new HashSet<Watcher>((int) allWatchesGauge.sum());
        for (Set<Watcher> watcherSet : childWatches.values()) {
            synchronized (watcherSet) {
                savedAllWatches.addAll(watcherSet);
            }
```

### SynchronizationOnLocalVariableOrMethodParameter
Synchronization on local variable `watchers`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/zk/ZKWatcherManager.java`
#### Snippet
```java
        }
        Set<Watcher> watchersToFire;
        synchronized (watchers) {
            watchersToFire = new HashSet<Watcher>(watchers.size());
            watchersToFire.addAll(watchers);
```

### SynchronizationOnLocalVariableOrMethodParameter
Synchronization on local variable `listenerSet`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/ZKLogSegmentMetadataStore.java`
#### Snippet
```java
                return;
            }
            synchronized (listenerSet) {
                listenerSet.remove(listener);
                if (listenerSet.isEmpty()) {
```

### SynchronizationOnLocalVariableOrMethodParameter
Synchronization on local variable `listenerSet`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/ZKLogSegmentMetadataStore.java`
#### Snippet
```java
                        }
                    }
                    synchronized (listenerSet) {
                        listenerSet.put(listener, new VersionedLogSegmentNamesListener(listener));
                        if (!listeners.containsKey(logSegmentsPath)) {
```

### SynchronizationOnLocalVariableOrMethodParameter
Synchronization on method parameter `ledgers`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/auditor/DLAuditor.java`
#### Snippet
```java
            List<Long> sLedgers = new ArrayList<Long>();
            for (LogSegmentMetadata segment : segments) {
                synchronized (ledgers) {
                    ledgers.add(segment.getLogSegmentId());
                }
```

### SynchronizationOnLocalVariableOrMethodParameter
Synchronization on local variable `stream`
in `bookkeeper-benchmark/src/main/java/org/apache/bookkeeper/benchmark/TestClient.java`
#### Snippet
```java
                while (System.currentTimeMillis() < stopat) {
                    FileOutputStream stream = streams.get(r.nextInt(streams.size()));
                    synchronized (stream) {
                        stream.write(data);
                        stream.flush();
```

### SynchronizationOnLocalVariableOrMethodParameter
Synchronization on method parameter `corruptedCandidates`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                            }
                        }
                        synchronized (corruptedCandidates) {
                            corruptedCandidates.put(s, ledgers);
                        }
```

## RuleId[id=ReturnNull]
### ReturnNull
Return of `null`
in `stream/clients/java/base/src/main/java/org/apache/bookkeeper/clients/impl/routing/RangeRouter.java`
#### Snippet
```java
                return oldRanges;
            } else {
                return null;
            }
        } finally {
```

### ReturnNull
Return of `null`
in `stream/distributedlog/protocol/src/main/java/org/apache/distributedlog/EnvelopedRecordSetReader.java`
#### Snippet
```java
    public LogRecordWithDLSN nextRecord() throws IOException {
        if (numRecords <= 0) {
            return null;
        }

```

### ReturnNull
Return of `null`
in `stream/distributedlog/protocol/src/main/java/org/apache/distributedlog/LogRecord.java`
#### Snippet
```java

                if (in.readableBytes() <= 0) {
                    return null;
                }

```

### ReturnNull
Return of `null`
in `stream/distributedlog/protocol/src/main/java/org/apache/distributedlog/LogRecord.java`
#### Snippet
```java
                }
            }
            return null;
        }

```

### ReturnNull
Return of `null`
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/sc/Channel404.java`
#### Snippet
```java
    @Override
    public String authority() {
        return null;
    }
}
```

### ReturnNull
Return of `null`
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/kv/TableStoreUtils.java`
#### Snippet
```java
                                org.apache.bookkeeper.api.kv.result.KeyValue<byte[], byte[]> kv) {
        if (null == kv) {
            return null;
        }
        return KeyValue.newBuilder()
```

### ReturnNull
Return of `null`
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/routing/StorageContainerProxyChannelManagerImpl.java`
#### Snippet
```java
                return serverChannel.getGrpcChannel();
            } else {
                return null;
            }
        } else {
```

### ReturnNull
Return of `null`
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/routing/StorageContainerProxyChannelManagerImpl.java`
#### Snippet
```java
            }
        } else {
            return null;
        }
    }
```

### ReturnNull
Return of `null`
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/routing/RangeRoutingTableImpl.java`
#### Snippet
```java
            // the range router is not ready, let the client backoff and retry.
            fetchStreamRanges(streamId);
            return null;
        } else {
            return router.getRangeProperties(routingKey);
```

### ReturnNull
Return of `null`
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/store/MVCCStoreFactoryImpl.java`
#### Snippet
```java
        Map<RangeId, MVCCAsyncStore<byte[], byte[]>> scStores = stores.get(scId);
        if (null == scStores) {
            return null;
        } else {
            RangeId rid = RangeId.of(streamId, rangeId);
```

### ReturnNull
Return of `null`
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/metadata/RootRangeStoreImpl.java`
#### Snippet
```java
            try {
                if (kvs.count() <= 0) {
                    return null;
                } else {
                    return kvs.getKvsAndClear().get(0);
```

### ReturnNull
Return of `null`
in `stream/api/src/main/java/org/apache/bookkeeper/api/kv/TableReadView.java`
#### Snippet
```java
                try {
                    if (result.count() == 0) {
                        return null;
                    } else {
                        return retain(result.kvs().get(0).value());
```

### ReturnNull
Return of `null`
in `stream/api/src/main/java/org/apache/bookkeeper/api/kv/TableReadView.java`
#### Snippet
```java
                try {
                    if (result.count() == 0) {
                        return null;
                    } else {
                        return result.getKvsAndClear().get(0);
```

### ReturnNull
Return of `null`
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/metadata/stream/MetaRangeImpl.java`
#### Snippet
```java
                        createFuture.complete(false);
                    }
                    return null;
                } finally {
                    txnResult.close();
```

### ReturnNull
Return of `null`
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/metadata/stream/MetaRangeImpl.java`
#### Snippet
```java
            .exceptionally(cause -> {
                createFuture.completeExceptionally(cause);
                return null;
            });
    }
```

### ReturnNull
Return of `null`
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/metadata/stream/MetaRangeImpl.java`
#### Snippet
```java
            .thenApplyAsync(kvs -> {
                if (kvs.isEmpty()) {
                    return null;
                } else {
                    loadMetadata(kvs);
```

### ReturnNull
Return of `null`
in `stream/api/src/main/java/org/apache/bookkeeper/api/kv/TableWriteView.java`
#### Snippet
```java
                    List<KeyValue<K, V>> prevKvs = result.prevKvs();
                    if (prevKvs.isEmpty()) {
                        return null;
                    } else {
                        return retain(prevKvs.get(0).value());
```

### ReturnNull
Return of `null`
in `stream/api/src/main/java/org/apache/bookkeeper/api/kv/PTableWriteView.java`
#### Snippet
```java
                    List<KeyValue<K, V>> prevKvs = result.prevKvs();
                    if (prevKvs.isEmpty()) {
                        return null;
                    } else {
                        return retain(prevKvs.get(0).value());
```

### ReturnNull
Return of `null`
in `stream/api/src/main/java/org/apache/bookkeeper/api/kv/PTableReadView.java`
#### Snippet
```java
                try {
                    if (result.count() == 0) {
                        return null;
                    } else {
                        return result.getKvsAndClear().get(0);
```

### ReturnNull
Return of `null`
in `stream/api/src/main/java/org/apache/bookkeeper/api/kv/PTableReadView.java`
#### Snippet
```java
                try {
                    if (result.count() == 0) {
                        return null;
                    } else {
                        return retain(result.kvs().get(0).value());
```

### ReturnNull
Return of `null`
in `stream/api/src/main/java/org/apache/bookkeeper/api/kv/options/Options.java`
#### Snippet
```java
        @Override
        public Object endKey() {
            return null;
        }

```

### ReturnNull
Return of `null`
in `stream/api/src/main/java/org/apache/bookkeeper/api/kv/options/Options.java`
#### Snippet
```java
        @Override
        public Object endKey() {
            return null;
        }

```

### ReturnNull
Return of `null`
in `stream/api/src/main/java/org/apache/bookkeeper/api/kv/options/Options.java`
#### Snippet
```java
        @Override
        public Object endKey() {
            return null;
        }

```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/CachedDNSToSwitchMapping.java`
#### Snippet
```java
        result.add(networkLocation);
      } else {
        return null;
      }
    }
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/AbstractDNSToSwitchMapping.java`
#### Snippet
```java
     */
    public Map<String, String> getSwitchMap() {
        return null;
    }

```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/ScriptBasedMapping.java`
#### Snippet
```java

            if (scriptName == null) {
                return null;
            }

```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/ScriptBasedMapping.java`
#### Snippet
```java
                    LOG.error("Script " + scriptName + " returned " + m.size() + " values when "
                            + names.size() + " were expected.");
                    return null;
                }
            } else {
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/ScriptBasedMapping.java`
#### Snippet
```java
                // an error occurred. return null to signify this.
                // (exn was already logged in runResolveCommand)
                return null;
            }

```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/ScriptBasedMapping.java`
#### Snippet
```java
            int loopCount = 0;
            if (args.size() == 0) {
                return null;
            }
            StringBuilder allOutput = new StringBuilder();
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/ScriptBasedMapping.java`
#### Snippet
```java
                LOG.warn("Invalid value " + maxArgs + " for " + SCRIPT_ARG_COUNT_KEY
                        + "; must be >= " + MIN_ALLOWABLE_ARGS);
                return null;
            }

```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/ScriptBasedMapping.java`
#### Snippet
```java
                } catch (Exception e) {
                    LOG.warn("Exception running: {} Exception message: {}", s, e.getMessage());
                    return null;
                }
                loopCount++;
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tls/SecurityProviderFactoryFactory.java`
#### Snippet
```java
            throws SecurityException {
        if ((securityHandler == null) || (securityHandler.equals(""))) {
            return null;
        }

```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tls/FileModifiedTimeUpdater.java`
#### Snippet
```java
            }
        }
        return null;
    }

```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/DNS.java`
#### Snippet
```java
            }
        }
        return null;
    }

```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NetworkTopologyImpl.java`
#### Snippet
```java
                // range check
                if (leafIndex < 0 || leafIndex >= this.getNumOfChildren()) {
                    return null;
                }
                return children.get(leafIndex);
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NetworkTopologyImpl.java`
#### Snippet
```java
                    }
                }
                return null;
            }
        }
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NetworkTopologyImpl.java`
#### Snippet
```java
        if (excludedScope != null) {
            if (scope.startsWith(excludedScope)) {
                return null;
            }
            if (!excludedScope.startsWith(scope)) {
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NetworkTopologyImpl.java`
#### Snippet
```java
            InnerNode rack = (InnerNode) clusterMap.getLoc(loc);
            if (rack == null) {
                return null;
            }
            return new ArrayList<Node>(rack.getChildren());
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NetworkTopologyImpl.java`
#### Snippet
```java
            }
            if (childnode == null) {
                return null; // non-existing node
            } else if (path.length == 1) {
                return childnode;
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NetworkTopologyImpl.java`
#### Snippet
```java
                return ((InnerNode) childnode).getLoc(path[1]);
            } else {
                return null;
            }
        }
```

### ReturnNull
Return of `null`
in `stream/server/src/main/java/org/apache/bookkeeper/stream/cluster/StreamCluster.java`
#### Snippet
```java
                    throw new StorageRuntimeException("Failed to initialize the segment storage", e);
                }
                return null;
            });
    }
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/AbstractConfiguration.java`
#### Snippet
```java
        List servers = getList(ZK_SERVERS, null);
        if (null == servers || 0 == servers.size()) {
            return null;
        }
        return StringUtils.join(servers, ",");
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/ZkLedgerAuditorManager.java`
#### Snippet
```java
            Collections.sort(children, new ElectionComparator());
            if (children.size() < 1) {
                return null;
            }
            String ledger = electionRoot + "/" + children.get(AUDITOR_INDEX);
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/ZkLayoutManager.java`
#### Snippet
```java
            return LedgerLayout.parseLayout(layoutData);
        } catch (NoNodeException nne) {
            return null;
        } catch (InterruptedException e) {
            Thread.currentThread().interrupt();
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/ServerConfiguration.java`
#### Snippet
```java
        String extraServerComponentsStr = getString(EXTRA_SERVER_COMPONENTS);
        if (Strings.isNullOrEmpty(extraServerComponentsStr)) {
            return null;
        }
        return this.getStringArray(EXTRA_SERVER_COMPONENTS);
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/ServerConfiguration.java`
#### Snippet
```java
    public String[] getIndexDirNames() {
        if (!this.containsKey(INDEX_DIRS)) {
            return null;
        }
        return this.getStringArray(INDEX_DIRS);
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/ServerConfiguration.java`
#### Snippet
```java
        String[] idxDirNames = getIndexDirNames();
        if (null == idxDirNames) {
            return null;
        }
        File[] idxDirs = new File[idxDirNames.length];
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/AbstractZkLedgerManager.java`
#### Snippet
```java
                                promise.completeExceptionally(new BKException.ZKException(exception));
                            }
                            return null;
                        });
                    } else {
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/LongZkLedgerIdGenerator.java`
#### Snippet
```java
                        return Long.parseLong(t.replace(hobPrefix, ""));
                    } catch (NumberFormatException e) {
                        return null;
                    }
                })
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/LongZkLedgerIdGenerator.java`
#### Snippet
```java
                                return Long.parseLong(t.replace(hobPrefix, ""));
                            } catch (NumberFormatException e) {
                                return null;
                            }
                        })
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/AbstractZkLedgerManagerFactory.java`
#### Snippet
```java
            throws ClassNotFoundException, IOException {
        if (null == lmfClassName) {
            return null;
        } else {
            // this is to address the issue when using the dlog shaded jar
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/NullMetadataBookieDriver.java`
#### Snippet
```java
        @Override
        public Versioned<byte[]> readCookie(BookieId bookieId) throws BookieException {
            return null;
        }

```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/sasl/SaslConstants.java`
#### Snippet
```java
            .getAppConfigurationEntry(configurationEntry);
        if (entries == null) {
            return null;
        }
        for (AppConfigurationEntry entry : entries) {
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/sasl/SaslConstants.java`
#### Snippet
```java
            }
        }
        return null;
    }
}
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/sasl/SASLClientProviderFactory.java`
#### Snippet
```java
        if (entries == null) {
            LOG.info("No JAAS Configuration found with section BookKeeper");
            return null;
        }
        try {
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/sasl/SASLClientProviderFactory.java`
#### Snippet
```java
        } catch (LoginException error) {
            LOG.error("Error JAAS Configuration subject", error);
            return null;
        }
    }
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/sasl/SaslClientState.java`
#### Snippet
```java
                LOG.debug("saslResponse: Failed to respond to SASL server's token:", e);
            }
            return null;
        }
    }
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/sasl/SASLBookieAuthProviderFactory.java`
#### Snippet
```java
            LOG.info("JAAS not configured or no "
                + loginContextName + " present in JAAS Configuration file");
            return null;
        }
        LoginContext loginContext = new LoginContext(loginContextName, new ClientCallbackHandler(null));
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/sasl/TGTRefreshThread.java`
#### Snippet
```java
            }
        }
        return null;
    }
    // LoginThread will sleep until 80% of time from last refresh to
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/ZkLedgerUnderreplicationManager.java`
#### Snippet
```java
                    LOG.debug("Ledger: {} is not marked underreplicated", ledgerId);
                }
                return null;
            }
            TextFormat.merge(new String(data, UTF_8), builder);
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/CertUtils.java`
#### Snippet
```java
                }
            }
            return null;
        } catch (InvalidNameException ine) {
            throw new IOException(ine);
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/CertUtils.java`
#### Snippet
```java
            }
        }
        return null;
    }
}
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentLongHashMap.java`
#### Snippet
```java
                        // The values we have read are consistent
                        if (storedKey == key) {
                            return storedValue != DeletedValue ? storedValue : null;
                        } else if (storedValue == EmptyValue) {
                            // Not found
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentLongHashMap.java`
#### Snippet
```java
                        } else if (storedValue == EmptyValue) {
                            // Not found
                            return null;
                        }
                    } else {
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentLongHashMap.java`
#### Snippet
```java

                        if (storedKey == key) {
                            return storedValue != DeletedValue ? storedValue : null;
                        } else if (storedValue == EmptyValue) {
                            // Not found
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentLongHashMap.java`
#### Snippet
```java
                        } else if (storedValue == EmptyValue) {
                            // Not found
                            return null;
                        }
                    }
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentLongHashMap.java`
#### Snippet
```java
                            ++size;
                            ++usedBuckets;
                            return valueProvider != null ? values[bucket] : null;
                        } else if (storedValue == DeletedValue) {
                            values[bucket] = value != null ? value : valueProvider.apply(key);
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentLongHashMap.java`
#### Snippet
```java
                            values[bucket] = value != null ? value : valueProvider.apply(key);
                            ++size;
                            return valueProvider != null ? values[bucket] : null;
                        } else if (!onlyIfAbsent) {
                            // Over written an old value for same key
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentLongHashMap.java`
#### Snippet
```java
                        values[bucket] = value != null ? value : valueProvider.apply(key);
                        ++size;
                        return valueProvider != null ? values[bucket] : null;
                    } else if (storedValue == DeletedValue) {
                        // The bucket contained a different deleted key
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentLongHashMap.java`
#### Snippet
```java
                        if (value == null || value.equals(storedValue)) {
                            if (storedValue == EmptyValue || storedValue == DeletedValue) {
                                return null;
                            }

```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentLongHashMap.java`
#### Snippet
```java
                            return storedValue;
                        } else {
                            return null;
                        }
                    } else if (storedValue == EmptyValue) {
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentLongHashMap.java`
#### Snippet
```java
                    } else if (storedValue == EmptyValue) {
                        // Key wasn't found
                        return null;
                    }

```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentOpenHashMap.java`
#### Snippet
```java
                        } else if (storedKey == EmptyKey) {
                            // Not found
                            return null;
                        }
                    } else {
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentOpenHashMap.java`
#### Snippet
```java
                        } else if (storedKey == EmptyKey) {
                            // Not found
                            return null;
                        }
                    }
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentOpenHashMap.java`
#### Snippet
```java
                            return storedValue;
                        } else {
                            return null;
                        }
                    } else if (storedKey == EmptyKey) {
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentOpenHashMap.java`
#### Snippet
```java
                    } else if (storedKey == EmptyKey) {
                        // Key wasn't found
                        return null;
                    }

```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentOpenHashMap.java`
#### Snippet
```java
                        table[bucket + 1] = value;
                        ++size;
                        return valueProvider != null ? value : null;
                    } else if (storedKey == DeletedKey) {
                        // The bucket contained a different deleted key
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/WriteLacProcessorV3.java`
#### Snippet
```java
            return writeLacResponse.build();
        }
        return null;
    }

```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/ForceLedgerProcessorV3.java`
#### Snippet
```java
            return forceLedgerResponse.build();
        }
        return null;
    }

```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieRequestProcessor.java`
#### Snippet
```java
            StatsLogger statsLogger) {
        if (numThreads <= 0) {
            return null;
        } else {
            return OrderedExecutor.newBuilder()
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/WriteEntryProcessorV3.java`
#### Snippet
```java
            return addResponse.build();
        }
        return null;
    }

```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/LongPollReadEntryProcessorV3.java`
#### Snippet
```java
                    }, readRequest.getTimeOut(), TimeUnit.MILLISECONDS);
                }
                return null;
            }
        }
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/ReadEntryProcessorV3.java`
#### Snippet
```java
            return readRequest.getPreviousLAC();
        } else {
            return null;
        }
    }
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/ReadEntryProcessorV3.java`
#### Snippet
```java
        if (null != fenceResult) {
            handleReadResultForFenceRead(entryBody, readResponseBuilder, entryId, startTimeSw);
            return null;
        } else {
            try {
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieNettyServer.java`
#### Snippet
```java
                        return c.remoteAddress();
                    } else {
                        return null;
                    }
                }
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieClientImpl.java`
#### Snippet
```java
            try {
                if (closed) {
                    return null;
                }
                PerChannelBookieClientPool newClientPool =
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieClientImpl.java`
#### Snippet
```java
            } catch (SecurityException e) {
                LOG.error("Security Exception in creating new default PCBC pool: ", e);
                return null;
            } finally {
                closeLock.readLock().unlock();
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/checksum/MacDigestManager.java`
#### Snippet
```java
            } catch (GeneralSecurityException gse) {
                LOG.error("Couldn't not get mac instance", gse);
                return null;
            }
        }
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookie/ListLedgersCommand.java`
#### Snippet
```java
                throw new UncheckedExecutionException(ioe);
            }
            return null;
        });

```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookie/ListActiveLedgersCommand.java`
#### Snippet
```java
          throw new UncheckedExecutionException(e);
        }
        return null;
      });
    }
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
        public Channel channel() {
            // used only for log
            return null;
        }

```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
                    return c.remoteAddress();
                } else {
                    return null;
                }
            }
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookie/FormatCommand.java`
#### Snippet
```java
                    }

                    return null;
                });
            } catch (MetadataException | ExecutionException e) {
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/client/LedgerMetaDataCommand.java`
#### Snippet
```java
                throw new UncheckedExecutionException(e);
            }
            return null;
        });
        return true;
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/health/SwitchOfHealthCheckCommand.java`
#### Snippet
```java
                if (flags.status) {
                    LOG.info("EnableHealthCheck is " + (isEnable ? "enabled." : "disabled."));
                    return null;
                }

```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/health/SwitchOfHealthCheckCommand.java`
#### Snippet
```java
                throw new UncheckedExecutionException(e);
            }
            return null;
        });
        return true;
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookies/InstanceIdCommand.java`
#### Snippet
```java
                LOG.info("Metadata Service Uri: {} InstanceId: {}",
                         conf.getMetadataServiceUriUnchecked(), readInstanceId);
                return null;
            });
        } catch (Exception e) {
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/autorecovery/ToggleCommand.java`
#### Snippet
```java
                        LOG.info("Autorecovery is {}", (underreplicationManager.isLedgerReplicationEnabled()
                                                                     ? "enabled." : "disabled."));
                        return null;
                    }
                    if (flags.enable) {
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/autorecovery/ToggleCommand.java`
#### Snippet
```java
                throw new UncheckedExecutionException(e);
            }
            return null;
        });
        return true;
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/autorecovery/ListUnderReplicatedCommand.java`
#### Snippet
```java

            LOG.info("Under replicated ledger count: {}", underReplicatedLedgerCount.get());
            return null;
        });
        return true;
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/autorecovery/QueryAutoRecoveryStatusCommand.java`
#### Snippet
```java
                LOG.info("\t No Ledger is being recovered.");
            }
            return null;
        });
        return true;
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieException.java`
#### Snippet
```java
            // Since this exception is a way to signal a specific condition and it's triggered and very specific points,
            // we can disable stack traces.
            return null;
        }
    }
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookies/RecoverCommand.java`
#### Snippet
```java
                    throw new UncheckedExecutionException(e);
                }
                return null;
            });
        } catch (Exception e) {
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryLogManagerForSingleEntryLog.java`
#### Snippet
```java
            return activeLogChannelTemp;
        }
        return null;
    }

```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/IndexInMemPageMgr.java`
#### Snippet
```java
            ConcurrentMap<Long, LedgerEntryPage> pageMap = pages.get(ledgerId);
            if (pageMap == null || pageMap.isEmpty()) {
                return null;
            }

```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/IndexInMemPageMgr.java`
#### Snippet
```java
                return map.get(firstEntry);
            }
            return null;
        }

```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/IndexInMemPageMgr.java`
#### Snippet
```java
        LedgerEntryPage lep = pageMapAndList.getPage(ledger, firstEntry);
        if (onlyDirty && null != lep && lep.isClean()) {
            return null;
        }
        if (null != lep) {
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/IndexInMemPageMgr.java`
#### Snippet
```java
                            LOG.debug("Did not find eligible page in the first pass");
                        }
                        return null;
                    }
                }
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/SkipListArena.java`
#### Snippet
```java
        // don't cause fragmentation as badly.
        if (size > maxAlloc) {
            return null;
        }

```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieStatus.java`
#### Snippet
```java
            throws IOException, IllegalArgumentException {
        if (!file.exists()) {
            return null;
        }

```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieStatus.java`
#### Snippet
```java
                LOG.debug("Empty line when parsing bookie status");
            }
            return null;
        }
        String[] parts = line.split(",");
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieStatus.java`
#### Snippet
```java
                LOG.debug("Error in parsing bookie status: {}", line);
            }
            return null;
        }
        synchronized (status) {
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieStatus.java`
#### Snippet
```java
            }
        }
        return null;

    }
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Cookie.java`
#### Snippet
```java
    String[] getIndexDirPathsFromCookie() {
        if (null == indexDirs) {
            return null;
        }
        return decodeDirPathFromCookie(indexDirs);
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/FileSystemUpgrade.java`
#### Snippet
```java
                    throw new UncheckedExecutionException(e.getMessage(), e);
                }
                return null;
            });
        } catch (MetadataException e) {
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/FileSystemUpgrade.java`
#### Snippet
```java
                    throw new UncheckedExecutionException(e.getMessage(), e);
                }
                return null;
            });
        } catch (MetadataException e) {
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/DefaultEntryLogger.java`
#### Snippet
```java
        synchronized (compactionLogLock) {
            if (compactionLogChannel == null) {
                return null;
            }
            return compactionLogChannel.getLogFile();
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryMemTable.java`
#### Snippet
```java

        if (result == null || result.getLedgerId() != ledgerId) {
            return null;
        }
        return (EntryKeyValue) result;
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/IndexPersistenceMgr.java`
#### Snippet
```java
            }
        }
        return null;
    }

```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/IndexPersistenceMgr.java`
#### Snippet
```java
        } catch (IOException e) {
            LOG.error("Exception during getLastAddConfirmed", e);
            return null;
        } finally {
            if (null != fi) {
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/KeyValueStorageRocksDB.java`
#### Snippet
```java
            }
        }
        return null;
    }

```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/KeyValueStorageRocksDB.java`
#### Snippet
```java
                return new EntryWrapper(iterator.key(), iterator.value());
            } else {
                return null;
            }
        }
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/WriteCache.java`
#### Snippet
```java
        LongPair result = index.get(ledgerId, entryId);
        if (result == null) {
            return null;
        }

```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/WriteCache.java`
#### Snippet
```java
        if (lastEntryId == -1) {
            // Ledger not found in write cache
            return null;
        } else {
            return get(ledgerId, lastEntryId);
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/ReadCache.java`
#### Snippet
```java

        // Entry not found in any segment
        return null;
    }

```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectWriter.java`
#### Snippet
```java
        Future<?> f = writeExecutor.submit(() -> {
            writeByteBuf(tmpBuffer, bytesToWrite, offset);
            return null;
            });
        addOutstandingWrite(f);
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectWriter.java`
#### Snippet
```java
                Future<?> f = writeExecutor.submit(() -> {
                    writeByteBuf(bufferToFlush, bytesToWrite, offsetToWrite);
                    return null;
                });
                addOutstandingWrite(f);
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectEntryLogger.java`
#### Snippet
```java
                        throw t;
                    }
                    return null;
                });
        } else {
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/SingleDirectoryDbLedgerStorage.java`
#### Snippet
```java
                log.debug("getExplicitLac ledger {} missing from LedgerData", ledgerId);
            }
            return null;
        }
        if (log.isDebugEnabled()) {
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerMetadataImpl.java`
#### Snippet
```java
    public DigestType getDigestType() {
        if (!hasPassword()) {
            return null;
        } else {
            return digestType;
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/DefaultSpeculativeRequestExecutionPolicy.java`
#### Snippet
```java
            }
        }
        return null;
    }
}
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/MSLedgerManagerFactory.java`
#### Snippet
```java

    static Long key2LedgerId(String key) {
        return null == key ? null : Long.parseLong(key, 10);
    }

```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/MSLedgerManagerFactory.java`
#### Snippet
```java

    static String ledgerId2Key(Long lid) {
        return null == lid ? null : StringUtils.getZKStringId(lid);
    }

```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/SyncCallbackUtils.java`
#### Snippet
```java
            } catch (TimeoutException eignore) {
                // it's ok to return null if we timeout after 292 years (2^63 nanos)
                return null;
            }
        } catch (ExecutionException err) {
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentLongLongPairHashMap.java`
#### Snippet
```java
                        } else if (storedKey1 == EmptyKey) {
                            // Not found
                            return null;
                        }
                    } else {
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentLongLongPairHashMap.java`
#### Snippet
```java
                        } else if (storedKey1 == EmptyKey) {
                            // Not found
                            return null;
                        }
                    }
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java`
#### Snippet
```java
                // read
                fail(firstError);
                return null;
            }

```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java`
#### Snippet
```java
                Thread.currentThread().interrupt();
                fail(BKException.Code.InterruptedException);
                return null;
            }
        }
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java`
#### Snippet
```java
        BookieId maybeSendSpeculativeRead(BitSet heardFromHostsBitSet) {
            // no speculative read
            return null;
        }
    }
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java`
#### Snippet
```java
        synchronized BookieId maybeSendSpeculativeRead(BitSet heardFrom) {
            if (nextReplicaIndexToReadFrom >= getLedgerMetadata().getWriteQuorumSize()) {
                return null;
            }

```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java`
#### Snippet
```java
                return sendNextRead();
            } else {
                return null;
            }
        }
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadLastConfirmedAndEntryOp.java`
#### Snippet
```java
        synchronized BookieId maybeSendSpeculativeRead(BitSet heardFrom) {
            if (nextReplicaIndexToReadFrom >= getLedgerMetadata().getEnsembleSize()) {
                return null;
            }

```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadLastConfirmedAndEntryOp.java`
#### Snippet
```java
                return sendNextRead();
            } else {
                return null;
            }
        }
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadLastConfirmedAndEntryOp.java`
#### Snippet
```java
        BookieId maybeSendSpeculativeRead(BitSet heardFromHostsBitSet) {
            // no speculative read
            return null;
        }
    }
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadLastConfirmedAndEntryOp.java`
#### Snippet
```java

                fail(firstError);
                return null;
            }

```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadLastConfirmedAndEntryOp.java`
#### Snippet
```java
                Thread.currentThread().interrupt();
                fail(BKException.Code.InterruptedException);
                return null;
            }
        }
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BKException.java`
#### Snippet
```java
    public static final Function<Throwable, BKException> HANDLER = cause -> {
        if (cause == null) {
            return null;
        }
        if (cause instanceof BKException) {
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/api/BKException.java`
#### Snippet
```java
    static final Function<Throwable, BKException> HANDLER = cause -> {
        if (cause == null) {
            return null;
        }
        if (cause instanceof BKException) {
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/http/BKHttpServiceProvider.java`
#### Snippet
```java

    private Auditor getAuditor() {
        return autoRecovery == null ? null : autoRecovery.getAuditor();
    }

```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/http/BKHttpServiceProvider.java`
#### Snippet
```java

    private Bookie getBookie() {
        return bookieServer == null ? null : bookieServer.getBookie();
    }

```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/http/service/RecoveryBookieService.java`
#### Snippet
```java
                    }
                });
                return null;
            });

```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/feature/FixedValueFeature.java`
#### Snippet
```java
    @Override
    public String name() {
        return null;
    }

```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/discover/ZKRegistrationClient.java`
#### Snippet
```java
    private static BookieId stripBookieIdFromPath(String path) {
        if (path == null) {
            return null;
        }
        final int slash = path.lastIndexOf('/');
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/discover/ZKRegistrationClient.java`
#### Snippet
```java
            }
        }
        return null;
    }

```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RackawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
        }
        if (rackMap.size() == 0) {
            return null;
        }

```

### ReturnNull
Return of `null`
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdLayoutManager.java`
#### Snippet
```java
        GetResponse response = ioResult(kvClient.get(layoutKey, GetOption.DEFAULT));
        if (response.getCount() <= 0) {
            return null;
        } else {
            byte[] layoutData = response.getKvs().get(0).getValue().getBytes();
```

### ReturnNull
Return of `null`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/zookeeper/ZooKeeperClient.java`
#### Snippet
```java
                logger.error("Gave up reconnecting to ZooKeeper : ", e);
                Runtime.getRuntime().exit(-1);
                return null;
            }
        }
```

### ReturnNull
Return of `null`
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdMetadataBookieDriver.java`
#### Snippet
```java
        this.conf = conf;
        this.statsLogger = statsLogger;
        return null;
    }

```

### ReturnNull
Return of `null`
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/helpers/ValueStream.java`
#### Snippet
```java
    private synchronized Versioned<T> processWatchResponse(WatchResponse response) {
        if (null != closeFuture) {
            return null;
        }
        if (log.isDebugEnabled()) {
```

### ReturnNull
Return of `null`
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/helpers/ValueStream.java`
#### Snippet
```java

        if (response.getHeader().getRevision() <= revision) {
            return null;
        }
        revision = response.getHeader().getRevision();
```

### ReturnNull
Return of `null`
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/helpers/KeySetReader.java`
#### Snippet
```java
    private synchronized Versioned<Set<T>> processWatchResponse(WatchResponse response) {
        if (null != closeFuture) {
            return null;
        }
        if (log.isDebugEnabled()) {
```

### ReturnNull
Return of `null`
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/helpers/KeySetReader.java`
#### Snippet
```java

        if (response.getHeader().getRevision() <= revision) {
            return null;
        }
        revision = response.getHeader().getRevision();
```

### ReturnNull
Return of `null`
in `cpu-affinity/src/main/java/org/apache/bookkeeper/common/util/affinity/impl/CpuAffinityImpl.java`
#### Snippet
```java

            if (lock == null) {
                return null;
            } else {
                final FileLock finalLock = lock;
```

### ReturnNull
Return of `null`
in `stats/bookkeeper-stats-providers/codahale-metrics-provider/src/main/java/org/apache/bookkeeper/stats/codahale/FastTimer.java`
#### Snippet
```java
        @Override
        public Snapshot getSnapshot() {
            return null;
        }

```

### ReturnNull
Return of `null`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/AppendOnlyStreamReader.java`
#### Snippet
```java
                    LOG.debug("No record");
                }
                return null;
            }
        }
```

### ReturnNull
Return of `null`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/EnvelopedEntryReader.java`
#### Snippet
```java

        if (isExhausted) {
            return null;
        }

```

### ReturnNull
Return of `null`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKSyncLogReader.java`
#### Snippet
```java
                    readAheadReader.addStateChangeNotification(BKSyncLogReader.this);
                    readAheadReader.start(logSegments.getValue());
                    return null;
                });
    }
```

### ReturnNull
Return of `null`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKSyncLogReader.java`
#### Snippet
```java
                    currentEntry = readNextEntry(nonBlocking);
                    if (null == currentEntry) {
                        return null;
                    }
                }
```

### ReturnNull
Return of `null`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAbstractLogWriter.java`
#### Snippet
```java
                            @Override
                            public BKLogSegmentWriter apply(LogSegmentMetadata completedLogSegment) {
                                return null;
                            }
                        });
```

### ReturnNull
Return of `null`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAbstractLogWriter.java`
#### Snippet
```java
        CompletableFuture<BKLogSegmentWriter> ledgerWriterFuture = getCachedLogWriterFuture();
        if (null == ledgerWriterFuture || null == ledgerWriter) {
            return null;
        }

```

### ReturnNull
Return of `null`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAsyncLogReader.java`
#### Snippet
```java
    private synchronized LogRecordWithDLSN readNextRecord() throws IOException {
        if (null == readAheadReader) {
            return null;
        }
        if (null == currentEntry) {
```

### ReturnNull
Return of `null`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAsyncLogReader.java`
#### Snippet
```java
            // no entry after reading from read ahead then return null
            if (null == currentEntry) {
                return null;
            }
        }
```

### ReturnNull
Return of `null`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAsyncLogReader.java`
#### Snippet
```java
            }, period, period, TimeUnit.MILLISECONDS);
        }
        return null;
    }

```

### ReturnNull
Return of `null`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAsyncLogWriter.java`
#### Snippet
```java
                && segmentWriter.isLogSegmentInError()
                && !disableRollOnSegmentError) {
            return null;
        } else {
            return segmentWriter;
```

### ReturnNull
Return of `null`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/ReadAheadEntryReader.java`
#### Snippet
```java
            }, idleWarnThresholdMillis, idleWarnThresholdMillis, TimeUnit.MILLISECONDS);
        }
        return null;
    }

```

### ReturnNull
Return of `null`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogWriteHandler.java`
#### Snippet
```java
                                inprogressLSSNs.remove((Long) l.getLogSegmentSequenceNumber());
                            }
                            return null;
                        });
            } else {
```

### ReturnNull
Return of `null`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogSegmentWriter.java`
#### Snippet
```java
                    // Control flushes always have at least the control record to flush
                    transmitDataMisses.inc();
                    return null;
                }

```

### ReturnNull
Return of `null`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/ZKMetadataAccessor.java`
#### Snippet
```java
            Stat currentStat = readerZKC.get().exists(zkPath, false);
            if (currentStat == null) {
                return null;
            } else {
                return readerZKC.get().getData(zkPath, false, currentStat);
```

### ReturnNull
Return of `null`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/lock/ZKDistributedLock.java`
#### Snippet
```java
                    throw lockReacquireException;
                } else {
                    return null;
                }
            }
```

### ReturnNull
Return of `null`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
            List<LogSegmentMetadata> segments = dlm.getLogSegments();
            if (segments.isEmpty()) {
                return null;
            }
            List<CompletableFuture<LogSegmentCandidate>> futures =
```

### ReturnNull
Return of `null`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
            }
            if (streamCandidate.segmentCandidates.isEmpty()) {
                return null;
            }
            return streamCandidate;
```

### ReturnNull
Return of `null`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
                    return new LogSegmentCandidate(metadata, record);
                } else {
                    return null;
                }
            }
```

### ReturnNull
Return of `null`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
        @Override
        protected String getUsage() {
            return null;
        }
    }
```

### ReturnNull
Return of `null`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/metadata/ZKLogStreamMetadataStore.java`
#### Snippet
```java
                        deleteOps);
                }
                return null;
            })
            // get the missing paths
```

### ReturnNull
Return of `null`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/util/Utils.java`
#### Snippet
```java
    public static String getParent(final String path) {
        if (path == null) {
            return null;
        }
        if (path.length() < 2) {
```

### ReturnNull
Return of `null`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/util/Utils.java`
#### Snippet
```java
        }
        if (path.length() < 2) {
            return null;
        }
        int firstIndex = path.indexOf("/");
```

### ReturnNull
Return of `null`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/util/Utils.java`
#### Snippet
```java
        int firstIndex = path.indexOf("/");
        if (firstIndex == -1) {
            return null;
        }
        int lastIndex = path.lastIndexOf("/");
```

### ReturnNull
Return of `null`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/util/Utils.java`
#### Snippet
```java
        }
        if (lastIndex == -1) {
            return null;
        }
        if (lastIndex == 0) {
```

### ReturnNull
Return of `null`
in `stream/common/src/main/java/org/apache/bookkeeper/common/resolver/NameResolverProviderFactory.java`
#### Snippet
```java
            }
        }
        return null;
    }

```

### ReturnNull
Return of `null`
in `stream/distributedlog/io/dlfs/src/main/java/org/apache/distributedlog/fs/DLInputStream.java`
#### Snippet
```java
            return new RecordStream(record);
        }
        return null;
    }

```

### ReturnNull
Return of `null`
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVAsyncStore.java`
#### Snippet
```java
            byte[] valBytes = localStore.get(keyBytes);
            if (null == valBytes) {
                return null;
            } else {
                return KVUtils.deserialize(valCoder, Unpooled.wrappedBuffer(valBytes));
```

### ReturnNull
Return of `null`
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVAsyncStore.java`
#### Snippet
```java
                byte[] prevValue = localStore.putIfAbsent(keyBytes, serializedBytes, revision);
                if (null == prevValue) {
                    return null;
                } else {
                    return KVUtils.deserialize(valCoder, Unpooled.wrappedBuffer(prevValue));
```

### ReturnNull
Return of `null`
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVAsyncStore.java`
#### Snippet
```java
            byte[] prevValue = localStore.delete(keyBytes, revision);
            if (null == prevValue) {
                return null;
            } else {
                return KVUtils.deserialize(valCoder, Unpooled.wrappedBuffer(prevValue));
```

### ReturnNull
Return of `null`
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/CheckpointInfo.java`
#### Snippet
```java
                    throw new StateStoreException("Failed to create dir " + dbName, ioe);
                }
                return null;
            }
            // for proper sorting
```

### ReturnNull
Return of `null`
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java

        if (value == null) {
            return null;
        }

```

### ReturnNull
Return of `null`
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java

        putRaw(key, keyBytes, value, revision);
        return null;
    }

```

### ReturnNull
Return of `null`
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
        byte[] valBytes = getRawBytes(key, keyBytes);
        if (null == valBytes) {
            return null;
        }
        return valCoder.decode(valBytes);
```

### ReturnNull
Return of `null`
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/dlog/DLInputStream.java`
#### Snippet
```java
            return new RecordStream(record);
        }
        return null;
    }

```

### ReturnNull
Return of `null`
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/ReflectionUtils.java`
#### Snippet
```java
                return theCls.asSubclass(xface);
            } else {
                return null;
            }
        } catch (Exception e) {
```

### ReturnNull
Return of `null`
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/conf/ConfigKey.java`
#### Snippet
```java
    private String defaultValueAsString() {
        if (null == defaultValue) {
            return null;
        } else if (defaultValue instanceof String) {
            return (String) defaultValue;
```

### ReturnNull
Return of `null`
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/collections/GrowableMpScArrayConsumerBlockingQueue.java`
#### Snippet
```java
            }
        } else {
            return null;
        }
    }
```

### ReturnNull
Return of `null`
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/collections/GrowableMpScArrayConsumerBlockingQueue.java`
#### Snippet
```java
            }
        } else {
            return null;
        }
    }
```

### ReturnNull
Return of `null`
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/collections/BatchedArrayBlockingQueue.java`
#### Snippet
```java
        try {
            if (size == 0) {
                return null;
            }

```

### ReturnNull
Return of `null`
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/collections/BatchedArrayBlockingQueue.java`
#### Snippet
```java
        try {
            if (size == 0) {
                return null;
            }

```

### ReturnNull
Return of `null`
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/concurrent/FutureUtils.java`
#### Snippet
```java
            ExceptionT cause = exceptionHandler.apply(e.getCause());
            if (null == cause) {
                return null;
            } else {
                throw cause;
```

### ReturnNull
Return of `null`
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/concurrent/FutureUtils.java`
#### Snippet
```java
            } catch (TimeoutException eignore) {
                // it's ok to return null if we timeout after 292 years (2^63 nanos)
                return null;
            }
        } catch (InterruptedException e) {
```

### ReturnNull
Return of `null`
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/concurrent/FutureUtils.java`
#### Snippet
```java
            ExceptionT cause = exceptionHandler.apply(e.getCause());
            if (null == cause) {
                return null;
            } else {
                throw cause;
```

### ReturnNull
Return of `null`
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/mvcc/MVCCStoreImpl.java`
#### Snippet
```java
            byte[] valBytes = this.db.get(dataCfHandle, keyBytes);
            if (null == valBytes) {
                return null;
            }
            MVCCRecord record = recordCoder.decode(valBytes);
```

### ReturnNull
Return of `null`
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/mvcc/MVCCStoreImpl.java`
#### Snippet
```java
                }
                if (result.count() <= 0) {
                    return null;
                } else {
                    return retain(result.kvs().get(0).value());
```

### ReturnNull
Return of `null`
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/mvcc/MVCCStoreImpl.java`
#### Snippet
```java
                }
                if (result.count() <= 0) {
                    return null;
                } else {
                    return result.kvs().get(0).numberValue();
```

### ReturnNull
Return of `null`
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/mvcc/MVCCStoreImpl.java`
#### Snippet
```java
                    if (!iter.isValid()) {
                        // no key to delete
                        return null;
                    }
                    rawKey = iter.key();
```

### ReturnNull
Return of `null`
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/mvcc/MVCCStoreImpl.java`
#### Snippet
```java
                    if (!iter.isValid()) {
                        // no key to delete
                        return null;
                    }
                    rawEndKey = iter.key();
```

## RuleId[id=UnnecessaryLocalVariable]
### UnnecessaryLocalVariable
Local variable `dataOffset` is redundant
in `stream/distributedlog/protocol/src/main/java/org/apache/distributedlog/EnvelopedRecordSetWriter.java`
#### Snippet
```java

    ByteBuf createBuffer() {
        int dataOffset = HEADER_LEN;
        int dataLen = buffer.readableBytes() - HEADER_LEN;

```

### UnnecessaryLocalVariable
Local variable `rangeResp` is redundant
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/kv/TableStoreImpl.java`
#### Snippet
```java
            .thenApply(result -> {
                try {
                    RangeResponse rangeResp = processRangeResult(
                        rangeReq.getHeader(),
                        result);
```

### UnnecessaryLocalVariable
Local variable `switchMap` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/CachedDNSToSwitchMapping.java`
#### Snippet
```java
  @Override
  public Map<String, String> getSwitchMap() {
    Map<String, String> switchMap = new HashMap<String, String>(cache);
    return switchMap;
  }
```

### UnnecessaryLocalVariable
Local variable `result` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/ZkLedgerAuditorManager.java`
#### Snippet
```java
            long voteSeqId1 = getVoteSequenceId(vote1);
            long voteSeqId2 = getVoteSequenceId(vote2);
            int result = voteSeqId1 < voteSeqId2 ? -1
                    : (voteSeqId1 > voteSeqId2 ? 1 : 0);
            return result;
```

### UnnecessaryLocalVariable
Local variable `retval` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/sasl/SaslClientState.java`
#### Snippet
```java
    public byte[] saslResponse(byte[] saslTokenMessage) {
        try {
            byte[] retval = saslClient.evaluateChallenge(saslTokenMessage);
            return retval;
        } catch (SaslException e) {
```

### UnnecessaryLocalVariable
Local variable `retval` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/sasl/SaslClientState.java`
#### Snippet
```java
        if (clientSubject != null) {
            try {
                final byte[] retval = Subject.doAs(clientSubject, new PrivilegedExceptionAction<byte[]>() {
                        @Override
                        public byte[] run() throws SaslException {
```

### UnnecessaryLocalVariable
Local variable `retval` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/sasl/SaslServerState.java`
#### Snippet
```java
    public byte[] response(byte[] token) throws SaslException {
        try {
            byte[] retval = saslServer.evaluateResponse(token);
            return retval;
        } catch (SaslException e) {
```

### UnnecessaryLocalVariable
Local variable `used` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/DiskChecker.java`
#### Snippet
```java
        }
        float free = (float) getTotalFreeSpace(dirs) / (float) getTotalDiskSpace(dirs);
        float used = 1f - free;
        return used;
    }
```

### UnnecessaryLocalVariable
Local variable `numSections` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentLongHashSet.java`
#### Snippet
```java
        checkArgument(shrinkFactor > 1);

        int numSections = concurrencyLevel;
        int perSectionExpectedItems = expectedItems / numSections;
        int perSectionCapacity = (int) (perSectionExpectedItems / SetFillFactor);
```

### UnnecessaryLocalVariable
Local variable `newValues` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentOpenHashSet.java`
#### Snippet
```java

        private void shrinkToInitCapacity() {
            V[] newValues = (V[]) new Object[initCapacity];

            values = newValues;
```

### UnnecessaryLocalVariable
Local variable `numSections` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentOpenHashSet.java`
#### Snippet
```java
        checkArgument(shrinkFactor > 1);

        int numSections = concurrencyLevel;
        int perSectionExpectedItems = expectedItems / numSections;
        int perSectionCapacity = (int) (perSectionExpectedItems / mapFillFactor);
```

### UnnecessaryLocalVariable
Local variable `numSections` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentLongHashMap.java`
#### Snippet
```java
        checkArgument(shrinkFactor > 1);

        int numSections = concurrencyLevel;
        int perSectionExpectedItems = expectedItems / numSections;
        int perSectionCapacity = (int) (perSectionExpectedItems / mapFillFactor);
```

### UnnecessaryLocalVariable
Local variable `numSections` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentOpenHashMap.java`
#### Snippet
```java
        checkArgument(shrinkFactor > 1);

        int numSections = concurrencyLevel;
        int perSectionExpectedItems = expectedItems / numSections;
        int perSectionCapacity = (int) (perSectionExpectedItems / mapFillFactor);
```

### UnnecessaryLocalVariable
Local variable `newTable` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentOpenHashMap.java`
#### Snippet
```java

        private void shrinkToInitCapacity() {
            Object[] newTable = new Object[2 * initCapacity];

            table = newTable;
```

### UnnecessaryLocalVariable
Local variable `e` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LedgerDirsManager.java`
#### Snippet
```java
        if (writableLedgerDirectories.isEmpty()) {
            String errMsg = "All ledger directories are non writable";
            NoWritableLedgerDirException e = new NoWritableLedgerDirException(
                    errMsg);
            throw e;
```

### UnnecessaryLocalVariable
Local variable `metadata` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryLogMetadata.java`
#### Snippet
```java

        public static EntryLogMetadataRecyclable get() {
            EntryLogMetadataRecyclable metadata = RECYCLER.get();
            return metadata;
        }
```

### UnnecessaryLocalVariable
Local variable `lastEntry` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LedgerCacheImpl.java`
#### Snippet
```java
        // last in mem entry and only then attempt to get the last persisted entry from the file
        // The latter is just an optimization
        long lastEntry = indexPersistenceManager.getPersistEntryBeyondInMem(ledgerId, lastEntryInMem);
        return lastEntry;
    }
```

### UnnecessaryLocalVariable
Local variable `metadata` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/PersistentEntryLogMetadataMap.java`
#### Snippet
```java
        localBais.reset();
        localDatais.reset();
        EntryLogMetadataRecyclable metadata = EntryLogMetadata.deserialize(datais.get());
        return metadata;
    }
```

### UnnecessaryLocalVariable
Local variable `firstIndex` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/datainteg/WriteSets.java`
#### Snippet
```java
        ImmutableList.Builder<Integer> builder =
            new ImmutableList.Builder<Integer> ();
        int firstIndex = offset;
        int lastIndex = (offset + writeQuorumSize - 1) % ensembleSize;
        for (Integer i : preferredOrder) {
```

### UnnecessaryLocalVariable
Local variable `bytesToRead` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectReader.java`
#### Snippet
```java

        long bufferOffset = 0;
        long bytesToRead = Math.min(blockSize, bytesAvailable);
        long bytesOutstanding = bytesToRead;
        long bytesRead = -1;
```

### UnnecessaryLocalVariable
Local variable `numSections` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentLongLongHashMap.java`
#### Snippet
```java
        checkArgument(shrinkFactor > 1);

        int numSections = concurrencyLevel;
        int perSectionExpectedItems = expectedItems / numSections;
        int perSectionCapacity = (int) (perSectionExpectedItems / mapFillFactor);
```

### UnnecessaryLocalVariable
Local variable `numSections` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentLongLongPairHashMap.java`
#### Snippet
```java
        checkArgument(shrinkFactor > 1);

        int numSections = concurrencyLevel;
        int perSectionExpectedItems = expectedItems / numSections;
        int perSectionCapacity = (int) (perSectionExpectedItems / mapFillFactor);
```

### UnnecessaryLocalVariable
Local variable `mse` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookieWatcherImpl.java`
#### Snippet
```java
            return new BKInterruptedException();
        } else {
            MetaStoreException mse = new MetaStoreException(cause);
            return mse;
        }
```

### UnnecessaryLocalVariable
Local variable `ret` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/streaming/LedgerInputStream.java`
#### Snippet
```java
        }
        if (toread) {
            int ret = 0xFF & bytebuff.get();
            return ret;
        }
```

### UnnecessaryLocalVariable
Local variable `gracePeriod` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/ReplicationWorker.java`
#### Snippet
```java
     */
    private void deferLedgerLockRelease(final long ledgerId) {
        long gracePeriod = this.openLedgerRereplicationGracePeriod;
        TimerTask timerTask = new TimerTask() {
            @Override
```

### UnnecessaryLocalVariable
Local variable `newEnsembleResult` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RackawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
            Set<BookieId> comprehensiveExclusionBookiesSet = addDefaultRackBookiesIfMinNumRacksIsEnforced(
                    excludeBookies);
            PlacementResult<List<BookieId>> newEnsembleResult = newEnsembleInternal(ensembleSize,
                    writeQuorumSize, ackQuorumSize, comprehensiveExclusionBookiesSet, null, null);
            return newEnsembleResult;
```

### UnnecessaryLocalVariable
Local variable `bn` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RackawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
                    continue;
                }
                BookieNode bn = (BookieNode) n;
                return bn;
            }
```

### UnnecessaryLocalVariable
Local variable `result` is redundant
in `stream/clients/java/kv/src/main/java/org/apache/bookkeeper/clients/impl/kv/KvUtils.java`
#### Snippet
```java
        ResultFactory<ByteBuf, ByteBuf> resultFactory,
        KeyValueFactory<ByteBuf, ByteBuf> kvFactory) {
        IncrementResultImpl<ByteBuf, ByteBuf> result = resultFactory.newIncrementResult(-1L)
            .totalAmount(response.getTotalAmount());
        return result;
```

### UnnecessaryLocalVariable
Local variable `dataOffset` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/EnvelopedEntryWriter.java`
#### Snippet
```java
        }

        int dataOffset = HEADER_LENGTH;
        int dataLen = buffer.readableBytes() - HEADER_LENGTH;

```

### UnnecessaryLocalVariable
Local variable `periodicFlushFrequency` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogSegmentWriter.java`
#### Snippet
```java
        final int configuredPeriodicFlushFrequency = dynConf.getPeriodicFlushFrequencyMilliSeconds();
        if (!immediateFlushEnabled || (0 != this.transmissionThreshold)) {
            int periodicFlushFrequency = configuredPeriodicFlushFrequency;
            if (periodicFlushFrequency > 0 && scheduler != null) {
                periodicFlushSchedule = scheduler.scheduleAtFixedRate(this,
```

### UnnecessaryLocalVariable
Local variable `lock` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/metadata/ZKLogStreamMetadataStore.java`
#### Snippet
```java
        return ensureReadLockPathExist(metadata, readLockPath)
            .thenApplyAsync((value) -> {
                DistributedLock lock = new ZKDistributedLock(
                    getLockStateExecutor(true),
                    getLockFactory(true),
```

### UnnecessaryLocalVariable
Local variable `dlNamespace` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/auditor/DLAuditor.java`
#### Snippet
```java
                int i = 0;
                for (final Namespace namespace : namespaces) {
                    final Namespace dlNamespace = namespace;
                    final URI uri = uris.get(i);
                    final List<String> aps = allocationPaths.get(i);
```

### UnnecessaryLocalVariable
Local variable `res` is redundant
in `native-io/src/main/java/org/apache/bookkeeper/common/util/nativeio/NativeIOImpl.java`
#### Snippet
```java
    @Override
    public int open(String pathname, int flags, int mode) throws NativeIOException {
        int res = NativeIOJni.open(pathname, flags, mode);
        return res;
    }
```

## RuleId[id=BusyWait]
### BusyWait
Call to `Thread.sleep()` in a loop, probably busy-waiting
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/sasl/TGTRefreshThread.java`
#### Snippet
```java
                LOG.info("TGT refresh sleeping until: {}", until);
                try {
                    Thread.sleep(nextRefresh - now);
                } catch (InterruptedException ie) {
                    Thread.currentThread().interrupt();
```

### BusyWait
Call to `Thread.sleep()` in a loop, probably busy-waiting
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/sasl/TGTRefreshThread.java`
#### Snippet
```java
                            // sleep for 10 seconds
                            try {
                                Thread.sleep(10 * 1000);
                            } catch (InterruptedException ie) {
                                Thread.currentThread().interrupt();
```

### BusyWait
Call to `Thread.sleep()` in a loop, probably busy-waiting
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/sasl/TGTRefreshThread.java`
#### Snippet
```java
                            // sleep for 10 seconds.
                            try {
                                Thread.sleep(10 * 1000);
                            } catch (InterruptedException e) {
                                Thread.currentThread().interrupt();
```

### BusyWait
Call to `Thread.sleep()` in a loop, probably busy-waiting
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/LocalBookKeeper.java`
#### Snippet
```java
                    lb.start();
                    while (true) {
                        Thread.sleep(1000);
                    }
                } catch (InterruptedException ie) {
```

### BusyWait
Call to `Thread.sleep()` in a loop, probably busy-waiting
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/LocalBookKeeper.java`
#### Snippet
```java
            }
            try {
                Thread.sleep(250);
            } catch (InterruptedException e) {
                Thread.currentThread().interrupt();
```

### BusyWait
Call to `Thread.sleep()` in a loop, probably busy-waiting
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieNettyServer.java`
#### Snippet
```java
                    while (suspended && isRunning()) {
                        try {
                            Thread.sleep(10);
                        } catch (InterruptedException e) {
                            Thread.currentThread().interrupt();
```

### BusyWait
Call to `Thread.sleep()` in a loop, probably busy-waiting
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieServer.java`
#### Snippet
```java
            while (true) {
                try {
                    Thread.sleep(watchInterval);
                } catch (InterruptedException ie) {
                    // do nothing
```

### BusyWait
Call to `Thread.sleep()` in a loop, probably busy-waiting
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/GarbageCollectorThread.java`
#### Snippet
```java
        while (!compacting.compareAndSet(false, true)) {
            // Wait till the thread stops compacting
            Thread.sleep(100);
        }

```

### BusyWait
Call to `Thread.sleep()` in a loop, probably busy-waiting
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/SingleDirectoryDbLedgerStorage.java`
#### Snippet
```java
            // Wait some time and try again
            try {
                Thread.sleep(1);
            } catch (InterruptedException e) {
                Thread.currentThread().interrupt();
```

### BusyWait
Call to `Thread.sleep()` in a loop, probably busy-waiting
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/AutoRecoveryMain.java`
#### Snippet
```java
            while (true) {
                try {
                    Thread.sleep(watchInterval);
                } catch (InterruptedException ie) {
                    Thread.currentThread().interrupt();
```

### BusyWait
Call to `Thread.sleep()` in a loop, probably busy-waiting
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeperAdmin.java`
#### Snippet
```java
            int sleepTimeForThisCheck = (long) ledgers.size() * sleepTimePerLedger > maxSleepTimeInBetweenChecks
                    ? maxSleepTimeInBetweenChecks : ledgers.size() * sleepTimePerLedger;
            Thread.sleep(sleepTimeForThisCheck);
            if (LOG.isDebugEnabled()) {
                LOG.debug("Making sure following ledgers replication to be completed: {}", ledgers);
```

### BusyWait
Call to `Thread.sleep()` in a loop, probably busy-waiting
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LocalDLMEmulator.java`
#### Snippet
```java
                        LOG.info("{} bookies are started.", numBookies);
                        while (true) {
                            Thread.sleep(1000);
                        }
                    } finally {
```

### BusyWait
Call to `Thread.sleep()` in a loop, probably busy-waiting
in `bookkeeper-benchmark/src/main/java/org/apache/bookkeeper/benchmark/BenchReadThroughputLatency.java`
#### Snippet
```java
                        break;
                    } else {
                        Thread.sleep(1000);
                        continue;
                    }
```

### BusyWait
Call to `Thread.sleep()` in a loop, probably busy-waiting
in `bookkeeper-benchmark/src/main/java/org/apache/bookkeeper/benchmark/BenchReadThroughputLatency.java`
#### Snippet
```java
                lh.close();
                lh = null;
                Thread.sleep(1000);
            }
        } catch (InterruptedException ie) {
```

### BusyWait
Call to `Thread.sleep()` in a loop, probably busy-waiting
in `bookkeeper-benchmark/src/main/java/org/apache/bookkeeper/benchmark/BenchThroughputLatency.java`
#### Snippet
```java
                    try {
                        while (true) {
                            Thread.sleep(1000);
                            LOG.info("ms: {} req: {}", System.currentTimeMillis(), completedRequests.getAndSet(0));
                        }
```

### BusyWait
Call to `Thread.sleep()` in a loop, probably busy-waiting
in `bookkeeper-benchmark/src/main/java/org/apache/bookkeeper/benchmark/BenchThroughputLatency.java`
#### Snippet
```java
            int i = 0;
            while (this.counter.get() > 0) {
                Thread.sleep(1000);
                i++;
                if (i > 30) {
```

## RuleId[id=UseCompareMethod]
### UseCompareMethod
Expression can be replaced with 'Long.compare'
in `stream/distributedlog/protocol/src/main/java/org/apache/distributedlog/DLSN.java`
#### Snippet
```java
            return (this.entryId < that.entryId) ? -1 : 1;
        } else {
            return (this.slotId < that.slotId) ? -1 : (this.slotId == that.slotId) ? 0 : 1;
        }
    }
```

### UseCompareMethod
Expression can be replaced with 'Long.compare'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/ZkLedgerAuditorManager.java`
#### Snippet
```java
            long voteSeqId1 = getVoteSequenceId(vote1);
            long voteSeqId2 = getVoteSequenceId(vote2);
            int result = voteSeqId1 < voteSeqId2 ? -1
                    : (voteSeqId1 > voteSeqId2 ? 1 : 0);
            return result;
        }
```

### UseCompareMethod
Expression can be replaced with 'Long.compare'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/WeightedRandomSelectionImpl.java`
#### Snippet
```java
            public int compare(WeightedObject o1, WeightedObject o2) {
                long diff = o1.getWeight() - o2.getWeight();
                if (diff < 0L) {
                    return -1;
                } else if (diff > 0L) {
```

### UseCompareMethod
Expression can be replaced with 'Long.compare'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java
            if ((o1.getLogSegmentSequenceNumber() == DistributedLogConstants.UNASSIGNED_LOGSEGMENT_SEQNO)
                    || (o2.getLogSegmentSequenceNumber() == DistributedLogConstants.UNASSIGNED_LOGSEGMENT_SEQNO)) {
                if (o1.firstTxId > o2.firstTxId) {
                    return -1;
                } else if (o1.firstTxId == o2.firstTxId) {
```

### UseCompareMethod
Expression can be replaced with 'Long.compare'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java
            if ((o1.getLogSegmentSequenceNumber() == DistributedLogConstants.UNASSIGNED_LOGSEGMENT_SEQNO)
                    || (o2.getLogSegmentSequenceNumber() == DistributedLogConstants.UNASSIGNED_LOGSEGMENT_SEQNO)) {
                if (o1.firstTxId < o2.firstTxId) {
                    return -1;
                } else if (o1.firstTxId == o2.firstTxId) {
```

### UseCompareMethod
Expression can be replaced with 'Long.compare'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java

    static int compareByCompletionTime(long time1, long time2) {
        return time1 > time2 ? 1 : (time1 < time2 ? -1 : 0);
    }

```

## RuleId[id=RedundantFileCreation]
### RedundantFileCreation
`new File` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java

                    br = new BufferedReader(new InputStreamReader(
                            new FileInputStream(new File(cmdline.getOptionValue("lf"))), UTF_8.name()));
                    String line;
                    while ((line = br.readLine()) != null) {
```

## RuleId[id=UseBulkOperation]
### UseBulkOperation
Iteration can be replaced with bulk 'Map.putAll()' call
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/SnapshotMap.java`
#### Snippet
```java
        // merging the updates to snapshot
        for (Map.Entry<K, V> entry : updatesToMerge.entrySet()) {
            snapshot.put(entry.getKey(), entry.getValue());
        }
        // clear updatesToMerge
```

### UseBulkOperation
Iteration can be replaced with bulk 'Map.putAll()' call
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/DefaultEnsemblePlacementPolicy.java`
#### Snippet
```java
        try {
            for (Map.Entry<BookieId, BookieInfo> e : bookieInfoMap.entrySet()) {
                this.bookieInfoMap.put(e.getKey(), e.getValue());
            }
            this.weightedSelection.updateMap(this.bookieInfoMap);
```

### UseBulkOperation
Iteration can be replaced with bulk 'Collection.addAll()' call
in `stream/common/src/main/java/org/apache/bookkeeper/common/resolver/ServiceNameResolverProvider.java`
#### Snippet
```java
                List<String> hostList = new ArrayList<>();
                for (String host : hosts) {
                    hostList.add(host);
                }
                List<URI> hostUris = Lists.transform(
```

## RuleId[id=UnstableApiUsage]
### UnstableApiUsage
'com.google.common.net.InetAddresses' is marked unstable with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/BookieSocketAddress.java`
#### Snippet
```java
            throw new UnknownHostException(addr);
        }
        if (InetAddresses.isInetAddress(hostname)) {
            socketAddress = Optional.of(new InetSocketAddress(hostname, port));
        } else {
```

### UnstableApiUsage
'isInetAddress(java.lang.String)' is declared in unstable class 'com.google.common.net.InetAddresses' marked with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/BookieSocketAddress.java`
#### Snippet
```java
            throw new UnknownHostException(addr);
        }
        if (InetAddresses.isInetAddress(hostname)) {
            socketAddress = Optional.of(new InetSocketAddress(hostname, port));
        } else {
```

### UnstableApiUsage
'com.google.common.net.InetAddresses' is marked unstable with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/BookieSocketAddress.java`
#### Snippet
```java
         * nodes HostName is considered static.
         */
        if (InetAddresses.isInetAddress(hostname)) {
            socketAddress = Optional.of(new InetSocketAddress(hostname, port));
        } else {
```

### UnstableApiUsage
'isInetAddress(java.lang.String)' is declared in unstable class 'com.google.common.net.InetAddresses' marked with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/BookieSocketAddress.java`
#### Snippet
```java
         * nodes HostName is considered static.
         */
        if (InetAddresses.isInetAddress(hostname)) {
            socketAddress = Optional.of(new InetSocketAddress(hostname, port));
        } else {
```

### UnstableApiUsage
'com.google.common.net.InetAddresses' is marked unstable with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/helpers/CommandHelpers.java`
#### Snippet
```java
            String realHostname;
            String ip;
            if (InetAddresses.isInetAddress(hostname)){
                ip = hostname;
                realHostname = networkAddress.getSocketAddress().getAddress().getCanonicalHostName();
```

### UnstableApiUsage
'isInetAddress(java.lang.String)' is declared in unstable class 'com.google.common.net.InetAddresses' marked with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/helpers/CommandHelpers.java`
#### Snippet
```java
            String realHostname;
            String ip;
            if (InetAddresses.isInetAddress(hostname)){
                ip = hostname;
                realHostname = networkAddress.getSocketAddress().getAddress().getCanonicalHostName();
```

### UnstableApiUsage
'com.google.common.util.concurrent.RateLimiter' is marked unstable with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/InterleavedLedgerStorage.java`
#### Snippet
```java
    @Override
    @SuppressFBWarnings("RCN_REDUNDANT_NULLCHECK_WOULD_HAVE_BEEN_A_NPE")
    public List<DetectedInconsistency> localConsistencyCheck(Optional<RateLimiter> rateLimiter) throws IOException {
        long checkStart = MathUtils.nowInNano();
        LOG.info("Starting localConsistencyCheck");
```

### UnstableApiUsage
'com.google.common.util.concurrent.RateLimiter' is marked unstable with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/InterleavedLedgerStorage.java`
#### Snippet
```java
                        long start = MathUtils.nowInNano();
                        lep.getEntries((entry, offset) -> {
                            rateLimiter.ifPresent(RateLimiter::acquire);

                            try {
```

### UnstableApiUsage
'acquire()' is declared in unstable class 'com.google.common.util.concurrent.RateLimiter' marked with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/InterleavedLedgerStorage.java`
#### Snippet
```java
                        long start = MathUtils.nowInNano();
                        lep.getEntries((entry, offset) -> {
                            rateLimiter.ifPresent(RateLimiter::acquire);

                            try {
```

### UnstableApiUsage
'com.google.common.util.concurrent.RateLimiter' is marked unstable with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/AbstractLogCompactor.java`
#### Snippet
```java
     */
    public static class Throttler {
        private final RateLimiter rateLimiter;
        private final boolean isThrottleByBytes;
        private final AtomicBoolean cancelled = new AtomicBoolean(false);
```

### UnstableApiUsage
'tryAcquire(int, long, java.util.concurrent.TimeUnit)' is declared in unstable class 'com.google.common.util.concurrent.RateLimiter' marked with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/AbstractLogCompactor.java`
#### Snippet
```java
        // acquire. if bybytes: bytes of this entry; if byentries: 1.
        boolean tryAcquire(int permits, long timeout, TimeUnit unit) {
            return rateLimiter.tryAcquire(this.isThrottleByBytes ? permits : 1, timeout, unit);
        }

```

### UnstableApiUsage
'com.google.common.util.concurrent.RateLimiter' is marked unstable with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/AbstractLogCompactor.java`
#### Snippet
```java
        Throttler(ServerConfiguration conf) {
            this.isThrottleByBytes  = conf.getIsThrottleByBytes();
            this.rateLimiter = RateLimiter.create(this.isThrottleByBytes
                ? conf.getCompactionRateByBytes() : conf.getCompactionRateByEntries());
        }
```

### UnstableApiUsage
'create(double)' is declared in unstable class 'com.google.common.util.concurrent.RateLimiter' marked with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/AbstractLogCompactor.java`
#### Snippet
```java
        Throttler(ServerConfiguration conf) {
            this.isThrottleByBytes  = conf.getIsThrottleByBytes();
            this.rateLimiter = RateLimiter.create(this.isThrottleByBytes
                ? conf.getCompactionRateByBytes() : conf.getCompactionRateByEntries());
        }
```

### UnstableApiUsage
'com.google.common.util.concurrent.RateLimiter' is marked unstable with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/SortedLedgerStorage.java`
#### Snippet
```java

    @Override
    public List<DetectedInconsistency> localConsistencyCheck(Optional<RateLimiter> rateLimiter) throws IOException {
        return interleavedLedgerStorage.localConsistencyCheck(rateLimiter);
    }
```

### UnstableApiUsage
'com.google.common.util.concurrent.RateLimiter' is marked unstable with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LedgerStorage.java`
#### Snippet
```java
     * @throws IOException
     */
    default List<DetectedInconsistency> localConsistencyCheck(Optional<RateLimiter> rateLimiter) throws IOException {
        return new ArrayList<>();
    }
```

### UnstableApiUsage
'com.google.common.util.concurrent.RateLimiter' is marked unstable with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/UpdateLedgerOp.java`
#### Snippet
```java
        final Set<CompletableFuture<?>> outstanding =
            Collections.newSetFromMap(new ConcurrentHashMap<CompletableFuture<?>, Boolean>());
        final RateLimiter throttler = RateLimiter.create(rate);
        final Semaphore outstandingReads = new Semaphore(maxOutstandingReads);
        final Iterator<Long> ledgerItr = admin.listLedgers().iterator();
```

### UnstableApiUsage
'com.google.common.util.concurrent.RateLimiter' is marked unstable with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/UpdateLedgerOp.java`
#### Snippet
```java
        final Set<CompletableFuture<?>> outstanding =
            Collections.newSetFromMap(new ConcurrentHashMap<CompletableFuture<?>, Boolean>());
        final RateLimiter throttler = RateLimiter.create(rate);
        final Semaphore outstandingReads = new Semaphore(maxOutstandingReads);
        final Iterator<Long> ledgerItr = admin.listLedgers().iterator();
```

### UnstableApiUsage
'create(double)' is declared in unstable class 'com.google.common.util.concurrent.RateLimiter' marked with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/UpdateLedgerOp.java`
#### Snippet
```java
        final Set<CompletableFuture<?>> outstanding =
            Collections.newSetFromMap(new ConcurrentHashMap<CompletableFuture<?>, Boolean>());
        final RateLimiter throttler = RateLimiter.create(rate);
        final Semaphore outstandingReads = new Semaphore(maxOutstandingReads);
        final Iterator<Long> ledgerItr = admin.listLedgers().iterator();
```

### UnstableApiUsage
'com.google.common.math.Quantiles.ScaleAndIndex' is declared in unstable class 'com.google.common.math.Quantiles' marked with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/DynamicWeightedRandomSelectionImpl.java`
#### Snippet
```java
                ArrayList<Long> weightList = selectedNodes.stream().map(weightFunc)
                        .collect(Collectors.toCollection(ArrayList::new));
                ScaleAndIndex median = Quantiles.median();
                medianWeight = (long) median.compute(weightList);
            }
```

### UnstableApiUsage
'com.google.common.math.Quantiles' is marked unstable with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/DynamicWeightedRandomSelectionImpl.java`
#### Snippet
```java
                ArrayList<Long> weightList = selectedNodes.stream().map(weightFunc)
                        .collect(Collectors.toCollection(ArrayList::new));
                ScaleAndIndex median = Quantiles.median();
                medianWeight = (long) median.compute(weightList);
            }
```

### UnstableApiUsage
'median()' is declared in unstable class 'com.google.common.math.Quantiles' marked with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/DynamicWeightedRandomSelectionImpl.java`
#### Snippet
```java
                ArrayList<Long> weightList = selectedNodes.stream().map(weightFunc)
                        .collect(Collectors.toCollection(ArrayList::new));
                ScaleAndIndex median = Quantiles.median();
                medianWeight = (long) median.compute(weightList);
            }
```

### UnstableApiUsage
'compute(java.util.Collection)' is declared in unstable class 'com.google.common.math.Quantiles' marked with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/DynamicWeightedRandomSelectionImpl.java`
#### Snippet
```java
                        .collect(Collectors.toCollection(ArrayList::new));
                ScaleAndIndex median = Quantiles.median();
                medianWeight = (long) median.compute(weightList);
            }

```

### UnstableApiUsage
'acquire()' is declared in unstable class 'com.google.common.util.concurrent.RateLimiter' marked with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandleAdv.java`
#### Snippet
```java
    protected void doAsyncAddEntry(final PendingAddOp op) {
        if (throttler != null) {
            throttler.acquire();
        }

```

### UnstableApiUsage
'acquire()' is declared in unstable class 'com.google.common.util.concurrent.RateLimiter' marked with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java`
#### Snippet
```java
    void sendReadTo(int bookieIndex, BookieId to, LedgerEntryRequest entry) throws InterruptedException {
        if (lh.throttler != null) {
            lh.throttler.acquire();
        }

```

### UnstableApiUsage
'com.google.common.util.concurrent.RateLimiter' is marked unstable with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java

        if (clientCtx.getConf().throttleValue > 0) {
            this.throttler = RateLimiter.create(clientCtx.getConf().throttleValue);
        } else {
            this.throttler = null;
```

### UnstableApiUsage
'create(double)' is declared in unstable class 'com.google.common.util.concurrent.RateLimiter' marked with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java

        if (clientCtx.getConf().throttleValue > 0) {
            this.throttler = RateLimiter.create(clientCtx.getConf().throttleValue);
        } else {
            this.throttler = null;
```

### UnstableApiUsage
'com.google.common.util.concurrent.RateLimiter' is marked unstable with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
    final DigestManager macManager;
    final DistributionSchedule distributionSchedule;
    final RateLimiter throttler;
    final LoadingCache<BookieId, Long> bookieFailureHistory;
    final BookiesHealthInfo bookiesHealthInfo;
```

### UnstableApiUsage
'acquire()' is declared in unstable class 'com.google.common.util.concurrent.RateLimiter' marked with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
    protected void doAsyncAddEntry(final PendingAddOp op) {
        if (throttler != null) {
            throttler.acquire();
        }

```

### UnstableApiUsage
'com.google.common.util.concurrent.RateLimiter' is marked unstable with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/MetadataUpdateLoop.java`
#### Snippet
```java
    private final MetadataTransform transform;
    private final LocalValueUpdater updateLocalValue;
    private final RateLimiter throttler;

    private final String logContext;
```

### UnstableApiUsage
'acquire()' is declared in unstable class 'com.google.common.util.concurrent.RateLimiter' marked with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/MetadataUpdateLoop.java`
#### Snippet
```java
                if (throttler != null) {
                    // throttler to control updates per second
                    throttler.acquire();
                }
                lm.writeLedgerMetadata(ledgerId, transformed, currentLocal.getVersion())
```

### UnstableApiUsage
'com.google.common.util.concurrent.RateLimiter' is marked unstable with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/MetadataUpdateLoop.java`
#### Snippet
```java
            MetadataTransform transform,
            LocalValueUpdater updateLocalValue,
            RateLimiter throttler) {
        this.lm = lm;
        this.ledgerId = ledgerId;
```

### UnstableApiUsage
'acquire(int)' is declared in unstable class 'com.google.common.util.concurrent.RateLimiter' marked with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerFragmentReplicator.java`
#### Snippet
```java
        // acquire. if bybytes: bytes of this entry; if byentries: 1.
        void acquire(int permits) {
            rateLimiter.acquire(permits);
        }
    }
```

### UnstableApiUsage
'getRate()' is declared in unstable class 'com.google.common.util.concurrent.RateLimiter' marked with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerFragmentReplicator.java`
#### Snippet
```java
        // get rate of limiter for unit test
        double getRate() {
            return this.rateLimiter.getRate();
        }

```

### UnstableApiUsage
'com.google.common.util.concurrent.RateLimiter' is marked unstable with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerFragmentReplicator.java`
#### Snippet
```java

        Throttler(int throttleBytes) {
            this.rateLimiter = RateLimiter.create(throttleBytes);
        }

```

### UnstableApiUsage
'create(double)' is declared in unstable class 'com.google.common.util.concurrent.RateLimiter' marked with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerFragmentReplicator.java`
#### Snippet
```java

        Throttler(int throttleBytes) {
            this.rateLimiter = RateLimiter.create(throttleBytes);
        }

```

### UnstableApiUsage
'setRate(double)' is declared in unstable class 'com.google.common.util.concurrent.RateLimiter' marked with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerFragmentReplicator.java`
#### Snippet
```java
        // reset rate of limiter before compact one entry log file
        void resetRate(int throttleBytes) {
            this.rateLimiter.setRate(throttleBytes);
        }

```

### UnstableApiUsage
'com.google.common.util.concurrent.RateLimiter' is marked unstable with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerFragmentReplicator.java`
#### Snippet
```java

    static class Throttler {
        private final RateLimiter rateLimiter;

        Throttler(int throttleBytes) {
```

### UnstableApiUsage
'com.google.common.util.concurrent.RateLimiter' is marked unstable with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/service/ScrubberService.java`
#### Snippet
```java

        double rateLimit = conf.getServerConf().getLocalScrubRateLimit();
        this.scrubRateLimiter = rateLimit == 0 ? Optional.empty() : Optional.of(RateLimiter.create(rateLimit));

        this.ledgerStorage = ledgerStorage;
```

### UnstableApiUsage
'create(double)' is declared in unstable class 'com.google.common.util.concurrent.RateLimiter' marked with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/service/ScrubberService.java`
#### Snippet
```java

        double rateLimit = conf.getServerConf().getLocalScrubRateLimit();
        this.scrubRateLimiter = rateLimit == 0 ? Optional.empty() : Optional.of(RateLimiter.create(rateLimit));

        this.ledgerStorage = ledgerStorage;
```

### UnstableApiUsage
'com.google.common.util.concurrent.RateLimiter' is marked unstable with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/service/ScrubberService.java`
#### Snippet
```java
    private final Random rng = new Random();
    private final long scrubPeriod;
    private final Optional<RateLimiter> scrubRateLimiter;
    private final AtomicBoolean stop = new AtomicBoolean(false);
    private final LedgerStorage ledgerStorage;
```

### UnstableApiUsage
'com.google.common.hash.Hashing' is marked unstable with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/metastore/Value.java`
#### Snippet
```java
    @Override
    public int hashCode() {
        HashFunction hf = Hashing.murmur3_32_fixed();
        Hasher hc = hf.newHasher();
        for (String key : fields.keySet()) {
```

### UnstableApiUsage
'murmur3_32_fixed()' is declared in unstable class 'com.google.common.hash.Hashing' marked with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/metastore/Value.java`
#### Snippet
```java
    @Override
    public int hashCode() {
        HashFunction hf = Hashing.murmur3_32_fixed();
        Hasher hc = hf.newHasher();
        for (String key : fields.keySet()) {
```

### UnstableApiUsage
'com.google.common.hash.Hasher' is marked unstable with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/metastore/Value.java`
#### Snippet
```java
    public int hashCode() {
        HashFunction hf = Hashing.murmur3_32_fixed();
        Hasher hc = hf.newHasher();
        for (String key : fields.keySet()) {
            hc.putString(key, Charset.defaultCharset());
```

### UnstableApiUsage
'newHasher()' is unstable because its signature references unstable interface 'com.google.common.hash.Hasher' marked with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/metastore/Value.java`
#### Snippet
```java
    public int hashCode() {
        HashFunction hf = Hashing.murmur3_32_fixed();
        Hasher hc = hf.newHasher();
        for (String key : fields.keySet()) {
            hc.putString(key, Charset.defaultCharset());
```

### UnstableApiUsage
'putString(java.lang.CharSequence, java.nio.charset.Charset)' is declared in unstable interface 'com.google.common.hash.Hasher' marked with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/metastore/Value.java`
#### Snippet
```java
        Hasher hc = hf.newHasher();
        for (String key : fields.keySet()) {
            hc.putString(key, Charset.defaultCharset());
        }
        return hc.hash().asInt();
```

### UnstableApiUsage
'hash()' is declared in unstable interface 'com.google.common.hash.Hasher' marked with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/metastore/Value.java`
#### Snippet
```java
            hc.putString(key, Charset.defaultCharset());
        }
        return hc.hash().asInt();
    }

```

### UnstableApiUsage
'com.google.common.util.concurrent.RateLimiter' is marked unstable with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/zookeeper/ZooWorker.java`
#### Snippet
```java
                                           ZooCallable<T> proc,
                                           RetryPolicy retryPolicy,
                                           RateLimiter rateLimiter,
                                           OpStatsLogger statsLogger)
    throws KeeperException, InterruptedException {
```

### UnstableApiUsage
'acquire()' is declared in unstable class 'com.google.common.util.concurrent.RateLimiter' marked with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/zookeeper/ZooWorker.java`
#### Snippet
```java
                logger.debug("Execute {} at {} retry attempt.", proc, attempts);
                if (null != rateLimiter) {
                    rateLimiter.acquire();
                }
                result = proc.call();
```

### UnstableApiUsage
'com.google.common.util.concurrent.RateLimiter' is marked unstable with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/zookeeper/ZooKeeperClient.java`
#### Snippet
```java

    // rate limiter
    private final RateLimiter rateLimiter;

    // retry polices
```

### UnstableApiUsage
'com.google.common.util.concurrent.RateLimiter' is marked unstable with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/zookeeper/ZooKeeperClient.java`
#### Snippet
```java
        this.connectRetryPolicy = connectRetryPolicy;
        this.operationRetryPolicy = operationRetryPolicy;
        this.rateLimiter = rate > 0 ? RateLimiter.create(rate) : null;
        this.retryExecutor =
                Executors.newScheduledThreadPool(retryExecThreadCount,
```

### UnstableApiUsage
'create(double)' is declared in unstable class 'com.google.common.util.concurrent.RateLimiter' marked with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/zookeeper/ZooKeeperClient.java`
#### Snippet
```java
        this.connectRetryPolicy = connectRetryPolicy;
        this.operationRetryPolicy = operationRetryPolicy;
        this.rateLimiter = rate > 0 ? RateLimiter.create(rate) : null;
        this.retryExecutor =
                Executors.newScheduledThreadPool(retryExecThreadCount,
```

### UnstableApiUsage
'com.google.common.util.concurrent.RateLimiter' is marked unstable with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/zookeeper/ZooKeeperClient.java`
#### Snippet
```java

        ZkRetryRunnable(RetryPolicy retryPolicy,
                        RateLimiter rateLimiter,
                        OpStatsLogger statsLogger) {
            this.worker = new ZooWorker(retryPolicy, statsLogger);
```

### UnstableApiUsage
'com.google.common.util.concurrent.RateLimiter' is marked unstable with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/zookeeper/ZooKeeperClient.java`
#### Snippet
```java

        final ZooWorker worker;
        final RateLimiter rateLimiter;
        final Runnable that;

```

### UnstableApiUsage
'acquire()' is declared in unstable class 'com.google.common.util.concurrent.RateLimiter' marked with @Beta
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/zookeeper/ZooKeeperClient.java`
#### Snippet
```java
        public void run() {
            if (null != rateLimiter) {
                rateLimiter.acquire();
            }
            zkRun();
```

### UnstableApiUsage
'com.google.common.net.HostAndPort' is marked unstable with @Beta
in `stats/bookkeeper-stats-providers/codahale-metrics-provider/src/main/java/org/apache/bookkeeper/stats/codahale/CodahaleMetricsProvider.java`
#### Snippet
```java
        if (!Strings.isNullOrEmpty(graphiteHost)) {
            LOG.info("Configuring stats with graphite");
            HostAndPort addr = HostAndPort.fromString(graphiteHost);
            final Graphite graphite = new Graphite(
                    new InetSocketAddress(addr.getHost(), addr.getPort()));
```

### UnstableApiUsage
'com.google.common.net.HostAndPort' is marked unstable with @Beta
in `stats/bookkeeper-stats-providers/codahale-metrics-provider/src/main/java/org/apache/bookkeeper/stats/codahale/CodahaleMetricsProvider.java`
#### Snippet
```java
        if (!Strings.isNullOrEmpty(graphiteHost)) {
            LOG.info("Configuring stats with graphite");
            HostAndPort addr = HostAndPort.fromString(graphiteHost);
            final Graphite graphite = new Graphite(
                    new InetSocketAddress(addr.getHost(), addr.getPort()));
```

### UnstableApiUsage
'fromString(java.lang.String)' is declared in unstable class 'com.google.common.net.HostAndPort' marked with @Beta
in `stats/bookkeeper-stats-providers/codahale-metrics-provider/src/main/java/org/apache/bookkeeper/stats/codahale/CodahaleMetricsProvider.java`
#### Snippet
```java
        if (!Strings.isNullOrEmpty(graphiteHost)) {
            LOG.info("Configuring stats with graphite");
            HostAndPort addr = HostAndPort.fromString(graphiteHost);
            final Graphite graphite = new Graphite(
                    new InetSocketAddress(addr.getHost(), addr.getPort()));
```

### UnstableApiUsage
'getHost()' is declared in unstable class 'com.google.common.net.HostAndPort' marked with @Beta
in `stats/bookkeeper-stats-providers/codahale-metrics-provider/src/main/java/org/apache/bookkeeper/stats/codahale/CodahaleMetricsProvider.java`
#### Snippet
```java
            HostAndPort addr = HostAndPort.fromString(graphiteHost);
            final Graphite graphite = new Graphite(
                    new InetSocketAddress(addr.getHost(), addr.getPort()));
            reporters.add(GraphiteReporter.forRegistry(getMetrics())
                          .prefixedWith(prefix)
```

### UnstableApiUsage
'getPort()' is declared in unstable class 'com.google.common.net.HostAndPort' marked with @Beta
in `stats/bookkeeper-stats-providers/codahale-metrics-provider/src/main/java/org/apache/bookkeeper/stats/codahale/CodahaleMetricsProvider.java`
#### Snippet
```java
            HostAndPort addr = HostAndPort.fromString(graphiteHost);
            final Graphite graphite = new Graphite(
                    new InetSocketAddress(addr.getHost(), addr.getPort()));
            reporters.add(GraphiteReporter.forRegistry(getMetrics())
                          .prefixedWith(prefix)
```

### UnstableApiUsage
'com.google.common.util.concurrent.RateLimiter' is marked unstable with @Beta
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/DistributedLogConfiguration.java`
#### Snippet
```java
     * Get zookeeper access rate limit.
     *
     * <p>The rate limiter is basically a guava {@link com.google.common.util.concurrent.RateLimiter}.
     * It is rate limiting the requests that sent by zookeeper client. If the value is non-positive,
     * the rate limiting is disable. By default it is disable (value = 0).
```

### UnstableApiUsage
'com.google.common.util.concurrent.RateLimiter' is marked unstable with @Beta
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/DistributedLogConfiguration.java`
#### Snippet
```java
     * Get zookeeper access rate limit for zookeeper client used in bookkeeper client.
     *
     * <p>The rate limiter is basically a guava {@link com.google.common.util.concurrent.RateLimiter}.
     * It is rate limiting the requests that sent by zookeeper client. If the value is non-positive,
     * the rate limiting is disable. By default it is disable (value = 0).
```

### UnstableApiUsage
'com.google.common.util.concurrent.RateLimiter' is marked unstable with @Beta
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/limiter/GuavaRateLimiter.java`
#### Snippet
```java
            effectiveLimit = Double.POSITIVE_INFINITY;
        }
        this.limiter = com.google.common.util.concurrent.RateLimiter.create(effectiveLimit);
    }

```

### UnstableApiUsage
'create(double)' is declared in unstable class 'com.google.common.util.concurrent.RateLimiter' marked with @Beta
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/limiter/GuavaRateLimiter.java`
#### Snippet
```java
            effectiveLimit = Double.POSITIVE_INFINITY;
        }
        this.limiter = com.google.common.util.concurrent.RateLimiter.create(effectiveLimit);
    }

```

### UnstableApiUsage
'tryAcquire(int)' is declared in unstable class 'com.google.common.util.concurrent.RateLimiter' marked with @Beta
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/limiter/GuavaRateLimiter.java`
#### Snippet
```java
        checkState(permits >= 0);
        if (permits > 0) {
            return limiter.tryAcquire(permits);
        } else {
            return true;
```

### UnstableApiUsage
'com.google.common.util.concurrent.RateLimiter' is marked unstable with @Beta
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/limiter/GuavaRateLimiter.java`
#### Snippet
```java
 */
public class GuavaRateLimiter implements RateLimiter {
    com.google.common.util.concurrent.RateLimiter limiter;

    public static RateLimiter of(int limit) {
```

### UnstableApiUsage
'com.google.common.io.Closeables' is marked unstable with @Beta
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/util/Utils.java`
#### Snippet
```java
        }
        try {
            Closeables.close(closeable, true);
        } catch (IOException e) {
            // no-op. the exception is swallowed.
```

### UnstableApiUsage
'close(java.io.Closeable, boolean)' is declared in unstable class 'com.google.common.io.Closeables' marked with @Beta
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/util/Utils.java`
#### Snippet
```java
        }
        try {
            Closeables.close(closeable, true);
        } catch (IOException e) {
            // no-op. the exception is swallowed.
```

### UnstableApiUsage
'com.google.common.base.Utf8' is marked unstable with @Beta
in `stream/common/src/main/java/org/apache/bookkeeper/common/coder/StringUtf8Coder.java`
#### Snippet
```java
    @Override
    public int getSerializedSize(String value) {
        return Utf8.encodedLength(value);
    }

```

### UnstableApiUsage
'encodedLength(java.lang.CharSequence)' is declared in unstable class 'com.google.common.base.Utf8' marked with @Beta
in `stream/common/src/main/java/org/apache/bookkeeper/common/coder/StringUtf8Coder.java`
#### Snippet
```java
    @Override
    public int getSerializedSize(String value) {
        return Utf8.encodedLength(value);
    }

```

### UnstableApiUsage
'com.google.common.io.MoreFiles' is marked unstable with @Beta
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/CheckpointInfo.java`
#### Snippet
```java
            Path checkpointPath = getCheckpointPath(dbPath);
            if (checkpointPath.toFile().exists()) {
                MoreFiles.deleteRecursively(checkpointPath, RecursiveDeleteOption.ALLOW_INSECURE);
            }
        } catch (IOException ioe) {
```

### UnstableApiUsage
'deleteRecursively(java.nio.file.Path, com.google.common.io.RecursiveDeleteOption...)' is declared in unstable class 'com.google.common.io.MoreFiles' marked with @Beta
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/CheckpointInfo.java`
#### Snippet
```java
            Path checkpointPath = getCheckpointPath(dbPath);
            if (checkpointPath.toFile().exists()) {
                MoreFiles.deleteRecursively(checkpointPath, RecursiveDeleteOption.ALLOW_INSECURE);
            }
        } catch (IOException ioe) {
```

### UnstableApiUsage
'com.google.common.io.RecursiveDeleteOption' is marked unstable with @Beta
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/CheckpointInfo.java`
#### Snippet
```java
            Path checkpointPath = getCheckpointPath(dbPath);
            if (checkpointPath.toFile().exists()) {
                MoreFiles.deleteRecursively(checkpointPath, RecursiveDeleteOption.ALLOW_INSECURE);
            }
        } catch (IOException ioe) {
```

### UnstableApiUsage
'ALLOW_INSECURE' is declared in unstable enum 'com.google.common.io.RecursiveDeleteOption' marked with @Beta
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/CheckpointInfo.java`
#### Snippet
```java
            Path checkpointPath = getCheckpointPath(dbPath);
            if (checkpointPath.toFile().exists()) {
                MoreFiles.deleteRecursively(checkpointPath, RecursiveDeleteOption.ALLOW_INSECURE);
            }
        } catch (IOException ioe) {
```

### UnstableApiUsage
'copy(java.io.File, java.io.OutputStream)' is marked unstable with @Beta
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/CheckpointFile.java`
#### Snippet
```java
        String destPath = RocksUtils.getDestPath(dbPrefix, checkpointId, getName());
        try (OutputStream os = checkpointStore.openOutputStream(destPath)) {
            Files.copy(file, os);
        }
    }
```

### UnstableApiUsage
'com.google.common.io.CountingInputStream' is marked unstable with @Beta
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/CheckpointFile.java`
#### Snippet
```java
                               Duration idleWait) throws IOException, TimeoutException {
        String remoteFilePath = getRemotePath(dbPrefix, checkpointId, true);
        CountingInputStream cis = new CountingInputStream(
            checkpointStore.openInputStream(remoteFilePath)
        );
```

### UnstableApiUsage
'CountingInputStream(java.io.InputStream)' is declared in unstable class 'com.google.common.io.CountingInputStream' marked with @Beta
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/CheckpointFile.java`
#### Snippet
```java
                               Duration idleWait) throws IOException, TimeoutException {
        String remoteFilePath = getRemotePath(dbPrefix, checkpointId, true);
        CountingInputStream cis = new CountingInputStream(
            checkpointStore.openInputStream(remoteFilePath)
        );
```

### UnstableApiUsage
'com.google.common.io.CountingInputStream' is marked unstable with @Beta
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/CheckpointFile.java`
#### Snippet
```java
                               Duration idleWait) throws IOException, TimeoutException {
        String remoteFilePath = getRemotePath(dbPrefix, checkpointId, true);
        CountingInputStream cis = new CountingInputStream(
            checkpointStore.openInputStream(remoteFilePath)
        );
```

### UnstableApiUsage
'getCount()' is declared in unstable class 'com.google.common.io.CountingInputStream' marked with @Beta
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/CheckpointFile.java`
#### Snippet
```java

        while (!copyFuture.isDone()) {
            long lastCount = cis.getCount();
            try {
                // Wait of at most `idleWait` time for this to finish. If it is not done, we will get a
```

### UnstableApiUsage
'getCount()' is declared in unstable class 'com.google.common.io.CountingInputStream' marked with @Beta
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/CheckpointFile.java`
#### Snippet
```java
                // Check if we made any progress
                long endMs = System.currentTimeMillis();
                long newCount = cis.getCount();
                log.info("Timeout waiting for copy: {} last-read {} current-read {} runtime(ms) {} ",
                    remoteFilePath, lastCount, newCount, endMs - startMs);
```

### UnstableApiUsage
'com.google.common.hash.Hashing' is marked unstable with @Beta
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/CheckpointFile.java`
#### Snippet
```java
            String ckSum = "invalid-" + System.currentTimeMillis();
            try {
                ckSum = Files.asByteSource(file).hash(Hashing.sha256()).toString();
                return ckSum;
            } catch (IOException e) {
```

### UnstableApiUsage
'sha256()' is declared in unstable class 'com.google.common.hash.Hashing' marked with @Beta
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/CheckpointFile.java`
#### Snippet
```java
            String ckSum = "invalid-" + System.currentTimeMillis();
            try {
                ckSum = Files.asByteSource(file).hash(Hashing.sha256()).toString();
                return ckSum;
            } catch (IOException e) {
```

### UnstableApiUsage
'copy(java.io.File, java.io.OutputStream)' is marked unstable with @Beta
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/CheckpointFile.java`
#### Snippet
```java

        try (OutputStream os = checkpointStore.openOutputStream(destPath)) {
            Files.copy(file, os);
        }
    }
```

### UnstableApiUsage
'com.google.common.io.MoreFiles' is marked unstable with @Beta
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/RocksCheckpointer.java`
#### Snippet
```java
            }
            try {
                MoreFiles.deleteRecursively(
                    Paths.get(checkpointsDir.getAbsolutePath(), checkpoint),
                    RecursiveDeleteOption.ALLOW_INSECURE);
```

### UnstableApiUsage
'deleteRecursively(java.nio.file.Path, com.google.common.io.RecursiveDeleteOption...)' is declared in unstable class 'com.google.common.io.MoreFiles' marked with @Beta
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/RocksCheckpointer.java`
#### Snippet
```java
            }
            try {
                MoreFiles.deleteRecursively(
                    Paths.get(checkpointsDir.getAbsolutePath(), checkpoint),
                    RecursiveDeleteOption.ALLOW_INSECURE);
```

### UnstableApiUsage
'com.google.common.io.RecursiveDeleteOption' is marked unstable with @Beta
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/RocksCheckpointer.java`
#### Snippet
```java
                MoreFiles.deleteRecursively(
                    Paths.get(checkpointsDir.getAbsolutePath(), checkpoint),
                    RecursiveDeleteOption.ALLOW_INSECURE);
            } catch (IOException ioe) {
                log.warn("Failed to remove unused checkpoint {} from {}",
```

### UnstableApiUsage
'ALLOW_INSECURE' is declared in unstable enum 'com.google.common.io.RecursiveDeleteOption' marked with @Beta
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/RocksCheckpointer.java`
#### Snippet
```java
                MoreFiles.deleteRecursively(
                    Paths.get(checkpointsDir.getAbsolutePath(), checkpoint),
                    RecursiveDeleteOption.ALLOW_INSECURE);
            } catch (IOException ioe) {
                log.warn("Failed to remove unused checkpoint {} from {}",
```

### UnstableApiUsage
'com.google.common.io.MoreFiles' is marked unstable with @Beta
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/fs/FSCheckpointManager.java`
#### Snippet
```java
    @Override
    public void deleteRecursively(String srcPath) throws IOException {
        MoreFiles.deleteRecursively(
            Paths.get(getFullyQualifiedPath(srcPath).getAbsolutePath()),
            RecursiveDeleteOption.ALLOW_INSECURE);
```

### UnstableApiUsage
'deleteRecursively(java.nio.file.Path, com.google.common.io.RecursiveDeleteOption...)' is declared in unstable class 'com.google.common.io.MoreFiles' marked with @Beta
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/fs/FSCheckpointManager.java`
#### Snippet
```java
    @Override
    public void deleteRecursively(String srcPath) throws IOException {
        MoreFiles.deleteRecursively(
            Paths.get(getFullyQualifiedPath(srcPath).getAbsolutePath()),
            RecursiveDeleteOption.ALLOW_INSECURE);
```

### UnstableApiUsage
'com.google.common.io.RecursiveDeleteOption' is marked unstable with @Beta
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/fs/FSCheckpointManager.java`
#### Snippet
```java
        MoreFiles.deleteRecursively(
            Paths.get(getFullyQualifiedPath(srcPath).getAbsolutePath()),
            RecursiveDeleteOption.ALLOW_INSECURE);
    }

```

### UnstableApiUsage
'ALLOW_INSECURE' is declared in unstable enum 'com.google.common.io.RecursiveDeleteOption' marked with @Beta
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/fs/FSCheckpointManager.java`
#### Snippet
```java
        MoreFiles.deleteRecursively(
            Paths.get(getFullyQualifiedPath(srcPath).getAbsolutePath()),
            RecursiveDeleteOption.ALLOW_INSECURE);
    }

```

### UnstableApiUsage
'com.google.common.io.MoreFiles' is marked unstable with @Beta
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
            if (dbDir.exists()) {
                try {
                    MoreFiles.deleteRecursively(dbDir.toPath(), RecursiveDeleteOption.ALLOW_INSECURE);
                } catch (IOException e) {
                    log.error("Failed to cleanup localStoreDir", e);
```

### UnstableApiUsage
'deleteRecursively(java.nio.file.Path, com.google.common.io.RecursiveDeleteOption...)' is declared in unstable class 'com.google.common.io.MoreFiles' marked with @Beta
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
            if (dbDir.exists()) {
                try {
                    MoreFiles.deleteRecursively(dbDir.toPath(), RecursiveDeleteOption.ALLOW_INSECURE);
                } catch (IOException e) {
                    log.error("Failed to cleanup localStoreDir", e);
```

### UnstableApiUsage
'com.google.common.io.RecursiveDeleteOption' is marked unstable with @Beta
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
            if (dbDir.exists()) {
                try {
                    MoreFiles.deleteRecursively(dbDir.toPath(), RecursiveDeleteOption.ALLOW_INSECURE);
                } catch (IOException e) {
                    log.error("Failed to cleanup localStoreDir", e);
```

### UnstableApiUsage
'ALLOW_INSECURE' is declared in unstable enum 'com.google.common.io.RecursiveDeleteOption' marked with @Beta
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
            if (dbDir.exists()) {
                try {
                    MoreFiles.deleteRecursively(dbDir.toPath(), RecursiveDeleteOption.ALLOW_INSECURE);
                } catch (IOException e) {
                    log.error("Failed to cleanup localStoreDir", e);
```

### UnstableApiUsage
'com.google.common.io.MoreFiles' is marked unstable with @Beta
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/RocksdbCheckpointTask.java`
#### Snippet
```java
            if (removeLocalCheckpointAfterSuccessfulCheckpoint && tempDir.exists()) {
                try {
                    MoreFiles.deleteRecursively(
                        Paths.get(tempDir.getAbsolutePath()),
                        RecursiveDeleteOption.ALLOW_INSECURE);
```

### UnstableApiUsage
'deleteRecursively(java.nio.file.Path, com.google.common.io.RecursiveDeleteOption...)' is declared in unstable class 'com.google.common.io.MoreFiles' marked with @Beta
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/RocksdbCheckpointTask.java`
#### Snippet
```java
            if (removeLocalCheckpointAfterSuccessfulCheckpoint && tempDir.exists()) {
                try {
                    MoreFiles.deleteRecursively(
                        Paths.get(tempDir.getAbsolutePath()),
                        RecursiveDeleteOption.ALLOW_INSECURE);
```

### UnstableApiUsage
'com.google.common.io.RecursiveDeleteOption' is marked unstable with @Beta
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/RocksdbCheckpointTask.java`
#### Snippet
```java
                    MoreFiles.deleteRecursively(
                        Paths.get(tempDir.getAbsolutePath()),
                        RecursiveDeleteOption.ALLOW_INSECURE);
                } catch (IOException ioe) {
                    log.warn("Failed to remove temporary checkpoint dir {}", tempDir, ioe);
```

### UnstableApiUsage
'ALLOW_INSECURE' is declared in unstable enum 'com.google.common.io.RecursiveDeleteOption' marked with @Beta
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/RocksdbCheckpointTask.java`
#### Snippet
```java
                    MoreFiles.deleteRecursively(
                        Paths.get(tempDir.getAbsolutePath()),
                        RecursiveDeleteOption.ALLOW_INSECURE);
                } catch (IOException ioe) {
                    log.warn("Failed to remove temporary checkpoint dir {}", tempDir, ioe);
```

### UnstableApiUsage
'com.google.common.util.concurrent.ListenableScheduledFuture' is marked unstable with @Beta
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/BoundedScheduledExecutorService.java`
#### Snippet
```java

    @Override
    public ListenableScheduledFuture<?> scheduleWithFixedDelay(Runnable command,
                                                               long initialDelay, long delay, TimeUnit unit) {
        this.checkQueue(1);
```

### UnstableApiUsage
'scheduleAtFixedRate(java.lang.Runnable, long, long, java.util.concurrent.TimeUnit)' is unstable because its signature references unstable interface 'com.google.common.util.concurrent.ListenableScheduledFuture' marked with @Beta
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/BoundedScheduledExecutorService.java`
#### Snippet
```java
                                                               long initialDelay, long delay, TimeUnit unit) {
        this.checkQueue(1);
        return this.thread.scheduleAtFixedRate(command, initialDelay, delay, unit);
    }

```

### UnstableApiUsage
'com.google.common.util.concurrent.ListenableScheduledFuture' is marked unstable with @Beta
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/BoundedScheduledExecutorService.java`
#### Snippet
```java

    @Override
    public <V> ListenableScheduledFuture<V> schedule(Callable<V> callable, long delay, TimeUnit unit) {
        this.checkQueue(1);
        return this.thread.schedule(callable, delay, unit);
```

### UnstableApiUsage
'schedule(java.util.concurrent.Callable, long, java.util.concurrent.TimeUnit)' is unstable because its signature references unstable interface 'com.google.common.util.concurrent.ListenableScheduledFuture' marked with @Beta
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/BoundedScheduledExecutorService.java`
#### Snippet
```java
    public <V> ListenableScheduledFuture<V> schedule(Callable<V> callable, long delay, TimeUnit unit) {
        this.checkQueue(1);
        return this.thread.schedule(callable, delay, unit);
    }

```

### UnstableApiUsage
'com.google.common.util.concurrent.ListenableScheduledFuture' is marked unstable with @Beta
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/BoundedScheduledExecutorService.java`
#### Snippet
```java

    @Override
    public ListenableScheduledFuture<?> schedule(Runnable command, long delay, TimeUnit unit) {
        this.checkQueue(1);
        return this.thread.schedule(command, delay, unit);
```

### UnstableApiUsage
'schedule(java.lang.Runnable, long, java.util.concurrent.TimeUnit)' is unstable because its signature references unstable interface 'com.google.common.util.concurrent.ListenableScheduledFuture' marked with @Beta
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/BoundedScheduledExecutorService.java`
#### Snippet
```java
    public ListenableScheduledFuture<?> schedule(Runnable command, long delay, TimeUnit unit) {
        this.checkQueue(1);
        return this.thread.schedule(command, delay, unit);
    }

```

### UnstableApiUsage
'com.google.common.util.concurrent.ListenableScheduledFuture' is marked unstable with @Beta
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/BoundedScheduledExecutorService.java`
#### Snippet
```java

    @Override
    public ListenableScheduledFuture<?> scheduleAtFixedRate(Runnable command,
                                                            long initialDelay, long period, TimeUnit unit) {
        this.checkQueue(1);
```

### UnstableApiUsage
'scheduleAtFixedRate(java.lang.Runnable, long, long, java.util.concurrent.TimeUnit)' is unstable because its signature references unstable interface 'com.google.common.util.concurrent.ListenableScheduledFuture' marked with @Beta
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/BoundedScheduledExecutorService.java`
#### Snippet
```java
                                                            long initialDelay, long period, TimeUnit unit) {
        this.checkQueue(1);
        return this.thread.scheduleAtFixedRate(command, initialDelay, period, unit);
    }

```

### UnstableApiUsage
'platformThreadFactory()' is marked unstable with @Beta
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/ExecutorUtils.java`
#### Snippet
```java
     */
    public static ThreadFactory getThreadFactory(String nameFormat, boolean daemon) {
        ThreadFactory threadFactory = MoreExecutors.platformThreadFactory();
        return new ThreadFactoryBuilder()
            .setThreadFactory(threadFactory)
```

### UnstableApiUsage
'scheduleWithFixedDelay(java.lang.Runnable, long, long, java.util.concurrent.TimeUnit)' is unstable because its signature references unstable interface 'com.google.common.util.concurrent.ListenableScheduledFuture' marked with @Beta
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/OrderedScheduler.java`
#### Snippet
```java
    public ScheduledFuture<?> scheduleWithFixedDelayOrdered(Object orderingKey, Runnable command, long initialDelay,
            long delay, TimeUnit unit) {
        return chooseThread(orderingKey).scheduleWithFixedDelay(command, initialDelay, delay, unit);
    }

```

### UnstableApiUsage
'com.google.common.util.concurrent.ListenableScheduledFuture' is marked unstable with @Beta
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/OrderedScheduler.java`
#### Snippet
```java

            @Override
            public ListenableScheduledFuture<?> schedule(Runnable command, long delay, TimeUnit unit) {
                return delegate.schedule(timedRunnable(command), delay, unit);
            }
```

### UnstableApiUsage
'schedule(java.lang.Runnable, long, java.util.concurrent.TimeUnit)' is unstable because its signature references unstable interface 'com.google.common.util.concurrent.ListenableScheduledFuture' marked with @Beta
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/OrderedScheduler.java`
#### Snippet
```java
            @Override
            public ListenableScheduledFuture<?> schedule(Runnable command, long delay, TimeUnit unit) {
                return delegate.schedule(timedRunnable(command), delay, unit);
            }

```

### UnstableApiUsage
'schedule(java.util.concurrent.Callable, long, java.util.concurrent.TimeUnit)' is unstable because its signature references unstable interface 'com.google.common.util.concurrent.ListenableScheduledFuture' marked with @Beta
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/OrderedScheduler.java`
#### Snippet
```java
    @Override
    public <V> ScheduledFuture<V> schedule(Callable<V> callable, long delay, TimeUnit unit) {
        return chooseThread().schedule(callable, delay, unit);
    }

```

### UnstableApiUsage
'schedule(java.lang.Runnable, long, java.util.concurrent.TimeUnit)' is unstable because its signature references unstable interface 'com.google.common.util.concurrent.ListenableScheduledFuture' marked with @Beta
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/OrderedScheduler.java`
#### Snippet
```java
     */
    public ScheduledFuture<?> scheduleOrdered(Object orderingKey, Runnable command, long delay, TimeUnit unit) {
        return chooseThread(orderingKey).schedule(command, delay, unit);
    }

```

### UnstableApiUsage
'com.google.common.util.concurrent.ListenableScheduledFuture' is marked unstable with @Beta
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/OrderedScheduler.java`
#### Snippet
```java

            @Override
            public <V> ListenableScheduledFuture<V> schedule(Callable<V> callable, long delay, TimeUnit unit) {
                return delegate.schedule(timedCallable(callable), delay, unit);
            }
```

### UnstableApiUsage
'schedule(java.util.concurrent.Callable, long, java.util.concurrent.TimeUnit)' is unstable because its signature references unstable interface 'com.google.common.util.concurrent.ListenableScheduledFuture' marked with @Beta
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/OrderedScheduler.java`
#### Snippet
```java
            @Override
            public <V> ListenableScheduledFuture<V> schedule(Callable<V> callable, long delay, TimeUnit unit) {
                return delegate.schedule(timedCallable(callable), delay, unit);
            }

```

### UnstableApiUsage
'scheduleWithFixedDelay(java.lang.Runnable, long, long, java.util.concurrent.TimeUnit)' is unstable because its signature references unstable interface 'com.google.common.util.concurrent.ListenableScheduledFuture' marked with @Beta
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/OrderedScheduler.java`
#### Snippet
```java
    public ScheduledFuture<?> scheduleWithFixedDelay(Runnable command,
                                                     long initialDelay, long delay, TimeUnit unit) {
        return chooseThread().scheduleWithFixedDelay(command, initialDelay, delay, unit);
    }

```

### UnstableApiUsage
'scheduleAtFixedRate(java.lang.Runnable, long, long, java.util.concurrent.TimeUnit)' is unstable because its signature references unstable interface 'com.google.common.util.concurrent.ListenableScheduledFuture' marked with @Beta
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/OrderedScheduler.java`
#### Snippet
```java
    public ScheduledFuture<?> scheduleAtFixedRateOrdered(Object orderingKey, Runnable command, long initialDelay,
            long period, TimeUnit unit) {
        return chooseThread(orderingKey).scheduleAtFixedRate(command, initialDelay, period, unit);
    }

```

### UnstableApiUsage
'scheduleAtFixedRate(java.lang.Runnable, long, long, java.util.concurrent.TimeUnit)' is unstable because its signature references unstable interface 'com.google.common.util.concurrent.ListenableScheduledFuture' marked with @Beta
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/OrderedScheduler.java`
#### Snippet
```java
    public ScheduledFuture<?> scheduleAtFixedRate(Runnable command,
                                                  long initialDelay, long period, TimeUnit unit) {
        return chooseThread().scheduleAtFixedRate(command, initialDelay, period, unit);
    }

```

### UnstableApiUsage
'com.google.common.util.concurrent.ListenableScheduledFuture' is marked unstable with @Beta
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/OrderedScheduler.java`
#### Snippet
```java

            @Override
            public ListenableScheduledFuture<?> scheduleWithFixedDelay(Runnable command,
                                                                       long initialDelay, long delay, TimeUnit unit) {
                return delegate.scheduleAtFixedRate(timedRunnable(command), initialDelay, delay, unit);
```

### UnstableApiUsage
'scheduleAtFixedRate(java.lang.Runnable, long, long, java.util.concurrent.TimeUnit)' is unstable because its signature references unstable interface 'com.google.common.util.concurrent.ListenableScheduledFuture' marked with @Beta
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/OrderedScheduler.java`
#### Snippet
```java
            public ListenableScheduledFuture<?> scheduleWithFixedDelay(Runnable command,
                                                                       long initialDelay, long delay, TimeUnit unit) {
                return delegate.scheduleAtFixedRate(timedRunnable(command), initialDelay, delay, unit);
            }

```

### UnstableApiUsage
'com.google.common.util.concurrent.ListenableScheduledFuture' is marked unstable with @Beta
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/OrderedScheduler.java`
#### Snippet
```java

            @Override
            public ListenableScheduledFuture<?> scheduleAtFixedRate(Runnable command,
                                                                    long initialDelay, long period, TimeUnit unit) {
                return delegate.scheduleAtFixedRate(timedRunnable(command), initialDelay, period, unit);
```

### UnstableApiUsage
'scheduleAtFixedRate(java.lang.Runnable, long, long, java.util.concurrent.TimeUnit)' is unstable because its signature references unstable interface 'com.google.common.util.concurrent.ListenableScheduledFuture' marked with @Beta
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/OrderedScheduler.java`
#### Snippet
```java
            public ListenableScheduledFuture<?> scheduleAtFixedRate(Runnable command,
                                                                    long initialDelay, long period, TimeUnit unit) {
                return delegate.scheduleAtFixedRate(timedRunnable(command), initialDelay, period, unit);
            }

```

### UnstableApiUsage
'schedule(java.lang.Runnable, long, java.util.concurrent.TimeUnit)' is unstable because its signature references unstable interface 'com.google.common.util.concurrent.ListenableScheduledFuture' marked with @Beta
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/OrderedScheduler.java`
#### Snippet
```java
    @Override
    public ScheduledFuture<?> schedule(Runnable command, long delay, TimeUnit unit) {
        return chooseThread().schedule(command, delay, unit);
    }

```

## RuleId[id=EnumSwitchStatementWhichMissesCases]
### EnumSwitchStatementWhichMissesCases
`switch (event.getType()) { case None: switch (event.getS...` statement on enum type 'org.apache.zookeeper.Watcher.Event.EventType' misses cases: 'NodeCreated', 'NodeDeleted', ...
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/ZooKeeperClient.java`
#### Snippet
```java
            @Override
            public void process(WatchedEvent event) {
                switch (event.getType()) {
                    case None:
                        switch (event.getState()) {
                            case Expired:
                                if (null == retryPolicy) {
                                    LOG.info("ZooKeeper {}' session expired. Event: {}", name, event);
                                    closeInternal();
                                }
                                authenticated = false;
                                break;
                            case Disconnected:
                                if (null == retryPolicy) {
                                    LOG.info("ZooKeeper {} is disconnected from zookeeper now,"
                                            + " but it is OK unless we received EXPIRED event.", name);
                                }
                                // Mark as not authenticated if expired or disconnected. In both cases
                                // we lose any attached auth info. Relying on Expired/Disconnected is
                                // sufficient since all Expired/Disconnected events are processed before
                                // all SyncConnected events, and the underlying member is not updated until
                                // SyncConnected is received.
                                authenticated = false;
                                break;
                            default:
                                break;
                        }
                }

                try {
```

## RuleId[id=StringEquality]
### StringEquality
String values are compared using `==`, not 'equals()'
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/cluster/ZkClusterInitializer.java`
#### Snippet
```java
                    String ledgersPath = metadataServiceUri.getPath();
                    Optional<String> segmentStorePath;
                    if (Strings.isNullOrEmpty(ledgersPath) || "/" == ledgersPath) {
                        segmentStorePath = Optional.empty();
                    } else {
```

### StringEquality
String values are compared using `==`, not 'equals()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/metastore/InMemoryMetastoreTable.java`
#### Snippet
```java
        if (Order.ASC == order) {
            myMap = map;
            if (EMPTY_END_KEY == lastKey || lastKey.compareTo(myMap.lastKey()) > 0) {
                lastKey = myMap.lastKey();
                lastInclusive = true;
```

### StringEquality
String values are compared using `==`, not 'equals()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/metastore/InMemoryMetastoreTable.java`
#### Snippet
```java
                lastInclusive = true;
            }
            if (EMPTY_START_KEY == firstKey || firstKey.compareTo(myMap.firstKey()) < 0) {
                firstKey = myMap.firstKey();
                firstInclusive = true;
```

### StringEquality
String values are compared using `==`, not 'equals()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/metastore/InMemoryMetastoreTable.java`
#### Snippet
```java
        } else if (Order.DESC == order) {
            myMap = map.descendingMap();
            if (EMPTY_START_KEY == lastKey || lastKey.compareTo(myMap.lastKey()) < 0) {
                lastKey = myMap.lastKey();
                lastInclusive = true;
```

### StringEquality
String values are compared using `==`, not 'equals()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/metastore/InMemoryMetastoreTable.java`
#### Snippet
```java
                lastInclusive = true;
            }
            if (EMPTY_END_KEY == firstKey || firstKey.compareTo(myMap.firstKey()) > 0) {
                firstKey = myMap.firstKey();
                firstInclusive = true;
```

## RuleId[id=ConditionalBreakInInfiniteLoop]
### ConditionalBreakInInfiniteLoop
Conditional break inside loop
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/DefaultEntryLogger.java`
#### Snippet
```java

            // Read through the entry log file and extract the ledger ID's.
            while (true) {
                // Check if we've finished reading the entry log file.
                if (pos >= bc.size()) {
```

## RuleId[id=StaticCallOnSubclass]
### StaticCallOnSubclass
Static method `ofHash()` declared in class 'org.apache.bookkeeper.clients.impl.internal.api.StreamRanges' but referenced via subclass 'org.apache.bookkeeper.clients.impl.internal.api.HashStreamRanges'
in `stream/clients/java/base/src/main/java/org/apache/bookkeeper/clients/impl/internal/ProtocolInternalUtils.java`
#### Snippet
```java
            ranges.size() > 0,
            "No active range found");
        return HashStreamRanges.ofHash(
            RangeKeyType.HASH,
            ranges);
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/GetBookieInfoProcessorV3.java`
#### Snippet
```java

    private GetBookieInfoResponse getGetBookieInfoResponse() {
        long startTimeNanos = MathUtils.nowInNano();
        GetBookieInfoRequest getBookieInfoRequest = request.getGetBookieInfoRequest();
        long requested = getBookieInfoRequest.getRequested();
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/GetBookieInfoProcessorV3.java`
#### Snippet
```java
            getBookieInfoResponse.setStatus(StatusCode.EBADVERSION);
            requestProcessor.getRequestStats().getGetBookieInfoStats()
                .registerFailedEvent(MathUtils.elapsedNanos(startTimeNanos), TimeUnit.NANOSECONDS);
            return getBookieInfoResponse.build();
        }
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/GetBookieInfoProcessorV3.java`
#### Snippet
```java
            }
            requestProcessor.getRequestStats().getGetBookieInfoStats()
                    .registerSuccessfulEvent(MathUtils.elapsedNanos(startTimeNanos), TimeUnit.NANOSECONDS);
        } catch (IOException e) {
            status = StatusCode.EIO;
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/GetBookieInfoProcessorV3.java`
#### Snippet
```java
            LOG.error("IOException while getting  freespace/totalspace", e);
            requestProcessor.getRequestStats().getGetBookieInfoStats()
                    .registerFailedEvent(MathUtils.elapsedNanos(startTimeNanos), TimeUnit.NANOSECONDS);
        }

```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/ReadLacProcessorV3.java`
#### Snippet
```java
    // Returns null if there is no exception thrown
    private ReadLacResponse getReadLacResponse() {
        final long startTimeNanos = MathUtils.nowInNano();
        ReadLacRequest readLacRequest = request.getReadLacRequest();
        long ledgerId = readLacRequest.getLedgerId();
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/ReadLacProcessorV3.java`
#### Snippet
```java
        if (status == StatusCode.EOK) {
            requestProcessor.getRequestStats().getReadLacStats()
                .registerSuccessfulEvent(MathUtils.elapsedNanos(startTimeNanos), TimeUnit.NANOSECONDS);
        } else {
            requestProcessor.getRequestStats().getReadLacStats()
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/ReadLacProcessorV3.java`
#### Snippet
```java
        } else {
            requestProcessor.getRequestStats().getReadLacStats()
                .registerFailedEvent(MathUtils.elapsedNanos(startTimeNanos), TimeUnit.NANOSECONDS);
        }
        // Finally set the status and return
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/GetListOfEntriesOfLedgerProcessorV3.java`
#### Snippet
```java

    private GetListOfEntriesOfLedgerResponse getListOfEntriesOfLedgerResponse() {
        long startTimeNanos = MathUtils.nowInNano();

        GetListOfEntriesOfLedgerResponse.Builder getListOfEntriesOfLedgerResponse = GetListOfEntriesOfLedgerResponse
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/GetListOfEntriesOfLedgerProcessorV3.java`
#### Snippet
```java
            getListOfEntriesOfLedgerResponse.setStatus(StatusCode.EBADVERSION);
            requestProcessor.getRequestStats().getGetListOfEntriesOfLedgerStats()
                    .registerFailedEvent(MathUtils.elapsedNanos(startTimeNanos), TimeUnit.NANOSECONDS);
            return getListOfEntriesOfLedgerResponse.build();
        }
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/GetListOfEntriesOfLedgerProcessorV3.java`
#### Snippet
```java
        if (status == StatusCode.EOK) {
            requestProcessor.getRequestStats().getListOfEntriesOfLedgerStats
                    .registerSuccessfulEvent(MathUtils.elapsedNanos(startTimeNanos), TimeUnit.NANOSECONDS);
        } else {
            requestProcessor.getRequestStats().getListOfEntriesOfLedgerStats
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/GetListOfEntriesOfLedgerProcessorV3.java`
#### Snippet
```java
        } else {
            requestProcessor.getRequestStats().getListOfEntriesOfLedgerStats
                    .registerFailedEvent(MathUtils.elapsedNanos(startTimeNanos), TimeUnit.NANOSECONDS);
        }
        // Finally set the status and return
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/WriteLacProcessorV3.java`
#### Snippet
```java
    // Returns null if there is no exception thrown
    private WriteLacResponse getWriteLacResponse() {
        final long startTimeNanos = MathUtils.nowInNano();
        WriteLacRequest writeLacRequest = request.getWriteLacRequest();
        long lac = writeLacRequest.getLac();
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/WriteLacProcessorV3.java`
#### Snippet
```java
        if (!status.equals(StatusCode.EOK)) {
            requestProcessor.getRequestStats().getWriteLacStats()
                .registerFailedEvent(MathUtils.elapsedNanos(startTimeNanos), TimeUnit.NANOSECONDS);
            writeLacResponse.setStatus(status);
            return writeLacResponse.build();
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/WriteLacProcessorV3.java`
#### Snippet
```java
                if (BookieProtocol.EOK == rc) {
                    requestProcessor.getRequestStats().getWriteLacStats()
                        .registerSuccessfulEvent(MathUtils.elapsedNanos(startTimeNanos), TimeUnit.NANOSECONDS);
                } else {
                    requestProcessor.getRequestStats().getWriteLacStats()
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/WriteLacProcessorV3.java`
#### Snippet
```java
                } else {
                    requestProcessor.getRequestStats().getWriteLacStats()
                        .registerFailedEvent(MathUtils.elapsedNanos(startTimeNanos), TimeUnit.NANOSECONDS);
                }

```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PacketProcessorBaseV3.java`
#### Snippet
```java
        this.requestHandler = requestHandler;
        this.requestProcessor = requestProcessor;
        this.enqueueNanos = MathUtils.nowInNano();
    }

```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PacketProcessorBaseV3.java`
#### Snippet
```java

    protected void sendResponse(StatusCode code, Object response, OpStatsLogger statsLogger) {
        final long writeNanos = MathUtils.nowInNano();

        Channel channel = requestHandler.ctx().channel();
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PacketProcessorBaseV3.java`
#### Snippet
```java
                    if (!channel.isWritable() && !requestProcessor.isBlacklisted(channel)) {
                        final long waitUntilNanos = writeNanos + TimeUnit.MILLISECONDS.toNanos(timeOut);
                        while (!channel.isWritable() && MathUtils.nowInNano() < waitUntilNanos) {
                            try {
                                TimeUnit.MILLISECONDS.sleep(1);
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PacketProcessorBaseV3.java`
#### Snippet
```java
                        StringUtils.requestToString(request));
                requestProcessor.getRequestStats().getChannelWriteStats()
                        .registerFailedEvent(MathUtils.elapsedNanos(writeNanos), TimeUnit.NANOSECONDS);
                statsLogger.registerFailedEvent(MathUtils.elapsedNanos(enqueueNanos), TimeUnit.NANOSECONDS);
                return;
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PacketProcessorBaseV3.java`
#### Snippet
```java
                requestProcessor.getRequestStats().getChannelWriteStats()
                        .registerFailedEvent(MathUtils.elapsedNanos(writeNanos), TimeUnit.NANOSECONDS);
                statsLogger.registerFailedEvent(MathUtils.elapsedNanos(enqueueNanos), TimeUnit.NANOSECONDS);
                return;
            } else {
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PacketProcessorBaseV3.java`
#### Snippet
```java
                @Override
                public void operationComplete(ChannelFuture future) throws Exception {
                    long writeElapsedNanos = MathUtils.elapsedNanos(writeNanos);
                    if (!future.isSuccess()) {
                        requestProcessor.getRequestStats().getChannelWriteStats()
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PacketProcessorBaseV3.java`
#### Snippet
```java
                    }
                    if (StatusCode.EOK == code) {
                        statsLogger.registerSuccessfulEvent(MathUtils.elapsedNanos(enqueueNanos), TimeUnit.NANOSECONDS);
                    } else {
                        statsLogger.registerFailedEvent(MathUtils.elapsedNanos(enqueueNanos), TimeUnit.NANOSECONDS);
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PacketProcessorBaseV3.java`
#### Snippet
```java
                        statsLogger.registerSuccessfulEvent(MathUtils.elapsedNanos(enqueueNanos), TimeUnit.NANOSECONDS);
                    } else {
                        statsLogger.registerFailedEvent(MathUtils.elapsedNanos(enqueueNanos), TimeUnit.NANOSECONDS);
                    }
                }
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookkeeperInternalCallbacks.java`
#### Snippet
```java
        public void operationComplete(int rc, T result) {
            if (successRc == rc) {
                statsLogger.registerSuccessfulEvent(MathUtils.elapsedNanos(startTime), TimeUnit.NANOSECONDS);
            } else {
                statsLogger.registerFailedEvent(MathUtils.elapsedNanos(startTime), TimeUnit.NANOSECONDS);
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookkeeperInternalCallbacks.java`
#### Snippet
```java
                statsLogger.registerSuccessfulEvent(MathUtils.elapsedNanos(startTime), TimeUnit.NANOSECONDS);
            } else {
                statsLogger.registerFailedEvent(MathUtils.elapsedNanos(startTime), TimeUnit.NANOSECONDS);
            }
            cb.operationComplete(rc, result);
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookkeeperInternalCallbacks.java`
#### Snippet
```java
            this.successRc = successRc;
            this.statsLogger = statsLogger;
            this.startTime = MathUtils.nowInNano();
        }

```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/ForceLedgerProcessorV3.java`
#### Snippet
```java
    // Returns null if there is no exception thrown
    private ForceLedgerResponse getForceLedgerResponse() {
        final long startTimeNanos = MathUtils.nowInNano();
        ForceLedgerRequest forceLedgerRequest = request.getForceLedgerRequest();
        long ledgerId = forceLedgerRequest.getLedgerId();
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/ForceLedgerProcessorV3.java`
#### Snippet
```java
            if (BookieProtocol.EOK == rc) {
                requestProcessor.getRequestStats().getForceLedgerStats()
                        .registerSuccessfulEvent(MathUtils.elapsedNanos(startTimeNanos),
                                TimeUnit.NANOSECONDS);
            } else {
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/ForceLedgerProcessorV3.java`
#### Snippet
```java
            } else {
                requestProcessor.getRequestStats().getForceLedgerStats()
                        .registerFailedEvent(MathUtils.elapsedNanos(startTimeNanos),
                                TimeUnit.NANOSECONDS);
            }
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/WriteEntryProcessor.java`
#### Snippet
```java
        if (BookieProtocol.EOK == rc) {
            requestProcessor.getRequestStats().getAddEntryStats()
                .registerSuccessfulEvent(MathUtils.elapsedNanos(startTimeNanos), TimeUnit.NANOSECONDS);
        } else {
            requestProcessor.getRequestStats().getAddEntryStats()
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/WriteEntryProcessor.java`
#### Snippet
```java
        } else {
            requestProcessor.getRequestStats().getAddEntryStats()
                .registerFailedEvent(MathUtils.elapsedNanos(startTimeNanos), TimeUnit.NANOSECONDS);
        }

```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/WriteEntryProcessor.java`
#### Snippet
```java
        }

        startTimeNanos = MathUtils.nowInNano();
        int rc = BookieProtocol.EOK;
        ByteBuf addData = request.getData();
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/WriteEntryProcessor.java`
#### Snippet
```java
        if (rc != BookieProtocol.EOK) {
            requestProcessor.getRequestStats().getAddEntryStats()
                .registerFailedEvent(MathUtils.elapsedNanos(startTimeNanos), TimeUnit.NANOSECONDS);
            sendWriteReqResponse(rc,
                         ResponseBuilder.buildErrorResponse(rc, request),
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/ReadEntryProcessor.java`
#### Snippet
```java
        }
        int errorCode = BookieProtocol.EOK;
        long startTimeNanos = MathUtils.nowInNano();
        ByteBuf data = null;
        try {
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/ReadEntryProcessor.java`
#### Snippet
```java
        BookieProtocol.Response response;
        if (errorCode == BookieProtocol.EOK) {
            logger.registerSuccessfulEvent(MathUtils.elapsedNanos(startTimeNanos), TimeUnit.NANOSECONDS);
            response = ResponseBuilder.buildReadResponse(data, request);
        } else {
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/ReadEntryProcessor.java`
#### Snippet
```java
                ReferenceCountUtil.release(data);
            }
            logger.registerFailedEvent(MathUtils.elapsedNanos(startTimeNanos), TimeUnit.NANOSECONDS);
            response = ResponseBuilder.buildErrorResponse(errorCode, request);
        }
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/WriteEntryProcessorV3.java`
#### Snippet
```java
    public void run() {
        requestProcessor.getRequestStats().getWriteThreadQueuedLatency()
                .registerSuccessfulEvent(MathUtils.elapsedNanos(enqueueNanos), TimeUnit.NANOSECONDS);
        AddResponse addResponse = getAddResponse();
        if (null != addResponse) {
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/WriteEntryProcessorV3.java`
#### Snippet
```java
    // Returns null if there is no exception thrown
    private AddResponse getAddResponse() {
        final long startTimeNanos = MathUtils.nowInNano();
        AddRequest addRequest = request.getAddRequest();
        long ledgerId = addRequest.getLedgerId();
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/WriteEntryProcessorV3.java`
#### Snippet
```java
                if (BookieProtocol.EOK == rc) {
                    requestProcessor.getRequestStats().getAddEntryStats()
                        .registerSuccessfulEvent(MathUtils.elapsedNanos(startTimeNanos), TimeUnit.NANOSECONDS);
                } else {
                    requestProcessor.getRequestStats().getAddEntryStats()
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/WriteEntryProcessorV3.java`
#### Snippet
```java
                } else {
                    requestProcessor.getRequestStats().getAddEntryStats()
                        .registerFailedEvent(MathUtils.elapsedNanos(startTimeNanos), TimeUnit.NANOSECONDS);
                }

```

### StaticCallOnSubclass
Static method `signSafeMod()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/DefaultPerChannelBookieClientPool.java`
#### Snippet
```java
            return pcbc[0];
        }
        int idx = MathUtils.signSafeMod(key, pcbc.length);
        return pcbc[idx];
    }
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/ReadEntryProcessorV3.java`
#### Snippet
```java
    public void run() {
        requestProcessor.getRequestStats().getReadEntrySchedulingDelayStats().registerSuccessfulEvent(
            MathUtils.elapsedNanos(enqueueNanos), TimeUnit.NANOSECONDS);
        if (!requestHandler.ctx().channel().isOpen()) {
            if (LOG.isDebugEnabled()) {
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PacketProcessorBase.java`
#### Snippet
```java

    protected void sendResponse(int rc, Object response, OpStatsLogger statsLogger) {
        final long writeNanos = MathUtils.nowInNano();
        final long timeOut = requestProcessor.getWaitTimeoutOnBackpressureMillis();

```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PacketProcessorBase.java`
#### Snippet
```java
                    if (!channel.isWritable() && !requestProcessor.isBlacklisted(channel)) {
                        final long waitUntilNanos = writeNanos + TimeUnit.MILLISECONDS.toNanos(timeOut);
                        while (!channel.isWritable() && MathUtils.nowInNano() < waitUntilNanos) {
                            try {
                                TimeUnit.MILLISECONDS.sleep(1);
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PacketProcessorBase.java`
#### Snippet
```java
                    StringUtils.requestToString(request));
                requestProcessor.getRequestStats().getChannelWriteStats()
                    .registerFailedEvent(MathUtils.elapsedNanos(writeNanos), TimeUnit.NANOSECONDS);
                statsLogger.registerFailedEvent(MathUtils.elapsedNanos(enqueueNanos), TimeUnit.NANOSECONDS);
                if (response instanceof BookieProtocol.Response) {
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PacketProcessorBase.java`
#### Snippet
```java
                requestProcessor.getRequestStats().getChannelWriteStats()
                    .registerFailedEvent(MathUtils.elapsedNanos(writeNanos), TimeUnit.NANOSECONDS);
                statsLogger.registerFailedEvent(MathUtils.elapsedNanos(enqueueNanos), TimeUnit.NANOSECONDS);
                if (response instanceof BookieProtocol.Response) {
                    ((BookieProtocol.Response) response).release();
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PacketProcessorBase.java`
#### Snippet
```java
        }
        if (BookieProtocol.EOK == rc) {
            statsLogger.registerSuccessfulEvent(MathUtils.elapsedNanos(enqueueNanos), TimeUnit.NANOSECONDS);
        } else {
            statsLogger.registerFailedEvent(MathUtils.elapsedNanos(enqueueNanos), TimeUnit.NANOSECONDS);
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PacketProcessorBase.java`
#### Snippet
```java
            statsLogger.registerSuccessfulEvent(MathUtils.elapsedNanos(enqueueNanos), TimeUnit.NANOSECONDS);
        } else {
            statsLogger.registerFailedEvent(MathUtils.elapsedNanos(enqueueNanos), TimeUnit.NANOSECONDS);
        }
    }
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PacketProcessorBase.java`
#### Snippet
```java
        if (request instanceof BookieProtocol.ReadRequest) {
            requestProcessor.getRequestStats().getReadEntrySchedulingDelayStats()
                    .registerSuccessfulEvent(MathUtils.elapsedNanos(enqueueNanos), TimeUnit.NANOSECONDS);
        }
        if (request instanceof BookieProtocol.ParsedAddRequest) {
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PacketProcessorBase.java`
#### Snippet
```java
        if (request instanceof BookieProtocol.ParsedAddRequest) {
            requestProcessor.getRequestStats().getWriteThreadQueuedLatency()
                    .registerSuccessfulEvent(MathUtils.elapsedNanos(enqueueNanos), TimeUnit.NANOSECONDS);
        }

```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PacketProcessorBase.java`
#### Snippet
```java
        }
        if (BookieProtocol.EOK == rc) {
            statsLogger.registerSuccessfulEvent(MathUtils.elapsedNanos(enqueueNanos), TimeUnit.NANOSECONDS);
        } else {
            statsLogger.registerFailedEvent(MathUtils.elapsedNanos(enqueueNanos), TimeUnit.NANOSECONDS);
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PacketProcessorBase.java`
#### Snippet
```java
            statsLogger.registerSuccessfulEvent(MathUtils.elapsedNanos(enqueueNanos), TimeUnit.NANOSECONDS);
        } else {
            statsLogger.registerFailedEvent(MathUtils.elapsedNanos(enqueueNanos), TimeUnit.NANOSECONDS);
        }
    }
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PacketProcessorBase.java`
#### Snippet
```java
        this.requestHandler = requestHandler;
        this.requestProcessor = requestProcessor;
        this.enqueueNanos = MathUtils.nowInNano();
    }

```

### StaticCallOnSubclass
Static method `elapsedMSec()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookie/FlipBookieIdCommand.java`
#### Snippet
```java
                    return; // disabled
                }
                if (TimeUnit.MILLISECONDS.toSeconds(MathUtils.elapsedMSec(lastReport)) >= printProgress) {
                    LOG.info("Number of ledgers issued={}, updated={}", issued, updated);
                    lastReport = MathUtils.nowInNano();
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookie/FlipBookieIdCommand.java`
#### Snippet
```java
                if (TimeUnit.MILLISECONDS.toSeconds(MathUtils.elapsedMSec(lastReport)) >= printProgress) {
                    LOG.info("Number of ledgers issued={}, updated={}", issued, updated);
                    lastReport = MathUtils.nowInNano();
                }
            }
```

### StaticCallOnSubclass
Static method `elapsedMSec()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookie/UpdateBookieInLedgerCommand.java`
#### Snippet
```java
                    return; // disabled
                }
                if (TimeUnit.MILLISECONDS.toSeconds(MathUtils.elapsedMSec(lastReport)) >= printProgress) {
                    LOG.info("Number of ledgers issued={}, updated={}", issued, updated);
                    lastReport = MathUtils.nowInNano();
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookie/UpdateBookieInLedgerCommand.java`
#### Snippet
```java
                if (TimeUnit.MILLISECONDS.toSeconds(MathUtils.elapsedMSec(lastReport)) >= printProgress) {
                    LOG.info("Number of ledgers issued={}, updated={}", issued, updated);
                    lastReport = MathUtils.nowInNano();
                }
            }
```

### StaticCallOnSubclass
Static method `getMessage()` declared in class 'org.apache.bookkeeper.client.api.BKException' but referenced via subclass 'org.apache.bookkeeper.client.BKException'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookie/ReadLedgerCommand.java`
#### Snippet
```java
                                               if (rc != BKException.Code.OK) {
                                                   LOG.error("Failed to read entry {} -- {}", entryId1,
                                                             BKException.getMessage(rc));
                                                   future.completeExceptionally(BKException.create(rc));
                                                   return;
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java

        try {
            final long startTime = MathUtils.nowInNano();

            ChannelPromise promise = channel.newPromise().addListener(future -> {
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
            ChannelPromise promise = channel.newPromise().addListener(future -> {
                if (future.isSuccess()) {
                    nettyOpLogger.registerSuccessfulEvent(MathUtils.elapsedNanos(startTime), TimeUnit.NANOSECONDS);
                    CompletionValue completion = completionObjects.get(key);
                    if (completion != null) {
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
                    }
                } else {
                    nettyOpLogger.registerFailedEvent(MathUtils.elapsedNanos(startTime), TimeUnit.NANOSECONDS);
                }
            });
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
            if (future.isSuccess()) {
                PerChannelBookieClient.this
                .connectTimer.registerSuccessfulEvent(MathUtils.elapsedNanos(startTime), TimeUnit.NANOSECONDS);
            } else {
                PerChannelBookieClient.this
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
            } else {
                PerChannelBookieClient.this
                .connectTimer.registerFailedEvent(MathUtils.elapsedNanos(startTime), TimeUnit.NANOSECONDS);
            }

```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
            this.ledgerId = ledgerId;
            this.entryId = entryId;
            this.startTime = MathUtils.nowInNano();
            this.opLogger = opLogger;
            this.timeoutOpLogger = timeoutOpLogger;
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java

        private long latency() {
            return MathUtils.elapsedNanos(startTime);
        }

```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
        @Override
        boolean maybeTimeout() {
            if (MathUtils.elapsedNanos(startTime) >= addEntryTimeoutNanos) {
                timeout();
                return true;
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
            this.ledgerId = ledgerId;
            this.entryId = entryId;
            this.startTime = MathUtils.nowInNano();
        }

```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java

        boolean maybeTimeout() {
            if (MathUtils.elapsedNanos(startTime) >= readEntryTimeoutNanos) {
                timeout();
                return true;
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
        @Override
        boolean maybeTimeout() {
            if (MathUtils.elapsedNanos(startTime) >= getBookieInfoTimeoutNanos) {
                timeout();
                return true;
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java

    protected ChannelFuture connect() {
        final long startTime = MathUtils.nowInNano();
        if (LOG.isDebugEnabled()) {
            LOG.debug("Connecting to bookie: {}", bookieId);
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/GarbageCollectorThread.java`
#### Snippet
```java

    public void runWithFlags(boolean force, boolean suspendMajor, boolean suspendMinor) {
        long threadStart = MathUtils.nowInNano();
        if (force) {
            LOG.info("Garbage collector thread forced to perform GC before expiry of wait time.");
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/GarbageCollectorThread.java`
#### Snippet
```java
            }
            gcStats.getGcThreadRuntime().registerSuccessfulEvent(
                    MathUtils.nowInNano() - threadStart, TimeUnit.NANOSECONDS);
        } catch (EntryLogMetadataMapException e) {
            LOG.error("Error in entryLog-metadatamap, Failed to complete GC/Compaction due to entry-log {}",
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/GarbageCollectorThread.java`
#### Snippet
```java
                    e.getMessage(), e);
            gcStats.getGcThreadRuntime().registerFailedEvent(
                    MathUtils.nowInNano() - threadStart, TimeUnit.NANOSECONDS);
        } finally {
            if (force && forceGarbageCollection.compareAndSet(true, false)) {
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/InterleavedLedgerStorage.java`
#### Snippet
```java
    @SuppressFBWarnings("RCN_REDUNDANT_NULLCHECK_WOULD_HAVE_BEEN_A_NPE")
    public List<DetectedInconsistency> localConsistencyCheck(Optional<RateLimiter> rateLimiter) throws IOException {
        long checkStart = MathUtils.nowInNano();
        LOG.info("Starting localConsistencyCheck");
        long checkedLedgers = 0;
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/InterleavedLedgerStorage.java`
#### Snippet
```java

                        MutableBoolean success = new MutableBoolean(true);
                        long start = MathUtils.nowInNano();
                        lep.getEntries((entry, offset) -> {
                            rateLimiter.ifPresent(RateLimiter::acquire);
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/InterleavedLedgerStorage.java`
#### Snippet
```java
                        if (success.booleanValue()) {
                            pageScanStats.registerSuccessfulEvent(
                                MathUtils.elapsedNanos(start), TimeUnit.NANOSECONDS);
                        } else {
                            pageScanStats.registerFailedEvent(
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/InterleavedLedgerStorage.java`
#### Snippet
```java
                        } else {
                            pageScanStats.registerFailedEvent(
                                MathUtils.elapsedNanos(start), TimeUnit.NANOSECONDS);
                        }
                    } while (retry.booleanValue());
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/InterleavedLedgerStorage.java`
#### Snippet
```java
            "Finished localConsistencyCheck, took {}s to scan {} ledgers, {} pages, "
                + "{} entries with {} retries, {} errors",
            TimeUnit.NANOSECONDS.toSeconds(MathUtils.elapsedNanos(checkStart)),
            checkedLedgers,
            checkedPages,
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/InterleavedLedgerStorage.java`
#### Snippet
```java

        // Get Offset
        long startTimeNanos = MathUtils.nowInNano();
        boolean success = false;
        try {
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/InterleavedLedgerStorage.java`
#### Snippet
```java
        } finally {
            if (success) {
                getOffsetStats.registerSuccessfulEvent(MathUtils.elapsedNanos(startTimeNanos), TimeUnit.NANOSECONDS);
            } else {
                getOffsetStats.registerFailedEvent(MathUtils.elapsedNanos(startTimeNanos), TimeUnit.NANOSECONDS);
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/InterleavedLedgerStorage.java`
#### Snippet
```java
                getOffsetStats.registerSuccessfulEvent(MathUtils.elapsedNanos(startTimeNanos), TimeUnit.NANOSECONDS);
            } else {
                getOffsetStats.registerFailedEvent(MathUtils.elapsedNanos(startTimeNanos), TimeUnit.NANOSECONDS);
            }
        }
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/InterleavedLedgerStorage.java`
#### Snippet
```java
        }
        // Get Entry
        startTimeNanos = MathUtils.nowInNano();
        success = false;
        try {
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/InterleavedLedgerStorage.java`
#### Snippet
```java
        } finally {
            if (success) {
                getEntryStats.registerSuccessfulEvent(MathUtils.elapsedNanos(startTimeNanos), TimeUnit.NANOSECONDS);
            } else {
                getEntryStats.registerFailedEvent(MathUtils.elapsedNanos(startTimeNanos), TimeUnit.NANOSECONDS);
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/InterleavedLedgerStorage.java`
#### Snippet
```java
                getEntryStats.registerSuccessfulEvent(MathUtils.elapsedNanos(startTimeNanos), TimeUnit.NANOSECONDS);
            } else {
                getEntryStats.registerFailedEvent(MathUtils.elapsedNanos(startTimeNanos), TimeUnit.NANOSECONDS);
            }
        }
```

### StaticCallOnSubclass
Static method `signSafeMod()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryLogManagerForEntryLogPerLedger.java`
#### Snippet
```java

        private EntryLogAndLockTuple(long ledgerId) {
            int lockIndex = MathUtils.signSafeMod(Long.hashCode(ledgerId), lockArrayPool.length());
            if (lockArrayPool.get(lockIndex) == null) {
                lockArrayPool.compareAndSet(lockIndex, null, new ReentrantLock());
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Journal.java`
#### Snippet
```java
        queue.add(QueueEntry.create(
                null, false /* ackBeforeSync */, ledgerId,
                BookieImpl.METAENTRY_ID_FORCE_LEDGER, cb, ctx, MathUtils.nowInNano(),
                journalStats.getJournalForceLedgerStats(),
                callbackTime));
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Journal.java`
#### Snippet
```java

        queue.put(QueueEntry.create(
                entry, ackBeforeSync,  ledgerId, entryId, cb, ctx, MathUtils.nowInNano(),
                journalStats.getJournalAddEntryStats(),
                callbackTime));
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Journal.java`
#### Snippet
```java

        private void syncJournal(ForceWriteRequest lastRequest) throws IOException {
            long fsyncStartTime = MathUtils.nowInNano();
            try {
                lastRequest.flushFileToDisk();
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Journal.java`
#### Snippet
```java
            try {
                lastRequest.flushFileToDisk();
                journalStats.getJournalSyncStats().registerSuccessfulEvent(MathUtils.elapsedNanos(fsyncStartTime),
                        TimeUnit.NANOSECONDS);
                lastLogMark.setCurLogMark(lastRequest.logId, lastRequest.lastFlushedPosition);
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Journal.java`
#### Snippet
```java
            } catch (IOException ioe) {
                journalStats.getJournalSyncStats()
                        .registerFailedEvent(MathUtils.elapsedNanos(fsyncStartTime), TimeUnit.NANOSECONDS);
                throw ioe;
            }
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Journal.java`
#### Snippet
```java
                LOG.debug("Acknowledge Ledger: {}, Entry: {}", ledgerId, entryId);
            }
            journalAddEntryStats.registerSuccessfulEvent(MathUtils.elapsedNanos(enqueueTime), TimeUnit.NANOSECONDS);
            cb.writeComplete(0, ledgerId, entryId, null, ctx);
            callbackTime.addLatency(MathUtils.elapsedNanos(startTime), TimeUnit.NANOSECONDS);
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Journal.java`
#### Snippet
```java
            journalAddEntryStats.registerSuccessfulEvent(MathUtils.elapsedNanos(enqueueTime), TimeUnit.NANOSECONDS);
            cb.writeComplete(0, ledgerId, entryId, null, ctx);
            callbackTime.addLatency(MathUtils.elapsedNanos(startTime), TimeUnit.NANOSECONDS);
            recycle();
        }
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Journal.java`
#### Snippet
```java
                    if (dequeueStartTime != 0) {
                        journalStats.getJournalProcessTimeStats()
                            .registerSuccessfulEvent(MathUtils.elapsedNanos(dequeueStartTime), TimeUnit.NANOSECONDS);
                    }

```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Journal.java`
#### Snippet
```java
                        queue.drainTo(localQueueEntries);

                        journalTime.addLatency(MathUtils.elapsedNanos(busyStartTime), TimeUnit.NANOSECONDS);
                        if (!localQueueEntries.isEmpty()) {
                            qe = localQueueEntries.removeFirst();
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Journal.java`
#### Snippet
```java
                        }

                        dequeueStartTime = MathUtils.nowInNano();
                        busyStartTime = dequeueStartTime;
                        journalStats.getJournalQueueSize().dec();
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Journal.java`
#### Snippet
```java
                        journalStats.getJournalQueueSize().dec();
                        journalStats.getJournalQueueStats()
                                .registerSuccessfulEvent(MathUtils.elapsedNanos(qe.enqueueTime),
                                        TimeUnit.NANOSECONDS);
                    } else {
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Journal.java`
#### Snippet
```java

                        if (!localQueueEntries.isEmpty()) {
                            journalTime.addLatency(MathUtils.elapsedNanos(busyStartTime), TimeUnit.NANOSECONDS);
                            qe = localQueueEntries.removeFirst();
                            dequeueStartTime = MathUtils.nowInNano();
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Journal.java`
#### Snippet
```java
                            journalTime.addLatency(MathUtils.elapsedNanos(busyStartTime), TimeUnit.NANOSECONDS);
                            qe = localQueueEntries.removeFirst();
                            dequeueStartTime = MathUtils.nowInNano();
                            busyStartTime = dequeueStartTime;
                        } else {
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Journal.java`
#### Snippet
```java
                        } else {
                            long pollWaitTimeNanos = maxGroupWaitInNanos
                                    - MathUtils.elapsedNanos(toFlush.get(0).enqueueTime);
                            if (flushWhenQueueEmpty || pollWaitTimeNanos < 0) {
                                pollWaitTimeNanos = 0;
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Journal.java`
#### Snippet
```java
                            }
                            qe = queue.poll(pollWaitTimeNanos, TimeUnit.NANOSECONDS);
                            dequeueStartTime = MathUtils.nowInNano();
                        }

```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Journal.java`
#### Snippet
```java
                            journalStats.getJournalQueueSize().dec();
                            journalStats.getJournalQueueStats()
                                .registerSuccessfulEvent(MathUtils.elapsedNanos(qe.enqueueTime), TimeUnit.NANOSECONDS);
                        }

```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Journal.java`
#### Snippet
```java
                        // 1. If the oldest pending entry has been pending for longer than the max wait time
                        if (maxGroupWaitInNanos > 0 && !groupWhenTimeout && (MathUtils
                                .elapsedNanos(toFlush.get(0).enqueueTime) > maxGroupWaitInNanos)) {
                            groupWhenTimeout = true;
                        } else if (maxGroupWaitInNanos > 0 && groupWhenTimeout
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Journal.java`
#### Snippet
```java
                        } else if (maxGroupWaitInNanos > 0 && groupWhenTimeout
                            && (qe == null // no entry to group
                                || MathUtils.elapsedNanos(qe.enqueueTime) < maxGroupWaitInNanos)) {
                            // when group timeout, it would be better to look forward, as there might be lots of
                            // entries already timeout
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryMemTable.java`
#### Snippet
```java
        EntryKey result = null;
        EntryKey key = new EntryKey(ledgerId, Long.MAX_VALUE);
        long startTimeNanos = MathUtils.nowInNano();
        boolean success = false;
        this.lock.readLock().lock();
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryMemTable.java`
#### Snippet
```java
            if (success) {
                memTableStats.getGetEntryStats()
                    .registerSuccessfulEvent(MathUtils.elapsedNanos(startTimeNanos), TimeUnit.NANOSECONDS);
            } else {
                memTableStats.getGetEntryStats()
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryMemTable.java`
#### Snippet
```java
            } else {
                memTableStats.getGetEntryStats()
                    .registerFailedEvent(MathUtils.elapsedNanos(startTimeNanos), TimeUnit.NANOSECONDS);
            }
        }
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryMemTable.java`
#### Snippet
```java
        // No-op if snapshot currently has entries
        if (this.snapshot.isEmpty() && this.kvmap.compareTo(oldCp) < 0) {
            final long startTimeNanos = MathUtils.nowInNano();
            this.lock.writeLock().lock();
            try {
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryMemTable.java`
#### Snippet
```java
            if (null != cp) {
                memTableStats.getSnapshotStats()
                    .registerSuccessfulEvent(MathUtils.elapsedNanos(startTimeNanos), TimeUnit.NANOSECONDS);
            } else {
                memTableStats.getSnapshotStats()
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryMemTable.java`
#### Snippet
```java
            } else {
                memTableStats.getSnapshotStats()
                    .registerFailedEvent(MathUtils.elapsedNanos(startTimeNanos), TimeUnit.NANOSECONDS);
            }
        }
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryMemTable.java`
#### Snippet
```java
        EntryKey key = new EntryKey(ledgerId, entryId);
        EntryKeyValue value = null;
        long startTimeNanos = MathUtils.nowInNano();
        boolean success = false;
        this.lock.readLock().lock();
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryMemTable.java`
#### Snippet
```java
            if (success) {
                memTableStats.getGetEntryStats()
                    .registerSuccessfulEvent(MathUtils.elapsedNanos(startTimeNanos), TimeUnit.NANOSECONDS);
            } else {
                memTableStats.getGetEntryStats()
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryMemTable.java`
#### Snippet
```java
            } else {
                memTableStats.getGetEntryStats()
                    .registerFailedEvent(MathUtils.elapsedNanos(startTimeNanos), TimeUnit.NANOSECONDS);
            }
        }
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryMemTable.java`
#### Snippet
```java
            throws IOException {
        long size = 0;
        long startTimeNanos = MathUtils.nowInNano();
        boolean success = false;
        try {
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryMemTable.java`
#### Snippet
```java
            if (!skipListSemaphore.tryAcquire(len)) {
                memTableStats.getThrottlingCounter().inc();
                final long throttlingStartTimeNanos = MathUtils.nowInNano();
                skipListSemaphore.acquireUninterruptibly(len);
                memTableStats.getThrottlingStats()
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryMemTable.java`
#### Snippet
```java
                skipListSemaphore.acquireUninterruptibly(len);
                memTableStats.getThrottlingStats()
                    .registerSuccessfulEvent(MathUtils.elapsedNanos(throttlingStartTimeNanos), TimeUnit.NANOSECONDS);
            }

```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryMemTable.java`
#### Snippet
```java
            if (success) {
                memTableStats.getPutEntryStats()
                    .registerSuccessfulEvent(MathUtils.elapsedNanos(startTimeNanos), TimeUnit.NANOSECONDS);
            } else {
                memTableStats.getPutEntryStats()
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryMemTable.java`
#### Snippet
```java
            } else {
                memTableStats.getPutEntryStats()
                    .registerFailedEvent(MathUtils.elapsedNanos(startTimeNanos), TimeUnit.NANOSECONDS);
            }
        }
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieImpl.java`
#### Snippet
```java
    public void recoveryAddEntry(ByteBuf entry, WriteCallback cb, Object ctx, byte[] masterKey)
            throws IOException, BookieException, InterruptedException {
        long requestNanos = MathUtils.nowInNano();
        boolean success = false;
        int entrySize = 0;
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieImpl.java`
#### Snippet
```java
            throw new IOException(e);
        } finally {
            long elapsedNanos = MathUtils.elapsedNanos(requestNanos);
            if (success) {
                bookieStats.getRecoveryAddEntryStats().registerSuccessfulEvent(elapsedNanos, TimeUnit.NANOSECONDS);
```

### StaticCallOnSubclass
Static method `signSafeMod()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieImpl.java`
#### Snippet
```java

    private Journal getJournal(long ledgerId) {
        return journals.get(MathUtils.signSafeMod(ledgerId, journals.size()));
    }

```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieImpl.java`
#### Snippet
```java
    public ByteBuf readEntry(long ledgerId, long entryId)
            throws IOException, NoLedgerException, BookieException {
        long requestNanos = MathUtils.nowInNano();
        boolean success = false;
        int entrySize = 0;
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieImpl.java`
#### Snippet
```java
            return entry;
        } finally {
            long elapsedNanos = MathUtils.elapsedNanos(requestNanos);
            if (success) {
                bookieStats.getReadEntryStats().registerSuccessfulEvent(elapsedNanos, TimeUnit.NANOSECONDS);
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieImpl.java`
#### Snippet
```java

    public OfLong getListOfEntriesOfLedger(long ledgerId) throws IOException, NoLedgerException {
        long requestNanos = MathUtils.nowInNano();
        boolean success = false;
        try {
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieImpl.java`
#### Snippet
```java
            return entriesOfLedger;
        } finally {
            long elapsedNanos = MathUtils.elapsedNanos(requestNanos);
            if (success) {
                bookieStats.getReadEntryStats().registerSuccessfulEvent(elapsedNanos, TimeUnit.NANOSECONDS);
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieImpl.java`
#### Snippet
```java
    public void addEntry(ByteBuf entry, boolean ackBeforeSync, WriteCallback cb, Object ctx, byte[] masterKey)
            throws IOException, BookieException, InterruptedException {
        long requestNanos = MathUtils.nowInNano();
        boolean success = false;
        int entrySize = 0;
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieImpl.java`
#### Snippet
```java
            throw new IOException(e);
        } finally {
            long elapsedNanos = MathUtils.elapsedNanos(requestNanos);
            if (success) {
                bookieStats.getAddEntryStats().registerSuccessfulEvent(elapsedNanos, TimeUnit.NANOSECONDS);
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/EntryLocationIndex.java`
#### Snippet
```java
        LongWrapper value = LongWrapper.get();

        long startTimeNanos = MathUtils.nowInNano();
        boolean operationSuccess = false;
        try {
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/EntryLocationIndex.java`
#### Snippet
```java
            if (operationSuccess) {
                stats.getLookupEntryLocationStats()
                        .registerSuccessfulEvent(MathUtils.elapsedNanos(startTimeNanos), TimeUnit.NANOSECONDS);
            } else {
                stats.getLookupEntryLocationStats()
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/EntryLocationIndex.java`
#### Snippet
```java
            } else {
                stats.getLookupEntryLocationStats()
                        .registerFailedEvent(MathUtils.elapsedNanos(startTimeNanos), TimeUnit.NANOSECONDS);
            }
        }
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/SingleDirectoryDbLedgerStorage.java`
#### Snippet
```java
        // Read from main storage
        long entryLocation;
        long locationIndexStartNano = MathUtils.nowInNano();
        try {
            entryLocation = entryLocationIndex.getLocation(ledgerId, entryId);
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/SingleDirectoryDbLedgerStorage.java`
#### Snippet
```java
        } finally {
            dbLedgerStorageStats.getReadFromLocationIndexTime().addLatency(
                    MathUtils.elapsedNanos(locationIndexStartNano), TimeUnit.NANOSECONDS);
        }

```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/SingleDirectoryDbLedgerStorage.java`
#### Snippet
```java
        }

        long readEntryStartNano = MathUtils.nowInNano();
        try {
            entry = entryLogger.readEntry(ledgerId, entryId, entryLocation);
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/SingleDirectoryDbLedgerStorage.java`
#### Snippet
```java
        } finally {
            dbLedgerStorageStats.getReadFromEntryLogTime().addLatency(
                    MathUtils.elapsedNanos(readEntryStartNano), TimeUnit.NANOSECONDS);
        }

```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/SingleDirectoryDbLedgerStorage.java`
#### Snippet
```java
    @Override
    public ByteBuf getEntry(long ledgerId, long entryId) throws IOException, BookieException {
        long startTime = MathUtils.nowInNano();
        try {
            ByteBuf entry = doGetEntry(ledgerId, entryId);
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/SingleDirectoryDbLedgerStorage.java`
#### Snippet
```java
    private void triggerFlushAndAddEntry(long ledgerId, long entryId, ByteBuf entry)
            throws IOException, BookieException {
        long throttledStartTime = MathUtils.nowInNano();
        dbLedgerStorageStats.getThrottledWriteRequests().inc();
        long absoluteTimeoutNanos = System.nanoTime() + maxThrottleTimeNanos;
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/SingleDirectoryDbLedgerStorage.java`
#### Snippet
```java
                            log.error("Error during flush", e);
                        } finally {
                            flushExecutorTime.addLatency(MathUtils.elapsedNanos(startTime), TimeUnit.NANOSECONDS);
                        }
                    });
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/SingleDirectoryDbLedgerStorage.java`
#### Snippet
```java

        // Search the last entry in storage
        long locationIndexStartNano = MathUtils.nowInNano();
        long lastEntryId = entryLocationIndex.getLastEntryInLedger(ledgerId);
        if (log.isDebugEnabled()) {
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/SingleDirectoryDbLedgerStorage.java`
#### Snippet
```java
        long entryLocation = entryLocationIndex.getLocation(ledgerId, lastEntryId);
        dbLedgerStorageStats.getReadFromLocationIndexTime().addLatency(
                MathUtils.elapsedNanos(locationIndexStartNano), TimeUnit.NANOSECONDS);

        long readEntryStartNano = MathUtils.nowInNano();
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/SingleDirectoryDbLedgerStorage.java`
#### Snippet
```java
                MathUtils.elapsedNanos(locationIndexStartNano), TimeUnit.NANOSECONDS);

        long readEntryStartNano = MathUtils.nowInNano();
        ByteBuf content = entryLogger.readEntry(ledgerId, lastEntryId, entryLocation);
        dbLedgerStorageStats.getReadFromEntryLogTime().addLatency(
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/SingleDirectoryDbLedgerStorage.java`
#### Snippet
```java
        ByteBuf content = entryLogger.readEntry(ledgerId, lastEntryId, entryLocation);
        dbLedgerStorageStats.getReadFromEntryLogTime().addLatency(
                MathUtils.elapsedNanos(readEntryStartNano), TimeUnit.NANOSECONDS);
        return content;
    }
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/SingleDirectoryDbLedgerStorage.java`
#### Snippet
```java

    private void recordFailedEvent(OpStatsLogger logger, long startTimeNanos) {
        logger.registerFailedEvent(MathUtils.elapsedNanos(startTimeNanos), TimeUnit.NANOSECONDS);
    }

```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/SingleDirectoryDbLedgerStorage.java`
#### Snippet
```java

    private void recordSuccessfulEvent(OpStatsLogger logger, long startTimeNanos) {
        logger.registerSuccessfulEvent(MathUtils.elapsedNanos(startTimeNanos), TimeUnit.NANOSECONDS);
    }

```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/SingleDirectoryDbLedgerStorage.java`
#### Snippet
```java
        long startTime = -1;
        try {
            startTime = MathUtils.nowInNano();
        } catch (Throwable e) {
            // Fix spotbugs warning. Should never happen
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/SingleDirectoryDbLedgerStorage.java`
#### Snippet
```java
            });

            long entryLoggerStart = MathUtils.nowInNano();
            entryLogger.flush();
            recordSuccessfulEvent(dbLedgerStorageStats.getFlushEntryLogStats(), entryLoggerStart);
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/SingleDirectoryDbLedgerStorage.java`
#### Snippet
```java
            recordSuccessfulEvent(dbLedgerStorageStats.getFlushEntryLogStats(), entryLoggerStart);

            long batchFlushStartTime = MathUtils.nowInNano();
            batch.flush();
            batch.close();
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/SingleDirectoryDbLedgerStorage.java`
#### Snippet
```java
            if (log.isDebugEnabled()) {
                log.debug("DB batch flushed time : {} s",
                        MathUtils.elapsedNanos(batchFlushStartTime) / (double) TimeUnit.SECONDS.toNanos(1));
            }

```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/SingleDirectoryDbLedgerStorage.java`
#### Snippet
```java
            }

            long ledgerIndexStartTime = MathUtils.nowInNano();
            ledgerIndex.flush();
            recordSuccessfulEvent(dbLedgerStorageStats.getFlushLedgerIndexStats(), ledgerIndexStartTime);
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/SingleDirectoryDbLedgerStorage.java`
#### Snippet
```java
            writeCacheBeingFlushed.clear();

            double flushTimeSeconds = MathUtils.elapsedNanos(startTime) / (double) TimeUnit.SECONDS.toNanos(1);
            double flushThroughput = sizeToFlush / 1024.0 / 1024.0 / flushTimeSeconds;

```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/SingleDirectoryDbLedgerStorage.java`
#### Snippet
```java

    private void fillReadAheadCache(long orginalLedgerId, long firstEntryId, long firstEntryLocation) {
        long readAheadStartNano = MathUtils.nowInNano();
        int count = 0;
        long size = 0;
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/SingleDirectoryDbLedgerStorage.java`
#### Snippet
```java
            dbLedgerStorageStats.getReadAheadBatchSizeStats().registerSuccessfulValue(size);
            dbLedgerStorageStats.getReadAheadTime().addLatency(
                    MathUtils.elapsedNanos(readAheadStartNano), TimeUnit.NANOSECONDS);
        }
    }
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/SingleDirectoryDbLedgerStorage.java`
#### Snippet
```java
    @Override
    public long addEntry(ByteBuf entry) throws IOException, BookieException {
        long startTime = MathUtils.nowInNano();

        long ledgerId = entry.getLong(entry.readerIndex());
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerOpenOp.java`
#### Snippet
```java
     */
    public void initiate() {
        startTime = MathUtils.nowInNano();

        /**
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerOpenOp.java`
#### Snippet
```java
    void openComplete(int rc, LedgerHandle lh) {
        if (BKException.Code.OK != rc) {
            openOpLogger.registerFailedEvent(MathUtils.elapsedNanos(startTime), TimeUnit.NANOSECONDS);
        } else {
            openOpLogger.registerSuccessfulEvent(MathUtils.elapsedNanos(startTime), TimeUnit.NANOSECONDS);
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerOpenOp.java`
#### Snippet
```java
            openOpLogger.registerFailedEvent(MathUtils.elapsedNanos(startTime), TimeUnit.NANOSECONDS);
        } else {
            openOpLogger.registerSuccessfulEvent(MathUtils.elapsedNanos(startTime), TimeUnit.NANOSECONDS);
        }

```

### StaticCallOnSubclass
Static method `getMessage()` declared in class 'org.apache.bookkeeper.client.api.BKException' but referenced via subclass 'org.apache.bookkeeper.client.BKException'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/SyncCallbackUtils.java`
#### Snippet
```java
        public void addLacComplete(int rc, LedgerHandle lh, Object ctx) {
            if (rc != BKException.Code.OK) {
                log.warn("LastAddConfirmedUpdate failed: {} ", BKException.getMessage(rc));
            } else if (log.isDebugEnabled()) {
                log.debug("Callback LAC Updated for: {} ", lh.getId());
```

### StaticCallOnSubclass
Static method `getMessage()` declared in class 'org.apache.bookkeeper.client.api.BKException' but referenced via subclass 'org.apache.bookkeeper.client.BKException'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java`
#### Snippet
```java

        if (rc != BKException.Code.OK) {
            entry.logErrorAndReattemptRead(rctx.bookieIndex, rctx.to, "Error: " + BKException.getMessage(rc), rc);
            return;
        }
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java`
#### Snippet
```java
    void initiate() {
        long nextEnsembleChange = startEntryId, i = startEntryId;
        this.requestTimeNanos = MathUtils.nowInNano();
        List<BookieId> ensemble = null;
        do {
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java`
#### Snippet
```java
        cancelSpeculativeTask(true);

        long latencyNanos = MathUtils.elapsedNanos(requestTimeNanos);
        if (code != BKException.Code.OK) {
            long firstUnread = LedgerHandle.INVALID_ENTRY_ID;
```

### StaticCallOnSubclass
Static method `getMessage()` declared in class 'org.apache.bookkeeper.client.api.BKException' but referenced via subclass 'org.apache.bookkeeper.client.BKException'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java`
#### Snippet
```java
                            + "Heard from {} : bitset = {}, Error = '{}'. First unread entry is ({}, rc = {})",
                    lh.getId(), startEntryId, endEntryId, sentToHosts, heardFromHosts, heardFromHostsBitSet,
                    BKException.getMessage(code), firstUnread, firstRc);
            clientCtx.getClientStats().getReadOpLogger().registerFailedEvent(latencyNanos, TimeUnit.NANOSECONDS);
            // release the entries
```

### StaticCallOnSubclass
Static method `getMessage()` declared in class 'org.apache.bookkeeper.client.api.BKException' but referenced via subclass 'org.apache.bookkeeper.client.BKException'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadLastConfirmedAndEntryOp.java`
#### Snippet
```java
            requestComplete.set(true);
        } else {
            request.logErrorAndReattemptRead(rCtx.getBookieIndex(), bookie, "Error: " + BKException.getMessage(rc), rc);
            return;
        }
```

### StaticCallOnSubclass
Static method `elapsedMicroSec()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadLastConfirmedAndEntryOp.java`
#### Snippet
```java

    private void submitCallback(int rc) {
        long latencyMicros = MathUtils.elapsedMicroSec(requestTimeNano);
        LedgerEntry entry;
        cancelSpeculativeTask(true);
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadLastConfirmedAndEntryOp.java`
#### Snippet
```java
        this.numEmptyResponsesAllowed = getLedgerMetadata().getEnsembleSize()
                - getLedgerMetadata().getAckQuorumSize() + 1;
        this.requestTimeNano = MathUtils.nowInNano();

        maxMissedReadsAllowed = getLedgerMetadata().getEnsembleSize()
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerDeleteOp.java`
#### Snippet
```java
        this.cb = cb;
        this.ctx = ctx;
        this.startTime = MathUtils.nowInNano();
        this.deleteOpLogger = clientStats.getDeleteOpLogger();
    }
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerDeleteOp.java`
#### Snippet
```java
            .whenCompleteAsync((ignore, exception) -> {
                    if (exception != null) {
                        deleteOpLogger.registerFailedEvent(MathUtils.elapsedNanos(startTime), TimeUnit.NANOSECONDS);
                    } else {
                        deleteOpLogger.registerSuccessfulEvent(MathUtils.elapsedNanos(startTime), TimeUnit.NANOSECONDS);
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerDeleteOp.java`
#### Snippet
```java
                        deleteOpLogger.registerFailedEvent(MathUtils.elapsedNanos(startTime), TimeUnit.NANOSECONDS);
                    } else {
                        deleteOpLogger.registerSuccessfulEvent(MathUtils.elapsedNanos(startTime), TimeUnit.NANOSECONDS);
                    }
                    cb.deleteComplete(BKException.getExceptionCode(exception), this.ctx);
```

### StaticCallOnSubclass
Static method `codeLogger()` declared in class 'org.apache.bookkeeper.client.api.BKException' but referenced via subclass 'org.apache.bookkeeper.client.BKException'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookieInfoReader.java`
#### Snippet
```java
                                    if (LOG.isErrorEnabled()) {
                                        LOG.error("Reading bookie info from bookie {} failed due to {}",
                                                b, BKException.codeLogger(rc));
                                    }
                                    // We reread bookies missing from the map each time, so remove to ensure
```

### StaticCallOnSubclass
Static method `codeLogger()` declared in class 'org.apache.bookkeeper.client.api.BKException' but referenced via subclass 'org.apache.bookkeeper.client.BKException'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookieInfoReader.java`
#### Snippet
```java
                                if (LOG.isErrorEnabled()) {
                                    LOG.error("Reading bookie info from bookie {} failed due to {}",
                                            b, BKException.codeLogger(rc));
                                }
                            } else {
```

### StaticCallOnSubclass
Static method `getMessage()` declared in class 'org.apache.bookkeeper.client.api.BKException' but referenced via subclass 'org.apache.bookkeeper.client.BKException'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerRecoveryOp.java`
#### Snippet
```java
        if (BKException.Code.OK != rc && !promise.isDone()) {
            LOG.error("Failure {} while reading entries: ({} - {}), ledger: {} while recovering ledger",
                      BKException.getMessage(rc), startEntryToRead, endEntryToRead, lh.getId());
            submitCallback(rc);
        } else if (BKException.Code.OK == rc) {
```

### StaticCallOnSubclass
Static method `codeLogger()` declared in class 'org.apache.bookkeeper.client.api.BKException' but referenced via subclass 'org.apache.bookkeeper.client.BKException'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerRecoveryOp.java`
#### Snippet
```java
        if (rc != BKException.Code.OK) {
            LOG.error("Failure {} while writing entry: {} while recovering ledger: {}",
                    BKException.codeLogger(rc), entryId + 1, lh.ledgerId);
            submitCallback(rc);
            return;
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ListenerBasedPendingReadOp.java`
#### Snippet
```java
            }
            seq.removeFirst();
            long latencyNanos = MathUtils.elapsedNanos(requestTimeNanos);
            LedgerEntry entry;
            if (BKException.Code.OK == request.getRc()) {
```

### StaticCallOnSubclass
Static method `codeLogger()` declared in class 'org.apache.bookkeeper.client.api.BKException' but referenced via subclass 'org.apache.bookkeeper.client.BKException'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
        public void closeComplete(int rc, LedgerHandle lh, Object ctx) {
            if (rc != BKException.Code.OK) {
                LOG.warn("Close failed: {}", BKException.codeLogger(rc));
            }
            // noop
```

### StaticCallOnSubclass
Static method `codeLogger()` declared in class 'org.apache.bookkeeper.client.api.BKException' but referenced via subclass 'org.apache.bookkeeper.client.BKException'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
            return;
        }
        LOG.error("Closing ledger {} due to {}", ledgerId, BKException.codeLogger(rc));
        asyncCloseInternal(NoopCloseCallback.instance, null, rc);
    }
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        }

        long latencyNanos = MathUtils.elapsedNanos(requestTimeNanos);
        if (rc != BKException.Code.OK) {
            clientCtx.getClientStats().getAddOpLogger().registerFailedEvent(latencyNanos, TimeUnit.NANOSECONDS);
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        }

        this.requestTimeNanos = MathUtils.nowInNano();
        checkNotNull(lh);
        checkNotNull(lh.macManager);
```

### StaticCallOnSubclass
Static method `getMessage()` declared in class 'org.apache.bookkeeper.client.api.BKException' but referenced via subclass 'org.apache.bookkeeper.client.BKException'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
                    LOG.debug("Failed to write entry ({}, {}) to bookie ({}, {}),"
                                    + " but it didn't break ack quorum, delaying ensemble change : {}",
                            ledgerId, entryId, bookieIndex, addr, BKException.getMessage(rc));
                }
            } else {
```

### StaticCallOnSubclass
Static method `getMessage()` declared in class 'org.apache.bookkeeper.client.api.BKException' but referenced via subclass 'org.apache.bookkeeper.client.BKException'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
            } else {
                LOG.warn("Failed to write entry ({}, {}) to bookie ({}, {}): {}",
                        ledgerId, entryId, bookieIndex, addr, BKException.getMessage(rc));
                lh.handleBookieFailure(ImmutableMap.of(bookieIndex, addr));
            }
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
                // Only do this for the first time.
                if (writeDelayedStartTime == -1) {
                    writeDelayedStartTime = MathUtils.nowInNano();
                }
            } else {
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
            } else {
                completed = true;
                this.qwcLatency = MathUtils.elapsedNanos(requestTimeNanos);

                if (writeDelayedStartTime != -1) {
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
                    clientCtx.getClientStats()
                             .getWriteDelayedDueToNotEnoughFaultDomainsLatency()
                             .registerSuccessfulEvent(MathUtils.elapsedNanos(writeDelayedStartTime),
                                                      TimeUnit.NANOSECONDS);
                }
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java

    boolean maybeTimeout() {
        if (MathUtils.elapsedNanos(requestTimeNanos) >= clientCtx.getConf().addEntryQuorumTimeoutNanos) {
            timeoutQuorumWait();
            return true;
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerCreateOp.java`
#### Snippet
```java
        // Opened a new ledger
        if (BKException.Code.OK != rc) {
            createOpLogger.registerFailedEvent(MathUtils.elapsedNanos(startTime), TimeUnit.NANOSECONDS);
        } else {
            createOpLogger.registerSuccessfulEvent(MathUtils.elapsedNanos(startTime), TimeUnit.NANOSECONDS);
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerCreateOp.java`
#### Snippet
```java
            createOpLogger.registerFailedEvent(MathUtils.elapsedNanos(startTime), TimeUnit.NANOSECONDS);
        } else {
            createOpLogger.registerSuccessfulEvent(MathUtils.elapsedNanos(startTime), TimeUnit.NANOSECONDS);
        }
        if (lh != null) { // lh is null in case of errors
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerCreateOp.java`
#### Snippet
```java
        this.cb = cb;
        this.ctx = ctx;
        this.startTime = MathUtils.nowInNano();
        this.createOpLogger = clientStats.getCreateOpLogger();
        this.clientStats = clientStats;
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerFragmentReplicator.java`
#### Snippet
```java
                }

                readDataLatency.registerSuccessfulEvent(MathUtils.elapsedNanos(startReadEntryTime),
                        TimeUnit.NANOSECONDS);

```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerFragmentReplicator.java`
#### Snippet
```java
                }
                for (BookieId newBookie : newBookies) {
                    long startWriteEntryTime = MathUtils.nowInNano();
                    bkc.getBookieClient().addEntry(newBookie, lh.getId(),
                            lh.getLedgerKey(), entryId, ByteBufList.clone(toSend),
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerFragmentReplicator.java`
#### Snippet
```java
                            false, WriteFlag.NONE);
                    writeDataLatency.registerSuccessfulEvent(
                           MathUtils.elapsedNanos(startWriteEntryTime), TimeUnit.NANOSECONDS);
                }
                toSend.release();
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerFragmentReplicator.java`
#### Snippet
```java
        };

        long startReadEntryTime = MathUtils.nowInNano();
        /*
         * Read the ledger entry using the LedgerHandle. This will allow us to
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/service/ScrubberService.java`
#### Snippet
```java
    private void run() {
        boolean success = false;
        long start = MathUtils.nowInNano();
        try {
            List<LedgerStorage.DetectedInconsistency> errors = ledgerStorage.localConsistencyCheck(scrubRateLimiter);
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/service/ScrubberService.java`
#### Snippet
```java
        }
        if (success) {
            scrubCounter.registerSuccessfulEvent(MathUtils.elapsedNanos(start), TimeUnit.NANOSECONDS);
        } else {
            scrubCounter.registerFailedEvent(MathUtils.elapsedNanos(start), TimeUnit.NANOSECONDS);
```

### StaticCallOnSubclass
Static method `elapsedNanos()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/service/ScrubberService.java`
#### Snippet
```java
            scrubCounter.registerSuccessfulEvent(MathUtils.elapsedNanos(start), TimeUnit.NANOSECONDS);
        } else {
            scrubCounter.registerFailedEvent(MathUtils.elapsedNanos(start), TimeUnit.NANOSECONDS);
            Runtime.getRuntime().exit(ExitCode.BOOKIE_EXCEPTION);
        }
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/zookeeper/ZooWorker.java`
#### Snippet
```java
        boolean isDone = false;
        int attempts = 0;
        long startTimeNanos = MathUtils.nowInNano();
        while (!isDone) {
            try {
```

### StaticCallOnSubclass
Static method `elapsedMicroSec()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/zookeeper/ZooWorker.java`
#### Snippet
```java
                result = proc.call();
                isDone = true;
                statsLogger.registerSuccessfulEvent(MathUtils.elapsedMicroSec(startTimeNanos), TimeUnit.MICROSECONDS);
            } catch (KeeperException e) {
                ++attempts;
```

### StaticCallOnSubclass
Static method `elapsedMSec()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/zookeeper/ZooWorker.java`
#### Snippet
```java
                ++attempts;
                boolean rethrow = true;
                long elapsedTime = MathUtils.elapsedMSec(startTimeNanos);
                if (((null != client && isRecoverableException(e)) || null == client)
                    && retryPolicy.allowRetry(attempts, elapsedTime)) {
```

### StaticCallOnSubclass
Static method `elapsedMicroSec()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/zookeeper/ZooWorker.java`
#### Snippet
```java
                }
                if (rethrow) {
                    statsLogger.registerFailedEvent(MathUtils.elapsedMicroSec(startTimeNanos), TimeUnit.MICROSECONDS);
                    logger.debug("Stopped executing {} after {} attempts.", proc, attempts);
                    throw e;
```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/zookeeper/ZooWorker.java`
#### Snippet
```java
        this.retryPolicy = retryPolicy;
        this.statsLogger = statsLogger;
        this.startTimeNanos = MathUtils.nowInNano();
    }

```

### StaticCallOnSubclass
Static method `elapsedMSec()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/zookeeper/ZooWorker.java`
#### Snippet
```java

    public boolean allowRetry(int rc) {
        elapsedTimeMs = MathUtils.elapsedMSec(startTimeNanos);
        if (!ZooWorker.isRecoverableException(rc)) {
            if (KeeperException.Code.OK.intValue() == rc) {
```

### StaticCallOnSubclass
Static method `elapsedMicroSec()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/zookeeper/ZooWorker.java`
#### Snippet
```java
        if (!ZooWorker.isRecoverableException(rc)) {
            if (KeeperException.Code.OK.intValue() == rc) {
                statsLogger.registerSuccessfulEvent(MathUtils.elapsedMicroSec(startTimeNanos), TimeUnit.MICROSECONDS);
            } else {
                statsLogger.registerFailedEvent(MathUtils.elapsedMicroSec(startTimeNanos), TimeUnit.MICROSECONDS);
```

### StaticCallOnSubclass
Static method `elapsedMicroSec()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/zookeeper/ZooWorker.java`
#### Snippet
```java
                statsLogger.registerSuccessfulEvent(MathUtils.elapsedMicroSec(startTimeNanos), TimeUnit.MICROSECONDS);
            } else {
                statsLogger.registerFailedEvent(MathUtils.elapsedMicroSec(startTimeNanos), TimeUnit.MICROSECONDS);
            }
            return false;
```

### StaticCallOnSubclass
Static method `getMessage()` declared in class 'org.apache.bookkeeper.client.api.BKException' but referenced via subclass 'org.apache.bookkeeper.client.BKException'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/AuditorCheckAllLedgersTask.java`
#### Snippet
```java
                        callback.processResult(BKException.Code.OK, null, null);
                    } else {
                        LOG.error("Couldn't open ledger {} to check : {}", ledgerId, BKException.getMessage(rc));
                        callback.processResult(rc, null, null);
                    }
```

### StaticCallOnSubclass
Static method `codeLogger()` declared in class 'org.apache.bookkeeper.client.api.BKException' but referenced via subclass 'org.apache.bookkeeper.client.BKException'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeperAdmin.java`
#### Snippet
```java
            @Override
            public void recoverComplete(int rc, Object ctx) {
                LOG.info("Recover bookie operation completed with rc: {}", BKException.codeLogger(rc));
                SyncObject syncObj = (SyncObject) ctx;
                synchronized (syncObj) {
```

### StaticCallOnSubclass
Static method `codeLogger()` declared in class 'org.apache.bookkeeper.client.api.BKException' but referenced via subclass 'org.apache.bookkeeper.client.BKException'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeperAdmin.java`
#### Snippet
```java
        // Call the async method to recover bookie data.
        asyncRecoverBookieData(lid, bookiesSrc, dryrun, skipOpenLedgers, (rc, ctx) -> {
            LOG.info("Recover bookie for {} completed with rc : {}", lid, BKException.codeLogger(rc));
            SyncObject syncObject = (SyncObject) ctx;
            synchronized (syncObject) {
```

### StaticCallOnSubclass
Static method `getMessage()` declared in class 'org.apache.bookkeeper.client.api.BKException' but referenced via subclass 'org.apache.bookkeeper.client.BKException'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeperAdmin.java`
#### Snippet
```java
                        } else {
                            VERBOSE.info("  Fragment [{} - {}] : {}", startEntryId, endEntryId,
                                BKException.getMessage(BKException.Code.NotEnoughBookiesException));
                        }
                        continue;
```

### StaticCallOnSubclass
Static method `codeLogger()` declared in class 'org.apache.bookkeeper.client.api.BKException' but referenced via subclass 'org.apache.bookkeeper.client.BKException'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeperAdmin.java`
#### Snippet
```java
                            if (skipUnrecoverableLedgers) {
                                LOG.warn("Failed to recover ledger: {} : {}, skip recover it.", lId,
                                    BKException.codeLogger(rc));
                                rc = BKException.Code.OK;
                            } else {
```

### StaticCallOnSubclass
Static method `codeLogger()` declared in class 'org.apache.bookkeeper.client.api.BKException' but referenced via subclass 'org.apache.bookkeeper.client.BKException'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeperAdmin.java`
#### Snippet
```java
                                rc = BKException.Code.OK;
                            } else {
                                LOG.error("Failed to recover ledger {} : {}", lId, BKException.codeLogger(rc));
                            }
                        } else {
```

### StaticCallOnSubclass
Static method `getMessage()` declared in class 'org.apache.bookkeeper.client.api.BKException' but referenced via subclass 'org.apache.bookkeeper.client.BKException'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogSegmentWriter.java`
#### Snippet
```java
                        if (!abort) {
                            throwExc.setValue(new IOException("Failed to close ledger for "
                                    + fullyQualifiedLogSegment + " : " + BKException.getMessage(rc)));
                        }
                    }
```

### StaticCallOnSubclass
Static method `elapsedMSec()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogSegmentWriter.java`
#### Snippet
```java
        }

        if (MathUtils.elapsedMSec(lastTransmitNanos) < periodicKeepAliveMs) {
            return;
        }
```

### StaticCallOnSubclass
Static method `getMessage()` declared in class 'org.apache.bookkeeper.client.api.BKException' but referenced via subclass 'org.apache.bookkeeper.client.BKException'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogSegmentWriter.java`
#### Snippet
```java
        if (null != closeFuture) {
            throw new WriteException(fullyQualifiedLogSegment,
                    BKException.getMessage(BKException.Code.LedgerClosedException));
        }

```

### StaticCallOnSubclass
Static method `getMessage()` declared in class 'org.apache.bookkeeper.client.api.BKException' but referenced via subclass 'org.apache.bookkeeper.client.BKException'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogSegmentWriter.java`
#### Snippet
```java
        if (BKException.Code.OK != transmitResultUpdater.get(this)) {
            // Failfast if the stream already encountered error with safe retry on the client
            throw new WriteException(fullyQualifiedLogSegment, BKException.getMessage(transmitResultUpdater.get(this)));
        }

```

### StaticCallOnSubclass
Static method `getMessage()` declared in class 'org.apache.bookkeeper.client.api.BKException' but referenced via subclass 'org.apache.bookkeeper.client.BKException'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogSegmentWriter.java`
#### Snippet
```java
                    LOG.error("Log Segment {} Trying to write to an errored stream; Error is {}",
                              fullyQualifiedLogSegment,
                              BKException.getMessage(transmitResultUpdater.get(this)));
                    throw new BKTransmitException("Trying to write to an errored stream;"
                                                          + " Error code : (" + transmitResultUpdater.get(this) + ") "
```

### StaticCallOnSubclass
Static method `getMessage()` declared in class 'org.apache.bookkeeper.client.api.BKException' but referenced via subclass 'org.apache.bookkeeper.client.BKException'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogSegmentWriter.java`
#### Snippet
```java
                    throw new BKTransmitException("Trying to write to an errored stream;"
                                                          + " Error code : (" + transmitResultUpdater.get(this) + ") "
                            + BKException.getMessage(transmitResultUpdater.get(this)), transmitResultUpdater.get(this));
                }

```

### StaticCallOnSubclass
Static method `nowInNano()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogSegmentWriter.java`
#### Snippet
```java
            synchronized (this) {
                // update the transmit timestamp
                lastTransmitNanos = MathUtils.nowInNano();

                BKTransmitPacket packet = new BKTransmitPacket(recordSetToTransmit);
```

### StaticCallOnSubclass
Static method `getMessage()` declared in class 'org.apache.bookkeeper.client.api.BKException' but referenced via subclass 'org.apache.bookkeeper.client.BKException'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/logsegment/BKLogSegmentEntryStore.java`
#### Snippet
```java
        } else if (BKException.Code.OK != rc) {
            logger.error("Couldn't delete ledger {} from bookkeeper for {} : {}",
                deleteRequest.segment.getLogSegmentId(), deleteRequest.segment, BKException.getMessage(rc));
            FutureUtils.completeExceptionally(deleteRequest.deletePromise,
                    new BKTransmitException("Couldn't delete log segment " + deleteRequest.segment, rc));
```

### StaticCallOnSubclass
Static method `getMessage()` declared in class 'org.apache.bookkeeper.client.api.BKException' but referenced via subclass 'org.apache.bookkeeper.client.BKException'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/util/Utils.java`
#### Snippet
```java
        return new BKTransmitException("Failed to write to bookkeeper; Error is ("
            + transmitResult + ") "
            + BKException.getMessage(transmitResult), transmitResult);
    }

```

### StaticCallOnSubclass
Static method `getMessage()` declared in class 'org.apache.bookkeeper.client.api.BKException' but referenced via subclass 'org.apache.bookkeeper.client.BKException'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                        System.out.println("Eid = " + rr.getEntryId() + ", Lac = " + rr.getValue());
                    } else {
                        System.out.println("status = " + BKException.getMessage(rr.getResultCode()));
                    }
                    System.out.println("\t-------------------------------");
```

### StaticCallOnSubclass
Static method `getMessage()` declared in class 'org.apache.bookkeeper.client.api.BKException' but referenced via subclass 'org.apache.bookkeeper.client.BKException'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                            System.out.println("\tbookie=" + rr.getBookieAddress());
                            System.out.println("\t-------------------------------");
                            System.out.println("status = " + BKException.getMessage(rr.getResultCode()));
                            System.out.println("\t-------------------------------");
                        }
```

### StaticCallOnSubclass
Static method `getMessage()` declared in class 'org.apache.bookkeeper.client.api.BKException' but referenced via subclass 'org.apache.bookkeeper.client.BKException'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                            printEntry(reader);
                        } else {
                            System.out.println("status = " + BKException.getMessage(rr.getResultCode()));
                        }
                        System.out.println("\t-------------------------------");
```

### StaticCallOnSubclass
Static method `findNextPositivePowerOfTwo()` declared in class 'org.apache.bookkeeper.common.util.MathUtils' but referenced via subclass 'org.apache.bookkeeper.util.MathUtils'
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/collections/GrowableMpScArrayConsumerBlockingQueue.java`
#### Snippet
```java
    @SuppressWarnings("unchecked")
    public GrowableMpScArrayConsumerBlockingQueue(int initialCapacity) {
        int capacity = MathUtils.findNextPositivePowerOfTwo(initialCapacity);
        data = (T[]) new Object[capacity];
    }
```

## RuleId[id=JavaLangInvokeHandleSignature]
### JavaLangInvokeHandleSignature
Cannot resolve method 'onSpinWait'
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/collections/BusyWait.java`
#### Snippet
```java
        MethodHandle handle = null;
        try {
            handle = MethodHandles.lookup().findStatic(Thread.class, "onSpinWait", MethodType.methodType(void.class));
        } catch (Throwable t) {
            // Ignore
```

## RuleId[id=UnnecessaryStringEscape]
### UnnecessaryStringEscape
`\'` is unnecessarily escaped
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tls/BookieAuthZFactory.java`
#### Snippet
```java

        if (allowedRoles == null || allowedRoles.length == 0) {
            throw new RuntimeException("Configuration option \'bookieAuthProviderFactoryClass\' is set to"
                    + " \'BookieAuthZFactory\' but no roles set for configuration field \'authorizedRoles\'.");
        }
```

### UnnecessaryStringEscape
`\'` is unnecessarily escaped
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tls/BookieAuthZFactory.java`
#### Snippet
```java

        if (allowedRoles == null || allowedRoles.length == 0) {
            throw new RuntimeException("Configuration option \'bookieAuthProviderFactoryClass\' is set to"
                    + " \'BookieAuthZFactory\' but no roles set for configuration field \'authorizedRoles\'.");
        }
```

### UnnecessaryStringEscape
`\'` is unnecessarily escaped
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tls/BookieAuthZFactory.java`
#### Snippet
```java
        if (allowedRoles == null || allowedRoles.length == 0) {
            throw new RuntimeException("Configuration option \'bookieAuthProviderFactoryClass\' is set to"
                    + " \'BookieAuthZFactory\' but no roles set for configuration field \'authorizedRoles\'.");
        }

```

### UnnecessaryStringEscape
`\'` is unnecessarily escaped
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tls/BookieAuthZFactory.java`
#### Snippet
```java
        if (allowedRoles == null || allowedRoles.length == 0) {
            throw new RuntimeException("Configuration option \'bookieAuthProviderFactoryClass\' is set to"
                    + " \'BookieAuthZFactory\' but no roles set for configuration field \'authorizedRoles\'.");
        }

```

### UnnecessaryStringEscape
`\'` is unnecessarily escaped
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tls/BookieAuthZFactory.java`
#### Snippet
```java
        if (allowedRoles == null || allowedRoles.length == 0) {
            throw new RuntimeException("Configuration option \'bookieAuthProviderFactoryClass\' is set to"
                    + " \'BookieAuthZFactory\' but no roles set for configuration field \'authorizedRoles\'.");
        }

```

### UnnecessaryStringEscape
`\'` is unnecessarily escaped
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tls/BookieAuthZFactory.java`
#### Snippet
```java
        if (allowedRoles == null || allowedRoles.length == 0) {
            throw new RuntimeException("Configuration option \'bookieAuthProviderFactoryClass\' is set to"
                    + " \'BookieAuthZFactory\' but no roles set for configuration field \'authorizedRoles\'.");
        }

```

### UnnecessaryStringEscape
`\'` is unnecessarily escaped
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tls/BookieAuthZFactory.java`
#### Snippet
```java
        for (String allowedRole : allowedRoles) {
            if (Strings.isNullOrEmpty(allowedRole)) {
                throw new RuntimeException("Configuration option \'bookieAuthProviderFactoryClass\' is set to"
                        + " \'BookieAuthZFactory\' but no roles set for configuration field \'authorizedRoles\'.");
            }
```

### UnnecessaryStringEscape
`\'` is unnecessarily escaped
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tls/BookieAuthZFactory.java`
#### Snippet
```java
        for (String allowedRole : allowedRoles) {
            if (Strings.isNullOrEmpty(allowedRole)) {
                throw new RuntimeException("Configuration option \'bookieAuthProviderFactoryClass\' is set to"
                        + " \'BookieAuthZFactory\' but no roles set for configuration field \'authorizedRoles\'.");
            }
```

### UnnecessaryStringEscape
`\'` is unnecessarily escaped
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tls/BookieAuthZFactory.java`
#### Snippet
```java
            if (Strings.isNullOrEmpty(allowedRole)) {
                throw new RuntimeException("Configuration option \'bookieAuthProviderFactoryClass\' is set to"
                        + " \'BookieAuthZFactory\' but no roles set for configuration field \'authorizedRoles\'.");
            }
        }
```

### UnnecessaryStringEscape
`\'` is unnecessarily escaped
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tls/BookieAuthZFactory.java`
#### Snippet
```java
            if (Strings.isNullOrEmpty(allowedRole)) {
                throw new RuntimeException("Configuration option \'bookieAuthProviderFactoryClass\' is set to"
                        + " \'BookieAuthZFactory\' but no roles set for configuration field \'authorizedRoles\'.");
            }
        }
```

### UnnecessaryStringEscape
`\'` is unnecessarily escaped
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tls/BookieAuthZFactory.java`
#### Snippet
```java
            if (Strings.isNullOrEmpty(allowedRole)) {
                throw new RuntimeException("Configuration option \'bookieAuthProviderFactoryClass\' is set to"
                        + " \'BookieAuthZFactory\' but no roles set for configuration field \'authorizedRoles\'.");
            }
        }
```

### UnnecessaryStringEscape
`\'` is unnecessarily escaped
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tls/BookieAuthZFactory.java`
#### Snippet
```java
            if (Strings.isNullOrEmpty(allowedRole)) {
                throw new RuntimeException("Configuration option \'bookieAuthProviderFactoryClass\' is set to"
                        + " \'BookieAuthZFactory\' but no roles set for configuration field \'authorizedRoles\'.");
            }
        }
```

## RuleId[id=ObsoleteCollection]
### ObsoleteCollection
Obsolete collection type `Vector` used
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/DNS.java`
#### Snippet
```java
            throws UnknownHostException {
        String[] ips = getIPs(strInterface);
        Vector<String> hosts = new Vector<String>();
        for (int ctr = 0; ctr < ips.length; ctr++) {
            try {
```

### ObsoleteCollection
Obsolete collection type `Vector` used
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/DNS.java`
#### Snippet
```java
            throws UnknownHostException {
        String[] ips = getIPs(strInterface);
        Vector<String> hosts = new Vector<String>();
        for (int ctr = 0; ctr < ips.length; ctr++) {
            try {
```

## RuleId[id=StaticPseudoFunctionalStyleMethod]
### StaticPseudoFunctionalStyleMethod
Pseudo functional style code
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/kv/TableStoreUtils.java`
#### Snippet
```java
                .setRoutingHeader(routingHeader)
                .build())
            .addAllKvs(Lists.transform(result.kvs(), kv -> newKeyValue(rKey, kv)))
            .setMore(result.more())
            .build();
```

### StaticPseudoFunctionalStyleMethod
Pseudo functional style code
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/kv/TableStoreUtils.java`
#### Snippet
```java
                .build())
            .setDeleted(result.numDeleted())
            .addAllPrevKvs(Lists.transform(result.prevKvs(), kv -> newKeyValue(rKey, kv)))
            .build();
    }
```

### StaticPseudoFunctionalStyleMethod
Pseudo functional style code
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/kv/TableStoreUtils.java`
#### Snippet
```java
                .build())
            .setSucceeded(txnResult.isSuccess())
            .addAllResponses(Lists.transform(txnResult.results(), result -> processTxnResult(
                routingHeader, result)))
            .build();
```

### StaticPseudoFunctionalStyleMethod
Pseudo functional style code
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/LedgerMetadataIndex.java`
#### Snippet
```java
    public Iterable<Long> getActiveLedgersInRange(final long firstLedgerId, final long lastLedgerId)
            throws IOException {
        return Iterables.filter(ledgers.keys(), new Predicate<Long>() {
            @Override
            public boolean apply(Long ledgerId) {
```

### StaticPseudoFunctionalStyleMethod
Pseudo functional style code
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java`
#### Snippet
```java
        } else {
            clientCtx.getClientStats().getReadOpLogger().registerSuccessfulEvent(latencyNanos, TimeUnit.NANOSECONDS);
            future.complete(LedgerEntriesImpl.create(Lists.transform(seq, input -> input.entryImpl)));
        }
    }
```

### StaticPseudoFunctionalStyleMethod
Pseudo functional style code
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/component/ServerLifecycleComponent.java`
#### Snippet
```java
            componentClasses.add(ReflectionUtils.forName(componentClsName, ServerLifecycleComponent.class));
        }
        return Lists.transform(componentClasses, cls -> newComponent(cls, conf, statsLogger));

    }
```

### StaticPseudoFunctionalStyleMethod
Pseudo functional style code
in `stream/clients/java/kv/src/main/java/org/apache/bookkeeper/clients/impl/kv/KvUtils.java`
#### Snippet
```java
    public static List<org.apache.bookkeeper.api.kv.result.KeyValue<ByteBuf, ByteBuf>> fromProtoKeyValues(
        List<KeyValue> kvs, KeyValueFactory<ByteBuf, ByteBuf> kvFactory) {
        return Lists.transform(kvs, kv -> fromProtoKeyValue(kv, kvFactory));
    }

```

### StaticPseudoFunctionalStyleMethod
Pseudo functional style code
in `stream/common/src/main/java/org/apache/bookkeeper/common/resolver/ServiceNameResolverProvider.java`
#### Snippet
```java
                    hostList.add(host);
                }
                List<URI> hostUris = Lists.transform(
                    hostList,
                    new Function<String, URI>() {
```

## RuleId[id=RedundantArrayCreation]
### RedundantArrayCreation
Redundant array creation for calling varargs method
in `stream/clients/java/base/src/main/java/org/apache/bookkeeper/clients/impl/container/StorageContainerChannel.java`
#### Snippet
```java
    private void handleFetchStorageContainerInfoFailure(Throwable cause) {
        log.info("Failed to fetch info of storage container ({}) - '{}'. Retry in {} ms ...",
            new Object[]{scId, cause.getMessage(), ClientConstants.DEFAULT_BACKOFF_START_MS});
        executor.schedule(() -> {
            fetchStorageContainerInfo();
```

### RedundantArrayCreation
Redundant array creation for calling varargs method
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/MSLedgerManagerFactory.java`
#### Snippet
```java

            if (LOG.isDebugEnabled()) {
                LOG.debug("Writing ledger {} metadata, version {}", new Object[] { ledgerId, currentVersion });
            }

```

### RedundantArrayCreation
Redundant array creation for calling varargs method
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/ReadUtils.java`
#### Snippet
```java
        if (lastAddConfirmed < 0) {
            if (LOG.isDebugEnabled()) {
                LOG.debug("Log segment {} is empty for {}.", new Object[] { metadata, streamName });
            }
            promise.complete(null);
```

### RedundantArrayCreation
Redundant array creation for calling varargs method
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogWriteHandler.java`
#### Snippet
```java
            // before completing current inprogress one
            LOG.info("Try storing max sequence number {} in completing {}.",
                    new Object[] { logSegmentSeqNo, inprogressLogSegment.getZkPath() });
        } else {
            LOG.warn("Unexpected max ledger sequence number {} found while completing log segment {} for {}",
```

### RedundantArrayCreation
Redundant array creation for calling varargs method
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/RocksdbRestoreTask.java`
#### Snippet
```java
        } catch (IOException ioe) {
            log.error("Failed to restore checkpoint {} to local directory {}",
                new Object[] { checkpointId, checkpointedDir, ioe });
            throw new StateStoreException(
                "Failed to restore checkpoint " + checkpointId + " to local directory " + checkpointedDir,
```

### RedundantArrayCreation
Redundant array creation for calling varargs method
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/RocksdbCheckpointTask.java`
#### Snippet
```java
            return checkpointId;
        } catch (IOException ioe) {
            log.error("Failed to checkpoint db {} to dir {}", new Object[] { dbName, tempDir, ioe });
            throw new StateStoreException(
                "Failed to checkpoint db " + dbName + " to dir " + tempDir,
```

## RuleId[id=DuplicateBranchesInSwitch]
### DuplicateBranchesInSwitch
Branch in 'switch' is a duplicate of the default branch
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/LongZkLedgerIdGenerator.java`
#### Snippet
```java
            return true;
        case NOT_PRESENT:
            return false;
        default:
            return false;
```

### DuplicateBranchesInSwitch
Branch in 'switch' is a duplicate of the default branch
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/http/BKHttpServiceProvider.java`
#### Snippet
```java
                return new HeartbeatService();
            case SERVER_CONFIG:
                return new ConfigurationService(configuration);
            case METRICS:
                return new MetricsService(configuration, statsProvider);
```

### DuplicateBranchesInSwitch
Duplicate branch in 'switch'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/zk/LimitedPermitManager.java`
#### Snippet
```java
                break;
            case Expired:
                forceSetAllowPermits(false);
                break;
            default:
```

### DuplicateBranchesInSwitch
Branch in 'switch' is a duplicate of the default branch
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/lock/ZKSessionLock.java`
#### Snippet
```java
            switch (toState) {
                case INIT:
                    return false;
                case PREPARING:
                    return inState(State.INIT);
```

### DuplicateBranchesInSwitch
Duplicate branch in 'switch'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/lock/ZKSessionLock.java`
#### Snippet
```java
                    return inState(State.PREPARED);
                case WAITING:
                    return inState(State.PREPARED);
                case EXPIRED:
                    return isTryingOrClaimed();
```

### DuplicateBranchesInSwitch
Branch in 'switch' is a duplicate of the default branch
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/lock/ZKSessionLock.java`
#### Snippet
```java
                switch (event.getState()) {
                    case SyncConnected:
                        break;
                    case Expired:
                        LOG.info("Session {} is expired for lock {} at {} : watcher epoch {}, lock epoch {}.",
```

### DuplicateBranchesInSwitch
Branch in 'switch' is a duplicate of the default branch
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/mvcc/MVCCCommandProcessor.java`
#### Snippet
```java
        switch (command.getReqCase()) {
            case NOP_REQ:
                return;
            case PUT_REQ:
                applyPutCommand(txid, command, store);
```

## RuleId[id=OctalLiteral]
### OctalLiteral
Octal integer `00644`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectWriter.java`
#### Snippet
```java
            fd = nativeIO.open(filename,
                               NativeIO.O_CREAT | NativeIO.O_WRONLY | NativeIO.O_DIRECT,
                               00644);
            checkState(fd >= 0, "Open should have thrown exception, fd is invalid : %d", fd);
        } catch (NativeIOException ne) {
```

### OctalLiteral
Octal integer `00755`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectReader.java`
#### Snippet
```java
            fd = nativeIO.open(filename,
                               NativeIO.O_RDONLY | NativeIO.O_DIRECT,
                               00755);
            checkState(fd >= 0, "Open should throw exception on negative return (%d)", fd);
        } catch (NativeIOException ne) {
```

## RuleId[id=DuplicateExpressions]
### DuplicateExpressions
Multiple occurrences of `i + 1 == chars.length || chars[i + 1] == '/'`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/util/DLUtils.java`
#### Snippet
```java

                    if (c == '.' && lastc == '.') {
                        if (chars[i - 2] == '/' && (i + 1 == chars.length || chars[i + 1] == '/')) {
                            reason = "relative paths not allowed @" + i;
                            break;
```

### DuplicateExpressions
Multiple occurrences of `i + 1 == chars.length || chars[i + 1] == '/'`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/util/DLUtils.java`
#### Snippet
```java
                        }
                    } else if (c == '.') {
                        if (chars[i - 1] == '/' && (i + 1 == chars.length || chars[i + 1] == '/')) {
                            reason = "relative paths not allowed @" + i;
                            break;
```

## RuleId[id=StringBufferReplaceableByString]
### StringBufferReplaceableByString
`StringBuilder` can be replaced with 'String'
in `stats/bookkeeper-stats-api/src/main/java/org/apache/bookkeeper/stats/StatsLogger.java`
#### Snippet
```java
    default StatsLogger scopeLabel(String labelName, String labelValue) {
        // Provide default implementation for backward compatibility
        return scope(new StringBuilder()
                .append(labelName)
                .append('_')
```

### StringBufferReplaceableByString
`StringBuilder sb` can be replaced with 'String'
in `stream/proto/src/main/java/org/apache/bookkeeper/stream/protocol/RangeId.java`
#### Snippet
```java
    @Override
    public String toString() {
        StringBuilder sb = new StringBuilder();
        sb.append("range(")
            .append(streamId)
```

### StringBufferReplaceableByString
`StringBuilder` can be replaced with 'String'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/LedgerLayout.java`
#### Snippet
```java
    public byte[] serialize() throws IOException {
        String s =
          new StringBuilder().append(layoutFormatVersion).append(lSplitter)
              .append(managerFactoryClass).append(splitter).append(managerVersion).toString();

```

### StringBufferReplaceableByString
`StringBuilder sb` can be replaced with 'String'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/FlatLedgerManager.java`
#### Snippet
```java
    @Override
    public String getLedgerPath(long ledgerId) {
        StringBuilder sb = new StringBuilder();
        sb.append(ledgerPrefix)
          .append(StringUtils.getZKStringId(ledgerId));
```

### StringBufferReplaceableByString
`StringBuilder sb` can be replaced with 'String'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/StringUtils.java`
#### Snippet
```java
        String ledgerIdStr = getZKStringId(ledgerId);
        // do 2-4-4 split
        StringBuilder sb = new StringBuilder();
        sb.append("/")
          .append(ledgerIdStr, 0, 2).append("/")
```

### StringBufferReplaceableByString
`StringBuilder sb` can be replaced with 'String'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/StringUtils.java`
#### Snippet
```java
        String ledgerIdStr = getZKStringIdForLongHierarchical(ledgerId);
        // do 3-4-4-4-4 split
        StringBuilder sb = new StringBuilder();
        sb.append("/")
          .append(ledgerIdStr, 0, 3).append("/")
```

### StringBufferReplaceableByString
`StringBuilder builder` can be replaced with 'String'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieStatus.java`
#### Snippet
```java
    @Override
    public String toString() {
        StringBuilder builder = new StringBuilder();
        builder.append(CURRENT_STATUS_LAYOUT_VERSION);
        builder.append(",");
```

### StringBufferReplaceableByString
`StringBuilder b` can be replaced with 'String'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Cookie.java`
#### Snippet
```java

    private String toStringVersion3() {
        StringBuilder b = new StringBuilder();
        b.append(CURRENT_COOKIE_LAYOUT_VERSION).append("\n")
            .append(bookieId).append("\n")
```

### StringBufferReplaceableByString
`StringBuilder` can be replaced with 'String'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryLocation.java`
#### Snippet
```java
    @Override
    public String toString() {
        return new StringBuilder().append("EntryLocation{")
            .append("ledger=").append(ledger)
            .append(",entry=").append(entry)
```

### StringBufferReplaceableByString
`StringBuilder sb` can be replaced with 'String'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LedgerEntryPage.java`
#### Snippet
```java
    @Override
    public String toString() {
        StringBuilder sb = new StringBuilder();
        sb.append(getLedger());
        sb.append('@');
```

### StringBufferReplaceableByString
`StringBuilder sb` can be replaced with 'String'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LogMark.java`
#### Snippet
```java
    @Override
    public synchronized String toString() {
        StringBuilder sb = new StringBuilder();

        sb.append("LogMark: logFileId - ").append(logFileId)
```

### StringBufferReplaceableByString
`StringBuilder sb` can be replaced with 'String'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryLogMetadata.java`
#### Snippet
```java
    @Override
    public String toString() {
        StringBuilder sb = new StringBuilder();
        sb.append("{totalSize = ").append(totalSize).append(", remainingSize = ").append(remainingSize)
                .append(", ledgersMap = ").append(ledgersMap.toString()).append("}");
```

### StringBufferReplaceableByString
`StringBuilder sb` can be replaced with 'String'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/IndexPersistenceMgr.java`
#### Snippet
```java
        int parent = (int) (ledgerId & 0xff);
        int grandParent = (int) ((ledgerId & 0xff00) >> 8);
        StringBuilder sb = new StringBuilder();
        sb.append(Integer.toHexString(grandParent));
        sb.append('/');
```

### StringBufferReplaceableByString
`StringBuilder sb` can be replaced with 'String'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/MSLedgerManagerFactory.java`
#### Snippet
```java

    static String rangeToString(Long firstLedger, boolean firstInclusive, Long lastLedger, boolean lastInclusive) {
        StringBuilder sb = new StringBuilder();
        sb.append(firstInclusive ? "[ " : "( ").append(firstLedger).append(" ~ ").append(lastLedger)
                .append(lastInclusive ? " ]" : " )");
```

### StringBufferReplaceableByString
`StringBuilder sb` can be replaced with 'String'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
    @Override
    public String toString() {
        StringBuilder sb = new StringBuilder();
        sb.append("PendingAddOp(lid:").append(lh.ledgerId)
          .append(", eid:").append(entryId).append(", completed:")
```

### StringBufferReplaceableByString
`StringBuilder sb` can be replaced with 'String'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/EntryPosition.java`
#### Snippet
```java
    @Override
    public String toString() {
        StringBuilder sb = new StringBuilder();
        sb.append("(").append(lssn).append(", ").append(entryId).append(")");
        return sb.toString();
```

### StringBufferReplaceableByString
`StringBuilder sb` can be replaced with 'String'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/QuorumConfig.java`
#### Snippet
```java
    @Override
    public String toString() {
        StringBuilder sb = new StringBuilder();
        sb.append("QuorumConfig[ensemble=")
          .append(ensembleSize).append(", write quorum=")
```

### StringBufferReplaceableByString
`StringBuilder sb` can be replaced with 'String'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/acl/ZKAccessControl.java`
#### Snippet
```java
    @Override
    public String toString() {
        StringBuilder sb = new StringBuilder();
        sb.append("entry(path=").append(zkPath).append(", acl=")
                .append(accessControlEntry).append(")");
```

### StringBufferReplaceableByString
`StringBuilder sb` can be replaced with 'String'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/injector/AsyncRandomFailureInjector.java`
#### Snippet
```java
    @Override
    public String toString() {
        StringBuilder sb = new StringBuilder();
        sb.append("FailureInjector[");
        sb.append("errors=(").append(simulateErrors).append(", pct=")
```

### StringBufferReplaceableByString
`StringBuilder sb` can be replaced with 'String'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/namespace/NamespaceDriverManager.java`
#### Snippet
```java
        @Override
        public String toString() {
            StringBuilder sb = new StringBuilder();
            sb.append("driver[")
                    .append(driverClassName)
```

### StringBufferReplaceableByString
`StringBuilder sb` can be replaced with 'String'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/lock/ZKSessionLock.java`
#### Snippet
```java
            @Override
            public String getActionName() {
                StringBuilder sb = new StringBuilder();
                sb.append("watchLockOwner(myNode=").append(myNode).append(", siblingNode=")
                        .append(siblingNode).append(", ownerNode=").append(ownerNode).append(")");
```

### StringBufferReplaceableByString
`StringBuilder sb` can be replaced with 'String'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/lock/ZKSessionLock.java`
#### Snippet
```java
            throws UnsupportedEncodingException {
        // member_<clientid>_s<owner_session>_
        StringBuilder sb = new StringBuilder();
        sb.append(lockPath).append(LOCK_PATH_PREFIX).append(URLEncoder.encode(clientId, UTF_8.name())).
                append(LOCK_PART_SEP).append("s").append(String.format("%10d", sessionOwner)).append(LOCK_PART_SEP);
```

### StringBufferReplaceableByString
`StringBuilder sb` can be replaced with 'String'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/lock/ZKSessionLock.java`
#### Snippet
```java
                                @Override
                                public String getActionName() {
                                    StringBuilder sb = new StringBuilder();
                                    sb.append("postWatchLockOwner(myNode=").append(myNode).append(", siblingNode=")
                                            .append(siblingNode).append(", ownerNode=").append(ownerNode).append(")");
```

## RuleId[id=NonShortCircuitBoolean]
### NonShortCircuitBoolean
Non-short-circuit boolean expression `updates.containsKey(key) | updatesToMerge.containsKey(key) | snaps...`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/SnapshotMap.java`
#### Snippet
```java
        this.lock.readLock().lock();
        try {
            return updates.containsKey(key)
                 | updatesToMerge.containsKey(key)
                 | snapshot.containsKey(key);
        } finally {
            this.lock.readLock().unlock();
```

### NonShortCircuitBoolean
Non-short-circuit boolean expression `hasCookieUpdatedInDirs &= verifyCookie(newCookie, dir)`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/cookie/AdminCommand.java`
#### Snippet
```java
                boolean hasCookieUpdatedInDirs = verifyCookie(newCookie, journalDirectories[0]);
                for (File dir : ledgerDirectories) {
                    hasCookieUpdatedInDirs &= verifyCookie(newCookie, dir);
                }
                if (indexDirectories != ledgerDirectories) {
```

### NonShortCircuitBoolean
Non-short-circuit boolean expression `hasCookieUpdatedInDirs &= verifyCookie(newCookie, dir)`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/cookie/AdminCommand.java`
#### Snippet
```java
                if (indexDirectories != ledgerDirectories) {
                    for (File dir : indexDirectories) {
                        hasCookieUpdatedInDirs &= verifyCookie(newCookie, dir);
                    }
                }
```

## RuleId[id=UnnecessaryReturn]
### UnnecessaryReturn
`return` is unnecessary as the last statement in a 'void' method
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/sc/ZkStorageContainerManager.java`
#### Snippet
```java

            if (oldSad.equals(newSad)) {
                return;
            } else {
                log.info("Server assignment is change for {}:\nold assignment: {}\nnew assignment: {}",
```

### UnnecessaryReturn
`return` is unnecessary as the last statement in a 'void' method
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/LongHierarchicalLedgerManager.java`
#### Snippet
```java
            if ((level == 0) && !isLedgerParentNode(lNode)) {
                cb.processResult(successRc, null, context);
                return;
            } else if (level < 3) {
                asyncProcessLevelNodes(nodePath,
```

### UnnecessaryReturn
`return` is unnecessary as the last statement in a 'void' method
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/ZkLedgerUnderreplicationManager.java`
#### Snippet
```java
                        + "since DISABLE_NODE ZNode is deleted");
                cb.operationComplete(0, null);
                return;
            }
        } catch (KeeperException ke) {
```

### UnnecessaryReturn
`return` is unnecessary as the last statement in a 'void' method
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/ZkLedgerUnderreplicationManager.java`
#### Snippet
```java
            if (null == zkc.exists(lostBookieRecoveryDelayZnode, w)) {
                cb.operationComplete(0, null);
                return;
            }
        } catch (KeeperException ke) {
```

### UnnecessaryReturn
`return` is unnecessary as the last statement in a 'void' method
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/AuthHandler.java`
#### Snippet
```java
                    channel.writeAndFlush(builder.build());
                    channel.close();
                    return;
                } else {
                    AuthMessage message = AuthMessage.newBuilder().setAuthPluginName(pluginName)
```

### UnnecessaryReturn
`return` is unnecessary as the last statement in a 'void' method
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
            errorOut(completionKey);
            ReferenceCountUtil.release(toSend);
            return;
        } else {
            // addEntry times out on backpressure
```

### UnnecessaryReturn
`return` is unnecessary as the last statement in a 'void' method
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LocalBookieEnsemblePlacementPolicy.java`
#### Snippet
```java
    @Override
    public void updateBookieInfo(Map<BookieId, BookieInfo> bookieToFreeSpaceMap) {
        return;
    }

```

### UnnecessaryReturn
`return` is unnecessary as the last statement in a 'void' method
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LocalBookieEnsemblePlacementPolicy.java`
#### Snippet
```java
    @Override
    public void registerSlowBookie(BookieId bookieSocketAddress, long entryId) {
        return;
    }

```

### UnnecessaryReturn
`return` is unnecessary as the last statement in a 'void' method
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LedgerStorage.java`
#### Snippet
```java

    default void resumeMinorGC() {
        return;
    }

```

### UnnecessaryReturn
`return` is unnecessary as the last statement in a 'void' method
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LedgerStorage.java`
#### Snippet
```java
     */
    default void forceGC(Boolean forceMajor, Boolean forceMinor) {
        return;
    }

```

### UnnecessaryReturn
`return` is unnecessary as the last statement in a 'void' method
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LedgerStorage.java`
#### Snippet
```java

    default void entryLocationCompact() {
        return;
    }

```

### UnnecessaryReturn
`return` is unnecessary as the last statement in a 'void' method
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LedgerStorage.java`
#### Snippet
```java

    default void suspendMinorGC() {
        return;
    }

```

### UnnecessaryReturn
`return` is unnecessary as the last statement in a 'void' method
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LedgerStorage.java`
#### Snippet
```java

    default void resumeMajorGC() {
        return;
    }

```

### UnnecessaryReturn
`return` is unnecessary as the last statement in a 'void' method
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LedgerStorage.java`
#### Snippet
```java
     */
    default void forceGC() {
        return;
    }

```

### UnnecessaryReturn
`return` is unnecessary as the last statement in a 'void' method
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LedgerStorage.java`
#### Snippet
```java

    default void entryLocationCompact(List<String> locations) {
        return;
    }

```

### UnnecessaryReturn
`return` is unnecessary as the last statement in a 'void' method
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LedgerStorage.java`
#### Snippet
```java

    default void suspendMajorGC() {
        return;
    }

```

### UnnecessaryReturn
`return` is unnecessary as the last statement in a 'void' method
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieStateManager.java`
#### Snippet
```java
                    + " Shutting down", e);
            shutdownHandler.shutdown(ExitCode.BOOKIE_EXCEPTION);
            return;
        }
    }
```

### UnnecessaryReturn
`return` is unnecessary as the last statement in a 'void' method
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieStateManager.java`
#### Snippet
```java
            // already see the bookie in writable list. so just log the exception
            LOG.warn("Failed to delete bookie readonly state in zookeeper : ", e);
            return;
        }
    }
```

### UnnecessaryReturn
`return` is unnecessary as the last statement in a 'void' method
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/IndexPersistenceMgr.java`
#### Snippet
```java
            // ledger has been deleted
            LOG.info("No ledger {} found when flushing header.", ledger);
            return;
        } finally {
            if (null != fi) {
```

### UnnecessaryReturn
`return` is unnecessary as the last statement in a 'void' method
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/DefaultEnsemblePlacementPolicy.java`
#### Snippet
```java
    @Override
    public void registerSlowBookie(BookieId bookieSocketAddress, long entryId) {
        return;
    }

```

### UnnecessaryReturn
`return` is unnecessary as the last statement in a 'void' method
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadOnlyLedgerHandle.java`
#### Snippet
```java

                handleUnrecoverableErrorDuringAdd(e.getCode());
                return;
            }
        }
```

### UnnecessaryReturn
`return` is unnecessary as the last statement in a 'void' method
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerRecoveryOp.java`
#### Snippet
```java
                    entry.getEntryId(), lh.getId(), readDone);
        }
        return;
    }

```

### UnnecessaryReturn
`return` is unnecessary as the last statement in a 'void' method
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/discover/ZKRegistrationClient.java`
#### Snippet
```java
                    promise.completeExceptionally(KeeperException.create(KeeperException.Code.get(rc), path)
                            .initCause(ex));
                    return;
                }
            } else if (KeeperException.Code.NONODE.intValue() == rc) {
```

### UnnecessaryReturn
`return` is unnecessary as the last statement in a 'void' method
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/discover/ZKRegistrationClient.java`
#### Snippet
```java
                            promise.completeExceptionally(KeeperException.create(KeeperException.Code.get(rc2), path2)
                                    .initCause(ex));
                            return;
                        }
                    } else {
```

### UnnecessaryReturn
`return` is unnecessary as the last statement in a 'void' method
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdLayoutManager.java`
#### Snippet
```java
                log.debug("Successfully delete layout '{}'", layoutKey.toString(StandardCharsets.UTF_8));
            }
            return;
        } else {
            throw new IOException("No ledger layout is found under '" + layoutKey.toString(StandardCharsets.UTF_8)
```

### UnnecessaryReturn
`return` is unnecessary as the last statement in a 'void' method
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdLayoutManager.java`
#### Snippet
```java
        // key doesn't exist and we created the key
        if (!response.isSucceeded()) {
            return;
        // key exists and we retrieved the key
        } else {
```

### UnnecessaryReturn
`return` is unnecessary as the last statement in a 'void' method
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdLedgerManager.java`
#### Snippet
```java
        ValueStream<LedgerMetadata> lmStream = watchers.get(ledgerId);
        if (null == lmStream) {
            return;
        } else {
            lmStream.unwatch(lmConsumer).thenAccept(noConsumers -> {
```

### UnnecessaryReturn
`return` is unnecessary as the last statement in a 'void' method
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdLedgerManager.java`
#### Snippet
```java
        LedgerMetadataConsumer oldConsumer = listeners.putIfAbsent(listener, lmConsumer);
        if (null != oldConsumer) {
            return;
        } else {
            lmStream.readAndWatch(lmConsumer)
```

### UnnecessaryReturn
`return` is unnecessary as the last statement in a 'void' method
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdLedgerManager.java`
#### Snippet
```java
                        log.error("Could not parse ledger metadata for ledger : {}", ledgerId, ioe);
                        promise.completeExceptionally(new BKException.MetaStoreException());
                        return;
                    }
                } else {
```

### UnnecessaryReturn
`return` is unnecessary as the last statement in a 'void' method
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAsyncLogReader.java`
#### Snippet
```java
                            && readAheadReader.isReaderIdle(idleErrorThresholdMillis, TimeUnit.MILLISECONDS))) {
                        markReaderAsIdle();
                        return;
                    } else if (lastProcessTime.elapsed(TimeUnit.MILLISECONDS) > idleErrorThresholdMillis) {
                        markReaderAsIdle();
```

### UnnecessaryReturn
`return` is unnecessary as the last statement in a 'void' method
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAsyncLogReader.java`
#### Snippet
```java
                } catch (IOException e) {
                    setLastException(e);
                    return;
                }
            }, period, period, TimeUnit.MILLISECONDS);
```

### UnnecessaryReturn
`return` is unnecessary as the last statement in a 'void' method
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogWriteHandler.java`
#### Snippet
```java
                    removeLogSegmentFromCache(segmentMetadata.getZNodeName());
                    promise.complete(segmentMetadata);
                    return;
                } else {
                    LOG.error("Couldn't purge {} for {}: with error {}",
```

### UnnecessaryReturn
`return` is unnecessary as the last statement in a 'void' method
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogHandler.java`
#### Snippet
```java
                                if (1 == numFailures.incrementAndGet()) {
                                    readResult.completeExceptionally(cause);
                                    return;
                                }
                            }
```

### UnnecessaryReturn
`return` is unnecessary as the last statement in a 'void' method
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/logsegment/BKLogSegmentEntryReader.java`
#### Snippet
```java
            if (isNotBeyondLastAddConfirmed(cacheEntry.getEntryId())) {
                issueSimpleRead(cacheEntry);
                return;
            } else {
                // Reach the end of stream
```

### UnnecessaryReturn
`return` is unnecessary as the last statement in a 'void' method
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/lock/ZKSessionLockFactory.java`
#### Snippet
```java
                // if the creation is interrupted, throw the exception without retrie.
                createPromise.completeExceptionally(dlie);
                return;
            } catch (IOException e) {
                if (numRetries.getAndDecrement() < 0) {
```

### UnnecessaryReturn
`return` is unnecessary as the last statement in a 'void' method
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/metadata/ZKLogStreamMetadataStore.java`
#### Snippet
```java
                public void onFailure(Throwable cause) {
                    promise.completeExceptionally(cause);
                    return;
                }
            });
```

### UnnecessaryReturn
`return` is unnecessary as the last statement in a 'void' method
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/util/Utils.java`
#### Snippet
```java
                promise.completeExceptionally(
                        KeeperException.create(KeeperException.Code.get(rc)));
                return;
            }
        }, null);
```

### UnnecessaryReturn
`return` is unnecessary as the last statement in a 'void' method
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/util/Utils.java`
#### Snippet
```java
                promise.completeExceptionally(
                        KeeperException.create(KeeperException.Code.get(rc)));
                return;
            }
        }, null);
```

### UnnecessaryReturn
`return` is unnecessary as the last statement in a 'void' method
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/KVCommandProcessor.java`
#### Snippet
```java
                return;
            default:
                return;
        }
    }
```

### UnnecessaryReturn
`return` is unnecessary as the last statement in a 'void' method
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/mvcc/MVCCCommandProcessor.java`
#### Snippet
```java
                return;
            default:
                return;
        }
    }
```

### UnnecessaryReturn
`return` is unnecessary as the last statement in a 'void' method
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/journal/AbstractStateStoreWithJournal.java`
#### Snippet
```java
                    log.error(msg);
                    FutureUtils.completeExceptionally(future, new InvalidStateStoreException(msg));
                    return;
                }
            }
```

## RuleId[id=ManualMinMaxCalculation]
### ManualMinMaxCalculation
Can be replaced with 'Math.max()' call
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BKStats.java`
#### Snippet
```java
        public OpStats diff(OpStats base) {
            OpStats diff = new OpStats();
            diff.maxLatency = this.maxLatency > base.maxLatency ? this.maxLatency : base.maxLatency;
            diff.minLatency = this.minLatency > base.minLatency ? base.minLatency : this.minLatency;
            diff.totalLatency = this.totalLatency - base.totalLatency;
```

### ManualMinMaxCalculation
Can be replaced with 'Math.min()' call
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BKStats.java`
#### Snippet
```java
            OpStats diff = new OpStats();
            diff.maxLatency = this.maxLatency > base.maxLatency ? this.maxLatency : base.maxLatency;
            diff.minLatency = this.minLatency > base.minLatency ? base.minLatency : this.minLatency;
            diff.totalLatency = this.totalLatency - base.totalLatency;
            diff.numSuccessOps = this.numSuccessOps - base.numSuccessOps;
```

### ManualMinMaxCalculation
Can be replaced with 'Math.min()' call
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ZoneawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
            throws BKNotEnoughBookiesException {
        int bookieToReplaceIndex = currentEnsemble.indexOf(bookieToReplace);
        int desiredNumZonesPerWriteQuorumForThisEnsemble = (writeQuorumSize < desiredNumZonesPerWriteQuorum)
                ? writeQuorumSize : desiredNumZonesPerWriteQuorum;
        List<BookieId> newEnsemble = new ArrayList<BookieId>(currentEnsemble);
        rwLock.readLock().lock();
```

### ManualMinMaxCalculation
Can be replaced with 'Math.min()' call
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
        }
        long start = Math.abs(opRand.nextLong() % lastEntryCompleted);
        long end = start + targetReadGroup > lastEntryCompleted ? lastEntryCompleted : start + targetReadGroup;
        System.out.format("Reading %d -> %d from ledger %d%n", start, end, ledger.ledgerID);
        LedgerInfo finalLedger = ledger;
```

### ManualMinMaxCalculation
Can be replaced with 'Math.max()' call
in `stream/distributedlog/io/dlfs/src/main/java/org/apache/distributedlog/fs/DLOutputStream.java`
#### Snippet
```java
        this.dlm = dlm;
        this.writer = writer;
        this.writePos = writer.getLastTxId() < 0L ? 0L : writer.getLastTxId();
        this.syncPos[0] = writePos;
    }
```

### ManualMinMaxCalculation
Can be replaced with 'Math.max()' call
in `stream/distributedlog/io/dlfs/src/main/java/org/apache/distributedlog/fs/DLFileSystem.java`
#### Snippet
```java
                ),
                statistics,
                writer.getLastTxId() < 0L ? 0L : writer.getLastTxId());
        } catch (LogNotFoundException le) {
            throw new FileNotFoundException(path.toString());
```

### ManualMinMaxCalculation
Can be replaced with 'Math.max()' call
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/dlog/DLOutputStream.java`
#### Snippet
```java
        this.dlm = dlm;
        this.writer = writer;
        this.writePos = writer.getLastTxId() < 0L ? 0L : writer.getLastTxId();
        this.syncPos[0] = writePos;
    }
```

## RuleId[id=AbstractClassNeverImplemented]
### AbstractClassNeverImplemented
Abstract class `SecurityProviderFactoryFactory` has no concrete subclass
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tls/SecurityProviderFactoryFactory.java`
#### Snippet
```java
 * A factory to manage security provider factories.
 */
public abstract class SecurityProviderFactoryFactory {
    private static final Logger LOG = LoggerFactory.getLogger(SecurityProviderFactoryFactory.class);

```

### AbstractClassNeverImplemented
Abstract class `AuthCallbacks` has no concrete subclass
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/auth/AuthCallbacks.java`
#### Snippet
```java
 * Callbacks for AuthProviders.
 */
public abstract class AuthCallbacks {

    /**
```

### AbstractClassNeverImplemented
Abstract class `CertUtils` has no concrete subclass
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/CertUtils.java`
#### Snippet
```java
 * Certificate parsing utilities.
 */
public abstract class CertUtils {

    // OU values
```

### AbstractClassNeverImplemented
Abstract class `AbstractStatelessLongHash` has no concrete subclass
in `circe-checksum/src/main/java/com/scurrilous/circe/impl/AbstractStatelessLongHash.java`
#### Snippet
```java
 * functions.
 */
public abstract class AbstractStatelessLongHash implements StatelessLongHash {

    @Override
```

### AbstractClassNeverImplemented
Abstract class `Builder` has no concrete subclass
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/limiter/RateLimiter.java`
#### Snippet
```java
     * Builder for a rate limiter.
     */
    abstract class Builder {
        public abstract RateLimiter build();
    }
```

### AbstractClassNeverImplemented
Abstract class `PerBKCommand` has no concrete subclass
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
    }

    abstract static class PerBKCommand extends PerDLCommand {

        protected PerBKCommand(String name, String description) {
```

## RuleId[id=BoundedWildcard]
### BoundedWildcard
Can generalize to `? super OrderedScheduler`
in `stream/clients/java/base/src/main/java/org/apache/bookkeeper/clients/impl/internal/StorageServerClientManagerImpl.java`
#### Snippet
```java

    public StorageServerClientManagerImpl(StorageClientSettings settings,
                                          Resource<OrderedScheduler> schedulerResource,
                                          Function<Endpoint, StorageServerChannel> channelFactory) {
        this.schedulerResource = schedulerResource;
```

### BoundedWildcard
Can generalize to `? extends StorageServerChannel`
in `stream/clients/java/base/src/main/java/org/apache/bookkeeper/clients/impl/channel/StorageServerChannelManager.java`
#### Snippet
```java

    @VisibleForTesting
    public StorageServerChannelManager(Function<Endpoint, StorageServerChannel> channelFactory) {
        this.channels = new ConcurrentHashMap<>();
        this.lock = new ReentrantReadWriteLock();
```

### BoundedWildcard
Can generalize to `? extends ListenableFuture`
in `stream/clients/java/base/src/main/java/org/apache/bookkeeper/clients/utils/RetryUtils.java`
#### Snippet
```java
     * @return the result of the action
     */
    public <T> CompletableFuture<T> executeListenable(Supplier<ListenableFuture<T>> action) {
        return Retries.run(
            backoffPolicy.toBackoffs(),
```

### BoundedWildcard
Can generalize to `? extends ReqT`
in `stream/clients/java/base/src/main/java/org/apache/bookkeeper/clients/utils/RpcUtils.java`
#### Snippet
```java
        ServiceT service,
        CompletableFuture<T> result,
        CreateRequestFunc<ReqT> createRequestFunc,
        ProcessRequestFunc<ReqT, RespT, ServiceT> processRequestFunc,
        ProcessResponseFunc<RespT, T> processResponseFunc) {
```

### BoundedWildcard
Can generalize to `? super ReqT`
in `stream/clients/java/base/src/main/java/org/apache/bookkeeper/clients/utils/RpcUtils.java`
#### Snippet
```java
        CompletableFuture<T> result,
        CreateRequestFunc<ReqT> createRequestFunc,
        ProcessRequestFunc<ReqT, RespT, ServiceT> processRequestFunc,
        ProcessResponseFunc<RespT, T> processResponseFunc) {
        ReqT request = createRequestFunc.apply();
```

### BoundedWildcard
Can generalize to `? super RespT`
in `stream/clients/java/base/src/main/java/org/apache/bookkeeper/clients/utils/RpcUtils.java`
#### Snippet
```java
        CreateRequestFunc<ReqT> createRequestFunc,
        ProcessRequestFunc<ReqT, RespT, ServiceT> processRequestFunc,
        ProcessResponseFunc<RespT, T> processResponseFunc) {
        ReqT request = createRequestFunc.apply();
        ListenableFuture<RespT> resultFuture =
```

### BoundedWildcard
Can generalize to `? extends StorageServerClientManager`
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/StorageContainerStoreBuilder.java`
#### Snippet
```java
     */
    public StorageContainerStoreBuilder withStorageServerClientManager(
        Supplier<StorageServerClientManager> clientManagerSupplier) {
        this.clientManagerSupplier = clientManagerSupplier;
        return this;
```

### BoundedWildcard
Can generalize to `? extends Set`
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/cluster/ClusterControllerLeaderImpl.java`
#### Snippet
```java

    @Override
    public void onBookiesChanged(Versioned<Set<BookieId>> bookies) {
        log.info("Cluster topology is changed - new cluster : {}", bookies);
        // when bookies are changed, notify the leader to take actions
```

### BoundedWildcard
Can generalize to `? super OrderedScheduler`
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/service/RangeStoreServiceFactoryImpl.java`
#### Snippet
```java
    public RangeStoreServiceFactoryImpl(StorageConfiguration storageConf,
                                        StorageContainerPlacementPolicy rangePlacementPolicy,
                                        Resource<OrderedScheduler> schedulerResource,
                                        MVCCStoreFactory storeFactory,
                                        StorageServerClientManager clientManager) {
```

### BoundedWildcard
Can generalize to `? extends CheckpointStore`
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/store/MVCCStoreFactoryImpl.java`
#### Snippet
```java

    public MVCCStoreFactoryImpl(Supplier<Namespace> namespaceSupplier,
                                Supplier<CheckpointStore> checkpointStoreSupplier,
                                File[] localStoreDirs,
                                StorageResources storageResources,
```

### BoundedWildcard
Can generalize to `? extends CompletableFuture`
in `stream/distributedlog/common/src/main/java/org/apache/distributedlog/common/concurrent/AsyncSemaphore.java`
#### Snippet
```java
     *         returned.
     */
    public <T> CompletableFuture<T> acquireAndRun(Supplier<CompletableFuture<T>> func) {
        return acquire().thenCompose(permit -> {
            CompletableFuture<T> future;
```

### BoundedWildcard
Can generalize to `? extends FileConfigurationBuilder`
in `stream/distributedlog/common/src/main/java/org/apache/distributedlog/common/config/ConfigurationSubscription.java`
#### Snippet
```java

    public ConfigurationSubscription(ConcurrentBaseConfiguration viewConfig,
                                     List<FileConfigurationBuilder> fileConfigBuilders,
                                     ScheduledExecutorService executorService,
                                     int reloadPeriod,
```

### BoundedWildcard
Can generalize to `? extends CompletableFuture`
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/metadata/stream/MetaRangeImpl.java`
#### Snippet
```java
    }

    private <T> CompletableFuture<T> checkStreamCreated(Supplier<CompletableFuture<T>> supplier) {
        CompletableFuture<T> future = FutureUtils.createFuture();
        executor.submit(() -> {
```

### BoundedWildcard
Can generalize to `? super CompletableFuture`
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/metadata/stream/MetaRangeImpl.java`
#### Snippet
```java
    }

    private <T> CompletableFuture<T> executeTask(Consumer<CompletableFuture<T>> consumer) {
        CompletableFuture<T> executeFuture = FutureUtils.createFuture();
        executor.submit(() -> {
```

### BoundedWildcard
Can generalize to `? extends KeyValue`
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/metadata/stream/MetaRangeImpl.java`
#### Snippet
```java
    }

    private void loadMetadata(List<KeyValue<byte[], byte[]>> kvs) {
        for (KeyValue<byte[], byte[]> kv : kvs) {
            if (isMetadataKey(kv.key())) {
```

### BoundedWildcard
Can generalize to `? extends Result`
in `stream/api/src/main/java/org/apache/bookkeeper/api/kv/impl/result/TxnResultImpl.java`
#### Snippet
```java
    }

    public TxnResultImpl<K, V> results(List<Result<K, V>> results) {
        this.results.forEach(Result::close);
        this.results.clear();
```

### BoundedWildcard
Can generalize to `? extends IncrementOptionImpl`
in `stream/api/src/main/java/org/apache/bookkeeper/api/kv/impl/options/IncrementOptionImpl.java`
#### Snippet
```java
class IncrementOptionImpl<K> implements IncrementOption<K> {

    static <K> IncrementOptionImpl<K> create(Recycler<IncrementOptionImpl<K>> recycler) {
        return recycler.get();
    }
```

### BoundedWildcard
Can generalize to `? extends PutOptionImpl`
in `stream/api/src/main/java/org/apache/bookkeeper/api/kv/impl/options/PutOptionImpl.java`
#### Snippet
```java
class PutOptionImpl<K> implements PutOption<K> {

    static <K> PutOptionImpl<K> create(Recycler<PutOptionImpl<K>> recycler) {
        return recycler.get();
    }
```

### BoundedWildcard
Can generalize to `? extends K`
in `stream/api/src/main/java/org/apache/bookkeeper/api/kv/impl/options/DeleteOptionImpl.java`
#### Snippet
```java
    }

    void set(DeleteOptionBuilderImpl<K> builderImpl) {
        this.prevKv = builderImpl.prevKv();
        release(this.endKey);
```

### BoundedWildcard
Can generalize to `? extends DeleteOptionImpl`
in `stream/api/src/main/java/org/apache/bookkeeper/api/kv/impl/options/DeleteOptionImpl.java`
#### Snippet
```java
class DeleteOptionImpl<K> implements DeleteOption<K> {

    static <K> DeleteOptionImpl<K> create(Recycler<DeleteOptionImpl<K>> recycler) {
        return recycler.get();
    }
```

### BoundedWildcard
Can generalize to `? extends PutOptionBuilderImpl`
in `stream/api/src/main/java/org/apache/bookkeeper/api/kv/impl/options/PutOptionBuilderImpl.java`
#### Snippet
```java
class PutOptionBuilderImpl<K> implements PutOptionBuilder<K> {

    static <K> PutOptionBuilderImpl<K> create(Recycler<PutOptionBuilderImpl<K>> buildRecyler) {
        return buildRecyler.get();
    }
```

### BoundedWildcard
Can generalize to `? extends IncrementOptionBuilderImpl`
in `stream/api/src/main/java/org/apache/bookkeeper/api/kv/impl/options/IncrementOptionBuilderImpl.java`
#### Snippet
```java
class IncrementOptionBuilderImpl<K> implements IncrementOptionBuilder<K> {

    static <K> IncrementOptionBuilderImpl<K> create(Recycler<IncrementOptionBuilderImpl<K>> buildRecyler) {
        return buildRecyler.get();
    }
```

### BoundedWildcard
Can generalize to `? extends DeleteOptionBuilderImpl`
in `stream/api/src/main/java/org/apache/bookkeeper/api/kv/impl/options/DeleteOptionBuilderImpl.java`
#### Snippet
```java
class DeleteOptionBuilderImpl<K> implements DeleteOptionBuilder<K> {

    static <K> DeleteOptionBuilderImpl<K> create(Recycler<DeleteOptionBuilderImpl<K>> buildRecyler) {
        return buildRecyler.get();
    }
```

### BoundedWildcard
Can generalize to `? extends K`
in `stream/api/src/main/java/org/apache/bookkeeper/api/kv/impl/options/RangeOptionImpl.java`
#### Snippet
```java
    }

    void set(RangeOptionBuilderImpl<K> builderImpl) {
        this.limit = builderImpl.limit();
        this.minCreateRev = builderImpl.minCreateRev();
```

### BoundedWildcard
Can generalize to `? extends RangeOptionImpl`
in `stream/api/src/main/java/org/apache/bookkeeper/api/kv/impl/options/RangeOptionImpl.java`
#### Snippet
```java
class RangeOptionImpl<K> implements RangeOption<K> {

    static <K> RangeOptionImpl<K> create(Recycler<RangeOptionImpl<K>> recycler) {
        return recycler.get();
    }
```

### BoundedWildcard
Can generalize to `? extends RangeOptionBuilderImpl`
in `stream/api/src/main/java/org/apache/bookkeeper/api/kv/impl/options/RangeOptionBuilderImpl.java`
#### Snippet
```java
class RangeOptionBuilderImpl<K> implements RangeOptionBuilder<K> {

    static <K> RangeOptionBuilderImpl<K> create(Recycler<RangeOptionBuilderImpl<K>> buildRecyler) {
        return buildRecyler.get();
    }
```

### BoundedWildcard
Can generalize to `? extends ClusterController`
in `stream/server/src/main/java/org/apache/bookkeeper/stream/server/service/ClusterControllerService.java`
#### Snippet
```java

    public ClusterControllerService(StorageConfiguration conf,
                                    Supplier<ClusterController> controllerSupplier,
                                    StatsLogger statsLogger) {
        super("cluster-controller", conf, statsLogger);
```

### BoundedWildcard
Can generalize to `? extends Node`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NetworkTopologyImpl.java`
#### Snippet
```java

    @Override
    public int countNumOfAvailableNodes(String scope, Collection<Node> excludedNodes) {
        boolean isExcluded = false;
        if (scope.startsWith(INVERSE)) {
```

### BoundedWildcard
Can generalize to `? super AuthToken`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/auth/AuthProviderFactoryFactory.java`
#### Snippet
```java
            return new BookieAuthProvider() {
                @Override
                public void process(AuthToken m, AuthCallbacks.GenericCallback<AuthToken> cb) {
                    // any request of authentication for clients is going to be answered with a standard response
                    // the client will d
```

### BoundedWildcard
Can generalize to `? super T`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/CleanupLedgerManager.java`
#### Snippet
```java
        private final GenericCallback<T> cb;

        CleanupGenericCallback(GenericCallback<T> cb) {
            this.cb = cb;
            addCallback(cb);
```

### BoundedWildcard
Can generalize to `? super AuditorEvent`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/ZkLedgerAuditorManager.java`
#### Snippet
```java

    @Override
    public void tryToBecomeAuditor(String bookieId, Consumer<AuditorEvent> listener)
            throws IOException, InterruptedException {
        this.listener = listener;
```

### BoundedWildcard
Can generalize to `? super Long`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/ZkLedgerIdGenerator.java`
#### Snippet
```java
    }

    public static void generateLedgerIdImpl(final GenericCallback<Long> cb, ZooKeeper zk, String ledgerPrefix,
            List<ACL> zkAcls) {
        ZkUtils.asyncCreateFullPathOptimistic(zk, ledgerPrefix, new byte[0], zkAcls,
```

### BoundedWildcard
Can generalize to `? super Long`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/AbstractZkLedgerManager.java`
#### Snippet
```java
     */
    protected void asyncProcessLedgersInSingleNode(
            final String path, final Processor<Long> processor,
            final AsyncCallback.VoidCallback finalCb, final Object ctx,
            final int successRc, final int failureRc) {
```

### BoundedWildcard
Can generalize to `? extends T`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/AbstractHierarchicalLedgerManager.java`
#### Snippet
```java
         *          RC passed to final callback on failure
         */
        public void process(final List<T> data, final Processor<T> processor,
                            final AsyncCallback.VoidCallback finalCb, final Object context,
                            final int successRc, final int failureRc) {
```

### BoundedWildcard
Can generalize to `? super T`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/AbstractHierarchicalLedgerManager.java`
#### Snippet
```java
         *          RC passed to final callback on failure
         */
        public void process(final List<T> data, final Processor<T> processor,
                            final AsyncCallback.VoidCallback finalCb, final Object context,
                            final int successRc, final int failureRc) {
```

### BoundedWildcard
Can generalize to `? super MetadataClientDriver`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/MetadataDrivers.java`
#### Snippet
```java
    @SuppressFBWarnings("RCN_REDUNDANT_NULLCHECK_WOULD_HAVE_BEEN_A_NPE")
    public static <T> T runFunctionWithMetadataClientDriver(ClientConfiguration conf,
                                                            Function<MetadataClientDriver, T> function,
                                                            ScheduledExecutorService executorService)
            throws MetadataException, ExecutionException {
```

### BoundedWildcard
Can generalize to `? super RegistrationManager`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/MetadataDrivers.java`
#### Snippet
```java
     */
    public static <T> T runFunctionWithRegistrationManager(ServerConfiguration conf,
                                                           Function<RegistrationManager, T> function)
            throws MetadataException, ExecutionException {
        return runFunctionWithMetadataBookieDriver(
```

### BoundedWildcard
Can generalize to `? super MetadataBookieDriver`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/MetadataDrivers.java`
#### Snippet
```java
    @SuppressFBWarnings("RCN_REDUNDANT_NULLCHECK_WOULD_HAVE_BEEN_A_NPE")
    public static <T> T runFunctionWithMetadataBookieDriver(ServerConfiguration conf,
                                                            Function<MetadataBookieDriver, T> function)
            throws MetadataException, ExecutionException {
        try (MetadataBookieDriver driver = MetadataDrivers.getBookieDriver(
```

### BoundedWildcard
Can generalize to `? super LedgerManagerFactory`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/MetadataDrivers.java`
#### Snippet
```java
     */
    public static <T> T runFunctionWithLedgerManagerFactory(ServerConfiguration conf,
                                                            Function<LedgerManagerFactory, T> function)
            throws MetadataException, ExecutionException {
        return runFunctionWithMetadataBookieDriver(conf, driver -> {
```

### BoundedWildcard
Can generalize to `? super AuthToken`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/sasl/SASLClientAuthProvider.java`
#### Snippet
```java

    @Override
    public void init(AuthCallbacks.GenericCallback<AuthToken> cb) {
        try {
            if (client.hasInitialResponse()) {
```

### BoundedWildcard
Can generalize to `? super AuthToken`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/sasl/SASLClientAuthProvider.java`
#### Snippet
```java

    @Override
    public void process(AuthToken m, AuthCallbacks.GenericCallback<AuthToken> cb) {
        if (client.isComplete()) {
            completeCb.operationComplete(BKException.Code.OK, null);
```

### BoundedWildcard
Can generalize to `? super AuthToken`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/sasl/SASLBookieAuthProvider.java`
#### Snippet
```java

    @Override
    public void process(AuthToken m, AuthCallbacks.GenericCallback<AuthToken> cb) {
        try {
            byte[] clientSideToken = m.getData();
```

### BoundedWildcard
Can generalize to `? super List`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/ZkLedgerUnderreplicationManager.java`
#### Snippet
```java
     */
    @Override
    public Iterator<UnderreplicatedLedger> listLedgersToRereplicate(final Predicate<List<String>> predicate) {
        final Queue<String> queue = new LinkedList<String>();
        queue.add(urLedgerPath);
```

### BoundedWildcard
Can generalize to `? super Throwable`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/SafeRunnable.java`
#### Snippet
```java
     * @return
     */
    public static SafeRunnable safeRun(Runnable runnable, Consumer<Throwable> exceptionHandler) {
        return new SafeRunnable() {
            @Override
```

### BoundedWildcard
Can generalize to `? extends T`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/IteratorUtility.java`
#### Snippet
```java
     * @return
     */
    public static <T> OfLong mergeIteratorsForPrimitiveLongIterator(Iterator<T> iter1, Iterator<T> iter2,
            Comparator<T> comparator, ToLongFunction<T> function) {
        return new PrimitiveIterator.OfLong() {
```

### BoundedWildcard
Can generalize to `? extends T`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/IteratorUtility.java`
#### Snippet
```java
     * @return
     */
    public static <T> OfLong mergeIteratorsForPrimitiveLongIterator(Iterator<T> iter1, Iterator<T> iter2,
            Comparator<T> comparator, ToLongFunction<T> function) {
        return new PrimitiveIterator.OfLong() {
```

### BoundedWildcard
Can generalize to `? super T`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/IteratorUtility.java`
#### Snippet
```java
     */
    public static <T> OfLong mergeIteratorsForPrimitiveLongIterator(Iterator<T> iter1, Iterator<T> iter2,
            Comparator<T> comparator, ToLongFunction<T> function) {
        return new PrimitiveIterator.OfLong() {
            private T curIter1Entry = null;
```

### BoundedWildcard
Can generalize to `? super T`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/IteratorUtility.java`
#### Snippet
```java
     */
    public static <T> OfLong mergeIteratorsForPrimitiveLongIterator(Iterator<T> iter1, Iterator<T> iter2,
            Comparator<T> comparator, ToLongFunction<T> function) {
        return new PrimitiveIterator.OfLong() {
            private T curIter1Entry = null;
```

### BoundedWildcard
Can generalize to `? extends File`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/DiskChecker.java`
#### Snippet
```java
     * @throws IOException
     */
    public long getTotalDiskSpace(List<File> dirs) throws IOException {
        long totalDiskSpace = 0;
        Set<FileStore> dirsFileStore = new HashSet<FileStore>();
```

### BoundedWildcard
Can generalize to `? extends File`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/DiskChecker.java`
#### Snippet
```java
     * @throws IOException
     */
    public long getTotalFreeSpace(List<File> dirs) throws IOException {
        long totalFreeSpace = 0;
        Set<FileStore> dirsFileStore = new HashSet<FileStore>();
```

### BoundedWildcard
Can generalize to `? super List`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/ZkUtils.java`
#### Snippet
```java
     */
    public static void getChildrenInSingleNode(final ZooKeeper zk, final String node,
            final GenericCallback<List<String>> cb) {
        zk.sync(node, new AsyncCallback.VoidCallback() {
            @Override
```

### BoundedWildcard
Can generalize to `? super K`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/SynchronizedHashMultiMap.java`
#### Snippet
```java
    }

    public synchronized int removeIf(BiPredicate<K, V> predicate) {
        int removedSum = map.values().stream().mapToInt(
                pairs -> {
```

### BoundedWildcard
Can generalize to `? super V`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/SynchronizedHashMultiMap.java`
#### Snippet
```java
    }

    public synchronized int removeIf(BiPredicate<K, V> predicate) {
        int removedSum = map.values().stream().mapToInt(
                pairs -> {
```

### BoundedWildcard
Can generalize to `? extends File`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/LocalBookKeeper.java`
#### Snippet
```java
    }

    private static void cleanupDirectories(List<File> dirs) throws IOException {
        for (File dir : dirs) {
            FileUtils.deleteDirectory(dir);
```

### BoundedWildcard
Can generalize to `? super V`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentLongHashMap.java`
#### Snippet
```java
        }

        public void forEach(EntryProcessor<V> processor) {
            long stamp = tryOptimisticRead();

```

### BoundedWildcard
Can generalize to `? extends V`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentLongHashMap.java`
#### Snippet
```java
        }

        V put(long key, V value, int keyHash, boolean onlyIfAbsent, LongFunction<V> valueProvider) {
            int bucket = keyHash;

```

### BoundedWildcard
Can generalize to `? super V`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentLongHashMap.java`
#### Snippet
```java
        }

        int removeIf(LongObjectPredicate<V> filter) {
            long stamp = writeLock();

```

### BoundedWildcard
Can generalize to `? super K`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentOpenHashMap.java`
#### Snippet
```java
        }

        int removeIf(BiPredicate<K, V> filter) {
            long stamp = writeLock();

```

### BoundedWildcard
Can generalize to `? super V`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentOpenHashMap.java`
#### Snippet
```java
        }

        int removeIf(BiPredicate<K, V> filter) {
            long stamp = writeLock();

```

### BoundedWildcard
Can generalize to `? super K`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentOpenHashMap.java`
#### Snippet
```java
        }

        V put(K key, V value, int keyHash, boolean onlyIfAbsent, Function<K, V> valueProvider) {
            long stamp = writeLock();
            int bucket = signSafeMod(keyHash, capacity);
```

### BoundedWildcard
Can generalize to `? extends V`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentOpenHashMap.java`
#### Snippet
```java
        }

        V put(K key, V value, int keyHash, boolean onlyIfAbsent, Function<K, V> valueProvider) {
            long stamp = writeLock();
            int bucket = signSafeMod(keyHash, capacity);
```

### BoundedWildcard
Can generalize to `? super T`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookkeeperInternalCallbacks.java`
#### Snippet
```java
        final long startTime;

        public TimedGenericCallback(GenericCallback<T> cb, int successRc, OpStatsLogger statsLogger) {
            this.cb = cb;
            this.successRc = successRc;
```

### BoundedWildcard
Can generalize to `? super String`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookie/LedgerCommand.java`
#### Snippet
```java
    private Consumer<String> print = this::printInfoLine;

    public void setPrint(Consumer<String> print) {
        this.print = print;
    }
```

### BoundedWildcard
Can generalize to `? super PerChannelBookieClient`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
    }

    private void completeOperation(GenericCallback<PerChannelBookieClient> op, int rc) {
        closeLock.readLock().lock();
        try {
```

### BoundedWildcard
Can generalize to `? extends EntryLocation`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/InterleavedLedgerStorage.java`
#### Snippet
```java

    @Override
    public void updateEntriesLocations(Iterable<EntryLocation> locations) throws IOException {
        for (EntryLocation l : locations) {
            try {
```

### BoundedWildcard
Can generalize to `? extends RateLimiter`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/InterleavedLedgerStorage.java`
#### Snippet
```java
    @Override
    @SuppressFBWarnings("RCN_REDUNDANT_NULLCHECK_WOULD_HAVE_BEEN_A_NPE")
    public List<DetectedInconsistency> localConsistencyCheck(Optional<RateLimiter> rateLimiter) throws IOException {
        long checkStart = MathUtils.nowInNano();
        LOG.info("Starting localConsistencyCheck");
```

### BoundedWildcard
Can generalize to `? extends File`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryLogManagerForSingleEntryLog.java`
#### Snippet
```java

    @Override
    public File getDirForNextEntryLog(List<File> writableLedgerDirs) {
        Collections.shuffle(writableLedgerDirs);
        return writableLedgerDirs.get(0);
```

### BoundedWildcard
Can generalize to `? extends File`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieStatus.java`
#### Snippet
```java
     *
     */
    synchronized void writeToDirectories(List<File> directories) {
        boolean success = false;
        for (File dir : directories) {
```

### BoundedWildcard
Can generalize to `? extends File`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieStatus.java`
#### Snippet
```java
     * @param directories list of directories that store the status file
     */
    void readFromDirectories(List<File> directories) {
        boolean success = false;
        for (File dir : directories) {
```

### BoundedWildcard
Can generalize to `? extends File`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LegacyCookieValidation.java`
#### Snippet
```java

    private static void verifyDirsForStorageExpansion(
            List<File> missedCookieDirs,
            Set<File> existingLedgerDirs) throws BookieException.InvalidCookieException {

```

### BoundedWildcard
Can generalize to `? extends Cookie`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LegacyCookieValidation.java`
#### Snippet
```java
    }

    private static Set<File> getKnownDirs(List<Cookie> cookies) {
        return cookies.stream()
                .flatMap((c) -> {
```

### BoundedWildcard
Can generalize to `? extends File`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LegacyCookieValidation.java`
#### Snippet
```java
    }

    private static void verifyDirsForNewEnvironment(List<File> missedCookieDirs)
            throws BookieException.InvalidCookieException {
        List<File> nonEmptyDirs = new ArrayList<>();
```

### BoundedWildcard
Can generalize to `? extends File`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LegacyCookieValidation.java`
#### Snippet
```java

    private static Pair<List<File>, List<Cookie>> verifyAndGetMissingDirs(
            Cookie masterCookie, boolean allowExpansion, List<File> dirs)
            throws BookieException.InvalidCookieException, IOException {
        List<File> missingDirs = Lists.newArrayList();
```

### BoundedWildcard
Can generalize to `? extends File`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LegacyCookieValidation.java`
#### Snippet
```java
                                       RegistrationManager rm,
                                       Version version,
                                       List<File> dirs)
            throws BookieException, IOException {
        // backfill all the directories that miss cookies (for storage expansion)
```

### BoundedWildcard
Can generalize to `? extends EntryLogAndLockTuple`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryLogManagerForEntryLogPerLedger.java`
#### Snippet
```java
     *
     */
    private void onCacheEntryRemoval(RemovalNotification<Long, EntryLogAndLockTuple> removedLedgerEntryLogMapEntry) {
        Long ledgerId = removedLedgerEntryLogMapEntry.getKey();
        if (log.isDebugEnabled()) {
```

### BoundedWildcard
Can generalize to `? extends File`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryLogManagerForEntryLogPerLedger.java`
#### Snippet
```java
     */
    @Override
    public File getDirForNextEntryLog(List<File> writableLedgerDirs) {
        Map<File, MutableInt> writableLedgerDirFrequency = new HashMap<File, MutableInt>();
        writableLedgerDirs.stream()
```

### BoundedWildcard
Can generalize to `? extends File`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LedgerDirsManager.java`
#### Snippet
```java
    }

    File pickRandomDir(List<File> dirs, File excludedDir) throws NoWritableLedgerDirException {
        final int start = rand.nextInt(dirs.size());
        int idx = start;
```

### BoundedWildcard
Can generalize to `? extends LedgerDirsManager`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LedgerDirsMonitor.java`
#### Snippet
```java
    public LedgerDirsMonitor(final ServerConfiguration conf,
                             final DiskChecker diskChecker,
                             final List<LedgerDirsManager> dirsManagers) {
        validateThreshold(conf.getDiskUsageThreshold(), conf.getDiskLowWaterMarkUsageThreshold());
        this.interval = conf.getDiskCheckInterval();
```

### BoundedWildcard
Can generalize to `? super Long`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/InMemoryEntryLogMetadataMap.java`
#### Snippet
```java

    @Override
    public void forKey(long entryLogId, BiConsumer<Long, EntryLogMetadata> action)
            throws BookieException.EntryLogMetadataMapException {
        action.accept(entryLogId, entryLogMetaMap.get(entryLogId));
```

### BoundedWildcard
Can generalize to `? super EntryLogMetadata`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/InMemoryEntryLogMetadataMap.java`
#### Snippet
```java

    @Override
    public void forKey(long entryLogId, BiConsumer<Long, EntryLogMetadata> action)
            throws BookieException.EntryLogMetadataMapException {
        action.accept(entryLogId, entryLogMetaMap.get(entryLogId));
```

### BoundedWildcard
Can generalize to `? super Long`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/InMemoryEntryLogMetadataMap.java`
#### Snippet
```java

    @Override
    public void forEach(BiConsumer<Long, EntryLogMetadata> action) {
        entryLogMetaMap.forEach(action);
    }
```

### BoundedWildcard
Can generalize to `? super EntryLogMetadata`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/InMemoryEntryLogMetadataMap.java`
#### Snippet
```java

    @Override
    public void forEach(BiConsumer<Long, EntryLogMetadata> action) {
        entryLogMetaMap.forEach(action);
    }
```

### BoundedWildcard
Can generalize to `? extends DefaultEntryLogger.EntryLogListener`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryLogManagerBase.java`
#### Snippet
```java

    EntryLogManagerBase(ServerConfiguration conf, LedgerDirsManager ledgerDirsManager,
            EntryLoggerAllocator entryLoggerAllocator, List<DefaultEntryLogger.EntryLogListener> listeners) {
        this.ledgerDirsManager = ledgerDirsManager;
        this.entryLoggerAllocator = entryLoggerAllocator;
```

### BoundedWildcard
Can generalize to `? extends LedgerMetadata`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/ScanAndCompareGarbageCollector.java`
#### Snippet
```java
    }

    private boolean isNotBookieIncludedInLedgerEnsembles(Versioned<LedgerMetadata> metadata) {
        // do not delete a ledger that is not closed, since the ensemble might
        // change again and include the current bookie while we are deleting it
```

### BoundedWildcard
Can generalize to `? extends CachedFileInfo`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/IndexPersistenceMgr.java`
#### Snippet
```java
     * the FileInfo.
     */
    private void handleLedgerEviction(RemovalNotification<Long, CachedFileInfo> notification) {
        CachedFileInfo fileInfo = notification.getValue();
        if (null == fileInfo || null == notification.getKey()) {
```

### BoundedWildcard
Can generalize to `? super Long`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/IndexPersistenceMgr.java`
#### Snippet
```java
                               int entriesPerPage,
                               ServerConfiguration conf,
                               SnapshotMap<Long, Boolean> activeLedgers,
                               LedgerDirsManager ledgerDirsManager,
                               StatsLogger statsLogger) throws IOException {
```

### BoundedWildcard
Can generalize to `? super Boolean`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/IndexPersistenceMgr.java`
#### Snippet
```java
                               int entriesPerPage,
                               ServerConfiguration conf,
                               SnapshotMap<Long, Boolean> activeLedgers,
                               LedgerDirsManager ledgerDirsManager,
                               StatsLogger statsLogger) throws IOException {
```

### BoundedWildcard
Can generalize to `? extends LedgerEntryPage`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/IndexPersistenceMgr.java`
#### Snippet
```java

    private void writeBuffers(Long ledger,
                              List<LedgerEntryPage> entries, FileInfo fi,
                              int start, int count) throws IOException, Bookie.NoLedgerException {
        if (LOG.isTraceEnabled()) {
```

### BoundedWildcard
Can generalize to `? super Long`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/IndexPersistenceMgr.java`
#### Snippet
```java
                                                          int maximumSize,
                                                          long expireAfterAccessSeconds,
                                                          RemovalListener<Long, CachedFileInfo> removalListener) {
        CacheBuilder<Long, CachedFileInfo> builder = CacheBuilder.newBuilder()
            .concurrencyLevel(concurrencyLevel)
```

### BoundedWildcard
Can generalize to `? super CachedFileInfo`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/IndexPersistenceMgr.java`
#### Snippet
```java
                                                          int maximumSize,
                                                          long expireAfterAccessSeconds,
                                                          RemovalListener<Long, CachedFileInfo> removalListener) {
        CacheBuilder<Long, CachedFileInfo> builder = CacheBuilder.newBuilder()
            .concurrencyLevel(concurrencyLevel)
```

### BoundedWildcard
Can generalize to `? super Long`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/LedgersIndexRebuildOp.java`
#### Snippet
```java
    }

    private void scanEntryLogFiles(Set<Long> ledgers, File[] lDirs) throws IOException {
        DefaultEntryLogger entryLogger = new DefaultEntryLogger(conf, new LedgerDirsManager(conf, lDirs,
                new DiskChecker(conf.getDiskUsageThreshold(), conf.getDiskUsageWarnThreshold())));
```

### BoundedWildcard
Can generalize to `? super Long`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/LedgersIndexRebuildOp.java`
#### Snippet
```java
    }

    private void scanJournal(Journal journal, long journalId, Set<Long> ledgers) throws IOException {
        LOG.info("Scanning journal " + journalId + " (" + Long.toHexString(journalId) + ".txn)");
        journal.scanJournal(journalId, 0L, new Journal.JournalScanner() {
```

### BoundedWildcard
Can generalize to `? extends File`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieImpl.java`
#### Snippet
```java
     * @throws IOException
     */
    private void checkIfDirsOnSameDiskPartition(List<File> dirs) throws DiskPartitionDuplicationException {
        boolean allowDiskPartitionDuplication = conf.isAllowMultipleDirsUnderSameDiskPartition();
        final MutableBoolean isDuplicationFoundAndNotAllowed = new MutableBoolean(false);
```

### BoundedWildcard
Can generalize to `? super Long`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/PersistentEntryLogMetadataMap.java`
#### Snippet
```java
     */
    @Override
    public void forKey(long entryLogId, BiConsumer<Long, EntryLogMetadata> action) throws EntryLogMetadataMapException {
        throwIfClosed();
        LongWrapper key = LongWrapper.get(entryLogId);
```

### BoundedWildcard
Can generalize to `? super EntryLogMetadata`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/PersistentEntryLogMetadataMap.java`
#### Snippet
```java
     */
    @Override
    public void forKey(long entryLogId, BiConsumer<Long, EntryLogMetadata> action) throws EntryLogMetadataMapException {
        throwIfClosed();
        LongWrapper key = LongWrapper.get(entryLogId);
```

### BoundedWildcard
Can generalize to `? super Long`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/PersistentEntryLogMetadataMap.java`
#### Snippet
```java
     */
    @Override
    public void forEach(BiConsumer<Long, EntryLogMetadata> action) throws EntryLogMetadataMapException {
        throwIfClosed();
        CloseableIterator<Entry<byte[], byte[]>> iterator = metadataMapDB.iterator();
```

### BoundedWildcard
Can generalize to `? super EntryLogMetadata`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/PersistentEntryLogMetadataMap.java`
#### Snippet
```java
     */
    @Override
    public void forEach(BiConsumer<Long, EntryLogMetadata> action) throws EntryLogMetadataMapException {
        throwIfClosed();
        CloseableIterator<Entry<byte[], byte[]>> iterator = metadataMapDB.iterator();
```

### BoundedWildcard
Can generalize to `? extends EntryLocation`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/EntryLocationIndex.java`
#### Snippet
```java
    }

    public void updateLocations(Iterable<EntryLocation> newLocations) throws IOException {
        if (log.isDebugEnabled()) {
            log.debug("Update locations -- {}", Iterables.size(newLocations));
```

### BoundedWildcard
Can generalize to `? extends File`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/datainteg/DataIntegrityCookieValidation.java`
#### Snippet
```java
    }

    private void stampCookie(Cookie masterCookie, Version expectedVersion, List<File> directories)
            throws BookieException {
        // stamp to ZK first as it's the authoritive cookie. If this fails part way through
```

### BoundedWildcard
Can generalize to `? extends File`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/datainteg/DataIntegrityCookieValidation.java`
#### Snippet
```java
    }

    private List<Optional<Cookie>> collectDirectoryCookies(List<File> directories) throws BookieException {
        List<Optional<Cookie>> cookies = new ArrayList<>();
        for (File d : directories) {
```

### BoundedWildcard
Can generalize to `? super Long`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/datainteg/MetadataAsyncIterator.java`
#### Snippet
```java

    private CompletableFuture<Void> processOne(long ledgerId,
                                               BiFunction<Long, LedgerMetadata, CompletableFuture<Void>> consumer) {
        return ledgerManager.readLedgerMetadata(ledgerId)
            .thenApply(Versioned::getValue)
```

### BoundedWildcard
Can generalize to `? super LedgerMetadata`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/datainteg/MetadataAsyncIterator.java`
#### Snippet
```java

    private CompletableFuture<Void> processOne(long ledgerId,
                                               BiFunction<Long, LedgerMetadata, CompletableFuture<Void>> consumer) {
        return ledgerManager.readLedgerMetadata(ledgerId)
            .thenApply(Versioned::getValue)
```

### BoundedWildcard
Can generalize to `? extends CompletableFuture`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/datainteg/MetadataAsyncIterator.java`
#### Snippet
```java

    private CompletableFuture<Void> processOne(long ledgerId,
                                               BiFunction<Long, LedgerMetadata, CompletableFuture<Void>> consumer) {
        return ledgerManager.readLedgerMetadata(ledgerId)
            .thenApply(Versioned::getValue)
```

### BoundedWildcard
Can generalize to `? extends T`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/DynamicWeightedRandomSelectionImpl.java`
#### Snippet
```java

    @Override
    public T getNextRandom(Collection<T> selectedNodes) {
        rwLock.readLock().lock();
        try {
```

### BoundedWildcard
Can generalize to `? extends T`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/DynamicWeightedRandomSelectionImpl.java`
#### Snippet
```java

    @Override
    public void updateMap(Map<T, WeightedObject> updatedMap) {
        rwLock.writeLock().lock();
        try {
```

### BoundedWildcard
Can generalize to `? extends WeightedObject`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/DynamicWeightedRandomSelectionImpl.java`
#### Snippet
```java

    @Override
    public void updateMap(Map<T, WeightedObject> updatedMap) {
        rwLock.writeLock().lock();
        try {
```

### BoundedWildcard
Can generalize to `? extends MetastoreTableItem`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/MSLedgerManagerFactory.java`
#### Snippet
```java
    }

    static SortedSet<Long> entries2Ledgers(Iterator<MetastoreTableItem> entries) {
        SortedSet<Long> ledgers = new TreeSet<Long>();
        while (entries.hasNext()) {
```

### BoundedWildcard
Can generalize to `? super T`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/MSLedgerManagerFactory.java`
#### Snippet
```java
         *            RC passed to final callback on failure
         */
        public void process(final Set<T> data, final Processor<T> processor, final AsyncCallback.VoidCallback finalCb,
                final Object context, final int successRc, final int failureRc) {
            if (data == null || data.size() == 0) {
```

### BoundedWildcard
Can generalize to `? super Enumeration`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/SyncCallbackUtils.java`
#### Snippet
```java
        private final CompletableFuture<Enumeration<LedgerEntry>> future;

        public SyncReadCallback(CompletableFuture<Enumeration<LedgerEntry>> future) {
            this.future = future;
        }
```

### BoundedWildcard
Can generalize to `? super ByteBuf`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/datainteg/EntryCopierImpl.java`
#### Snippet
```java
                                    List<BookieId> ensemble,
                                    ImmutableList<Integer> writeSet,
                                    CompletableFuture<ByteBuf> promise,
                                    Optional<Throwable> firstException) {
            if (attempt >= writeSet.size()) {
```

### BoundedWildcard
Can generalize to `? extends LedgerMetadata`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/datainteg/DataIntegrityCheckImpl.java`
#### Snippet
```java
     *         OK and missing ledgers do not need to be looked at again. Error should be retried.
     */
    CompletableFuture<Set<LedgerResult>> checkAndRecoverLedgers(Map<Long, LedgerMetadata> ledgers,
                                                                String runId) {
        CompletableFuture<Set<LedgerResult>> promise = new CompletableFuture<>();
```

### BoundedWildcard
Can generalize to `? super Long`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/datainteg/DataIntegrityCheckImpl.java`
#### Snippet
```java
    }

    boolean isEntryMissing(WriteSets writeSets, NavigableMap<Long, Integer> bookieIndices,
                           long ledgerId, long entryId) throws IOException, BookieException {
        int bookieIndexForEntry = bookieIndices.floorEntry(entryId).getValue();
```

### BoundedWildcard
Can generalize to `? super LedgerFragment`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerChecker.java`
#### Snippet
```java

        ReadManyEntriesCallback(long numEntries, LedgerFragment fragment,
                GenericCallback<LedgerFragment> cb) {
            this.numEntries = new AtomicLong(numEntries);
            this.fragment = fragment;
```

### BoundedWildcard
Can generalize to `? super Set`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerChecker.java`
#### Snippet
```java

        FullLedgerCallback(long numFragments,
                GenericCallback<Set<LedgerFragment>> cb) {
            badFragments = new LinkedHashSet<>();
            this.numFragments = new AtomicLong(numFragments);
```

### BoundedWildcard
Can generalize to `? super Boolean`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerChecker.java`
#### Snippet
```java

        EntryExistsCallback(int numReads,
                            GenericCallback<Boolean> cb) {
            this.numReads = new AtomicInteger(numReads);
            this.cb = cb;
```

### BoundedWildcard
Can generalize to `? super LedgerFragment`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerChecker.java`
#### Snippet
```java
        LedgerFragmentCallback(LedgerFragment lf,
                               int bookieIndex,
                               GenericCallback<LedgerFragment> cb,
                               Map<Integer, Integer> badBookies,
                               AtomicInteger numBookies) {
```

### BoundedWildcard
Can generalize to `? extends PendingAddOp`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
    }

    void errorOutPendingAdds(int rc, List<PendingAddOp> ops) {
        for (PendingAddOp op : ops) {
            op.submitCallback(rc);
```

### BoundedWildcard
Can generalize to `? extends LedgerEntry`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
            asyncReadEntries(entryId, entryId, new ReadCallback() {
                @Override
                public void readComplete(int rc, LedgerHandle lh, Enumeration<LedgerEntry> seq, Object ctx) {
                    if (BKException.Code.OK == rc) {
                        if (seq.hasMoreElements()) {
```

### BoundedWildcard
Can generalize to `? super Versioned`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/MetadataUpdateLoop.java`
#### Snippet
```java
    }

    private void readLoop(long ledgerId, CompletableFuture<Versioned<LedgerMetadata>> promise) {
        Versioned<LedgerMetadata> current = currentLocalValue.get();

```

### BoundedWildcard
Can generalize to `? super Versioned`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/MetadataUpdateLoop.java`
#### Snippet
```java

    private void writeLoop(Versioned<LedgerMetadata> currentLocal,
                           CompletableFuture<Versioned<LedgerMetadata>> promise) {
        if (LOG.isDebugEnabled()) {
            LOG.debug("{} starting write loop iteration, attempt {}",
```

### BoundedWildcard
Can generalize to `? extends BookieInfo`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/TopologyAwareEnsemblePlacementPolicy.java`
#### Snippet
```java

    @Override
    public void updateBookieInfo(Map<BookieId, BookieInfo> bookieInfoMap) {
        if (!isWeighted) {
            LOG.info("bookieFreeDiskInfo callback called even without weighted placement policy being used.");
```

### BoundedWildcard
Can generalize to `? extends Node`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/TopologyAwareEnsemblePlacementPolicy.java`
#### Snippet
```java
    }

    static Set<String> getNetworkLocations(Set<Node> bookieNodes) {
        Set<String> networkLocs = new HashSet<>();
        for (Node bookieNode : bookieNodes) {
```

### BoundedWildcard
Can generalize to `? super BookieNode`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ZoneawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
     * 'bookiesToConsiderAfterExcludingUDs' set.
     */
    private void updateBookiesToConsiderAfterExcludingZonesAndUDs(Set<BookieNode> bookiesToConsiderAfterExcludingUDs,
            Set<BookieNode> bookiesToConsider, HashMap<String, Set<String>> excludingUDsOfZonesToConsider) {
        for (BookieNode bookieToConsider : bookiesToConsider) {
```

### BoundedWildcard
Can generalize to `? extends BookieNode`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ZoneawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
     */
    private void updateBookiesToConsiderAfterExcludingZonesAndUDs(Set<BookieNode> bookiesToConsiderAfterExcludingUDs,
            Set<BookieNode> bookiesToConsider, HashMap<String, Set<String>> excludingUDsOfZonesToConsider) {
        for (BookieNode bookieToConsider : bookiesToConsider) {
            ZoneAwareNodeLocation nodeLocation = getZoneAwareNodeLocation(bookieToConsider);
```

### BoundedWildcard
Can generalize to `? extends Set`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ZoneawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
     */
    private void updateBookiesToConsiderAfterExcludingZonesAndUDs(Set<BookieNode> bookiesToConsiderAfterExcludingUDs,
            Set<BookieNode> bookiesToConsider, HashMap<String, Set<String>> excludingUDsOfZonesToConsider) {
        for (BookieNode bookieToConsider : bookiesToConsider) {
            ZoneAwareNodeLocation nodeLocation = getZoneAwareNodeLocation(bookieToConsider);
```

### BoundedWildcard
Can generalize to `? extends DNSToSwitchMapping`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ZoneawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
    @Override
    public EnsemblePlacementPolicy initialize(ClientConfiguration conf,
            Optional<DNSToSwitchMapping> optionalDnsResolver, HashedWheelTimer timer, FeatureProvider featureProvider,
            StatsLogger statsLogger, BookieAddressResolver bookieAddressResolver) {
        this.statsLogger = statsLogger;
```

### BoundedWildcard
Can generalize to `? extends Set`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ZoneawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java

    private boolean validateMinUDsAreMaintained(HashMap<String, Integer> numOfNodesInZones,
            HashMap<String, Set<String>> nodesLocationInWriteSet) {
        for (Entry<String, Integer> numOfNodesInZone : numOfNodesInZones.entrySet()) {
            String zone = numOfNodesInZone.getKey();
```

### BoundedWildcard
Can generalize to `? super BookieId`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ZoneawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
     */
    private BookieId setBookieInTheEnsemble(int ensembleSize, int writeQuorumSize,
            List<BookieId> currentEnsemble, List<BookieId> newEnsemble, int bookieToReplaceIndex,
            int desiredNumZonesPerWriteQuorumForThisEnsemble, Set<BookieId> excludeBookies)
                    throws BKNotEnoughBookiesException {
```

### BoundedWildcard
Can generalize to `? extends BookieNode`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ZoneawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
    }

    private Set<String> getZonesOfBookies(Collection<BookieNode> bookieNodes) {
        Set<String> zonesOfBookies = new HashSet<String>();
        for (BookieNode bookieNode : bookieNodes) {
```

### BoundedWildcard
Can generalize to `? extends LedgerEntry`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerFragmentReplicator.java`
#### Snippet
```java
            @Override
            public void readComplete(int rc, LedgerHandle lh,
                    Enumeration<LedgerEntry> seq, Object ctx) {
                if (rc != BKException.Code.OK) {
                    LOG.error("BK error reading ledger entry: " + entryId,
```

### BoundedWildcard
Can generalize to `? super Long`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerFragmentReplicator.java`
#### Snippet
```java
            final AsyncCallback.VoidCallback ledgerFragmentEntryMcb,
            final Set<BookieId> newBookies,
            final BiConsumer<Long, Long> onReadEntryFailureCallback) throws InterruptedException {
        final long ledgerId = lh.getId();
        final AtomicInteger numCompleted = new AtomicInteger(0);
```

### BoundedWildcard
Can generalize to `? super Long`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerFragmentReplicator.java`
#### Snippet
```java
            final AsyncCallback.VoidCallback ledgerFragmentEntryMcb,
            final Set<BookieId> newBookies,
            final BiConsumer<Long, Long> onReadEntryFailureCallback) throws InterruptedException {
        final long ledgerId = lh.getId();
        final AtomicInteger numCompleted = new AtomicInteger(0);
```

### BoundedWildcard
Can generalize to `? extends LedgerFragment`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerFragmentReplicator.java`
#### Snippet
```java
     */
    private void replicateNextBatch(final LedgerHandle lh,
            final Iterator<LedgerFragment> fragments,
            final AsyncCallback.VoidCallback ledgerFragmentMcb,
            final Set<BookieId> targetBookieAddresses,
```

### BoundedWildcard
Can generalize to `? extends Versioned`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/http/service/ListLedgerService.java`
#### Snippet
```java
    static final int LIST_LEDGER_BATCH_SIZE = 100;

    private void keepLedgerMetadata(long ledgerId, CompletableFuture<Versioned<LedgerMetadata>> future,
                                    LinkedHashMap<String, Object> output, boolean decodeMeta)
            throws Exception {
```

### BoundedWildcard
Can generalize to `? super String`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/http/service/ListLedgerService.java`
#### Snippet
```java

    private void keepLedgerMetadata(long ledgerId, CompletableFuture<Versioned<LedgerMetadata>> future,
                                    LinkedHashMap<String, Object> output, boolean decodeMeta)
            throws Exception {
        LedgerMetadata md = future.get().getValue();
```

### BoundedWildcard
Can generalize to `? super Integer`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/DirectBookkeeperDriver.java`
#### Snippet
```java
    @Override
    public void readEntries(
            long ledgerID, long firstEntryID, long lastEntryID, BiConsumer<Integer, ArrayList<byte[]>> cb) {
        client.asyncOpenLedgerNoRecovery(ledgerID, BookKeeper.DigestType.CRC32, new byte[0], (rc, lh, ctx) -> {
            if (rc != 0) {
```

### BoundedWildcard
Can generalize to `? super ArrayList`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/DirectBookkeeperDriver.java`
#### Snippet
```java
    @Override
    public void readEntries(
            long ledgerID, long firstEntryID, long lastEntryID, BiConsumer<Integer, ArrayList<byte[]>> cb) {
        client.asyncOpenLedgerNoRecovery(ledgerID, BookKeeper.DigestType.CRC32, new byte[0], (rc, lh, ctx) -> {
            if (rc != 0) {
```

### BoundedWildcard
Can generalize to `? super Integer`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/DirectBookkeeperDriver.java`
#### Snippet
```java

    @Override
    public void writeEntry(long ledgerID, long entryID, byte[] data, Consumer<Integer> cb) {
        LedgerHandle handle;
        handle = openHandles.get(ledgerID);
```

### BoundedWildcard
Can generalize to `? super Integer`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/DirectBookkeeperDriver.java`
#### Snippet
```java

    @Override
    public void createLedger(long ledgerID, int enSize, int writeQSize, int ackQSize, Consumer<Integer> cb) {
        client.asyncCreateLedgerAdv(
                ledgerID,
```

### BoundedWildcard
Can generalize to `? super Integer`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/DirectBookkeeperDriver.java`
#### Snippet
```java

    @Override
    public void deleteLedger(long ledgerID, Consumer<Integer> cb) {
        client.asyncDeleteLedger(ledgerID, (rc, ctx) -> {
            cb.accept(rc);
```

### BoundedWildcard
Can generalize to `? super Integer`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/DirectBookkeeperDriver.java`
#### Snippet
```java

    @Override
    public void closeLedger(long ledgerID, Consumer<Integer> cb) {
        LedgerHandle handle = openHandles.remove(ledgerID);
        handle.asyncClose(
```

### BoundedWildcard
Can generalize to `? super Consumer`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
        void onLastOpComplete(
                Consumer<Integer> cb,
                Consumer<Consumer<Integer>> newOnLastOp) {
            checkState(onLastOp == null);
            onLastOp = newOnLastOp;
```

### BoundedWildcard
Can generalize to `? super Consumer`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
        void onLastWriteComplete(
                Consumer<Integer> cb,
                Consumer<Consumer<Integer>> newOnLastWrite) {
            assert (onLastWrite == null);
            onLastWrite = newOnLastWrite;
```

### BoundedWildcard
Can generalize to `? super String`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/BookieLedgerIndexer.java`
#### Snippet
```java
    }

    private void putLedger(ConcurrentHashMap<String, Set<Long>> bookie2ledgersMap,
            String bookie, long ledgerId) {
        Set<Long> ledgers = bookie2ledgersMap.get(bookie);
```

### BoundedWildcard
Can generalize to `? extends LedgerMetadata`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/AuditorPlacementPolicyCheckTask.java`
#### Snippet
```java
    void doPlacementPolicyCheck(Long ledgerId,
                                AsyncCallback.VoidCallback iterCallback,
                                Versioned<LedgerMetadata> metadataVer) {
        LedgerMetadata metadata = metadataVer.getValue();
        int writeQuorumSize = metadata.getWriteQuorumSize();
```

### BoundedWildcard
Can generalize to `? extends LedgerFragment`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/ReplicationWorker.java`
#### Snippet
```java
    }

    private boolean checkFragmentRepeat(Set<LedgerFragment> fragments, LedgerFragment needChecked) {
        for (LedgerFragment fragment : fragments) {
            if (fragment.getLedgerId() == needChecked.getLedgerId()
```

### BoundedWildcard
Can generalize to `? super Node`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RackawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
     * @return chosen bookie.
     */
    protected BookieNode selectRandomFromRack(String netPath, Set<Node> excludeBookies, Predicate<BookieNode> predicate,
            Ensemble<BookieNode> ensemble) throws BKNotEnoughBookiesException {
        WeightedRandomSelection<BookieNode> wRSelection = null;
```

### BoundedWildcard
Can generalize to `? extends Node`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RackawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
    }

    private WeightedRandomSelection<BookieNode> prepareForWeightedSelection(List<Node> leaves) {
        // create a map of bookieNode->freeDiskSpace for this rack. The assumption is that
        // the number of nodes in a rack is of the order of 40, so it shouldn't be too bad
```

### BoundedWildcard
Can generalize to `? super Node`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RackawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
    protected List<BookieNode> selectRandomInternal(List<BookieNode> bookiesToSelectFrom,
                                                    int numBookies,
                                                    Set<Node> excludeBookies,
                                                    Predicate<BookieNode> predicate,
                                                    Ensemble<BookieNode> ensemble)
```

### BoundedWildcard
Can generalize to `? super AtomicBoolean`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/AuditorTask.java`
#### Snippet
```java
                LedgerUnderreplicationManager ledgerUnderreplicationManager,
                ShutdownTaskHandler shutdownTaskHandler,
                BiConsumer<AtomicBoolean, Throwable> hasAuditCheckTask) {
        this.conf = conf;
        this.auditorStats = auditorStats;
```

### BoundedWildcard
Can generalize to `? extends DNSToSwitchMapping`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RackawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
    @Override
    public RackawareEnsemblePlacementPolicyImpl initialize(ClientConfiguration conf,
                                                           Optional<DNSToSwitchMapping> optionalDnsResolver,
                                                           HashedWheelTimer timer,
                                                           FeatureProvider featureProvider,
```

### BoundedWildcard
Can generalize to `? extends Set`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/AuditorBookieCheckTask.java`
#### Snippet
```java

    private CompletableFuture<?> handleLostBookiesAsync(Collection<String> lostBookies,
                                                        Map<String, Set<Long>> ledgerDetails) {
        LOG.info("Following are the failed bookies: {},"
                + " and searching its ledgers for re-replication", lostBookies);
```

### BoundedWildcard
Can generalize to `? super Long`
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/LedgerMetadataConsumer.java`
#### Snippet
```java
    LedgerMetadataConsumer(long ledgerId,
                           LedgerMetadataListener listener,
                           Consumer<Long> onDeletedConsumer) {
        this.ledgerId = ledgerId;
        this.listener = listener;
```

### BoundedWildcard
Can generalize to `? extends Consumer`>>
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdRegistrationClient.java`
#### Snippet
```java
    private static CompletableFuture<Void> unregisterListener(
        KeySetReader<BookieId> keySetReader,
        Map<RegistrationListener, Consumer<Versioned<Set<BookieId>>>> listeners,
        RegistrationListener listener
    ) {
```

### BoundedWildcard
Can generalize to `? super RegistrationListener`
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdRegistrationClient.java`
#### Snippet
```java
    private static CompletableFuture<Void> registerListener(
        KeySetReader<BookieId> keySetReader,
        Map<RegistrationListener, Consumer<Versioned<Set<BookieId>>>> listeners,
        RegistrationListener listener
    ) {
```

### BoundedWildcard
Can generalize to `? super Long`
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/Etcd64bitIdGenerator.java`
#### Snippet
```java

    @Override
    public void generateLedgerId(GenericCallback<Long> cb) {
        int bucketId = nextBucketId();
        checkArgument(bucketId >= 0 && bucketId < NUM_BUCKETS,
```

### BoundedWildcard
Can generalize to `? super Long`
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdLedgerManager.java`
#### Snippet
```java

    private void processLedgers(KeyStream<Long> ks,
                                Processor<Long> processor,
                                VoidCallback finalCb,
                                Object context,
```

### BoundedWildcard
Can generalize to `? super ByteSequence`
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/helpers/KeyStream.java`
#### Snippet
```java
                     ByteSequence startKey,
                     ByteSequence endKey,
                     Function<ByteSequence, T> encoder,
                     int batchSize) {
        this.kvClient = kvClient;
```

### BoundedWildcard
Can generalize to `? extends T`
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/helpers/KeyStream.java`
#### Snippet
```java
                     ByteSequence startKey,
                     ByteSequence endKey,
                     Function<ByteSequence, T> encoder,
                     int batchSize) {
        this.kvClient = kvClient;
```

### BoundedWildcard
Can generalize to `? super ByteSequence`
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/helpers/ValueStream.java`
#### Snippet
```java
    public ValueStream(Client client,
                       EtcdWatchClient watchClient,
                       Function<ByteSequence, T> encoder,
                       ByteSequence key) {
        this.client = client;
```

### BoundedWildcard
Can generalize to `? extends T`
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/helpers/ValueStream.java`
#### Snippet
```java
    public ValueStream(Client client,
                       EtcdWatchClient watchClient,
                       Function<ByteSequence, T> encoder,
                       ByteSequence key) {
        this.client = client;
```

### BoundedWildcard
Can generalize to `? super ByteSequence`
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/helpers/KeySetReader.java`
#### Snippet
```java
    public KeySetReader(Client client,
                        EtcdWatchClient watchClient,
                        Function<ByteSequence, T> encoder,
                        ByteSequence beginKey,
                        ByteSequence endKey) {
```

### BoundedWildcard
Can generalize to `? extends T`
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/helpers/KeySetReader.java`
#### Snippet
```java
    public KeySetReader(Client client,
                        EtcdWatchClient watchClient,
                        Function<ByteSequence, T> encoder,
                        ByteSequence beginKey,
                        ByteSequence endKey) {
```

### BoundedWildcard
Can generalize to `? super SortedMap`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeperAdmin.java`
#### Snippet
```java

    public void asyncGetLedgersContainBookies(final Set<BookieId> bookies,
                                              final GenericCallback<SortedMap<Long, LedgerMetadata>> callback) {
        final SortedMap<Long, LedgerMetadata> ledgers = new ConcurrentSkipListMap<Long, LedgerMetadata>();
        bkc.getLedgerManager().asyncProcessLedgers(new Processor<Long>() {
```

### BoundedWildcard
Can generalize to `? extends Set`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeperAdmin.java`
#### Snippet
```java
                List<BookieId> ensemble,
                Set<Integer> bookieIndexesToRereplicate,
                Optional<Set<BookieId>> excludedBookies)
            throws BKException.BKNotEnoughBookiesException {
        // target bookies to replicate
```

### BoundedWildcard
Can generalize to `? extends BookieExpectedToContainSegmentInfo`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/AuditorReplicasCheckTask.java`
#### Snippet
```java
                int ackQuorumSize,
                BookieId bookieInEnsemble,
                List<BookieExpectedToContainSegmentInfo> bookieExpectedToContainSegmentInfoList,
                ConcurrentHashMap<Long, MissingEntriesInfoOfLedger> ledgersWithMissingEntries,
                ConcurrentHashMap<Long, MissingEntriesInfoOfLedger> ledgersWithUnavailableBookies,
```

### BoundedWildcard
Can generalize to `? super Long`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/AuditorReplicasCheckTask.java`
#### Snippet
```java
                BookieId bookieInEnsemble,
                List<BookieExpectedToContainSegmentInfo> bookieExpectedToContainSegmentInfoList,
                ConcurrentHashMap<Long, MissingEntriesInfoOfLedger> ledgersWithMissingEntries,
                ConcurrentHashMap<Long, MissingEntriesInfoOfLedger> ledgersWithUnavailableBookies,
                MultiCallback mcbForThisLedger) {
```

### BoundedWildcard
Can generalize to `? super Long`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/AuditorReplicasCheckTask.java`
#### Snippet
```java
                List<BookieExpectedToContainSegmentInfo> bookieExpectedToContainSegmentInfoList,
                ConcurrentHashMap<Long, MissingEntriesInfoOfLedger> ledgersWithMissingEntries,
                ConcurrentHashMap<Long, MissingEntriesInfoOfLedger> ledgersWithUnavailableBookies,
                MultiCallback mcbForThisLedger) {
            this.ledgerInRange = ledgerInRange;
```

### BoundedWildcard
Can generalize to `? super Version`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/metastore/InMemoryMetastoreTable.java`
#### Snippet
```java

    @Override
    public void put(final String key, final Value value, final Version version, final MetastoreCallback<Version> cb,
            final Object ctx) {
        scheduler.submit(new Runnable() {
```

### BoundedWildcard
Can generalize to `? super MetastoreCursor`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/metastore/InMemoryMetastoreTable.java`
#### Snippet
```java
                           final String lastKey, final boolean lastInclusive,
                           final Order order, final Set<String> fields,
                           final MetastoreCallback<MetastoreCursor> cb, final Object ctx) {
        scheduler.submit(new Runnable() {
            @Override
```

### BoundedWildcard
Can generalize to `? super Versioned`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/metastore/InMemoryMetastoreTable.java`
#### Snippet
```java
    }

    public synchronized void scheduleGet(String key, Set<String> fields, MetastoreCallback<Versioned<Value>> cb,
            Object ctx) {
        if (null == key) {
```

### BoundedWildcard
Can generalize to `? super OutOfMemoryError`
in `bookkeeper-common-allocator/src/main/java/org/apache/bookkeeper/common/allocator/impl/ByteBufAllocatorImpl.java`
#### Snippet
```java
    ByteBufAllocatorImpl(ByteBufAllocator pooledAllocator, ByteBufAllocator unpooledAllocator,
            PoolingPolicy poolingPolicy, int poolingConcurrency, OutOfMemoryPolicy outOfMemoryPolicy,
            Consumer<OutOfMemoryError> outOfMemoryListener,
            LeakDetectionPolicy leakDetectionPolicy) {
        super(poolingPolicy == PoolingPolicy.PooledDirect /* preferDirect */);
```

### BoundedWildcard
Can generalize to `? super OutOfMemoryError`
in `bookkeeper-common-allocator/src/main/java/org/apache/bookkeeper/common/allocator/impl/ByteBufAllocatorImpl.java`
#### Snippet
```java

    @Override
    public void setOomHandler(Consumer<OutOfMemoryError> handler) {
        this.outOfMemoryListener = handler;
    }
```

### BoundedWildcard
Can generalize to `? extends Handler`
in `bookkeeper-http/http-server/src/main/java/org/apache/bookkeeper/http/HttpRouter.java`
#### Snippet
```java
    private final Map<String, Handler> endpointHandlers = new HashMap<>();

    public HttpRouter(AbstractHttpHandlerFactory<Handler> handlerFactory) {
        this.endpointHandlers.put(HEARTBEAT, handlerFactory.newHandler(HttpServer.ApiType.HEARTBEAT));
        this.endpointHandlers.put(SERVER_CONFIG, handlerFactory.newHandler(HttpServer.ApiType.SERVER_CONFIG));
```

### BoundedWildcard
Can generalize to `? super String`
in `bookkeeper-slogger/api/src/main/java/org/apache/bookkeeper/slogger/AbstractSlogger.java`
#### Snippet
```java

    private static void addWithPrefix(String prefix, Sloggable value,
                                      BiConsumer<String, String> consumer, int depth) {
        value.log(new SloggableAccumulator() {
                @Override
```

### BoundedWildcard
Can generalize to `? super String`
in `bookkeeper-slogger/api/src/main/java/org/apache/bookkeeper/slogger/AbstractSlogger.java`
#### Snippet
```java

    private static void addWithPrefix(String prefix, Sloggable value,
                                      BiConsumer<String, String> consumer, int depth) {
        value.log(new SloggableAccumulator() {
                @Override
```

### BoundedWildcard
Can generalize to `? super Integer`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKTransmitPacket.java`
#### Snippet
```java
     * @see #awaitTransmitComplete(long, TimeUnit)
     */
    void addTransmitCompleteListener(FutureEventListener<Integer> transmitCompleteListener) {
        transmitComplete.whenComplete(transmitCompleteListener);
    }
```

### BoundedWildcard
Can generalize to `? super Set`>
in `stream/distributedlog/core/src/main/java/org/apache/bookkeeper/client/LedgerReader.java`
#### Snippet
```java

    public void readLacs(final LedgerHandle lh, long eid,
                         final GenericCallback<Set<ReadResult<Long>>> callback) {
        WriteSet writeSet = lh.distributionSchedule.getWriteSet(eid);
        final AtomicInteger numBookies = new AtomicInteger(writeSet.size());
```

### BoundedWildcard
Can generalize to `? super List`
in `stream/distributedlog/core/src/main/java/org/apache/bookkeeper/client/LedgerReader.java`
#### Snippet
```java
     */
    public void forwardReadEntriesFromLastConfirmed(final LedgerHandle lh,
                                                    final GenericCallback<List<LedgerEntry>> callback) {
        final List<LedgerEntry> resultList = new ArrayList<LedgerEntry>();

```

### BoundedWildcard
Can generalize to `? super Set`>
in `stream/distributedlog/core/src/main/java/org/apache/bookkeeper/client/LedgerReader.java`
#### Snippet
```java

    public void readEntriesFromAllBookies(final LedgerHandle lh, long eid,
                                          final GenericCallback<Set<ReadResult<ByteBuf>>> callback) {
        WriteSet writeSet = lh.distributionSchedule.getWriteSet(eid);
        final AtomicInteger numBookies = new AtomicInteger(writeSet.size());
```

### BoundedWildcard
Can generalize to `? extends P`
in `circe-checksum/src/main/java/com/scurrilous/circe/impl/AbstractHashProvider.java`
#### Snippet
```java
     * @param parametersClass the base hash parameters class supported
     */
    protected AbstractHashProvider(Class<P> parametersClass) {
        this.parametersClass = parametersClass;
    }
```

### BoundedWildcard
Can generalize to `? extends FeatureProvider`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BookKeeperClient.java`
#### Snippet
```java
                     HashedWheelTimer requestTimer,
                     StatsLogger statsLogger,
                     Optional<FeatureProvider> featureProvider) {
        this.conf = conf;
        this.name = name;
```

### BoundedWildcard
Can generalize to `? extends LogRecordWithDLSN`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/ReadUtils.java`
#### Snippet
```java
            final ExecutorService executorService,
            final LogSegmentRandomAccessEntryReader reader,
            final List<LogRecordWithDLSN> searchResults,
            final int nWays,
            final Optional<LogRecordWithDLSN> prevFoundRecord,
```

### BoundedWildcard
Can generalize to `? super LogRecordWithDLSN`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/ReadUtils.java`
#### Snippet
```java
            final LogSegmentMetadata metadata,
            final ExecutorService executorService,
            final CompletableFuture<LogRecordWithDLSN> promise,
            final ScanContext context,
            final LogRecordSelector selector) {
```

### BoundedWildcard
Can generalize to `? super CompletableFuture`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAsyncLogWriter.java`
#### Snippet
```java
    }

    private void appendCancelledFutures(List<CompletableFuture<DLSN>> futures, int numToAdd) {
        final WriteCancelledException cre =
            new WriteCancelledException(getStreamName());
```

### BoundedWildcard
Can generalize to `? extends DistributedLogConfiguration`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/DistributedLogConfiguration.java`
#### Snippet
```java
     * @param streamConfiguration stream configuration overrides
     */
    public void loadStreamConf(Optional<DistributedLogConfiguration> streamConfiguration) {
        if (!streamConfiguration.isPresent()) {
            return;
```

### BoundedWildcard
Can generalize to `? extends LogSegmentMetadata`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogReadHandler.java`
#### Snippet
```java
    }

    protected void notifyUpdatedLogSegments(List<LogSegmentMetadata> segments) {
        if (logSegmentsNotificationDisabled) {
            return;
```

### BoundedWildcard
Can generalize to `? extends LogSegmentMetadata`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/ReadAheadEntryReader.java`
#### Snippet
```java
     * Reinitialize the log segments.
     */
    private void unsafeReinitializeLogSegments(List<LogSegmentMetadata> segments) {
        logger.info("Reinitialize log segments with {}", segments);
        int segmentIdx = 0;
```

### BoundedWildcard
Can generalize to `? extends LogSegmentMetadata`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/ReadAheadEntryReader.java`
#### Snippet
```java
     * @param segments list of log segments
     */
    private void unsafeInitializeLogSegments(List<LogSegmentMetadata> segments) {
        if (segments.isEmpty()) {
            // not initialize the background reader, until the first log segment is notified
```

### BoundedWildcard
Can generalize to `? extends DynamicDistributedLogConfiguration`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKDistributedLogNamespace.java`
#### Snippet
```java
            String nameOfLogStream,
            Optional<DistributedLogConfiguration> logConfiguration,
            Optional<DynamicDistributedLogConfiguration> dynamicLogConfiguration)
        throws InvalidStreamNameException, IOException {
        // Make sure the name is well formed
```

### BoundedWildcard
Can generalize to `? super Version`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/zk/ZKVersionedSetOp.java`
#### Snippet
```java

    public ZKVersionedSetOp(Op op,
                            @Nullable OpListener<Version> opListener) {
        super(op);
        this.listener = opListener;
```

### BoundedWildcard
Can generalize to `? super LogSegmentMetadata`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogWriteHandler.java`
#### Snippet
```java

    private void deleteLogSegmentMetadata(final LogSegmentMetadata segmentMetadata,
                                          final CompletableFuture<LogSegmentMetadata> promise) {
        Transaction<Object> deleteTxn = metadataStore.transaction();
        metadataStore.deleteLogSegment(deleteTxn, segmentMetadata, new Transaction.OpListener<Void>() {
```

### BoundedWildcard
Can generalize to `? super LogSegmentMetadata`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogWriteHandler.java`
#### Snippet
```java
            long lastEntryId,
            long lastSlotId,
            final CompletableFuture<LogSegmentMetadata> promise) {
        try {
            lock.checkOwnershipAndReacquire();
```

### BoundedWildcard
Can generalize to `? extends LogSegmentMetadata`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogWriteHandler.java`
#### Snippet
```java

    private CompletableFuture<List<LogSegmentMetadata>> deleteLogSegments(
            final List<LogSegmentMetadata> logs) {
        if (LOG.isTraceEnabled()) {
            LOG.trace("Purging logs for {} : {}", getFullyQualifiedName(), logs);
```

### BoundedWildcard
Can generalize to `? extends LogSegmentMetadata`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogWriteHandler.java`
#### Snippet
```java

    private CompletableFuture<List<LogSegmentMetadata>> setLogSegmentTruncationStatus(
            final List<LogSegmentMetadata> truncateList,
            LogSegmentMetadata partialTruncate,
            DLSN minActiveDLSN) {
```

### BoundedWildcard
Can generalize to `? extends LogSegmentMetadata`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogWriteHandler.java`
#### Snippet
```java
    }

    private int getNumCandidateLogSegmentsToPurge(List<LogSegmentMetadata> logSegments) {
        if (logSegments.isEmpty()) {
            return 0;
```

### BoundedWildcard
Can generalize to `? extends LogSegmentMetadata`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogWriteHandler.java`
#### Snippet
```java

    private CompletableFuture<List<LogSegmentMetadata>> setLogSegmentsOlderThanDLSNTruncated(
            List<LogSegmentMetadata> logSegments, final DLSN dlsn) {
        if (LOG.isDebugEnabled()) {
            LOG.debug("Setting truncation status on logs older than {} from {} for {}",
```

### BoundedWildcard
Can generalize to `? extends LogSegmentMetadata`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogHandler.java`
#### Snippet
```java
    }

    private void asyncGetLastLogRecord(final Iterator<LogSegmentMetadata> ledgerIter,
                                       final CompletableFuture<LogRecordWithDLSN> promise,
                                       final boolean fence,
```

### BoundedWildcard
Can generalize to `? super LogRecordWithDLSN`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogHandler.java`
#### Snippet
```java

    private void asyncGetLastLogRecord(final Iterator<LogSegmentMetadata> ledgerIter,
                                       final CompletableFuture<LogRecordWithDLSN> promise,
                                       final boolean fence,
                                       final boolean includeControlRecord,
```

### BoundedWildcard
Can generalize to `? super Versioned`>
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogHandler.java`
#### Snippet
```java
                                                  final Map<String, LogSegmentMetadata> addedSegments,
                                                  final Comparator<LogSegmentMetadata> comparator,
                                                  final CompletableFuture<Versioned<List<LogSegmentMetadata>>>
                                                          readResult,
                                                  final Version logSegmentNamesVersion,
```

### BoundedWildcard
Can generalize to `? extends List`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogHandler.java`
#### Snippet
```java
    }

    protected void readLogSegmentsFromStore(final Versioned<List<String>> logSegmentNames,
                                            final Comparator<LogSegmentMetadata> comparator,
                                            final LogSegmentFilter segmentFilter,
```

### BoundedWildcard
Can generalize to `? super LedgerHandle`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/LedgerAllocatorPool.java`
#### Snippet
```java
    @Override
    public CompletableFuture<LedgerHandle> tryObtain(final Transaction<Object> txn,
                                                     final Transaction.OpListener<LedgerHandle> listener) {
        final SimpleLedgerAllocator allocator;
        synchronized (this) {
```

### BoundedWildcard
Can generalize to `? super BKLogSegmentWriter`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogSegmentWriter.java`
#### Snippet
```java
    void scheduleFlushWithDelayIfNeeded(
            final Callable<?> callable,
            final AtomicReferenceFieldUpdater<BKLogSegmentWriter, ScheduledFuture> scheduledFutureRefUpdater) {
        final long delayMs = Math.max(0, minDelayBetweenImmediateFlushMs - lastTransmit.elapsed(TimeUnit.MILLISECONDS));
        final ScheduledFuture scheduledFuture = scheduledFutureRefUpdater.get(this);
```

### BoundedWildcard
Can generalize to `? extends LogRecord`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogSegmentWriter.java`
#### Snippet
```java
     * @throws IOException when there is I/O errors during writing records.
     */
    public synchronized int writeBulk(List<LogRecord> records) throws IOException {
        int numRecords = 0;
        for (LogRecord r : records) {
```

### BoundedWildcard
Can generalize to `? extends LedgerEntry`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/logsegment/BKLogSegmentRandomAccessEntryReader.java`
#### Snippet
```java
    @SuppressWarnings("unchecked")
    @Override
    public void readComplete(int rc, LedgerHandle lh, Enumeration<LedgerEntry> entries, Object ctx) {
        CompletableFuture<List<Entry.Reader>> promise = (CompletableFuture<List<Entry.Reader>>) ctx;
        if (BKException.Code.OK == rc) {
```

### BoundedWildcard
Can generalize to `? extends VersionedLogSegmentNamesListener`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/ZKLogSegmentMetadataStore.java`
#### Snippet
```java

    void notifyLogSegmentsUpdated(String logSegmentsPath,
                                  final Map<LogSegmentNamesListener, VersionedLogSegmentNamesListener> listeners,
                                  final Versioned<List<String>> segments) {
        if (null == listeners) {
```

### BoundedWildcard
Can generalize to `? extends LogSegmentNamesListener`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/ZKLogSegmentMetadataStore.java`
#### Snippet
```java

    void notifyLogStreamDeleted(String logSegmentsPath,
                                final Map<LogSegmentNamesListener, VersionedLogSegmentNamesListener> listeners) {
        if (null == listeners) {
            return;
```

### BoundedWildcard
Can generalize to `? super Void`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/ZKLogSegmentMetadataStore.java`
#### Snippet
```java
    public void deleteLogSegment(Transaction<Object> txn,
                                 final LogSegmentMetadata segment,
                                 final OpListener<Void> listener) {
        Op deleteOp = Op.delete(
                segment.getZkPath(),
```

### BoundedWildcard
Can generalize to `? super Map`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/subscription/ZKSubscriptionsStore.java`
#### Snippet
```java
    }

    private void getLastCommitPositions(final CompletableFuture<Map<String, DLSN>> result,
                                        List<String> subscribers) {
        List<CompletableFuture<Pair<String, DLSN>>> futures =
```

### BoundedWildcard
Can generalize to `? extends LedgerEntry`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/logsegment/BKLogSegmentEntryReader.java`
#### Snippet
```java
        void processReadEntries(int rc,
                                LedgerHandle lh,
                                Enumeration<LedgerEntry> entries,
                                Object ctx) {
            if (isDone()) {
```

### BoundedWildcard
Can generalize to `? extends Throwable`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/lock/ZKSessionLockFactory.java`
#### Snippet
```java
    void createLock(final String lockPath,
                    final DistributedLockContext context,
                    final AtomicReference<Throwable> interruptedException,
                    final AtomicInteger numRetries,
                    final CompletableFuture<SessionLock> createPromise,
```

### BoundedWildcard
Can generalize to `? super SessionLock`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/lock/ZKSessionLockFactory.java`
#### Snippet
```java
                    final AtomicReference<Throwable> interruptedException,
                    final AtomicInteger numRetries,
                    final CompletableFuture<SessionLock> createPromise,
                    final long delayMs) {
        lockStateExecutor.scheduleOrdered(lockPath, () -> {
```

### BoundedWildcard
Can generalize to `? extends T`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/federated/FederatedZKLogMetadataStore.java`
#### Snippet
```java
    }

    private <T> CompletableFuture<T> postStateCheck(CompletableFuture<T> future) {
        final CompletableFuture<T> postCheckedPromise = new CompletableFuture<T>();
        future.whenComplete(new FutureEventListener<T>() {
```

### BoundedWildcard
Can generalize to `? super Set`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/federated/FederatedZKLogMetadataStore.java`
#### Snippet
```java

    private void fetchSubNamespaces(Watcher watcher,
                                    final CompletableFuture<Set<URI>> promise) {
        try {
            zkc.get().getChildren(this.zkSubnamespacesPath, watcher,
```

### BoundedWildcard
Can generalize to `? extends Set`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/federated/FederatedZKLogMetadataStore.java`
#### Snippet
```java
    }

    private Iterator<String> getIterator(List<Set<String>> resultList) {
        List<Iterator<String>> iterList = Lists.newArrayListWithExpectedSize(resultList.size());
        for (Set<String> result : resultList) {
```

### BoundedWildcard
Can generalize to `? extends LogSegmentMetadata`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/util/DLUtils.java`
#### Snippet
```java
     * @return start sequence id
     */
    public static long computeStartSequenceId(List<LogSegmentMetadata> logSegmentDescList,
                                              LogSegmentMetadata segment)
            throws UnexpectedException {
```

### BoundedWildcard
Can generalize to `? extends LogSegmentMetadata`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/util/DLUtils.java`
#### Snippet
```java
     *         otherwise, return next log segment sequence number
     */
    public static Long nextLogSegmentSequenceNumber(List<LogSegmentMetadata> segmentListDesc) {
        int lastAssignedLogSegmentIdx = -1;
        Long lastAssignedLogSegmentSeqNo = null;
```

### BoundedWildcard
Can generalize to `? extends LogSegmentMetadata`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/util/DLUtils.java`
#### Snippet
```java
     * @return the first log segment whose transaction ids are not less than <code>transactionId</code>.
     */
    public static int findLogSegmentNotLessThanTxnId(List<LogSegmentMetadata> segments,
                                                     long transactionId) {
        int found = -1;
```

### BoundedWildcard
Can generalize to `? extends DLSN`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKDistributedLogManager.java`
#### Snippet
```java
    }

    protected CompletableFuture<AsyncLogReader> getAsyncLogReaderWithLock(final Optional<DLSN> fromDLSN,
                                                               final Optional<String> subscriberId) {
        if (!fromDLSN.isPresent() && !subscriberId.isPresent()) {
```

### BoundedWildcard
Can generalize to `? extends LogSegmentMetadata`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKDistributedLogManager.java`
#### Snippet
```java
    private CompletableFuture<DLSN> getDLSNNotLessThanTxIdInSegment(final long fromTxnId,
                                                         final int segmentIdx,
                                                         final List<LogSegmentMetadata> segments,
                                                         final LogSegmentEntryStore entryStore) {
        final LogSegmentMetadata segment = segments.get(segmentIdx);
```

### BoundedWildcard
Can generalize to `? super BKLogWriteHandler`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKDistributedLogManager.java`
#### Snippet
```java
                                    LedgerMetadata ledgerMetadata,
                                    boolean lockHandler,
                                    final CompletableFuture<BKLogWriteHandler> createPromise) {
        // Build the locks
        DistributedLock lock;
```

### BoundedWildcard
Can generalize to `? super BKLogReadHandler`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKDistributedLogManager.java`
#### Snippet
```java
    }

    <T> CompletableFuture<T> processReaderOperation(final Function<BKLogReadHandler, CompletableFuture<T>> func) {
        CompletableFuture<T> future = FutureUtils.createFuture();
        scheduler.submit(() -> {
```

### BoundedWildcard
Can generalize to `? extends CompletableFuture`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKDistributedLogManager.java`
#### Snippet
```java
    }

    <T> CompletableFuture<T> processReaderOperation(final Function<BKLogReadHandler, CompletableFuture<T>> func) {
        CompletableFuture<T> future = FutureUtils.createFuture();
        scheduler.submit(() -> {
```

### BoundedWildcard
Can generalize to `? extends LockWaiter`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/lock/ZKDistributedLock.java`
#### Snippet
```java
    }

    void interruptTryLock(final CompletableFuture<LockWaiter> tryLockFuture,
                          final CompletableFuture<Void> closePromise) {
        if (null == tryLockFuture) {
```

### BoundedWildcard
Can generalize to `? super ZKDistributedLock`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/lock/ZKDistributedLock.java`
#### Snippet
```java

    void waitForAcquire(final LockWaiter waiter,
                        final CompletableFuture<ZKDistributedLock> acquirePromise) {
        waiter.getAcquireFuture().whenCompleteAsync(
            new FutureEventListener<Boolean>() {
```

### BoundedWildcard
Can generalize to `? super String`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/feature/ConfigurationFeatureProvider.java`
#### Snippet
```java

    static SettableFeature makeFeature(ConcurrentBaseConfiguration featuresConf,
                                       ConcurrentMap<String, SettableFeature> features,
                                       String featureName) {
        SettableFeature feature = features.get(featureName);
```

### BoundedWildcard
Can generalize to `? super RequestT`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/limiter/ComposableRequestLimiter.java`
#### Snippet
```java
    public ComposableRequestLimiter(
            RateLimiter limiter,
            OverlimitFunction<RequestT> overlimitFunction,
            CostFunction<RequestT> costFunction,
            StatsLogger statsLogger) {
```

### BoundedWildcard
Can generalize to `? super RequestT`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/limiter/ComposableRequestLimiter.java`
#### Snippet
```java
            RateLimiter limiter,
            OverlimitFunction<RequestT> overlimitFunction,
            CostFunction<RequestT> costFunction,
            StatsLogger statsLogger) {
        checkNotNull(limiter);
```

### BoundedWildcard
Can generalize to `? extends RequestLimiter`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/limiter/ChainedRequestLimiter.java`
#### Snippet
```java
    }

    private ChainedRequestLimiter(ImmutableList<RequestLimiter<Request>> limiters,
                                  StatsLogger statsLogger) {
        this.limiters = limiters;
```

### BoundedWildcard
Can generalize to `? extends Op`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/metadata/ZKLogStreamMetadataStore.java`
#### Snippet
```java
    private CompletableFuture<Void> executeRenameTxn(String oldLogPath,
                                                     String newLogPath,
                                                     LinkedList<Op> createOps,
                                                     LinkedList<Op> deleteOps) {
        CompletableFuture<Void> future = FutureUtils.createFuture();
```

### BoundedWildcard
Can generalize to `? extends Op`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/metadata/ZKLogStreamMetadataStore.java`
#### Snippet
```java
                                                     String newLogPath,
                                                     LinkedList<Op> createOps,
                                                     LinkedList<Op> deleteOps) {
        CompletableFuture<Void> future = FutureUtils.createFuture();
        List<Op> zkOps = Lists.newArrayListWithExpectedSize(createOps.size() + deleteOps.size());
```

### BoundedWildcard
Can generalize to `? super List`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/metadata/ZKLogStreamMetadataStore.java`
#### Snippet
```java
                                  String basePath,
                                  LinkedList<String> missingPaths,
                                  CompletableFuture<List<String>> future) {
        if (basePath.equals(path)) {
            future.complete(missingPaths);
```

### BoundedWildcard
Can generalize to `? super Op`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/metadata/ZKLogStreamMetadataStore.java`
#### Snippet
```java
                                                      byte[] initData,
                                                      List<ACL> acls,
                                                      LinkedList<Op> createOps,
                                                      LinkedList<Op> deleteOps) {
        if (pathExists(pathData)) {
```

### BoundedWildcard
Can generalize to `? super Op`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/metadata/ZKLogStreamMetadataStore.java`
#### Snippet
```java
                                                      List<ACL> acls,
                                                      LinkedList<Op> createOps,
                                                      LinkedList<Op> deleteOps) {
        if (pathExists(pathData)) {
            createOps.addLast(Op.create(
```

### BoundedWildcard
Can generalize to `? super Op`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/metadata/ZKLogStreamMetadataStore.java`
#### Snippet
```java
                                                            String newSegmentsPath,
                                                            List<ACL> acls,
                                                            LinkedList<Op> createOps,
                                                            LinkedList<Op> deleteOps) {
        createOps.addLast(Op.create(
```

### BoundedWildcard
Can generalize to `? super Op`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/metadata/ZKLogStreamMetadataStore.java`
#### Snippet
```java
                                                            List<ACL> acls,
                                                            LinkedList<Op> createOps,
                                                            LinkedList<Op> deleteOps) {
        createOps.addLast(Op.create(
            newSegmentsPath + "/" + oldMetadata.getZNodeName(),
```

### BoundedWildcard
Can generalize to `? extends Versioned`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/metadata/ZKLogStreamMetadataStore.java`
#### Snippet
```java
                                                    String logName,
                                                    String logIdentifier,
                                                    List<Versioned<byte[]>> metadatas,
                                                    boolean ownAllocator)
            throws UnexpectedException {
```

### BoundedWildcard
Can generalize to `? extends Versioned`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/metadata/ZKLogStreamMetadataStore.java`
#### Snippet
```java
                                                    List<Op> zkOps,
                                                    List<byte[]> pathsToCreate,
                                                    List<Versioned<byte[]>> metadatas,
                                                    String logRootPath,
                                                    CompletableFuture<List<Versioned<byte[]>>> promise) {
```

### BoundedWildcard
Can generalize to `? super List`>
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/metadata/ZKLogStreamMetadataStore.java`
#### Snippet
```java
                                                    List<Versioned<byte[]>> metadatas,
                                                    String logRootPath,
                                                    CompletableFuture<List<Versioned<byte[]>>> promise) {

        zk.multi(zkOps, new AsyncCallback.MultiCallback() {
```

### BoundedWildcard
Can generalize to `? super LogSegmentMetadata`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/logsegment/PerStreamLogSegmentCache.java`
#### Snippet
```java
     * @throws UnexpectedException if unexpected condition detected (e.g. ledger sequence number gap)
     */
    public List<LogSegmentMetadata> getLogSegments(Comparator<LogSegmentMetadata> comparator)
        throws UnexpectedException {
        List<LogSegmentMetadata> segmentsToReturn;
```

### BoundedWildcard
Can generalize to `? super RespT`
in `stream/common/src/main/java/org/apache/bookkeeper/common/grpc/proxy/ProxyCall.java`
#### Snippet
```java
        private boolean needToRequest;

        public ResponseProxy(ServerCall<?, RespT> serverCall) {
            this.serverCall = serverCall;
        }
```

### BoundedWildcard
Can generalize to `? super ReqT`
in `stream/common/src/main/java/org/apache/bookkeeper/common/grpc/proxy/ProxyCall.java`
#### Snippet
```java
        private boolean needToRequest;

        public RequestProxy(ClientCall<ReqT, ?> clientCall) {
            this.clientCall = clientCall;
        }
```

### BoundedWildcard
Can generalize to `? super Long`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/auditor/DLAuditor.java`
#### Snippet
```java
    private List<Long> collectLedgersFromStream(Namespace namespace,
                                                String stream,
                                                Set<Long> ledgers)
            throws IOException {
        DistributedLogManager dlm = namespace.openLog(stream);
```

### BoundedWildcard
Can generalize to `? extends List`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/auditor/DLAuditor.java`
#### Snippet
```java
     * Find leak ledgers phase 2: collect ledgers from uris.
     */
    private Set<Long> collectLedgersFromDL(List<URI> uris, List<List<String>> allocationPaths)
            throws IOException {
        final Set<Long> ledgers = new TreeSet<Long>();
```

### BoundedWildcard
Can generalize to `? super Long`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/auditor/DLAuditor.java`
#### Snippet
```java
                                             final Namespace namespace,
                                             final List<String> allocationPaths,
                                             final Set<Long> ledgers) throws IOException {
        final LinkedBlockingQueue<String> poolQueue =
                new LinkedBlockingQueue<String>();
```

### BoundedWildcard
Can generalize to `? extends T`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/auditor/DLAuditor.java`
#### Snippet
```java
    }

    static <T> void executeAction(final LinkedBlockingQueue<T> queue,
                                  final int numThreads,
                                  final Action<T> action) throws IOException {
```

### BoundedWildcard
Can generalize to `? super T`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/auditor/DLAuditor.java`
#### Snippet
```java
    static <T> void executeAction(final LinkedBlockingQueue<T> queue,
                                  final int numThreads,
                                  final Action<T> action) throws IOException {
        final CountDownLatch failureLatch = new CountDownLatch(1);
        final CountDownLatch doneLatch = new CountDownLatch(queue.size());
```

### BoundedWildcard
Can generalize to `? extends LockWaiter`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/lock/ZKSessionLock.java`
#### Snippet
```java
    }

    synchronized LockWaiter waitForTry(Stopwatch stopwatch, CompletableFuture<LockWaiter> tryFuture)
            throws LockingException {
        boolean success = false;
```

### BoundedWildcard
Can generalize to `? super String`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/lock/ZKSessionLock.java`
#### Snippet
```java
     *          promise to satisfy with current lock owner
     */
    private void asyncTryLock(boolean wait, final CompletableFuture<String> result) {
        final CompletableFuture<String> lockResult = new CompletableFuture<String>();
        lockResult.whenComplete(new FutureEventListener<String>() {
```

### BoundedWildcard
Can generalize to `? extends T`
in `stream/common/src/main/java/org/apache/bookkeeper/common/util/ListenableFutures.java`
#### Snippet
```java
     * @return the completable future.
     */
    public static <T> CompletableFuture<T> fromListenableFuture(ListenableFuture<T> listenableFuture) {
        return fromListenableFuture(listenableFuture, Function.identity());
    }
```

### BoundedWildcard
Can generalize to `? extends NameResolverProvider`
in `stream/common/src/main/java/org/apache/bookkeeper/common/resolver/NameResolverProviderFactory.java`
#### Snippet
```java
    private final List<NameResolverProvider> providers;

    public NameResolverProviderFactory(List<NameResolverProvider> providers) {
        this.providers = providers;
    }
```

### BoundedWildcard
Can generalize to `? extends FileOutputStream`
in `bookkeeper-benchmark/src/main/java/org/apache/bookkeeper/benchmark/TestClient.java`
#### Snippet
```java
        final Random r;

        FileClient(List<FileOutputStream> streams, byte[] data, long time) {
            this.streams = streams;
            this.data = data;
```

### BoundedWildcard
Can generalize to `? extends LedgerHandle`
in `bookkeeper-benchmark/src/main/java/org/apache/bookkeeper/benchmark/TestClient.java`
#### Snippet
```java
        final AtomicLong outstanding = new AtomicLong(0);

        BKClient(List<LedgerHandle> handles, byte[] data, long time, boolean sync) {
            this.handles = handles;
            this.data = data;
```

### BoundedWildcard
Can generalize to `? extends LogSegmentMetadata`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java

        protected List<LogSegmentMetadata> inspectLogSegments(
                BookKeeperClient bkc, List<LogSegmentMetadata> segments) throws Exception {
            List<LogSegmentMetadata> segmentsToRepair = new ArrayList<LogSegmentMetadata>();
            for (LogSegmentMetadata segment : segments) {
```

### BoundedWildcard
Can generalize to `? super BookieId`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
        }

        void merge(Map<BookieId, Integer> m, BookieId bookie, Integer count) {
            if (m.containsKey(bookie)) {
                m.put(bookie, count + m.get(bookie));
```

### BoundedWildcard
Can generalize to `? super String`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                                    int tid,
                                    int numStreamsPerThreads,
                                    SortedMap<String, List<Pair<LogSegmentMetadata, List<String>>>> corruptedCandidates)
                throws Exception {
            int startIdx = tid * numStreamsPerThreads;
```

### BoundedWildcard
Can generalize to `? super List`>>
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                                    int tid,
                                    int numStreamsPerThreads,
                                    SortedMap<String, List<Pair<LogSegmentMetadata, List<String>>>> corruptedCandidates)
                throws Exception {
            int startIdx = tid * numStreamsPerThreads;
```

### BoundedWildcard
Can generalize to `? extends LogSegmentMetadata`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
        protected void repairLogSegments(LogSegmentMetadataStore metadataStore,
                                         BookKeeperClient bkc,
                                         List<LogSegmentMetadata> segments) throws Exception {
            BookKeeperAdmin bkAdmin = new BookKeeperAdmin(bkc.get());
            try {
```

### BoundedWildcard
Can generalize to `? extends CheckpointFile`
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/RocksdbRestoreTask.java`
#### Snippet
```java

    private void copyFilesFromRemote(String checkpointId,
                                     List<CheckpointFile> remoteFiles) throws IOException, TimeoutException {
        for (CheckpointFile file : remoteFiles) {
            file.copyFromRemote(checkpointStore, dbPrefix, checkpointId, idleWait);
```

### BoundedWildcard
Can generalize to `? extends CheckpointFile`
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/RocksdbCheckpointTask.java`
#### Snippet
```java
     */
    private void finalizeCopyFiles(String checkpointId,
                                   List<CheckpointFile> files) throws IOException {
        for (CheckpointFile file : files) {
            file.finalize(checkpointStore, dbPrefix, checkpointId,
```

### BoundedWildcard
Can generalize to `? extends CheckpointFile`
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/RocksdbCheckpointTask.java`
#### Snippet
```java
     * All sst files are copied to checkpoint location first.
     */
    private void copyFilesToDest(String checkpointId, List<CheckpointFile> files) throws IOException {
        for (CheckpointFile file : files) {
            file.copyToRemote(checkpointStore, dbPrefix, checkpointId);
```

### BoundedWildcard
Can generalize to `? extends CheckpointFile`
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/RocksdbCheckpointTask.java`
#### Snippet
```java
    private void cleanupRemoteCheckpoints(File checkpointedDir,
                                          String checkpointToExclude,
                                          List<CheckpointFile> filesToKeep) throws IOException {
        String checkpointsPath = RocksUtils.getDestCheckpointsPath(dbPrefix);
        List<String> checkpoints = checkpointStore.listFiles(checkpointsPath);
```

### BoundedWildcard
Can generalize to `? super String`
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/RocksdbCheckpointTask.java`
#### Snippet
```java
    }

    public void setInjectedError(InjectedError<String> injectedError) {
        this.injectedError = injectedError;
    }
```

### BoundedWildcard
Can generalize to `? extends T`
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/ReflectionUtils.java`
#### Snippet
```java
    public static <T> Class<? extends T> getClass(Configuration conf,
                                                  String name, Class<? extends T> defaultValue,
                                                  Class<T> xface, ClassLoader classLoader)
        throws ConfigurationException {
        try {
```

### BoundedWildcard
Can generalize to `? extends T`
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/ReflectionUtils.java`
#### Snippet
```java
     */
    public static <T> Class<? extends T> forName(String className,
                                                 Class<T> xface) {

        // Construct the class
```

### BoundedWildcard
Can generalize to `? extends T`
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/journal/AbstractStateStoreWithJournal.java`
#### Snippet
```java

    private <T> CompletableFuture<T> executeIO(ScheduledExecutorService scheduler,
                                               Callable<T> callable) {
        synchronized (this) {
            if (null != closeFuture) {
```

### BoundedWildcard
Can generalize to `? extends ScheduledExecutorService`
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/SharedResourceManager.java`
#### Snippet
```java
    private ScheduledExecutorService destroyer;

    private SharedResourceManager(Supplier<ScheduledExecutorService> destroyerFactory) {
        this.destroyerFactory = destroyerFactory;
    }
```

### BoundedWildcard
Can generalize to `? extends T`
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/Watchable.java`
#### Snippet
```java
     * @param value value to notify
     */
    public <R> void notifyWatchers(Function<R, T> valueFn, R value) {
        RecyclableArrayList<Watcher<T>> watchersLocal;
        synchronized (this) {
```

### BoundedWildcard
Can generalize to `? super Throwable`
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/SafeRunnable.java`
#### Snippet
```java
     * @return
     */
    static SafeRunnable safeRun(Runnable runnable, Consumer<Throwable> exceptionHandler) {
        return () -> {
            try {
```

### BoundedWildcard
Can generalize to `? extends ConfigKeyGroup`
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/conf/ConfigDef.java`
#### Snippet
```java
    private final Map<String, ConfigKey> keys;

    private ConfigDef(Set<ConfigKeyGroup> groups,
                      Map<String, Set<ConfigKey>> settings) {
        this.groups = groups;
```

### BoundedWildcard
Can generalize to `? extends T`
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/OrderedExecutor.java`
#### Snippet
```java
        private final Map<String, String> mdcContextMap;

        ContextPreservingCallable(Callable<T> callable) {
            this.callable = callable;
            this.mdcContextMap = MDC.getCopyOfContextMap();
```

### BoundedWildcard
Can generalize to `? extends T`
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/OrderedExecutor.java`
#### Snippet
```java
    }

    public <T> ListenableFuture<T> submitOrdered(long orderingKey, Callable<T> task) {
        SettableFuture<T> future = SettableFuture.create();
        executeOrdered(orderingKey, () -> {
```

### BoundedWildcard
Can generalize to `? extends T`
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/OrderedExecutor.java`
#### Snippet
```java
        final long initNanos;

        TimedCallable(Callable<T> callable) {
            this.callable = callable;
            this.initNanos = MathUtils.nowInNano();
```

### BoundedWildcard
Can generalize to `? extends LifecycleComponent`
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/component/LifecycleComponentStack.java`
#### Snippet
```java
    private LifecycleComponentStack(String name,
                                    ComponentInfoPublisher componentInfoPublisher,
                                    ImmutableList<LifecycleComponent> components) {
        this.name = name;
        this.componentInfoPublisher = componentInfoPublisher;
```

### BoundedWildcard
Can generalize to `? super ReturnT`
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/Retries.java`
#### Snippet
```java

    private static <ReturnT> void execute(
        CompletableFuture<ReturnT> finalResult,
        Iterator<Long> backoffIter,
        Predicate<Throwable> retryPredicate,
```

### BoundedWildcard
Can generalize to `? super Throwable`
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/Retries.java`
#### Snippet
```java
        CompletableFuture<ReturnT> finalResult,
        Iterator<Long> backoffIter,
        Predicate<Throwable> retryPredicate,
        Supplier<CompletableFuture<ReturnT>> task,
        OrderedScheduler scheduler,
```

### BoundedWildcard
Can generalize to `? extends CompletableFuture`
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/Retries.java`
#### Snippet
```java
        Iterator<Long> backoffIter,
        Predicate<Throwable> retryPredicate,
        Supplier<CompletableFuture<ReturnT>> task,
        OrderedScheduler scheduler,
        Object key) {
```

### BoundedWildcard
Can generalize to `? extends T`
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/collections/BatchedArrayBlockingQueue.java`
#### Snippet
```java
    }

    public int putAll(List<T> c) throws InterruptedException {
        lock.lockInterruptibly();

```

### BoundedWildcard
Can generalize to `? super Throwable`
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/concurrent/FutureUtils.java`
#### Snippet
```java
    public static <T, ExceptionT extends Throwable> T result(
        CompletableFuture<T> future,
        Function<Throwable, ExceptionT> exceptionHandler,
        long timeout,
        TimeUnit timeUnit) throws ExceptionT, TimeoutException {
```

### BoundedWildcard
Can generalize to `? super Throwable`
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/concurrent/FutureUtils.java`
#### Snippet
```java
    @SneakyThrows(InterruptedException.class)
    public static <T, ExceptionT extends Throwable> T result(
        CompletableFuture<T> future, Function<Throwable, ExceptionT> exceptionHandler) throws ExceptionT {
        try {
            try {
```

### BoundedWildcard
Can generalize to `? extends T`
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/concurrent/FutureUtils.java`
#### Snippet
```java
    }

    public static <T> void proxyTo(CompletableFuture<T> src,
                                   CompletableFuture<T> target) {
        src.whenComplete((value, cause) -> {
```

### BoundedWildcard
Can generalize to `? super T`
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/concurrent/FutureUtils.java`
#### Snippet
```java

    public static <T> void proxyTo(CompletableFuture<T> src,
                                   CompletableFuture<T> target) {
        src.whenComplete((value, cause) -> {
            if (null == cause) {
```

### BoundedWildcard
Can generalize to `? super T`
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/concurrent/FutureUtils.java`
#### Snippet
```java

        ListFutureProcessor(List<T> items,
                            Function<T, CompletableFuture<R>> processFunc,
                            ExecutorService callbackExecutor) {
            this.itemsIter = items.iterator();
```

### BoundedWildcard
Can generalize to `? extends CompletableFuture`
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/concurrent/FutureUtils.java`
#### Snippet
```java

        ListFutureProcessor(List<T> items,
                            Function<T, CompletableFuture<R>> processFunc,
                            ExecutorService callbackExecutor) {
            this.itemsIter = items.iterator();
```

### BoundedWildcard
Can generalize to `? extends CompletableFuture`
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/concurrent/FutureUtils.java`
#### Snippet
```java
    }

    public static <T> CompletableFuture<List<T>> collect(List<CompletableFuture<T>> futureList) {
        CompletableFuture<Void> finalFuture =
            CompletableFuture.allOf(futureList.toArray(new CompletableFuture[futureList.size()]));
```

### BoundedWildcard
Can generalize to `? extends T`
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/concurrent/FutureUtils.java`
#### Snippet
```java
    }

    public static <T> CompletableFuture<T> rescue(CompletableFuture<T> future,
                                                  Function<Throwable, CompletableFuture<T>> rescueFuc) {
        CompletableFuture<T> result = FutureUtils.createFuture();
```

### BoundedWildcard
Can generalize to `? super Throwable`
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/concurrent/FutureUtils.java`
#### Snippet
```java

    public static <T> CompletableFuture<T> rescue(CompletableFuture<T> future,
                                                  Function<Throwable, CompletableFuture<T>> rescueFuc) {
        CompletableFuture<T> result = FutureUtils.createFuture();
        future.whenComplete((value, cause) -> {
```

### BoundedWildcard
Can generalize to `? extends CompletableFuture`
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/concurrent/FutureUtils.java`
#### Snippet
```java

    public static <T> CompletableFuture<T> rescue(CompletableFuture<T> future,
                                                  Function<Throwable, CompletableFuture<T>> rescueFuc) {
        CompletableFuture<T> result = FutureUtils.createFuture();
        future.whenComplete((value, cause) -> {
```

### BoundedWildcard
Can generalize to `? super MVCCRecord`
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/mvcc/MVCCStoreImpl.java`
#### Snippet
```java
                               MVCCRecord record,
                               List<byte[]> resultKeys,
                               List<MVCCRecord> resultValues,
                               MutableLong numKvs,
                               RangeOption<K> rangeOption,
```

### BoundedWildcard
Can generalize to `? extends MVCCRecord`
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/mvcc/MVCCStoreImpl.java`
#### Snippet
```java
    }

    private List<KeyValue<K, V>> toKvs(List<byte[]> keys, List<MVCCRecord> records) {
        List<KeyValue<K, V>> kvs = Lists.newArrayListWithExpectedSize(keys.size());

```

### BoundedWildcard
Can generalize to `? extends K`
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/mvcc/MVCCStoreImpl.java`
#### Snippet
```java
    }

    DeleteResult<K, V> delete(long revision, WriteBatch batch, DeleteOp<K, V> op, boolean allowBlind) {
        // parameters
        final K key = op.key();
```

### BoundedWildcard
Can generalize to `? extends V`
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/mvcc/MVCCStoreImpl.java`
#### Snippet
```java

    boolean processCompareOp(@Nullable MVCCRecord record,
                             CompareOp<K, V> op) {
        int cmp;
        switch (op.target()) {
```

## RuleId[id=MissortedModifiers]
### MissortedModifiers
Missorted modifiers `final @VisibleForTesting`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadOnlyLedgerHandle.java`
#### Snippet
```java
     */
    void recover(GenericCallback<Void> finalCb,
                 final @VisibleForTesting ReadEntryListener listener,
                 final boolean forceRecovery) {
        final GenericCallback<Void> cb = new TimedGenericCallback<Void>(
```

### MissortedModifiers
Missorted modifiers `final static`
in `circe-checksum/src/main/java/com/scurrilous/circe/checksum/Crc32cIntChecksum.java`
#### Snippet
```java
public class Crc32cIntChecksum {

    private final static IntHash CRC32C_HASH;

    static {
```

## RuleId[id=NegativeIntConstantInLongContext]
### NegativeIntConstantInLongContext
Negative int hexadecimal constant in long context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryLocation.java`
#### Snippet
```java
            .append("ledger=").append(ledger)
            .append(",entry=").append(entry)
            .append(",locationLog=").append(location >> 32 & 0xFFFFFFFF)
            .append(",locationOffset=").append((int) (location & 0xFFFFFFFF))
            .append("}").toString();
```

### NegativeIntConstantInLongContext
Negative int hexadecimal constant in long context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryLocation.java`
#### Snippet
```java
            .append(",entry=").append(entry)
            .append(",locationLog=").append(location >> 32 & 0xFFFFFFFF)
            .append(",locationOffset=").append((int) (location & 0xFFFFFFFF))
            .append("}").toString();
    }
```

### NegativeIntConstantInLongContext
Negative int hexadecimal constant in long context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectEntryLogger.java`
#### Snippet
```java
            throws IOException, NoEntryException {
        int logId = (int) (location >> 32);
        int pos = (int) (location & 0xFFFFFFFF);

        long start = System.nanoTime();
```

## RuleId[id=AnonymousHasLambdaAlternative]
### AnonymousHasLambdaAlternative
Anonymous new ThreadLocal() can be replaced with ThreadLocal.withInitial()
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/LegacyHierarchicalLedgerManager.java`
#### Snippet
```java
    private static final String MIN_ID_SUFFIX = "0000";

    private static final ThreadLocal<StringBuilder> threadLocalNodeBuilder = new ThreadLocal<StringBuilder>() {
        @Override
        protected StringBuilder initialValue() {
```

### AnonymousHasLambdaAlternative
Anonymous new ThreadLocal\>() can be replaced with ThreadLocal.withInitial()
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/DefaultEntryLogger.java`
#### Snippet
```java
     */
    private final ThreadLocal<Map<Long, BufferedReadChannel>> logid2Channel =
            new ThreadLocal<Map<Long, BufferedReadChannel>>() {
        @Override
        public Map<Long, BufferedReadChannel> initialValue() {
```

### AnonymousHasLambdaAlternative
Anonymous new ThreadLocal() can be replaced with ThreadLocal.withInitial()
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectEntryLoggerStats.java`
#### Snippet
```java

    private static synchronized void setStats(StatsLogger stats) {
        readEntryStats = new ThreadLocal<OpStatsLogger>() {
            @Override
            public OpStatsLogger initialValue() {
```

### AnonymousHasLambdaAlternative
Anonymous new ThreadLocal() can be replaced with ThreadLocal.withInitial()
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectEntryLoggerStats.java`
#### Snippet
```java
            }
        };
        readBlockStats = new ThreadLocal<OpStatsLogger>() {
            @Override
            public OpStatsLogger initialValue() {
```

### AnonymousHasLambdaAlternative
Anonymous new ThreadLocal() can be replaced with ThreadLocal.withInitial()
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectEntryLoggerStats.java`
#### Snippet
```java
        };

        DirectEntryLoggerStats.openReaderStats = new ThreadLocal<Counter>() {
            @Override
            public Counter initialValue() {
```

### AnonymousHasLambdaAlternative
Anonymous new ThreadLocal() can be replaced with ThreadLocal.withInitial()
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectEntryLoggerStats.java`
#### Snippet
```java
        };

        DirectEntryLoggerStats.closeReaderStats = new ThreadLocal<Counter>() {
            @Override
            public Counter initialValue() {
```

### AnonymousHasLambdaAlternative
Anonymous new ThreadLocal() can be replaced with ThreadLocal.withInitial()
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectEntryLoggerStats.java`
#### Snippet
```java
        };

        DirectEntryLoggerStats.cachedReadersServedClosed = new ThreadLocal<Counter>() {
            @Override
            public Counter initialValue() {
```

### AnonymousHasLambdaAlternative
Anonymous new ThreadLocal\>() can be replaced with ThreadLocal.withInitial()
in `bookkeeper-slogger/api/src/main/java/org/apache/bookkeeper/slogger/AbstractSlogger.java`
#### Snippet
```java
    private List<String> parentCtx;

    private ThreadLocal<List<Object>> kvs = new ThreadLocal<List<Object>>() {
            @Override
            protected List<Object> initialValue() {
```

### AnonymousHasLambdaAlternative
Anonymous new ThreadLocal() can be replaced with ThreadLocal.withInitial()
in `bookkeeper-slogger/api/src/main/java/org/apache/bookkeeper/slogger/AbstractSlogger.java`
#### Snippet
```java
    }

    private final ThreadLocal<CtxIterator> iterator = new ThreadLocal<CtxIterator>() {
            @Override
            protected CtxIterator initialValue() {
```

### AnonymousHasLambdaAlternative
Anonymous new Thread() can be replaced with new Thread(() -\> {...})
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LocalDLMEmulator.java`
#### Snippet
```java
        this.lb = LocalBookKeeper.getLocalBookies(zkHost, zkPort,
                numBookies, shouldStartZK, serverConf);
        this.bkStartupThread = new Thread() {
            public void run() {
                try {
```

### AnonymousHasLambdaAlternative
Anonymous new Thread() can be replaced with new Thread(() -\> {...})
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LocalDLMEmulator.java`
#### Snippet
```java
                .build();

            Runtime.getRuntime().addShutdownHook(new Thread() {
                @Override
                public void run() {
```

### AnonymousHasLambdaAlternative
Anonymous new Thread() can be replaced with new Thread(() -\> {...})
in `bookkeeper-benchmark/src/main/java/org/apache/bookkeeper/benchmark/BenchReadThroughputLatency.java`
#### Snippet
```java
                                            final Long ledgerId = Long.valueOf(m.group(1));
                                            processedLedgers.add(ledger);
                                            Thread t = new Thread() {
                                                @Override
                                                public void run() {
```

### AnonymousHasLambdaAlternative
Anonymous new Thread() can be replaced with new Thread(() -\> {...})
in `bookkeeper-benchmark/src/main/java/org/apache/bookkeeper/benchmark/BenchThroughputLatency.java`
#### Snippet
```java
        int sent = 0;

        Thread reporter = new Thread() {
                @Override
                public void run() {
```

### AnonymousHasLambdaAlternative
Anonymous new ThreadLocal\>() can be replaced with ThreadLocal.withInitial()
in `bookkeeper-slogger/slf4j/src/main/java/org/apache/bookkeeper/slogger/slf4j/Slf4jSlogger.java`
#### Snippet
```java
 */
public class Slf4jSlogger extends AbstractSlogger {
    private ThreadLocal<List<String>> mdcKeysTls = new ThreadLocal<List<String>>() {
            @Override
            protected List<String> initialValue() {
```

## RuleId[id=WhileLoopSpinsOnField]
### WhileLoopSpinsOnField
`while` loop spins on field
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/collections/BatchedArrayBlockingQueue.java`
#### Snippet
```java
        lock.lockInterruptibly();
        try {
            while (size == 0) {
                if (remainingTimeNanos <= 0L) {
                    return null;
```

### WhileLoopSpinsOnField
`while` loop spins on field
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/collections/BatchedArrayBlockingQueue.java`
#### Snippet
```java
        lock.lock();
        try {
            while (size > 0) {
                dequeueOne();
            }
```

### WhileLoopSpinsOnField
`while` loop spins on field
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/collections/BatchedArrayBlockingQueue.java`
#### Snippet
```java

        try {
            while (size == 0) {
                notEmpty.await();
            }
```

### WhileLoopSpinsOnField
`while` loop spins on field
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/collections/BatchedArrayBlockingQueue.java`
#### Snippet
```java
        lock.lockInterruptibly();
        try {
            while (size == 0) {
                if (waitForever) {
                    notEmpty.await();
```

## RuleId[id=MalformedFormatString]
### MalformedFormatString
Too many arguments for format string (found: 3, expected: 0)
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
                    List<byte[]> cfNames = RocksDB.listColumnFamilies(opts, dbDir.getAbsolutePath());
                    if (!cfNames.contains(wanted) && cfNames.contains(other)) {
                        throw new StateStoreException(String.format("{}: expected {} column family, found {}",
                                dbDir.getAbsolutePath(), wanted, other));
                    }
```

## RuleId[id=DefaultAnnotationParam]
### DefaultAnnotationParam
Redundant default parameter value assignment
in `microbenchmarks/src/main/java/org/apache/bookkeeper/proto/checksum/DigestManagerBenchmark.java`
#### Snippet
```java
    @BenchmarkMode(Mode.Throughput)
    @OutputTimeUnit(TimeUnit.MICROSECONDS)
    @Warmup(iterations = 2, time = 3, timeUnit = TimeUnit.SECONDS)
    @Measurement(iterations = 3, time = 10, timeUnit = TimeUnit.SECONDS)
    @Threads(2)
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `microbenchmarks/src/main/java/org/apache/bookkeeper/proto/checksum/DigestManagerBenchmark.java`
#### Snippet
```java
    @OutputTimeUnit(TimeUnit.MICROSECONDS)
    @Warmup(iterations = 2, time = 3, timeUnit = TimeUnit.SECONDS)
    @Measurement(iterations = 3, time = 10, timeUnit = TimeUnit.SECONDS)
    @Threads(2)
    @Fork(1)
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `microbenchmarks/src/main/java/org/apache/bookkeeper/stats/StatsLoggerBenchmark.java`
#### Snippet
```java
@Threads(16)
@Fork(1)
@Warmup(iterations = 1, time = 10, timeUnit = TimeUnit.SECONDS)
@Measurement(iterations = 3, time = 10, timeUnit = TimeUnit.SECONDS)
public class StatsLoggerBenchmark {
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `microbenchmarks/src/main/java/org/apache/bookkeeper/stats/StatsLoggerBenchmark.java`
#### Snippet
```java
@Fork(1)
@Warmup(iterations = 1, time = 10, timeUnit = TimeUnit.SECONDS)
@Measurement(iterations = 3, time = 10, timeUnit = TimeUnit.SECONDS)
public class StatsLoggerBenchmark {

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `microbenchmarks/src/main/java/org/apache/bookkeeper/proto/checksum/DigestTypeBenchmark.java`
#### Snippet
```java
    @BenchmarkMode(Mode.Throughput)
    @OutputTimeUnit(TimeUnit.MILLISECONDS)
    @Warmup(iterations = 2, time = 3, timeUnit = TimeUnit.SECONDS)
    @Measurement(iterations = 2, time = 10, timeUnit = TimeUnit.SECONDS)
    @Threads(2)
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `microbenchmarks/src/main/java/org/apache/bookkeeper/proto/checksum/DigestTypeBenchmark.java`
#### Snippet
```java
    @OutputTimeUnit(TimeUnit.MILLISECONDS)
    @Warmup(iterations = 2, time = 3, timeUnit = TimeUnit.SECONDS)
    @Measurement(iterations = 2, time = 10, timeUnit = TimeUnit.SECONDS)
    @Threads(2)
    @Fork(value = 1, warmups = 1)
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `microbenchmarks/src/main/java/org/apache/bookkeeper/common/OrderedExecutorBenchmark.java`
#### Snippet
```java
@Threads(16)
@Fork(1)
@Warmup(iterations = 1, time = 10, timeUnit = TimeUnit.SECONDS)
@Measurement(iterations = 3, time = 10, timeUnit = TimeUnit.SECONDS)
public class OrderedExecutorBenchmark {
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `microbenchmarks/src/main/java/org/apache/bookkeeper/common/OrderedExecutorBenchmark.java`
#### Snippet
```java
@Fork(1)
@Warmup(iterations = 1, time = 10, timeUnit = TimeUnit.SECONDS)
@Measurement(iterations = 3, time = 10, timeUnit = TimeUnit.SECONDS)
public class OrderedExecutorBenchmark {

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `microbenchmarks/src/main/java/org/apache/bookkeeper/stats/codahale/TimerBenchmark.java`
#### Snippet
```java
    @BenchmarkMode(Mode.Throughput)
    @OutputTimeUnit(TimeUnit.MILLISECONDS)
    @Warmup(iterations = 2, time = 3, timeUnit = TimeUnit.SECONDS)
    @Measurement(iterations = 2, time = 10, timeUnit = TimeUnit.SECONDS)
    @Threads(4)
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `microbenchmarks/src/main/java/org/apache/bookkeeper/stats/codahale/TimerBenchmark.java`
#### Snippet
```java
    @OutputTimeUnit(TimeUnit.MILLISECONDS)
    @Warmup(iterations = 2, time = 3, timeUnit = TimeUnit.SECONDS)
    @Measurement(iterations = 2, time = 10, timeUnit = TimeUnit.SECONDS)
    @Threads(4)
    @Fork(value = 1, warmups = 1)
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `microbenchmarks/src/main/java/org/apache/bookkeeper/stats/codahale/TimerBenchmark.java`
#### Snippet
```java
    @BenchmarkMode(Mode.Throughput)
    @OutputTimeUnit(TimeUnit.MILLISECONDS)
    @Warmup(iterations = 2, time = 3, timeUnit = TimeUnit.SECONDS)
    @Measurement(iterations = 2, time = 10, timeUnit = TimeUnit.SECONDS)
    @Threads(4)
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `microbenchmarks/src/main/java/org/apache/bookkeeper/stats/codahale/TimerBenchmark.java`
#### Snippet
```java
    @OutputTimeUnit(TimeUnit.MILLISECONDS)
    @Warmup(iterations = 2, time = 3, timeUnit = TimeUnit.SECONDS)
    @Measurement(iterations = 2, time = 10, timeUnit = TimeUnit.SECONDS)
    @Threads(4)
    @Fork(value = 1, warmups = 1)
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `microbenchmarks/src/main/java/org/apache/bookkeeper/common/MpScQueueBenchmark.java`
#### Snippet
```java
@Threads(16)
@Fork(1)
@Warmup(iterations = 1, time = 10, timeUnit = TimeUnit.SECONDS)
@Measurement(iterations = 3, time = 10, timeUnit = TimeUnit.SECONDS)
public class MpScQueueBenchmark {
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `microbenchmarks/src/main/java/org/apache/bookkeeper/common/MpScQueueBenchmark.java`
#### Snippet
```java
@Fork(1)
@Warmup(iterations = 1, time = 10, timeUnit = TimeUnit.SECONDS)
@Measurement(iterations = 3, time = 10, timeUnit = TimeUnit.SECONDS)
public class MpScQueueBenchmark {

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookie/RegenerateInterleavedStorageIndexFileCommand.java`
#### Snippet
```java
        @Parameter(names = { "-l", "--ledgerids" },
            description = "Ledger(s) whose index needs to be regenerated. Multiple can be specified, comma separated.",
            splitter = CommaParameterSplitter.class)
        private List<Long> ledgerIds;

```

## RuleId[id=IfStatementWithIdenticalBranches]
### IfStatementWithIdenticalBranches
Common part can be extracted from 'if'
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/cluster/ClusterControllerLeaderImpl.java`
#### Snippet
```java
        if (null == availableServersSnapshot || availableServersSnapshot.isEmpty()) {
            // haven't received any servers from registration service, wait for 200ms and retry.
            if (lastSuccessfulAssigmentAt < 0) {
                log.info("No servers is alive yet. Backoff 200ms and retry.");
                TimeUnit.MILLISECONDS.sleep(200);
```

### IfStatementWithIdenticalBranches
Common part can be extracted removing branch
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentOpenHashMap.java`
#### Snippet
```java

                    if (key.equals(storedKey)) {
                        if (!onlyIfAbsent) {
                            // Over written an old value for same key
                            table[bucket + 1] = value;
```

### IfStatementWithIdenticalBranches
Common part can be extracted from 'if'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryLoggerAllocator.java`
#### Snippet
```java
        synchronized (createEntryLogLock) {
            BufferedLogChannel bc;
            if (!entryLogPreAllocationEnabled){
                // create a new log directly
                bc = allocateNewLog(dirForNextEntryLog);
```

### IfStatementWithIdenticalBranches
Common part can be extracted removing branch
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentLongLongHashMap.java`
#### Snippet
```java

                    if (key == storedKey) {
                        if (!onlyIfAbsent) {
                            // Over written an old value for same key
                            table[bucket + 1] = value;
```

### IfStatementWithIdenticalBranches
Common part can be extracted from 'if'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/http/service/WhoIsAuditorService.java`
#### Snippet
```java
        HttpServiceResponse response = new HttpServiceResponse();

        if (HttpServer.Method.GET == request.getMethod()) {
            BookieId bookieId;
            try {
```

### IfStatementWithIdenticalBranches
Common part can be extracted from 'if'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/http/service/ListDiskFilesService.java`
#### Snippet
```java
        Map<String, String> params = request.getParams();

        if (HttpServer.Method.GET == request.getMethod()) {
            /**
             * output:
```

### IfStatementWithIdenticalBranches
Common part can be extracted from 'if'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/http/service/ListUnderReplicatedLedgerService.java`
#### Snippet
```java
                    }
                }
                if (!hasURLedgers) {
                    response.setCode(HttpServer.StatusCode.NOT_FOUND);
                    response.setBody("No under replicated ledgers found");
```

### IfStatementWithIdenticalBranches
Common part can be extracted from 'if'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/http/service/ReadLedgerEntryService.java`
#### Snippet
```java
        Map<String, String> params = request.getParams();

        if (HttpServer.Method.GET == request.getMethod() && (params != null) && params.containsKey("ledger_id")) {
            Long ledgerId = Long.parseLong(params.get("ledger_id"));
            Long startEntryId = 0L;
```

### IfStatementWithIdenticalBranches
Common part can be extracted from 'if'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/http/service/TriggerAuditService.java`
#### Snippet
```java
        HttpServiceResponse response = new HttpServiceResponse();

        if (HttpServer.Method.PUT == request.getMethod()) {
            try {
                bka.triggerAudit();
```

### IfStatementWithIdenticalBranches
Common part can be extracted from 'if'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/http/service/LostBookieRecoveryDelayService.java`
#### Snippet
```java
            @SuppressWarnings("unchecked")
            HashMap<String, Integer> configMap = JsonUtil.fromJson(requestBody, HashMap.class);
            if (configMap != null && configMap.containsKey("delay_seconds")) {
                int delaySeconds = configMap.get("delay_seconds");
                bka.setLostBookieRecoveryDelay(delaySeconds);
```

### IfStatementWithIdenticalBranches
Common part can be extracted from 'if'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/http/service/GetLedgerMetaService.java`
#### Snippet
```java
        Map<String, String> params = request.getParams();

        if (HttpServer.Method.GET == request.getMethod() && (params != null) && params.containsKey("ledger_id")) {
            Long ledgerId = Long.parseLong(params.get("ledger_id"));

```

### IfStatementWithIdenticalBranches
Common part can be extracted from 'if'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/http/service/ListBookiesService.java`
#### Snippet
```java
        HttpServiceResponse response = new HttpServiceResponse();
        // GET
        if (HttpServer.Method.GET == request.getMethod()) {
            Collection<BookieId> bookies = new ArrayList<BookieId>();

```

### IfStatementWithIdenticalBranches
Common part can be extracted from 'if'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/http/service/DeleteLedgerService.java`
#### Snippet
```java
        if (HttpServer.Method.DELETE == request.getMethod()) {
            Map<String, String> params = request.getParams();
            if (params != null && params.containsKey("ledger_id")) {
                ClientConfiguration clientConf = new ClientConfiguration();
                clientConf.addConfiguration(conf);
```

### IfStatementWithIdenticalBranches
Common part can be extracted from 'if'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/http/service/ExpandStorageService.java`
#### Snippet
```java
        HttpServiceResponse response = new HttpServiceResponse();

        if (HttpServer.Method.PUT == request.getMethod()) {
            File[] ledgerDirectories = BookieImpl.getCurrentDirectories(conf.getLedgerDirs());
            File[] journalDirectories = BookieImpl.getCurrentDirectories(conf.getJournalDirs());
```

### IfStatementWithIdenticalBranches
Common part can be extracted from 'if'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/http/service/GCDetailsService.java`
#### Snippet
```java
        HttpServiceResponse response = new HttpServiceResponse();

        if (HttpServer.Method.GET == request.getMethod()) {
            List<GarbageCollectionStatus> details = bookieServer.getBookie()
                .getLedgerStorage().getGarbageCollectionStatus();
```

### IfStatementWithIdenticalBranches
Common part can be extracted from 'if'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/http/service/ListBookieInfoService.java`
#### Snippet
```java
        HttpServiceResponse response = new HttpServiceResponse();

        if (HttpServer.Method.GET == request.getMethod()) {
            ClientConfiguration clientConf = new ClientConfiguration(conf);
            clientConf.setDiskWeightBasedPlacementEnabled(true);
```

### IfStatementWithIdenticalBranches
Common part can be extracted from 'if'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/http/service/RecoveryBookieService.java`
#### Snippet
```java
        }

        if (HttpServer.Method.PUT == request.getMethod() && !requestJsonBody.bookieSrc.isEmpty()) {
            runFunctionWithRegistrationManager(conf, rm -> {
                final String bookieSrcSerialized = requestJsonBody.bookieSrc.get(0);
```

### IfStatementWithIdenticalBranches
Common part can be extracted from 'if'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/http/service/ListLedgerService.java`
#### Snippet
```java
        // GET
        // parameter could be like: print_metadata=true&page=PageIndex
        if (HttpServer.Method.GET == request.getMethod()) {
            Map<String, String> params = request.getParams();
            // default not print metadata
```

### IfStatementWithIdenticalBranches
Common part can be extracted from 'if'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogWriteHandler.java`
#### Snippet
```java
        long highestTxIdWritten = maxTxId.get();
        if (txId < highestTxIdWritten) {
            if (highestTxIdWritten == DistributedLogConstants.MAX_TXID) {
                LOG.error("We've already marked the stream as ended and attempting to start a new log segment");
                FutureUtils.completeExceptionally(promise,
```

## RuleId[id=UnnecessarySuperQualifier]
### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/zk/ZKMetadataBookieDriver.java`
#### Snippet
```java
                                                        StatsLogger statsLogger)
            throws MetadataException {
        super.initialize(
            conf,
            statsLogger.scope(BOOKIE_SCOPE),
```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/zk/ZKMetadataClientDriver.java`
#### Snippet
```java
                                                        Optional<Object> optionalCtx)
            throws MetadataException {
        super.initialize(
            conf,
            statsLogger,
```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/ReadEntryProcessor.java`
#### Snippet
```java
    private void recycle() {
        request.recycle();
        super.reset();
        this.recyclerHandle.recycle(this);
    }
```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/LongPollReadEntryProcessorV3.java`
#### Snippet
```java
                    }
                    try {
                        return super.readEntry(readResponseBuilder, entryId, true, startTimeSw);
                    } catch (Bookie.NoEntryException e) {
                        requestProcessor.getRequestStats().getReadLastEntryNoEntryErrorCounter().inc();
```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/LongPollReadEntryProcessorV3.java`
#### Snippet
```java
            }
        } else {
            return super.readEntry(readResponseBuilder, entryId, false, startTimeSw);
        }
    }
```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/AuthHandler.java`
#### Snippet
```java
                if (authenticated) {
                    super.write(ctx, msg, promise);
                    super.flush(ctx);
                } else if (msg instanceof BookkeeperProtocol.Request) {
                    // let auth messages through, queue the rest
```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/AuthHandler.java`
#### Snippet
```java
                        || req.getHeader().getOperation() == BookkeeperProtocol.OperationType.START_TLS) {
                        super.write(ctx, msg, promise);
                        super.flush(ctx);
                    } else {
                        waitingForAuth.add(msg);
```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/AuthHandler.java`
#### Snippet
```java
                    if (BookieProtocol.AUTH == req.getOpCode()) {
                        super.write(ctx, msg, promise);
                        super.flush(ctx);
                    } else {
                        waitingForAuth.add(msg);
```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieException.java`
#### Snippet
```java
            break;
        }
        String reason = super.getMessage();
        if (reason == null) {
            if (super.getCause() != null) {
```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieException.java`
#### Snippet
```java
        String reason = super.getMessage();
        if (reason == null) {
            if (super.getCause() != null) {
                reason = super.getCause().getMessage();
            }
```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieException.java`
#### Snippet
```java
        if (reason == null) {
            if (super.getCause() != null) {
                reason = super.getCause().getMessage();
            }
        }
```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryLogManagerForEntryLogPerLedger.java`
#### Snippet
```java
         *
         */
        super.flush();
    }

```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Journal.java`
#### Snippet
```java
        public void run() {
            LOG.info("ForceWrite Thread started");
            ThreadRegistry.register(super.getName(), 0);

            if (conf.isBusyWaitEnabled()) {
```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/DefaultEntryLogger.java`
#### Snippet
```java
            // Otherwise the header might point to something that is not fully
            // written
            super.flush();

            // Update the headers with the map offset and count of ledgers
```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadOnlyLedgerHandle.java`
#### Snippet
```java
    @Override
    public String toString() {
        return String.format("ReadOnlyLedgerHandle(lid = %d, id = %d)", ledgerId, super.hashCode());
    }

```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RegionAwareEnsemblePlacementPolicy.java`
#### Snippet
```java
                writeSetWithRegion.put(idx, getRegion(ensemble.get(idx)));
            }
            return super.reorderReadSequenceWithRegion(ensemble, writeSet, writeSetWithRegion,
                bookiesHealthInfo, true, myRegion, REMOTE_NODE_IN_REORDER_SEQUENCE);
        }
```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdMetadataClientDriver.java`
#### Snippet
```java
                                           Optional<Object> ctx)
            throws MetadataException {
        super.initialize(conf, statsLogger);
        this.conf = conf;
        this.statsLogger = statsLogger;
```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `stream/clients/java/all/src/main/java/org/apache/bookkeeper/clients/StorageClientImpl.java`
#### Snippet
```java
    public void close() {
        try {
            super.close(1, TimeUnit.SECONDS);
        } catch (Exception e) {
            log.warn("Encountered exceptions on closing the storage client", e);
```

## RuleId[id=SlowListContainsAll]
### SlowListContainsAll
Call to 'list.containsAll(collection)' may have poor performance
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/FileSystemUpgrade.java`
#### Snippet
```java
        final File[] indexDirs = conf.getIndexDirs();
        if (indexDirs != null && indexDirs.length == ledgerDirs.length
                && !Arrays.asList(indexDirs).containsAll(Arrays.asList(ledgerDirs))) {
            dirs.addAll(Lists.newArrayList(indexDirs));
        }
```

### SlowListContainsAll
Call to 'list.containsAll(collection)' may have poor performance
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/Auditor.java`
#### Snippet
```java
                        availableBookies, knownBookies);
                knownBookies.addAll(newBookies);
                if (!bookiesToBeAudited.isEmpty() && knownBookies.containsAll(bookiesToBeAudited)) {
                    // the bookie, which went down earlier and had an audit scheduled for,
                    // has come up. So let us stop tracking it and cancel the audit. Since
```

## RuleId[id=InfiniteLoopStatement]
### InfiniteLoopStatement
`while` statement cannot complete without throwing an exception
in `microbenchmarks/src/main/java/org/apache/bookkeeper/stats/codahale/TimerBenchmark.java`
#### Snippet
```java
        System.out.println("Done.");
        System.out.println("Now run 'jmap -histo:live <pid>' on this JVM to get a heap histogram, then kill this JVM.");
        while (true) {
            try {
                TimeUnit.MILLISECONDS.sleep(1000);
```

### InfiniteLoopStatement
`while` statement cannot complete without throwing an exception
in `microbenchmarks/src/main/java/org/apache/bookkeeper/common/MpScQueueBenchmark.java`
#### Snippet
```java

            try {
                while (true) {
                    batchedArrayBlockingQueue.takeAll(localArray);
                }
```

### InfiniteLoopStatement
`while` statement cannot complete without throwing an exception
in `microbenchmarks/src/main/java/org/apache/bookkeeper/common/MpScQueueBenchmark.java`
#### Snippet
```java

            try {
                while (true) {
                    arrayBlockingQueue.drainTo(localList);
                    if (localList.isEmpty()) {
```

### InfiniteLoopStatement
`while` statement cannot complete without throwing an exception
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/cluster/ClusterControllerLeaderImpl.java`
#### Snippet
```java

        // the leader is looping here to react to changes
        while (true) {
            try {
                checkSuspension();
```

### InfiniteLoopStatement
`while` statement cannot complete without throwing an exception
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/LocalBookKeeper.java`
#### Snippet
```java
                try {
                    lb.start();
                    while (true) {
                        Thread.sleep(1000);
                    }
```

### InfiniteLoopStatement
`while` statement cannot complete without throwing an exception
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieServer.java`
#### Snippet
```java
        @Override
        public void run() {
            while (true) {
                try {
                    Thread.sleep(watchInterval);
```

### InfiniteLoopStatement
`while` statement cannot complete without throwing an exception
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/AutoRecoveryMain.java`
#### Snippet
```java
        @Override
        public void run() {
            while (true) {
                try {
                    Thread.sleep(watchInterval);
```

### InfiniteLoopStatement
`while` statement cannot complete without throwing an exception
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LocalDLMEmulator.java`
#### Snippet
```java
                        lb.start();
                        LOG.info("{} bookies are started.", numBookies);
                        while (true) {
                            Thread.sleep(1000);
                        }
```

### InfiniteLoopStatement
`while` statement cannot complete without throwing an exception
in `bookkeeper-benchmark/src/main/java/org/apache/bookkeeper/benchmark/BenchThroughputLatency.java`
#### Snippet
```java
                public void run() {
                    try {
                        while (true) {
                            Thread.sleep(1000);
                            LOG.info("ms: {} req: {}", System.currentTimeMillis(), completedRequests.getAndSet(0));
```

## RuleId[id=CodeBlock2Expr]
### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `stream/clients/java/base/src/main/java/org/apache/bookkeeper/clients/impl/container/StorageContainerChannel.java`
#### Snippet
```java
        log.info("Failed to fetch info of storage container ({}) - '{}'. Retry in {} ms ...",
            new Object[]{scId, cause.getMessage(), ClientConstants.DEFAULT_BACKOFF_START_MS});
        executor.schedule(() -> {
            fetchStorageContainerInfo();
        }, ClientConstants.DEFAULT_BACKOFF_START_MS, TimeUnit.MILLISECONDS);
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/sc/DefaultStorageContainerController.java`
#### Snippet
```java
                .stream()
                .collect(Collectors.toMap(e1 -> {
                        return BookieId.parse(e1.getKey());
                    },
                    e2 -> e2.getValue().getContainersList().stream().collect(Collectors.toSet())
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `stats/bookkeeper-stats-providers/prometheus-metrics-provider/src/main/java/org/apache/bookkeeper/stats/prometheus/ThreadScopedDataSketchesStatsLogger.java`
#### Snippet
```java

        this.statsLoggers = ThreadLocal.withInitial(() -> {
            return new DataSketchesOpStatsLogger(labels);
        });
    }
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `stats/bookkeeper-stats-providers/prometheus-metrics-provider/src/main/java/org/apache/bookkeeper/stats/prometheus/ThreadScopedLongAdderCounter.java`
#### Snippet
```java

        this.counters = ThreadLocal.withInitial(() -> {
            return new LongAdderCounter(labels);
        });
    }
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `stats/bookkeeper-stats-providers/prometheus-metrics-provider/src/main/java/org/apache/bookkeeper/stats/prometheus/PrometheusMetricsProvider.java`
#### Snippet
```java
    @VisibleForTesting
    void rotateLatencyCollection() {
        opStats.forEach((name, metric) -> {
            metric.rotateLatencyCollection();
        });
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `stats/bookkeeper-stats-providers/prometheus-metrics-provider/src/main/java/org/apache/bookkeeper/stats/prometheus/PrometheusMetricsProvider.java`
#### Snippet
```java
                DEFAULT_PROMETHEUS_STATS_LATENCY_ROLLOVER_SECONDS);

        executor.scheduleAtFixedRate(() -> {
            rotateLatencyCollection();
        }, 1, latencyRolloverSeconds, TimeUnit.SECONDS);
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `stream/server/src/main/java/org/apache/bookkeeper/stream/server/StorageServer.java`
#### Snippet
```java
        List<BookieServiceInfo.Endpoint> endpoints = componentInfoPublisher.getEndpoints().values()
                .stream().map(e -> {
                    return new BookieServiceInfo.Endpoint(
                            e.getId(),
                            e.getPort(),
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/BookieSocketAddress.java`
#### Snippet
```java
         */
        return socketAddress.orElseGet(() -> {
            return new InetSocketAddress(hostname, port);
        });
    }
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NetworkTopologyImpl.java`
#### Snippet
```java
                String[] excludeScopes = scope.substring(1).split(NODE_SEPARATOR);
                Set<Node> excludeNodes = new HashSet<Node>();
                Arrays.stream(excludeScopes).forEach((excludeScope) -> {
                    excludeNodes.addAll(doGetLeaves(excludeScope));
                });
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/LocalBookKeeper.java`
#### Snippet
```java
        List<Endpoint> endpoints = componentInfoPublisher.getEndpoints().values()
                .stream().map(e -> {
                    return new Endpoint(
                            e.getId(),
                            e.getPort(),
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookie/ReadLogMetadataCommand.java`
#### Snippet
```java
                entryLogMetadata.getRemainingSize(), entryLogMetadata.getTotalSize(), entryLogMetadata.getUsage());

        entryLogMetadata.getLedgersMap().forEach((ledgerId, size) -> {
            LOG.info("--------- Lid={}, TotalSizeOfEntriesOfLedger={}  ---------",
                     ledgerIdFormatter.formatLedgerId(ledgerId), size);
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java

    private static final BiPredicate<CompletionKey, CompletionValue> timeoutCheck = (key, value) -> {
        return value.maybeTimeout();
    };

```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
        if (useV2WireProtocol) {
                LOG.error("force is not allowed with v2 protocol");
                executor.executeOrdered(ledgerId, () -> {
                    cb.forceLedgerComplete(BKException.Code.IllegalOpException, ledgerId, bookieId, ctx);
                });
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookies/EndpointInfoCommand.java`
#### Snippet
```java
            if (!bookieServiceInfo.getProperties().isEmpty()) {
                LOG.info("Properties");
                bookieServiceInfo.getProperties().forEach((k, v) -> {
                    LOG.info("{} : {}", k, v);
                });
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/autorecovery/ListUnderReplicatedCommand.java`
#### Snippet
```java
                }
                if (printMissingReplica) {
                    underreplicatedLedger.getReplicaList().forEach((missingReplica) -> {
                        LOG.info("\tMissingReplica : {}", missingReplica);
                    });
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/GarbageCollectorThread.java`
#### Snippet
```java
                        final boolean suspendMajor,
                        final boolean suspendMinor) {
        return gcExecutor.submit(() -> {
                runWithFlags(force, suspendMajor, suspendMinor);
            });
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/GarbageCollectorThread.java`
#### Snippet
```java
        final boolean suspendMinor = suspendMinorCompaction.get();

        return gcExecutor.submit(() -> {
                runWithFlags(force, suspendMajor, suspendMinor);
            });
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryMemTable.java`
#### Snippet
```java
        return IteratorUtility.mergeIteratorsForPrimitiveLongIterator(thisLedgerEntriesInKVMap,
                thisLedgerEntriesInSnapshot, EntryKey.COMPARATOR, (entryKey) -> {
                    return entryKey.entryId;
                });
    }
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieShell.java`
#### Snippet
```java
        initEntryLogger();
        EntryLogMetadata entryLogMetadata = entryLogger.getEntryLogMetadata(logId);
        entryLogMetadata.getLedgersMap().forEach((ledgerId, size) -> {
            LOG.info("--------- Lid={}, TotalSizeOfEntriesOfLedger={}  ---------",
                    ledgerIdFormatter.formatLedgerId(ledgerId), size);
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieImpl.java`
#### Snippet
```java
                @Override
                public void start() {
                    executor.scheduleAtFixedRate(() -> {
                        doCheckpoint(checkpointSource.newCheckpoint());
                    }, conf.getFlushInterval(), conf.getFlushInterval(), TimeUnit.MILLISECONDS);
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/SingleDirectoryDbLedgerStorage.java`
#### Snippet
```java
    private TransientLedgerInfo getOrAddLedgerInfo(long ledgerId) {
        return transientLedgerInfoCache.computeIfAbsent(ledgerId, l -> {
            return new TransientLedgerInfo(l, ledgerIndex);
        });
    }
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/UpdateLedgerOp.java`
#### Snippet
```java
                            ref::get,
                            (metadata) -> {
                                return metadata.getAllEnsembles().values().stream()
                                    .flatMap(Collection::stream)
                                    .anyMatch(b -> b.equals(oldBookieId));
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/UpdateLedgerOp.java`
#### Snippet
```java
                            },
                            (metadata) -> {
                                return replaceBookieInEnsembles(metadata, oldBookieId, newBookieId);
                            },
                            ref::compareAndSet, throttler).run();
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentLongLongHashMap.java`
#### Snippet
```java

        int headerLen = sb.length();
        forEach((k, v) -> {
                sb.append(k).append(" => ").append(v).append(", ");
            });
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/datainteg/DataIntegrityCheckImpl.java`
#### Snippet
```java
            .subscribeOn(scheduler, false)
            .flatMapMaybe((entryId) -> {
                    return maybeCopyEntry(writeSets, bookieIndices, ledgerId, entryId, batch)
                        .doOnError((t) -> {
                                firstError.compareAndSet(null, t);
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerChecker.java`
#### Snippet
```java

                final CompletableFuture<Void> future = new CompletableFuture<>();
                future.whenCompleteAsync((re, ex) -> {
                    checkFragments(fragments, cb, percentageOfLedgerFragmentToBeVerified);
                });
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
                                },
                                (metadata) -> {
                                    return LedgerMetadataBuilder.from(metadata)
                                            .withClosedState().withLastEntryId(lastEntry)
                                            .withLength(finalLength).build();
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/EmbeddedServer.java`
#### Snippet
```java
            List<BookieServiceInfo.Endpoint> endpoints = componentInfoPublisher.getEndpoints().values()
                    .stream().map(e -> {
                        return new BookieServiceInfo.Endpoint(
                                e.getId(),
                                e.getPort(),
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/DirectBookkeeperDriver.java`
#### Snippet
```java
            return;
        }
        handle.asyncAddEntry(entryID, data, (rc, lh, entryId, ctx) -> {
            cb.accept(rc);
        }, null);
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/DirectBookkeeperDriver.java`
#### Snippet
```java
    @Override
    public void deleteLedger(long ledgerID, Consumer<Integer> cb) {
        client.asyncDeleteLedger(ledgerID, (rc, ctx) -> {
            cb.accept(rc);
        }, null);
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/discover/ZKRegistrationManager.java`
#### Snippet
```java
            List<BookieServiceInfoFormat.Endpoint> bsiEndpoints = bookieServiceInfo.getEndpoints().stream()
                    .map(e -> {
                        return BookieServiceInfoFormat.Endpoint.newBuilder()
                               .setId(e.getId())
                               .setPort(e.getPort())
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/discover/ZKRegistrationClient.java`
#### Snippet
```java
            if (listeners.add(listener)) {
                if (null != bookies) {
                    scheduler.execute(() -> {
                            listener.onBookiesChanged(
                                    new Versioned<>(bookies, version));
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/AutoRecoveryMain.java`
#### Snippet
```java
            // do not run "shutdown" in the main ZooKeeper client thread
            // as it performs some blocking operations
            CompletableFuture.runAsync(() -> {
                shutdown(ExitCode.ZK_EXPIRED);
            });
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/AuditorTask.java`
#### Snippet
```java
                                underReplicatedSize.add(metadata.getValue().getLength());
                            }
                        }), null).whenComplete((res, e) -> {
            auditorStats.getUnderReplicatedLedgerTotalSize().registerSuccessfulValue(underReplicatedSize.longValue());
        });
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdBookieRegister.java`
#### Snippet
```java
        }
        CompletableFuture<Void> closeFuture = new CompletableFuture<>();
        executor.submit(() -> {
            FutureUtils.complete(closeFuture, (Void) null);
        });
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeper.java`
#### Snippet
```java
        CompletableFuture<Versioned<LedgerMetadata>> versioned = getLedgerManager().readLedgerMetadata(ledgerId);
        return versioned.thenApply(versionedLedgerMetadata -> {
            return versionedLedgerMetadata.getValue();
        });
    }
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `stream/clients/java/all/src/main/java/org/apache/bookkeeper/clients/admin/StorageAdminClientImpl.java`
#### Snippet
```java
    @Override
    protected void closeAsyncOnce(CompletableFuture<Void> closeFuture) {
        clientManager.closeAsync().whenComplete((result, cause) -> {
            closeFuture.complete(null);
        });
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdWatchClient.java`
#### Snippet
```java
            future = closeFuture;
        }
        return future.whenComplete((ignored, cause) -> {
            this.scheduler.shutdown();
        });
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeperAdmin.java`
#### Snippet
```java
                    + "Have to make sure that those ledger fragments are rereplicated");
            List<Long> urLedgers = new ArrayList<>();
            urLedgerIterator.forEachRemaining((urLedger) -> {
                urLedgers.add(urLedger.getLedgerId());
            });
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `bookkeeper-common-allocator/src/main/java/org/apache/bookkeeper/common/allocator/impl/ByteBufAllocatorImpl.java`
#### Snippet
```java
        this.outOfMemoryPolicy = outOfMemoryPolicy;
        if (outOfMemoryListener == null) {
            this.outOfMemoryListener = (v) -> {
                log.error("Unable to allocate memory", v);
            };
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/journal/AbstractStateStoreWithJournal.java`
#### Snippet
```java
                    getWriter(),
                    logManager
                ).thenRun(() -> {
                    log.info("Successfully close the log stream of state store {}", name);
                }),
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/conf/ConfigDef.java`
#### Snippet
```java
                stream, COMMENT_PREFIX, "@options :"
            );
            key.optionValues().forEach(value -> {
                writeSentence(
                    stream, COMMENT_PREFIX, "  " + value
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/Retries.java`
#### Snippet
```java
                null);
        } else {
            scheduler.executeOrdered(key, () -> {
                execute(
                    future,
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/concurrent/FutureUtils.java`
#### Snippet
```java
    public static <T> CompletableFuture<T> ensure(CompletableFuture<T> future,
                                                  Runnable ensureBlock) {
        return future.whenComplete((value, cause) -> {
            ensureBlock.run();
        });
```

## RuleId[id=EmptyMethod]
### EmptyMethod
Method only calls its super
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/collections/RecyclableArrayList.java`
#### Snippet
```java

    @Override
    public int hashCode() {
        return super.hashCode();
    }
```

### EmptyMethod
The method is empty
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/conf/ComponentConfiguration.java`
#### Snippet
```java
    }

    public void validate() throws ConfigurationException {
        // do nothing by default.
    }
```

### EmptyMethod
Method only calls its super
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryKeyValue.java`
#### Snippet
```java

    @Override
    public int hashCode() {
        // since this entry is identified by (lid, eid)
        // so just use {@link org.apache.bookkeeper.bookie.EntryKey#hashCode} as the hash code.
```

### EmptyMethod
Method only calls its super
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LedgerStorage.java`
#### Snippet
```java
     * Force trigger Garbage Collection.
     */
    default void forceGC() {
        return;
    }
```

### EmptyMethod
Method only calls its super
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LedgerStorage.java`
#### Snippet
```java
     * Force trigger Garbage Collection with forceMajor or forceMinor parameter.
     */
    default void forceGC(Boolean forceMajor, Boolean forceMinor) {
        return;
    }
```

### EmptyMethod
Method only calls its super
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LedgerStorage.java`
#### Snippet
```java
    }

    default void suspendMinorGC() {
        return;
    }
```

### EmptyMethod
Method only calls its super
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LedgerStorage.java`
#### Snippet
```java
    }

    default void suspendMajorGC() {
        return;
    }
```

### EmptyMethod
Method only calls its super
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LedgerStorage.java`
#### Snippet
```java
    }

    default void resumeMinorGC() {
        return;
    }
```

### EmptyMethod
Method only calls its super
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LedgerStorage.java`
#### Snippet
```java
    }

    default void resumeMajorGC() {
        return;
    }
```

### EmptyMethod
Method only calls its super
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LedgerStorage.java`
#### Snippet
```java
    }

    default void entryLocationCompact() {
        return;
    }
```

### EmptyMethod
Method only calls its super
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LedgerStorage.java`
#### Snippet
```java
    }

    default void entryLocationCompact(List<String> locations) {
        return;
    }
```

### EmptyMethod
Method only calls its super
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LocalBookieEnsemblePlacementPolicy.java`
#### Snippet
```java

    @Override
    public void registerSlowBookie(BookieId bookieSocketAddress, long entryId) {
        return;
    }
```

### EmptyMethod
Method only calls its super
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LocalBookieEnsemblePlacementPolicy.java`
#### Snippet
```java

    @Override
    public void updateBookieInfo(Map<BookieId, BookieInfo> bookieToFreeSpaceMap) {
        return;
    }
```

### EmptyMethod
Method only calls its super
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/DefaultEnsemblePlacementPolicy.java`
#### Snippet
```java

    @Override
    public void registerSlowBookie(BookieId bookieSocketAddress, long entryId) {
        return;
    }
```

### EmptyMethod
Method only calls its super
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/zk/ZKMetadataBookieDriver.java`
#### Snippet
```java

    @Override
    public void close() {
        super.close();
    }
```

### EmptyMethod
All implementations of this method are empty
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/metastore/MetaStore.java`
#### Snippet
```java
     * @throws MetastoreException when failed to initialize
     */
    void init(Configuration config, int msVersion) throws MetastoreException;

    /**
```

### EmptyMethod
All implementations of this method are empty
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/metastore/MetaStore.java`
#### Snippet
```java
     * Close the meta store.
     */
    void close();

    /**
```

### EmptyMethod
All implementations of this method are empty
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/metastore/MetastoreTable.java`
#### Snippet
```java
     * Close the table.
     */
    void close();
}

```

### EmptyMethod
The method is empty
in `microbenchmarks/src/main/java/org/apache/bookkeeper/proto/checksum/DigestTypeBenchmark.java`
#### Snippet
```java

        @TearDown(Level.Trial)
        public void doTearDown() {
        }

```

### EmptyMethod
Method only calls its super
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKSyncLogWriter.java`
#### Snippet
```java
     */
    @Override
    public void abort() throws IOException {
        super.abort();
    }
```

### EmptyMethod
The method is empty
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/auditor/DLAuditor.java`
#### Snippet
```java
    }

    public void close() {
        // no-op
    }
```

### EmptyMethod
The method is empty
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/thrift/AccessControlEntry.java`
#### Snippet
```java
  }

  public void validate() throws org.apache.thrift.TException {
    // check for required fields
    // check for sub-struct validity
```

### EmptyMethod
The method is empty
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/thrift/BKDLConfigFormat.java`
#### Snippet
```java
  }

  public void validate() throws org.apache.thrift.TException {
    // check for required fields
    // check for sub-struct validity
```

## RuleId[id=RedundantFieldInitialization]
### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/clients/java/base/src/main/java/org/apache/bookkeeper/clients/impl/channel/StorageServerChannelManager.java`
#### Snippet
```java

    private final ReentrantReadWriteLock lock;
    private boolean closed = false;
    private final ConcurrentMap<Endpoint, StorageServerChannel> channels;
    private final Function<Endpoint, StorageServerChannel> channelFactory;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/clients/java/base/src/main/java/org/apache/bookkeeper/clients/impl/container/StorageContainerChannel.java`
#### Snippet
```java

    @GuardedBy("this")
    private StorageContainerInfo scInfo = null;
    @GuardedBy("this")
    private CompletableFuture<StorageServerChannel> rsChannelFuture = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/clients/java/base/src/main/java/org/apache/bookkeeper/clients/impl/container/StorageContainerChannel.java`
#### Snippet
```java
    private StorageContainerInfo scInfo = null;
    @GuardedBy("this")
    private CompletableFuture<StorageServerChannel> rsChannelFuture = null;

    public StorageContainerChannel(long scId,
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/clients/java/base/src/main/java/org/apache/bookkeeper/clients/utils/ListenableFutureRpcProcessor.java`
#### Snippet
```java
    private final CompletableFuture<ResultT> resultFuture;

    private CompletableFuture<StorageServerChannel> serverChannelFuture = null;

    protected ListenableFutureRpcProcessor(StorageContainerChannel channel,
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `stream/distributedlog/protocol/src/main/java/org/apache/distributedlog/EnvelopedRecordSetWriter.java`
#### Snippet
```java
    private final int metadata;
    private final int codecCode;
    private int count = 0;
    private ByteBuf recordSetBuffer = null;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/protocol/src/main/java/org/apache/distributedlog/EnvelopedRecordSetWriter.java`
#### Snippet
```java
    private final int codecCode;
    private int count = 0;
    private ByteBuf recordSetBuffer = null;

    EnvelopedRecordSetWriter(int initialBufferSize,
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stats/bookkeeper-stats-api/src/main/java/org/apache/bookkeeper/stats/AlertStatsLogger.java`
#### Snippet
```java
    private final String scope;
    private Counter globalCounter = null;
    private Counter scopedCounter = null;

    public AlertStatsLogger(StatsLogger globalStatsLogger, String scope, String alertStatName) {
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stats/bookkeeper-stats-api/src/main/java/org/apache/bookkeeper/stats/AlertStatsLogger.java`
#### Snippet
```java
    private final StatsLogger scopedStatsLogger;
    private final String scope;
    private Counter globalCounter = null;
    private Counter scopedCounter = null;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/protocol/src/main/java/org/apache/distributedlog/LogRecord.java`
#### Snippet
```java
        private static final int SKIP_BUFFER_SIZE = 512;
        private LogRecordSet.Reader recordSetReader = null;
        private LogRecordWithDLSN lastRecordSkipTo = null;

        /**
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/protocol/src/main/java/org/apache/distributedlog/LogRecord.java`
#### Snippet
```java
        private final boolean deserializeRecordSet;
        private static final int SKIP_BUFFER_SIZE = 512;
        private LogRecordSet.Reader recordSetReader = null;
        private LogRecordWithDLSN lastRecordSkipTo = null;

```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `microbenchmarks/src/main/java/org/apache/bookkeeper/stats/codahale/TimerBenchmark.java`
#### Snippet
```java

        private static OpStatsLogger[] timers;
        private int timerIdx = 0;

        private static long[] times;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `microbenchmarks/src/main/java/org/apache/bookkeeper/stats/codahale/TimerBenchmark.java`
#### Snippet
```java

        private static long[] times;
        private int timeIdx = 0;

        @Setup(Level.Trial)
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/StorageContainerStoreBuilder.java`
#### Snippet
```java

    private StatsLogger statsLogger = NullStatsLogger.INSTANCE;
    private StorageConfiguration storeConf = null;
    private StorageResources storeResources = null;
    private StorageContainerManagerFactory scmFactory = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/StorageContainerStoreBuilder.java`
#### Snippet
```java
    private StorageConfiguration storeConf = null;
    private StorageResources storeResources = null;
    private StorageContainerManagerFactory scmFactory = null;
    private StorageContainerPlacementPolicy.Factory placementPolicyFactory = () ->
        StorageContainerPlacementPolicyImpl.of(1024);
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/StorageContainerStoreBuilder.java`
#### Snippet
```java
    private StatsLogger statsLogger = NullStatsLogger.INSTANCE;
    private StorageConfiguration storeConf = null;
    private StorageResources storeResources = null;
    private StorageContainerManagerFactory scmFactory = null;
    private StorageContainerPlacementPolicy.Factory placementPolicyFactory = () ->
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/StorageContainerStoreBuilder.java`
#### Snippet
```java
        StorageContainerPlacementPolicyImpl.of(1024);
    private MVCCStoreFactory mvccStoreFactory = null;
    private URI defaultBackendUri = null;
    private Supplier<StorageServerClientManager> clientManagerSupplier;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/StorageContainerStoreBuilder.java`
#### Snippet
```java
    private StorageContainerPlacementPolicy.Factory placementPolicyFactory = () ->
        StorageContainerPlacementPolicyImpl.of(1024);
    private MVCCStoreFactory mvccStoreFactory = null;
    private URI defaultBackendUri = null;
    private Supplier<StorageServerClientManager> clientManagerSupplier;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/sc/StorageContainerRegistryImpl.java`
#### Snippet
```java
    private final ConcurrentMap<Long, StorageContainer> containers;
    private final ReentrantReadWriteLock closeLock;
    private boolean closed = false;

    public StorageContainerRegistryImpl(StorageContainerFactory factory) {
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/cluster/ClusterControllerLeaderImpl.java`
#### Snippet
```java
    @Getter(AccessLevel.PACKAGE)
    private final Object suspensionLock = new Object();
    private volatile boolean suspended = false;

    // last successful assignment happened at (timestamp)
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/cluster/ZkClusterMetadataStore.java`
#### Snippet
```java
    private org.apache.curator.framework.recipes.cache.NodeCache assignmentDataCache;

    private volatile boolean closed = false;

    public ZkClusterMetadataStore(CuratorFramework client, String zkServers, String zkRootPath) {
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/store/MVCCStoreFactoryImpl.java`
#### Snippet
```java
    private final Map<Long, Map<RangeId, MVCCAsyncStore<byte[], byte[]>>> stores;
    private final boolean serveReadOnlyTable;
    private boolean closed = false;
    private final StorageConfiguration storageConf;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/routing/RoutingHeaderProxyInterceptor.java`
#### Snippet
```java
        return new SimpleForwardingClientCall<ReqT, RespT>(next.newCall(method, callOptions)) {

            private Long rid = null;
            private Long sid = null;
            private byte[] rk = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/routing/RoutingHeaderProxyInterceptor.java`
#### Snippet
```java
            private Long rid = null;
            private Long sid = null;
            private byte[] rk = null;

            @Override
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/routing/RoutingHeaderProxyInterceptor.java`
#### Snippet
```java

            private Long rid = null;
            private Long sid = null;
            private byte[] rk = null;

```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `stream/tests-common/src/main/java/org/apache/bookkeeper/tests/rpc/PingPongService.java`
#### Snippet
```java
        return new StreamObserver<PingRequest>() {

            int pingCount = 0;
            long lastSequence = -1L;

```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `stream/tests-common/src/main/java/org/apache/bookkeeper/tests/rpc/PingPongService.java`
#### Snippet
```java
        return new StreamObserver<PingRequest>() {

            int pingCount = 0;

            @Override
```

### RedundantFieldInitialization
Field initialization to `0L` is redundant
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/metadata/stream/MetaRangeImpl.java`
#### Snippet
```java
    private LifecycleState lifecycleState = LifecycleState.UNINIT;
    private ServingState servingState = ServingState.WRITABLE;
    private long cTime = 0L;
    private long mTime = 0L;

```

### RedundantFieldInitialization
Field initialization to `0L` is redundant
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/metadata/stream/MetaRangeImpl.java`
#### Snippet
```java
    private ServingState servingState = ServingState.WRITABLE;
    private long cTime = 0L;
    private long mTime = 0L;

    private long nextRangeId = MIN_DATA_RANGE_ID;
```

### RedundantFieldInitialization
Field initialization to `0L` is redundant
in `stream/api/src/main/java/org/apache/bookkeeper/api/kv/impl/result/IncrementResultImpl.java`
#### Snippet
```java
    implements IncrementResult<K, V> {

    private long totalAmount = 0L;

    IncrementResultImpl(Handle<IncrementResultImpl<K, V>> handle) {
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/api/src/main/java/org/apache/bookkeeper/api/kv/impl/result/TxnResultImpl.java`
#### Snippet
```java
public class TxnResultImpl<K, V> extends ResultImpl<K, V, TxnResultImpl<K, V>> implements TxnResult<K, V> {

    private boolean isSuccess = false;
    private List<Result<K, V>> results = Collections.emptyList();

```

### RedundantFieldInitialization
Field initialization to `0L` is redundant
in `stream/api/src/main/java/org/apache/bookkeeper/api/kv/impl/result/RangeResultImpl.java`
#### Snippet
```java

    private List<KeyValue<K, V>> kvs = Collections.emptyList();
    private long count = 0L;
    private boolean more = false;

```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/api/src/main/java/org/apache/bookkeeper/api/kv/impl/result/RangeResultImpl.java`
#### Snippet
```java
    private List<KeyValue<K, V>> kvs = Collections.emptyList();
    private long count = 0L;
    private boolean more = false;

    RangeResultImpl(Handle<RangeResultImpl<K, V>> handle) {
```

### RedundantFieldInitialization
Field initialization to `0L` is redundant
in `stream/api/src/main/java/org/apache/bookkeeper/api/kv/impl/result/DeleteResultImpl.java`
#### Snippet
```java

    private List<KeyValue<K, V>> prevKvs = Collections.emptyList();
    private long numDeleted = 0L;

    DeleteResultImpl(Handle<DeleteResultImpl<K, V>> handle) {
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/api/src/main/java/org/apache/bookkeeper/api/kv/impl/result/KeyValueImpl.java`
#### Snippet
```java

    private K key = null;
    private V value = null;
    private long createRevision = -1L;
    private long modifiedRevision = -1L;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/api/src/main/java/org/apache/bookkeeper/api/kv/impl/result/KeyValueImpl.java`
#### Snippet
```java
    private long modifiedRevision = -1L;
    private long version = -1L;
    private boolean isNumber = false;
    private long numberValue = -1L;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/api/src/main/java/org/apache/bookkeeper/api/kv/impl/result/KeyValueImpl.java`
#### Snippet
```java
    private final Handle<KeyValueImpl<K, V>> handle;

    private K key = null;
    private V value = null;
    private long createRevision = -1L;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/server/src/main/java/org/apache/bookkeeper/stream/cluster/StreamClusterSpec.java`
#### Snippet
```java
     */
    @Default
    ServiceURI metadataServiceUri = null;

    /**
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/server/src/main/java/org/apache/bookkeeper/stream/cluster/StandaloneStarter.java`
#### Snippet
```java
            },
            description = "Show this help message")
        boolean help = false;

    }
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/server/src/main/java/org/apache/bookkeeper/stream/cluster/StandaloneStarter.java`
#### Snippet
```java
            },
            description = "Clean up previous standalone data")
        boolean wipeData = false;

        @Parameter(
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/server/src/main/java/org/apache/bookkeeper/stream/cluster/StandaloneStarter.java`
#### Snippet
```java
            description = "Uri of the external metadata service."
                + " If set, the standalone will not start any metadata service itself.")
        String metadataServiceUri = null;

        @Parameter(
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/server/src/main/java/org/apache/bookkeeper/stream/cluster/StandaloneStarter.java`
#### Snippet
```java
            },
            description = "Configuration file path")
        String configFile = null;

        @Parameter(
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/server/src/main/java/org/apache/bookkeeper/stream/server/StorageServer.java`
#### Snippet
```java

        @Parameter(names = {"-h", "--help"}, description = "Show this help message")
        private boolean help = false;

    }
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/server/src/main/java/org/apache/bookkeeper/stream/server/StorageServer.java`
#### Snippet
```java

        @Parameter(names = {"-u", "--useHostname"}, description = "Use hostname instead of IP for server ID")
        private boolean useHostname = false;

        @Parameter(names = {"-h", "--help"}, description = "Show this help message")
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NetworkTopologyImpl.java`
#### Snippet
```java
     * Rack counter.
     */
    protected int numOfRacks = 0;
    /**
     * The lock used to manage access.
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/CleanupLedgerManager.java`
#### Snippet
```java
    private final ConcurrentMap<GenericCallback, GenericCallback> callbacks =
        new ConcurrentHashMap<GenericCallback, GenericCallback>();
    private boolean closed = false;
    private final ReentrantReadWriteLock closeLock = new ReentrantReadWriteLock();
    private final Set<CompletableFuture<?>> futures = ConcurrentHashMap.newKeySet();
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/ZkLedgerAuditorManager.java`
#### Snippet
```java

    private volatile Consumer<AuditorEvent> listener;
    private volatile boolean isClosed = false;

    // Expose Stats
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/FlatLedgerManager.java`
#### Snippet
```java
        return new LedgerRangeIterator() {
            // single iterator, can visit only one time
            boolean nextCalled = false;
            LedgerRange nextRange = null;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/FlatLedgerManager.java`
#### Snippet
```java
            // single iterator, can visit only one time
            boolean nextCalled = false;
            LedgerRange nextRange = null;

            private synchronized void preload() throws IOException {
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/LegacyHierarchicalLedgerManager.java`
#### Snippet
```java
    private class LegacyHierarchicalLedgerRangeIterator implements LedgerRangeIterator {
        private Iterator<String> l1NodesIter = null;
        private Iterator<String> l2NodesIter = null;
        private String curL1Nodes = "";
        private boolean iteratorDone = false;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/LegacyHierarchicalLedgerManager.java`
#### Snippet
```java
        private String curL1Nodes = "";
        private boolean iteratorDone = false;
        private LedgerRange nextRange = null;
        private final long zkOpTimeoutMs;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/LegacyHierarchicalLedgerManager.java`
#### Snippet
```java
     */
    private class LegacyHierarchicalLedgerRangeIterator implements LedgerRangeIterator {
        private Iterator<String> l1NodesIter = null;
        private Iterator<String> l2NodesIter = null;
        private String curL1Nodes = "";
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/LegacyHierarchicalLedgerManager.java`
#### Snippet
```java
        private Iterator<String> l2NodesIter = null;
        private String curL1Nodes = "";
        private boolean iteratorDone = false;
        private LedgerRange nextRange = null;
        private final long zkOpTimeoutMs;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/zk/ZKMetadataDriverBase.java`
#### Snippet
```java
    @Getter
    @Setter
    protected ZooKeeper zk = null;
    // whether the zk handle is one we created, or is owned by whoever
    // instantiated us
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/zk/ZKMetadataDriverBase.java`
#### Snippet
```java
    // whether the zk handle is one we created, or is owned by whoever
    // instantiated us
    protected boolean ownZKHandle = false;

    // disable health check path
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/sasl/SaslClientState.java`
#### Snippet
```java
    static class ClientCallbackHandler implements CallbackHandler {

        private String password = null;

        public ClientCallbackHandler(String password) {
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/sasl/SASLBookieAuthProviderFactory.java`
#### Snippet
```java
    private static class ClientCallbackHandler implements CallbackHandler {

        private String password = null;

        public ClientCallbackHandler(String password) {
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/AvailabilityOfEntriesOfLedger.java`
#### Snippet
```java
    private MutableInt curSequenceSize = new MutableInt(0);
    private boolean availabilityOfEntriesOfLedgerClosed = false;
    private long totalNumOfAvailableEntries = 0;

    public AvailabilityOfEntriesOfLedger(PrimitiveIterator.OfLong entriesOfLedgerItr) {
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/AvailabilityOfEntriesOfLedger.java`
#### Snippet
```java
        private int sequencePeriod;
        private boolean isSequenceGroupClosed = false;
        private long numOfEntriesInSequenceGroup = 0;

        private SequenceGroup(long firstSequenceStart, int sequenceSize) {
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/AvailabilityOfEntriesOfLedger.java`
#### Snippet
```java
        private long lastSequenceStart = INVALID_ENTRYID;
        private int sequencePeriod;
        private boolean isSequenceGroupClosed = false;
        private long numOfEntriesInSequenceGroup = 0;

```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/AvailabilityOfEntriesOfLedger.java`
#### Snippet
```java
    private MutableLong curSequenceStartEntryId = new MutableLong(INVALID_ENTRYID);
    private MutableInt curSequenceSize = new MutableInt(0);
    private boolean availabilityOfEntriesOfLedgerClosed = false;
    private long totalNumOfAvailableEntries = 0;

```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/HardLink.java`
#### Snippet
```java
  public static class LinkStats {
    public int countDirs = 0;
    public int countSingleLinks = 0;
    public int countMultLinks = 0;
    public int countFilesMultLinks = 0;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/HardLink.java`
#### Snippet
```java
   */
  public static class LinkStats {
    public int countDirs = 0;
    public int countSingleLinks = 0;
    public int countMultLinks = 0;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/HardLink.java`
#### Snippet
```java
    public int countFilesMultLinks = 0;
    public int countEmptyDirs = 0;
    public int countPhysicalFileCopies = 0;

    public void clear() {
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/HardLink.java`
#### Snippet
```java
    public int countSingleLinks = 0;
    public int countMultLinks = 0;
    public int countFilesMultLinks = 0;
    public int countEmptyDirs = 0;
    public int countPhysicalFileCopies = 0;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/HardLink.java`
#### Snippet
```java
    public int countMultLinks = 0;
    public int countFilesMultLinks = 0;
    public int countEmptyDirs = 0;
    public int countPhysicalFileCopies = 0;

```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/HardLink.java`
#### Snippet
```java
    public int countDirs = 0;
    public int countSingleLinks = 0;
    public int countMultLinks = 0;
    public int countFilesMultLinks = 0;
    public int countEmptyDirs = 0;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/IteratorUtility.java`
#### Snippet
```java
        return new PrimitiveIterator.OfLong() {
            private T curIter1Entry = null;
            private T curIter2Entry = null;
            private boolean hasToPreFetch = true;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/IteratorUtility.java`
#### Snippet
```java
            Comparator<T> comparator, ToLongFunction<T> function) {
        return new PrimitiveIterator.OfLong() {
            private T curIter1Entry = null;
            private T curIter2Entry = null;
            private boolean hasToPreFetch = true;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/ZkUtils.java`
#### Snippet
```java
    private static class GetChildrenCtx {
        int rc;
        boolean done = false;
        List<String> children = null;
    }
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/ZkUtils.java`
#### Snippet
```java
        int rc;
        boolean done = false;
        List<String> children = null;
    }

```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BKStats.java`
#### Snippet
```java
        long minLatency = Long.MAX_VALUE;
        double totalLatency = 0.0f;
        long numSuccessOps = 0;
        long numFailedOps = 0;
        long[] latencyBuckets = new long[NUM_BUCKETS];
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BKStats.java`
#### Snippet
```java
        static final int NUM_BUCKETS = 3 * 9 + 2;

        long maxLatency = 0;
        long minLatency = Long.MAX_VALUE;
        double totalLatency = 0.0f;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BKStats.java`
#### Snippet
```java
        double totalLatency = 0.0f;
        long numSuccessOps = 0;
        long numFailedOps = 0;
        long[] latencyBuckets = new long[NUM_BUCKETS];

```

### RedundantFieldInitialization
Field initialization to `0.0f` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BKStats.java`
#### Snippet
```java
        long maxLatency = 0;
        long minLatency = Long.MAX_VALUE;
        double totalLatency = 0.0f;
        long numSuccessOps = 0;
        long numFailedOps = 0;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieRequestHandler.java`
#### Snippet
```java
    private ChannelHandlerContext ctx;

    private ByteBuf pendingSendResponses = null;
    private int maxPendingResponsesSize;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/LongPollReadEntryProcessorV3.java`
#### Snippet
```java
    private final ExecutorService longPollThreadPool;
    private final HashedWheelTimer requestTimer;
    private Timeout expirationTimerTask = null;
    private Future<?> deferredTask = null;
    private boolean shouldReadEntry = false;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/LongPollReadEntryProcessorV3.java`
#### Snippet
```java
    private Timeout expirationTimerTask = null;
    private Future<?> deferredTask = null;
    private boolean shouldReadEntry = false;

    LongPollReadEntryProcessorV3(Request request,
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/LongPollReadEntryProcessorV3.java`
#### Snippet
```java
    private final HashedWheelTimer requestTimer;
    private Timeout expirationTimerTask = null;
    private Future<?> deferredTask = null;
    private boolean shouldReadEntry = false;

```

### RedundantFieldInitialization
Field initialization to `0L` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/Shell.java`
#### Snippet
```java
    public static final Log LOG = LogFactory.getLog(Shell.class);

    protected long timeOutInterval = 0L;
    /* If or not script timed out */
    private AtomicBoolean timedOut;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/ReadEntryProcessorV3.java`
#### Snippet
```java
    private final ExecutorService fenceThreadPool;

    private CompletableFuture<Boolean> fenceResult = null;

    protected final ReadRequest readRequest;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/AuthHandler.java`
#### Snippet
```java

    static class ServerSideHandler extends ChannelInboundHandlerAdapter {
        volatile boolean authenticated = false;
        final BookieAuthProvider.Factory authProviderFactory;
        final BookieConnectionPeer connectionPeer;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/AuthHandler.java`
#### Snippet
```java

    static class ClientSideHandler extends ChannelDuplexHandler {
        volatile boolean authenticated = false;
        final ClientAuthProvider.Factory authProviderFactory;
        ClientAuthProvider authProvider;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieNettyServer.java`
#### Snippet
```java
    final AtomicBoolean isClosed = new AtomicBoolean(false);
    final Object suspensionLock = new Object();
    volatile boolean suspended = false;
    ChannelGroup allChannels;
    final BookieSocketAddress bookieAddress;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieServer.java`
#### Snippet
```java
    final ServerConfiguration conf;
    BookieNettyServer nettyServer;
    private volatile boolean running = false;
    private final Bookie bookie;
    DeathWatcher deathWatcher;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieServer.java`
#### Snippet
```java

    // Exception handler
    private volatile UncaughtExceptionHandler uncaughtExceptionHandler = null;

    public BookieServer(ServerConfiguration conf,
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/shims/zk/ZooKeeperServerShimImpl.java`
#### Snippet
```java

    ZooKeeperServer zks = null;
    NIOServerCnxnFactory serverFactory = null;

    @Override
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/shims/zk/ZooKeeperServerShimImpl.java`
#### Snippet
```java
class ZooKeeperServerShimImpl implements ZooKeeperServerShim {

    ZooKeeperServer zks = null;
    NIOServerCnxnFactory serverFactory = null;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookie/ReadLogMetadataCommand.java`
#### Snippet
```java
    private LedgerIdFormatter ledgerIdFormatter;

    EntryLogger entryLogger = null;

    public ReadLogMetadataCommand() {
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookie/ReadJournalCommand.java`
#### Snippet
```java
    private static final Logger LOG = LoggerFactory.getLogger(ReadJournalCommand.class);

    List<Journal> journals = null;

    public ReadJournalCommand() {
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookie/ReadJournalCommand.java`
#### Snippet
```java
        LOG.info("Scan journal {} ({}.txn)", journalId, Long.toHexString(journalId));
        scanJournal(journal, journalId, new Journal.JournalScanner() {
            boolean printJournalVersion = false;

            @Override
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java

        CompletionKey key = null;
        WriteCallback originalCallback = null;

        AddCompletion(Recycler.Handle<AddCompletion> handle) {
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
        final Recycler.Handle<AddCompletion> handle;

        CompletionKey key = null;
        WriteCallback originalCallback = null;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
    private volatile Queue<GenericCallback<PerChannelBookieClient>> pendingOps =
            new ArrayDeque<GenericCallback<PerChannelBookieClient>>();
    volatile Channel channel = null;
    private final ClientConnectionPeer connectionPeer;
    private volatile BookKeeperPrincipal authorizedId = BookKeeperPrincipal.ANONYMOUS;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
    private final SecurityHandlerFactory shFactory;
    private volatile boolean isWritable = true;
    private long lastBookieUnavailableLogTimestamp = 0;

    public PerChannelBookieClient(OrderedExecutor executor, EventLoopGroup eventLoopGroup,
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/client/LedgerMetaDataCommand.java`
#### Snippet
```java
        @Parameter(names = { "-u",
                "--update" }, description = "Update metadata if already exist while restoring metadata")
        private boolean update = false;
    }

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/cookie/GenerateCookieCommand.java`
#### Snippet
```java
            description = "The instance id of the cluster that this bookie belongs to."
                + " If omitted, it will used the instance id of the cluster that this cli connects to.")
        private String instanceId = null;

        @Parameter(
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/cookie/GenerateCookieCommand.java`
#### Snippet
```java
                names = { "-ix", "--index-dirs" },
                description = "The index directories used by this bookie")
        private String indexDirs = null;

        @Parameter(
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookies/ListBookiesCommand.java`
#### Snippet
```java

        @Parameter(names = { "-rw", "--readwrite" }, description = "Print readwrite bookies")
        private boolean readwrite = false;
        @Parameter(names = { "-ro", "--readonly" }, description = "Print readonly bookies")
        private boolean readonly = false;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookies/ListBookiesCommand.java`
#### Snippet
```java
        private boolean readonly = false;
        @Parameter(names = { "-a", "--all" }, description = "Print all bookies")
        private boolean all = false;

    }
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookies/ListBookiesCommand.java`
#### Snippet
```java
        private boolean readwrite = false;
        @Parameter(names = { "-ro", "--readonly" }, description = "Print readonly bookies")
        private boolean readonly = false;
        @Parameter(names = { "-a", "--all" }, description = "Print all bookies")
        private boolean all = false;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/SyncThread.java`
#### Snippet
```java

    private final Object suspensionLock = new Object();
    private boolean suspended = false;
    private boolean disableCheckpoint = false;
    private final Counter syncExecutorTime;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/SyncThread.java`
#### Snippet
```java
    private final Object suspensionLock = new Object();
    private boolean suspended = false;
    private boolean disableCheckpoint = false;
    private final Counter syncExecutorTime;
    private static String executorName = "SyncThread";
```

### RedundantFieldInitialization
Field initialization to `0L` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/JournalChannel.java`
#### Snippet
```java

    // The position of the file channel's last drop position
    private long lastDropPosition = 0L;

    final ServerConfiguration configuration;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/JournalChannel.java`
#### Snippet
```java
    final int formatVersion;
    BufferedChannel bc;
    long nextPrealloc = 0;

    final byte[] magicWord = "BKLG".getBytes(UTF_8);
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/GarbageCollectorThread.java`
#### Snippet
```java
    // Compaction parameters
    boolean isForceMinorCompactionAllow = false;
    boolean enableMinorCompaction = false;
    final double minorCompactionThreshold;
    final long minorCompactionInterval;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/GarbageCollectorThread.java`
#### Snippet
```java

    // Compaction parameters
    boolean isForceMinorCompactionAllow = false;
    boolean enableMinorCompaction = false;
    final double minorCompactionThreshold;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/GarbageCollectorThread.java`
#### Snippet
```java

    private final ScheduledExecutorService gcExecutor;
    Future<?> scheduledFuture = null;

    // This is how often we want to run the Garbage Collector Thread (in milliseconds).
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/GarbageCollectorThread.java`
#### Snippet
```java

    boolean isForceMajorCompactionAllow = false;
    boolean enableMajorCompaction = false;
    final double majorCompactionThreshold;
    final long majorCompactionInterval;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/GarbageCollectorThread.java`
#### Snippet
```java
    long lastMinorCompactionTime;

    boolean isForceMajorCompactionAllow = false;
    boolean enableMajorCompaction = false;
    final double majorCompactionThreshold;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/IndexInMemPageMgr.java`
#### Snippet
```java
        final long totalEntries;

        long curEntry = 0;

        PageEntriesIterableImpl(long ledgerId) throws IOException {
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BufferedReadChannel.java`
#### Snippet
```java
    protected long readBufferStartPosition = Long.MIN_VALUE;

    long invocationCount = 0;
    long cacheHitCount = 0;

```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BufferedReadChannel.java`
#### Snippet
```java

    long invocationCount = 0;
    long cacheHitCount = 0;

    public BufferedReadChannel(FileChannel fileChannel, int readCapacity) {
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryLoggerAllocator.java`
#### Snippet
```java

    private long preallocatedLogId;
    Future<BufferedLogChannel> preallocation = null;
    ExecutorService allocatorExecutor;
    private final ServerConfiguration conf;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LedgerDescriptorImpl.java`
#### Snippet
```java

    private AtomicBoolean fenceEntryPersisted = new AtomicBoolean();
    private CompletableFuture<Boolean> logFenceResult = null;

    LedgerDescriptorImpl(byte[] masterKey,
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/InterleavedStorageRegenerateIndexOp.java`
#### Snippet
```java
        long firstEntry = Long.MAX_VALUE;
        long lastEntry = Long.MIN_VALUE;
        long numEntries = 0;

        void registerEntry(long entryId) {
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Cookie.java`
#### Snippet
```java
        private String journalDirs = null;
        private String ledgerDirs = null;
        private String instanceId = null;
        private String indexDirs = null;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Cookie.java`
#### Snippet
```java
        private int layoutVersion = CURRENT_COOKIE_LAYOUT_VERSION;
        private String bookieId = null;
        private String journalDirs = null;
        private String ledgerDirs = null;
        private String instanceId = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Cookie.java`
#### Snippet
```java
    public static class Builder {
        private int layoutVersion = CURRENT_COOKIE_LAYOUT_VERSION;
        private String bookieId = null;
        private String journalDirs = null;
        private String ledgerDirs = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Cookie.java`
#### Snippet
```java
        private String bookieId = null;
        private String journalDirs = null;
        private String ledgerDirs = null;
        private String instanceId = null;
        private String indexDirs = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Cookie.java`
#### Snippet
```java
        private String ledgerDirs = null;
        private String instanceId = null;
        private String indexDirs = null;

        private Builder() {
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryLogManagerForEntryLogPerLedger.java`
#### Snippet
```java
    static class BufferedLogChannelWithDirInfo {
        private final BufferedLogChannel logChannel;
        volatile boolean ledgerDirFull = false;

        private BufferedLogChannelWithDirInfo(BufferedLogChannel logChannel) {
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Journal.java`
#### Snippet
```java

    private static class CbThreadFactory implements ThreadFactory {
        private int counter = 0;
        private String threadBaseName = "bookie-journal-callback";

```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BufferedChannel.java`
#### Snippet
```java
    protected final AtomicLong unpersistedBytes;

    private boolean closed = false;

    // make constructor to be public for unit test
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LedgerEntryPage.java`
#### Snippet
```java
        return new OfLong() {
            long firstEntry = getFirstEntry();
            int curDiffEntry = 0;

            @Override
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryKeyValue.java`
#### Snippet
```java
    private final byte [] bytes;
    private int offset = 0; // start offset of entry blob
    private int length = 0; // length of entry blob

    /**
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryKeyValue.java`
#### Snippet
```java
public class EntryKeyValue extends EntryKey {
    private final byte [] bytes;
    private int offset = 0; // start offset of entry blob
    private int length = 0; // length of entry blob

```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/SlowBufferedChannel.java`
#### Snippet
```java
 */
public class SlowBufferedChannel extends BufferedChannel {
    public volatile long getDelay = 0;
    public volatile long addDelay = 0;
    public volatile long flushDelay = 0;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/SlowBufferedChannel.java`
#### Snippet
```java
public class SlowBufferedChannel extends BufferedChannel {
    public volatile long getDelay = 0;
    public volatile long addDelay = 0;
    public volatile long flushDelay = 0;

```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/SlowBufferedChannel.java`
#### Snippet
```java
    public volatile long getDelay = 0;
    public volatile long addDelay = 0;
    public volatile long flushDelay = 0;

    public SlowBufferedChannel(ByteBufAllocator allocator, FileChannel fc, int capacity) throws IOException {
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/DefaultEntryLogger.java`
#### Snippet
```java
                    int remainingLedgers = numberOfLedgers;
                    boolean startNewBatch = true;
                    int remainingInBatch = 0;

                    @Override
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LedgerCacheImpl.java`
#### Snippet
```java
        final Iterator<LedgerCache.PageEntries> pageEntriesIterator = pageEntriesIteratorNonFinal;
        return new OfLong() {
            private OfLong entriesInCurrentLEPIterator = null;
            {
                if (pageEntriesIterator.hasNext()) {
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/FileInfo.java`
#### Snippet
```java
    private FileChannel fc;
    private File lf;
    private ByteBuffer explicitLac = null;

    byte[] masterKey;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/FileInfo.java`
#### Snippet
```java

    // lac
    private Long lac = null;

    // file access mode
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/FileInfo.java`
#### Snippet
```java
    // bit map for states of the ledger.
    private int stateBits;
    private boolean needFlushHeader = false;

    // lac
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieShell.java`
#### Snippet
```java
    File[] journalDirectories;

    EntryLogger entryLogger = null;
    List<Journal> journals = null;
    EntryFormatter entryFormatter;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieShell.java`
#### Snippet
```java

    EntryLogger entryLogger = null;
    List<Journal> journals = null;
    EntryFormatter entryFormatter;
    LedgerIdFormatter ledgerIdFormatter;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieStateManager.java`
#### Snippet
```java
    private volatile boolean running = false;
    // Flag identify whether it is in shutting down progress
    private volatile boolean shuttingdown = false;
    // Bookie status
    private final BookieStatus bookieStatus = new BookieStatus();
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieStateManager.java`
#### Snippet
```java

    // Running flag
    private volatile boolean running = false;
    // Flag identify whether it is in shutting down progress
    private volatile boolean shuttingdown = false;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/TransientLedgerInfo.java`
#### Snippet
```java
    private volatile long lac = NOT_ASSIGNED_LAC;
    // request from explicit lac requests
    private ByteBuffer explicitLac = null;
    // is the ledger info closed?
    private boolean isClosed;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/DbLedgerStorage.java`
#### Snippet
```java

    private ExecutorService entryLoggerWriteExecutor = null;
    private ExecutorService entryLoggerFlushExecutor = null;

    protected ByteBufAllocator allocator;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/DbLedgerStorage.java`
#### Snippet
```java
    private List<SingleDirectoryDbLedgerStorage> ledgerStorageList;

    private ExecutorService entryLoggerWriteExecutor = null;
    private ExecutorService entryLoggerFlushExecutor = null;

```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/Buffer.java`
#### Snippet
```java
    ByteBuf buffer;
    ByteBuffer byteBuffer;
    long pointer = 0;

    Buffer(NativeIO nativeIO, int bufferSize) throws IOException {
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/LogMetadata.java`
#### Snippet
```java
                int remainingLedgers = numberOfLedgers;
                boolean startNewBatch = true;
                int remainingInBatch = 0;

                @Override
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadLastConfirmedOp.java`
#### Snippet
```java
    private int numResponsesPending;
    private RecoveryData maxRecoveredData;
    private volatile boolean completed = false;
    private int lastSeenError = BKException.Code.ReadException;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/datainteg/MetadataAsyncIterator.java`
#### Snippet
```java
    private static class FlatIterator {
        final LedgerManager.LedgerRangeIterator ranges;
        Iterator<Long> range = null;
        FlatIterator(LedgerManager.LedgerRangeIterator ranges) {
            this.ranges = ranges;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerMetadataBuilder.java`
#### Snippet
```java

    private long ctime = -1;
    private boolean storeCtime = false;
    private Map<String, byte[]> customMetadata = Collections.emptyMap();

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RoundRobinDistributionSchedule.java`
#### Snippet
```java

    private static class WriteSetImpl implements WriteSet {
        int[] array = null;
        int size;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ZoneawareEnsemblePlacementPolicy.java`
#### Snippet
```java
public class ZoneawareEnsemblePlacementPolicy extends ZoneawareEnsemblePlacementPolicyImpl
        implements ITopologyAwareEnsemblePlacementPolicy<BookieNode> {
    ZoneawareEnsemblePlacementPolicyImpl slave = null;

    public ZoneawareEnsemblePlacementPolicy() {
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/MSLedgerManagerFactory.java`
#### Snippet
```java
        class MSLedgerRangeIterator implements LedgerRangeIterator {
            final CountDownLatch openCursorLatch = new CountDownLatch(1);
            MetastoreCursor cursor = null;
            // last ledger id in previous range

```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/MSLedgerManagerFactory.java`
#### Snippet
```java
        T value;
        int rc;
        boolean finished = false;

        public synchronized void complete(int rc, T value) {
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/SyncCounter.java`
#### Snippet
```java
    int rc;
    int total;
    Enumeration<LedgerEntry> seq = null;
    LedgerHandle lh = null;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/SyncCounter.java`
#### Snippet
```java
    int total;
    Enumeration<LedgerEntry> seq = null;
    LedgerHandle lh = null;

    synchronized void inc() {
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerOpenOp.java`
#### Snippet
```java
    final byte[] passwd;
    boolean doRecovery = true;
    boolean administrativeOpen = false;
    long startTime;
    final OpStatsLogger openOpLogger;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/TryReadLastConfirmedOp.java`
#### Snippet
```java

    int numResponsesPending;
    volatile boolean hasValidResponse = false;
    volatile boolean completed = false;
    RecoveryData maxRecoveredData;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/TryReadLastConfirmedOp.java`
#### Snippet
```java
    int numResponsesPending;
    volatile boolean hasValidResponse = false;
    volatile boolean completed = false;
    RecoveryData maxRecoveredData;
    final List<BookieId> currentEnsemble;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java`
#### Snippet
```java
    private static final Logger LOG = LoggerFactory.getLogger(PendingReadOp.class);

    private ScheduledFuture<?> speculativeTask = null;
    protected final LinkedList<LedgerEntryRequest> seq;
    private final CompletableFuture<LedgerEntries> future;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java`
#### Snippet
```java
    class SequenceReadRequest extends LedgerEntryRequest {
        static final int NOT_FOUND = -1;
        int nextReplicaIndexToReadFrom = 0;

        final BitSet sentReplicas;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java`
#### Snippet
```java
        int rc = BKException.Code.OK;
        int firstError = BKException.Code.OK;
        int numBookiesMissingEntry = 0;

        final List<BookieId> ensemble;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java`
#### Snippet
```java
    final boolean isRecoveryRead;

    boolean parallelRead = false;
    final AtomicBoolean complete = new AtomicBoolean(false);
    boolean allowFailFast = false;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadOp.java`
#### Snippet
```java
    boolean parallelRead = false;
    final AtomicBoolean complete = new AtomicBoolean(false);
    boolean allowFailFast = false;

    abstract class LedgerEntryRequest implements SpeculativeRequestExecutor, AutoCloseable {
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ForceLedgerOp.java`
#### Snippet
```java
    DistributionSchedule.AckSet ackSet;
    boolean completed = false;
    boolean errored = false;
    int lastSeenError = BKException.Code.WriteException;
    final List<BookieId> currentEnsemble;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ForceLedgerOp.java`
#### Snippet
```java

    DistributionSchedule.AckSet ackSet;
    boolean completed = false;
    boolean errored = false;
    int lastSeenError = BKException.Code.WriteException;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadLastConfirmedAndEntryOp.java`
#### Snippet
```java
    class SequenceReadRequest extends ReadLACAndEntryRequest {
        static final int NOT_FOUND = -1;
        int nextReplicaIndexToReadFrom = 0;

        final BitSet sentReplicas;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadLastConfirmedAndEntryOp.java`
#### Snippet
```java
    private long timeOutInMillis;
    private final List<BookieId> currentEnsemble;
    private ScheduledFuture<?> speculativeTask = null;

    abstract class ReadLACAndEntryRequest implements AutoCloseable {
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadLastConfirmedAndEntryOp.java`
#### Snippet
```java
    private int numResponsesPending;
    private final int numEmptyResponsesAllowed;
    private volatile boolean hasValidResponse = false;
    private final long prevEntryId;
    private long lastAddConfirmed;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadLastConfirmedAndEntryOp.java`
#### Snippet
```java
    final BitSet emptyResponsesFromHostsBitSet;
    final int maxMissedReadsAllowed;
    boolean parallelRead = false;
    final AtomicBoolean requestComplete = new AtomicBoolean(false);

```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadLastConfirmedAndEntryOp.java`
#### Snippet
```java
        int rc = BKException.Code.OK;
        int firstError = BKException.Code.OK;
        int numMissedEntryReads = 0;

        final List<BookieId> ensemble;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadLacOp.java`
#### Snippet
```java
    LacCallback cb;
    int numResponsesPending;
    volatile boolean completed = false;
    int lastSeenError = BKException.Code.ReadException;
    final DistributionSchedule.QuorumCoverageSet coverageSet;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookieInfoReader.java`
#### Snippet
```java

    /* State to track scan execution progress as callbacks come in */
    private int totalSent = 0;
    private int completedCnt = 0;
    private int errorCnt = 0;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookieInfoReader.java`
#### Snippet
```java
    public enum State { UNQUEUED, PARTIAL, FULL }
    private static class InstanceState {
        private boolean running = false;
        private State queuedType = State.UNQUEUED;

```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookieInfoReader.java`
#### Snippet
```java
    /* State to track scan execution progress as callbacks come in */
    private int totalSent = 0;
    private int completedCnt = 0;
    private int errorCnt = 0;

```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookieInfoReader.java`
#### Snippet
```java
    private int totalSent = 0;
    private int completedCnt = 0;
    private int errorCnt = 0;

    /**
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RackawareEnsemblePlacementPolicy.java`
#### Snippet
```java
public class RackawareEnsemblePlacementPolicy extends RackawareEnsemblePlacementPolicyImpl
        implements ITopologyAwareEnsemblePlacementPolicy<BookieNode> {
    RackawareEnsemblePlacementPolicyImpl slave = null;

    public RackawareEnsemblePlacementPolicy() {
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingWriteLacOp.java`
#### Snippet
```java

    DistributionSchedule.AckSet ackSet;
    boolean completed = false;
    int lastSeenError = BKException.Code.WriteException;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerRecoveryOp.java`
#### Snippet
```java
    // EntryListener Hook
    @VisibleForTesting
    ReadEntryListener entryListener = null;

    class RecoveryReadOp extends ListenerBasedPendingReadOp {
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RegionAwareEnsemblePlacementPolicy.java`
#### Snippet
```java
    protected int minRegionsForDurability = 0;
    protected boolean enableValidation = true;
    protected boolean enforceDurabilityInReplace = false;
    protected Feature disableDurabilityFeature;
    private int lastRegionIndex = 0;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RegionAwareEnsemblePlacementPolicy.java`
#### Snippet
```java
    protected FeatureProvider featureProvider;
    protected String disallowBookiePlacementInRegionFeatureName;
    protected String myRegion = null;
    protected int minRegionsForDurability = 0;
    protected boolean enableValidation = true;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RegionAwareEnsemblePlacementPolicy.java`
#### Snippet
```java
    protected boolean enforceDurabilityInReplace = false;
    protected Feature disableDurabilityFeature;
    private int lastRegionIndex = 0;

    RegionAwareEnsemblePlacementPolicy() {
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RegionAwareEnsemblePlacementPolicy.java`
#### Snippet
```java
    protected String disallowBookiePlacementInRegionFeatureName;
    protected String myRegion = null;
    protected int minRegionsForDurability = 0;
    protected boolean enableValidation = true;
    protected boolean enforceDurabilityInReplace = false;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
    final EnumSet<WriteFlag> writeFlags;

    ScheduledFuture<?> timeoutFuture = null;

    @VisibleForTesting
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java

    final Object metadataLock = new Object();
    boolean changingEnsemble = false;
    final AtomicInteger numEnsembleChanges = new AtomicInteger(0);
    Queue<PendingAddOp> pendingAddOps;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
    boolean hasRun;
    EnumSet<WriteFlag> writeFlags;
    boolean allowFailFast = false;
    List<BookieId> ensemble;

```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
    LedgerHandle lh;
    ClientContext clientCtx;
    boolean isRecoveryAdd = false;
    volatile long requestTimeNanos;
    long qwcLatency; // Quorum Write Completion Latency after response from quorum bookies.
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java

    DistributionSchedule.AckSet ackSet;
    boolean completed = false;

    LedgerHandle lh;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/MetadataUpdateLoop.java`
#### Snippet
```java

    private final String logContext;
    private volatile int writeLoopCount = 0;
    private static final AtomicIntegerFieldUpdater<MetadataUpdateLoop> WRITE_LOOP_COUNT_UPDATER =
        AtomicIntegerFieldUpdater.newUpdater(MetadataUpdateLoop.class, "writeLoopCount");
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerCreateOp.java`
#### Snippet
```java
    final OpStatsLogger createOpLogger;
    final BookKeeperClientStats clientStats;
    boolean adv = false;
    boolean generateLedgerId = true;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookieWatcherImpl.java`
#### Snippet
```java
    private volatile Set<BookieId> readOnlyBookies = Collections.emptySet();

    private CompletableFuture<?> initialWritableBookiesFuture = null;
    private CompletableFuture<?> initialReadonlyBookiesFuture = null;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookieWatcherImpl.java`
#### Snippet
```java

    private CompletableFuture<?> initialWritableBookiesFuture = null;
    private CompletableFuture<?> initialReadonlyBookiesFuture = null;

    private final BookieAddressResolver bookieAddressResolver;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/impl/OpenBuilderBase.java`
#### Snippet
```java
    static final Logger LOG = LoggerFactory.getLogger(OpenBuilderBase.class);

    protected boolean recovery = false;
    protected long ledgerId = LedgerHandle.INVALID_LEDGER_ID;
    protected byte[] password;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/TopologyAwareEnsemblePlacementPolicy.java`
#### Snippet
```java
        help = "The distribution of number of bookies left the cluster on each network topology change"
    )
    protected OpStatsLogger bookiesLeftCounter = null;

    protected static class TruePredicate implements Predicate<BookieNode> {
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/TopologyAwareEnsemblePlacementPolicy.java`
#### Snippet
```java
            help = "The distribution of number of bookies joined the cluster on each network topology change"
    )
    protected OpStatsLogger bookiesJoinedCounter = null;
    @StatsDoc(
        name = BOOKIES_LEFT,
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/TopologyAwareEnsemblePlacementPolicy.java`
#### Snippet
```java
        protected class RackQuorumCoverageSet implements CoverageSet {
            HashSet<String> racksOrRegionsInQuorum = new HashSet<String>();
            int seenBookies = 0;
            private final int minNumRacksPerWriteQuorum;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ZoneawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
    @StatsDoc(name = FAILED_TO_RESOLVE_NETWORK_LOCATION_COUNT, help = "Counter for number of times"
            + " DNSResolverDecorator failed to resolve Network Location")
    protected Counter failedToResolveNetworkLocationCounter = null;
    @StatsDoc(name = NUM_WRITABLE_BOOKIES_IN_DEFAULT_FAULTDOMAIN, help = "Gauge for the number of writable"
            + " Bookies in default fault domain")
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ZoneawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
    protected boolean reorderReadsRandom = false;
    protected int stabilizePeriodSeconds = 0;
    protected int reorderThresholdPendingRequests = 0;
    protected int maxWeightMultiple;
    protected int minNumZonesPerWriteQuorum;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ZoneawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
    protected String myZone = null;
    protected boolean reorderReadsRandom = false;
    protected int stabilizePeriodSeconds = 0;
    protected int reorderThresholdPendingRequests = 0;
    protected int maxWeightMultiple;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ZoneawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
    protected Cache<BookieId, Long> slowBookies;
    protected BookieNode myNode = null;
    protected String myZone = null;
    protected boolean reorderReadsRandom = false;
    protected int stabilizePeriodSeconds = 0;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ZoneawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
    protected BookieNode myNode = null;
    protected String myZone = null;
    protected boolean reorderReadsRandom = false;
    protected int stabilizePeriodSeconds = 0;
    protected int reorderThresholdPendingRequests = 0;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ZoneawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
    // Use a loading cache so slow bookies are expired. Use entryId as values.
    protected Cache<BookieId, Long> slowBookies;
    protected BookieNode myNode = null;
    protected String myZone = null;
    protected boolean reorderReadsRandom = false;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ZoneawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
            NetworkTopology.DEFAULT_ZONE, NetworkTopology.DEFAULT_UPGRADEDOMAIN);
    private final Random rand;
    protected StatsLogger statsLogger = null;
    // Use a loading cache so slow bookies are expired. Use entryId as values.
    protected Cache<BookieId, Long> slowBookies;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/http/BKHttpServiceProvider.java`
#### Snippet
```java
        LedgerManagerFactory ledgerManagerFactory = null;
        ServerConfiguration serverConf = null;
        StatsProvider statsProvider = null;

        public Builder setBookieServer(BookieServer bookieServer) {
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/http/BKHttpServiceProvider.java`
#### Snippet
```java
    public static class Builder {

        BookieServer bookieServer = null;
        AutoRecoveryMain autoRecovery = null;
        LedgerManagerFactory ledgerManagerFactory = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/http/BKHttpServiceProvider.java`
#### Snippet
```java
        AutoRecoveryMain autoRecovery = null;
        LedgerManagerFactory ledgerManagerFactory = null;
        ServerConfiguration serverConf = null;
        StatsProvider statsProvider = null;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/http/BKHttpServiceProvider.java`
#### Snippet
```java
        BookieServer bookieServer = null;
        AutoRecoveryMain autoRecovery = null;
        LedgerManagerFactory ledgerManagerFactory = null;
        ServerConfiguration serverConf = null;
        StatsProvider statsProvider = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/http/BKHttpServiceProvider.java`
#### Snippet
```java

        BookieServer bookieServer = null;
        AutoRecoveryMain autoRecovery = null;
        LedgerManagerFactory ledgerManagerFactory = null;
        ServerConfiguration serverConf = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerFragmentReplicator.java`
#### Snippet
```java
    private final OpStatsLogger writeDataLatency;

    protected Throttler replicationThrottle = null;

    private AtomicInteger averageEntrySize;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/discover/ZKRegistrationManager.java`
#### Snippet
```java
    private final LayoutManager layoutManager;

    private volatile boolean zkRegManagerInitialized = false;

    // ledgers root path
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/discover/ZKRegistrationClient.java`
#### Snippet
```java
    private WatchTask watchWritableBookiesTask = null;
    @Getter(AccessLevel.PACKAGE)
    private WatchTask watchReadOnlyBookiesTask = null;
    private final ConcurrentHashMap<BookieId, Versioned<BookieServiceInfo>> bookieServiceInfoCache =
                                                                            new ConcurrentHashMap<>();
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/discover/ZKRegistrationClient.java`
#### Snippet
```java
        private final String regPath;
        private final Set<RegistrationListener> listeners;
        private volatile boolean closed = false;
        private Set<BookieId> bookies = null;
        private Version version = Version.NEW;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/discover/ZKRegistrationClient.java`
#### Snippet
```java
    private final ScheduledExecutorService scheduler;
    @Getter(AccessLevel.PACKAGE)
    private WatchTask watchWritableBookiesTask = null;
    @Getter(AccessLevel.PACKAGE)
    private WatchTask watchReadOnlyBookiesTask = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/discover/ZKRegistrationClient.java`
#### Snippet
```java
        private final Set<RegistrationListener> listeners;
        private volatile boolean closed = false;
        private Set<BookieId> bookies = null;
        private Version version = Version.NEW;
        private final CompletableFuture<Void> firstRunFuture;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/streaming/LedgerInputStream.java`
#### Snippet
```java
    private ByteBuffer bytebuff;
    byte[] bbytes;
    long lastEntry = 0;
    int increment = 50;
    int defaultSize = 1024 * 1024; // 1MB default size
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/streaming/LedgerInputStream.java`
#### Snippet
```java
    int increment = 50;
    int defaultSize = 1024 * 1024; // 1MB default size
    Enumeration<LedgerEntry> ledgerSeq = null;

    /**
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
    }

    private int outstandingWriteCount = 0;
    private int outstandingReadCount = 0;
    private long nextLedger = 0;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
        private long lastEntryIDCompleted = -1;
        private long confirmedLAC = -1;
        private boolean closed = false;

        final TreeSet<Long> writesInProgress = new TreeSet<>();
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
        int readsInProgress = 0;
        Consumer<Consumer<Integer>> onLastOp = null;
        Consumer<Consumer<Integer>> onLastWrite = null;

        EntryIterator iter;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java

    class WriteCallback implements Consumer<Integer> {
        private int completed = 0;
        private final int toWaitFor;
        private final LedgerInfo ledger;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
        final TreeSet<Long> writesCompleted = new TreeSet<>();
        int readsInProgress = 0;
        Consumer<Consumer<Integer>> onLastOp = null;
        Consumer<Consumer<Integer>> onLastWrite = null;

```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
        final TreeSet<Long> writesInProgress = new TreeSet<>();
        final TreeSet<Long> writesCompleted = new TreeSet<>();
        int readsInProgress = 0;
        Consumer<Consumer<Integer>> onLastOp = null;
        Consumer<Consumer<Integer>> onLastWrite = null;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java

    private int outstandingWriteCount = 0;
    private int outstandingReadCount = 0;
    private long nextLedger = 0;
    private long getNextLedgerID() {
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
    private int outstandingWriteCount = 0;
    private int outstandingReadCount = 0;
    private long nextLedger = 0;
    private long getNextLedgerID() {
        return nextLedger++;
```

### RedundantFieldInitialization
Field initialization to `0L` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/zookeeper/ZooWorker.java`
#### Snippet
```java
    int attempts = 0;
    long startTimeNanos;
    long elapsedTimeMs = 0L;
    final RetryPolicy retryPolicy;
    final OpStatsLogger statsLogger;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/zookeeper/ZooWorker.java`
#### Snippet
```java
    private static final Logger logger = LoggerFactory.getLogger(ZooWorker.class);

    int attempts = 0;
    long startTimeNanos;
    long elapsedTimeMs = 0L;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/AutoRecoveryMain.java`
#### Snippet
```java
    int exitCode;
    private volatile boolean shuttingDown = false;
    private volatile boolean running = false;

    // Exception handler
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/AutoRecoveryMain.java`
#### Snippet
```java

    // Exception handler
    private volatile UncaughtExceptionHandler uncaughtExceptionHandler = null;

    public AutoRecoveryMain(ServerConfiguration conf) throws IOException,
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/AutoRecoveryMain.java`
#### Snippet
```java
    final AutoRecoveryDeathWatcher deathWatcher;
    int exitCode;
    private volatile boolean shuttingDown = false;
    private volatile boolean running = false;

```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/ReplicationWorker.java`
#### Snippet
```java
    private final LedgerUnderreplicationManager underreplicationManager;
    private final ServerConfiguration conf;
    private volatile boolean workerRunning = false;
    private final BookKeeperAdmin admin;
    private final LedgerChecker ledgerChecker;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/ReplicationWorker.java`
#### Snippet
```java
    private static class CheckerCallback implements
            GenericCallback<Set<LedgerFragment>> {
        private Set<LedgerFragment> result = null;
        private CountDownLatch latch = new CountDownLatch(1);

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RackawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
            help = "The distribution of number of bookies reordered on each read request"
    )
    protected OpStatsLogger readReorderedCounter = null;
    @StatsDoc(
            name = FAILED_TO_RESOLVE_NETWORK_LOCATION_COUNT,
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RackawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
    // looks like these only assigned in the same thread as constructor, immediately after constructor;
    // no need to make volatile
    protected StatsLogger statsLogger = null;

    @StatsDoc(
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RackawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
    protected Cache<BookieId, Long> slowBookies;
    protected BookieNode localNode;
    protected boolean reorderReadsRandom = false;
    protected boolean enforceDurability = false;
    protected int stabilizePeriodSeconds = 0;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RackawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
            help = "Counter for number of times DNSResolverDecorator failed to resolve Network Location"
    )
    protected Counter failedToResolveNetworkLocationCounter = null;
    @StatsDoc(
            name = NUM_WRITABLE_BOOKIES_IN_DEFAULT_RACK,
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RackawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
    protected BookieNode localNode;
    protected boolean reorderReadsRandom = false;
    protected boolean enforceDurability = false;
    protected int stabilizePeriodSeconds = 0;
    protected int reorderThresholdPendingRequests = 0;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RackawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
    protected boolean enforceDurability = false;
    protected int stabilizePeriodSeconds = 0;
    protected int reorderThresholdPendingRequests = 0;
    // looks like these only assigned in the same thread as constructor, immediately after constructor;
    // no need to make volatile
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RackawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
    protected boolean reorderReadsRandom = false;
    protected boolean enforceDurability = false;
    protected int stabilizePeriodSeconds = 0;
    protected int reorderThresholdPendingRequests = 0;
    // looks like these only assigned in the same thread as constructor, immediately after constructor;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdWatcher.java`
#### Snippet
```java
    @Setter
    private long revision;
    private boolean closed = false;
    // the client owns this watcher
    private final EtcdWatchClient owner;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/zookeeper/ZooKeeperClient.java`
#### Snippet
```java
        StatsLogger statsLogger = NullStatsLogger.INSTANCE;
        int retryExecThreadCount = DEFAULT_RETRY_EXECUTOR_THREAD_COUNT;
        double requestRateLimit = 0;
        boolean allowReadOnlyMode = false;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/zookeeper/ZooKeeperClient.java`
#### Snippet
```java
     */
    public static class Builder {
        String connectString = null;
        int sessionTimeoutMs = 10000;
        Set<Watcher> watchers = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/zookeeper/ZooKeeperClient.java`
#### Snippet
```java
        int sessionTimeoutMs = 10000;
        Set<Watcher> watchers = null;
        RetryPolicy connectRetryPolicy = null;
        RetryPolicy operationRetryPolicy = null;
        StatsLogger statsLogger = NullStatsLogger.INSTANCE;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/zookeeper/ZooKeeperClient.java`
#### Snippet
```java
        String connectString = null;
        int sessionTimeoutMs = 10000;
        Set<Watcher> watchers = null;
        RetryPolicy connectRetryPolicy = null;
        RetryPolicy operationRetryPolicy = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/zookeeper/ZooKeeperClient.java`
#### Snippet
```java
        Set<Watcher> watchers = null;
        RetryPolicy connectRetryPolicy = null;
        RetryPolicy operationRetryPolicy = null;
        StatsLogger statsLogger = NullStatsLogger.INSTANCE;
        int retryExecThreadCount = DEFAULT_RETRY_EXECUTOR_THREAD_COUNT;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/zookeeper/ZooKeeperClient.java`
#### Snippet
```java
        int retryExecThreadCount = DEFAULT_RETRY_EXECUTOR_THREAD_COUNT;
        double requestRateLimit = 0;
        boolean allowReadOnlyMode = false;

        private Builder() {}
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdBookieRegister.java`
#### Snippet
```java
    @Getter(AccessLevel.PACKAGE)
    private volatile long leaseId = -0xabcd;
    private volatile CloseableClient kaListener = null;
    private volatile boolean running = true;
    private long nextWaitTimeMs = 200;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdBookieRegister.java`
#### Snippet
```java
    private volatile boolean running = true;
    private long nextWaitTimeMs = 200;
    private Future<?> runFuture = null;

    EtcdBookieRegister(Lease leaseClient,
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeper.java`
#### Snippet
```java
        ZooKeeper zk = null;
        EventLoopGroup eventLoopGroup = null;
        ByteBufAllocator allocator = null;
        StatsLogger statsLogger = NullStatsLogger.INSTANCE;
        DNSToSwitchMapping dnsResolver = null;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeper.java`
#### Snippet
```java

    // Close State
    boolean closed = false;
    final ReentrantReadWriteLock closeLock = new ReentrantReadWriteLock();

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeper.java`
#### Snippet
```java
        private final LedgerRangeIterator iterator;
        private final ListLedgersResultImpl parent;
        Iterator<Long> currentRange = null;

        public SyncLedgerIterator(LedgerRangeIterator iterator, ListLedgersResultImpl parent) {
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeper.java`
#### Snippet
```java
    // whether the event loop group is one we created, or is owned by whoever
    // instantiated us
    boolean ownEventLoopGroup = false;

    final BookieClient bookieClient;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeper.java`
#### Snippet
```java
        DNSToSwitchMapping dnsResolver = null;
        HashedWheelTimer requestTimer = null;
        FeatureProvider featureProvider = null;

        Builder(ClientConfiguration conf) {
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeper.java`
#### Snippet
```java
        final ClientConfiguration conf;

        ZooKeeper zk = null;
        EventLoopGroup eventLoopGroup = null;
        ByteBufAllocator allocator = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeper.java`
#### Snippet
```java
        StatsLogger statsLogger = NullStatsLogger.INSTANCE;
        DNSToSwitchMapping dnsResolver = null;
        HashedWheelTimer requestTimer = null;
        FeatureProvider featureProvider = null;

```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeper.java`
#### Snippet
```java

        private final LedgerRangeIterator iterator;
        private boolean closed = false;
        private LedgersIterator ledgersIterator;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeper.java`
#### Snippet
```java
        ByteBufAllocator allocator = null;
        StatsLogger statsLogger = NullStatsLogger.INSTANCE;
        DNSToSwitchMapping dnsResolver = null;
        HashedWheelTimer requestTimer = null;
        FeatureProvider featureProvider = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeper.java`
#### Snippet
```java

        ZooKeeper zk = null;
        EventLoopGroup eventLoopGroup = null;
        ByteBufAllocator allocator = null;
        StatsLogger statsLogger = NullStatsLogger.INSTANCE;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/helpers/RevisionedConsumer.java`
#### Snippet
```java

    protected final Consumer<Versioned<T>> consumer;
    protected volatile Version localVersion = null;

    protected RevisionedConsumer(Consumer<Versioned<T>> consumer) {
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/helpers/KeyIterator.java`
#### Snippet
```java
    private CompletableFuture<List<T>> readFuture = null;
    private boolean hasNext = true;
    private List<T> keys = null;

    public KeyIterator(KeyStream<T> stream) {
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/helpers/KeyIterator.java`
#### Snippet
```java

    private final KeyStream<T> stream;
    private CompletableFuture<List<T>> readFuture = null;
    private boolean hasNext = true;
    private List<T> keys = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/clients/java/all/src/main/java/org/apache/bookkeeper/clients/StorageClientBuilder.java`
#### Snippet
```java
public class StorageClientBuilder implements Supplier<StorageClient> {

    private StorageClientSettings settings = null;
    private String namespaceName = null;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/clients/java/all/src/main/java/org/apache/bookkeeper/clients/StorageClientBuilder.java`
#### Snippet
```java

    private StorageClientSettings settings = null;
    private String namespaceName = null;

    /**
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdLedgerManager.java`
#### Snippet
```java
        new ConcurrentHashMap<>();

    private volatile boolean closed = false;

    EtcdLedgerManager(Client client,
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/helpers/KeyStream.java`
#### Snippet
```java
    private final int batchSize;
    private ByteSequence nextKey;
    private ByteSequence lastKey = null;
    private boolean hasMore = true;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/helpers/ValueStream.java`
#### Snippet
```java
    private final Map<Consumer<Versioned<T>>, RevisionedConsumer<T>> consumers =
        new HashMap<>();
    private volatile T localValue = null;
    private volatile long revision = -1L;
    private CompletableFuture<EtcdWatcher> watchFuture = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/helpers/ValueStream.java`
#### Snippet
```java
    private volatile long revision = -1L;
    private CompletableFuture<EtcdWatcher> watchFuture = null;
    private CompletableFuture<Void> closeFuture = null;

    public ValueStream(Client client,
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/helpers/ValueStream.java`
#### Snippet
```java
    private volatile T localValue = null;
    private volatile long revision = -1L;
    private CompletableFuture<EtcdWatcher> watchFuture = null;
    private CompletableFuture<Void> closeFuture = null;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/helpers/KeySetReader.java`
#### Snippet
```java
    private volatile long revision = -1L;
    private CompletableFuture<EtcdWatcher> watchFuture = null;
    private CompletableFuture<Void> closeFuture = null;

    public KeySetReader(Client client,
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/helpers/KeySetReader.java`
#### Snippet
```java
        new CopyOnWriteArraySet<>();
    private volatile long revision = -1L;
    private CompletableFuture<EtcdWatcher> watchFuture = null;
    private CompletableFuture<Void> closeFuture = null;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdWatchClient.java`
#### Snippet
```java

    // close state
    private CompletableFuture<Void> closeFuture = null;

    public EtcdWatchClient(Client client) {
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeperAdmin.java`
#### Snippet
```java
            public Iterator<Long> iterator() {
                return new Iterator<Long>() {
                    Iterator<Long> currentRange = null;

                    @Override
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `cpu-affinity/src/main/java/org/apache/bookkeeper/common/util/affinity/impl/CpuAffinityImpl.java`
#### Snippet
```java
    // Ids of processors that were isolated by Linux at boot time. This is the set
    // of processors that can acquired by this or other processes.
    private static SortedSet<Integer> isolatedProcessors = null;

    private static ProcessorsInfo processorsInfo = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `cpu-affinity/src/main/java/org/apache/bookkeeper/common/util/affinity/impl/CpuAffinityImpl.java`
#### Snippet
```java
    private static SortedSet<Integer> isolatedProcessors = null;

    private static ProcessorsInfo processorsInfo = null;

    public static synchronized void acquireCore() {
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `cpu-affinity/src/main/java/org/apache/bookkeeper/common/util/affinity/impl/CpuAffinityImpl.java`
#### Snippet
```java
public class CpuAffinityImpl {

    private static boolean isInitialized = false;
    private static boolean isSupported;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-http/http-server/src/main/java/org/apache/bookkeeper/http/HttpServerLoader.java`
#### Snippet
```java

    public static final String HTTP_SERVER_CLASS = "httpServerClass";
    static HttpServer server = null;

    public static void loadHttpServer(Configuration conf) {
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/metastore/InMemoryMetastoreTable.java`
#### Snippet
```java

    private String name;
    private TreeMap<String, Versioned<Value>> map = null;
    private TreeMap<String, MetastoreWatcher> watcherMap = null;
    private ScheduledExecutorService scheduler;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/metastore/InMemoryMetastoreTable.java`
#### Snippet
```java
    private String name;
    private TreeMap<String, Versioned<Value>> map = null;
    private TreeMap<String, MetastoreWatcher> watcherMap = null;
    private ScheduledExecutorService scheduler;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-common-allocator/src/main/java/org/apache/bookkeeper/common/allocator/impl/ByteBufAllocatorBuilderImpl.java`
#### Snippet
```java
public class ByteBufAllocatorBuilderImpl implements ByteBufAllocatorBuilder {

    ByteBufAllocator pooledAllocator = null;
    ByteBufAllocator unpooledAllocator = null;
    PoolingPolicy poolingPolicy = PoolingPolicy.PooledDirect;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-common-allocator/src/main/java/org/apache/bookkeeper/common/allocator/impl/ByteBufAllocatorBuilderImpl.java`
#### Snippet
```java
    int poolingConcurrency = 2 * Runtime.getRuntime().availableProcessors();
    OutOfMemoryPolicy outOfMemoryPolicy = OutOfMemoryPolicy.FallbackToHeap;
    Consumer<OutOfMemoryError> outOfMemoryListener = null;
    LeakDetectionPolicy leakDetectionPolicy = LeakDetectionPolicy.Disabled;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-common-allocator/src/main/java/org/apache/bookkeeper/common/allocator/impl/ByteBufAllocatorBuilderImpl.java`
#### Snippet
```java

    ByteBufAllocator pooledAllocator = null;
    ByteBufAllocator unpooledAllocator = null;
    PoolingPolicy poolingPolicy = PoolingPolicy.PooledDirect;
    int poolingConcurrency = 2 * Runtime.getRuntime().availableProcessors();
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stats/bookkeeper-stats-providers/codahale-metrics-provider/src/main/java/org/apache/bookkeeper/stats/codahale/CodahaleMetricsProvider.java`
#### Snippet
```java
    MetricRegistry metrics = null;
    List<ScheduledReporter> reporters = new ArrayList<ScheduledReporter>();
    JmxReporter jmx = null;

    synchronized void initIfNecessary() {
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stats/bookkeeper-stats-providers/codahale-metrics-provider/src/main/java/org/apache/bookkeeper/stats/codahale/CodahaleMetricsProvider.java`
#### Snippet
```java
    static final Logger LOG = LoggerFactory.getLogger(CodahaleMetricsProvider.class);

    MetricRegistry metrics = null;
    List<ScheduledReporter> reporters = new ArrayList<ScheduledReporter>();
    JmxReporter jmx = null;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stats/utils/src/main/java/org/apache/bookkeeper/stats/utils/StatsDocGenerator.java`
#### Snippet
```java
            },
            description = "Show this help message")
        boolean help = false;

    }
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stats/utils/src/main/java/org/apache/bookkeeper/stats/utils/StatsDocGenerator.java`
#### Snippet
```java
                + " If omitted, the output goes to stdout."
        )
        String yamlFile = null;

        @Parameter(
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `stats/bookkeeper-stats-providers/codahale-metrics-provider/src/main/java/org/apache/bookkeeper/stats/codahale/FastTimer.java`
#### Snippet
```java
    private final Object[] locks; // indexed by [hash]
    private final int[] lastTime;
    private int lastTimeBucket = 0;

    private final int[][] meter;    // indexed by [hash][time]
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-slogger/api/src/main/java/org/apache/bookkeeper/slogger/AbstractSlogger.java`
#### Snippet
```java
        };
    class CtxIterator implements Iterator<Object> {
        int index = 0;

        private void reset() {
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/EnvelopedEntryWriter.java`
#### Snippet
```java
    private final CompressionCodec.Type codec;
    private final int flags;
    private int count = 0;
    private boolean hasUserData = false;
    private long maxTxId = Long.MIN_VALUE;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/EnvelopedEntryWriter.java`
#### Snippet
```java
    private final String logName;
    private final ByteBuf buffer;
    private ByteBuf finalizedBuffer = null;
    private final LogRecord.Writer writer;
    private final List<WriteRequest> writeRequests;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/EnvelopedEntryWriter.java`
#### Snippet
```java
    private final int flags;
    private int count = 0;
    private boolean hasUserData = false;
    private long maxTxId = Long.MIN_VALUE;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/AppendOnlyStreamReader.java`
#### Snippet
```java
    static final Logger LOG = LoggerFactory.getLogger(AppendOnlyStreamReader.class);

    private LogRecordWithInputStream currentLogRecord = null;
    private final DistributedLogManager dlm;
    private LogReader reader;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java
        // is lost while parsing.
        // NOTE: This value is not stored in the Metadata store.
        protected boolean envelopeEntries = false;

        LogSegmentMetadataBuilder(String zkPath,
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BookKeeperClientBuilder.java`
#### Snippet
```java
    private String name = null;
    // dl config
    private DistributedLogConfiguration dlConfig = null;
    // bookkeeper settings
    // zookeeper client
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BookKeeperClientBuilder.java`
#### Snippet
```java
    private StatsLogger statsLogger = NullStatsLogger.INSTANCE;
    // client channel factory
    private EventLoopGroup eventLoopGroup = null;
    // request timer
    private HashedWheelTimer requestTimer = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BookKeeperClientBuilder.java`
#### Snippet
```java
    private ZooKeeperClient zkc = null;
    // or zookeeper servers
    private String zkServers = null;
    // ledgers path
    private String ledgersPath = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BookKeeperClientBuilder.java`
#### Snippet
```java
    // bookkeeper settings
    // zookeeper client
    private ZooKeeperClient zkc = null;
    // or zookeeper servers
    private String zkServers = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BookKeeperClientBuilder.java`
#### Snippet
```java

    // Cached BookKeeper Client
    private BookKeeperClient cachedClient = null;

    /**
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BookKeeperClientBuilder.java`
#### Snippet
```java
    private EventLoopGroup eventLoopGroup = null;
    // request timer
    private HashedWheelTimer requestTimer = null;
    // feature provider
    private Optional<FeatureProvider> featureProvider = Optional.empty();
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BookKeeperClientBuilder.java`
#### Snippet
```java
    private String zkServers = null;
    // ledgers path
    private String ledgersPath = null;
    // statsLogger
    private StatsLogger statsLogger = NullStatsLogger.INSTANCE;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BookKeeperClientBuilder.java`
#### Snippet
```java

    // client name
    private String name = null;
    // dl config
    private DistributedLogConfiguration dlConfig = null;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/EnvelopedEntryReader.java`
#### Snippet
```java
    // error lag
    private IOException lastException = null;
    private boolean isExhausted = false;

    EnvelopedEntryReader(long logSegmentSeqNo,
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/EnvelopedEntryReader.java`
#### Snippet
```java
    private long slotId = 0;
    // error lag
    private IOException lastException = null;
    private boolean isExhausted = false;

```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/EnvelopedEntryReader.java`
#### Snippet
```java

    // slot id
    private long slotId = 0;
    // error lag
    private IOException lastException = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/ZooKeeperClientBuilder.java`
#### Snippet
```java

    // Cached ZooKeeper Client
    private ZooKeeperClient cachedClient = null;

    private ZooKeeperClientBuilder() {}
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/ZooKeeperClientBuilder.java`
#### Snippet
```java
    private String zkServers = null;
    // retry policy
    private RetryPolicy retryPolicy = null;
    // stats logger
    private StatsLogger statsLogger = NullStatsLogger.INSTANCE;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BookKeeperClient.java`
#### Snippet
```java

    // bookkeeper client state
    private boolean closed = false;
    private BookKeeper bkc = null;
    private ZooKeeperClient zkc;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BookKeeperClient.java`
#### Snippet
```java
    // bookkeeper client state
    private boolean closed = false;
    private BookKeeper bkc = null;
    private ZooKeeperClient zkc;
    private final boolean ownZK;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/ZooKeeperClientBuilder.java`
#### Snippet
```java
    private int retryThreadCount = 1;
    // zookeeper access requestRateLimit limit
    private double requestRateLimit = 0;
    // Did call the zkAclId setter on the builder, used to ensure the setter is set.
    private boolean zkAclIdSet = false;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/ZooKeeperClientBuilder.java`
#### Snippet
```java
    private int conectionTimeoutMs = -1;
    // zkServers
    private String zkServers = null;
    // retry policy
    private RetryPolicy retryPolicy = null;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/ZooKeeperClientBuilder.java`
#### Snippet
```java
    private double requestRateLimit = 0;
    // Did call the zkAclId setter on the builder, used to ensure the setter is set.
    private boolean zkAclIdSet = false;
    private String zkAclId;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKSyncLogReader.java`
#### Snippet
```java
    private final Optional<Long> startTransactionId;
    private boolean positioned = false;
    private Entry.Reader currentEntry = null;

    // readahead reader
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKSyncLogReader.java`
#### Snippet
```java

    // readahead reader
    ReadAheadEntryReader readAheadReader = null;

    // idle reader settings
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKSyncLogReader.java`
#### Snippet
```java
    private CompletableFuture<Void> closeFuture;
    private final Optional<Long> startTransactionId;
    private boolean positioned = false;
    private Entry.Reader currentEntry = null;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAbstractLogWriter.java`
#### Snippet
```java
    private CompletableFuture<List<LogSegmentMetadata>> lastTruncationAttempt = null;
    @VisibleForTesting
    private Long minTimestampToKeepOverride = null;

    // Log Segment Writers
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAbstractLogWriter.java`
#### Snippet
```java
    protected CompletableFuture<BKLogSegmentWriter> segmentWriterFuture = null;
    protected BKLogSegmentWriter allocatedSegmentWriter = null;
    protected BKLogWriteHandler writeHandler = null;

    BKAbstractLogWriter(DistributedLogConfiguration conf,
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAbstractLogWriter.java`
#### Snippet
```java
    protected BKLogSegmentWriter segmentWriter = null;
    protected CompletableFuture<BKLogSegmentWriter> segmentWriterFuture = null;
    protected BKLogSegmentWriter allocatedSegmentWriter = null;
    protected BKLogWriteHandler writeHandler = null;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAbstractLogWriter.java`
#### Snippet
```java
    // Log Segment Writers
    protected BKLogSegmentWriter segmentWriter = null;
    protected CompletableFuture<BKLogSegmentWriter> segmentWriterFuture = null;
    protected BKLogSegmentWriter allocatedSegmentWriter = null;
    protected BKLogWriteHandler writeHandler = null;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAbstractLogWriter.java`
#### Snippet
```java
    // States
    private CompletableFuture<Void> closePromise = null;
    private volatile boolean forceRolling = false;
    private boolean forceRecovery = false;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAbstractLogWriter.java`
#### Snippet
```java

    // Log Segment Writers
    protected BKLogSegmentWriter segmentWriter = null;
    protected CompletableFuture<BKLogSegmentWriter> segmentWriterFuture = null;
    protected BKLogSegmentWriter allocatedSegmentWriter = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAbstractLogWriter.java`
#### Snippet
```java

    // Truncation Related
    private CompletableFuture<List<LogSegmentMetadata>> lastTruncationAttempt = null;
    @VisibleForTesting
    private Long minTimestampToKeepOverride = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAbstractLogWriter.java`
#### Snippet
```java

    // States
    private CompletableFuture<Void> closePromise = null;
    private volatile boolean forceRolling = false;
    private boolean forceRecovery = false;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAbstractLogWriter.java`
#### Snippet
```java
    private CompletableFuture<Void> closePromise = null;
    private volatile boolean forceRolling = false;
    private boolean forceRecovery = false;

    // Truncation Related
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAsyncLogReader.java`
#### Snippet
```java
    private final Stopwatch readNextDelayStopwatch;
    private DLSN startDLSN;
    private ReadAheadEntryReader readAheadReader = null;
    private int lastPosition = 0;
    private final boolean positionGapDetectionEnabled;
```

### RedundantFieldInitialization
Field initialization to `0L` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAsyncLogReader.java`
#### Snippet
```java
    private static final AtomicLongFieldUpdater<BKAsyncLogReader> scheduleCountUpdater =
        AtomicLongFieldUpdater.newUpdater(BKAsyncLogReader.class, "scheduleCount");
    private volatile long scheduleCount = 0L;
    private final Stopwatch scheduleDelayStopwatch;
    private final Stopwatch readNextDelayStopwatch;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAsyncLogReader.java`
#### Snippet
```java

    // Failure Injector
    private boolean disableProcessingReadRequests = false;

    // Stats
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAsyncLogReader.java`
#### Snippet
```java
    private DLSN startDLSN;
    private ReadAheadEntryReader readAheadReader = null;
    private int lastPosition = 0;
    private final boolean positionGapDetectionEnabled;
    private final int idleErrorThresholdMillis;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAsyncLogReader.java`
#### Snippet
```java

    // State
    private Entry.Reader currentEntry = null;
    private LogRecordWithDLSN nextRecord = null;

```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAsyncLogReader.java`
#### Snippet
```java
    protected CompletableFuture<Void> closeFuture = null;

    private boolean lockStream = false;

    private final boolean returnEndOfStreamRecord;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAsyncLogReader.java`
#### Snippet
```java
    private static final AtomicReferenceFieldUpdater<BKAsyncLogReader, Throwable> lastExceptionUpdater =
        AtomicReferenceFieldUpdater.newUpdater(BKAsyncLogReader.class, Throwable.class, "lastException");
    private volatile Throwable lastException = null;
    private final OrderedScheduler scheduler;
    private final ConcurrentLinkedQueue<PendingReadRequest> pendingRequests =
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAsyncLogReader.java`
#### Snippet
```java
    // State
    private Entry.Reader currentEntry = null;
    private LogRecordWithDLSN nextRecord = null;

    // Failure Injector
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAsyncLogReader.java`
#### Snippet
```java
    private final Stopwatch lastProcessTime;

    protected CompletableFuture<Void> closeFuture = null;

    private boolean lockStream = false;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAsyncLogReader.java`
#### Snippet
```java
    private final int idleErrorThresholdMillis;
    final ScheduledFuture<?> idleReaderTimeoutTask;
    private ScheduledFuture<?> backgroundScheduleTask = null;
    // last process time
    private final Stopwatch lastProcessTime;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAsyncLogWriter.java`
#### Snippet
```java
    private final boolean streamFailFast;
    private final boolean disableRollOnSegmentError;
    private LinkedList<PendingLogRecord> pendingRequests = null;
    private volatile boolean encounteredError = false;
    private final AtomicReference<Throwable> firstEncounteredError = new AtomicReference<>(null);
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAsyncLogWriter.java`
#### Snippet
```java
    private volatile boolean encounteredError = false;
    private final AtomicReference<Throwable> firstEncounteredError = new AtomicReference<>(null);
    private CompletableFuture<BKLogSegmentWriter> rollingFuture = null;
    private long lastTxId = DistributedLogConstants.INVALID_TXID;

```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAsyncLogWriter.java`
#### Snippet
```java
    private final boolean disableRollOnSegmentError;
    private LinkedList<PendingLogRecord> pendingRequests = null;
    private volatile boolean encounteredError = false;
    private final AtomicReference<Throwable> firstEncounteredError = new AtomicReference<>(null);
    private CompletableFuture<BKLogSegmentWriter> rollingFuture = null;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/AppendOnlyStreamWriter.java`
#### Snippet
```java
    final long[] syncPos = new long[1];
    BKAsyncLogWriter logWriter;
    long requestPos = 0;

    public AppendOnlyStreamWriter(BKAsyncLogWriter logWriter, long pos) {
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogReadHandler.java`
#### Snippet
```java

    // log segments listener
    protected boolean logSegmentsNotificationDisabled = false;
    protected final CopyOnWriteArraySet<LogSegmentListener> listeners =
            new CopyOnWriteArraySet<LogSegmentListener>();
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/ZooKeeperClient.java`
#### Snippet
```java
    private Stopwatch disconnectedStopwatch = null;

    private boolean closed = false;

    final Set<Watcher> watchers = new CopyOnWriteArraySet<Watcher>();
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/ZooKeeperClient.java`
#### Snippet
```java
    private final double requestRateLimit;
    private final Credentials credentials;
    private volatile boolean authenticated = false;
    private Stopwatch disconnectedStopwatch = null;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/ZooKeeperClient.java`
#### Snippet
```java
    // GuardedBy "this", but still volatile for tests, where we want to be able to see writes
    // made from within long synchronized blocks.
    private volatile ZooKeeper zooKeeper = null;
    private final RetryPolicy retryPolicy;
    private final StatsLogger statsLogger;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/ZooKeeperClient.java`
#### Snippet
```java
    private final Credentials credentials;
    private volatile boolean authenticated = false;
    private Stopwatch disconnectedStopwatch = null;

    private boolean closed = false;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/ReadAheadEntryReader.java`
#### Snippet
```java
    private boolean isInitialized = false;
    private boolean readAheadPaused = false;
    private CompletableFuture<Void> closePromise = null;
    // segment readers
    private long currentSegmentSequenceNumber;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/ReadAheadEntryReader.java`
#### Snippet
```java
        private final long startEntryId;
        private CompletableFuture<LogSegmentEntryReader> openFuture = null;
        private LogSegmentEntryReader reader = null;
        private boolean isStarted = false;
        private boolean isClosed = false;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/ReadAheadEntryReader.java`
#### Snippet
```java
        private LogSegmentMetadata metadata;
        private final long startEntryId;
        private CompletableFuture<LogSegmentEntryReader> openFuture = null;
        private LogSegmentEntryReader reader = null;
        private boolean isStarted = false;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/ReadAheadEntryReader.java`
#### Snippet
```java

    private final AtomicBoolean started = new AtomicBoolean(false);
    private boolean isInitialized = false;
    private boolean readAheadPaused = false;
    private CompletableFuture<Void> closePromise = null;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/ReadAheadEntryReader.java`
#### Snippet
```java
        private CompletableFuture<LogSegmentEntryReader> openFuture = null;
        private LogSegmentEntryReader reader = null;
        private boolean isStarted = false;
        private boolean isClosed = false;

```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/ReadAheadEntryReader.java`
#### Snippet
```java
    private final AtomicBoolean started = new AtomicBoolean(false);
    private boolean isInitialized = false;
    private boolean readAheadPaused = false;
    private CompletableFuture<Void> closePromise = null;
    // segment readers
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/ReadAheadEntryReader.java`
#### Snippet
```java
        private LogSegmentEntryReader reader = null;
        private boolean isStarted = false;
        private boolean isClosed = false;

        SegmentReader(LogSegmentMetadata metadata,
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/zk/LimitedPermitManager.java`
#### Snippet
```java
    private static final AtomicIntegerFieldUpdater<LimitedPermitManager> epochUpdater =
        AtomicIntegerFieldUpdater.newUpdater(LimitedPermitManager.class, "epoch");
    volatile int epoch = 0;
    private StatsLogger statsLogger = null;
    private Gauge<Number> outstandingGauge = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/zk/LimitedPermitManager.java`
#### Snippet
```java
    volatile int epoch = 0;
    private StatsLogger statsLogger = null;
    private Gauge<Number> outstandingGauge = null;

    public LimitedPermitManager(int concurrency, int period, TimeUnit timeUnit,
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/zk/LimitedPermitManager.java`
#### Snippet
```java
        AtomicIntegerFieldUpdater.newUpdater(LimitedPermitManager.class, "epoch");
    volatile int epoch = 0;
    private StatsLogger statsLogger = null;
    private Gauge<Number> outstandingGauge = null;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogWriteHandler.java`
#### Snippet
```java
    protected final int regionId;
    protected final RollingPolicy rollingPolicy;
    protected CompletableFuture<? extends DistributedLock> lockFuture = null;
    protected final PermitLimiter writeLimiter;
    protected final FeatureProvider featureProvider;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogHandler.java`
#### Snippet
```java
    protected static final AtomicReferenceFieldUpdater<BKLogHandler, IOException> METADATA_EXCEPTION_UPDATER =
        AtomicReferenceFieldUpdater.newUpdater(BKLogHandler.class, IOException.class, "metadataException");
    private volatile IOException metadataException = null;

    // Maintain the list of log segments per stream
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogHandler.java`
#### Snippet
```java
    protected final StatsLogger statsLogger;
    protected final AlertStatsLogger alertStatsLogger;
    protected volatile boolean reportGetSegmentStats = false;
    private final String lockClientId;
    protected static final AtomicReferenceFieldUpdater<BKLogHandler, IOException> METADATA_EXCEPTION_UPDATER =
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/api/namespace/NamespaceBuilder.java`
#### Snippet
```java
    }

    private DistributedLogConfiguration _conf = null;
    private DynamicDistributedLogConfiguration _dynConf = null;
    private URI _uri = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/api/namespace/NamespaceBuilder.java`
#### Snippet
```java

    private DistributedLogConfiguration _conf = null;
    private DynamicDistributedLogConfiguration _dynConf = null;
    private URI _uri = null;
    private StatsLogger _statsLogger = NullStatsLogger.INSTANCE;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/api/namespace/NamespaceBuilder.java`
#### Snippet
```java
    private StatsLogger _statsLogger = NullStatsLogger.INSTANCE;
    private StatsLogger _perLogStatsLogger = NullStatsLogger.INSTANCE;
    private FeatureProvider _featureProvider = null;
    private String _clientId = DistributedLogConstants.UNKNOWN_CLIENT_ID;
    private int _regionId = DistributedLogConstants.LOCAL_REGION_ID;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/api/namespace/NamespaceBuilder.java`
#### Snippet
```java
    private DistributedLogConfiguration _conf = null;
    private DynamicDistributedLogConfiguration _dynConf = null;
    private URI _uri = null;
    private StatsLogger _statsLogger = NullStatsLogger.INSTANCE;
    private StatsLogger _perLogStatsLogger = NullStatsLogger.INSTANCE;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogSegmentWriter.java`
#### Snippet
```java
    private static final AtomicIntegerFieldUpdater<BKLogSegmentWriter> outstandingTransmitsUpdater =
        AtomicIntegerFieldUpdater.newUpdater(BKLogSegmentWriter.class, "outstandingTransmits");
    private volatile int outstandingTransmits = 0;
    private final int transmissionThreshold;
    protected final LogSegmentEntryWriter entryWriter;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogSegmentWriter.java`
#### Snippet
```java
            ScheduledFuture.class,
            "immFlushSchedFutureRef");
    private volatile ScheduledFuture immFlushSchedFutureRef = null;
    private static final AtomicReferenceFieldUpdater<BKLogSegmentWriter, Exception> scheduledFlushExceptionUpdater =
        AtomicReferenceFieldUpdater.newUpdater(
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogSegmentWriter.java`
#### Snippet
```java
    private int minDelayBetweenImmediateFlushMs = 0;
    private Stopwatch lastTransmit;
    private boolean streamEnded = false;
    private final ScheduledFuture<?> periodicFlushSchedule;
    private final ScheduledFuture<?> periodicKeepAliveSchedule;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogSegmentWriter.java`
#### Snippet
```java
    private long lastTxIdAcknowledged = INVALID_TXID;
    private long outstandingBytes = 0;
    private long numFlushesSinceRestart = 0;
    private long numBytes = 0;
    private long lastEntryId = Long.MIN_VALUE;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogSegmentWriter.java`
#### Snippet
```java
    private long outstandingBytes = 0;
    private long numFlushesSinceRestart = 0;
    private long numBytes = 0;
    private long lastEntryId = Long.MIN_VALUE;
    private long lastTransmitNanos = Long.MIN_VALUE;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogSegmentWriter.java`
#### Snippet
```java
    private volatile boolean controlFlushNeeded = false;
    private boolean immediateFlushEnabled = false;
    private int minDelayBetweenImmediateFlushMs = 0;
    private Stopwatch lastTransmit;
    private boolean streamEnded = false;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogSegmentWriter.java`
#### Snippet
```java
    private volatile Exception scheduledFlushException = null;
    private boolean enforceLock = true;
    private CompletableFuture<Void> closeFuture = null;
    private final boolean enableRecordCounts;
    private int positionWithinLogSegment = 0;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogSegmentWriter.java`
#### Snippet
```java
    private long lastTxId = INVALID_TXID;
    private long lastTxIdAcknowledged = INVALID_TXID;
    private long outstandingBytes = 0;
    private long numFlushesSinceRestart = 0;
    private long numBytes = 0;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogSegmentWriter.java`
#### Snippet
```java
    private CompletableFuture<Void> closeFuture = null;
    private final boolean enableRecordCounts;
    private int positionWithinLogSegment = 0;
    private final long logSegmentSequenceNumber;
    // Used only for values that *could* change (e.g. buffer size etc.)
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogSegmentWriter.java`
#### Snippet
```java
            ScheduledFuture.class,
            "transmitSchedFutureRef");
    private volatile ScheduledFuture transmitSchedFutureRef = null;
    private static final AtomicReferenceFieldUpdater<BKLogSegmentWriter, ScheduledFuture>
        immFlushSchedFutureRefUpdater = AtomicReferenceFieldUpdater.newUpdater(
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogSegmentWriter.java`
#### Snippet
```java
    // add confirmed
    private volatile boolean controlFlushNeeded = false;
    private boolean immediateFlushEnabled = false;
    private int minDelayBetweenImmediateFlushMs = 0;
    private Stopwatch lastTransmit;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogSegmentWriter.java`
#### Snippet
```java
    // a control record to be transmitted to make them visible to the readers by updating the last
    // add confirmed
    private volatile boolean controlFlushNeeded = false;
    private boolean immediateFlushEnabled = false;
    private int minDelayBetweenImmediateFlushMs = 0;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogSegmentWriter.java`
#### Snippet
```java
            Exception.class,
            "scheduledFlushException");
    private volatile Exception scheduledFlushException = null;
    private boolean enforceLock = true;
    private CompletableFuture<Void> closeFuture = null;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/metadata/BKDLConfig.java`
#### Snippet
```java
    private String aclRootPath;
    private Long firstLogSegmentSeqNo;
    private boolean isFederatedNamespace = false;

    /**
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/metadata/BKDLConfig.java`
#### Snippet
```java
    private String bkLedgersPath;
    private boolean sanityCheckTxnID = true;
    private boolean encodeRegionID = false;
    private String dlZkServersForWriter;
    private String dlZkServersForReader;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/BKNamespaceDriver.java`
#### Snippet
```java
    // states
    //
    protected boolean initialized = false;
    protected AtomicBoolean closed = new AtomicBoolean(false);

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/logsegment/BKLogSegmentRandomAccessEntryReader.java`
#### Snippet
```java
    private final LogSegmentMetadata metadata;
    private final LedgerHandle lh;
    private CompletableFuture<Void> closePromise = null;

    BKLogSegmentRandomAccessEntryReader(LogSegmentMetadata metadata,
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/subscription/ZKSubscriptionStateStore.java`
#### Snippet
```java
    private static final AtomicReferenceFieldUpdater<ZKSubscriptionStateStore, DLSN> lastCommittedPositionUpdater =
        AtomicReferenceFieldUpdater.newUpdater(ZKSubscriptionStateStore.class, DLSN.class, "lastCommittedPosition");
    private volatile DLSN lastCommittedPosition = null;

    public ZKSubscriptionStateStore(ZooKeeperClient zooKeeperClient, String zkPath) {
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/acl/ZKAccessControlManager.java`
#### Snippet
```java
    protected final ConcurrentMap<String, ZKAccessControl> streamEntries;
    protected ZKAccessControl defaultAccessControl;
    protected volatile boolean closed = false;

    public ZKAccessControlManager(DistributedLogConfiguration conf,
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/ZKLogSegmentMetadataStore.java`
#### Snippet
```java
    final OrderedScheduler scheduler;
    final ReentrantReadWriteLock closeLock;
    boolean closed = false;

    public ZKLogSegmentMetadataStore(DistributedLogConfiguration conf,
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
    LedgerMetadata ledgerMetadata;

    CompletableFuture<Void> closeFuture = null;
    final LinkedList<CompletableFuture<Void>> ledgerDeletions =
            new LinkedList<CompletableFuture<Void>>();
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
    Long ledgerIdLeftFromPrevAllocation = null;
    // Allocated Ledger
    LedgerHandle allocatedLh = null;

    LedgerMetadata ledgerMetadata;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
    // outstanding tryObtain transaction
    Transaction<Object> tryObtainTxn = null;
    OpListener<LedgerHandle> tryObtainListener = null;
    // ledger id left from previous allocation
    Long ledgerIdLeftFromPrevAllocation = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
    OpListener<LedgerHandle> tryObtainListener = null;
    // ledger id left from previous allocation
    Long ledgerIdLeftFromPrevAllocation = null;
    // Allocated Ledger
    LedgerHandle allocatedLh = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
    CompletableFuture<LedgerHandle> allocatePromise;
    // outstanding tryObtain transaction
    Transaction<Object> tryObtainTxn = null;
    OpListener<LedgerHandle> tryObtainListener = null;
    // ledger id left from previous allocation
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/logsegment/BKLogSegmentEntryReader.java`
#### Snippet
```java
        AtomicLongFieldUpdater.newUpdater(BKLogSegmentEntryReader.class, "scheduleCount");
    private volatile long scheduleCount = 0L;
    private volatile boolean hasCaughtupOnInprogress = false;
    private final CopyOnWriteArraySet<StateChangeListener> stateChangeListeners =
            new CopyOnWriteArraySet<StateChangeListener>();
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/logsegment/BKLogSegmentEntryReader.java`
#### Snippet
```java
    private static final AtomicReferenceFieldUpdater<BKLogSegmentEntryReader, Throwable> lastExceptionUpdater =
        AtomicReferenceFieldUpdater.newUpdater(BKLogSegmentEntryReader.class, Throwable.class, "lastException");
    private volatile Throwable lastException = null;
    private static final AtomicLongFieldUpdater<BKLogSegmentEntryReader> scheduleCountUpdater =
        AtomicLongFieldUpdater.newUpdater(BKLogSegmentEntryReader.class, "scheduleCount");
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/logsegment/BKLogSegmentEntryReader.java`
#### Snippet
```java
    private static final AtomicIntegerFieldUpdater<BKLogSegmentEntryReader> numReadErrorsUpdater =
        AtomicIntegerFieldUpdater.newUpdater(BKLogSegmentEntryReader.class, "numReadErrors");
    private volatile int numReadErrors = 0;
    private final boolean skipBrokenEntries;
    // readahead cache
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/logsegment/BKLogSegmentEntryReader.java`
#### Snippet
```java
    private final boolean skipBrokenEntries;
    // readahead cache
    int cachedEntries = 0;
    int numOutstandingEntries = 0;
    final LinkedBlockingQueue<CacheEntry> readAheadEntries;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/logsegment/BKLogSegmentEntryReader.java`
#### Snippet
```java
    // readahead cache
    int cachedEntries = 0;
    int numOutstandingEntries = 0;
    final LinkedBlockingQueue<CacheEntry> readAheadEntries;
    // request queue
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/logsegment/BKLogSegmentEntryReader.java`
#### Snippet
```java
    private final int maxPrefetchEntries;
    // state
    private CompletableFuture<Void> closePromise = null;
    private LogSegmentMetadata metadata;
    private LedgerHandle lh;
```

### RedundantFieldInitialization
Field initialization to `0L` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/logsegment/BKLogSegmentEntryReader.java`
#### Snippet
```java
    private static final AtomicLongFieldUpdater<BKLogSegmentEntryReader> scheduleCountUpdater =
        AtomicLongFieldUpdater.newUpdater(BKLogSegmentEntryReader.class, "scheduleCount");
    private volatile long scheduleCount = 0L;
    private volatile boolean hasCaughtupOnInprogress = false;
    private final CopyOnWriteArraySet<StateChangeListener> stateChangeListeners =
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/util/SimplePermitLimiter.java`
#### Snippet
```java
    private static final AtomicIntegerFieldUpdater<SimplePermitLimiter> permitsUpdater =
        AtomicIntegerFieldUpdater.newUpdater(SimplePermitLimiter.class, "permits");
    volatile int permits = 0;
    final int permitsMax;
    final boolean darkmode;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/util/SimplePermitLimiter.java`
#### Snippet
```java
    final boolean darkmode;
    final Feature disableWriteLimitFeature;
    private StatsLogger statsLogger = null;
    private Gauge<Number> permitsGauge = null;
    private String permitsGaugeLabel = "";
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/util/SimplePermitLimiter.java`
#### Snippet
```java
    final Feature disableWriteLimitFeature;
    private StatsLogger statsLogger = null;
    private Gauge<Number> permitsGauge = null;
    private String permitsGaugeLabel = "";

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKDistributedLogManager.java`
#### Snippet
```java
    ///
    // read handler for listener.
    private BKLogReadHandler readHandlerForListener = null;
    private final PendingReaders pendingReaders;

```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/lock/ZKDistributedLock.java`
#### Snippet
```java
    private static final AtomicIntegerFieldUpdater<ZKDistributedLock> reacquireCountUpdater =
        AtomicIntegerFieldUpdater.newUpdater(ZKDistributedLock.class, "reacquireCount");
    private volatile int reacquireCount = 0;
    private final StatsLogger lockStatsLogger;
    private final OpStatsLogger acquireStats;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/lock/ZKDistributedLock.java`
#### Snippet
```java
    private LockingException lockReacquireException = null;
    // closeFuture
    private volatile boolean closed = false;
    private CompletableFuture<Void> closeFuture = null;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/lock/ZKDistributedLock.java`
#### Snippet
```java
    // 1. lock acquire future: for the initial acquire op
    // 2. lock reacquire future: for reacquire necessary when session expires, lock is closed
    private CompletableFuture<ZKDistributedLock> lockAcquireFuture = null;
    private CompletableFuture<ZKDistributedLock> lockReacquireFuture = null;
    // following variable tracking the status of acquire process
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/lock/ZKDistributedLock.java`
#### Snippet
```java
    // following variable tracking the status of acquire process
    //   => create (internalLock) => tryLock (tryLockFuture) => waitForAcquire (lockWaiter)
    private SessionLock internalLock = null;
    private CompletableFuture<LockWaiter> tryLockFuture = null;
    private LockWaiter lockWaiter = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/lock/ZKDistributedLock.java`
#### Snippet
```java
    //   => create (internalLock) => tryLock (tryLockFuture) => waitForAcquire (lockWaiter)
    private SessionLock internalLock = null;
    private CompletableFuture<LockWaiter> tryLockFuture = null;
    private LockWaiter lockWaiter = null;
    // exception indicating if the reacquire failed
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/lock/ZKDistributedLock.java`
#### Snippet
```java
    private SessionLock internalLock = null;
    private CompletableFuture<LockWaiter> tryLockFuture = null;
    private LockWaiter lockWaiter = null;
    // exception indicating if the reacquire failed
    private LockingException lockReacquireException = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/lock/ZKDistributedLock.java`
#### Snippet
```java
    // closeFuture
    private volatile boolean closed = false;
    private CompletableFuture<Void> closeFuture = null;

    // A counter to track how many re-acquires happened during a lock's life cycle.
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/lock/ZKDistributedLock.java`
#### Snippet
```java
    private LockWaiter lockWaiter = null;
    // exception indicating if the reacquire failed
    private LockingException lockReacquireException = null;
    // closeFuture
    private volatile boolean closed = false;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/lock/ZKDistributedLock.java`
#### Snippet
```java
    // 2. lock reacquire future: for reacquire necessary when session expires, lock is closed
    private CompletableFuture<ZKDistributedLock> lockAcquireFuture = null;
    private CompletableFuture<ZKDistributedLock> lockReacquireFuture = null;
    // following variable tracking the status of acquire process
    //   => create (internalLock) => tryLock (tryLockFuture) => waitForAcquire (lockWaiter)
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java

        boolean dryrun = false;
        boolean verbose = false;
        int concurrency = 1;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
    static class DeleteStreamACLCommand extends PerDLCommand {

        String stream = null;

        DeleteStreamACLCommand() {
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java

        boolean denyWrite = false;
        boolean denyTruncate = false;
        boolean denyDelete = false;
        boolean denyAcquire = false;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
    static class RepairSeqNoCommand extends PerDLCommand {

        boolean dryrun = false;
        boolean verbose = false;
        final List<String> streams = new ArrayList<String>();
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
        boolean denyWrite = false;
        boolean denyTruncate = false;
        boolean denyDelete = false;
        boolean denyAcquire = false;
        boolean denyRelease = false;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java

        boolean dryrun = false;
        boolean verbose = false;
        final List<String> streams = new ArrayList<String>();

```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
        boolean denyTruncate = false;
        boolean denyDelete = false;
        boolean denyAcquire = false;
        boolean denyRelease = false;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
    static class SetStreamACLCommand extends SetACLCommand {

        String stream = null;

        SetStreamACLCommand() {
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
    static class DLCKCommand extends PerDLCommand {

        boolean dryrun = false;
        boolean verbose = false;
        int concurrency = 1;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
        boolean denyDelete = false;
        boolean denyAcquire = false;
        boolean denyRelease = false;

        protected SetACLCommand(String name, String description) {
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
    abstract static  class SetACLCommand extends PerDLCommand {

        boolean denyWrite = false;
        boolean denyTruncate = false;
        boolean denyDelete = false;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/injector/AsyncRandomFailureInjector.java`
#### Snippet
```java
        private boolean _simulateStops = false;
        private boolean _simulateCorruption = false;
        private int _injectedDelayPercent = 0;
        private int _injectedErrorPercent = 0;
        private int _injectedStopPercent = 0;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/injector/AsyncRandomFailureInjector.java`
#### Snippet
```java

        private boolean _simulateDelays = false;
        private boolean _simulateErrors = false;
        private boolean _simulateStops = false;
        private boolean _simulateCorruption = false;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/injector/AsyncRandomFailureInjector.java`
#### Snippet
```java
        private boolean _simulateErrors = false;
        private boolean _simulateStops = false;
        private boolean _simulateCorruption = false;
        private int _injectedDelayPercent = 0;
        private int _injectedErrorPercent = 0;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/injector/AsyncRandomFailureInjector.java`
#### Snippet
```java
        private boolean _simulateDelays = false;
        private boolean _simulateErrors = false;
        private boolean _simulateStops = false;
        private boolean _simulateCorruption = false;
        private int _injectedDelayPercent = 0;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/injector/AsyncRandomFailureInjector.java`
#### Snippet
```java
    public static class Builder {

        private boolean _simulateDelays = false;
        private boolean _simulateErrors = false;
        private boolean _simulateStops = false;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/injector/AsyncRandomFailureInjector.java`
#### Snippet
```java
        private boolean _simulateCorruption = false;
        private int _injectedDelayPercent = 0;
        private int _injectedErrorPercent = 0;
        private int _injectedStopPercent = 0;
        private int _maxInjectedDelayMs = Integer.MAX_VALUE;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/injector/AsyncRandomFailureInjector.java`
#### Snippet
```java
        private int _injectedDelayPercent = 0;
        private int _injectedErrorPercent = 0;
        private int _injectedStopPercent = 0;
        private int _maxInjectedDelayMs = Integer.MAX_VALUE;

```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/metadata/DLMetadata.java`
#### Snippet
```java

    // metadata format version
    private int metadataFormatVersion = 0;
    // underlying dl type
    private String dlType;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/selector/FirstTxIdNotLessThanSelector.java`
#### Snippet
```java
    LogRecordWithDLSN result;
    final long txId;
    boolean found = false;

    public FirstTxIdNotLessThanSelector(long txId) {
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/namespace/NamespaceDriverManager.java`
#### Snippet
```java

    private static final ConcurrentMap<String, NamespaceDriverInfo> drivers;
    private static boolean initialized = false;

    static {
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/common/src/main/java/org/apache/bookkeeper/common/util/AbstractAutoAsyncCloseable.java`
#### Snippet
```java

    @GuardedBy("this")
    private CompletableFuture<Void> closeFuture = null;

    @Override
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/lock/ZKSessionLock.java`
#### Snippet
```java
    private static final AtomicIntegerFieldUpdater<ZKSessionLock> epochUpdater =
        AtomicIntegerFieldUpdater.newUpdater(ZKSessionLock.class, "epoch");
    private volatile int epoch = 0;
    private final OrderedScheduler lockStateExecutor;
    private LockListener lockListener = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/lock/ZKSessionLock.java`
#### Snippet
```java
    private volatile int epoch = 0;
    private final OrderedScheduler lockStateExecutor;
    private LockListener lockListener = null;
    private final long lockOpTimeout;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/io/dlfs/src/main/java/org/apache/distributedlog/fs/DLInputStream.java`
#### Snippet
```java
    private long pos;
    private long lastPos;
    private RecordStream currentRecord = null;

    DLInputStream(DistributedLogManager dlm,
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/io/dlfs/src/main/java/org/apache/distributedlog/fs/DLOutputStream.java`
#### Snippet
```java
    private static final AtomicReferenceFieldUpdater<DLOutputStream, Throwable> exceptionUpdater =
        AtomicReferenceFieldUpdater.newUpdater(DLOutputStream.class, Throwable.class, "exception");
    private volatile Throwable exception = null;

    DLOutputStream(DistributedLogManager dlm,
```

### RedundantFieldInitialization
Field initialization to `0L` is redundant
in `stream/distributedlog/io/dlfs/src/main/java/org/apache/distributedlog/fs/DLOutputStream.java`
#### Snippet
```java
    // positions
    private final long[] syncPos = new long[1];
    private long writePos = 0L;

    // state
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/api/StateStoreSpec.java`
#### Snippet
```java

    @Default
    private boolean localStorageCleanupEnable = false;

    @Default
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/api/StateStoreSpec.java`
#### Snippet
```java

    @Default
    private int ttlSeconds = 0;
}

```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-benchmark/src/main/java/org/apache/bookkeeper/benchmark/BenchThroughputLatency.java`
#### Snippet
```java
    }

    long previous = 0;
    byte[] bytes;

```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-benchmark/src/main/java/org/apache/bookkeeper/benchmark/BenchThroughputLatency.java`
#### Snippet
```java

    long threshold = 20000;
    long runningAverageCounter = 0;
    long totalTime = 0;
    @Override
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-benchmark/src/main/java/org/apache/bookkeeper/benchmark/BenchThroughputLatency.java`
#### Snippet
```java
    long threshold = 20000;
    long runningAverageCounter = 0;
    long totalTime = 0;
    @Override
    public void addComplete(int rc, LedgerHandle lh, long entryId, Object ctx) {
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-benchmark/src/main/java/org/apache/bookkeeper/benchmark/BenchThroughputLatency.java`
#### Snippet
```java
    }

    int lastLedger = 0;
    private int getRandomLedger() {
         return rand.nextInt(numberOfLedgers);
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
        int numThreads = 1;
        String streamPrefix = null;
        String subscriberId = null;

        DeleteSubscriberCommand() {
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java

        int numThreads = 1;
        String streamPrefix = null;
        String subscriberId = null;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
        boolean printHex = false;
        boolean skipPayload = false;
        Long fromTxnId = null;
        DLSN fromDLSN = null;
        int count = 100;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
        Long untilEntryId;
        boolean printHex = false;
        boolean skipPayload = false;
        boolean readAllBookies = false;
        boolean readLac = false;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java

        boolean printMetadata = false;
        boolean printHex = false;

        ListCommand() {
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
        String streamPrefix = null;
        boolean printInprogressOnly = false;
        boolean dumpEntries = false;
        boolean orderByTime = false;
        boolean printStreamsOnly = false;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
        protected URI uri;
        protected String zkAclId = null;
        protected boolean force = false;
        protected Namespace namespace = null;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
        final List<String> streams = new ArrayList<String>();

        String streamPrefix = null;
        String streamExpression = null;

```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
        SimpleBookKeeperClient bkc = null;
        boolean listSegments = true;
        boolean listEppStats = false;
        long firstLid = 0;
        long lastLid = -1;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
        protected final DistributedLogConfiguration dlConf;
        protected URI uri;
        protected String zkAclId = null;
        protected boolean force = false;
        protected Namespace namespace = null;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
        boolean dumpEntries = false;
        boolean orderByTime = false;
        boolean printStreamsOnly = false;
        boolean checkInprogressOnly = false;

```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
        boolean printHex = false;
        boolean skipPayload = false;
        boolean readAllBookies = false;
        boolean readLac = false;
        boolean corruptOnly = false;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
    public static class ListCommand extends PerDLCommand {

        boolean printMetadata = false;
        boolean printHex = false;

```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
        int numThreads = 1;
        String streamPrefix = null;
        boolean printInprogressOnly = false;
        boolean dumpEntries = false;
        boolean orderByTime = false;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
        protected final List<URI> uris = new ArrayList<URI>();
        protected String zkAclId = null;
        protected boolean force = false;

        protected AuditCommand(String name, String description) {
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
        boolean listSegments = true;
        boolean listEppStats = false;
        long firstLid = 0;
        long lastLid = -1;

```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
        boolean orderByTime = false;
        boolean printStreamsOnly = false;
        boolean checkInprogressOnly = false;

        InspectCommand() {
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java

        int numThreads = 1;
        String streamPrefix = null;
        boolean printInprogressOnly = false;
        boolean dumpEntries = false;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
    protected static class DumpCommand extends PerStreamCommand {

        boolean printHex = false;
        boolean skipPayload = false;
        Long fromTxnId = null;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
        boolean skipPayload = false;
        boolean readAllBookies = false;
        boolean readLac = false;
        boolean corruptOnly = false;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java

        DLSN startDLSN = null;
        DLSN endDLSN = null;

        protected CountCommand() {
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
        int numThreads = 1;
        String streamPrefix = null;
        boolean deleteStream = false;

        TruncateCommand() {
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
        boolean printInprogressOnly = false;
        boolean dumpEntries = false;
        boolean orderByTime = false;
        boolean printStreamsOnly = false;
        boolean checkInprogressOnly = false;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
        protected String zkAclId = null;
        protected boolean force = false;
        protected Namespace namespace = null;

        protected PerDLCommand(String name, String description) {
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java

        int numThreads = 1;
        String streamPrefix = null;
        boolean deleteStream = false;

```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java

        private DLSN dlsn = DLSN.InitialDLSN;
        private boolean hex = false;

        SerializeDLSNCommand() {
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
        protected final DistributedLogConfiguration dlConf;
        protected final List<URI> uris = new ArrayList<URI>();
        protected String zkAclId = null;
        protected boolean force = false;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
    public static class AuditDLSpaceCommand extends PerDLCommand {

        private String regex = null;

        AuditDLSpaceCommand() {
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
    protected static class ShowCommand extends PerStreamCommand {

        SimpleBookKeeperClient bkc = null;
        boolean listSegments = true;
        boolean listEppStats = false;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
        boolean readAllBookies = false;
        boolean readLac = false;
        boolean corruptOnly = false;

        int metadataVersion = LogSegmentMetadata.LEDGER_METADATA_CURRENT_LAYOUT_VERSION;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
        Long fromEntryId;
        Long untilEntryId;
        boolean printHex = false;
        boolean skipPayload = false;
        boolean readAllBookies = false;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
    static class CountCommand extends PerStreamCommand {

        DLSN startDLSN = null;
        DLSN endDLSN = null;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
        boolean skipPayload = false;
        Long fromTxnId = null;
        DLSN fromDLSN = null;
        int count = 100;

```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java

        boolean printHex = false;
        boolean skipPayload = false;
        Long fromTxnId = null;
        DLSN fromDLSN = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java

        String streamPrefix = null;
        String streamExpression = null;

        CreateCommand() {
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java

        private final WriteBatch batch = new WriteBatch();
        private volatile boolean executed = false;

        private void checkExecuted() {
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java

    // states of the store
    protected volatile boolean isInitialized = false;
    protected volatile boolean closed = false;
    protected volatile long lastRevision = -1L;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
    // states of the store
    protected volatile boolean isInitialized = false;
    protected volatile boolean closed = false;
    protected volatile long lastRevision = -1L;
    private final byte[] lastRevisionBytes = new byte[Long.BYTES];
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
        final Coder<V> valCoder;

        private volatile boolean closed = false;

        /**
```

### RedundantFieldInitialization
Field initialization to `0L` is redundant
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/dlog/DLOutputStream.java`
#### Snippet
```java
    // positions
    private final long[] syncPos = new long[1];
    private long writePos = 0L;

    // state
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/dlog/DLInputStream.java`
#### Snippet
```java
    private long pos;
    private long lastPos;
    private RecordStream currentRecord = null;

    DLInputStream(DistributedLogManager dlm,
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/dlog/DLOutputStream.java`
#### Snippet
```java
    private static final AtomicReferenceFieldUpdater<DLOutputStream, Throwable> exceptionUpdater =
        AtomicReferenceFieldUpdater.newUpdater(DLOutputStream.class, Throwable.class, "exception");
    private volatile Throwable exception = null;

    DLOutputStream(DistributedLogManager dlm,
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/journal/AbstractStateStoreWithJournal.java`
#### Snippet
```java

    protected boolean ownWriteScheduler = false;
    protected boolean ownReadScheduler = false;
    protected ScheduledExecutorService writeIOScheduler;
    protected ScheduledExecutorService readIOScheduler;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/journal/AbstractStateStoreWithJournal.java`
#### Snippet
```java
    protected StateStoreSpec spec;

    protected boolean ownWriteScheduler = false;
    protected boolean ownReadScheduler = false;
    protected ScheduledExecutorService writeIOScheduler;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/journal/AbstractStateStoreWithJournal.java`
#### Snippet
```java
    // close state
    protected boolean isInitialized = false;
    protected CompletableFuture<Void> closeFuture = null;

    protected AbstractStateStoreWithJournal(Supplier<LocalStateStoreT> localStateStoreSupplier,
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/journal/AbstractStateStoreWithJournal.java`
#### Snippet
```java

    // close state
    protected boolean isInitialized = false;
    protected CompletableFuture<Void> closeFuture = null;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/conf/ConfigKey.java`
#### Snippet
```java
     */
    @Default
    private Object defaultValue = null;

    private String defaultValueAsString() {
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/conf/ConfigKey.java`
#### Snippet
```java
     */
    @Default
    private boolean required = false;

    /**
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/conf/ConfigKey.java`
#### Snippet
```java
     */
    @Default
    private boolean deprecated = false;

    /**
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/OrderedExecutor.java`
#### Snippet
```java
        protected ThreadFactory threadFactory = null;
        protected StatsLogger statsLogger = NullStatsLogger.INSTANCE;
        protected boolean traceTaskExecution = false;
        protected boolean preserveMdcForTaskExecution = false;
        protected long warnTimeMicroSec = WARN_TIME_MICRO_SEC_DEFAULT;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/OrderedExecutor.java`
#### Snippet
```java
        protected long warnTimeMicroSec = WARN_TIME_MICRO_SEC_DEFAULT;
        protected int maxTasksInQueue = NO_TASK_LIMIT;
        protected boolean enableBusyWait = false;
        protected boolean enableThreadScopedMetrics = false;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/OrderedExecutor.java`
#### Snippet
```java
        protected String name = getClass().getSimpleName();
        protected int numThreads = Runtime.getRuntime().availableProcessors();
        protected ThreadFactory threadFactory = null;
        protected StatsLogger statsLogger = NullStatsLogger.INSTANCE;
        protected boolean traceTaskExecution = false;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/OrderedExecutor.java`
#### Snippet
```java
        protected int maxTasksInQueue = NO_TASK_LIMIT;
        protected boolean enableBusyWait = false;
        protected boolean enableThreadScopedMetrics = false;

        public AbstractBuilder<T> name(String name) {
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/OrderedExecutor.java`
#### Snippet
```java
        protected StatsLogger statsLogger = NullStatsLogger.INSTANCE;
        protected boolean traceTaskExecution = false;
        protected boolean preserveMdcForTaskExecution = false;
        protected long warnTimeMicroSec = WARN_TIME_MICRO_SEC_DEFAULT;
        protected int maxTasksInQueue = NO_TASK_LIMIT;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/collections/BlockingMpscQueue.java`
#### Snippet
```java
    private static final class DrainStrategy implements WaitStrategy, ExitCondition {

        boolean reachedEnd = false;

        @Override
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/collections/GrowableMpScArrayConsumerBlockingQueue.java`
#### Snippet
```java

    private static final class PaddedInt {
        int value = 0;

        // Padding to avoid false sharing
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/concurrent/FutureUtils.java`
#### Snippet
```java
        implements FutureEventListener<R>, Runnable {

        private volatile boolean done = false;
        private final Iterator<T> itemsIter;
        private final Function<T, CompletableFuture<R>> processFunc;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/mvcc/MVCCStoreImpl.java`
#### Snippet
```java
        private RangeResult<K, V> result;
        private PeekingIterator<KeyValue<K, V>> resultIter;
        private boolean eor = false;

        private volatile boolean closed = false;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/mvcc/MVCCStoreImpl.java`
#### Snippet
```java
        private boolean eor = false;

        private volatile boolean closed = false;

        RangeResultIterator(K from, K to) {
```

## RuleId[id=RedundantImplements]
### RedundantImplements
Redundant interface declaration `Runnable`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/GetBookieInfoProcessorV3.java`
#### Snippet
```java
 * A processor class for v3 bookie metadata packets.
 */
public class GetBookieInfoProcessorV3 extends PacketProcessorBaseV3 implements Runnable {
    private static final Logger LOG = LoggerFactory.getLogger(GetBookieInfoProcessorV3.class);

```

### RedundantImplements
Redundant interface declaration `Runnable`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/ReadLacProcessorV3.java`
#### Snippet
```java
 * A read processor for v3 last add confirmed messages.
 */
class ReadLacProcessorV3 extends PacketProcessorBaseV3 implements Runnable {
    private static final Logger logger = LoggerFactory.getLogger(ReadLacProcessorV3.class);

```

### RedundantImplements
Redundant interface declaration `Runnable`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/GetListOfEntriesOfLedgerProcessorV3.java`
#### Snippet
```java
 * A processor class for v3 entries of a ledger packets.
 */
public class GetListOfEntriesOfLedgerProcessorV3 extends PacketProcessorBaseV3 implements Runnable {

    private static final Logger LOG = LoggerFactory.getLogger(GetListOfEntriesOfLedgerProcessorV3.class);
```

### RedundantImplements
Redundant interface declaration `Runnable`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/WriteLacProcessorV3.java`
#### Snippet
```java


class WriteLacProcessorV3 extends PacketProcessorBaseV3 implements Runnable {
    private static final Logger logger = LoggerFactory.getLogger(WriteLacProcessorV3.class);

```

### RedundantImplements
Redundant interface declaration `Runnable`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/ForceLedgerProcessorV3.java`
#### Snippet
```java


class ForceLedgerProcessorV3 extends PacketProcessorBaseV3 implements Runnable {
    private static final Logger logger = LoggerFactory.getLogger(ForceLedgerProcessorV3.class);

```

### RedundantImplements
Redundant interface declaration `LedgerStorage`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/SortedLedgerStorage.java`
#### Snippet
```java
 */
public class SortedLedgerStorage
        implements LedgerStorage, CacheCallback, SkipListFlusher,
            CompactableLedgerStorage, DefaultEntryLogger.EntryLogListener {
    private static final Logger LOG = LoggerFactory.getLogger(SortedLedgerStorage.class);
```

### RedundantImplements
Redundant interface declaration `ITopologyAwareEnsemblePlacementPolicy`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ZoneawareEnsemblePlacementPolicy.java`
#### Snippet
```java
 */
public class ZoneawareEnsemblePlacementPolicy extends ZoneawareEnsemblePlacementPolicyImpl
        implements ITopologyAwareEnsemblePlacementPolicy<BookieNode> {
    ZoneawareEnsemblePlacementPolicyImpl slave = null;

```

### RedundantImplements
Redundant interface declaration `ITopologyAwareEnsemblePlacementPolicy`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RackawareEnsemblePlacementPolicy.java`
#### Snippet
```java
 */
public class RackawareEnsemblePlacementPolicy extends RackawareEnsemblePlacementPolicyImpl
        implements ITopologyAwareEnsemblePlacementPolicy<BookieNode> {
    RackawareEnsemblePlacementPolicyImpl slave = null;

```

### RedundantImplements
Redundant interface declaration `AutoCloseable`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/zookeeper/ZooKeeperClient.java`
#### Snippet
```java
 * Provide a zookeeper client to handle session expire.
 */
public class ZooKeeperClient extends ZooKeeper implements Watcher, AutoCloseable {

    private static final Logger logger = LoggerFactory.getLogger(ZooKeeperClient.class);
```

### RedundantImplements
Redundant interface declaration `IncrementalIntHash`
in `circe-checksum/src/main/java/com/scurrilous/circe/crc/Sse42Crc32C.java`
#### Snippet
```java
 * Implementation of CRC-32C using the SSE 4.2 CRC instruction.
 */
public final class Sse42Crc32C extends AbstractIncrementalIntHash implements IncrementalIntHash {

    private static final boolean SUPPORTED = checkSupported();
```

### RedundantImplements
Redundant interface declaration `ScheduledExecutorService`
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/SingleThreadSafeScheduledExecutorService.java`
#### Snippet
```java
@Slf4j
public class SingleThreadSafeScheduledExecutorService extends ScheduledThreadPoolExecutor
        implements ScheduledExecutorService {

    public SingleThreadSafeScheduledExecutorService(ThreadFactory threadFactory) {
```

### RedundantImplements
Redundant interface declaration `ExecutorService`
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/SingleThreadExecutor.java`
#### Snippet
```java
 */
@Slf4j
public class SingleThreadExecutor extends AbstractExecutorService implements ExecutorService, Runnable {
    private final BlockingQueue<Runnable> queue;
    private final Thread runner;
```

### RedundantImplements
Redundant interface declaration `BlockingQueue`
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/collections/BlockingMpscQueue.java`
#### Snippet
```java
 * Blocking queue optimized for multiple producers and single consumer.
 */
public class BlockingMpscQueue<T> extends MpscArrayQueue<T> implements BlockingQueue<T>, BatchedBlockingQueue<T> {

    public BlockingMpscQueue(int size) {
```

### RedundantImplements
Redundant interface declaration `BlockingQueue`
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/collections/BatchedArrayBlockingQueue.java`
#### Snippet
```java
public class BatchedArrayBlockingQueue<T>
        extends AbstractQueue<T>
        implements BlockingQueue<T>, BatchedBlockingQueue<T> {

    private final ReentrantLock lock = new ReentrantLock();
```

## RuleId[id=InstanceofCatchParameter]
### InstanceofCatchParameter
'instanceof' on 'catch' parameter `e`
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/cluster/ZkClusterMetadataStore.java`
#### Snippet
```java
            return true;
        } catch (Exception e) {
            if (e instanceof KeeperException.NodeExistsException) {
                // the cluster already exists.
                log.info("Stream storage cluster is already initialized.");
```

### InstanceofCatchParameter
'instanceof' on 'catch' parameter `e`
in `stream/distributedlog/common/src/main/java/org/apache/distributedlog/io/Abortables.java`
#### Snippet
```java
                log.warn("IOException thrown while aborting Abortable {} : ", abortable, e);
            } else {
                if (e instanceof IOException) {
                    throw (IOException) e;
                } else {
```

### InstanceofCatchParameter
'instanceof' on 'catch' parameter `e`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/cookie/CookieCommand.java`
#### Snippet
```java
        } catch (MetadataException | ExecutionException | UncheckedExecutionException e) {
            Throwable cause = e;
            if (!(e instanceof MetadataException) && null != e.getCause()) {
                cause = e.getCause();
            }
```

### InstanceofCatchParameter
'instanceof' on 'catch' parameter `e`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookies/RecoverCommand.java`
#### Snippet
```java
        } catch (Exception e) {
            Throwable cause = e;
            if (e instanceof UncheckedExecutionException) {
                cause = e.getCause();
            }
```

### InstanceofCatchParameter
'instanceof' on 'catch' parameter `e`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/ScanAndCompareGarbageCollector.java`
#### Snippet
```java
                                        TimeUnit.MILLISECONDS);
                            } catch (BKException | TimeoutException e) {
                                if (e instanceof BKException) {
                                    rc = ((BKException) e).getCode();
                                } else {
```

### InstanceofCatchParameter
'instanceof' on 'catch' parameter `ex`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/DefaultBookieAddressResolver.java`
#### Snippet
```java
            throw new BookieIdNotResolvedException(bookieId, ex);
        } catch (Exception ex) {
            if (ex instanceof InterruptedException) {
                Thread.currentThread().interrupt();
            }
```

### InstanceofCatchParameter
'instanceof' on 'catch' parameter `e`
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdLedgerManagerFactory.java`
#### Snippet
```java
            return EtcdRegistrationManager.nukeExistingCluster(client.getKVClient(), scope);
        } catch (Exception e) {
            if (e instanceof IOException) {
                throw (IOException) e;
            } else {
```

### InstanceofCatchParameter
'instanceof' on 'catch' parameter `e`
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdLedgerManagerFactory.java`
#### Snippet
```java
            EtcdRegistrationManager.format(client.getKVClient(), scope);
        } catch (Exception e) {
            if (e instanceof IOException) {
                throw (IOException) e;
            } else {
```

### InstanceofCatchParameter
'instanceof' on 'catch' parameter `e`
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdLedgerManager.java`
#### Snippet
```java
                    return ki.hasNext();
                } catch (Exception e) {
                    if (e instanceof IOException) {
                        throw ((IOException) e);
                    } else {
```

### InstanceofCatchParameter
'instanceof' on 'catch' parameter `e`
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdLedgerManager.java`
#### Snippet
```java
                    return new LedgerRange(ledgers);
                } catch (Exception e) {
                    if (e instanceof IOException) {
                        throw ((IOException) e);
                    } else {
```

### InstanceofCatchParameter
'instanceof' on 'catch' parameter `e`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeperAdmin.java`
#### Snippet
```java
                    return true;
                } catch (Exception e) {
                    if (e instanceof BKException.BKNoSuchEntryException && lastEntryId == -1) {
                        // there are no more entries in the ledger, so we just return false and ignore this exception
                        // since the last entry id was undefined
```

### InstanceofCatchParameter
'instanceof' on 'catch' parameter `exc`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAsyncLogReader.java`
#### Snippet
```java
                } catch (IOException exc) {
                    setLastException(exc);
                    if (!(exc instanceof LogNotFoundException)) {
                        LOG.warn("{} : read with skip Exception",
                                readHandler.getFullyQualifiedName(), lastExceptionUpdater.get(this));
```

### InstanceofCatchParameter
'instanceof' on 'catch' parameter `e`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogSegmentWriter.java`
#### Snippet
```java
                FailpointUtils.checkFailPoint(FailpointUtils.FailPointName.FP_TransmitFailGetBuffer);
            } catch (IOException e) {
                if (e instanceof InvalidEnvelopedEntryException) {
                    alertStatsLogger.raise("Invalid enveloped entry for segment {} : ", fullyQualifiedLogSegment, e);
                }
```

### InstanceofCatchParameter
'instanceof' on 'catch' parameter `e`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogSegmentWriter.java`
#### Snippet
```java
                // no future writes go through and violate ordering guarantees.
                transmitResultUpdater.set(this, BKException.Code.WriteException);
                if (e instanceof InvalidEnvelopedEntryException) {
                    alertStatsLogger.raise("Invalid enveloped entry for segment {} : ", fullyQualifiedLogSegment, e);
                    throw (InvalidEnvelopedEntryException) e;
```

### InstanceofCatchParameter
'instanceof' on 'catch' parameter `t`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/acl/ZKAccessControlManager.java`
#### Snippet
```java
            FutureUtils.result(fetchDefaultAccessControlEntry());
        } catch (Throwable t) {
            if (t instanceof InterruptedException) {
                throw new DLInterruptedException("Interrupted on getting default access control entry for "
                        + zkRootPath, t);
```

### InstanceofCatchParameter
'instanceof' on 'catch' parameter `t`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/acl/ZKAccessControlManager.java`
#### Snippet
```java
                throw new DLInterruptedException("Interrupted on getting default access control entry for "
                        + zkRootPath, t);
            } else if (t instanceof KeeperException) {
                throw new IOException("Encountered zookeeper exception on getting default access control entry for "
                        + zkRootPath, t);
```

### InstanceofCatchParameter
'instanceof' on 'catch' parameter `t`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/acl/ZKAccessControlManager.java`
#### Snippet
```java
                throw new IOException("Encountered zookeeper exception on getting default access control entry for "
                        + zkRootPath, t);
            } else if (t instanceof IOException) {
                throw (IOException) t;
            } else {
```

### InstanceofCatchParameter
'instanceof' on 'catch' parameter `t`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/acl/ZKAccessControlManager.java`
#### Snippet
```java
            FutureUtils.result(fetchAccessControlEntries());
        } catch (Throwable t) {
            if (t instanceof InterruptedException) {
                throw new DLInterruptedException("Interrupted on getting access control entries for " + zkRootPath, t);
            } else if (t instanceof KeeperException) {
```

### InstanceofCatchParameter
'instanceof' on 'catch' parameter `t`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/acl/ZKAccessControlManager.java`
#### Snippet
```java
            if (t instanceof InterruptedException) {
                throw new DLInterruptedException("Interrupted on getting access control entries for " + zkRootPath, t);
            } else if (t instanceof KeeperException) {
                throw new IOException("Encountered zookeeper exception on getting access control entries for "
                        + zkRootPath, t);
```

### InstanceofCatchParameter
'instanceof' on 'catch' parameter `t`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/acl/ZKAccessControlManager.java`
#### Snippet
```java
                throw new IOException("Encountered zookeeper exception on getting access control entries for "
                        + zkRootPath, t);
            } else if (t instanceof IOException) {
                throw (IOException) t;
            } else {
```

### InstanceofCatchParameter
'instanceof' on 'catch' parameter `e`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/federated/FederatedZKLogMetadataStore.java`
#### Snippet
```java
            uris = FutureUtils.result(fetchSubNamespaces(this));
        } catch (Exception e) {
            if (e instanceof IOException) {
                throw (IOException) e;
            } else {
```

### InstanceofCatchParameter
'instanceof' on 'catch' parameter `t`
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/SingleThreadExecutor.java`
#### Snippet
```java
            tasksCompleted.increment();
        } catch (Throwable t) {
            if (t instanceof InterruptedException) {
                Thread.currentThread().interrupt();
                return false;
```

## RuleId[id=ArrayEquality]
### ArrayEquality
Array objects are compared using `!=`, not 'Arrays.equals()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/DefaultPerChannelBookieClientPool.java`
#### Snippet
```java
        for (int i = 0; i < clients.length; i++) {
            clients[i].close(wait);
            if (clients != clientsV3Enforced) {
                clientsV3Enforced[i].close(wait);
            }
```

### ArrayEquality
Array objects are compared using `!=`, not 'Arrays.equals()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/DefaultPerChannelBookieClientPool.java`
#### Snippet
```java
        for (int i = 0; i < clients.length; i++) {
            clients[i].checkTimeoutOnPendingOperations();
            if (clients != clientsV3Enforced) {
                clientsV3Enforced[i].checkTimeoutOnPendingOperations();
            }
```

### ArrayEquality
Array objects are compared using `!=`, not 'Arrays.equals()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/DefaultPerChannelBookieClientPool.java`
#### Snippet
```java
        for (int i = 0; i < clients.length; i++) {
            clients[i].disconnect();
            if (clients != clientsV3Enforced) {
                clientsV3Enforced[i].disconnect();
            }
```

### ArrayEquality
Array objects are compared using `!=`, not 'Arrays.equals()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/DefaultPerChannelBookieClientPool.java`
#### Snippet
```java
            numPending += pcbc.getNumPendingCompletionRequests();
        }
        if (clients != clientsV3Enforced) {
            for (PerChannelBookieClient pcbc : clientsV3Enforced) {
                numPending += pcbc.getNumPendingCompletionRequests();
```

### ArrayEquality
Array objects are compared using `!=`, not 'Arrays.equals()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/cookie/AdminCommand.java`
#### Snippet
```java
                    hasCookieUpdatedInDirs &= verifyCookie(newCookie, dir);
                }
                if (indexDirectories != ledgerDirectories) {
                    for (File dir : indexDirectories) {
                        hasCookieUpdatedInDirs &= verifyCookie(newCookie, dir);
```

### ArrayEquality
Array objects are compared using `!=`, not 'Arrays.equals()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/cookie/AdminCommand.java`
#### Snippet
```java
                    }
                    LOG.info("Updated cookie file present in ledgerDirectories {}", (Object) ledgerDirectories);
                    if (ledgerDirectories != indexDirectories) {
                        for (File dir : indexDirectories) {
                            newCookie.writeToDirectory(dir);
```

### ArrayEquality
Array objects are compared using `!=`, not 'Arrays.equals()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/cookie/AdminCommand.java`
#### Snippet
```java
            List<File> allLedgerDirs = Lists.newArrayList();
            allLedgerDirs.addAll(Arrays.asList(ledgerDirectories));
            if (indexDirectories != ledgerDirectories) {
                allLedgerDirs.addAll(Arrays.asList(indexDirectories));
            }
```

### ArrayEquality
Array objects are compared using `!=`, not 'Arrays.equals()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/http/service/ExpandStorageService.java`
#### Snippet
```java
            List<File> allLedgerDirs = Lists.newArrayList();
            allLedgerDirs.addAll(Arrays.asList(ledgerDirectories));
            if (indexDirectories != ledgerDirectories) {
                allLedgerDirs.addAll(Arrays.asList(indexDirectories));
            }
```

## RuleId[id=RedundantStringFormatCall]
### RedundantStringFormatCall
Redundant call to `format()`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LocalDLMEmulator.java`
#### Snippet
```java
            localDlm.start();

            System.out.println(String.format(
                "DistributedLog Sandbox is running now. You could access distributedlog://%s:%s",
                zkHost,
```

### RedundantStringFormatCall
Redundant call to `format()`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                }
                try {
                    System.out.println(String.format("Dump records for %s (from = %s, dump"
                            + " count = %d, total records = %d)", getStreamName(), startOffset, count, totalCount));

```

### RedundantStringFormatCall
Redundant call to `format()`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
            }
            for (Map.Entry<BookieId, Integer> entry : entries) {
                System.out.println(String.format("%" + width + "s\t%6.2f%%\t\t%d",
                        entry.getKey(), entry.getValue() * 1.0 / totalEntries, entry.getValue()));
            }
```

## RuleId[id=NonFinalFieldOfException]
### NonFinalFieldOfException
Non-final field `exitCode` of exception class
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/Shell.java`
#### Snippet
```java
        private static final long serialVersionUID = 2241095121609500810L;

        int exitCode;

        public ExitCodeException(int exitCode, String message) {
```

## RuleId[id=ZeroLengthArrayInitialization]
### ZeroLengthArrayInitialization
Allocation of zero length array
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/ZkLedgerAuditorManager.java`
#### Snippet
```java
            if (zkc.exists(basePath, false) == null) {
                try {
                    zkc.create(basePath, new byte[0], zkAcls,
                            CreateMode.PERSISTENT);
                } catch (KeeperException.NodeExistsException nee) {
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/ZkLedgerAuditorManager.java`
#### Snippet
```java
            if (zkc.exists(getVotePath(""), false) == null) {
                try {
                    zkc.create(getVotePath(""), new byte[0],
                            zkAcls, CreateMode.PERSISTENT);
                } catch (KeeperException.NodeExistsException nee) {
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/ZkLedgerIdGenerator.java`
#### Snippet
```java
    public static void generateLedgerIdImpl(final GenericCallback<Long> cb, ZooKeeper zk, String ledgerPrefix,
            List<ACL> zkAcls) {
        ZkUtils.asyncCreateFullPathOptimistic(zk, ledgerPrefix, new byte[0], zkAcls,
                CreateMode.EPHEMERAL_SEQUENTIAL,
                new StringCallback() {
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/LongZkLedgerIdGenerator.java`
#### Snippet
```java

    private void createLongLedgerIdPathAndGenerateLongLedgerId(final GenericCallback<Long> cb, String createPath) {
        ZkUtils.asyncCreateFullPathOptimistic(zk, ledgerIdGenPath, new byte[0], Ids.OPEN_ACL_UNSAFE,
                CreateMode.PERSISTENT, new StringCallback() {
                    @Override
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/LongZkLedgerIdGenerator.java`
#### Snippet
```java
                LOG.debug("Creating HOB path: {}", ledgerPrefix + formatHalfId(hob));
            }
            zk.create(ledgerPrefix + formatHalfId(hob), new byte[0], Ids.OPEN_ACL_UNSAFE, CreateMode.PERSISTENT);
        } catch (KeeperException.NodeExistsException e) {
            // It's fine if we lost a race to create the node (NodeExistsException).
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/sasl/SASLClientAuthProvider.java`
#### Snippet
```java
        try {
            if (client.hasInitialResponse()) {
                byte[] response = client.evaluateChallenge(new byte[0]);
                cb.operationComplete(BKException.Code.OK, AuthToken.wrap(response));
            } else {
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/sasl/SASLClientAuthProvider.java`
#### Snippet
```java
                cb.operationComplete(BKException.Code.OK, AuthToken.wrap(response));
            } else {
                cb.operationComplete(BKException.Code.OK, AuthToken.wrap(new byte[0]));
            }
        } catch (SaslException err) {
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/sasl/SASLClientAuthProvider.java`
#### Snippet
```java
            byte[] response = client.evaluateChallenge(responseToken);
            if (response == null) {
                response = new byte[0];
            }
            cb.operationComplete(BKException.Code.OK, AuthToken.wrap(response));
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/AvailabilityOfEntriesOfLedger.java`
#### Snippet
```java
    public static final AvailabilityOfEntriesOfLedger EMPTY_AVAILABILITYOFENTRIESOFLEDGER;
    static {
        long[] tmpArray = {};
        EMPTY_AVAILABILITYOFENTRIESOFLEDGER = new AvailabilityOfEntriesOfLedger(Arrays.stream(tmpArray).iterator());
    }
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/ZkLedgerUnderreplicationManager.java`
#### Snippet
```java
        if (zkc.exists(basePath, false) == null) {
            try {
                zkc.create(basePath, new byte[0], zkAcls, CreateMode.PERSISTENT);
            } catch (KeeperException.NodeExistsException nee) {
                // do nothing, someone each could have created it
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/ZkLedgerUnderreplicationManager.java`
#### Snippet
```java
        if (zkc.exists(urLedgerPath, false) == null) {
            try {
                zkc.create(urLedgerPath, new byte[0], zkAcls, CreateMode.PERSISTENT);
            } catch (KeeperException.NodeExistsException nee) {
                // do nothing, someone each could have created it
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/ZkLedgerUnderreplicationManager.java`
#### Snippet
```java
        if (zkc.exists(urLockPath, false) == null) {
            try {
                zkc.create(urLockPath, new byte[0], zkAcls, CreateMode.PERSISTENT);
            } catch (KeeperException.NodeExistsException nee) {
                // do nothing, someone each could have created it
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/ZkUtils.java`
#### Snippet
```java
                // parents
                String parent = new File(originalPath).getParent().replace("\\", "/");
                asyncCreateFullPathOptimistic(zk, parent, new byte[0], acl,
                        CreateMode.PERSISTENT, new StringCallback() {

```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/LocalBookKeeper.java`
#### Snippet
```java
                    .build()) {
            String zkLedgersRootPath = ZKMetadataDriverBase.resolveZkLedgersRootPath(baseConf);
            ZkUtils.createFullPathOptimistic(zkc, zkLedgersRootPath, new byte[0], Ids.OPEN_ACL_UNSAFE,
                    CreateMode.PERSISTENT);
            List<Op> multiOps = Lists.newArrayListWithExpectedSize(2);
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/LocalBookKeeper.java`
#### Snippet
```java
            multiOps.add(
                Op.create(zkLedgersRootPath + "/" + AVAILABLE_NODE,
                    new byte[0], Ids.OPEN_ACL_UNSAFE, CreateMode.PERSISTENT));
            multiOps.add(
                Op.create(zkLedgersRootPath + "/" + AVAILABLE_NODE + "/" + READONLY,
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/LocalBookKeeper.java`
#### Snippet
```java
            multiOps.add(
                Op.create(zkLedgersRootPath + "/" + AVAILABLE_NODE + "/" + READONLY,
                    new byte[0], Ids.OPEN_ACL_UNSAFE, CreateMode.PERSISTENT));
            zkc.multi(multiOps);
            // No need to create an entry for each requested bookie anymore as the
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieClientImpl.java`
#### Snippet
```java
        for (int i = 0; i < 100000; i++) {
            counter.inc();
            bc.addEntry(addr, ledger, new byte[0], i,
                    ByteBufList.get(Unpooled.wrappedBuffer(hello)), cb, counter, 0, false,
                    WriteFlag.NONE);
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookie/SanityTestCommand.java`
#### Snippet
```java
        LedgerHandle lh = null;
        try {
            lh = bk.createLedger(1, 1, BookKeeper.DigestType.MAC, new byte[0]);
            LOG.info("Create ledger {}", lh.getId());

```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookie/SanityTestCommand.java`
#### Snippet
```java

            // Reopen the ledger and read entries
            lh = bk.openLedger(lh.getId(), BookKeeper.DigestType.MAC, new byte[0]);
            if (lh.getLastAddConfirmed() != (cmdFlags.entries - 1)) {
                throw new Exception("Invalid last entry found on ledger. expecting: " + (cmdFlags.entries - 1)
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/client/SimpleTestCommand.java`
#### Snippet
```java
                    .withDigestType(DigestType.CRC32C)
                    .withCustomMetadata(ImmutableMap.of("Bookie", NAME.getBytes(StandardCharsets.UTF_8)))
                    .withPassword(new byte[0])
                    .execute());
            LOG.info("Ledger ID: {}", wh.getId());
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/client/SimpleTestCommand.java`
#### Snippet
```java

            try (ReadHandle rh = result(bk.newOpenLedgerOp().withLedgerId(wh.getId()).withDigestType(DigestType.CRC32C)
                    .withPassword(new byte[0]).execute())) {
                LedgerEntries ledgerEntries = rh.read(0, flags.numEntries);
                for (LedgerEntry ledgerEntry : ledgerEntries) {
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LegacyCookieValidation.java`
#### Snippet
```java
                        dirs.addAll(Arrays.asList(c.getIndexDirPathsFromCookie()));
                    }
                    return Arrays.stream(dirs.toArray(new String[]{}));
                }).map((s) -> new File(s)).collect(Collectors.toSet());
    }
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RoundRobinDistributionSchedule.java`
#### Snippet
```java
        private final BitSet ackSet = new BitSet();
        // grows on reset()
        private BookieId[] failureMap = new BookieId[0];

        private final Handle<AckSetImpl> recyclerHandle;
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerMetadataImpl.java`
#### Snippet
```java
    public byte[] getPassword() {
        if (!hasPassword()) {
            return new byte[0];
        } else {
            return Arrays.copyOf(password, password.length);
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/datainteg/DataIntegrityCheckImpl.java`
#### Snippet
```java
                    try {
                        if (!ledgerStorage.ledgerExists(ledgerId)) {
                            ledgerStorage.setMasterKey(ledgerId, new byte[0]);
                        }
                    } catch (IOException ioe) {
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/datainteg/DataIntegrityCheckImpl.java`
#### Snippet
```java
        try {
            if (!this.ledgerStorage.ledgerExists(ledgerId)) {
                this.ledgerStorage.setMasterKey(ledgerId, new byte[0]);
            }
            if (this.ledgerStorage.hasLimboState(ledgerId)) {
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/DirectBookkeeperDriver.java`
#### Snippet
```java
    public void readEntries(
            long ledgerID, long firstEntryID, long lastEntryID, BiConsumer<Integer, ArrayList<byte[]>> cb) {
        client.asyncOpenLedgerNoRecovery(ledgerID, BookKeeper.DigestType.CRC32, new byte[0], (rc, lh, ctx) -> {
            if (rc != 0) {
                cb.accept(rc, null);
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/DirectBookkeeperDriver.java`
#### Snippet
```java
                ackQSize,
                BookKeeper.DigestType.CRC32,
                new byte[0],
                (rc, lh, ctx) -> {
                    openHandles.put(ledgerID, lh);
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/discover/ZKRegistrationManager.java`
#### Snippet
```java
                if (zk.exists(cookiePath, false) == null) {
                    try {
                        zk.create(cookiePath, new byte[0], zkAcls, CreateMode.PERSISTENT);
                    } catch (NodeExistsException nne) {
                        log.info("More than one bookie tried to create {} at once. Safe to ignore.",
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/discover/ZKRegistrationManager.java`
#### Snippet
```java
        // create readonly bookies node if not exists
        if (null == zk.exists(bookieReadonlyRegistrationPath, false)) {
            zk.create(bookieReadonlyRegistrationPath, new byte[0], zkAcls, CreateMode.PERSISTENT);
        }

```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdRegistrationManager.java`
#### Snippet
```java
            .Else(io.etcd.jetcd.op.Op.put(
                regPathBs,
                ByteSequence.from(new byte[0]),
                PutOption.newBuilder()
                    .withLeaseId(bkRegister.get())
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `stream/clients/java/kv/src/main/java/org/apache/bookkeeper/clients/impl/kv/KvUtils.java`
#### Snippet
```java
                ByteBuf value = cmp.value();
                if (null == value) {
                    value = Unpooled.wrappedBuffer(new byte[0]);
                }
                builder.setValue(toProtoKey(value));
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/LedgerAllocatorPool.java`
#### Snippet
```java
            } catch (KeeperException.NoNodeException e) {
                logger.info("Allocator Pool {} doesn't exist. Creating it.", poolPath);
                ZkUtils.createFullPathOptimistic(zkc.get(), poolPath, new byte[0], zkc.getDefaultACL(),
                        CreateMode.PERSISTENT);
                allocators = zkc.get().getChildren(poolPath, false);
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/LedgerAllocatorPool.java`
#### Snippet
```java
        };
        for (int i = 0; i < numAllocators; i++) {
            zkc.get().create(poolPath + "/A", new byte[0],
                             zkc.getDefaultACL(),
                             CreateMode.PERSISTENT_SEQUENTIAL,
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/net/NetUtils.java`
#### Snippet
```java
            try {
                constructor = resolverCls.getDeclaredConstructor();
                parameters = new Object[0];
            } catch (NoSuchMethodException nsme1) {
                throw new RuntimeException("Unable to find constructor for dns resolver "
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/BKNamespaceDriver.java`
#### Snippet
```java
                currentStat = zk.exists(zkPath, false);
                if (currentStat == null) {
                    result.put(child, new byte[0]);
                } else {
                    result.put(child, zk.getData(zkPath, false, currentStat));
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/acl/ZKAccessControlManager.java`
#### Snippet
```java
            return;
        }
        ZkUtils.asyncCreateFullPathOptimistic(zk, zkRootPath, new byte[0], zkc.getDefaultACL(),
                CreateMode.PERSISTENT, new AsyncCallback.StringCallback() {
            @Override
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/federated/FederatedZKLogMetadataStore.java`
#### Snippet
```java
        txn.setData(zkSubnamespacesPath, uri.getPath().getBytes(UTF_8), zkVersion);
        String logPath = uri.getPath() + "/" + logName;
        txn.create(logPath, new byte[0], zkc.getDefaultACL(), CreateMode.PERSISTENT);
        try {
            txn.commit();
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/federated/FederatedZKLogMetadataStore.java`
#### Snippet
```java
            throws IOException, KeeperException {
        String zkSubNamespacesPath = namespace.getPath() + "/" + ZNODE_SUB_NAMESPACES;
        Utils.zkCreateFullPathOptimistic(zkc, zkSubNamespacesPath, new byte[0],
                zkc.getDefaultACL(), CreateMode.PERSISTENT);
    }
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/federated/FederatedZKLogMetadataStore.java`
#### Snippet
```java
        final String nsPath = namespace.getPath() + "/" + ZNODE_SUB_NAMESPACES + "/" + SUB_NAMESPACE_PREFIX;
        try {
            zkc.get().create(nsPath, new byte[0], zkc.getDefaultACL(), CreateMode.PERSISTENT_SEQUENTIAL,
                    new AsyncCallback.StringCallback() {
                        @Override
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/metadata/DLMetadata.java`
#### Snippet
```java
                .uri(uri)
                .build();
        byte[] data = new byte[0];
        try {
            zkc.get().setData(uri.getPath(), data, -1);
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/metadata/ZKLogStreamMetadataStore.java`
#### Snippet
```java
        Optional<String> parentPathShouldNotCreate = Optional.of(logMetadata.getLogRootPath());
        Utils.zkAsyncCreateFullPathOptimisticRecursive(zooKeeperClient, readLockPath, parentPathShouldNotCreate,
                new byte[0], zooKeeperClient.getDefaultACL(), CreateMode.PERSISTENT,
                new org.apache.zookeeper.AsyncCallback.StringCallback() {
                    @Override
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/util/Utils.java`
#### Snippet
```java
                        return;
                    }
                    zkAsyncCreateFullPathOptimisticRecursive(zkc, parent, parentPathShouldNotCreate, new byte[0], acl,
                            CreateMode.PERSISTENT, new AsyncCallback.StringCallback() {
                                @Override
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/net/ServiceURI.java`
#### Snippet
```java

        String serviceName;
        String[] serviceInfos = new String[0];
        String scheme = uri.getScheme();
        if (null != scheme) {
```

## RuleId[id=OptionalGetWithoutIsPresent]
### OptionalGetWithoutIsPresent
`Optional.get()` without 'isPresent()' check
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryLogManagerForEntryLogPerLedger.java`
#### Snippet
```java
        Optional<Entry<File, MutableInt>> ledgerDirWithLeastNumofCurrentLogs = writableLedgerDirFrequency.entrySet()
                .stream().min(Map.Entry.comparingByValue());
        return ledgerDirWithLeastNumofCurrentLogs.get().getKey();
    }

```

### OptionalGetWithoutIsPresent
`Optional.get()` without 'isPresent()' check
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKSyncLogReader.java`
#### Snippet
```java
            }
            if (!positioned) {
                if (record.getTransactionId() < startTransactionId.get()) {
                    record = null;
                    continue;
```

## RuleId[id=ConstantValue]
### ConstantValue
Condition `ret < 0` is always `false`
in `stream/distributedlog/protocol/src/main/java/org/apache/distributedlog/LogRecord.java`
#### Snippet
```java
    public int getPositionWithinLogSegment() {
        long ret = (metadata & LOGRECORD_METADATA_POSITION_MASK) >> LOGRECORD_METADATA_POSITION_SHIFT;
        if (ret < 0 || ret > Integer.MAX_VALUE) {
            throw new IllegalArgumentException
                (ret + " position should never exceed max integer value");
```

### ConstantValue
Condition `c > '\u0000'` is always `true`
in `stream/proto/src/main/java/org/apache/bookkeeper/stream/protocol/util/ProtoUtils.java`
#### Snippet
```java
                || c == '<'
                || c == '>'
                || c > '\u0000' && c < '\u001f'
                || c > '\u007f' && c < '\u009f'
                || c > '\ud800' && c < '\uf8ff'
```

### ConstantValue
Condition `!(node instanceof InnerNode)` is always `true`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NetworkTopologyImpl.java`
#### Snippet
```java
                    numOfRacks++;
                }
                if (!(node instanceof InnerNode)) {
                    if (depthOfAllLeaves == -1) {
                        depthOfAllLeaves = node.getLevel();
```

### ConstantValue
Condition `node instanceof InnerNode` is always `false`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NetworkTopologyImpl.java`
#### Snippet
```java
                    numOfRacks++;
                }
                if (!(node instanceof InnerNode)) {
                    if (depthOfAllLeaves == -1) {
                        depthOfAllLeaves = node.getLevel();
```

### ConstantValue
Condition `retry >= 0` is always `true`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/sasl/TGTRefreshThread.java`
#### Snippet
```java
                String kinitArgs = "-R";
                int retry = 1;
                while (retry >= 0) {
                    try {
                        if (LOG.isDebugEnabled()) {
```

### ConstantValue
Condition `retry >= 0` is always `true`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/sasl/TGTRefreshThread.java`
#### Snippet
```java
            try {
                int retry = 1;
                while (retry >= 0) {
                    try {
                        reLogin();
```

### ConstantValue
Value `inpMsg` is always 'null'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/HardLink.java`
#### Snippet
```java
    } catch (InterruptedException e) {
      Thread.currentThread().interrupt();
      throw createIOException(fileName, inpMsg, errMsg, exitValue, e);
    } finally {
      process.destroy();
```

### ConstantValue
Value `errMsg` is always 'null'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/HardLink.java`
#### Snippet
```java
    } catch (InterruptedException e) {
      Thread.currentThread().interrupt();
      throw createIOException(fileName, inpMsg, errMsg, exitValue, e);
    } finally {
      process.destroy();
```

### ConstantValue
Condition `msg instanceof BookieProtocol.Request` is always `false` when reached
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieRequestHandler.java`
#### Snippet
```java
    @Override
    public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception {
        if (!(msg instanceof BookkeeperProtocol.Request || msg instanceof BookieProtocol.Request)) {
            ctx.fireChannelRead(msg);
            return;
```

### ConstantValue
Condition `msg instanceof BookieProtocol.Request` is always `false`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/AuthHandler.java`
#### Snippet
```java
                        waitingForAuth.add(msg);
                    }
                } else if (msg instanceof BookieProtocol.Request) {
                    // let auth messages through, queue the rest
                    BookieProtocol.Request req = (BookieProtocol.Request) msg;
```

### ConstantValue
Condition `msg instanceof BookieProtocol.Response` is always `false`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/AuthHandler.java`
#### Snippet
```java
                    }
                }
            } else if (msg instanceof BookieProtocol.Response) {
                BookieProtocol.Response resp = (BookieProtocol.Response) msg;
                switch (resp.opCode) {
```

### ConstantValue
Condition `msg instanceof BookkeeperProtocol.Request` is always `false`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/AuthHandler.java`
#### Snippet
```java
                    ctx.channel().close();
                }
            } else if (msg instanceof BookkeeperProtocol.Request) { // post-PB-client
                BookkeeperProtocol.Request req = (BookkeeperProtocol.Request) msg;
                if (req.getHeader().getOperation() == BookkeeperProtocol.OperationType.AUTH
```

### ConstantValue
Condition `msg instanceof BookieProtocol.Request` is always `false`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieProtoEncoding.java`
#### Snippet
```java
            if (msg instanceof BookkeeperProtocol.Request) {
                ctx.write(reqV3.encode(msg, ctx.alloc()), promise);
            } else if (msg instanceof BookieProtocol.Request) {
                ctx.write(reqPreV3.encode(msg, ctx.alloc()), promise);
            } else {
```

### ConstantValue
Condition `result instanceof Response && OperationType.START_TLS == ((Response)...` is always `false`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieProtoEncoding.java`
#### Snippet
```java
                        try {
                            result = repV3.decode(buffer);
                            if (result instanceof Response
                                && OperationType.START_TLS == ((Response) result).getHeader().getOperation()) {
                                usingV3Protocol = false;
                                if (LOG.isDebugEnabled()) {
```

### ConstantValue
Condition `msg instanceof BookkeeperProtocol.Response` is always `false`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieProtoEncoding.java`
#### Snippet
```java
            if (msg instanceof ByteBuf) {
                ctx.write(msg, promise);
            } else if (msg instanceof BookkeeperProtocol.Response) {
                ctx.write(repV3.encode(msg, ctx.alloc()), promise);
            } else if (msg instanceof BookieProtocol.Response) {
```

### ConstantValue
Condition `msg instanceof Response` is always `false`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
            BookieProtocol.Response response = (BookieProtocol.Response) msg;
            readV2Response(response);
        } else if (msg instanceof Response) {
            Response response = (Response) msg;
            readV3Response(response);
```

### ConstantValue
Condition `(rangeEndPos == -1) || (entryStartPos <= rangeEndPos)` is always `true`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookie/ReadLogCommand.java`
#### Snippet
```java
                         */
                        long entryEndPos = entryStartPos + entrySize + 4 - 1;
                        if (((rangeEndPos == -1) || (entryStartPos <= rangeEndPos)) && (rangeStartPos <= entryEndPos)) {
                            FormatUtil.formatEntry(entryStartPos, entry, printMsg, ledgerIdFormatter, entryFormatter);
                            entryFound.setValue(true);
```

### ConstantValue
Condition `entryStartPos <= rangeEndPos` is always `true` when reached
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookie/ReadLogCommand.java`
#### Snippet
```java
                         */
                        long entryEndPos = entryStartPos + entrySize + 4 - 1;
                        if (((rangeEndPos == -1) || (entryStartPos <= rangeEndPos)) && (rangeStartPos <= entryEndPos)) {
                            FormatUtil.formatEntry(entryStartPos, entry, printMsg, ledgerIdFormatter, entryFormatter);
                            entryFound.setValue(true);
```

### ConstantValue
Condition `flags.ledgerIdFormatter.equals(DEFAULT)` is always `true` when reached
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/client/DeleteLedgerCommand.java`
#### Snippet
```java
        if (null == ledgerIdFormatter && !flags.ledgerIdFormatter.equals(DEFAULT)) {
            this.ledgerIdFormatter = LedgerIdFormatter.newLedgerIdFormatter(flags.ledgerIdFormatter, conf);
        } else if (null == ledgerIdFormatter && flags.ledgerIdFormatter.equals(DEFAULT)) {
            this.ledgerIdFormatter = LedgerIdFormatter.newLedgerIdFormatter(conf);
        }
```

### ConstantValue
Condition `admin != null` is always `true`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookies/EndpointInfoCommand.java`
#### Snippet
```java
            return false;
        } finally {
            if (admin != null) {
                admin.close();
            }
```

### ConstantValue
Condition `admin != null` is always `true`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookies/DecommissionCommand.java`
#### Snippet
```java
            return false;
        } finally {
            if (admin != null) {
                admin.close();
            }
```

### ConstantValue
Condition `admin != null` is always `true`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/autorecovery/TriggerAuditCommand.java`
#### Snippet
```java
            admin.triggerAudit();
        } finally {
            if (admin != null) {
                admin.close();
            }
```

### ConstantValue
Condition `admin != null` is always `true`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/autorecovery/LostBookieRecoveryDelayCommand.java`
#### Snippet
```java
            }
        } finally {
            if (admin != null) {
                admin.close();
            }
```

### ConstantValue
Value `suspendMajor` is always 'false'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/GarbageCollectorThread.java`
#### Snippet
```java
                    && (!suspendMajor)) {
                // enter major compaction
                LOG.info("Enter major compaction, suspendMajor {}", suspendMajor);
                majorCompacting.set(true);
                try {
```

### ConstantValue
Value `suspendMinor` is always 'false'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/GarbageCollectorThread.java`
#### Snippet
```java
                    && (!suspendMinor)) {
                // enter minor compaction
                LOG.info("Enter minor compaction, suspendMinor {}", suspendMinor);
                minorCompacting.set(true);
                try {
```

### ConstantValue
Value `lep` is always 'null'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/IndexInMemPageMgr.java`
#### Snippet
```java
                }
            }
            return lep;
        }

```

### ConstantValue
Condition `removedEntryFromCounterMap != null` is always `true`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryLogManagerForEntryLogPerLedger.java`
#### Snippet
```java
                        @Override
                        public void onRemoval(RemovalNotification<Long, MutableInt> removedEntryFromCounterMap) {
                            if ((removedEntryFromCounterMap != null)
                                    && (removedEntryFromCounterMap.getValue() != null)) {
                                synchronized (EntryLogsPerLedgerCounter.this) {
```

### ConstantValue
Condition `changed` is always `true`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/FileInfo.java`
#### Snippet
```java
            fc = null;
        }
        if (changed) {
            notifyWatchers(LastAddConfirmedUpdateNotification.FUNC, Long.MAX_VALUE);
        }
```

### ConstantValue
Value `retLac` is always 'null'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/FileInfo.java`
#### Snippet
```java
            }
        }
        return retLac;
    }

```

### ConstantValue
Condition `written <= 0 && size > 0` is always `false`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/FileInfo.java`
#### Snippet
```java
                written += count;
            }
            if (written <= 0 && size > 0) {
                throw new IOException("Copying to new location " + rlocFile + " failed");
            }
```

### ConstantValue
Condition `size > 0` is always `false` when reached
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/FileInfo.java`
#### Snippet
```java
                written += count;
            }
            if (written <= 0 && size > 0) {
                throw new IOException("Copying to new location " + rlocFile + " failed");
            }
```

### ConstantValue
Value `retLac` is always 'null'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/TransientLedgerInfo.java`
#### Snippet
```java
            }
        }
        return retLac;
    }

```

### ConstantValue
Condition `BKException.Code.OK != rc` is always `true` when reached
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingReadLacOp.java`
#### Snippet
```java
        }

        if (!heardValidResponse && BKException.Code.OK != rc) {
            lastSeenError = rc;
        }
```

### ConstantValue
Condition `this == o` is always `false`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
           return (this.entryId == ((PendingAddOp) o).entryId);
       }
       return (this == o);
    }

```

### ConstantValue
Condition `!completed` is always `true` when reached
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        }

        if (ackQuorum && !completed) {
            if (clientCtx.getConf().enforceMinNumFaultDomainsForWrite
                && !(clientCtx.getPlacementPolicy()
```

### ConstantValue
Value `completed` is always 'false'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/PendingAddOp.java`
#### Snippet
```java
        }

        if (ackQuorum && !completed) {
            if (clientCtx.getConf().enforceMinNumFaultDomainsForWrite
                && !(clientCtx.getPlacementPolicy()
```

### ConstantValue
Condition `!all` is always `true`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/http/service/ListDiskFilesService.java`
#### Snippet
```java
            boolean all = false;

            if (!journal && !entrylog && !index && !all) {
                all = true;
            }
```

### ConstantValue
Value `all` is always 'false'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/http/service/ListDiskFilesService.java`
#### Snippet
```java
            boolean all = false;

            if (!journal && !entrylog && !index && !all) {
                all = true;
            }
```

### ConstantValue
Value `dryrun` is always 'false'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeperAdmin.java`
#### Snippet
```java
                            bkc.mainWorkerPool.submit(() -> {
                                // do recovery
                                recoverLedger(bookiesSrc, lId, dryrun, skipOpenLedgers,
                                    skipUnrecoverableLedgers, finalLedgerIterCb);
                            });
```

### ConstantValue
Condition `null == myMap` is always `false` when reached
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/metastore/InMemoryMetastoreTable.java`
#### Snippet
```java
        }

        if (!isLegalCursor || null == myMap) {
            return new Result<MetastoreCursor>(Code.IllegalOp, null);
        }
```

### ConstantValue
Condition `version >= Integer.MIN_VALUE` is always `true`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java

        long version = versionStatusCount & METADATA_VERSION_MASK;
        assert (version >= Integer.MIN_VALUE && version <= Integer.MAX_VALUE);
        assert (LogSegmentMetadataVersion.VERSION_V3_MIN_ACTIVE_DLSN.value <= version
                && LogSegmentMetadataVersion.VERSION_V4_ENVELOPED_ENTRIES.value >= version);
```

### ConstantValue
Condition `version >= Integer.MIN_VALUE && version <= Integer.MAX_VALUE` is always `true`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java

        long version = versionStatusCount & METADATA_VERSION_MASK;
        assert (version >= Integer.MIN_VALUE && version <= Integer.MAX_VALUE);
        assert (LogSegmentMetadataVersion.VERSION_V3_MIN_ACTIVE_DLSN.value <= version
                && LogSegmentMetadataVersion.VERSION_V4_ENVELOPED_ENTRIES.value >= version);
```

### ConstantValue
Condition `version <= Integer.MAX_VALUE` is always `true` when reached
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java

        long version = versionStatusCount & METADATA_VERSION_MASK;
        assert (version >= Integer.MIN_VALUE && version <= Integer.MAX_VALUE);
        assert (LogSegmentMetadataVersion.VERSION_V3_MIN_ACTIVE_DLSN.value <= version
                && LogSegmentMetadataVersion.VERSION_V4_ENVELOPED_ENTRIES.value >= version);
```

### ConstantValue
Condition `regionId >= 0` is always `true`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java

        int regionId = (int) ((versionStatusCount & REGION_MASK) >> REGION_SHIFT);
        assert (regionId >= 0 && regionId <= 0xf);

        long status = (versionStatusCount & STATUS_BITS_MASK) >> STATUS_BITS_SHIFT;
```

### ConstantValue
Condition `regionId >= 0 && regionId <= 0xf` is always `true`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java

        int regionId = (int) ((versionStatusCount & REGION_MASK) >> REGION_SHIFT);
        assert (regionId >= 0 && regionId <= 0xf);

        long status = (versionStatusCount & STATUS_BITS_MASK) >> STATUS_BITS_SHIFT;
```

### ConstantValue
Condition `regionId <= 0xf` is always `true` when reached
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java

        int regionId = (int) ((versionStatusCount & REGION_MASK) >> REGION_SHIFT);
        assert (regionId >= 0 && regionId <= 0xf);

        long status = (versionStatusCount & STATUS_BITS_MASK) >> STATUS_BITS_SHIFT;
```

### ConstantValue
Condition `status >= 0` is always `true`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java

        long status = (versionStatusCount & STATUS_BITS_MASK) >> STATUS_BITS_SHIFT;
        assert (status >= 0 && status <= METADATA_STATUS_BIT_MAX);

        if (parts.length == 6) {
```

### ConstantValue
Condition `status >= 0 && status <= METADATA_STATUS_BIT_MAX` is always `true`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java

        long status = (versionStatusCount & STATUS_BITS_MASK) >> STATUS_BITS_SHIFT;
        assert (status >= 0 && status <= METADATA_STATUS_BIT_MAX);

        if (parts.length == 6) {
```

### ConstantValue
Condition `status <= METADATA_STATUS_BIT_MAX` is always `true` when reached
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java

        long status = (versionStatusCount & STATUS_BITS_MASK) >> STATUS_BITS_SHIFT;
        assert (status >= 0 && status <= METADATA_STATUS_BIT_MAX);

        if (parts.length == 6) {
```

### ConstantValue
Condition `recordCount >= Integer.MIN_VALUE` is always `true`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java
        } else if (parts.length == 10) {
            long recordCount = (versionStatusCount & LOGRECORD_COUNT_MASK) >> LOGRECORD_COUNT_SHIFT;
            assert (recordCount >= Integer.MIN_VALUE && recordCount <= Integer.MAX_VALUE);

            long logSegmentId = Long.parseLong(parts[1]);
```

### ConstantValue
Condition `recordCount >= Integer.MIN_VALUE && recordCount <= Integer.MAX_VALUE` is always `true`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java
        } else if (parts.length == 10) {
            long recordCount = (versionStatusCount & LOGRECORD_COUNT_MASK) >> LOGRECORD_COUNT_SHIFT;
            assert (recordCount >= Integer.MIN_VALUE && recordCount <= Integer.MAX_VALUE);

            long logSegmentId = Long.parseLong(parts[1]);
```

### ConstantValue
Condition `recordCount <= Integer.MAX_VALUE` is always `true` when reached
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java
        } else if (parts.length == 10) {
            long recordCount = (versionStatusCount & LOGRECORD_COUNT_MASK) >> LOGRECORD_COUNT_SHIFT;
            assert (recordCount >= Integer.MIN_VALUE && recordCount <= Integer.MAX_VALUE);

            long logSegmentId = Long.parseLong(parts[1]);
```

### ConstantValue
Condition `version >= Integer.MIN_VALUE` is always `true`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java

        long version = versionStatusCount & METADATA_VERSION_MASK;
        assert (version >= Integer.MIN_VALUE && version <= Integer.MAX_VALUE);
        assert (LogSegmentMetadataVersion.VERSION_V5_SEQUENCE_ID.value <= version
                && LogSegmentMetadata.LEDGER_METADATA_CURRENT_LAYOUT_VERSION >= version);
```

### ConstantValue
Condition `version >= Integer.MIN_VALUE && version <= Integer.MAX_VALUE` is always `true`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java

        long version = versionStatusCount & METADATA_VERSION_MASK;
        assert (version >= Integer.MIN_VALUE && version <= Integer.MAX_VALUE);
        assert (LogSegmentMetadataVersion.VERSION_V5_SEQUENCE_ID.value <= version
                && LogSegmentMetadata.LEDGER_METADATA_CURRENT_LAYOUT_VERSION >= version);
```

### ConstantValue
Condition `version <= Integer.MAX_VALUE` is always `true` when reached
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java

        long version = versionStatusCount & METADATA_VERSION_MASK;
        assert (version >= Integer.MIN_VALUE && version <= Integer.MAX_VALUE);
        assert (LogSegmentMetadataVersion.VERSION_V5_SEQUENCE_ID.value <= version
                && LogSegmentMetadata.LEDGER_METADATA_CURRENT_LAYOUT_VERSION >= version);
```

### ConstantValue
Condition `regionId >= 0` is always `true`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java

        int regionId = (int) ((versionStatusCount & REGION_MASK) >> REGION_SHIFT);
        assert (regionId >= 0 && regionId <= 0xf);

        long status = (versionStatusCount & STATUS_BITS_MASK) >> STATUS_BITS_SHIFT;
```

### ConstantValue
Condition `regionId >= 0 && regionId <= 0xf` is always `true`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java

        int regionId = (int) ((versionStatusCount & REGION_MASK) >> REGION_SHIFT);
        assert (regionId >= 0 && regionId <= 0xf);

        long status = (versionStatusCount & STATUS_BITS_MASK) >> STATUS_BITS_SHIFT;
```

### ConstantValue
Condition `regionId <= 0xf` is always `true` when reached
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java

        int regionId = (int) ((versionStatusCount & REGION_MASK) >> REGION_SHIFT);
        assert (regionId >= 0 && regionId <= 0xf);

        long status = (versionStatusCount & STATUS_BITS_MASK) >> STATUS_BITS_SHIFT;
```

### ConstantValue
Condition `status >= 0` is always `true`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java

        long status = (versionStatusCount & STATUS_BITS_MASK) >> STATUS_BITS_SHIFT;
        assert (status >= 0 && status <= METADATA_STATUS_BIT_MAX);

        if (parts.length == 7) {
```

### ConstantValue
Condition `status >= 0 && status <= METADATA_STATUS_BIT_MAX` is always `true`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java

        long status = (versionStatusCount & STATUS_BITS_MASK) >> STATUS_BITS_SHIFT;
        assert (status >= 0 && status <= METADATA_STATUS_BIT_MAX);

        if (parts.length == 7) {
```

### ConstantValue
Condition `status <= METADATA_STATUS_BIT_MAX` is always `true` when reached
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java

        long status = (versionStatusCount & STATUS_BITS_MASK) >> STATUS_BITS_SHIFT;
        assert (status >= 0 && status <= METADATA_STATUS_BIT_MAX);

        if (parts.length == 7) {
```

### ConstantValue
Condition `recordCount >= Integer.MIN_VALUE` is always `true`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java
        } else if (parts.length == 11) {
            long recordCount = (versionStatusCount & LOGRECORD_COUNT_MASK) >> LOGRECORD_COUNT_SHIFT;
            assert (recordCount >= Integer.MIN_VALUE && recordCount <= Integer.MAX_VALUE);

            long logSegmentId = Long.parseLong(parts[1]);
```

### ConstantValue
Condition `recordCount >= Integer.MIN_VALUE && recordCount <= Integer.MAX_VALUE` is always `true`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java
        } else if (parts.length == 11) {
            long recordCount = (versionStatusCount & LOGRECORD_COUNT_MASK) >> LOGRECORD_COUNT_SHIFT;
            assert (recordCount >= Integer.MIN_VALUE && recordCount <= Integer.MAX_VALUE);

            long logSegmentId = Long.parseLong(parts[1]);
```

### ConstantValue
Condition `recordCount <= Integer.MAX_VALUE` is always `true` when reached
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java
        } else if (parts.length == 11) {
            long recordCount = (versionStatusCount & LOGRECORD_COUNT_MASK) >> LOGRECORD_COUNT_SHIFT;
            assert (recordCount >= Integer.MIN_VALUE && recordCount <= Integer.MAX_VALUE);

            long logSegmentId = Long.parseLong(parts[1]);
```

### ConstantValue
Condition `version >= Integer.MIN_VALUE` is always `true`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java

        long version = versionStatusCount & METADATA_VERSION_MASK;
        assert (version >= Integer.MIN_VALUE && version <= Integer.MAX_VALUE);
        assert (1 == version);

```

### ConstantValue
Condition `version >= Integer.MIN_VALUE && version <= Integer.MAX_VALUE` is always `true`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java

        long version = versionStatusCount & METADATA_VERSION_MASK;
        assert (version >= Integer.MIN_VALUE && version <= Integer.MAX_VALUE);
        assert (1 == version);

```

### ConstantValue
Condition `version <= Integer.MAX_VALUE` is always `true` when reached
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java

        long version = versionStatusCount & METADATA_VERSION_MASK;
        assert (version >= Integer.MIN_VALUE && version <= Integer.MAX_VALUE);
        assert (1 == version);

```

### ConstantValue
Condition `regionId <= 0xf` is always `true` when reached
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java

        int regionId = (int) (versionStatusCount & REGION_MASK) >> REGION_SHIFT;
        assert (regionId >= 0 && regionId <= 0xf);

        long status = (versionStatusCount & STATUS_BITS_MASK) >> STATUS_BITS_SHIFT;
```

### ConstantValue
Condition `status >= 0` is always `true`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java

        long status = (versionStatusCount & STATUS_BITS_MASK) >> STATUS_BITS_SHIFT;
        assert (status >= 0 && status <= METADATA_STATUS_BIT_MAX);

        if (parts.length == 3) {
```

### ConstantValue
Condition `status >= 0 && status <= METADATA_STATUS_BIT_MAX` is always `true`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java

        long status = (versionStatusCount & STATUS_BITS_MASK) >> STATUS_BITS_SHIFT;
        assert (status >= 0 && status <= METADATA_STATUS_BIT_MAX);

        if (parts.length == 3) {
```

### ConstantValue
Condition `status <= METADATA_STATUS_BIT_MAX` is always `true` when reached
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java

        long status = (versionStatusCount & STATUS_BITS_MASK) >> STATUS_BITS_SHIFT;
        assert (status >= 0 && status <= METADATA_STATUS_BIT_MAX);

        if (parts.length == 3) {
```

### ConstantValue
Condition `recordCount >= Integer.MIN_VALUE` is always `true`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java
        } else if (parts.length == 5) {
            long recordCount = (versionStatusCount & LOGRECORD_COUNT_MASK) >> LOGRECORD_COUNT_SHIFT;
            assert (recordCount >= Integer.MIN_VALUE && recordCount <= Integer.MAX_VALUE);

            long logSegmentId = Long.parseLong(parts[1]);
```

### ConstantValue
Condition `recordCount >= Integer.MIN_VALUE && recordCount <= Integer.MAX_VALUE` is always `true`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java
        } else if (parts.length == 5) {
            long recordCount = (versionStatusCount & LOGRECORD_COUNT_MASK) >> LOGRECORD_COUNT_SHIFT;
            assert (recordCount >= Integer.MIN_VALUE && recordCount <= Integer.MAX_VALUE);

            long logSegmentId = Long.parseLong(parts[1]);
```

### ConstantValue
Condition `recordCount <= Integer.MAX_VALUE` is always `true` when reached
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java
        } else if (parts.length == 5) {
            long recordCount = (versionStatusCount & LOGRECORD_COUNT_MASK) >> LOGRECORD_COUNT_SHIFT;
            assert (recordCount >= Integer.MIN_VALUE && recordCount <= Integer.MAX_VALUE);

            long logSegmentId = Long.parseLong(parts[1]);
```

### ConstantValue
Condition `version >= Integer.MIN_VALUE` is always `true`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java

        long version = versionStatusCount & METADATA_VERSION_MASK;
        assert (version >= Integer.MIN_VALUE && version <= Integer.MAX_VALUE);
        assert (2 == version);

```

### ConstantValue
Condition `version >= Integer.MIN_VALUE && version <= Integer.MAX_VALUE` is always `true`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java

        long version = versionStatusCount & METADATA_VERSION_MASK;
        assert (version >= Integer.MIN_VALUE && version <= Integer.MAX_VALUE);
        assert (2 == version);

```

### ConstantValue
Condition `version <= Integer.MAX_VALUE` is always `true` when reached
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java

        long version = versionStatusCount & METADATA_VERSION_MASK;
        assert (version >= Integer.MIN_VALUE && version <= Integer.MAX_VALUE);
        assert (2 == version);

```

### ConstantValue
Condition `regionId >= 0` is always `true`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java

        int regionId = (int) ((versionStatusCount & REGION_MASK) >> REGION_SHIFT);
        assert (regionId >= 0 && regionId <= 0xf);

        long status = (versionStatusCount & STATUS_BITS_MASK) >> STATUS_BITS_SHIFT;
```

### ConstantValue
Condition `regionId >= 0 && regionId <= 0xf` is always `true`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java

        int regionId = (int) ((versionStatusCount & REGION_MASK) >> REGION_SHIFT);
        assert (regionId >= 0 && regionId <= 0xf);

        long status = (versionStatusCount & STATUS_BITS_MASK) >> STATUS_BITS_SHIFT;
```

### ConstantValue
Condition `regionId <= 0xf` is always `true` when reached
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java

        int regionId = (int) ((versionStatusCount & REGION_MASK) >> REGION_SHIFT);
        assert (regionId >= 0 && regionId <= 0xf);

        long status = (versionStatusCount & STATUS_BITS_MASK) >> STATUS_BITS_SHIFT;
```

### ConstantValue
Condition `status >= 0` is always `true`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java

        long status = (versionStatusCount & STATUS_BITS_MASK) >> STATUS_BITS_SHIFT;
        assert (status >= 0 && status <= METADATA_STATUS_BIT_MAX);

        if (parts.length == 4) {
```

### ConstantValue
Condition `status >= 0 && status <= METADATA_STATUS_BIT_MAX` is always `true`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java

        long status = (versionStatusCount & STATUS_BITS_MASK) >> STATUS_BITS_SHIFT;
        assert (status >= 0 && status <= METADATA_STATUS_BIT_MAX);

        if (parts.length == 4) {
```

### ConstantValue
Condition `status <= METADATA_STATUS_BIT_MAX` is always `true` when reached
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java

        long status = (versionStatusCount & STATUS_BITS_MASK) >> STATUS_BITS_SHIFT;
        assert (status >= 0 && status <= METADATA_STATUS_BIT_MAX);

        if (parts.length == 4) {
```

### ConstantValue
Condition `recordCount >= Integer.MIN_VALUE` is always `true`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java
        } else if (parts.length == 8) {
            long recordCount = (versionStatusCount & LOGRECORD_COUNT_MASK) >> LOGRECORD_COUNT_SHIFT;
            assert (recordCount >= Integer.MIN_VALUE && recordCount <= Integer.MAX_VALUE);

            long logSegmentId = Long.parseLong(parts[1]);
```

### ConstantValue
Condition `recordCount >= Integer.MIN_VALUE && recordCount <= Integer.MAX_VALUE` is always `true`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java
        } else if (parts.length == 8) {
            long recordCount = (versionStatusCount & LOGRECORD_COUNT_MASK) >> LOGRECORD_COUNT_SHIFT;
            assert (recordCount >= Integer.MIN_VALUE && recordCount <= Integer.MAX_VALUE);

            long logSegmentId = Long.parseLong(parts[1]);
```

### ConstantValue
Condition `recordCount <= Integer.MAX_VALUE` is always `true` when reached
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java
        } else if (parts.length == 8) {
            long recordCount = (versionStatusCount & LOGRECORD_COUNT_MASK) >> LOGRECORD_COUNT_SHIFT;
            assert (recordCount >= Integer.MIN_VALUE && recordCount <= Integer.MAX_VALUE);

            long logSegmentId = Long.parseLong(parts[1]);
```

### ConstantValue
Value `this.enablePermits` is always 'false'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/zk/LimitedPermitManager.java`
#### Snippet
```java
        if (epoch == ((EpochPermit) permit).getEpoch()) {
            this.enablePermits = false;
            LOG.info("EnablePermits = {}, Epoch = {}.", this.enablePermits, epoch);
            return true;
        } else {
```

### ConstantValue
Value `abort` is always 'false'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogSegmentWriter.java`
#### Snippet
```java
                public void onFailure(Throwable cause) {
                    throwExc.setValue(cause);
                    abortTransmitPacketOnClose(abort, throwExc, closePromise);
                }
            });
```

### ConstantValue
Value `abort` is always 'false'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogSegmentWriter.java`
#### Snippet
```java
                @Override
                public void onSuccess(Long value) {
                    abortTransmitPacketOnClose(abort, throwExc, closePromise);
                }

```

### ConstantValue
Condition `null != allocator` is always `true`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/BKNamespaceDriver.java`
#### Snippet
```java
                    writerBKC,
                    scheduler);
            if (null != allocator) {
                allocator.start();
            }
```

### ConstantValue
Condition `c > '\u0000'` is always `true`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/util/DLUtils.java`
#### Snippet
```java
                            break;
                        }
                    } else if (c > '\u0000' && c < '\u001f'
                        || c > '\u007f' && c < '\u009F'
                        || c > '\ud800' && c < '\uf8ff'
```

### ConstantValue
Value `createIfNull` is always 'true'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/metadata/ZKLogStreamMetadataStore.java`
#### Snippet
```java
                    zooKeeperClient,
                    clientId,
                    getLockStateExecutor(createIfNull),
                    conf.getZKNumRetries(),
                    conf.getLockTimeoutMilliSeconds(),
```

### ConstantValue
Value `wait` is always 'false'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/lock/ZKSessionLock.java`
#### Snippet
```java
                                    }, lockStateExecutor.chooseThread(lockPath));
                        } else {
                            asyncTryLock(wait, result);
                        }
                    });
```

### ConstantValue
Value `wait` is always 'true'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/lock/ZKSessionLock.java`
#### Snippet
```java
        final boolean wait = DistributedLogConstants.LOCK_IMMEDIATE != timeout;
        if (wait) {
            asyncTryLock(wait, result);
        } else {
            // try to check locks first
```

### ConstantValue
Value `recursive` is always 'true'
in `stream/distributedlog/io/dlfs/src/main/java/org/apache/distributedlog/fs/DLFileSystem.java`
#### Snippet
```java
                    String child = logs.next();
                    Path childPath = new Path(path, child);
                    delete(childPath, recursive);
                }
            }
```

### ConstantValue
Condition `args.length >= 1` is always `true`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                throw new ParseException("Must specify at least start dlsn.");
            }
            if (args.length >= 1) {
                startDLSN = parseDLSN(args[0]);
            }
```

### ConstantValue
Condition `t instanceof InterruptedException` is always `false`
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/SingleThreadExecutor.java`
#### Snippet
```java
            tasksCompleted.increment();
        } catch (Throwable t) {
            if (t instanceof InterruptedException) {
                Thread.currentThread().interrupt();
                return false;
```

### ConstantValue
Condition `size() == 0` is always `true`
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/collections/GrowableMpScArrayConsumerBlockingQueue.java`
#### Snippet
```java

            // Double check that size has not changed after we have registered ourselves for notification
            if (size() == 0) {
                LockSupport.park();
                if (Thread.interrupted()) {
```

## RuleId[id=StringConcatenationInsideStringBufferAppend]
### StringConcatenationInsideStringBufferAppend
String concatenation as argument to `StringBuilder.append()` call
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/AuditorReplicasCheckTask.java`
#### Snippet
```java
            writeQuorumSize = missingEntriesInfoOfLedger.getWriteQuorumSize();
            ackQuorumSize = missingEntriesInfoOfLedger.getAckQuorumSize();
            errMessage.append("Ledger : " + ledgerWithMissingEntries + " has following missing entries : ");
            for (int listInd = 0; listInd < missingEntriesInfoList.size(); listInd++) {
                MissingEntriesInfo missingEntriesInfo = missingEntriesInfoList.get(listInd);
```

### StringConcatenationInsideStringBufferAppend
String concatenation as argument to `StringBuilder.append()` call
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/AuditorReplicasCheckTask.java`
#### Snippet
```java
                        missingEntriesInfo.getSegmentEnsemble();
                missingEntries.addAll(unavailableEntriesList);
                errMessage.append("In segment starting at " + segmentEnsemble.getKey() + " with ensemble "
                        + segmentEnsemble.getValue() + ", following entries " + unavailableEntriesList
                        + " are missing in bookie: " + missingEntriesInfo.getBookieMissingEntries());
```

### StringConcatenationInsideStringBufferAppend
String concatenation as argument to `StringBuilder.append()` call
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/AuditorReplicasCheckTask.java`
#### Snippet
```java
            List<MissingEntriesInfo> missingBookiesInfoList = ledgerWithUnavailableBookiesInfo.getValue()
                    .getMissingEntriesInfoList();
            errMessage.append("Ledger : " + ledgerWithUnavailableBookies + " has following unavailable bookies : ");
            for (int listInd = 0; listInd < missingBookiesInfoList.size(); listInd++) {
                MissingEntriesInfo missingBookieInfo = missingBookiesInfoList.get(listInd);
```

### StringConcatenationInsideStringBufferAppend
String concatenation as argument to `StringBuilder.append()` call
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/AuditorReplicasCheckTask.java`
#### Snippet
```java
                Entry<Long, ? extends List<BookieId>> segmentEnsemble =
                        missingBookieInfo.getSegmentEnsemble();
                errMessage.append("In segment starting at " + segmentEnsemble.getKey() + " with ensemble "
                        + segmentEnsemble.getValue() + ", following bookie has not responded "
                        + missingBookieInfo.getBookieMissingEntries());
```

## RuleId[id=IOResource]
### IOResource
'RandomAccessFile' should be opened in front of a 'try' block and closed in the corresponding 'finally' block
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryLoggerAllocator.java`
#### Snippet
```java

        File newLogFile = new File(dirForNextEntryLog, logFileName);
        FileChannel channel = new RandomAccessFile(newLogFile, "rw").getChannel();

        BufferedLogChannel logChannel = new BufferedLogChannel(byteBufAllocator, channel, conf.getWriteBufferBytes(),
```

### IOResource
'DryRunLedgerCache' should be opened in front of a 'try' block and closed in the corresponding 'finally' block
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/InterleavedStorageRegenerateIndexOp.java`
#### Snippet
```java
        final LedgerCache ledgerCache;
        if (dryRun) {
            ledgerCache = new DryRunLedgerCache();
        } else {
            ledgerCache = new LedgerCacheImpl(conf, new SnapshotMap<Long, Boolean>(),
```

### IOResource
'LedgerCacheImpl' should be opened in front of a 'try' block and closed in the corresponding 'finally' block
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/InterleavedStorageRegenerateIndexOp.java`
#### Snippet
```java
            ledgerCache = new DryRunLedgerCache();
        } else {
            ledgerCache = new LedgerCacheImpl(conf, new SnapshotMap<Long, Boolean>(),
                                              indexDirsManager, NullStatsLogger.INSTANCE);
        }
```

### IOResource
'RandomAccessFile' should be opened in front of a 'try' block and closed in the corresponding 'finally' block
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/DefaultEntryLogger.java`
#### Snippet
```java
        // get channel is used to open an existing entry log file
        // it would be better to open using read mode
        FileChannel newFc = new RandomAccessFile(file, "r").getChannel();
        FileChannel oldFc = logid2FileChannel.putIfAbsent(entryLogId, newFc);
        if (null != oldFc) {
```

### IOResource
'RandomAccessFile' should be opened in front of a 'try' block and closed in the corresponding 'finally' block
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/FileInfo.java`
#### Snippet
```java
            }

            fc = new RandomAccessFile(lf, mode).getChannel();
            size = fc.size();
            sizeSinceLastWrite = size;
```

### IOResource
'RandomAccessFile' should be opened in front of a 'try' block and closed in the corresponding 'finally' block
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/FileInfo.java`
#### Snippet
```java
        }
        // copy contents from old.idx to new.idx.rloc
        FileChannel newFc = new RandomAccessFile(rlocFile, "rw").getChannel();
        try {
            long written = 0;
```

### IOResource
'RandomAccessFile' should be opened in front of a 'try' block and closed in the corresponding 'finally' block
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/FileInfo.java`
#### Snippet
```java
            throw new IOException("Failed to rename " + rlocFile + " to " + newFile);
        }
        fc = new RandomAccessFile(newFile, mode).getChannel();
        lf = newFile;
        deleted = false;
```

### IOResource
'RandomAccessFile' should be opened in front of a 'try' block and closed in the corresponding 'finally' block
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/FileInfo.java`
#### Snippet
```java
                // delayed the creation of parents directories
                checkParents(lf);
                fc = new RandomAccessFile(lf, mode).getChannel();
                size = fc.size();
                if (size == 0) {
```

### IOResource
'BKAsyncLogWriter' should be opened in front of a 'try' block and closed in the corresponding 'finally' block
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKDistributedLogManager.java`
#### Snippet
```java
            synchronized (BKDistributedLogManager.this) {
                // 2. create the writer with the handler
                writer = new BKAsyncLogWriter(
                        conf,
                        dynConf,
```

### IOResource
'BufferedReader' should be opened in front of a 'try' block and closed in the corresponding 'finally' block
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/metadata/DLMetadata.java`
#### Snippet
```java
            LOG.debug("Parsing dl metadata {}.", metadata);
        }
        BufferedReader br = new BufferedReader(new StringReader(metadata));
        String versionLine = br.readLine();
        if (null == versionLine) {
```

### IOResource
'CountingInputStream' should be opened in front of a 'try' block and closed in the corresponding 'finally' block
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/CheckpointFile.java`
#### Snippet
```java
                               Duration idleWait) throws IOException, TimeoutException {
        String remoteFilePath = getRemotePath(dbPrefix, checkpointId, true);
        CountingInputStream cis = new CountingInputStream(
            checkpointStore.openInputStream(remoteFilePath)
        );
```

## RuleId[id=RedundantOperationOnEmptyContainer]
### RedundantOperationOnEmptyContainer
Array `tmpArray` is always empty
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/AvailabilityOfEntriesOfLedger.java`
#### Snippet
```java
    static {
        long[] tmpArray = {};
        EMPTY_AVAILABILITYOFENTRIESOFLEDGER = new AvailabilityOfEntriesOfLedger(Arrays.stream(tmpArray).iterator());
    }

```

### RedundantOperationOnEmptyContainer
Collection `streams` is always empty
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/ZKLogMetadataStore.java`
#### Snippet
```java
                                } else if (KeeperException.Code.NONODE.intValue() == rc) {
                                    List<String> streams = Lists.newLinkedList();
                                    promise.complete(streams.iterator());
                                } else {
                                    promise.completeExceptionally(new ZKException("Error reading namespace "
```

### RedundantOperationOnEmptyContainer
Collection `streams` is always empty
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/ZKLogMetadataStore.java`
#### Snippet
```java
                    } else if (KeeperException.Code.NONODE.intValue() == syncRc) {
                        List<String> streams = Lists.newLinkedList();
                        promise.complete(streams.iterator());
                    } else {
                        promise.completeExceptionally(new ZKException("Error reading namespace " + nsRootPath,
```

## RuleId[id=OptionalIsPresent]
### OptionalIsPresent
Can be replaced with single expression in functional style
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/LedgerMetadataSerDe.java`
#### Snippet
```java
            // 'storingCreationTime' is only ever taken into account for serializing version 2
            builder.storingCreationTime(true);
        } else if (metadataStoreCtime.isPresent()) {
            builder.withCreationTime(metadataStoreCtime.get()).storingCreationTime(false);
        }
```

### OptionalIsPresent
Can be replaced with single expression in functional style
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/LedgerMetadataSerDe.java`
#### Snippet
```java
        if (data.hasCtime()) {
            builder.storingCreationTime(true);
        } else if (metadataStoreCtime.isPresent()) {
            builder.withCreationTime(metadataStoreCtime.get()).storingCreationTime(false);
        }
```

### OptionalIsPresent
Can be replaced with single expression in functional style
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/LongPollReadEntryProcessorV3.java`
#### Snippet
```java
                    entryId = previousLAC + 1;
                    readResponseBuilder.setMaxLAC(knownLAC);
                    if (lastAddConfirmedUpdateTime.isPresent()) {
                        readResponseBuilder.setLacUpdateTimestamp(lastAddConfirmedUpdateTime.get());
                    }
```

### OptionalIsPresent
Can be replaced with single expression in functional style
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/EnsemblePlacementPolicy.java`
#### Snippet
```java
     */
    default int getStickyReadBookieIndex(LedgerMetadata metadata, Optional<Integer> currentStickyBookieIndex) {
        if (!currentStickyBookieIndex.isPresent()) {
            // Pick one bookie randomly from the current ensemble as the initial
            // "sticky bookie"
```

### OptionalIsPresent
Can be replaced with single expression in functional style
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeperAdmin.java`
#### Snippet
```java
        // bookies to exclude for ensemble allocation
        Set<BookieId> bookiesToExclude = Sets.newHashSet();
        if (excludedBookies.isPresent()) {
            bookiesToExclude.addAll(excludedBookies.get());
        }
```

### OptionalIsPresent
Can be replaced with single expression in functional style
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKDistributedLogNamespace.java`
#### Snippet
```java
        // If dynamic config was not provided, default to a static view of the global configuration.
        DynamicDistributedLogConfiguration dynConf = null;
        if (dynamicLogConfiguration.isPresent()) {
            dynConf = dynamicLogConfiguration.get();
        } else {
```

### OptionalIsPresent
Can be replaced with single expression in functional style
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/federated/FederatedZKLogMetadataStore.java`
#### Snippet
```java
        }
        return postStateCheck(fetchLogLocation(logName).thenApply((uriOptional) -> {
            if (uriOptional.isPresent()) {
                log2Locations.putIfAbsent(logName, uriOptional.get());
            }
```

### OptionalIsPresent
Can be replaced with single expression in functional style
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKDistributedLogManager.java`
#### Snippet
```java
                BKDistributedLogManager.this,
                scheduler,
                fromDLSN.isPresent() ? fromDLSN.get() : DLSN.InitialDLSN,
                subscriberId,
                false,
```

### OptionalIsPresent
Can be replaced with single expression in functional style
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/metadata/LogMetadataForReader.java`
#### Snippet
```java
     */
    public String getReadLockPath(Optional<String> subscriberId) {
        if (subscriberId.isPresent()) {
            return logRootPath + SUBSCRIBERS_PATH + "/" + subscriberId.get() + READ_LOCK_PATH;
        } else {
```

## RuleId[id=Java8MapForEach]
### Java8MapForEach
Can be replaced with 'Map.forEach()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadOnlyLedgerHandle.java`
#### Snippet
```java
                    Long lastEnsembleKey = LedgerMetadataUtils.getLastEnsembleKey(metadata);
                    synchronized (metadataLock) {
                        newEnsemblesFromRecovery.entrySet().forEach(
                                (e) -> {
                                    checkState(e.getKey() >= lastEnsembleKey,
```

## RuleId[id=RedundantLengthCheck]
### RedundantLengthCheck
Redundant array length check
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/DefaultEntryLogger.java`
#### Snippet
```java
                if (dir.exists() && dir.isDirectory()) {
                    File[] files = dir.listFiles(file -> file.getName().endsWith(".log"));
                    if (files != null && files.length > 0) {
                        for (File f : files) {
                            long logId = fileName2LogId(f.getName());
```

### RedundantLengthCheck
Redundant array length check
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/EntryLogIdsImpl.java`
#### Snippet
```java
        if (directory.exists() && directory.isDirectory()) {
            File[] files = directory.listFiles();
            if (files != null && files.length > 0) {
                for (File f : files) {
                    Matcher m = COMPACTED_FILE_PATTERN.matcher(f.getName());
```

### RedundantLengthCheck
Redundant array length check
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/EntryLogIdsImpl.java`
#### Snippet
```java
        if (directory.exists() && directory.isDirectory()) {
            File[] files = directory.listFiles();
            if (files != null && files.length > 0) {
                for (File f : files) {
                    Matcher m = FILE_PATTERN.matcher(f.getName());
```

### RedundantLengthCheck
Redundant array length check
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectEntryLogger.java`
#### Snippet
```java
        if (ledgerDir.exists() && ledgerDir.isDirectory()) {
            File[] files = ledgerDir.listFiles();
            if (files != null && files.length > 0) {
                for (File f : files) {
                    if (f.getName().endsWith(COMPACTING_SUFFIX)) {
```

## RuleId[id=UtilityClassWithoutPrivateConstructor]
### UtilityClassWithoutPrivateConstructor
Class `ClientConstants` has only 'static' members, and lacks a 'private' constructor
in `stream/clients/java/base/src/main/java/org/apache/bookkeeper/clients/utils/ClientConstants.java`
#### Snippet
```java
 * Client related constants.
 */
public final class ClientConstants {

    public static final String TOKEN = "token";
```

### UtilityClassWithoutPrivateConstructor
Class `NetUtils` has only 'static' members, and lacks a 'private' constructor
in `stream/clients/java/base/src/main/java/org/apache/bookkeeper/clients/utils/NetUtils.java`
#### Snippet
```java
 * Network related utils.
 */
public class NetUtils {

    /**
```

### UtilityClassWithoutPrivateConstructor
Class `RpcUtils` has only 'static' members, and lacks a 'private' constructor
in `stream/clients/java/base/src/main/java/org/apache/bookkeeper/clients/utils/RpcUtils.java`
#### Snippet
```java
 * RPC related utils.
 */
public class RpcUtils {

    /**
```

### UtilityClassWithoutPrivateConstructor
Class `LogRecordSet` has only 'static' members, and lacks a 'private' constructor
in `stream/distributedlog/protocol/src/main/java/org/apache/distributedlog/LogRecordSet.java`
#### Snippet
```java
 * </pre>
 */
public class LogRecordSet {

    public static final int HEADER_LEN =
```

### UtilityClassWithoutPrivateConstructor
Class `ThreadRegistry` has only 'static' members, and lacks a 'private' constructor
in `stats/bookkeeper-stats-api/src/main/java/org/apache/bookkeeper/stats/ThreadRegistry.java`
#### Snippet
```java
 * For flexibility, this registry is not based on TLS.
 */
public class ThreadRegistry {
    private static ConcurrentMap<Long, ThreadPoolThread> threadPoolMap = new ConcurrentHashMap<>();

```

### UtilityClassWithoutPrivateConstructor
Class `Stats` has only 'static' members, and lacks a 'private' constructor
in `stats/bookkeeper-stats-api/src/main/java/org/apache/bookkeeper/stats/Stats.java`
#### Snippet
```java
 * An umbrella class for loading stats provider.
 */
public class Stats {
    static final Logger LOG = LoggerFactory.getLogger(Stats.class);
    public static final String STATS_PROVIDER_CLASS = "statsProviderClass";
```

### UtilityClassWithoutPrivateConstructor
Class `CompressionUtils` has only 'static' members, and lacks a 'private' constructor
in `stream/distributedlog/common/src/main/java/org/apache/distributedlog/io/CompressionUtils.java`
#### Snippet
```java
 * Utils for compression related operations.
 */
public class CompressionUtils {

    public static final String LZ4 = "lz4";
```

### UtilityClassWithoutPrivateConstructor
Class `MathUtil` has only 'static' members, and lacks a 'private' constructor
in `stream/distributedlog/common/src/main/java/org/apache/distributedlog/common/util/MathUtil.java`
#### Snippet
```java
 * Helpers for math related utils.
 */
public class MathUtil {

  public static int signSafeMod(long dividend, int divisor) {
```

### UtilityClassWithoutPrivateConstructor
Class `ByteBufUtils` has only 'static' members, and lacks a 'private' constructor
in `stream/distributedlog/common/src/main/java/org/apache/distributedlog/common/util/ByteBufUtils.java`
#### Snippet
```java
 * Utils to handle with {@link io.netty.buffer.ByteBuf}.
 */
public class ByteBufUtils {

    public static byte[] getArray(ByteBuf buffer) {
```

### UtilityClassWithoutPrivateConstructor
Class `BitMaskUtils` has only 'static' members, and lacks a 'private' constructor
in `stream/distributedlog/common/src/main/java/org/apache/distributedlog/common/util/BitMaskUtils.java`
#### Snippet
```java
 * Utils for bit mask operations.
 */
public class BitMaskUtils {

    /**
```

### UtilityClassWithoutPrivateConstructor
Class `SchedulerUtils` has only 'static' members, and lacks a 'private' constructor
in `stream/distributedlog/common/src/main/java/org/apache/distributedlog/common/util/SchedulerUtils.java`
#### Snippet
```java
 */
@Slf4j
public class SchedulerUtils {

    public static void shutdownScheduler(ExecutorService service, long timeout, TimeUnit timeUnit) {
```

### UtilityClassWithoutPrivateConstructor
Class `VoidFunctions` has only 'static' members, and lacks a 'private' constructor
in `stream/distributedlog/common/src/main/java/org/apache/distributedlog/common/functions/VoidFunctions.java`
#### Snippet
```java
 * Functions for transforming structures related to {@link Void}.
 */
public class VoidFunctions {

    public static final Function<List<Void>, Void> LIST_TO_VOID_FUNC =
```

### UtilityClassWithoutPrivateConstructor
Class `ProtoUtils` has only 'static' members, and lacks a 'private' constructor
in `stream/proto/src/main/java/org/apache/bookkeeper/stream/protocol/util/ProtoUtils.java`
#### Snippet
```java
 * Protocol related utils.
 */
public class ProtoUtils {

    /**
```

### UtilityClassWithoutPrivateConstructor
Class `BroadCastStatsLogger` has only 'static' members, and lacks a 'private' constructor
in `stream/distributedlog/common/src/main/java/org/apache/distributedlog/common/stats/BroadCastStatsLogger.java`
#### Snippet
```java
 * Stats Loggers that broadcast stats to multiple {@link StatsLogger}.
 */
public class BroadCastStatsLogger {

    /**
```

### UtilityClassWithoutPrivateConstructor
Class `StandaloneStarter` has only 'static' members, and lacks a 'private' constructor
in `stream/server/src/main/java/org/apache/bookkeeper/stream/cluster/StandaloneStarter.java`
#### Snippet
```java
 */
@Slf4j
public class StandaloneStarter {

    /**
```

### UtilityClassWithoutPrivateConstructor
Class `StorageServer` has only 'static' members, and lacks a 'private' constructor
in `stream/server/src/main/java/org/apache/bookkeeper/stream/server/StorageServer.java`
#### Snippet
```java
 */
@Slf4j
public class StorageServer {

    private static class ServerArguments {
```

### UtilityClassWithoutPrivateConstructor
Class `NetUtils` has only 'static' members, and lacks a 'private' constructor
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NetUtils.java`
#### Snippet
```java
 * Network Utilities.
 */
public class NetUtils {

    /**
```

### UtilityClassWithoutPrivateConstructor
Class `DNS` has only 'static' members, and lacks a 'private' constructor
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/DNS.java`
#### Snippet
```java
 * the querying of specific network interfaces or nameservers.
 */
public class DNS {

    private static final Logger LOG = LoggerFactory.getLogger(DNS.class);
```

### UtilityClassWithoutPrivateConstructor
Class `AuthProviderFactoryFactory` has only 'static' members, and lacks a 'private' constructor
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/auth/AuthProviderFactoryFactory.java`
#### Snippet
```java
 * A factory to manage the authentication provider factories.
 */
public class AuthProviderFactoryFactory {

    public static BookieAuthProvider.Factory newBookieAuthProviderFactory(ServerConfiguration conf) throws IOException {
```

### UtilityClassWithoutPrivateConstructor
Class `SaslConstants` has only 'static' members, and lacks a 'private' constructor
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/sasl/SaslConstants.java`
#### Snippet
```java
 * SASL Constants.
 */
public class SaslConstants {

    static final String PLUGIN_NAME = "sasl";
```

### UtilityClassWithoutPrivateConstructor
Class `PortManager` has only 'static' members, and lacks a 'private' constructor
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/PortManager.java`
#### Snippet
```java
 * of the bookkeeper tests to run at once.
 */
public class PortManager {

    /**
```

### UtilityClassWithoutPrivateConstructor
Class `IOUtils` has only 'static' members, and lacks a 'private' constructor
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/IOUtils.java`
#### Snippet
```java
 * An utility class for I/O related functionality.
 */
public class IOUtils {

    /**
```

### UtilityClassWithoutPrivateConstructor
Class `BookKeeperConstants` has only 'static' members, and lacks a 'private' constructor
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/BookKeeperConstants.java`
#### Snippet
```java
 * This class contains constants used in BookKeeper.
 */
public class BookKeeperConstants {

    // //////////////////////////
```

### UtilityClassWithoutPrivateConstructor
Class `ZeroBuffer` has only 'static' members, and lacks a 'private' constructor
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/ZeroBuffer.java`
#### Snippet
```java
 */

public class ZeroBuffer {
    private static final byte[] zeroBytes = new byte[64 * 1024];

```

### UtilityClassWithoutPrivateConstructor
Class `IteratorUtility` has only 'static' members, and lacks a 'private' constructor
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/IteratorUtility.java`
#### Snippet
```java
 * Utility class to merge iterators.
 */
public class IteratorUtility {

    private static final long INVALID_ELEMENT = -1;
```

### UtilityClassWithoutPrivateConstructor
Class `StringUtils` has only 'static' members, and lacks a 'private' constructor
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/StringUtils.java`
#### Snippet
```java
 *
 */
public class StringUtils {

    // Ledger Node Prefix
```

### UtilityClassWithoutPrivateConstructor
Class `ZkUtils` has only 'static' members, and lacks a 'private' constructor
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/ZkUtils.java`
#### Snippet
```java
 * Provided utilites for zookeeper access, etc.
 */
public class ZkUtils {
    private static final Logger LOG = LoggerFactory.getLogger(ZkUtils.class);

```

### UtilityClassWithoutPrivateConstructor
Class `LocalBookiesRegistry` has only 'static' members, and lacks a 'private' constructor
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/LocalBookiesRegistry.java`
#### Snippet
```java
 * Local registry for embedded Bookies.
 */
public class LocalBookiesRegistry {

    private static final ConcurrentHashMap<BookieId, Boolean> localBookiesRegistry =
```

### UtilityClassWithoutPrivateConstructor
Class `BookkeeperInternalCallbacks` has only 'static' members, and lacks a 'private' constructor
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookkeeperInternalCallbacks.java`
#### Snippet
```java
 * not exposed to the client application.
 */
public class BookkeeperInternalCallbacks {

    static final Logger LOG = LoggerFactory.getLogger(BookkeeperInternalCallbacks.class);
```

### UtilityClassWithoutPrivateConstructor
Class `RequestUtils` has only 'static' members, and lacks a 'private' constructor
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/RequestUtils.java`
#### Snippet
```java
 * Utilities for requests.
 */
class RequestUtils {

    public static boolean isFenceRequest(BookkeeperProtocol.ReadRequest readRequest) {
```

### UtilityClassWithoutPrivateConstructor
Class `ResponseBuilder` has only 'static' members, and lacks a 'private' constructor
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/ResponseBuilder.java`
#### Snippet
```java
import io.netty.buffer.ByteBuf;

class ResponseBuilder {
    static BookieProtocol.Response buildErrorResponse(int errorCode, BookieProtocol.Request r) {
        if (r.getOpCode() == BookieProtocol.ADDENTRY) {
```

### UtilityClassWithoutPrivateConstructor
Class `AuthHandler` has only 'static' members, and lacks a 'private' constructor
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/AuthHandler.java`
#### Snippet
```java
import org.slf4j.LoggerFactory;

class AuthHandler {
    static final Logger LOG = LoggerFactory.getLogger(AuthHandler.class);

```

### UtilityClassWithoutPrivateConstructor
Class `PacketHeader` has only 'static' members, and lacks a 'private' constructor
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieProtocol.java`
#### Snippet
```java
     * first int. This handles that case also.
     */
    final class PacketHeader {
        public static int toInt(byte version, byte opCode, short flags) {
            if (version == 0) {
```

### UtilityClassWithoutPrivateConstructor
Class `ZooKeeperServerShimFactory` has only 'static' members, and lacks a 'private' constructor
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/shims/zk/ZooKeeperServerShimFactory.java`
#### Snippet
```java
 * A factory to create zookeeper server.
 */
public class ZooKeeperServerShimFactory {

    public static ZooKeeperServerShim createServer(File snapDir, File logDir, int zkPort, int maxCC)
```

### UtilityClassWithoutPrivateConstructor
Class `BookieProtoEncoding` has only 'static' members, and lacks a 'private' constructor
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieProtoEncoding.java`
#### Snippet
```java
 * A class for encoding and decoding the Bookkeeper protocol.
 */
public class BookieProtoEncoding {
    private static final Logger LOG = LoggerFactory.getLogger(BookieProtoEncoding.class);

```

### UtilityClassWithoutPrivateConstructor
Class `FormatUtil` has only 'static' members, and lacks a 'private' constructor
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookie/FormatUtil.java`
#### Snippet
```java
 * .Provide to format message.
 */
public class FormatUtil {

    private static final Logger LOG = LoggerFactory.getLogger(FormatUtil.class);
```

### UtilityClassWithoutPrivateConstructor
Class `LedgerStorageFactory` has only 'static' members, and lacks a 'private' constructor
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LedgerStorageFactory.java`
#### Snippet
```java
 * A factory that creates {@link LedgerStorage} by reflection.
 */
public class LedgerStorageFactory {
    public static LedgerStorage createLedgerStorage(String name) throws IOException {
        try {
```

### UtilityClassWithoutPrivateConstructor
Class `BookieResources` has only 'static' members, and lacks a 'private' constructor
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieResources.java`
#### Snippet
```java
 * Centralizes the creation of injected resources.
 */
public class BookieResources {
    private static final Logger log = LoggerFactory.getLogger(BookieResources.class);

```

### UtilityClassWithoutPrivateConstructor
Class `FileSystemUpgrade` has only 'static' members, and lacks a 'private' constructor
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/FileSystemUpgrade.java`
#### Snippet
```java
 * Application for upgrading the bookkeeper filesystem between versions.
 */
public class FileSystemUpgrade {
    private static final Logger LOG = LoggerFactory.getLogger(FileSystemUpgrade.class);

```

### UtilityClassWithoutPrivateConstructor
Class `ExitCode` has only 'static' members, and lacks a 'private' constructor
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/ExitCode.java`
#### Snippet
```java
 * Exit code used to exit bookie server.
 */
public class ExitCode {
    // normal quit
    public static final int OK                  = 0;
```

### UtilityClassWithoutPrivateConstructor
Class `ScrubberStats` has only 'static' members, and lacks a 'private' constructor
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/ScrubberStats.java`
#### Snippet
```java
 * Stats associated with the consistency checker.
 */
public class ScrubberStats {
    public static final String SCOPE = "scrubber";

```

### UtilityClassWithoutPrivateConstructor
Class `ArrayUtil` has only 'static' members, and lacks a 'private' constructor
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/ArrayUtil.java`
#### Snippet
```java
 * Utility to serialize/deserialize longs into byte arrays.
 */
class ArrayUtil {

    private static final boolean UNALIGNED = io.netty.util.internal.PlatformDependent.isUnaligned();
```

### UtilityClassWithoutPrivateConstructor
Class `Header` has only 'static' members, and lacks a 'private' constructor
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/Header.java`
#### Snippet
```java
 * </pre>
 */
class Header {
    static final int LOGFILE_LEGACY_HEADER_SIZE = 1024;
    static final int LOGFILE_DIRECT_HEADER_SIZE = Buffer.ALIGNMENT;
```

### UtilityClassWithoutPrivateConstructor
Class `LogReaderScan` has only 'static' members, and lacks a 'private' constructor
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/LogReaderScan.java`
#### Snippet
```java
import org.apache.bookkeeper.bookie.storage.EntryLogScanner;

class LogReaderScan {
    static void scan(LogReader reader, EntryLogScanner scanner) throws IOException {
        int offset = Header.LOGFILE_LEGACY_HEADER_SIZE;
```

### UtilityClassWithoutPrivateConstructor
Class `LogMetadata` has only 'static' members, and lacks a 'private' constructor
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/LogMetadata.java`
#### Snippet
```java
import org.apache.bookkeeper.util.collections.ConcurrentLongLongHashMap.BiConsumerLong;

class LogMetadata {

    /**
```

### UtilityClassWithoutPrivateConstructor
Class `SyncCallbackUtils` has only 'static' members, and lacks a 'private' constructor
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/SyncCallbackUtils.java`
#### Snippet
```java
 */
@Slf4j
class SyncCallbackUtils {

    /**
```

### UtilityClassWithoutPrivateConstructor
Class `LedgerMetadataUtils` has only 'static' members, and lacks a 'private' constructor
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerMetadataUtils.java`
#### Snippet
```java
 * Utilities for working with ledger metadata.
 */
public class LedgerMetadataUtils {
    static final Logger LOG = LoggerFactory.getLogger(LedgerMetadataUtils.class);

```

### UtilityClassWithoutPrivateConstructor
Class `EnsembleUtils` has only 'static' members, and lacks a 'private' constructor
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/EnsembleUtils.java`
#### Snippet
```java
import org.slf4j.LoggerFactory;

class EnsembleUtils {
    private static final Logger LOG = LoggerFactory.getLogger(EnsembleUtils.class);

```

### UtilityClassWithoutPrivateConstructor
Class `Main` has only 'static' members, and lacks a 'private' constructor
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/Main.java`
#### Snippet
```java
 */
@Slf4j
public class Main {
    static final Options BK_OPTS = new Options();
    static {
```

### UtilityClassWithoutPrivateConstructor
Class `BookieServiceInfoUtils` has only 'static' members, and lacks a 'private' constructor
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/discover/BookieServiceInfoUtils.java`
#### Snippet
```java
 * Utility class for {@link BookieServiceInfo}.
 */
public final class BookieServiceInfoUtils {

    /**
```

### UtilityClassWithoutPrivateConstructor
Class `BookkeeperVerifierMain` has only 'static' members, and lacks a 'private' constructor
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifierMain.java`
#### Snippet
```java
 * validating results.
 */
public class BookkeeperVerifierMain {

    private static void printHelpAndExit(Options options, String header, int code) {
```

### UtilityClassWithoutPrivateConstructor
Class `MetastoreUtils` has only 'static' members, and lacks a 'private' constructor
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/metastore/MetastoreUtils.java`
#### Snippet
```java
 * Provides utilities for metastore.
 */
public class MetastoreUtils {

    private static final Logger logger = LoggerFactory.getLogger(MetastoreUtils.class);
```

### UtilityClassWithoutPrivateConstructor
Class `MetastoreFactory` has only 'static' members, and lacks a 'private' constructor
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/metastore/MetastoreFactory.java`
#### Snippet
```java
 *  Metastore Factory.
 */
public class MetastoreFactory {

    public static MetaStore createMetaStore(String name)
```

### UtilityClassWithoutPrivateConstructor
Class `EtcdClientUtils` has only 'static' members, and lacks a 'private' constructor
in `metadata-drivers/etcd/src/main/java/io/etcd/jetcd/EtcdClientUtils.java`
#### Snippet
```java
 * Utils to access fields in Etcd client.
 */
class EtcdClientUtils {

    @SuppressWarnings("unchecked")
```

### UtilityClassWithoutPrivateConstructor
Class `HttpServerLoader` has only 'static' members, and lacks a 'private' constructor
in `bookkeeper-http/http-server/src/main/java/org/apache/bookkeeper/http/HttpServerLoader.java`
#### Snippet
```java
 * Class to load and instantiate http server from config.
 */
public class HttpServerLoader {

    static final Logger LOG = LoggerFactory.getLogger(HttpServerLoader.class);
```

### UtilityClassWithoutPrivateConstructor
Class `NativeUtils` has only 'static' members, and lacks a 'private' constructor
in `circe-checksum/src/main/java/com/scurrilous/circe/utils/NativeUtils.java`
#### Snippet
```java
 * Utils for loading native checksum library.
 */
public class NativeUtils {

    public static final String OS_NAME = System.getProperty("os.name").toLowerCase(Locale.US);
```

### UtilityClassWithoutPrivateConstructor
Class `Crc32cIntChecksum` has only 'static' members, and lacks a 'private' constructor
in `circe-checksum/src/main/java/com/scurrilous/circe/checksum/Crc32cIntChecksum.java`
#### Snippet
```java
import io.netty.buffer.ByteBuf;

public class Crc32cIntChecksum {

    private final static IntHash CRC32C_HASH;
```

### UtilityClassWithoutPrivateConstructor
Class `BookKeeperAccessor` has only 'static' members, and lacks a 'private' constructor
in `stream/distributedlog/core/src/main/java/org/apache/bookkeeper/client/BookKeeperAccessor.java`
#### Snippet
```java
 * Accessor to protected methods in bookkeeper.
 */
public class BookKeeperAccessor {

    public static LedgerManager getLedgerManager(BookKeeper bk) {
```

### UtilityClassWithoutPrivateConstructor
Class `DistributedLogConstants` has only 'static' members, and lacks a 'private' constructor
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/DistributedLogConstants.java`
#### Snippet
```java
 * Constants used in DistributedLog.
 */
public class DistributedLogConstants {
    public static final byte[] EMPTY_BYTES = new byte[0];
    public static final String SCHEME_PREFIX = "distributedlog";
```

### UtilityClassWithoutPrivateConstructor
Class `Entry` has only 'static' members, and lacks a 'private' constructor
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/Entry.java`
#### Snippet
```java
 * A set of {@link LogRecord}s.
 */
public class Entry {

    /**
```

### UtilityClassWithoutPrivateConstructor
Class `EnvelopedEntry` has only 'static' members, and lacks a 'private' constructor
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/EnvelopedEntry.java`
#### Snippet
```java
 *      11      : Unused
 */
class EnvelopedEntry {

    public static final byte VERSION_ONE = 1;
```

### UtilityClassWithoutPrivateConstructor
Class `ReadUtils` has only 'static' members, and lacks a 'private' constructor
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/ReadUtils.java`
#### Snippet
```java
 * Utility function for readers.
 */
public class ReadUtils {

    static final Logger LOG = LoggerFactory.getLogger(ReadUtils.class);
```

### UtilityClassWithoutPrivateConstructor
Class `LedgerAllocatorUtils` has only 'static' members, and lacks a 'private' constructor
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/LedgerAllocatorUtils.java`
#### Snippet
```java
 * LedgerAllocator utilities.
 */
public class LedgerAllocatorUtils {

    /**
```

### UtilityClassWithoutPrivateConstructor
Class `NetUtils` has only 'static' members, and lacks a 'private' constructor
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/net/NetUtils.java`
#### Snippet
```java
 * Utils about network.
 */
public class NetUtils {

    /**
```

### UtilityClassWithoutPrivateConstructor
Class `ZKLogSegmentFilters` has only 'static' members, and lacks a 'private' constructor
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/ZKLogSegmentFilters.java`
#### Snippet
```java
 * Filters based on current zookeeper log segments.
 */
public class ZKLogSegmentFilters {

    static final Logger LOG = LoggerFactory.getLogger(ZKLogSegmentFilters.class);
```

### UtilityClassWithoutPrivateConstructor
Class `BKUtils` has only 'static' members, and lacks a 'private' constructor
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/logsegment/BKUtils.java`
#### Snippet
```java
 * BookKeeper Util Functions.
 */
public class BKUtils {

    /**
```

### UtilityClassWithoutPrivateConstructor
Class `RetryPolicyUtils` has only 'static' members, and lacks a 'private' constructor
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/util/RetryPolicyUtils.java`
#### Snippet
```java
 * Utils for {@link org.apache.bookkeeper.zookeeper.RetryPolicy}.
 */
public class RetryPolicyUtils {

    /**
```

### UtilityClassWithoutPrivateConstructor
Class `CommandLineUtils` has only 'static' members, and lacks a 'private' constructor
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/util/CommandLineUtils.java`
#### Snippet
```java
 * Utils to commandline.
 */
public class CommandLineUtils {

    public static Optional<String> getOptionalStringArg(CommandLine cmdline, String arg) {
```

### UtilityClassWithoutPrivateConstructor
Class `FailpointUtils` has only 'static' members, and lacks a 'private' constructor
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/util/FailpointUtils.java`
#### Snippet
```java
 * Utils to Failpoint.
 */
public class FailpointUtils {
    private static final Logger logger = LoggerFactory.getLogger(FailpointUtils.class);

```

### UtilityClassWithoutPrivateConstructor
Class `ConfUtils` has only 'static' members, and lacks a 'private' constructor
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/util/ConfUtils.java`
#### Snippet
```java
 * Utils to conf.
 */
public class ConfUtils {

    /**
```

### UtilityClassWithoutPrivateConstructor
Class `DLUtils` has only 'static' members, and lacks a 'private' constructor
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/util/DLUtils.java`
#### Snippet
```java
 * Utilities about DL implementations like uri, log segments, metadata serialization and deserialization.
 */
public class DLUtils {

    /**
```

### UtilityClassWithoutPrivateConstructor
Class `MetadataIndex` has only 'static' members, and lacks a 'private' constructor
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/metadata/ZKLogStreamMetadataStore.java`
#### Snippet
```java
    //

    static class MetadataIndex {
        static final int LOG_ROOT_PARENT = 0;
        static final int LOG_ROOT = 1;
```

### UtilityClassWithoutPrivateConstructor
Class `Utils` has only 'static' members, and lacks a 'private' constructor
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/util/Utils.java`
#### Snippet
```java
 */
@Slf4j
public class Utils {

    /**
```

### UtilityClassWithoutPrivateConstructor
Class `MurmurHash` has only 'static' members, and lacks a 'private' constructor
in `stream/common/src/main/java/org/apache/bookkeeper/common/hash/MurmurHash.java`
#### Snippet
```java
 * </p>
 */
public class MurmurHash {

    /**
```

### UtilityClassWithoutPrivateConstructor
Class `Bytes` has only 'static' members, and lacks a 'private' constructor
in `stream/common/src/main/java/org/apache/bookkeeper/common/util/Bytes.java`
#### Snippet
```java
 * Bytes related utils.
 */
public class Bytes {

    /**
```

### UtilityClassWithoutPrivateConstructor
Class `VarInt` has only 'static' members, and lacks a 'private' constructor
in `stream/common/src/main/java/org/apache/bookkeeper/common/util/VarInt.java`
#### Snippet
```java
 * All negative ints are encoded using 5 bytes, longs take 10 bytes.
 */
public class VarInt {

    private static long convertIntToLongNoSignExtend(int v) {
```

### UtilityClassWithoutPrivateConstructor
Class `Murmur3` has only 'static' members, and lacks a 'private' constructor
in `stream/common/src/main/java/org/apache/bookkeeper/common/hash/Murmur3.java`
#### Snippet
```java
 * to their code."
 */
public class Murmur3 {
    // Constants for 32 bit variant
    private static final int C1_32 = 0xcc9e2d51;
```

### UtilityClassWithoutPrivateConstructor
Class `NativeIOJni` has only 'static' members, and lacks a 'private' constructor
in `native-io/src/main/java/org/apache/bookkeeper/common/util/nativeio/NativeIOJni.java`
#### Snippet
```java
import org.apache.commons.lang3.SystemUtils;

class NativeIOJni {

    static native int open(String pathname, int flags, int mode) throws NativeIOException;
```

### UtilityClassWithoutPrivateConstructor
Class `BenchBookie` has only 'static' members, and lacks a 'private' constructor
in `bookkeeper-benchmark/src/main/java/org/apache/bookkeeper/benchmark/BenchBookie.java`
#### Snippet
```java
 * A utility class used for benchmarking the performance of bookies.
 */
public class BenchBookie {
    static final Logger LOG = LoggerFactory.getLogger(BenchBookie.class);

```

### UtilityClassWithoutPrivateConstructor
Class `BenchReadThroughputLatency` has only 'static' members, and lacks a 'private' constructor
in `bookkeeper-benchmark/src/main/java/org/apache/bookkeeper/benchmark/BenchReadThroughputLatency.java`
#### Snippet
```java
 * A benchmark that benchmarks the read throughput and latency.
 */
public class BenchReadThroughputLatency {
    static final Logger LOG = LoggerFactory.getLogger(BenchReadThroughputLatency.class);

```

### UtilityClassWithoutPrivateConstructor
Class `Bytes` has only 'static' members, and lacks a 'private' constructor
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/Bytes.java`
#### Snippet
```java
 * Bytes related utils.
 */
public class Bytes {

    /**
```

### UtilityClassWithoutPrivateConstructor
Class `TestClient` has only 'static' members, and lacks a 'private' constructor
in `bookkeeper-benchmark/src/main/java/org/apache/bookkeeper/benchmark/TestClient.java`
#### Snippet
```java
 * BookKeeper and to the local file system.
 */
public class TestClient {
    private static final Logger LOG = LoggerFactory.getLogger(TestClient.class);

```

### UtilityClassWithoutPrivateConstructor
Class `ReflectionUtils` has only 'static' members, and lacks a 'private' constructor
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/ReflectionUtils.java`
#### Snippet
```java
 * General Class Reflection Utils.
 */
public class ReflectionUtils {

    private static final Map<Class<?>, Constructor<?>> constructorCache =
```

### UtilityClassWithoutPrivateConstructor
Class `ExecutorUtils` has only 'static' members, and lacks a 'private' constructor
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/ExecutorUtils.java`
#### Snippet
```java
 * Executor/Thread related utils.
 */
public class ExecutorUtils {

    /**
```

### UtilityClassWithoutPrivateConstructor
Class `Backoff` has only 'static' members, and lacks a 'private' constructor
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/Backoff.java`
#### Snippet
```java
 * retried.
 */
public class Backoff {

    public static final Policy DEFAULT = Jitter.of(
```

### UtilityClassWithoutPrivateConstructor
Class `MdcUtils` has only 'static' members, and lacks a 'private' constructor
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/MdcUtils.java`
#### Snippet
```java
 * Utils for work with Slf4j MDC.
 */
public class MdcUtils {

    public static void restoreContext(Map<String, String> mdcContextMap) {
```

### UtilityClassWithoutPrivateConstructor
Class `StreamUtil` has only 'static' members, and lacks a 'private' constructor
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/StreamUtil.java`
#### Snippet
```java
 * Java {@link java.util.stream.Stream} related operations.
 */
public class StreamUtil {

    public static <T1, T2, R> Stream<R> zip(Stream<? extends T1> a,
```

### UtilityClassWithoutPrivateConstructor
Class `ComponentStarter` has only 'static' members, and lacks a 'private' constructor
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/component/ComponentStarter.java`
#### Snippet
```java
 */
@Slf4j
public class ComponentStarter {

    static class ComponentShutdownHook implements Runnable {
```

### UtilityClassWithoutPrivateConstructor
Class `BroadCastStatsLogger` has only 'static' members, and lacks a 'private' constructor
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/stats/BroadCastStatsLogger.java`
#### Snippet
```java
 * Stats Loggers that broadcast stats to multiple {@link StatsLogger}.
 */
public class BroadCastStatsLogger {

    /**
```

### UtilityClassWithoutPrivateConstructor
Class `JsonUtil` has only 'static' members, and lacks a 'private' constructor
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/JsonUtil.java`
#### Snippet
```java
 * Util class which helps to parse Json to and from Object.
 */
public class JsonUtil {

    private static ObjectMapper mapper = new ObjectMapper();
```

## RuleId[id=DataFlowIssue]
### DataFlowIssue
Method invocation `getValue` may produce `NullPointerException`
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/sc/DefaultStorageContainerController.java`
#### Snippet
```java
        for (Long containerId : containersToReassign) {
            Pair<BookieId, LinkedList<Long>> leastLoadedServer = assignmentQueue.pollFirst();
            leastLoadedServer.getValue().add(containerId);
            assignmentQueue.add(leastLoadedServer);
        }
```

### DataFlowIssue
Method invocation `getValue` may produce `NullPointerException`
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/sc/DefaultStorageContainerController.java`
#### Snippet
```java

            // move container from mostLoaded to leastLoaded
            Long containerId = mostLoaded.getValue().removeFirst();
            // add the container to the end to avoid balancing this container again.
            leastLoaded.getValue().addLast(containerId);
```

### DataFlowIssue
Method invocation `getValue` may produce `NullPointerException`
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/sc/DefaultStorageContainerController.java`
#### Snippet
```java
            Long containerId = mostLoaded.getValue().removeFirst();
            // add the container to the end to avoid balancing this container again.
            leastLoaded.getValue().addLast(containerId);

            assignmentQueue.add(leastLoaded);
```

### DataFlowIssue
The call to 'checkArgument' always fails, according to its method contracts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/LedgerMetadataSerDe.java`
#### Snippet
```java
                break;
            default:
                checkArgument(false,
                              String.format("Unknown state %s for protobuf serialization", metadata.getState()));
                break;
```

### DataFlowIssue
The call to 'checkArgument' always fails, according to its method contracts
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/LedgerMetadataSerDe.java`
#### Snippet
```java
                    break;
                default:
                    checkArgument(false,
                                  String.format("Unknown state %s for protobuf serialization", metadata.getState()));
                    break;
```

### DataFlowIssue
Method invocation `getSubject` may produce `NullPointerException`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/sasl/SASLClientProviderFactory.java`
#### Snippet
```java

            this.login = loginClient();
            this.subject = login.getSubject();
            this.isKrbTicket = !subject.getPrivateCredentials(KerberosTicket.class).isEmpty();
            boolean systemRole = CLIENT_ROLE_SYSTEM.equals(clientConfiguration.getClientRole());
```

### DataFlowIssue
Method invocation `getSubject` may produce `NullPointerException`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/sasl/SASLBookieAuthProviderFactory.java`
#### Snippet
```java

            this.login = loginServer();
            this.subject = login.getSubject();
            this.isKrbTicket = !subject.getPrivateCredentials(KerberosTicket.class).isEmpty();
            if (isKrbTicket) {
```

### DataFlowIssue
Casting `msg` to `BookieProtocol.Request` will produce `ClassCastException` for any non-null value
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieRequestProcessor.java`
#### Snippet
```java
            }
        } else {
            BookieProtocol.Request r = (BookieProtocol.Request) msg;
            // process packet
            switch (r.getOpCode()) {
```

### DataFlowIssue
Method invocation `getOpCode` will produce `NullPointerException`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieRequestProcessor.java`
#### Snippet
```java
            BookieProtocol.Request r = (BookieProtocol.Request) msg;
            // process packet
            switch (r.getOpCode()) {
                case BookieProtocol.ADDENTRY:
                    checkArgument(r instanceof BookieProtocol.ParsedAddRequest);
```

### DataFlowIssue
Variable is already assigned to this value
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
                if (channel != null && state == ConnectionState.CONNECTED) {
                    completeOpNow = true;
                    opRc = BKException.Code.OK;
                } else if (state == ConnectionState.CLOSED) {
                    completeOpNow = true;
```

### DataFlowIssue
Variable is already assigned to this value
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/IndexInMemPageMgr.java`
#### Snippet
```java
            }
            while (lruCleanPageMap.size() > 0) {
                lep = null;
                synchronized (lruCleanPageMap) {
                    Iterator<Map.Entry<EntryKey, LedgerEntryPage>> iterator = lruCleanPageMap.entrySet().iterator();
```

### DataFlowIssue
Argument `fileName` might be null
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/DefaultEntryLogger.java`
#### Snippet
```java
        }
        try {
            return Long.parseLong(fileName, 16);
        } catch (Exception nfe) {
            LOG.error("Invalid log file name {} found when trying to convert to logId.", fileName, nfe);
```

### DataFlowIssue
Method invocation `getName` may produce `NullPointerException`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/DefaultEntryLogger.java`
#### Snippet
```java

        File compactingLogFile = getCurCompactionLogFile();
        long compactionLogId = fileName2LogId(compactingLogFile.getName());
        File compactedLogFile = compactedLogFileFromCompacting(compactingLogFile, logToCompact);
        File finalLogFile = new File(compactingLogFile.getParentFile(),
```

### DataFlowIssue
Method invocation `close` may produce `NullPointerException`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectEntryLogger.java`
#### Snippet
```java
            RemovalListener<Integer, LogReader> rl = (notification) -> {
                try {
                    notification.getValue().close();
                    this.stats.getCloseReaderCounter().inc();
                } catch (IOException ioe) {
```

### DataFlowIssue
Method invocation `getBookies` may produce `NullPointerException`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookieInfoReader.java`
#### Snippet
```java
                    }
                    try {
                        Collection<BookieId> updatedBookies = bk.bookieWatcher.getBookies();
                        bookieInfoMap.updateBookies(updatedBookies);
                    } catch (BKException e) {
```

### DataFlowIssue
Method invocation `updateBookieInfo` may produce `NullPointerException`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookieInfoReader.java`
#### Snippet
```java

    void onExit() {
        bk.placementPolicy.updateBookieInfo(bookieInfoMap.getBookieMap());
        if (errorCnt > 0) {
            if (LOG.isInfoEnabled()) {
```

### DataFlowIssue
Method invocation `getBookies` may produce `NullPointerException`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookieInfoReader.java`
#### Snippet
```java

        Collection<BookieId> bookies;
        bookies = bk.bookieWatcher.getBookies();
        bookies.addAll(bk.bookieWatcher.getReadOnlyBookies());
        if (bookies.isEmpty()) {
```

### DataFlowIssue
Unboxing of `SyncCallbackUtils.waitForResult(callback)` may produce `NullPointerException`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
        asyncAddEntry(data, offset, length, callback, null);

        return SyncCallbackUtils.waitForResult(callback);
    }

```

### DataFlowIssue
Method invocation `nextElement` may produce `NullPointerException`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
            asyncReadEntries(lastEntryId, lastEntryId, new SyncReadCallback(result), null);

            return SyncCallbackUtils.waitForResult(result).nextElement();
        }
    }
```

### DataFlowIssue
Variable is already assigned to this value
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
                    }
                } else {
                    writableResult = false;
                    break;
                }
```

### DataFlowIssue
Unboxing of `FutureUtils.`result(appendAsync(data), BKException.HANDLER) may produce `NullPointerException`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/api/WriteHandle.java`
#### Snippet
```java
     */
    default long append(ByteBuf data) throws BKException, InterruptedException {
        return FutureUtils.<Long, BKException>result(appendAsync(data), BKException.HANDLER);
    }

```

### DataFlowIssue
Unboxing of `FutureUtils.`result(writeAsync(entryId, data), BKException.HANDLER) may produce `NullPointerException`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/api/WriteAdvHandle.java`
#### Snippet
```java
     */
    default long write(long entryId, ByteBuf data) throws BKException, InterruptedException {
        return FutureUtils.<Long, BKException>result(writeAsync(entryId, data), BKException.HANDLER);
    }
}
```

### DataFlowIssue
Unboxing of `FutureUtils.`result(readLastAddConfirmedAsync(), ... may produce `NullPointerException`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/api/ReadHandle.java`
#### Snippet
```java
     */
    default long readLastAddConfirmed() throws BKException, InterruptedException {
        return FutureUtils.<Long, BKException>result(readLastAddConfirmedAsync(),
                                                     BKException.HANDLER);
    }

```

### DataFlowIssue
Unboxing of `FutureUtils.`result(tryReadLastAddConfirmedAsync(), ... may produce `NullPointerException`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/api/ReadHandle.java`
#### Snippet
```java
     */
    default long tryReadLastAddConfirmed() throws BKException, InterruptedException {
        return FutureUtils.<Long, BKException>result(tryReadLastAddConfirmedAsync(),
                                                     BKException.HANDLER);
    }

```

### DataFlowIssue
Argument `ensemble` might be null
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerCreateOp.java`
#### Snippet
```java
            .withEnsembleSize(actualEnsembleSize).withWriteQuorumSize(writeQuorumSize).withAckQuorumSize(ackQuorumSize)
            .withDigestType(digestType.toApiDigestType()).withPassword(passwd);
        metadataBuilder.newEnsembleEntry(0L, ensemble);
        if (customMetadata != null) {
            metadataBuilder.withCustomMetadata(customMetadata);
```

### DataFlowIssue
Method invocation `getValue` may produce `NullPointerException`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookieWatcherImpl.java`
#### Snippet
```java
    public Set<BookieId> getAllBookies() throws BKException {
        try {
            return FutureUtils.result(registrationClient.getAllBookies(), EXCEPTION_FUNC).getValue();
        } catch (BKInterruptedException ie) {
            Thread.currentThread().interrupt();
```

### DataFlowIssue
Method invocation `getValue` may produce `NullPointerException`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookieWatcherImpl.java`
#### Snippet
```java
    public Set<BookieId> getBookies() throws BKException {
        try {
            return FutureUtils.result(registrationClient.getWritableBookies(), EXCEPTION_FUNC).getValue();
        } catch (BKInterruptedException ie) {
            Thread.currentThread().interrupt();
```

### DataFlowIssue
Method invocation `getValue` may produce `NullPointerException`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookieWatcherImpl.java`
#### Snippet
```java
            throws BKException {
        try {
            return FutureUtils.result(registrationClient.getReadOnlyBookies(), EXCEPTION_FUNC).getValue();
        } catch (BKInterruptedException ie) {
            Thread.currentThread().interrupt();
```

### DataFlowIssue
Method invocation `isEmpty` may produce `NullPointerException`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ZoneawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
            }
        }
        if (bookiesToConsiderAfterExcludingZonesAndUDs.isEmpty()) {
            zonesToExclude = getZonesToExcludeToMaintainMinZones(currentEnsemble, bookieToReplaceIndex,
                    writeQuorumSize);
```

### DataFlowIssue
Method invocation `createRegistrationManager` may produce `NullPointerException`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/EmbeddedServer.java`
#### Snippet
```java

            if (registrationManager == null) {
                registrationManager = metadataDriver.createRegistrationManager();
                serverBuilder.addComponent(
                        new AutoCloseableLifecycleComponent("registrationManager", registrationManager));
```

### DataFlowIssue
Method invocation `getLedgerManagerFactory` may produce `NullPointerException`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/EmbeddedServer.java`
#### Snippet
```java
            // 3. Build ledger manager
            if (ledgerManagerFactory == null) {
                ledgerManagerFactory = metadataDriver.getLedgerManagerFactory();
                serverBuilder.addComponent(new AutoCloseableLifecycleComponent("lmFactory", ledgerManagerFactory));
            }
```

### DataFlowIssue
Method invocation `hasOption` may produce `NullPointerException`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifierMain.java`
#### Snippet
```java
        }

        if (cmd.hasOption("help")) {
            printHelpAndExit(options, "Help:", 0);
        }
```

### DataFlowIssue
Method invocation `getValue` may produce `NullPointerException`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/discover/ZKRegistrationManager.java`
#### Snippet
```java
            if (availableNodeExists) {
                Collection<BookieId> rwBookies = FutureUtils
                        .result(regClient.getWritableBookies(), EXCEPTION_FUNC).getValue();
                if (rwBookies != null && !rwBookies.isEmpty()) {
                    log.error("Bookies are still up and connected to this cluster, "
```

### DataFlowIssue
Method invocation `getValue` may produce `NullPointerException`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/discover/ZKRegistrationManager.java`
#### Snippet
```java
                if (readonlyNodeExists) {
                    Collection<BookieId> roBookies = FutureUtils
                            .result(regClient.getReadOnlyBookies(), EXCEPTION_FUNC).getValue();
                    if (roBookies != null && !roBookies.isEmpty()) {
                        log.error("Readonly Bookies are still up and connected to this cluster, "
```

### DataFlowIssue
Dereference of `errors.poll()` may produce `NullPointerException`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
                e.printStackTrace();
            }
            throw errors.poll();
        }
    }
```

### DataFlowIssue
Method invocation `getNextRandom` may produce `NullPointerException`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RackawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
                    break;
                }
                n = wRSelection.getNextRandom();
                bookiesSeenSoFar.add(n);
            } else {
```

### DataFlowIssue
Method invocation `getNextRandom` may produce `NullPointerException`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RackawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
                        break;
                    }
                    n = wRSelection.getNextRandom();
                    bookiesSeenSoFar.add(n);
                } else {
```

### DataFlowIssue
Method invocation `getNextRandom` may produce `NullPointerException`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RackawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
                    break;
                }
                bookie = wRSelection.getNextRandom();
                bookiesSeenSoFar.add(bookie);
            } else {
```

### DataFlowIssue
Method invocation `submit` may produce `NullPointerException`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeperAdmin.java`
#### Snippet
```java
                                return;
                            }
                            bkc.mainWorkerPool.submit(() -> {
                                // do recovery
                                recoverLedger(bookiesSrc, lId, dryrun, skipOpenLedgers,
```

### DataFlowIssue
Method invocation `nextElement` may produce `NullPointerException`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeperAdmin.java`
#### Snippet
```java
                        new SyncReadCallback(result), null, false);

                    currentEntry = SyncCallbackUtils.waitForResult(result).nextElement();

                    return true;
```

### DataFlowIssue
Method invocation `getResponseCase` may produce `NullPointerException`
in `stream/clients/java/kv/src/main/java/org/apache/bookkeeper/clients/impl/kv/KvUtils.java`
#### Snippet
```java
        result.isSuccess(txnResponse.getSucceeded());
        result.results(Lists.transform(txnResponse.getResponsesList(), op -> {
            switch (op.getResponseCase()) {
                case RESPONSE_PUT:
                    return newPutResult(
```

### DataFlowIssue
Argument `kv` might be null
in `stream/clients/java/kv/src/main/java/org/apache/bookkeeper/clients/impl/kv/KvUtils.java`
#### Snippet
```java
    public static List<org.apache.bookkeeper.api.kv.result.KeyValue<ByteBuf, ByteBuf>> fromProtoKeyValues(
        List<KeyValue> kvs, KeyValueFactory<ByteBuf, ByteBuf> kvFactory) {
        return Lists.transform(kvs, kv -> fromProtoKeyValue(kv, kvFactory));
    }

```

### DataFlowIssue
Argument `filename` might be null
in `cpu-affinity/src/main/java/org/apache/bookkeeper/common/util/affinity/impl/NativeUtils.java`
#### Snippet
```java
        }
        dir.deleteOnExit();
        File temp = new File(dir, filename);
        temp.deleteOnExit();

```

### DataFlowIssue
Argument `filename` might be null
in `circe-checksum/src/main/java/com/scurrilous/circe/utils/NativeUtils.java`
#### Snippet
```java
        }
        dir.deleteOnExit();
        File temp = new File(dir, filename);
        temp.deleteOnExit();

```

### DataFlowIssue
Method invocation `checkReadLock` may produce `NullPointerException`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAsyncLogReader.java`
#### Snippet
```java
        if (lockStream) {
            try {
                readHandler.checkReadLock();
            } catch (IOException ex) {
                setLastException(ex);
```

### DataFlowIssue
Method invocation `asyncWrite` may produce `NullPointerException`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAsyncLogWriter.java`
#### Snippet
```java
            }
        } else {
            result = w.asyncWrite(record, flush);
        }
        // use map here rather than onSuccess because we want lastTxId to be updated before
```

### DataFlowIssue
Variable is already assigned to this value
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogWriteHandler.java`
#### Snippet
```java

            if (null == nextLogSegmentSeqNo) {
                logSegmentsFound = false;
                // we don't find last assigned log segment sequence number
                // then we start the log segment with configured FirstLogSegmentSequenceNumber.
```

### DataFlowIssue
Method invocation `release` may produce `NullPointerException`
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/logsegment/BKLogSegmentEntryReader.java`
#### Snippet
```java
                skippedBrokenEntriesCounter.inc();
                CacheEntry removedEntry = readAheadEntries.poll();
                removedEntry.release();
                continue;
            } else {
```

### DataFlowIssue
Method invocation `length` may produce `NullPointerException`
in `stream/common/src/main/java/org/apache/bookkeeper/common/grpc/stats/ServerStats.java`
#### Snippet
```java
            String fullMethodName = methodDescriptor.getFullMethodName();
            String serviceName = MethodDescriptor.extractFullServiceName(fullMethodName);
            String methodName = fullMethodName.substring(serviceName.length() + 1);

            MethodType type = methodDescriptor.getType();
```

### DataFlowIssue
Method invocation `length` may produce `NullPointerException`
in `stream/common/src/main/java/org/apache/bookkeeper/common/grpc/stats/ClientStats.java`
#### Snippet
```java
            String fullMethodName = methodDescriptor.getFullMethodName();
            String serviceName = MethodDescriptor.extractFullServiceName(fullMethodName);
            String methodName = fullMethodName.substring(serviceName.length() + 1);

            MethodType type = methodDescriptor.getType();
```

### DataFlowIssue
@Nullable method 'apply' always returns a non-null value
in `stream/common/src/main/java/org/apache/bookkeeper/common/resolver/ServiceNameResolverProvider.java`
#### Snippet
```java
                    hostList,
                    new Function<String, URI>() {
                        @Nullable
                        @Override
                        public URI apply(@Nullable String host) {
```

### DataFlowIssue
Argument `checkpointedDir.listFiles()` might be null
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/CheckpointFile.java`
#### Snippet
```java
    public static List<CheckpointFile> list(File checkpointedDir) {
        // List for files from checkpoint folder
        return Arrays.stream(checkpointedDir.listFiles())
            .map(f -> CheckpointFile.builder()
                .file(f)
```

### DataFlowIssue
Dereference of `checkpoints` may produce `NullPointerException`
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/RocksCheckpointer.java`
#### Snippet
```java
        File checkpointsDir = new File(dbPath, "checkpoints");
        String[] checkpoints = checkpointsDir.list();
        for (String checkpoint : checkpoints) {
            if (checkpoint.equals(checkpointToExclude)) {
                continue;
```

### DataFlowIssue
Method invocation `toString` may produce `NullPointerException`
in `bookkeeper-slogger/slf4j/src/main/java/org/apache/bookkeeper/slogger/slf4j/Slf4jSlogger.java`
#### Snippet
```java
            }

            String msg = message == null ? event.toString() : message;
            switch (level) {
            case INFO:
```

### DataFlowIssue
Method invocation `getLeft` may produce `NullPointerException`
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/mvcc/MVCCStoreImpl.java`
#### Snippet
```java
        } else {
            Pair<byte[], byte[]> realRange = getRealRange(rawKey, rawEndKey);
            rawKey = realRange.getLeft();
            rawEndKey = realRange.getRight();

```

### DataFlowIssue
Method invocation `getLeft` may produce `NullPointerException`
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/mvcc/MVCCStoreImpl.java`
#### Snippet
```java
        }
        Pair<byte[], byte[]> realRange = getRealRange(rawKey, rawEndKey);
        rawKey = realRange.getLeft();
        rawEndKey = realRange.getRight();

```

### DataFlowIssue
Method invocation `getRight` may produce `NullPointerException`
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/mvcc/MVCCStoreImpl.java`
#### Snippet
```java
            } else {
                Pair<byte[], byte[]> realRange = getRealRange(key, endKey);
                endKey = realRange.getRight();
                ++endKey[endKey.length - 1];
                batch.deleteRange(realRange.getLeft(), endKey);
```

### DataFlowIssue
Method invocation `compareModRev` may produce `NullPointerException`
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/mvcc/MVCCStoreImpl.java`
#### Snippet
```java
        switch (op.target()) {
            case MOD:
                cmp = record.compareModRev(op.revision());
                break;
            case CREATE:
```

### DataFlowIssue
Method invocation `compareCreateRev` may produce `NullPointerException`
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/mvcc/MVCCStoreImpl.java`
#### Snippet
```java
                break;
            case CREATE:
                cmp = record.compareCreateRev(op.revision());
                break;
            case VERSION:
```

### DataFlowIssue
Method invocation `compareVersion` may produce `NullPointerException`
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/mvcc/MVCCStoreImpl.java`
#### Snippet
```java
                break;
            case VERSION:
                cmp = record.compareVersion(op.revision());
                break;
            case VALUE:
```

## RuleId[id=DeprecatedIsStillUsed]
### DeprecatedIsStillUsed
Deprecated member 'setZkLedgersRootPath' is still used
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/AbstractConfiguration.java`
#### Snippet
```java
     */
    @Deprecated
    public void setZkLedgersRootPath(String zkLedgersPath) {
        setProperty(ZK_LEDGERS_ROOT_PATH, zkLedgersPath);
    }
```

### DeprecatedIsStillUsed
Deprecated member 'setZkServers' is still used
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/AbstractConfiguration.java`
#### Snippet
```java
     */
    @Deprecated
    public T setZkServers(String zkServers) {
        setProperty(ZK_SERVERS, zkServers);
        return getThis();
```

### DeprecatedIsStillUsed
Deprecated member 'setLedgerManagerType' is still used
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/AbstractConfiguration.java`
#### Snippet
```java
     */
    @Deprecated
    public void setLedgerManagerType(String lmType) {
        setProperty(LEDGER_MANAGER_TYPE, lmType);
    }
```

### DeprecatedIsStillUsed
Deprecated member 'getLedgerManagerType' is still used
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/AbstractConfiguration.java`
#### Snippet
```java
     */
    @Deprecated
    public String getLedgerManagerType() {
        return getString(LEDGER_MANAGER_TYPE);
    }
```

### DeprecatedIsStillUsed
Deprecated member 'getZkLedgersRootPath' is still used
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/AbstractConfiguration.java`
#### Snippet
```java
     */
    @Deprecated
    public String getZkLedgersRootPath() {
        return getString(ZK_LEDGERS_ROOT_PATH, "/ledgers");
    }
```

### DeprecatedIsStillUsed
Deprecated member 'getZkServers' is still used
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/AbstractConfiguration.java`
#### Snippet
```java
     */
    @Deprecated
    public String getZkServers() {
        List servers = getList(ZK_SERVERS, null);
        if (null == servers || 0 == servers.size()) {
```

### DeprecatedIsStillUsed
Deprecated member 'getJournalDirName' is still used
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/ServerConfiguration.java`
#### Snippet
```java
     */
    @Deprecated
    public String getJournalDirName() {
        return this.getString(JOURNAL_DIR, "/tmp/bk-txn");
    }
```

### DeprecatedIsStillUsed
Deprecated member 'getCompactionRate' is still used
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/ServerConfiguration.java`
#### Snippet
```java
     */
    @Deprecated
    public int getCompactionRate() {
        return getInt(COMPACTION_RATE, 1000);
    }
```

### DeprecatedIsStillUsed
Deprecated member 'setNumJournalCallbackThreads' is still used
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/ServerConfiguration.java`
#### Snippet
```java
     */
    @Deprecated
    public ServerConfiguration setNumJournalCallbackThreads(int numThreads) {
        setProperty(NUM_JOURNAL_CALLBACK_THREADS, numThreads);
        return this;
```

### DeprecatedIsStillUsed
Deprecated member 'CLIENT_TLS_TRUSTSTORE_PASSWORD_PATH' is still used
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/ClientConfiguration.java`
#### Snippet
```java
     */
    @Deprecated
    protected static final String CLIENT_TLS_TRUSTSTORE_PASSWORD_PATH = "clientTrustStorePasswordPath";

    // NIO Parameters
```

### DeprecatedIsStillUsed
Deprecated member 'CLIENT_TLS_KEYSTORE' is still used
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/ClientConfiguration.java`
#### Snippet
```java
     */
    @Deprecated
    protected static final String CLIENT_TLS_KEYSTORE = "clientKeyStore";

    /**
```

### DeprecatedIsStillUsed
Deprecated member 'CLIENT_TLS_KEYSTORE_PASSWORD_PATH' is still used
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/ClientConfiguration.java`
#### Snippet
```java
     */
    @Deprecated
    protected static final String CLIENT_TLS_KEYSTORE_PASSWORD_PATH = "clientKeyStorePasswordPath";

    /**
```

### DeprecatedIsStillUsed
Deprecated member 'CLIENT_TLS_KEYSTORE_TYPE' is still used
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/ClientConfiguration.java`
#### Snippet
```java
     */
    @Deprecated
    protected static final String CLIENT_TLS_KEYSTORE_TYPE = "clientKeyStoreType";

    /**
```

### DeprecatedIsStillUsed
Deprecated member 'setNettyUsePooledBuffers' is still used
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/ClientConfiguration.java`
#### Snippet
```java
     * @see LedgerHandle#readEntries(long, long)
     */
    public ClientConfiguration setNettyUsePooledBuffers(boolean enabled) {
        setProperty(NETTY_USE_POOLED_BUFFERS, enabled);
        return this;
```

### DeprecatedIsStillUsed
Deprecated member 'getReadTimeout' is still used
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/ClientConfiguration.java`
#### Snippet
```java
     */
    @Deprecated
    public int getReadTimeout() {
        return getInt(READ_TIMEOUT, 5);
    }
```

### DeprecatedIsStillUsed
Deprecated member 'CLIENT_TLS_TRUSTSTORE' is still used
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/ClientConfiguration.java`
#### Snippet
```java
     */
    @Deprecated
    protected static final String CLIENT_TLS_TRUSTSTORE = "clientTrustStore";

    /**
```

### DeprecatedIsStillUsed
Deprecated member 'setReadTimeout' is still used
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/ClientConfiguration.java`
#### Snippet
```java
     */
    @Deprecated
    public ClientConfiguration setReadTimeout(int timeout) {
        setProperty(READ_TIMEOUT, Integer.toString(timeout));
        return this;
```

### DeprecatedIsStillUsed
Deprecated member 'CLIENT_TLS_TRUSTSTORE_TYPE' is still used
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/ClientConfiguration.java`
#### Snippet
```java
     */
    @Deprecated
    protected static final String CLIENT_TLS_TRUSTSTORE_TYPE = "clientTrustStoreType";

    /**
```

### DeprecatedIsStillUsed
Deprecated member 'ConcurrentLongHashSet' is still used
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentLongHashSet.java`
#### Snippet
```java

    @Deprecated
    public ConcurrentLongHashSet(int expectedItems, int concurrencyLevel) {
        this(expectedItems, concurrencyLevel, DefaultMapFillFactor, DefaultMapIdleFactor,
                DefaultAutoShrink, DefaultExpandFactor, DefaultShrinkFactor);
```

### DeprecatedIsStillUsed
Deprecated member 'THROTTLED_WRITE_REQUESTS' is still used
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/DbLedgerStorageStats.java`
#### Snippet
```java

    @Deprecated
    private static final String THROTTLED_WRITE_REQUESTS = "throttled-write-requests";
    // throttled-write-requests is deprecated, use new metric: throttled-write
    private static final String THROTTLED_WRITE = "throttled-write";
```

### DeprecatedIsStillUsed
Deprecated member 'MSLedgerManagerFactory' is still used
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/MSLedgerManagerFactory.java`
#### Snippet
```java
 */
@Slf4j
public class MSLedgerManagerFactory extends AbstractZkLedgerManagerFactory {

    private static final Logger LOG = LoggerFactory.getLogger(MSLedgerManagerFactory.class);
```

### DeprecatedIsStillUsed
Deprecated member 'ConcurrentLongLongHashMap' is still used
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentLongLongHashMap.java`
#### Snippet
```java

    @Deprecated
    public ConcurrentLongLongHashMap(int expectedItems, int concurrencyLevel) {
        this(expectedItems, concurrencyLevel, DefaultMapFillFactor, DefaultMapIdleFactor,
                DefaultAutoShrink, DefaultExpandFactor, DefaultShrinkFactor);
```

### DeprecatedIsStillUsed
Deprecated member 'ConcurrentLongLongPairHashMap' is still used
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentLongLongPairHashMap.java`
#### Snippet
```java

    @Deprecated
    public ConcurrentLongLongPairHashMap(int expectedItems, int concurrencyLevel) {
        this(expectedItems, concurrencyLevel, DefaultMapFillFactor, DefaultMapIdleFactor,
                DefaultAutoShrink, DefaultExpandFactor, DefaultShrinkFactor);
```

### DeprecatedIsStillUsed
Deprecated member 'setEventLoopGroup' is still used
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeper.java`
#### Snippet
```java
         */
        @Deprecated
        public Builder setEventLoopGroup(EventLoopGroup f) {
            eventLoopGroup = f;
            return this;
```

### DeprecatedIsStillUsed
Deprecated member 'setStatsLogger' is still used
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeper.java`
#### Snippet
```java
         */
        @Deprecated
        public Builder setStatsLogger(StatsLogger statsLogger) {
            this.statsLogger = statsLogger;
            return this;
```

### DeprecatedIsStillUsed
Deprecated member 'setZookeeper' is still used
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeper.java`
#### Snippet
```java
         */
        @Deprecated
        public Builder setZookeeper(ZooKeeper zk) {
            this.zk = zk;
            return this;
```

### DeprecatedIsStillUsed
Deprecated member 'getBKClientWriteTimeout' is still used
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/DistributedLogConfiguration.java`
#### Snippet
```java
     * @see ClientConfiguration#getAddEntryTimeout()
     */
    public int getBKClientWriteTimeout() {
        return this.getInt(BKDL_BKCLIENT_WRITE_TIMEOUT, BKDL_BKCLIENT_WRITE_TIMEOUT_DEFAULT);
    }
```

### DeprecatedIsStillUsed
Deprecated member 'setBKClientReadTimeout' is still used
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/DistributedLogConfiguration.java`
#### Snippet
```java
     * @see #getBKClientReadTimeout()
     */
    public DistributedLogConfiguration setBKClientReadTimeout(int readTimeout) {
        setProperty(BKDL_BKCLIENT_READ_TIMEOUT, readTimeout);
        return this;
```

### DeprecatedIsStillUsed
Deprecated member 'setBKClientWriteTimeout' is still used
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/DistributedLogConfiguration.java`
#### Snippet
```java
     * @see #getBKClientWriteTimeout()
     */
    public DistributedLogConfiguration setBKClientWriteTimeout(int writeTimeout) {
        setProperty(BKDL_BKCLIENT_WRITE_TIMEOUT, writeTimeout);
        return this;
```

### DeprecatedIsStillUsed
Deprecated member 'getEnablePerStreamStat' is still used
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/DistributedLogConfiguration.java`
#### Snippet
```java
     * @return flag to enable per stream stat.
     */
    public boolean getEnablePerStreamStat() {
        return getBoolean(BKDL_ENABLE_PERSTREAM_STAT, BKDL_ENABLE_PERSTREAM_STAT_DEFAULT);
    }
```

### DeprecatedIsStillUsed
Deprecated member 'getBKClientNumberWorkerThreads' is still used
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/DistributedLogConfiguration.java`
#### Snippet
```java
     * @see ClientConfiguration#getNumWorkerThreads()
     */
    public int getBKClientNumberWorkerThreads() {
        return this.getInt(BKDL_BKCLIENT_NUM_WORKER_THREADS, BKDL_BKCLEINT_NUM_WORKER_THREADS_DEFAULT);
    }
```

### DeprecatedIsStillUsed
Deprecated member 'getBKClientReadTimeout' is still used
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/DistributedLogConfiguration.java`
#### Snippet
```java
     * @see ClientConfiguration#getReadEntryTimeout()
     */
    public int getBKClientReadTimeout() {
        return this.getInt(BKDL_BKCLIENT_READ_TIMEOUT,
                BKDL_BKCLIENT_READ_TIMEOUT_DEFAULT);
```

### DeprecatedIsStillUsed
Deprecated member 'MetadataAccessor' is still used
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/api/MetadataAccessor.java`
#### Snippet
```java
@LimitedPrivate
@Evolving
public interface MetadataAccessor extends Closeable, AsyncCloseable {
    /**
     * Get the name of the stream managed by this log manager.
```

## RuleId[id=Convert2MethodRef]
### Convert2MethodRef
Lambda can be replaced with method reference
in `stream/clients/java/base/src/main/java/org/apache/bookkeeper/clients/impl/internal/MetaRangeClientImpl.java`
#### Snippet
```java
        return MetaRangeRequestProcessor.of(
            createGetActiveRangesRequest(streamProps),
            (response) -> createActiveRanges(response),
            scClient,
            executor,
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `stream/clients/java/base/src/main/java/org/apache/bookkeeper/clients/impl/internal/LocationClientImpl.java`
#### Snippet
```java
    @VisibleForTesting
    static final Predicate<Throwable> LOCATE_STORAGE_CONTAINERS_RETRY_PREDICATE =
        cause -> shouldRetryOnException(cause);

    private static boolean shouldRetryOnException(Throwable cause) {
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `stream/clients/java/base/src/main/java/org/apache/bookkeeper/clients/impl/internal/RootRangeClientImplWithRetries.java`
#### Snippet
```java
    @VisibleForTesting
    static final Predicate<Throwable> ROOT_RANGE_CLIENT_RETRY_PREDICATE =
        cause -> shouldRetryOnException(cause);

    private static boolean shouldRetryOnException(Throwable cause) {
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `stream/clients/java/base/src/main/java/org/apache/bookkeeper/clients/impl/internal/StorageServerClientManagerImpl.java`
#### Snippet
```java
            return FutureUtils.value(client);
        }
        return getStreamProperties(streamId).thenApply(props -> openMetaRangeClient(props));
    }

```

### Convert2MethodRef
Lambda can be replaced with method reference
in `stream/clients/java/base/src/main/java/org/apache/bookkeeper/clients/impl/channel/StorageServerChannel.java`
#### Snippet
```java
                    settings.endpointResolver());
                return interceptor
                    .map(interceptor -> channel.intercept(interceptor))
                    .orElse(channel);
            }
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `stream/clients/java/base/src/main/java/org/apache/bookkeeper/clients/impl/container/StorageContainerChannel.java`
#### Snippet
```java
            new Object[]{scId, cause.getMessage(), ClientConstants.DEFAULT_BACKOFF_START_MS});
        executor.schedule(() -> {
            fetchStorageContainerInfo();
        }, ClientConstants.DEFAULT_BACKOFF_START_MS, TimeUnit.MILLISECONDS);
    }
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `stream/clients/java/base/src/main/java/org/apache/bookkeeper/clients/utils/RetryUtils.java`
#### Snippet
```java
    @VisibleForTesting
    static final Predicate<Throwable> DEFAULT_CLIENT_RETRY_PREDICATE =
        cause -> shouldRetryOnException(cause);

    private static boolean shouldRetryOnException(Throwable cause) {
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/kv/TableStoreCache.java`
#### Snippet
```java

    public TableStoreCache(MVCCStoreFactory mvccStoreFactory) {
        this(mvccStoreFactory, store -> new TableStoreImpl(store));
    }

```

### Convert2MethodRef
Lambda can be replaced with method reference
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/sc/StorageContainerImpl.java`
#### Snippet
```java
                                          Collection<ServerServiceDefinition> services) {
        InProcessServerBuilder builder = InProcessServerBuilder.forName(serverName);
        services.forEach(service -> builder.addService(service));
        return builder
            .directExecutor()
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/sc/ZkStorageContainerManager.java`
#### Snippet
```java
    public void accept(Void aVoid) {
        // any time if the cluster assignment data is changed, schedule a probe task
        this.executor.submit(() -> probeContainers());
    }
}
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/routing/RangeRoutingTableImpl.java`
#### Snippet
```java
        FutureUtils.proxyTo(
            manager.openMetaRangeClient(streamId)
                .thenCompose(metaRangeClient -> metaRangeClient.getActiveDataRanges())
                .thenApply(hashStreamRanges -> {
                    RangeRouter<byte[]> router = new RangeRouter<>(BytesHashRouter.of());
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/service/RangeStoreServiceImpl.java`
#### Snippet
```java
                store, rangePlacementPolicy, scheduler.chooseThread(scId)),
            store -> new MetaRangeStoreImpl(store, rangePlacementPolicy, scheduler.chooseThread(scId), clientManager),
            store -> new TableStoreImpl(store));
    }

```

### Convert2MethodRef
Lambda can be replaced with method reference
in `stream/distributedlog/common/src/main/java/org/apache/distributedlog/io/AsyncAbortable.java`
#### Snippet
```java
    Function<AsyncAbortable, CompletableFuture<Void>> ABORT_FUNC = abortable -> abortable.asyncAbort();

    AsyncAbortable NULL = () -> FutureUtils.Void();

    /**
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `stream/distributedlog/common/src/main/java/org/apache/distributedlog/io/AsyncAbortable.java`
#### Snippet
```java
public interface AsyncAbortable {

    Function<AsyncAbortable, CompletableFuture<Void>> ABORT_FUNC = abortable -> abortable.asyncAbort();

    AsyncAbortable NULL = () -> FutureUtils.Void();
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `stream/distributedlog/common/src/main/java/org/apache/distributedlog/io/AsyncCloseable.java`
#### Snippet
```java
public interface AsyncCloseable {

    Function<AsyncCloseable, CompletableFuture<Void>> CLOSE_FUNC = closeable -> closeable.asyncClose();

    Function<AsyncCloseable, CompletableFuture<Void>> CLOSE_FUNC_IGNORE_ERRORS =
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `stream/distributedlog/common/src/main/java/org/apache/distributedlog/io/AsyncCloseable.java`
#### Snippet
```java
        closeable -> FutureUtils.ignore(closeable.asyncClose());

    AsyncCloseable NULL = () -> FutureUtils.Void();

    /**
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/metadata/stream/MetaRangeImpl.java`
#### Snippet
```java
                if (isStreamCreated(lifecycleState)) {
                    supplier.get()
                        .thenApplyAsync(value -> future.complete(value), executor)
                        .exceptionally(cause -> future.completeExceptionally(cause));
                } else {
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/metadata/stream/MetaRangeImpl.java`
#### Snippet
```java
                    supplier.get()
                        .thenApplyAsync(value -> future.complete(value), executor)
                        .exceptionally(cause -> future.completeExceptionally(cause));
                } else {
                    throw new IllegalStateException("Stream isn't created yet.");
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `stats/bookkeeper-stats-providers/prometheus-metrics-provider/src/main/java/org/apache/bookkeeper/stats/prometheus/PrometheusMetricsProvider.java`
#### Snippet
```java

        executor.scheduleAtFixedRate(() -> {
            rotateLatencyCollection();
        }, 1, latencyRolloverSeconds, TimeUnit.SECONDS);

```

### Convert2MethodRef
Lambda can be replaced with method reference
in `stream/server/src/main/java/org/apache/bookkeeper/stream/cluster/StreamCluster.java`
#### Snippet
```java
        List<Future<LifecycleComponent>> startFutures = Lists.newArrayList();
        for (int i = 0; i < spec.numServers(); i++) {
            Future<LifecycleComponent> future = executor.submit(() -> startServer());
            startFutures.add(future);
        }
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `stream/server/src/main/java/org/apache/bookkeeper/stream/cluster/StreamCluster.java`
#### Snippet
```java
            "bk://%s/",
            getRpcEndpoints().stream()
                .map(endpoint -> NetUtils.endpointToString(endpoint))
                .collect(Collectors.joining(",")));
        StorageClientSettings settings = StorageClientSettings.newBuilder()
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/AbstractZkLedgerManager.java`
#### Snippet
```java
                }
                readLedgerMetadata(ledgerId, AbstractZkLedgerManager.this)
                    .whenComplete((metadata, exception) -> handleMetadata(metadata, exception));
            } else if (LOG.isDebugEnabled()) {
                LOG.debug("Ledger metadata listener for ledger {} is already removed.", ledgerId);
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/LongZkLedgerIdGenerator.java`
#### Snippet
```java
                    }
                })
            .filter((t) -> t != null)
            .reduce(Math::max);

```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/LongZkLedgerIdGenerator.java`
#### Snippet
```java
                            }
                        })
                    .filter((t) -> t != null)
                    .sorted()
                    .toArray();
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/SynchronizedHashMultiMap.java`
#### Snippet
```java
                    return removed;
                }).sum();
        map.values().removeIf((s) -> s.isEmpty());
        return removedSum;
    }
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/SynchronizedHashMultiMap.java`
#### Snippet
```java

    public synchronized Optional<K> getAnyKey() {
        return map.values().stream().findAny().flatMap(pairs -> pairs.stream().findAny().map(p -> p.getLeft()));
    }

```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/SynchronizedHashMultiMap.java`
#### Snippet
```java
        Set<Pair<K, V>> set = map.getOrDefault(k.hashCode(), Collections.emptySet());
        Optional<Pair<K, V>> pair = set.stream().filter(p -> p.getLeft().equals(k)).findAny();
        pair.ifPresent(p -> set.remove(p));
        return pair.map(p -> p.getRight());
    }
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/SynchronizedHashMultiMap.java`
#### Snippet
```java
        Optional<Pair<K, V>> pair = set.stream().filter(p -> p.getLeft().equals(k)).findAny();
        pair.ifPresent(p -> set.remove(p));
        return pair.map(p -> p.getRight());
    }

```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentOpenHashSet.java`
#### Snippet
```java
    List<V> values() {
        List<V> values = Lists.newArrayList();
        forEach(value -> values.add(value));
        return values;
    }
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieClientImpl.java`
#### Snippet
```java
        if (conf.getAddEntryTimeout() > 0 || conf.getReadEntryTimeout() > 0) {
            this.timeoutFuture = this.scheduler.scheduleAtFixedRate(
                    () -> monitorPendingOperations(),
                    conf.getTimeoutMonitorIntervalSec(),
                    conf.getTimeoutMonitorIntervalSec(),
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
        } else {
            // If there's no completion object here, try in the multimap
            completionObjectsV2Conflicts.removeAny(key).ifPresent(c -> c.errorOut());
        }
    }
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookies/InfoCommand.java`
#### Snippet
```java
                .collect(Collectors.toMap(
                    entry -> entry.getKey().toString(),
                    entry -> entry.getValue(),
                    (key1, key2) -> key2
                ));
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/GarbageCollectorThread.java`
#### Snippet
```java
            () -> numActiveEntryLogs,
            () -> totalEntryLogSize,
            () -> garbageCollector.getNumActiveLedgers()
        );

```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LegacyCookieValidation.java`
#### Snippet
```java
                    }
                    return Arrays.stream(dirs.toArray(new String[]{}));
                }).map((s) -> new File(s)).collect(Collectors.toSet());
    }

```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Journal.java`
#### Snippet
```java
        // Expose Stats
        this.journalStats = new JournalStats(journalStatsLogger, journalMaxMemory,
                () -> memoryLimitController.currentUsage());
    }

```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LastAddConfirmedUpdateNotification.java`
#### Snippet
```java
public class LastAddConfirmedUpdateNotification implements Recyclable {

    public static final Function<Long, LastAddConfirmedUpdateNotification> FUNC = lac -> of(lac);

    public static final RecyclableArrayList.Recycler<Watcher<LastAddConfirmedUpdateNotification>> WATCHER_RECYCLER =
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieShell.java`
#### Snippet
```java
            RegenerateInterleavedStorageIndexFileCommand.RISIFFlags
                flags = new RegenerateInterleavedStorageIndexFileCommand.RISIFFlags();
            List<Long> ledgerIds = Arrays.stream(cmdLine.getOptionValues("ledgerIds")).map((id) -> Long.parseLong(id))
                                         .collect(Collectors.toList());
            boolean dryRun = cmdLine.hasOption("dryRun");
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/IndexPersistenceMgr.java`
#### Snippet
```java
        persistenceMgrStats = new IndexPersistenceMgrStats(
            statsLogger,
            () -> writeFileInfoCache.size(),
            () -> readFileInfoCache.size()
        );
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/IndexPersistenceMgr.java`
#### Snippet
```java
            statsLogger,
            () -> writeFileInfoCache.size(),
            () -> readFileInfoCache.size()
        );
    }
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieImpl.java`
#### Snippet
```java

        // register shutdown handler using trigger mode
        stateManager.setShutdownHandler(exitCode -> triggerBookieShutdown(exitCode));
        // Initialise dirsMonitor. This would look through all the
        // configured directories. When disk errors or all the ledger
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/KeyValueStorageRocksDB.java`
#### Snippet
```java

    static KeyValueStorageFactory factory = (defaultBasePath, subPath, dbConfigType, conf) ->
            new KeyValueStorageRocksDB(defaultBasePath, subPath, dbConfigType, conf);

    private final RocksDB db;
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/directentrylogger/DirectEntryLogger.java`
#### Snippet
```java
        return EntryLogIdsImpl.logIdsInDirectory(ledgerDir).stream()
            .filter(logId -> !unflushedLogs.contains(logId))
            .map(i -> Long.valueOf(i))
            .collect(Collectors.toList());
    }
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/SingleDirectoryDbLedgerStorage.java`
#### Snippet
```java
            () -> writeCache.size() + writeCacheBeingFlushed.size(),
            () -> writeCache.count() + writeCacheBeingFlushed.count(),
            () -> readCache.size(),
            () -> readCache.count()
        );
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/SingleDirectoryDbLedgerStorage.java`
#### Snippet
```java
            () -> writeCache.count() + writeCacheBeingFlushed.count(),
            () -> readCache.size(),
            () -> readCache.count()
        );

```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerMetadataImpl.java`
#### Snippet
```java
        helper.add("customMetadata",
                   customMetadata.entrySet().stream().collect(
                           Collectors.toMap(e -> e.getKey(),
                                            e -> "base64:" + Base64.getEncoder().encodeToString(e.getValue()))));
        return helper.toString();
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/MSLedgerManagerFactory.java`
#### Snippet
```java
                    }
                    readLedgerMetadata(ledgerId).whenComplete(
                            (metadata, exception) -> handleMetadata(metadata, exception));
                } else {
                    if (LOG.isDebugEnabled()) {
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/datainteg/EntryCopierImpl.java`
#### Snippet
```java
            .collect(ImmutableSortedMap.toImmutableSortedMap(
                             Comparator.naturalOrder(),
                             e -> e.getKey(),
                             e -> {
                                 List<BookieId> ensemble = e.getValue();
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/datainteg/EntryCopierImpl.java`
#### Snippet
```java
                                 int myIndex = ensemble.indexOf(bookieId);
                                 Set<Integer> errorIndices = errorBookies.stream()
                                     .map(b -> ensemble.indexOf(b)).collect(Collectors.toSet());

                                 // turn bookies into positions and filter out my own
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/datainteg/EntryCopierImpl.java`
#### Snippet
```java
                        ImmutableSortedMap.toImmutableSortedMap(
                                Comparator.naturalOrder(),
                                e -> e.getKey(),
                                e -> new WriteSets(e.getValue(),
                                                   metadata.getEnsembleSize(),
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/collections/ConcurrentLongLongHashMap.java`
#### Snippet
```java
    public Map<Long, Long> asMap() {
        Map<Long, Long> map = Maps.newHashMap();
        forEach((key, value) -> map.put(key, value));
        return map;
    }
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/datainteg/DataIntegrityCheckImpl.java`
#### Snippet
```java
            .entrySet().stream()
            .collect(ImmutableSortedMap.toImmutableSortedMap(Comparator.naturalOrder(),
                                                             e -> e.getKey(),
                                                             e -> e.getValue().indexOf(bookieId)));

```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/datainteg/DataIntegrityCheckImpl.java`
#### Snippet
```java
                        1 /* copy 1 ledger at a time to keep entries together in entrylog */)
                .collect(Collectors.toSet())
                .subscribe(resolved -> promise.complete(resolved),
                        throwable -> promise.completeExceptionally(throwable));
        promise.whenComplete((result, ex) -> disposable.dispose());
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/datainteg/DataIntegrityCheckImpl.java`
#### Snippet
```java
                .collect(Collectors.toSet())
                .subscribe(resolved -> promise.complete(resolved),
                        throwable -> promise.completeExceptionally(throwable));
        promise.whenComplete((result, ex) -> disposable.dispose());
        return promise;
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/datainteg/DataIntegrityCheckImpl.java`
#### Snippet
```java
                                    }
                                }
                                Optional<Throwable> firstError = resolved.stream().filter(r -> r.isError())
                                    .map(r -> r.getThrowable()).findFirst();

```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/datainteg/DataIntegrityCheckImpl.java`
#### Snippet
```java
                                }
                                Optional<Throwable> firstError = resolved.stream().filter(r -> r.isError())
                                    .map(r -> r.getThrowable()).findFirst();

                                if (firstError.isPresent()) {
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/datainteg/DataIntegrityCheckImpl.java`
#### Snippet
```java
                                            + ", error: {}, missing: {}, ledgersToRetry: {}",
                                            Events.FULL_CHECK_END, runId,
                                            resolved.stream().filter(r -> r.isOK()).count(),
                                            resolved.stream().filter(r -> r.isError()).count(),
                                            resolved.stream().filter(r -> r.isMissing()).count(),
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/datainteg/DataIntegrityCheckImpl.java`
#### Snippet
```java
                                            Events.FULL_CHECK_END, runId,
                                            resolved.stream().filter(r -> r.isOK()).count(),
                                            resolved.stream().filter(r -> r.isError()).count(),
                                            resolved.stream().filter(r -> r.isMissing()).count(),
                                            ledgers.size(), firstError.get());
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/datainteg/DataIntegrityCheckImpl.java`
#### Snippet
```java
                                            resolved.stream().filter(r -> r.isOK()).count(),
                                            resolved.stream().filter(r -> r.isError()).count(),
                                            resolved.stream().filter(r -> r.isMissing()).count(),
                                            ledgers.size(), firstError.get());
                                } else {
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/datainteg/DataIntegrityCheckImpl.java`
#### Snippet
```java
                                    log.info("Event: {}, runId: {}, ok: {}, error: 0, missing: {}, ledgersToRetry: {}",
                                            Events.FULL_CHECK_END, runId,
                                            resolved.stream().filter(r -> r.isOK()).count(),
                                            resolved.stream().filter(r -> r.isMissing()).count(),
                                            ledgers.size());
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/datainteg/DataIntegrityCheckImpl.java`
#### Snippet
```java
                                            Events.FULL_CHECK_END, runId,
                                            resolved.stream().filter(r -> r.isOK()).count(),
                                            resolved.stream().filter(r -> r.isMissing()).count(),
                                            ledgers.size());
                                }
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookieInfoReader.java`
#### Snippet
```java

    private void submitTaskWithDelay(int delaySeconds) {
        scheduler.schedule(() -> getReadWriteBookieInfo(), delaySeconds, TimeUnit.SECONDS);
    }

```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookieInfoReader.java`
#### Snippet
```java

    private void submitTask() {
        scheduler.submit(() -> getReadWriteBookieInfo());
    }

```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
        if (clientCtx.getConf().addEntryQuorumTimeoutNanos > 0) {
            this.timeoutFuture = clientCtx.getScheduler().scheduleAtFixedRate(
                    () -> monitorPendingAddOps(),
                    clientCtx.getConf().timeoutMonitorIntervalSec,
                    clientCtx.getConf().timeoutMonitorIntervalSec,
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ZoneawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
        }

        this.dnsResolver = new DNSResolverDecorator(actualDNSResolver, () -> this.getDefaultFaultDomain(),
                failedToResolveNetworkLocationCounter);
        dnsResolver.setBookieAddressResolver(bookieAddressResolver);
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RackawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
        this.stabilizePeriodSeconds = stabilizePeriodSeconds;
        this.reorderThresholdPendingRequests = reorderThresholdPendingRequests;
        this.dnsResolver = new DNSResolverDecorator(dnsResolver, () -> this.getDefaultRack(),
                failedToResolveNetworkLocationCounter);
        this.timer = timer;
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdRegistrationClient.java`
#### Snippet
```java
                return FutureUtils.Void();
            } else {
                consumer = bookies -> listener.onBookiesChanged(bookies);
                listeners.put(listener, consumer);
            }
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeper.java`
#### Snippet
```java
        if (conf.isBookieHealthCheckEnabled()) {
            scheduler.scheduleAtFixedRate(
                    () -> checkForFaultyBookies(),
                    conf.getBookieHealthCheckIntervalSeconds(),
                    conf.getBookieHealthCheckIntervalSeconds(),
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeper.java`
#### Snippet
```java
        CompletableFuture<Versioned<LedgerMetadata>> versioned = getLedgerManager().readLedgerMetadata(ledgerId);
        return versioned.thenApply(versionedLedgerMetadata -> {
            return versionedLedgerMetadata.getValue();
        });
    }
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `stream/clients/java/all/src/main/java/org/apache/bookkeeper/clients/SimpleStorageClientImpl.java`
#### Snippet
```java
                                                                String table) {
        return openPTable(namespaceName, table)
            .thenApply(pTable -> new ByteBufTableImpl(pTable));
    }

```

### Convert2MethodRef
Lambda can be replaced with method reference
in `stream/clients/java/all/src/main/java/org/apache/bookkeeper/clients/StorageClientImpl.java`
#### Snippet
```java
                                                                String table) {
        return openPTable(namespaceName, table)
            .thenApply(pTable -> new ByteBufTableImpl(pTable));
    }

```

### Convert2MethodRef
Lambda can be replaced with method reference
in `stream/clients/java/kv/src/main/java/org/apache/bookkeeper/clients/impl/kv/PByteBufTableImpl.java`
#### Snippet
```java
            .openMetaRangeClient(props)
            .getActiveDataRanges()
            .thenComposeAsync((ranges) -> refreshRangeSpaces(ranges), executor);
    }

```

### Convert2MethodRef
Lambda can be replaced with method reference
in `stats/utils/src/main/java/org/apache/bookkeeper/stats/utils/StatsDocGenerator.java`
#### Snippet
```java
                .stream()
                .collect(Collectors.toMap(
                    e -> e.getKey(),
                    e -> e.getValue().entrySet()
                        .stream()
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `stats/utils/src/main/java/org/apache/bookkeeper/stats/utils/StatsDocGenerator.java`
#### Snippet
```java
                        .stream()
                        .collect(Collectors.toMap(
                            e1 -> e1.getKey(),
                            e1 -> e1.getValue().properties()
                        ))
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAsyncLogWriter.java`
#### Snippet
```java
            return FutureUtils.value(getLastTxId());
        }
        return writerFuture.thenCompose(writer -> writer.flushAndCommit());
    }

```

### Convert2MethodRef
Lambda can be replaced with method reference
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAsyncLogWriter.java`
#### Snippet
```java

        return FutureUtils.stats(
                logSegmentWriterFuture.thenCompose(w -> w.markEndOfStream()),
                markEndOfStreamOpStatsLogger,
                stopwatch);
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/ReadAheadEntryReader.java`
#### Snippet
```java
    //
    private final Function<LogSegmentEntryReader, CompletableFuture<List<Entry.Reader>>> readFunc;
    private final Runnable removeClosedSegmentReadersFunc = () -> removeClosedSegmentReaders();

    //
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/ReadAheadEntryReader.java`
#### Snippet
```java
            }
            return FutureUtils.ensure(
                openFuture.thenCompose(reader1 -> reader1.asyncClose()),
                () -> {
                    synchronized (SegmentReader.this) {
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogWriteHandler.java`
#### Snippet
```java
        }
        return FutureUtils.processList(logs,
            segment -> deleteLogSegment(segment), scheduler);
    }

```

### Convert2MethodRef
Lambda can be replaced with method reference
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogHandler.java`
#### Snippet
```java
                            }
                        }
                        return FutureUtils.collect(futureCounts).thenApply(counts -> sum(counts));
                    }
                });
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/LedgerAllocatorPool.java`
#### Snippet
```java
        return FutureUtils.processList(
            allocatorsToClose,
            allocator -> allocator.asyncClose(),
            scheduledExecutorService
        ).thenApply(values -> null);
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/LedgerAllocatorPool.java`
#### Snippet
```java
        return FutureUtils.processList(
            allocatorsToDelete,
            allocator -> allocator.delete(),
            scheduledExecutorService
        ).thenCompose(values -> Utils.zkDelete(zkc, poolPath, new LongVersion(-1)));
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/federated/FederatedZKLogMetadataStore.java`
#### Snippet
```java
        }
        return postStateCheck(retrieveLogs().thenApply(
            resultList -> getIterator(resultList)));
    }

```

### Convert2MethodRef
Lambda can be replaced with method reference
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKDistributedLogManager.java`
#### Snippet
```java
            }
        });
        return dlsnPromise.thenCompose(dlsn -> openAsyncLogReader(dlsn));
    }

```

### Convert2MethodRef
Lambda can be replaced with method reference
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKDistributedLogManager.java`
#### Snippet
```java

    static final Function<LogRecordWithDLSN, DLSN> RECORD_2_DLSN_FUNCTION =
        record -> record.getDlsn();

    private final URI uri;
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKDistributedLogManager.java`
#### Snippet
```java
                null
        )
        .thenApply((versionedList) -> versionedList.getValue())
        .whenComplete((value, cause) -> readHandler.asyncClose());
    }
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKDistributedLogManager.java`
#### Snippet
```java

    static final Function<LogRecordWithDLSN, Long> RECORD_2_TXID_FUNCTION =
        record -> record.getTransactionId();

    static final Function<LogRecordWithDLSN, DLSN> RECORD_2_DLSN_FUNCTION =
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/lock/ZKDistributedLock.java`
#### Snippet
```java
                return;
            }
            lockStateExecutor.executeOrdered(lockPath, () -> asyncClose());
        });
        final Stopwatch stopwatch = Stopwatch.createStarted();
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/StateStores.java`
#### Snippet
```java
    public static <K, V> Supplier<KVAsyncStore<K, V>> kvAsyncStoreSupplier(Supplier<Namespace> logNamespaceSupplier) {
        return () ->
            new RocksdbKVAsyncStore<>(() -> new RocksdbKVStore<>(), logNamespaceSupplier);
    }

```

### Convert2MethodRef
Lambda can be replaced with method reference
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/StateStores.java`
#### Snippet
```java
    public static <K, V> Supplier<KVStore<K, V>> kvStoreSupplier() {
        return () ->
            new RocksdbKVStore<>();
    }

```

### Convert2MethodRef
Lambda can be replaced with method reference
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/mvcc/MVCCStores.java`
#### Snippet
```java
    public static Supplier<MVCCAsyncStore<byte[], byte[]>> bytesStoreSupplier(Supplier<Namespace> nsSupplier) {
        return () -> new MVCCAsyncBytesStoreImpl(
            () -> new MVCCStoreImpl<>(),
            nsSupplier
        );
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/RocksdbCheckpointTask.java`
#### Snippet
```java
        // delete unused ssts
        Set<String> sstsToKeep = filesToKeep.stream()
            .filter(f -> f.isSstFile())
            .map(f -> f.getNameWithChecksum())
            .collect(Collectors.toSet());
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/RocksdbCheckpointTask.java`
#### Snippet
```java
        Set<String> sstsToKeep = filesToKeep.stream()
            .filter(f -> f.isSstFile())
            .map(f -> f.getNameWithChecksum())
            .collect(Collectors.toSet());
        if (checkpointChecksumCompatible) {
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/RocksdbCheckpointTask.java`
#### Snippet
```java
            // If we are running in compatible mode, we need to retain sst files without checksum suffix.
            Set<String> files = filesToKeep.stream()
                .filter(f -> f.isSstFile())
                .map(f -> f.getName())
                .collect(Collectors.toSet());
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/RocksdbCheckpointTask.java`
#### Snippet
```java
            Set<String> files = filesToKeep.stream()
                .filter(f -> f.isSstFile())
                .map(f -> f.getName())
                .collect(Collectors.toSet());
            sstsToKeep.addAll(files);
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/journal/AbstractStateStoreWithJournal.java`
#### Snippet
```java
            long checkpointIntervalMs = checkpointInterval.toMillis();
            checkpointTask = writeIOScheduler.scheduleAtFixedRate(
                () -> localStore.checkpoint(),
                checkpointIntervalMs,
                checkpointIntervalMs,
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/journal/AbstractStateStoreWithJournal.java`
#### Snippet
```java
            return initializeLocalStore(spec)
                .thenComposeAsync(ignored -> getLastDLSN(spec), writeIOScheduler)
                .thenComposeAsync(endDLSN -> replayJournal(endDLSN), writeIOScheduler);
        } else {
            return initializeLocalStore(spec)
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/Backoff.java`
#### Snippet
```java
    public interface Policy {

        Policy NONE = () -> Stream.empty();

        /**
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/conf/ConfigDef.java`
#### Snippet
```java
            checkArgument(
                Sets.difference(
                    groups.stream().map(group -> group.name()).collect(Collectors.toSet()),
                    settings.keySet()
                ).isEmpty(),
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/conf/ConfigDef.java`
#### Snippet
```java
        this.keys = settings.values()
            .stream()
            .flatMap(keys -> keys.stream())
            .collect(Collectors.toSet())
            .stream()
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/conf/ConfigDef.java`
#### Snippet
```java
            .stream()
            .collect(Collectors.toMap(
                key -> key.name(),
                key -> key
            ));
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/component/LifecycleComponentStack.java`
#### Snippet
```java
    @Override
    public void stop() {
        components.reverse().forEach(component -> component.stop());
    }

```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/component/LifecycleComponentStack.java`
#### Snippet
```java
        componentInfoPublisher.startupFinished();

        components.forEach(component -> component.start());
    }

```

### Convert2MethodRef
Lambda can be replaced with method reference
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/component/LifecycleComponentStack.java`
#### Snippet
```java
    @Override
    public void close() {
        components.reverse().forEach(component -> component.close());
    }

```

## RuleId[id=AbstractMethodCallInConstructor]
### AbstractMethodCallInConstructor
Call to 'abstract' method `getMacCodeLength()` during object construction
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/checksum/DigestManager.java`
#### Snippet
```java
        this.ledgerId = ledgerId;
        this.useV2Protocol = useV2Protocol;
        this.macCodeLength = getMacCodeLength();
        this.allocator = allocator;
    }
```

## RuleId[id=NonSerializableFieldInSerializableClass]
### NonSerializableFieldInSerializableClass
Non-serializable field 'bookieId' in a Serializable class
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieAddressResolver.java`
#### Snippet
```java
     */
    class BookieIdNotResolvedException extends RuntimeException {
        private final BookieId bookieId;

        public BookieIdNotResolvedException(BookieId bookieId, Throwable cause) {
```

## RuleId[id=MismatchedJavadocCode]
### MismatchedJavadocCode
Method is specified to return 'true' but its return type is not boolean
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/MetadataClientDriver.java`
#### Snippet
```java
     * Return health check is enable or disable.
     *
     * @return true if health check is enable, otherwise false.
     */
    default CompletableFuture<Boolean> isHealthCheckEnabled() {
```

### MismatchedJavadocCode
Method is specified to return 'true' but its return type is not boolean
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/MetadataBookieDriver.java`
#### Snippet
```java
     * Return health check is enable or disable.
     *
     * @return true if health check is enable, otherwise false.
     */
    default CompletableFuture<Boolean>  isHealthCheckEnabled() {
```

### MismatchedJavadocCode
Method is specified to return list but the return type is map
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/DistributionSchedule.java`
#### Snippet
```java
         * Return the list of bookies that already failed.
         *
         * @return the list of bookies that already failed.
         */
        Map<Integer, BookieId> getFailedBookies();
```

### MismatchedJavadocCode
Method is specified to return 'true' but its return type is not boolean
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/DistributedLogConfiguration.java`
#### Snippet
```java
     * Whether log segment sequence number validation is enabled?
     *
     * @return true if the log segment sequence number validation is enabled, otherwise false.
     */
    public DistributedLogConfiguration setLogSegmentSequenceNumberValidationEnabled(boolean enabled) {
```

## RuleId[id=CatchMayIgnoreException]
### CatchMayIgnoreException
Empty `catch` block
in `microbenchmarks/src/main/java/org/apache/bookkeeper/common/MpScQueueBenchmark.java`
#### Snippet
```java
                    batchedArrayBlockingQueue.takeAll(localArray);
                }
            } catch (InterruptedException ie) {
            }
        }
```

### CatchMayIgnoreException
Empty `catch` block
in `microbenchmarks/src/main/java/org/apache/bookkeeper/common/MpScQueueBenchmark.java`
#### Snippet
```java
                    localList.clear();
                }
            } catch (InterruptedException ie) {
            }
        }
```

### CatchMayIgnoreException
Empty `catch` block
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/Shell.java`
#### Snippet
```java
        try {
            errThread.start();
        } catch (IllegalStateException ise) {
        }
        try {
```

## RuleId[id=AssignmentToForLoopParameter]
### AssignmentToForLoopParameter
Assignment to for-loop parameter `j`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/RoundRobinDistributionSchedule.java`
#### Snippet
```java
                    if (!contains(i)) {
                        set(j, i);
                        j++;
                    }
                }
```

## RuleId[id=InnerClassMayBeStatic]
### InnerClassMayBeStatic
Inner class `BookieSideConnectionPeerContextHandler` may be 'static'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieNettyServer.java`
#### Snippet
```java
    }

    class BookieSideConnectionPeerContextHandler extends ChannelInboundHandlerAdapter {

        final BookieConnectionPeer connectionPeer;
```

### InnerClassMayBeStatic
Inner class `CompletionKey` may be 'static'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClient.java`
#### Snippet
```java
    }

    abstract class CompletionKey {
        final long txnId;
        OperationType operationType;
```

### InnerClassMayBeStatic
Inner class `MyCommand` may be 'static'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieShell.java`
#### Snippet
```java
    }

    abstract class MyCommand implements Command {
        abstract Options getOptions();

```

### InnerClassMayBeStatic
Inner class `BindCommand` may be 'static'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
     * TODO: move bind to namespace driver
     */
    class BindCommand extends OptsCommand {

        Options options = new Options();
```

### InnerClassMayBeStatic
Inner class `UnbindCommand` may be 'static'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
     * TODO: move unbind operation to namespace driver
     */
    class UnbindCommand extends OptsCommand {

        Options options = new Options();
```

## RuleId[id=NestedSynchronizedStatement]
### NestedSynchronizedStatement
Nested `synchronized` statement
in `stats/bookkeeper-stats-providers/codahale-metrics-provider/src/main/java/org/apache/bookkeeper/stats/codahale/FastTimer.java`
#### Snippet
```java
                    int tstop = (now + 2) % timeWindow;
                    for (int b = 0; b < numBuckets; b++) {
                        synchronized (buckets[b]) {
                            for (int t = (lastTimeBucket + 2) % timeWindow; t != tstop; t = (t + 1) % timeWindow) {
                                buckets[b][t] = 0;
```

### NestedSynchronizedStatement
Nested `synchronized` statement
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAsyncLogReader.java`
#### Snippet
```java

                PendingReadRequest nextRequest = null;
                synchronized (this) {
                    nextRequest = pendingRequests.peek();

```

## RuleId[id=StringEqualsEmptyString]
### StringEqualsEmptyString
`equals("")` can be replaced with 'isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tls/SecurityProviderFactoryFactory.java`
#### Snippet
```java
    public static SecurityHandlerFactory getSecurityProviderFactory(String securityHandler)
            throws SecurityException {
        if ((securityHandler == null) || (securityHandler.equals(""))) {
            return null;
        }
```

### StringEqualsEmptyString
`equals("")` can be replaced with 'isEmpty()'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookie/LedgerCommand.java`
#### Snippet
```java

    private void initLedgerIdFormatter(ServerConfiguration conf, LedgerFlags flags) {
        if (flags.ledgerIdFormatter.equals("")) {
            this.ledgerIdFormatter = LedgerIdFormatter.newLedgerIdFormatter(conf);
        } else {
```

### StringEqualsEmptyString
`equals("")` can be replaced with 'isEmpty()'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/LedgerMetadata.java`
#### Snippet
```java

    public void addCustomMetadata(String key, String value) {
        if (key == null || "".equals(key.trim())) {
            throw new IllegalArgumentException("Metadata key cant be empty");
        }
```

### StringEqualsEmptyString
`equals("")` can be replaced with 'isEmpty()'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/LedgerMetadata.java`
#### Snippet
```java
            throw new IllegalArgumentException("Metadata key cant be empty");
        }
        if (value == null || "".equals(value.trim())) {
            throw new IllegalArgumentException("Metadata value cant be empty");
        }
```

### StringEqualsEmptyString
`equals("")` can be replaced with 'isEmpty()'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/federated/FederatedZKLogMetadataStore.java`
#### Snippet
```java
    @Override
    public CompletableFuture<Iterator<String>> getLogs(String logNamePrefix) {
        if (!"".equals(logNamePrefix)) {
            return FutureUtils.exception(
                new UnexpectedException("Get logs by prefix is not supported by federated metadata store"));
```

## RuleId[id=SynchronizeOnNonFinalField]
### SynchronizeOnNonFinalField
Synchronization on a non-final field `metadataLock`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadOnlyLedgerHandle.java`
#### Snippet
```java
    @Override
    List<BookieId> getCurrentEnsemble() {
        synchronized (metadataLock) {
            if (!newEnsemblesFromRecovery.isEmpty()) {
                return newEnsemblesFromRecovery.lastEntry().getValue();
```

### SynchronizeOnNonFinalField
Synchronization on a non-final field `metadataLock`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadOnlyLedgerHandle.java`
#### Snippet
```java
        // ledger, so this synchronized should be unnecessary, but putting it here now
        // just in case (can be removed when we validate threads)
        synchronized (metadataLock) {
            String logContext = String.format("[RecoveryEnsembleChange(ledger:%d)]", ledgerId);

```

### SynchronizeOnNonFinalField
Synchronization on a non-final field `metadataLock`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadOnlyLedgerHandle.java`
#### Snippet
```java
                    LedgerMetadataBuilder builder = LedgerMetadataBuilder.from(metadata);
                    Long lastEnsembleKey = LedgerMetadataUtils.getLastEnsembleKey(metadata);
                    synchronized (metadataLock) {
                        newEnsemblesFromRecovery.entrySet().forEach(
                                (e) -> {
```

### SynchronizeOnNonFinalField
Synchronization on a non-final field `metadataLock`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadOnlyLedgerHandle.java`
#### Snippet
```java
                this::setLedgerMetadata).run();
        f.whenComplete((result, exception) -> {
            synchronized (metadataLock) {
                newEnsemblesFromRecovery.clear();
            }
```

### SynchronizeOnNonFinalField
Synchronization on a non-final field `watcherMap`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/metastore/InMemoryMetastoreTable.java`
#### Snippet
```java

    private void triggerWatch(String key, MSWatchedEvent.EventType type) {
        synchronized (watcherMap){
            if (watcherMap.containsKey(key)) {
                MSWatchedEvent event = new MSWatchedEvent(key, type);
```

### SynchronizeOnNonFinalField
Synchronization on a non-final field `watcherMap`
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/metastore/InMemoryMetastoreTable.java`
#### Snippet
```java
            public void run() {
                scheduleGet(key, ALL_FIELDS, cb, ctx);
                synchronized (watcherMap) {
                    watcherMap.put(key, watcher);
                }
```

## RuleId[id=MissingDeprecatedAnnotation]
### MissingDeprecatedAnnotation
Missing '@Deprecated' annotation
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/ServerConfiguration.java`
#### Snippet
```java
     * @param enabled
     */
    public ServerConfiguration setSortedLedgerStorageEnabled(boolean enabled) {
        this.setProperty(SORTED_LEDGER_STORAGE_ENABLED, enabled);
        return this;
```

### MissingDeprecatedAnnotation
Missing '@Deprecated' annotation
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/ClientConfiguration.java`
#### Snippet
```java
     * @see LedgerHandle#readEntries(long, long)
     */
    public ClientConfiguration setNettyUsePooledBuffers(boolean enabled) {
        setProperty(NETTY_USE_POOLED_BUFFERS, enabled);
        return this;
```

### MissingDeprecatedAnnotation
Missing '@Deprecated' annotation
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/MSLedgerManagerFactory.java`
#### Snippet
```java
 */
@Slf4j
public class MSLedgerManagerFactory extends AbstractZkLedgerManagerFactory {

    private static final Logger LOG = LoggerFactory.getLogger(MSLedgerManagerFactory.class);
```

### MissingDeprecatedAnnotation
Missing '@Deprecated' annotation
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/DistributedLogConfiguration.java`
#### Snippet
```java
     * @see #getBKClientNumberWorkerThreads()
     */
    public DistributedLogConfiguration setBKClientNumberWorkerThreads(int numThreads) {
        setProperty(BKDL_BKCLIENT_NUM_WORKER_THREADS, numThreads);
        return this;
```

### MissingDeprecatedAnnotation
Missing '@Deprecated' annotation
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/DistributedLogConfiguration.java`
#### Snippet
```java
     * @see ClientConfiguration#getAddEntryTimeout()
     */
    public int getBKClientWriteTimeout() {
        return this.getInt(BKDL_BKCLIENT_WRITE_TIMEOUT, BKDL_BKCLIENT_WRITE_TIMEOUT_DEFAULT);
    }
```

### MissingDeprecatedAnnotation
Missing '@Deprecated' annotation
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/DistributedLogConfiguration.java`
#### Snippet
```java
     * @see #getBKClientReadTimeout()
     */
    public DistributedLogConfiguration setBKClientReadTimeout(int readTimeout) {
        setProperty(BKDL_BKCLIENT_READ_TIMEOUT, readTimeout);
        return this;
```

### MissingDeprecatedAnnotation
Missing '@Deprecated' annotation
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/DistributedLogConfiguration.java`
#### Snippet
```java
     * @see #getBKClientWriteTimeout()
     */
    public DistributedLogConfiguration setBKClientWriteTimeout(int writeTimeout) {
        setProperty(BKDL_BKCLIENT_WRITE_TIMEOUT, writeTimeout);
        return this;
```

### MissingDeprecatedAnnotation
Missing '@Deprecated' annotation
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/DistributedLogConfiguration.java`
#### Snippet
```java
     * @return flag to enable per stream stat.
     */
    public boolean getEnablePerStreamStat() {
        return getBoolean(BKDL_ENABLE_PERSTREAM_STAT, BKDL_ENABLE_PERSTREAM_STAT_DEFAULT);
    }
```

### MissingDeprecatedAnnotation
Missing '@Deprecated' annotation
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/DistributedLogConfiguration.java`
#### Snippet
```java
     * @see ClientConfiguration#getNumWorkerThreads()
     */
    public int getBKClientNumberWorkerThreads() {
        return this.getInt(BKDL_BKCLIENT_NUM_WORKER_THREADS, BKDL_BKCLEINT_NUM_WORKER_THREADS_DEFAULT);
    }
```

### MissingDeprecatedAnnotation
Missing '@Deprecated' annotation
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/DistributedLogConfiguration.java`
#### Snippet
```java
     * @see ClientConfiguration#getReadEntryTimeout()
     */
    public int getBKClientReadTimeout() {
        return this.getInt(BKDL_BKCLIENT_READ_TIMEOUT,
                BKDL_BKCLIENT_READ_TIMEOUT_DEFAULT);
```

### MissingDeprecatedAnnotation
Missing '@Deprecated' annotation
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/DistributedLogConfiguration.java`
#### Snippet
```java
     * @return dl configuration.
     */
    public DistributedLogConfiguration setEnablePerStreamStat(boolean enabled) {
        setProperty(BKDL_ENABLE_PERSTREAM_STAT, enabled);
        return this;
```

### MissingDeprecatedAnnotation
Missing '@Deprecated' annotation
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/DistributedLogConfiguration.java`
#### Snippet
```java
     * @deprecated use {@link #getZKSessionTimeoutMilliseconds()}
     */
    public int getZKSessionTimeoutSeconds() {
        return this.getInt(BKDL_ZK_SESSION_TIMEOUT_SECONDS, BKDL_ZK_SESSION_TIMEOUT_SECONDS_DEFAULT);
    }
```

### MissingDeprecatedAnnotation
Missing '@Deprecated' annotation
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/api/MetadataAccessor.java`
#### Snippet
```java
@LimitedPrivate
@Evolving
public interface MetadataAccessor extends Closeable, AsyncCloseable {
    /**
     * Get the name of the stream managed by this log manager.
```

## RuleId[id=ConditionCoveredByFurtherCondition]
### ConditionCoveredByFurtherCondition
Condition 'mapping != null' covered by subsequent condition 'mapping instanceof AbstractDNSToSwitchMapping'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/AbstractDNSToSwitchMapping.java`
#### Snippet
```java
     */
    public static boolean isMappingSingleSwitch(DNSToSwitchMapping mapping) {
        return mapping != null && mapping instanceof AbstractDNSToSwitchMapping
                && ((AbstractDNSToSwitchMapping) mapping).isSingleSwitch();
    }
```

### ConditionCoveredByFurtherCondition
Condition 'excludedNode == null' covered by subsequent condition '!(excludedNode instanceof InnerNode)'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/NetworkTopologyImpl.java`
#### Snippet
```java
            int count = 0;
            // check if the excluded node a leaf
            boolean isLeaf = excludedNode == null || !(excludedNode instanceof InnerNode);
            // calculate the total number of excluded leaf nodes
            int numOfExcludedLeaves = isLeaf ? 1 : ((InnerNode) excludedNode).getNumOfLeaves();
```

### ConditionCoveredByFurtherCondition
Condition 'msg instanceof BookkeeperProtocol.Request' covered by subsequent condition 'msg instanceof BookieProtocol.Request'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieRequestHandler.java`
#### Snippet
```java
    @Override
    public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception {
        if (!(msg instanceof BookkeeperProtocol.Request || msg instanceof BookieProtocol.Request)) {
            ctx.fireChannelRead(msg);
            return;
```

### ConditionCoveredByFurtherCondition
Condition 'null == obj' covered by subsequent condition '!(obj instanceof MetadataVersion)'
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/metastore/InMemoryMetastoreTable.java`
#### Snippet
```java
        @Override
        public boolean equals(Object obj) {
            if (null == obj || !(obj instanceof MetadataVersion)) {
                return false;
            }
```

### ConditionCoveredByFurtherCondition
Condition 'null != cause' covered by subsequent condition 'cause instanceof CancellationException'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/lock/ZKSessionLockFactory.java`
#### Snippet
```java
        CompletableFuture<SessionLock> createPromise = FutureUtils.createFuture();
        createPromise.whenComplete((value, cause) -> {
            if (null != cause && cause instanceof CancellationException) {
                interruptedException.set(cause);
            }
```

### ConditionCoveredByFurtherCondition
Condition 'null == throwable' covered by subsequent condition '!(throwable instanceof CancellationException)'
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/lock/ZKDistributedLock.java`
#### Snippet
```java
        final CompletableFuture<ZKDistributedLock> promise = FutureUtils.createFuture();
        promise.whenComplete((zkDistributedLock, throwable) -> {
            if (null == throwable || !(throwable instanceof CancellationException)) {
                return;
            }
```

## RuleId[id=UnnecessaryFullyQualifiedName]
### UnnecessaryFullyQualifiedName
Qualifier `org.apache.bookkeeper.common.util` is unnecessary and can be removed
in `stream/clients/java/base/src/main/java/org/apache/bookkeeper/clients/config/StorageClientSettings.java`
#### Snippet
```java
     * Configure a backoff policy for the client.
     *
     * <p>There are a few default backoff policies defined in {@link org.apache.bookkeeper.common.util.Backoff}.
     *
     * @return backoff policy provider
```

### UnnecessaryFullyQualifiedName
Qualifier `io.grpc` is unnecessary and can be removed
in `stream/bk-grpc-name-resolver/src/main/java/org/apache/bookkeeper/grpc/resolver/BKRegistrationNameResolverProvider.java`
#### Snippet
```java

/**
 * An implementation of {@link NameResolverProvider} that provides {@link io.grpc.NameResolver}s
 * to resolve servers registered using bookkeeper registration library.
 */
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.bookkeeper.statelib.api.mvcc` is unnecessary and can be removed
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/kv/TableStoreImpl.java`
#### Snippet
```java

/**
 * A table store implementation based on {@link org.apache.bookkeeper.statelib.api.mvcc.MVCCAsyncStore}.
 */
@Slf4j
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.curator.framework.recipes.cache` is unnecessary, and can be replaced with an import
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/cluster/ZkClusterMetadataStore.java`
#### Snippet
```java
        synchronized (this) {
            if (assignmentDataCache == null) {
                assignmentDataCache = new org.apache.curator.framework.recipes.cache.NodeCache(client,
                                                                                               zkClusterAssignmentPath);
                try {
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.curator.framework.recipes.cache` is unnecessary, and can be replaced with an import
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/cluster/ZkClusterMetadataStore.java`
#### Snippet
```java

    private final Map<Consumer<Void>, NodeCacheListener> assignmentDataConsumers;
    private org.apache.curator.framework.recipes.cache.NodeCache assignmentDataCache;

    private volatile boolean closed = false;
```

### UnnecessaryFullyQualifiedName
Qualifier `io.netty.buffer` is unnecessary and can be removed
in `stream/distributedlog/common/src/main/java/org/apache/distributedlog/common/util/ByteBufUtils.java`
#### Snippet
```java

/**
 * Utils to handle with {@link io.netty.buffer.ByteBuf}.
 */
public class ByteBufUtils {
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.bookkeeper.proto` is unnecessary and can be removed
in `stream/server/src/main/java/org/apache/bookkeeper/stream/server/service/BookieService.java`
#### Snippet
```java
/**
 * A {@link org.apache.bookkeeper.common.component.LifecycleComponent} that runs
 * a {@link org.apache.bookkeeper.proto.BookieServer}.
 */
@Accessors(fluent = true)
```

### UnnecessaryFullyQualifiedName
Qualifier `java.lang` is unnecessary and can be removed
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/net/BookieSocketAddress.java`
#### Snippet
```java
     * @param bookieId
     * @return true if the BookieId looks like it has been generated by
     * {@link #createDummyBookieIdForHostname(java.lang.String)}
     */
    public static boolean isDummyBookieIdForHostname(BookieId bookieId) {
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.commons.configuration` is unnecessary and can be removed
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/UncheckedConfigurationException.java`
#### Snippet
```java

/**
 * Wraps a {@link org.apache.commons.configuration.ConfigurationException} with an unchecked exception.
 *
 * @since 4.7.0
```

### UnnecessaryFullyQualifiedName
Qualifier `java.lang` is unnecessary and can be removed
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/AbstractConfiguration.java`
#### Snippet
```java
    /**
     * Set the list of enabled TLS cipher suites. Leave null not to override default JDK list. This list will be passed
     * to {@link SSLEngine#setEnabledCipherSuites(java.lang.String[]) }. Please refer to official JDK JavaDocs
     *
     * @param list
```

### UnnecessaryFullyQualifiedName
Qualifier `java.lang` is unnecessary and can be removed
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/AbstractConfiguration.java`
#### Snippet
```java
    /**
     * Set the list of enabled TLS protocols. Leave null not to override default JDK list. This list will be passed to
     * {@link SSLEngine#setEnabledProtocols(java.lang.String[]) }. Please refer to official JDK JavaDocs
     *
     * @param list
```

### UnnecessaryFullyQualifiedName
Qualifier `java.lang` is unnecessary and can be removed
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/AbstractConfiguration.java`
#### Snippet
```java
     * @return this list of enabled TLS cipher suites
     *
     * @see #setTLSEnabledCipherSuites(java.lang.String)
     */
    public String getTLSEnabledCipherSuites() {
```

### UnnecessaryFullyQualifiedName
Qualifier `java.lang` is unnecessary and can be removed
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/AbstractConfiguration.java`
#### Snippet
```java

    /**
     * This list will be passed to {@link SSLEngine#setEnabledProtocols(java.lang.String[]) }.
     * Please refer to official JDK JavaDocs
    */
```

### UnnecessaryFullyQualifiedName
Qualifier `java.lang` is unnecessary and can be removed
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/AbstractConfiguration.java`
#### Snippet
```java
     * @return the list of enabled TLS protocols.
     *
     * @see #setTLSEnabledProtocols(java.lang.String)
     */
    public String getTLSEnabledProtocols() {
```

### UnnecessaryFullyQualifiedName
Qualifier `java.lang` is unnecessary and can be removed
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/AbstractConfiguration.java`
#### Snippet
```java
    protected static final String TLS_CERT_FILES_REFRESH_DURATION_SECONDS = "tlsCertFilesRefreshDurationSeconds";
    /**
     * This list will be passed to {@link SSLEngine#setEnabledCipherSuites(java.lang.String[]) }.
     * Please refer to official JDK JavaDocs
    */
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.bookkeeper.meta` is unnecessary, and can be replaced with an import
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/AbstractConfiguration.java`
#### Snippet
```java
            if (factoryClass == HierarchicalLedgerManagerFactory.class) {
                ledgerManagerType = HierarchicalLedgerManagerFactory.NAME;
            } else if (factoryClass == org.apache.bookkeeper.meta.FlatLedgerManagerFactory.class) {
                ledgerManagerType = org.apache.bookkeeper.meta.FlatLedgerManagerFactory.NAME;
            } else if (factoryClass == LongHierarchicalLedgerManagerFactory.class) {
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.bookkeeper.meta` is unnecessary, and can be replaced with an import
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/AbstractConfiguration.java`
#### Snippet
```java
                ledgerManagerType = HierarchicalLedgerManagerFactory.NAME;
            } else if (factoryClass == org.apache.bookkeeper.meta.FlatLedgerManagerFactory.class) {
                ledgerManagerType = org.apache.bookkeeper.meta.FlatLedgerManagerFactory.NAME;
            } else if (factoryClass == LongHierarchicalLedgerManagerFactory.class) {
                ledgerManagerType = LongHierarchicalLedgerManagerFactory.NAME;
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.bookkeeper.meta` is unnecessary, and can be replaced with an import
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/AbstractConfiguration.java`
#### Snippet
```java
            } else if (factoryClass == LongHierarchicalLedgerManagerFactory.class) {
                ledgerManagerType = LongHierarchicalLedgerManagerFactory.NAME;
            } else if (factoryClass == org.apache.bookkeeper.meta.MSLedgerManagerFactory.class) {
                ledgerManagerType = org.apache.bookkeeper.meta.MSLedgerManagerFactory.NAME;
            } else {
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.bookkeeper.meta` is unnecessary, and can be replaced with an import
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/AbstractConfiguration.java`
#### Snippet
```java
                ledgerManagerType = LongHierarchicalLedgerManagerFactory.NAME;
            } else if (factoryClass == org.apache.bookkeeper.meta.MSLedgerManagerFactory.class) {
                ledgerManagerType = org.apache.bookkeeper.meta.MSLedgerManagerFactory.NAME;
            } else {
                throw new IllegalArgumentException("Unknown zookeeper based ledger manager factory : "
```

### UnnecessaryFullyQualifiedName
Qualifier `java.lang` is unnecessary and can be removed
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/ServerConfiguration.java`
#### Snippet
```java
     * automatic BookieId generation, based on Network Addresses.
     *
     * @see #setBookieId(java.lang.String)
     * @see #getAdvertisedAddress()
     * @return the configure address to be advertised
```

### UnnecessaryFullyQualifiedName
Qualifier `io.netty.util.internal` is unnecessary, and can be replaced with an import
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/ServerConfiguration.java`
#### Snippet
```java
    public long getJournalMaxMemorySizeMb() {
        // Default is taking 5% of max direct memory (and convert to MB).
        long estimateMaxDirectMemory = io.netty.util.internal.PlatformDependent.estimateMaxDirectMemory();
        long defaultValue = (long) (estimateMaxDirectMemory * 0.05 / 1024 / 1024);
        return this.getLong(JOURNAL_MAX_MEMORY_SIZE_MB, defaultValue);
```

### UnnecessaryFullyQualifiedName
Qualifier `java.lang` is unnecessary and can be removed
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/ServerConfiguration.java`
#### Snippet
```java
     *
     * @see #getBookieId()
     * @see #setAdvertisedAddress(java.lang.String)
     * @param bookieId the bookie id
     *
```

### UnnecessaryFullyQualifiedName
Qualifier `org.slf4j` is unnecessary, and can be replaced with an import
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/sasl/SASLClientProviderFactory.java`
#### Snippet
```java
    org.apache.bookkeeper.auth.ClientAuthProvider.Factory, JAASCredentialsContainer {

    private static final org.slf4j.Logger LOG = LoggerFactory.getLogger(SASLClientProviderFactory.class);

    private ClientConfiguration clientConfiguration;
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.bookkeeper.auth` is unnecessary and can be removed
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/sasl/SASLClientProviderFactory.java`
#### Snippet
```java
 */
public class SASLClientProviderFactory implements
    org.apache.bookkeeper.auth.ClientAuthProvider.Factory, JAASCredentialsContainer {

    private static final org.slf4j.Logger LOG = LoggerFactory.getLogger(SASLClientProviderFactory.class);
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.bookkeeper.meta` is unnecessary, and can be replaced with an import
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/zk/ZKMetadataDriverBase.java`
#### Snippet
```java
        if (schemeParts.length > 1) {
            switch (schemeParts[1]) {
                case org.apache.bookkeeper.meta.FlatLedgerManagerFactory.NAME:
                    ledgerManagerFactoryClass = org.apache.bookkeeper.meta.FlatLedgerManagerFactory.class;
                    break;
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.bookkeeper.meta` is unnecessary, and can be replaced with an import
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/zk/ZKMetadataDriverBase.java`
#### Snippet
```java
            switch (schemeParts[1]) {
                case org.apache.bookkeeper.meta.FlatLedgerManagerFactory.NAME:
                    ledgerManagerFactoryClass = org.apache.bookkeeper.meta.FlatLedgerManagerFactory.class;
                    break;
                case HierarchicalLedgerManagerFactory.NAME:
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.bookkeeper.meta` is unnecessary, and can be replaced with an import
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/zk/ZKMetadataDriverBase.java`
#### Snippet
```java
                    ledgerManagerFactoryClass = LongHierarchicalLedgerManagerFactory.class;
                    break;
                case org.apache.bookkeeper.meta.MSLedgerManagerFactory.NAME:
                    ledgerManagerFactoryClass = org.apache.bookkeeper.meta.MSLedgerManagerFactory.class;
                    break;
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.bookkeeper.meta` is unnecessary, and can be replaced with an import
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/zk/ZKMetadataDriverBase.java`
#### Snippet
```java
                    break;
                case org.apache.bookkeeper.meta.MSLedgerManagerFactory.NAME:
                    ledgerManagerFactoryClass = org.apache.bookkeeper.meta.MSLedgerManagerFactory.class;
                    break;
                case "null":
```

### UnnecessaryFullyQualifiedName
Qualifier `org.slf4j` is unnecessary, and can be replaced with an import
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/sasl/SASLClientAuthProvider.java`
#### Snippet
```java
public class SASLClientAuthProvider implements ClientAuthProvider {

    private static final org.slf4j.Logger LOG = LoggerFactory.getLogger(SASLClientAuthProvider.class);

    private SaslClientState client;
```

### UnnecessaryFullyQualifiedName
Qualifier `org.slf4j` is unnecessary, and can be replaced with an import
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/sasl/SaslClientState.java`
#### Snippet
```java
public class SaslClientState {

    private static final org.slf4j.Logger LOG = LoggerFactory.getLogger(SaslClientState.class);

    private final SaslClient saslClient;
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.bookkeeper.auth` is unnecessary, and can be replaced with an import
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/sasl/SASLBookieAuthProviderFactory.java`
#### Snippet
```java

    @Override
    public org.apache.bookkeeper.auth.BookieAuthProvider newProvider(BookieConnectionPeer addr,
        AuthCallbacks.GenericCallback<Void> completeCb) {
        return new SASLBookieAuthProvider(addr, completeCb, serverConfiguration,
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.bookkeeper.auth` is unnecessary, and can be replaced with an import
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/sasl/SASLBookieAuthProviderFactory.java`
#### Snippet
```java
 * BookieAuthProvider which uses JDK-bundled SASL.
 */
public class SASLBookieAuthProviderFactory implements org.apache.bookkeeper.auth.BookieAuthProvider.Factory,
    JAASCredentialsContainer {

```

### UnnecessaryFullyQualifiedName
Qualifier `org.slf4j` is unnecessary, and can be replaced with an import
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/sasl/SaslServerState.java`
#### Snippet
```java
public class SaslServerState {

    private static final org.slf4j.Logger LOG = LoggerFactory.getLogger(SaslServerState.class);

    private final SaslServer saslServer;
```

### UnnecessaryFullyQualifiedName
Qualifier `java.io` is unnecessary, and can be replaced with an import
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/HexDumpEntryFormatter.java`
#### Snippet
```java

    @Override
    public void formatEntry(java.io.InputStream input) {
        try {
            byte[] data = new byte[input.available()];
```

### UnnecessaryFullyQualifiedName
Qualifier `javax.security.auth.login` is unnecessary and can be removed
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/sasl/TGTRefreshThread.java`
#### Snippet
```java
     * Re-login a principal. This method assumes that {@link #login(String)} has happened already.
     *
     * @throws javax.security.auth.login.LoginException on a failure
     */
    // c.f. HADOOP-6559
```

### UnnecessaryFullyQualifiedName
Qualifier `java.io` is unnecessary, and can be replaced with an import
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/IOUtils.java`
#### Snippet
```java
     *            the objects to close
     */
    public static void close(Logger log, java.io.Closeable closeable) {
        if (closeable != null) {
            try {
```

### UnnecessaryFullyQualifiedName
Qualifier `java.io` is unnecessary, and can be replaced with an import
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/IOUtils.java`
#### Snippet
```java
     *            the objects to close
     */
    public static void close(Logger log, java.io.Closeable... closeables) {
        for (java.io.Closeable c : closeables) {
            close(log, c);
```

### UnnecessaryFullyQualifiedName
Qualifier `java.io` is unnecessary, and can be replaced with an import
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/IOUtils.java`
#### Snippet
```java
     */
    public static void close(Logger log, java.io.Closeable... closeables) {
        for (java.io.Closeable c : closeables) {
            close(log, c);
        }
```

### UnnecessaryFullyQualifiedName
Qualifier `java.io` is unnecessary, and can be replaced with an import
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/EntryFormatter.java`
#### Snippet
```java
     *          Input Stream
     */
    public abstract void formatEntry(java.io.InputStream input);
    public static final EntryFormatter STRING_FORMATTER = new StringEntryFormatter();

```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.bookkeeper.client` is unnecessary and can be removed
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/conf/ClientConfiguration.java`
#### Snippet
```java
     * bookies. This should be taken into account before changing this configuration value.
     *
     * @see org.apache.bookkeeper.client.LedgerHandle#asyncReadEntries
     * @return the speculative read timeout in milliseconds. Default 2000.
     */
```

### UnnecessaryFullyQualifiedName
Qualifier `java.io` is unnecessary, and can be replaced with an import
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/util/StringEntryFormatter.java`
#### Snippet
```java

    @Override
    public void formatEntry(java.io.InputStream input) {
        try {
            byte[] data = new byte[input.available()];
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.bookkeeper.proto` is unnecessary and can be removed
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClientFactory.java`
#### Snippet
```java

    /**
     * Create a {@link org.apache.bookkeeper.proto.PerChannelBookieClient} to
     * <i>address</i>.
     *
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.bookkeeper.proto` is unnecessary and can be removed
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/PerChannelBookieClientFactory.java`
#### Snippet
```java

/**
 * Factory to create {@link org.apache.bookkeeper.proto.PerChannelBookieClient}.
 */
interface PerChannelBookieClientFactory {
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.bookkeeper.auth` is unnecessary and can be removed
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/ConnectionPeer.java`
#### Snippet
```java
     * Returns the user which is bound to the connection.
     * @return the principal or null if no auth takes place
     * or the auth plugin did not call {@link #setAuthorizedId(org.apache.bookkeeper.auth.BookKeeperPrincipal)}
     * @see  #setAuthorizedId(org.apache.bookkeeper.auth.BookKeeperPrincipal)
     */
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.bookkeeper.auth` is unnecessary and can be removed
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/ConnectionPeer.java`
#### Snippet
```java
     * @return the principal or null if no auth takes place
     * or the auth plugin did not call {@link #setAuthorizedId(org.apache.bookkeeper.auth.BookKeeperPrincipal)}
     * @see  #setAuthorizedId(org.apache.bookkeeper.auth.BookKeeperPrincipal)
     */
    BookKeeperPrincipal getAuthorizedId();
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.bookkeeper.proto` is unnecessary and can be removed
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieClient.java`
#### Snippet
```java
     * @param ctx a context object passed to the callback on completion
     * @param options a bit mask of flags from BookieProtocol.FLAG_*
     *                {@link org.apache.bookkeeper.proto.BookieProtocol}
     * @param allowFastFail fail the add immediately if the channel is non-writable
     *                      {@link #isWritable(BookieId,long)}
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.bookkeeper.client.api` is unnecessary and can be removed
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieClient.java`
#### Snippet
```java
     *                      {@link #isWritable(BookieId,long)}
     * @param writeFlags a set of write flags
     *                   {@link org.apache.bookkeeper.client.api.WriteFlag}
     */
    void addEntry(BookieId address, long ledgerId, byte[] masterKey,
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.bookkeeper.proto` is unnecessary and can be removed
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieClient.java`
#### Snippet
```java
     * @param ctx a context object passed to the callback on completion
     * @param flags a bit mask of flags from BookieProtocol.FLAG_*
     *              {@link org.apache.bookkeeper.proto.BookieProtocol}
     * @param masterKey the master key of the ledger being read from. This is only required
     *                  if the FLAG_DO_FENCING is specified.
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.bookkeeper.client.api` is unnecessary and can be removed
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookieClient.java`
#### Snippet
```java
     * Send a force request to the server. When complete all entries which have
     * been written for {@code ledgerId} to this bookie will be persisted on disk.
     * This is for use with {@link org.apache.bookkeeper.client.api.WriteFlag#DEFERRED_SYNC}.
     *
     * @param address the address of the bookie
```

### UnnecessaryFullyQualifiedName
Qualifier `java.util` is unnecessary, and can be replaced with an import
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookie/LocalConsistencyCheckCommand.java`
#### Snippet
```java
        LedgerStorage ledgerStorage = BookieImpl.mountLedgerStorageOffline(serverConfiguration, null);
        List<LedgerStorage.DetectedInconsistency> errors = ledgerStorage.localConsistencyCheck(
            java.util.Optional.empty());
        if (errors.size() > 0) {
            LOG.info("=== Check returned errors: ===");
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.bookkeeper.bookie` is unnecessary, and can be replaced with an import
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/cookie/CookieCommand.java`
#### Snippet
```java
        throws Exception;

    public org.apache.bookkeeper.bookie.BookieShell.Command asShellCommand(String shellCmdName,
                                                                           CompositeConfiguration conf) {
        return new BookieShellCommand<>(shellCmdName, this, conf);
```

### UnnecessaryFullyQualifiedName
Qualifier `java.io` is unnecessary and can be removed
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/ShortReadException.java`
#### Snippet
```java

/**
 * Short Read Exception. Used to distinguish short read exception with other {@link java.io.IOException}s.
 */
public class ShortReadException extends IOException {
```

### UnnecessaryFullyQualifiedName
Qualifier `java.util` is unnecessary and can be removed
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LocalBookieEnsemblePlacementPolicy.java`
#### Snippet
```java
    @Override
    public PlacementResult<List<BookieId>> newEnsemble(int ensembleSize, int writeQuorumSize,
            int ackQuorumSize, java.util.Map<String, byte[]> customMetadata, Set<BookieId> excludeBookies)
            throws BKNotEnoughBookiesException {
        if (ensembleSize > 1) {
```

### UnnecessaryFullyQualifiedName
Qualifier `java.util` is unnecessary and can be removed
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LocalBookieEnsemblePlacementPolicy.java`
#### Snippet
```java
    @Override
    public PlacementResult<BookieId> replaceBookie(int ensembleSize, int writeQuorumSize, int ackQuorumSize,
            java.util.Map<String, byte[]> customMetadata, List<BookieId> currentEnsemble,
            BookieId bookieToReplace, Set<BookieId> excludeBookies)
            throws BKNotEnoughBookiesException {
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.bookkeeper.bookie` is unnecessary and can be removed
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/Journal.java`
#### Snippet
```java
     * Those journals will be garbage collected in SyncThread.
     * </p>
     * @see org.apache.bookkeeper.bookie.SyncThread
     */
    @Override
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.bookkeeper.bookie` is unnecessary and can be removed
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/FileInfo.java`
#### Snippet
```java
     * Read data from position <i>start</i> to fill the byte buffer <i>bb</i>.
     * If <i>bestEffort </i> is provided, it would return when it reaches EOF.
     * Otherwise, it would throw {@link org.apache.bookkeeper.bookie.ShortReadException}
     * if it reaches EOF.
     *
```

### UnnecessaryFullyQualifiedName
Qualifier `io.netty.util.internal` is unnecessary, and can be replaced with an import
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/ArrayUtil.java`
#### Snippet
```java

    public static boolean isArrayAllZeros(final byte[] array) {
        return io.netty.util.internal.PlatformDependent.isZero(array, 0, array.length);
    }
}
```

### UnnecessaryFullyQualifiedName
Qualifier `io.netty.util.internal` is unnecessary, and can be replaced with an import
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/ArrayUtil.java`
#### Snippet
```java

    private static final boolean UNALIGNED = io.netty.util.internal.PlatformDependent.isUnaligned();
    private static final boolean HAS_UNSAFE = io.netty.util.internal.PlatformDependent.hasUnsafe();
    private static final boolean BIG_ENDIAN_NATIVE_ORDER = ByteOrder.nativeOrder() == ByteOrder.BIG_ENDIAN;

```

### UnnecessaryFullyQualifiedName
Qualifier `io.netty.util.internal` is unnecessary, and can be replaced with an import
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/ArrayUtil.java`
#### Snippet
```java
    public static long getLong(byte[] array, int index) {
        if (HAS_UNSAFE && UNALIGNED) {
            long v = io.netty.util.internal.PlatformDependent.getLong(array, index);
            return BIG_ENDIAN_NATIVE_ORDER ? v : Long.reverseBytes(v);
        }
```

### UnnecessaryFullyQualifiedName
Qualifier `io.netty.util.internal` is unnecessary, and can be replaced with an import
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/ArrayUtil.java`
#### Snippet
```java
class ArrayUtil {

    private static final boolean UNALIGNED = io.netty.util.internal.PlatformDependent.isUnaligned();
    private static final boolean HAS_UNSAFE = io.netty.util.internal.PlatformDependent.hasUnsafe();
    private static final boolean BIG_ENDIAN_NATIVE_ORDER = ByteOrder.nativeOrder() == ByteOrder.BIG_ENDIAN;
```

### UnnecessaryFullyQualifiedName
Qualifier `io.netty.util.internal` is unnecessary, and can be replaced with an import
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/ArrayUtil.java`
#### Snippet
```java
    public static void setLong(byte[] array, int index, long value) {
        if (HAS_UNSAFE && UNALIGNED) {
            io.netty.util.internal.PlatformDependent
                    .putLong(array, index, BIG_ENDIAN_NATIVE_ORDER ? value : Long.reverseBytes(value));
        } else {
```

### UnnecessaryFullyQualifiedName
Qualifier `java.util` is unnecessary and can be removed
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/EnsemblePlacementPolicy.java`
#### Snippet
```java
     * <p>The implementation should take actions when the cluster view is changed. So subsequent
     * {@link #newEnsemble(int, int, int, Map, Set)} and
     * {@link #replaceBookie(int, int, int, java.util.Map, java.util.List, BookieId, java.util.Set) }
     * can choose proper bookies.
     *
```

### UnnecessaryFullyQualifiedName
Qualifier `java.util` is unnecessary and can be removed
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/EnsemblePlacementPolicy.java`
#### Snippet
```java
     * <p>The implementation should take actions when the cluster view is changed. So subsequent
     * {@link #newEnsemble(int, int, int, Map, Set)} and
     * {@link #replaceBookie(int, int, int, java.util.Map, java.util.List, BookieId, java.util.Set) }
     * can choose proper bookies.
     *
```

### UnnecessaryFullyQualifiedName
Qualifier `java.util` is unnecessary and can be removed
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/EnsemblePlacementPolicy.java`
#### Snippet
```java
     * <p>The implementation should take actions when the cluster view is changed. So subsequent
     * {@link #newEnsemble(int, int, int, Map, Set)} and
     * {@link #replaceBookie(int, int, int, java.util.Map, java.util.List, BookieId, java.util.Set) }
     * can choose proper bookies.
     *
```

### UnnecessaryFullyQualifiedName
Qualifier `java.util` is unnecessary and can be removed
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/EnsemblePlacementPolicy.java`
#### Snippet
```java
 * {@link #onClusterChanged(Set, Set)}. The implementation of the ensemble placement policy will react on those
 * changes to build new network topology. Subsequent operations like {@link #newEnsemble(int, int, int, Map, Set)} or
 * {@link #replaceBookie(int, int, int, java.util.Map, java.util.List, BookieId, java.util.Set)}
 * hence can operate on the new
 * network topology.
```

### UnnecessaryFullyQualifiedName
Qualifier `java.util` is unnecessary and can be removed
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/EnsemblePlacementPolicy.java`
#### Snippet
```java
 * {@link #onClusterChanged(Set, Set)}. The implementation of the ensemble placement policy will react on those
 * changes to build new network topology. Subsequent operations like {@link #newEnsemble(int, int, int, Map, Set)} or
 * {@link #replaceBookie(int, int, int, java.util.Map, java.util.List, BookieId, java.util.Set)}
 * hence can operate on the new
 * network topology.
```

### UnnecessaryFullyQualifiedName
Qualifier `java.util` is unnecessary and can be removed
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/EnsemblePlacementPolicy.java`
#### Snippet
```java
 * {@link #onClusterChanged(Set, Set)}. The implementation of the ensemble placement policy will react on those
 * changes to build new network topology. Subsequent operations like {@link #newEnsemble(int, int, int, Map, Set)} or
 * {@link #replaceBookie(int, int, int, java.util.Map, java.util.List, BookieId, java.util.Set)}
 * hence can operate on the new
 * network topology.
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.bookkeeper.client` is unnecessary and can be removed
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
     * Obtains asynchronously the last confirmed write from a quorum of bookies.
     * It is similar as
     * {@link #asyncReadLastConfirmed(org.apache.bookkeeper.client.AsyncCallback.ReadLastConfirmedCallback, Object)},
     * but it doesn't wait all the responses from the quorum. It would callback
     * immediately if it received a LAC which is larger than current LAC.
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.bookkeeper.client` is unnecessary and can be removed
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
     * immediately if it received a LAC which is larger than current LAC.
     *
     * @see #asyncTryReadLastConfirmed(org.apache.bookkeeper.client.AsyncCallback.ReadLastConfirmedCallback, Object)
     *
     * @param cb
```

### UnnecessaryFullyQualifiedName
Qualifier `java.lang` is unnecessary and can be removed
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
     *
     * @see #readEntries(long, long)
     * @see #asyncReadUnconfirmedEntries(long, long, ReadCallback, java.lang.Object)
     * @see #asyncReadLastConfirmed(ReadLastConfirmedCallback, java.lang.Object)
     */
```

### UnnecessaryFullyQualifiedName
Qualifier `java.lang` is unnecessary and can be removed
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/LedgerHandle.java`
#### Snippet
```java
     * @see #readEntries(long, long)
     * @see #asyncReadUnconfirmedEntries(long, long, ReadCallback, java.lang.Object)
     * @see #asyncReadLastConfirmed(ReadLastConfirmedCallback, java.lang.Object)
     */
    public Enumeration<LedgerEntry> readUnconfirmedEntries(long firstEntry, long lastEntry)
```

### UnnecessaryFullyQualifiedName
Qualifier `java.util.concurrent` is unnecessary and can be removed
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/api/OpBuilder.java`
#### Snippet
```java
     * @return an handle to access the result of the operation
     *
     * @see FutureUtils#result(java.util.concurrent.CompletableFuture) to have a simple method to access the result
     */
    CompletableFuture<T> execute();
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.bookkeeper.client.api` is unnecessary and can be removed
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/api/Handle.java`
#### Snippet
```java
     * Close this handle synchronously.
     *
     * @throws org.apache.bookkeeper.client.api.BKException
     * @throws java.lang.InterruptedException
     * @see #closeAsync
```

### UnnecessaryFullyQualifiedName
Qualifier `java.lang` is unnecessary and can be removed
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/api/Handle.java`
#### Snippet
```java
     *
     * @throws org.apache.bookkeeper.client.api.BKException
     * @throws java.lang.InterruptedException
     * @see #closeAsync
     */
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.bookkeeper.client.api` is unnecessary and can be removed
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/impl/BookKeeperBuilderImpl.java`
#### Snippet
```java

/**
 * Internal builder for {@link org.apache.bookkeeper.client.api.BookKeeper} client.
 *
 * @since 4.6
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.bookkeeper.client` is unnecessary and can be removed
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ZoneawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
    @Override
    public BookieNode selectFromNetworkLocation(String networkLoc, Set<Node> excludeBookies,
            org.apache.bookkeeper.client.ITopologyAwareEnsemblePlacementPolicy.Predicate<BookieNode> predicate,
            org.apache.bookkeeper.client.ITopologyAwareEnsemblePlacementPolicy.Ensemble<BookieNode> ensemble,
            boolean fallbackToRandom) throws BKNotEnoughBookiesException {
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.bookkeeper.client` is unnecessary and can be removed
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ZoneawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
    public BookieNode selectFromNetworkLocation(String networkLoc, Set<Node> excludeBookies,
            org.apache.bookkeeper.client.ITopologyAwareEnsemblePlacementPolicy.Predicate<BookieNode> predicate,
            org.apache.bookkeeper.client.ITopologyAwareEnsemblePlacementPolicy.Ensemble<BookieNode> ensemble,
            boolean fallbackToRandom) throws BKNotEnoughBookiesException {
        throw new UnsupportedOperationException(
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.bookkeeper.client` is unnecessary and can be removed
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ZoneawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
    @Override
    public BookieNode selectFromNetworkLocation(Set<String> excludeRacks, Set<Node> excludeBookies,
            org.apache.bookkeeper.client.ITopologyAwareEnsemblePlacementPolicy.Predicate<BookieNode> predicate,
            org.apache.bookkeeper.client.ITopologyAwareEnsemblePlacementPolicy.Ensemble<BookieNode> ensemble,
            boolean fallbackToRandom) throws BKNotEnoughBookiesException {
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.bookkeeper.client` is unnecessary and can be removed
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ZoneawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
    public BookieNode selectFromNetworkLocation(Set<String> excludeRacks, Set<Node> excludeBookies,
            org.apache.bookkeeper.client.ITopologyAwareEnsemblePlacementPolicy.Predicate<BookieNode> predicate,
            org.apache.bookkeeper.client.ITopologyAwareEnsemblePlacementPolicy.Ensemble<BookieNode> ensemble,
            boolean fallbackToRandom) throws BKNotEnoughBookiesException {
        throw new UnsupportedOperationException(
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.bookkeeper.client` is unnecessary and can be removed
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ZoneawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
    public PlacementResult<List<BookieId>> newEnsemble(int ensembleSize, int writeQuorumSize,
            int ackQuorumSize, Set<BookieId> excludeBookies,
            org.apache.bookkeeper.client.ITopologyAwareEnsemblePlacementPolicy.Ensemble<BookieNode> parentEnsemble,
            org.apache.bookkeeper.client.ITopologyAwareEnsemblePlacementPolicy.Predicate<BookieNode> parentPredicate)
            throws BKNotEnoughBookiesException {
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.bookkeeper.client` is unnecessary and can be removed
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ZoneawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
            int ackQuorumSize, Set<BookieId> excludeBookies,
            org.apache.bookkeeper.client.ITopologyAwareEnsemblePlacementPolicy.Ensemble<BookieNode> parentEnsemble,
            org.apache.bookkeeper.client.ITopologyAwareEnsemblePlacementPolicy.Predicate<BookieNode> parentPredicate)
            throws BKNotEnoughBookiesException {
        throw new UnsupportedOperationException(
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.bookkeeper.client` is unnecessary and can be removed
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ZoneawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
    @Override
    public BookieNode selectFromNetworkLocation(String networkLoc, Set<String> excludeRacks, Set<Node> excludeBookies,
            org.apache.bookkeeper.client.ITopologyAwareEnsemblePlacementPolicy.Predicate<BookieNode> predicate,
            org.apache.bookkeeper.client.ITopologyAwareEnsemblePlacementPolicy.Ensemble<BookieNode> ensemble,
            boolean fallbackToRandom) throws BKNotEnoughBookiesException {
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.bookkeeper.client` is unnecessary and can be removed
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ZoneawareEnsemblePlacementPolicyImpl.java`
#### Snippet
```java
    public BookieNode selectFromNetworkLocation(String networkLoc, Set<String> excludeRacks, Set<Node> excludeBookies,
            org.apache.bookkeeper.client.ITopologyAwareEnsemblePlacementPolicy.Predicate<BookieNode> predicate,
            org.apache.bookkeeper.client.ITopologyAwareEnsemblePlacementPolicy.Ensemble<BookieNode> ensemble,
            boolean fallbackToRandom) throws BKNotEnoughBookiesException {
        throw new UnsupportedOperationException(
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.bookkeeper.common.component` is unnecessary and can be removed
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/Main.java`
#### Snippet
```java
 * A bookie server is a server that run bookie and serving rpc requests.
 *
 * <p>It is a rewritten server using {@link org.apache.bookkeeper.common.component.LifecycleComponent},
 * replacing the legacy server {@link org.apache.bookkeeper.proto.BookieServer}.
 */
```

### UnnecessaryFullyQualifiedName
Qualifier `java.lang` is unnecessary and can be removed
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/EmbeddedServer.java`
#### Snippet
```java
         *
         * @return lifecycle stack
         * @throws java.lang.Exception
         */
        public EmbeddedServer build() throws Exception {
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.bookkeeper.client` is unnecessary and can be removed
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/server/EmbeddedServer.java`
#### Snippet
```java

                EntryCopier copier = new EntryCopierImpl(bookieId,
                        ((org.apache.bookkeeper.client.BookKeeper) bkc).getClientCtx().getBookieClient(),
                        storage, Ticker.systemTicker());

```

### UnnecessaryFullyQualifiedName
Qualifier `io.etcd.jetcd.op` is unnecessary, and can be replaced with an import
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdLayoutManager.java`
#### Snippet
```java
        TxnResponse response = ioResult(kvClient.txn()
            .If(new Cmp(layoutKey, Cmp.Op.GREATER, CmpTarget.createRevision(0)))
            .Then(io.etcd.jetcd.op.Op.get(layoutKey, GetOption.DEFAULT))
            .Else(io.etcd.jetcd.op.Op.put(layoutKey, layoutData, PutOption.DEFAULT))
            .commit());
```

### UnnecessaryFullyQualifiedName
Qualifier `io.etcd.jetcd.op` is unnecessary, and can be replaced with an import
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdLayoutManager.java`
#### Snippet
```java
            .If(new Cmp(layoutKey, Cmp.Op.GREATER, CmpTarget.createRevision(0)))
            .Then(io.etcd.jetcd.op.Op.get(layoutKey, GetOption.DEFAULT))
            .Else(io.etcd.jetcd.op.Op.put(layoutKey, layoutData, PutOption.DEFAULT))
            .commit());
        // key doesn't exist and we created the key
```

### UnnecessaryFullyQualifiedName
Qualifier `io.etcd.jetcd.op` is unnecessary, and can be replaced with an import
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdLedgerManager.java`
#### Snippet
```java
                Cmp.Op.EQUAL,
                CmpTarget.modRevision(lv.getLongVersion())))
            .Then(io.etcd.jetcd.op.Op.put(
                ledgerKeyBs,
                valueBs,
```

### UnnecessaryFullyQualifiedName
Qualifier `io.etcd.jetcd.op` is unnecessary, and can be replaced with an import
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdLedgerManager.java`
#### Snippet
```java
                valueBs,
                PutOption.DEFAULT))
            .Else(io.etcd.jetcd.op.Op.get(
                ledgerKeyBs,
                GetOption.DEFAULT))
```

### UnnecessaryFullyQualifiedName
Qualifier `io.etcd.jetcd.op` is unnecessary, and can be replaced with an import
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdLedgerManager.java`
#### Snippet
```java
        }
        txn
            .Then(io.etcd.jetcd.op.Op.delete(
                ledgerKeyBs,
                DeleteOption.DEFAULT
```

### UnnecessaryFullyQualifiedName
Qualifier `io.etcd.jetcd.op` is unnecessary, and can be replaced with an import
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdLedgerManager.java`
#### Snippet
```java
                DeleteOption.DEFAULT
            ))
            .Else(io.etcd.jetcd.op.Op.get(
                ledgerKeyBs,
                GetOption.DEFAULT
```

### UnnecessaryFullyQualifiedName
Qualifier `io.etcd.jetcd.op` is unnecessary, and can be replaced with an import
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdLedgerManager.java`
#### Snippet
```java
                Cmp.Op.GREATER,
                CmpTarget.createRevision(0L)))
            .Then(io.etcd.jetcd.op.Op.get(
                ledgerKeyBs,
                GetOption.newBuilder()
```

### UnnecessaryFullyQualifiedName
Qualifier `io.etcd.jetcd.op` is unnecessary, and can be replaced with an import
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdLedgerManager.java`
#### Snippet
```java
                    .withCountOnly(true)
                    .build()))
            .Else(io.etcd.jetcd.op.Op.put(
                ledgerKeyBs,
                valueBs,
```

### UnnecessaryFullyQualifiedName
Qualifier `com.google.common.base` is unnecessary, and can be replaced with an import
in `cpu-affinity/src/main/java/org/apache/bookkeeper/common/util/affinity/impl/NativeUtils.java`
#### Snippet
```java
            justification = "work around for java 9: https://github.com/spotbugs/spotbugs/issues/493")
    public static void loadLibraryFromJar(String path) throws Exception {
        com.google.common.base.Preconditions.checkArgument(path.startsWith("/"), "absolute path must start with /");

        String[] parts = path.split("/");
```

### UnnecessaryFullyQualifiedName
Qualifier `com.google.common.base` is unnecessary, and can be replaced with an import
in `cpu-affinity/src/main/java/org/apache/bookkeeper/common/util/affinity/impl/ProcessorsInfo.java`
#### Snippet
```java
            }

            com.google.common.base.Preconditions.checkArgument(cpuId >= 0);
            com.google.common.base.Preconditions.checkArgument(coreId >= 0);
            pi.cpus.put(cpuId, coreId);
```

### UnnecessaryFullyQualifiedName
Qualifier `com.google.common.base` is unnecessary, and can be replaced with an import
in `cpu-affinity/src/main/java/org/apache/bookkeeper/common/util/affinity/impl/ProcessorsInfo.java`
#### Snippet
```java

            com.google.common.base.Preconditions.checkArgument(cpuId >= 0);
            com.google.common.base.Preconditions.checkArgument(coreId >= 0);
            pi.cpus.put(cpuId, coreId);
        }
```

### UnnecessaryFullyQualifiedName
Qualifier `java.io` is unnecessary and can be removed
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LocalDLMEmulator.java`
#### Snippet
```java
     * @param count number of bookies required
     * @param timeout number of seconds to wait for bookies to start
     * @throws java.io.IOException if bookies are not started by the time the timeout hits
     */
    public int checkBookiesUp(int count, int timeout) throws Exception {
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.bookkeeper.conf` is unnecessary and can be removed
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/DistributedLogConfiguration.java`
#### Snippet
```java
 * </pre>
 *
 * @see org.apache.bookkeeper.conf.ClientConfiguration
 */
public class DistributedLogConfiguration extends CompositeConfiguration {
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.distributedlog` is unnecessary and can be removed
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/DistributedLogConfiguration.java`
#### Snippet
```java
     *
     * @return layout version
     * @see org.apache.distributedlog.LogSegmentMetadata.LogSegmentMetadataVersion
     */
    public int getDLLedgerMetadataLayoutVersion() {
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.distributedlog` is unnecessary and can be removed
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/DistributedLogConfiguration.java`
#### Snippet
```java
     *
     * @return whether truncation managed explicitly by the application
     * @see org.apache.distributedlog.LogSegmentMetadata.TruncationStatus
     */
    public boolean getExplicitTruncationByApplication() {
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.distributedlog` is unnecessary and can be removed
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/DistributedLogConfiguration.java`
#### Snippet
```java
     *
     * @return whether we should enforce the min ledger metadata version check
     * @see org.apache.distributedlog.LogSegmentMetadata.LogSegmentMetadataVersion
     */
    public boolean getDLLedgerMetadataSkipMinVersionCheck() {
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.distributedlog.logsegment` is unnecessary and can be removed
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/ReadAheadEntryReader.java`
#### Snippet
```java

/**
 * New ReadAhead Reader that uses {@link org.apache.distributedlog.logsegment.LogSegmentEntryReader}.
 *
 * <p>NOTE: all the state changes happen in the same thread. All *unsafe* methods should be submitted to the order
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.bookkeeper.versioning` is unnecessary and can be removed
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/zk/ZKVersionedSetOp.java`
#### Snippet
```java

/**
 * ZooKeeper Operation that plays with {@link org.apache.bookkeeper.versioning.Version}.
 */
public class ZKVersionedSetOp extends ZKOp {
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.distributedlog.api` is unnecessary, and can be replaced with an import
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/ZKMetadataAccessor.java`
#### Snippet
```java
 */
@SuppressWarnings("deprecation")
public class ZKMetadataAccessor implements org.apache.distributedlog.api.MetadataAccessor {
    static final Logger LOG = LoggerFactory.getLogger(ZKMetadataAccessor.class);
    protected final String name;
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.distributedlog.api` is unnecessary, and can be replaced with an import
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/BKNamespaceDriver.java`
#### Snippet
```java
    @SuppressWarnings("deprecation")
    @Override
    public org.apache.distributedlog.api.MetadataAccessor getMetadataAccessor(String streamName)
            throws InvalidStreamNameException, IOException {
        if (getBkdlConfig().isFederatedNamespace()) {
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.distributedlog.acl` is unnecessary and can be removed
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/acl/ZKAccessControlManager.java`
#### Snippet
```java

/**
 * ZooKeeper Based {@link org.apache.distributedlog.acl.AccessControlManager}.
 */
public class ZKAccessControlManager implements AccessControlManager, Watcher {
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.zookeeper` is unnecessary, and can be replaced with an import
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
            return;
        }
        org.apache.zookeeper.Op zkSetDataOp = org.apache.zookeeper.Op.setData(
                allocatePath, DistributedLogConstants.EMPTY_BYTES, (int) version.getLongVersion());
        ZKVersionedSetOp commitOp = new ZKVersionedSetOp(zkSetDataOp, this);
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.zookeeper` is unnecessary, and can be replaced with an import
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
            return;
        }
        org.apache.zookeeper.Op zkSetDataOp = org.apache.zookeeper.Op.setData(
                allocatePath, DistributedLogConstants.EMPTY_BYTES, (int) version.getLongVersion());
        ZKVersionedSetOp commitOp = new ZKVersionedSetOp(zkSetDataOp, this);
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.bookkeeper.zookeeper` is unnecessary and can be removed
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/util/RetryPolicyUtils.java`
#### Snippet
```java

/**
 * Utils for {@link org.apache.bookkeeper.zookeeper.RetryPolicy}.
 */
public class RetryPolicyUtils {
```

### UnnecessaryFullyQualifiedName
Qualifier `java.io` is unnecessary and can be removed
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKDistributedLogManager.java`
#### Snippet
```java
     *
     * @return the last log record in the stream
     * @throws java.io.IOException if a stream cannot be found.
     */
    @Override
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.commons.cli` is unnecessary and can be removed
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/Tool.java`
#### Snippet
```java

    /**
     * {@link org.apache.commons.cli.Options} based command.
     */
    protected abstract static class OptsCommand implements Command {
```

### UnnecessaryFullyQualifiedName
Qualifier `java.util` is unnecessary and can be removed
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/injector/AsyncRandomFailureInjector.java`
#### Snippet
```java

/**
 * Failure injector based on {@link java.util.Random}.
 */
public class AsyncRandomFailureInjector implements AsyncFailureInjector {
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.distributedlog.api` is unnecessary, and can be replaced with an import
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/namespace/NamespaceDriver.java`
#### Snippet
```java
     */
    @SuppressWarnings("deprecation")
    org.apache.distributedlog.api.MetadataAccessor getMetadataAccessor(String streamName)
            throws InvalidStreamNameException, IOException;

```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.distributedlog` is unnecessary and can be removed
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/logsegment/LogSegmentRandomAccessEntryReader.java`
#### Snippet
```java

/**
 * An interface class to read entries {@link org.apache.distributedlog.Entry}
 * from a random access log segment.
 */
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.distributedlog` is unnecessary and can be removed
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/logsegment/LogSegmentEntryReader.java`
#### Snippet
```java
/**
 * An interface class to read the enveloped entry (serialized bytes of
 * {@link org.apache.distributedlog.Entry}) from a log segment.
 */
@Beta
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.zookeeper` is unnecessary and can be removed
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/metadata/ZKLogStreamMetadataStore.java`
#### Snippet
```java
        Utils.zkAsyncCreateFullPathOptimisticRecursive(zooKeeperClient, readLockPath, parentPathShouldNotCreate,
                new byte[0], zooKeeperClient.getDefaultACL(), CreateMode.PERSISTENT,
                new org.apache.zookeeper.AsyncCallback.StringCallback() {
                    @Override
                    public void processResult(final int rc, final String path, Object ctx, String name) {
```

### UnnecessaryFullyQualifiedName
Qualifier `io.grpc` is unnecessary and can be removed
in `stream/common/src/main/java/org/apache/bookkeeper/common/grpc/proxy/ChannelFinder.java`
#### Snippet
```java

/**
 * Find a grpc {@link io.grpc.Channel} to route the requests.
 */
public interface ChannelFinder {
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.distributedlog.exceptions` is unnecessary and can be removed
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/lock/ZKSessionLock.java`
#### Snippet
```java
 * <p>
 * 0. if it is an immediate lock, it would get lock waiters first. if the lock is already held by someone.
 *    it would fail immediately with {@link org.apache.distributedlog.exceptions.OwnershipAcquireFailedException}
 *    with current owner. if there is no lock waiters, it would start locking procedure from 1.
 * 1. prepare: create a sequential znode to identify the lock.
```

### UnnecessaryFullyQualifiedName
Qualifier `io.netty.buffer` is unnecessary and can be removed
in `stream/common/src/main/java/org/apache/bookkeeper/common/router/ByteBufHashRouter.java`
#### Snippet
```java

/**
 * Compute a hash value for an {@link io.netty.buffer.ByteBuf}.
 */
public class ByteBufHashRouter extends AbstractHashRouter<ByteBuf> {
```

### UnnecessaryFullyQualifiedName
Qualifier `com.google.common.util.concurrent` is unnecessary and can be removed
in `stream/common/src/main/java/org/apache/bookkeeper/common/util/ListenableFutures.java`
#### Snippet
```java

/**
 * Utils to convert {@link com.google.common.util.concurrent.ListenableFuture} to
 * java {@link java.util.concurrent.CompletableFuture}.
 */
```

### UnnecessaryFullyQualifiedName
Qualifier `java.util.concurrent` is unnecessary and can be removed
in `stream/common/src/main/java/org/apache/bookkeeper/common/util/ListenableFutures.java`
#### Snippet
```java
/**
 * Utils to convert {@link com.google.common.util.concurrent.ListenableFuture} to
 * java {@link java.util.concurrent.CompletableFuture}.
 */
@NoArgsConstructor(access = AccessLevel.PRIVATE)
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.bookkeeper.common.net` is unnecessary and can be removed
in `stream/common/src/main/java/org/apache/bookkeeper/common/resolver/ServiceNameResolverProvider.java`
#### Snippet
```java
/**
 * An implementation of {@link NameResolverProvider} that provides {@link NameResolver}s
 * to resolve {@link org.apache.bookkeeper.common.net.ServiceURI}.
 */
@Slf4j
```

### UnnecessaryFullyQualifiedName
Qualifier `io.grpc` is unnecessary and can be removed
in `stream/common/src/main/java/org/apache/bookkeeper/common/resolver/NameResolverProviderFactory.java`
#### Snippet
```java

/**
 * A {@link io.grpc.NameResolverProvider} based {@link NameResolver.Factory}.
 */
public class NameResolverProviderFactory extends NameResolver.Factory {
```

### UnnecessaryFullyQualifiedName
Qualifier `io.grpc` is unnecessary and can be removed
in `stream/common/src/main/java/org/apache/bookkeeper/common/resolver/AbstractNameResolver.java`
#### Snippet
```java
 * The abstract bookkeeper name resolver.
 *
 * <p>The bookkeeper name resolvers should extend this one instead of {@link io.grpc.NameResolver}.
 */
public abstract class AbstractNameResolver extends NameResolver {
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.distributedlog.api` is unnecessary, and can be replaced with an import
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                    continue;
                }
                org.apache.distributedlog.api.MetadataAccessor accessor =
                        namespace.getNamespaceDriver().getMetadataAccessor(streamName);
                byte[] metadata = accessor.getMetadata();
```

### UnnecessaryFullyQualifiedName
Qualifier `lombok` is unnecessary, and can be replaced with an import
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/CheckpointFile.java`
#### Snippet
```java
 */
@Slf4j
@lombok.Builder
@lombok.EqualsAndHashCode
public class CheckpointFile {
```

### UnnecessaryFullyQualifiedName
Qualifier `lombok` is unnecessary, and can be replaced with an import
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/CheckpointFile.java`
#### Snippet
```java
@Slf4j
@lombok.Builder
@lombok.EqualsAndHashCode
public class CheckpointFile {
    private final File file;
```

### UnnecessaryFullyQualifiedName
Qualifier `org.rocksdb` is unnecessary and can be removed
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/kv/RocksdbKVStore.java`
#### Snippet
```java
                // does not match the previous TTL, it will apply to any new or updated keys

                try (Options opts = new org.rocksdb.Options(options, cfOpts)) {
                    byte[] wanted = haveTtl ? DATA_TTL_CF : DATA_CF;
                    byte[] other = haveTtl ? DATA_CF : DATA_TTL_CF;
```

### UnnecessaryFullyQualifiedName
Qualifier `java.net` is unnecessary and can be removed
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/net/ServiceURI.java`
#### Snippet
```java
 * <h3>Service URI syntax and components</h3>
 *
 * <p>At the highest level a service uri is a {@link java.net.URI} in string
 * form has the syntax.
 *
```

### UnnecessaryFullyQualifiedName
Qualifier `java.net` is unnecessary and can be removed
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/net/ServiceURI.java`
#### Snippet
```java
 *
 * <p>The authority component of a service URI has the same meaning as the authority component
 * in a {@link java.net.URI}. If specified, it should be <i>server-based</i>. A server-based
 * authority parses according to the familiar syntax
 *
```

### UnnecessaryFullyQualifiedName
Qualifier `java.util.stream` is unnecessary and can be removed
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/Backoff.java`
#### Snippet
```java
 * Implements various backoff strategies.
 *
 * <p>Strategies are defined by a {@link java.util.stream.Stream} of durations
 * and are intended to determine the duration after which a task is to be
 * retried.
```

### UnnecessaryFullyQualifiedName
Qualifier `java.util.stream` is unnecessary and can be removed
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/StreamUtil.java`
#### Snippet
```java

/**
 * Java {@link java.util.stream.Stream} related operations.
 */
public class StreamUtil {
```

### UnnecessaryFullyQualifiedName
Qualifier `java.util.concurrent` is unnecessary, and can be replaced with an import
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/concurrent/FutureUtils.java`
#### Snippet
```java
        }
        // schedule a timeout to raise timeout exception
        final java.util.concurrent.ScheduledFuture<?> task = scheduler.scheduleOrdered(key, () -> {
            if (!promise.isDone() && promise.completeExceptionally(cause)) {
                log.info("Raise exception", cause);
```

## RuleId[id=ThrowablePrintStackTrace]
### ThrowablePrintStackTrace
Call to `printStackTrace()` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookie/CheckDBLedgersIndexCommand.java`
#### Snippet
```java
            return success;
        } catch (IOException e) {
            e.printStackTrace();
            return false;
        }
```

### ThrowablePrintStackTrace
Call to `printStackTrace()` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookie/RebuildDBLedgerLocationsIndexCommand.java`
#### Snippet
```java
            new LocationsIndexRebuildOp(serverConfiguration).initiate();
        } catch (IOException e) {
            e.printStackTrace();
        }
        LOG.info("-- Done rebuilding DBStorage locations index --");
```

### ThrowablePrintStackTrace
Call to `printStackTrace()` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/tools/cli/commands/bookies/InfoCommand.java`
#### Snippet
```java
            return true;
        } catch (IOException | InterruptedException | BKException e) {
            e.printStackTrace();
        }
        return true;
```

### ThrowablePrintStackTrace
Call to `printStackTrace()` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifierMain.java`
#### Snippet
```java
            verifier.run();
        } catch (Exception e) {
            e.printStackTrace();
            System.exit(1);
        } finally {
```

### ThrowablePrintStackTrace
Call to `printStackTrace()` should probably be replaced with more robust logging
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/verifier/BookkeeperVerifier.java`
#### Snippet
```java
            for (Exception e: errors) {
                System.out.format("Error found: %s%n", e.toString());
                e.printStackTrace();
            }
            throw errors.poll();
```

### ThrowablePrintStackTrace
Call to `printStackTrace()` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/Tool.java`
#### Snippet
```java
        } catch (Throwable t) {
            System.err.println("Fail to run tool " + toolClass + " : ");
            t.printStackTrace();
        }
        System.exit(rc);
```

### ThrowablePrintStackTrace
Call to `printStackTrace()` should probably be replaced with more robust logging
in `bookkeeper-benchmark/src/main/java/org/apache/bookkeeper/benchmark/BenchThroughputLatency.java`
#### Snippet
```java
            }
        } catch (BKException e) {
            e.printStackTrace();
        }
    }
```

### ThrowablePrintStackTrace
Call to `printStackTrace()` should probably be replaced with more robust logging
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                        public void onFailure(Throwable cause) {
                            System.out.println("Failed to delete subscriber for stream " + s);
                            cause.printStackTrace();
                            countDownLatch.countDown();
                        }
```

## RuleId[id=Anonymous2MethodRef]
### Anonymous2MethodRef
Anonymous new Runnable() can be replaced with method reference
in `stream/distributedlog/common/src/main/java/org/apache/distributedlog/common/config/ConfigurationSubscription.java`
#### Snippet
```java

    private void scheduleReload() {
        executorService.scheduleAtFixedRate(new Runnable() {
            @Override
            public void run() {
```

### Anonymous2MethodRef
Anonymous new SubTreeCache.TreeProvider() can be replaced with method reference
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/ZkLedgerUnderreplicationManager.java`
#### Snippet
```java
        idExtractionPattern = Pattern.compile("urL(\\d+)$");
        this.zkc = zkc;
        this.subTreeCache = new SubTreeCache(new SubTreeCache.TreeProvider() {
            @Override
            public List<String> getChildren(String path, Watcher watcher) throws InterruptedException, KeeperException {
```

### Anonymous2MethodRef
Anonymous new Runnable() can be replaced with method reference
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookkeeperInternalCallbacks.java`
#### Snippet
```java
            if (null != callbackExecutor) {
                try {
                    callbackExecutor.submit(new Runnable() {
                        @Override
                        public void run() {
```

### Anonymous2MethodRef
Anonymous new RemovalListener() can be replaced with method reference
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryLogManagerForEntryLogPerLedger.java`
#### Snippet
```java
                .expireAfterAccess(entrylogMapAccessExpiryTimeInSeconds, TimeUnit.SECONDS)
                .maximumSize(maximumNumberOfActiveEntryLogs)
                .removalListener(new RemovalListener<Long, EntryLogAndLockTuple>() {
                    @Override
                    public void onRemoval(
```

### Anonymous2MethodRef
Anonymous new LedgerStorage.LedgerDeletionListener() can be replaced with method reference
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieImpl.java`
#### Snippet
```java
        }

        LedgerStorage.LedgerDeletionListener ledgerDeletionListener = new LedgerStorage.LedgerDeletionListener() {
            @Override
            public void ledgerDeleted(long ledgerId) {
```

### Anonymous2MethodRef
Anonymous new com.codahale.metrics.Gauge() can be replaced with method reference
in `stats/bookkeeper-stats-providers/codahale-metrics-provider/src/main/java/org/apache/bookkeeper/stats/codahale/CodahaleStatsLogger.java`
#### Snippet
```java
        metrics.remove(metricName);

        metrics.register(metricName, new com.codahale.metrics.Gauge<T>() {
                @Override
                public T getValue() {
```

### Anonymous2MethodRef
Anonymous new Runnable() can be replaced with method reference
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogSegmentWriter.java`
#### Snippet
```java
        this.periodicKeepAliveMs = conf.getPeriodicKeepAliveMilliSeconds();
        if (periodicKeepAliveMs > 0 && scheduler != null) {
            periodicKeepAliveSchedule = scheduler.scheduleAtFixedRate(new Runnable() {
                @Override
                public void run() {
```

### Anonymous2MethodRef
Anonymous new Function\>() can be replaced with method reference
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKDistributedLogManager.java`
#### Snippet
```java

    private CompletableFuture<LogRecordWithDLSN> getFirstRecordAsyncInternal() {
        return processReaderOperation(new Function<BKLogReadHandler, CompletableFuture<LogRecordWithDLSN>>() {
            @Override
            public CompletableFuture<LogRecordWithDLSN> apply(final BKLogReadHandler ledgerHandler) {
```

### Anonymous2MethodRef
Anonymous new BKCommandRunner() can be replaced with method reference
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
        @Override
        protected int runCmd() throws Exception {
            return runBKCommand(new BKCommandRunner() {
                @Override
                public int run(ZooKeeperClient zkc, BookKeeperClient bkc) throws Exception {
```

### Anonymous2MethodRef
Anonymous new SafeRunnable() can be replaced with method reference
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/SafeRunnable.java`
#### Snippet
```java
     */
    static SafeRunnable safeRun(Runnable runnable) {
        return new SafeRunnable() {
            @Override
            public void safeRun() {
```

## RuleId[id=Java8MapApi]
### Java8MapApi
Can be replaced with single 'Map.computeIfAbsent' method call
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/AuditorReplicasCheckTask.java`
#### Snippet
```java
                    List<BookieExpectedToContainSegmentInfo> bookieSegmentInfoList = bookiesSegmentInfoMap
                            .get(bookieInEnsemble);
                    if (bookieSegmentInfoList == null) {
                        bookieSegmentInfoList = new ArrayList<BookieExpectedToContainSegmentInfo>();
                        bookiesSegmentInfoMap.put(bookieInEnsemble, bookieSegmentInfoList);
```

### Java8MapApi
Can be replaced with single 'Map.computeIfAbsent' method call
in `stats/utils/src/main/java/org/apache/bookkeeper/stats/utils/StatsDocGenerator.java`
#### Snippet
```java
    private NavigableMap<String, StatsDocEntry> getCategoryMap(String category) {
        NavigableMap<String, StatsDocEntry> categoryMap = docEntries.get(category);
        if (null == categoryMap) {
            categoryMap = new TreeMap<>();
            docEntries.put(category, categoryMap);
```

## RuleId[id=Convert2Lambda]
### Convert2Lambda
Anonymous new Runnable() can be replaced with lambda
in `stream/distributedlog/common/src/main/java/org/apache/distributedlog/common/config/ConfigurationSubscription.java`
#### Snippet
```java

    private void scheduleReload() {
        executorService.scheduleAtFixedRate(new Runnable() {
            @Override
            public void run() {
```

### Convert2Lambda
Anonymous new Runnable() can be replaced with lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/AbstractHierarchicalLedgerManager.java`
#### Snippet
```java
                    final T dataToProcess = data.get(next);
                    final AsyncCallback.VoidCallback stub = this;
                    scheduler.submit(new Runnable() {
                        @Override
                        public void run() {
```

### Convert2Lambda
Anonymous new Runnable() can be replaced with lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/proto/BookkeeperInternalCallbacks.java`
#### Snippet
```java
            if (null != callbackExecutor) {
                try {
                    callbackExecutor.submit(new Runnable() {
                        @Override
                        public void run() {
```

### Convert2Lambda
Anonymous new Runnable() can be replaced with lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/SortedLedgerStorage.java`
#### Snippet
```java
        // The only exception for the size limitation is if a file grows to be more than hard limit 2GB,
        // we have to force rolling log, which it might cause slight performance effects
        scheduler.execute(new Runnable() {
            @Override
            public void run() {
```

### Convert2Lambda
Anonymous new RemovalListener() can be replaced with lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryLogManagerForEntryLogPerLedger.java`
#### Snippet
```java
                .expireAfterAccess(entrylogMapAccessExpiryTimeInSeconds, TimeUnit.SECONDS)
                .maximumSize(maximumNumberOfActiveEntryLogs)
                .removalListener(new RemovalListener<Long, EntryLogAndLockTuple>() {
                    @Override
                    public void onRemoval(
```

### Convert2Lambda
Anonymous new RemovalListener() can be replaced with lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/EntryLogManagerForEntryLogPerLedger.java`
#### Snippet
```java
                            TimeUnit.SECONDS)
                    .maximumSize(maximumNumberOfActiveEntryLogs * entryLogPerLedgerCounterLimitsMultFactor)
                    .removalListener(new RemovalListener<Long, MutableInt>() {
                        @Override
                        public void onRemoval(RemovalNotification<Long, MutableInt> removedEntryFromCounterMap) {
```

### Convert2Lambda
Anonymous new FilenameFilter() can be replaced with lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/FileSystemUpgrade.java`
#### Snippet
```java
                    c.writeToDirectory(tmpDir);

                    String[] files = d.list(new FilenameFilter() {
                            @Override
                            public boolean accept(File dir, String name) {
```

### Convert2Lambda
Anonymous new FilenameFilter() can be replaced with lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/DefaultEntryLogger.java`
#### Snippet
```java
        Set<Long> entryLogs = Sets.newTreeSet();

        final FilenameFilter logFileFilter = new FilenameFilter() {
            @Override
            public boolean accept(File dir, String name) {
```

### Convert2Lambda
Anonymous new Callable() can be replaced with lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieStateManager.java`
#### Snippet
```java
    @Override
    public Future<Void> transitionToWritableMode() {
        return stateService.submit(new Callable<Void>() {
            @Override
            public Void call() throws Exception{
```

### Convert2Lambda
Anonymous new Callable() can be replaced with lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieStateManager.java`
#### Snippet
```java
    @Override
    public Future<Void> registerBookie(final boolean throwException) {
        return stateService.submit(new Callable<Void>() {
            @Override
            public Void call() throws IOException {
```

### Convert2Lambda
Anonymous new Callable() can be replaced with lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieStateManager.java`
#### Snippet
```java
    @Override
    public Future<Void> transitionToReadOnlyMode() {
        return stateService.submit(new Callable<Void>() {
            @Override
            public Void call() throws Exception{
```

### Convert2Lambda
Anonymous new Comparator() can be replaced with lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/IndexPersistenceMgr.java`
#### Snippet
```java
        CachedFileInfo fi = null;
        try {
            Collections.sort(entries, new Comparator<LedgerEntryPage>() {
                @Override
                public int compare(LedgerEntryPage o1, LedgerEntryPage o2) {
```

### Convert2Lambda
Anonymous new FilenameFilter() can be replaced with lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/BookieImpl.java`
#### Snippet
```java

            final AtomicBoolean oldDataExists = new AtomicBoolean(false);
            parent.list(new FilenameFilter() {
                    @Override
                    public boolean accept(File dir, String name) {
```

### Convert2Lambda
Anonymous new Predicate() can be replaced with lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/LedgerMetadataIndex.java`
#### Snippet
```java
    public Iterable<Long> getActiveLedgersInRange(final long firstLedgerId, final long lastLedgerId)
            throws IOException {
        return Iterables.filter(ledgers.keys(), new Predicate<Long>() {
            @Override
            public boolean apply(Long ledgerId) {
```

### Convert2Lambda
Anonymous new Comparator() can be replaced with lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/WeightedRandomSelectionImpl.java`
#### Snippet
```java
        Long totalWeight = 0L, min = Long.MAX_VALUE;
        List<WeightedObject> values = new ArrayList<WeightedObject>(map.values());
        Collections.sort(values, new Comparator<WeightedObject>() {
            @Override
            public int compare(WeightedObject o1, WeightedObject o2) {
```

### Convert2Lambda
Anonymous new Runnable() can be replaced with lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/DefaultSpeculativeRequestExecutionPolicy.java`
#### Snippet
```java
                                         final int speculativeRequestTimeout) {
        try {
            return scheduler.schedule(new Runnable() {
                @Override
                public void run() {
```

### Convert2Lambda
Anonymous new Runnable() can be replaced with lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/MSLedgerManagerFactory.java`
#### Snippet
```java
                    final T dataToProcess = iter.next();
                    final AsyncCallback.VoidCallback stub = this;
                    scheduler.submit(new Runnable() {
                        @Override
                        public void run() {
```

### Convert2Lambda
Anonymous new Runnable() can be replaced with lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/MSLedgerManagerFactory.java`
#### Snippet
```java
                                 final AsyncCallback.VoidCallback finalCb, final Object context,
                                 final int successRc, final int failureRc) {
            scheduler.submit(new Runnable() {
                @Override
                public void run() {
```

### Convert2Lambda
Anonymous new Callable() can be replaced with lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/ReadLastConfirmedAndEntryOp.java`
#### Snippet
```java
    @Override
    public ListenableFuture<Boolean> issueSpeculativeRequest() {
        return clientCtx.getMainWorkerPool().submitOrdered(lh.getId(), new Callable<Boolean>() {
            @Override
            public Boolean call() throws Exception {
```

### Convert2Lambda
Anonymous new Runnable() can be replaced with lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookieInfoReader.java`
#### Snippet
```java
                        public void getBookieInfoComplete(final int rc, final BookieInfo bInfo, final Object ctx) {
                            scheduler.submit(
                                new Runnable() {
                                    @Override
                                    public void run() {
```

### Convert2Lambda
Anonymous new RemovalListener() can be replaced with lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookieWatcherImpl.java`
#### Snippet
```java
        this.quarantinedBookies = CacheBuilder.newBuilder()
                .expireAfterWrite(conf.getBookieQuarantineTimeSeconds(), TimeUnit.SECONDS)
                .removalListener(new RemovalListener<BookieId, Boolean>() {

                    @Override
```

### Convert2Lambda
Anonymous new Runnable() can be replaced with lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/metastore/InMemoryMetastoreCursor.java`
#### Snippet
```java
    @Override
    public void asyncReadEntries(final int numEntries, final ReadEntriesCallback cb, final Object ctx) {
        scheduler.submit(new Runnable() {
            @Override
            public void run() {
```

### Convert2Lambda
Anonymous new Runnable() can be replaced with lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/AuditorElector.java`
#### Snippet
```java
    Future<?> submitElectionTask() {

        Runnable r = new Runnable() {
                @Override
                public void run() {
```

### Convert2Lambda
Anonymous new Runnable() can be replaced with lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/replication/AuditorElector.java`
#### Snippet
```java
     */
    private void submitShutdownTask() {
        executor.submit(new Runnable() {
                @Override
                public void run() {
```

### Convert2Lambda
Anonymous new Function() can be replaced with lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/client/BookKeeperAdmin.java`
#### Snippet
```java
    public static boolean format(ServerConfiguration conf,
            boolean isInteractive, boolean force) throws Exception {
        return runFunctionWithMetadataBookieDriver(conf, new Function<MetadataBookieDriver, Boolean>() {
            @Override
            @SuppressFBWarnings("RCN_REDUNDANT_NULLCHECK_WOULD_HAVE_BEEN_A_NPE")
```

### Convert2Lambda
Anonymous new Runnable() can be replaced with lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/metastore/InMemoryMetastoreTable.java`
#### Snippet
```java
    @Override
    public void get(final String key, final MetastoreCallback<Versioned<Value>> cb, final Object ctx) {
        scheduler.submit(new Runnable() {
            @Override
            public void run() {
```

### Convert2Lambda
Anonymous new Runnable() can be replaced with lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/metastore/InMemoryMetastoreTable.java`
#### Snippet
```java
    public void get(final String key, final MetastoreWatcher watcher, final MetastoreCallback<Versioned<Value>> cb,
            final Object ctx) {
        scheduler.submit(new Runnable() {
            @Override
            public void run() {
```

### Convert2Lambda
Anonymous new Runnable() can be replaced with lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/metastore/InMemoryMetastoreTable.java`
#### Snippet
```java
    public void put(final String key, final Value value, final Version version, final MetastoreCallback<Version> cb,
            final Object ctx) {
        scheduler.submit(new Runnable() {
            @Override
            public void run() {
```

### Convert2Lambda
Anonymous new Runnable() can be replaced with lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/metastore/InMemoryMetastoreTable.java`
#### Snippet
```java
                           final Order order, final Set<String> fields,
                           final MetastoreCallback<MetastoreCursor> cb, final Object ctx) {
        scheduler.submit(new Runnable() {
            @Override
            public void run() {
```

### Convert2Lambda
Anonymous new Runnable() can be replaced with lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/metastore/InMemoryMetastoreTable.java`
#### Snippet
```java
    @Override
    public void remove(final String key, final Version version, final MetastoreCallback<Void> cb, final Object ctx) {
        scheduler.submit(new Runnable() {
            @Override
            public void run() {
```

### Convert2Lambda
Anonymous new Runnable() can be replaced with lambda
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/metastore/InMemoryMetastoreTable.java`
#### Snippet
```java
    public void get(final String key, final Set<String> fields, final MetastoreCallback<Versioned<Value>> cb,
            final Object ctx) {
        scheduler.submit(new Runnable() {
            @Override
            public void run() {
```

### Convert2Lambda
Anonymous new com.codahale.metrics.Gauge() can be replaced with lambda
in `stats/bookkeeper-stats-providers/codahale-metrics-provider/src/main/java/org/apache/bookkeeper/stats/codahale/CodahaleStatsLogger.java`
#### Snippet
```java
        metrics.remove(metricName);

        metrics.register(metricName, new com.codahale.metrics.Gauge<T>() {
                @Override
                public T getValue() {
```

### Convert2Lambda
Anonymous new Comparator() can be replaced with lambda
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java

    public static final Comparator<LogSegmentMetadata> COMPARATOR =
            new Comparator<LogSegmentMetadata>() {

        public int compare(LogSegmentMetadata o1,
```

### Convert2Lambda
Anonymous new Comparator() can be replaced with lambda
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/LogSegmentMetadata.java`
#### Snippet
```java

    public static final Comparator<LogSegmentMetadata> DESC_COMPARATOR =
            new Comparator<LogSegmentMetadata>() {
        public int compare(LogSegmentMetadata o1,
                           LogSegmentMetadata o2) {
```

### Convert2Lambda
Anonymous new Callable() can be replaced with lambda
in `circe-checksum/src/main/java/com/scurrilous/circe/impl/AbstractHashProvider.java`
#### Snippet
```java
            final HashCache cache = HashCacheLoader.getCache();
            try {
                return cache.get(params, required, new Callable<Hash>() {
                    @Override
                    public Hash call() throws Exception {
```

### Convert2Lambda
Anonymous new Function() can be replaced with lambda
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAbstractLogWriter.java`
#### Snippet
```java
            rollPromise = FutureUtils.value(segmentWriter);
        }
        return rollPromise.thenApply(new Function<BKLogSegmentWriter, BKLogSegmentWriter>() {
            @Override
            public BKLogSegmentWriter apply(BKLogSegmentWriter newSegmentWriter) {
```

### Convert2Lambda
Anonymous new Function\>() can be replaced with lambda
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAbstractLogWriter.java`
#### Snippet
```java
            }
            return writeHandler.asyncStartLogSegment(startTxId, bestEffort, allowMaxTxID)
                    .thenCompose(new Function<BKLogSegmentWriter, CompletableFuture<BKLogSegmentWriter>>() {
                        @Override
                        public CompletableFuture<BKLogSegmentWriter> apply(BKLogSegmentWriter newSegmentWriter) {
```

### Convert2Lambda
Anonymous new Function\>() can be replaced with lambda
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAbstractLogWriter.java`
#### Snippet
```java
            }
            return closeFuture.thenCompose(
                    new Function<Void, CompletionStage<BKLogSegmentWriter>>() {
                @Override
                public CompletableFuture<BKLogSegmentWriter> apply(Void result) {
```

### Convert2Lambda
Anonymous new Function() can be replaced with lambda
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKAbstractLogWriter.java`
#### Snippet
```java
                    if (null != writeHandler && forceRecovery) {
                        return writeHandler.completeAndCloseLogSegment(ledgerWriter)
                                .thenApply(new Function<LogSegmentMetadata, BKLogSegmentWriter>() {
                            @Override
                            public BKLogSegmentWriter apply(LogSegmentMetadata completedLogSegment) {
```

### Convert2Lambda
Anonymous new Runnable() can be replaced with lambda
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogReadHandler.java`
#### Snippet
```java
                    return;
                }
                scheduler.schedule(new Runnable() {
                    @Override
                    public void run() {
```

### Convert2Lambda
Anonymous new Runnable() can be replaced with lambda
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogReadHandler.java`
#### Snippet
```java
                    return;
                }
                scheduler.schedule(new Runnable() {
                    @Override
                    public void run() {
```

### Convert2Lambda
Anonymous new Function, CompletableFuture\>\>() can be replaced with lambda
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogWriteHandler.java`
#### Snippet
```java
        }
        return getCachedLogSegmentsAfterFirstFullFetch(LogSegmentMetadata.COMPARATOR).thenCompose(
                new Function<List<LogSegmentMetadata>, CompletableFuture<List<LogSegmentMetadata>>>() {
            @Override
            public CompletableFuture<List<LogSegmentMetadata>> apply(List<LogSegmentMetadata> logSegments) {
```

### Convert2Lambda
Anonymous new Function, List\>() can be replaced with lambda
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogWriteHandler.java`
#### Snippet
```java
            };
    private final Function<List<LogSegmentMetadata>, List<LogSegmentMetadata>> removeEmptySegments =
        new Function<List<LogSegmentMetadata>, List<LogSegmentMetadata>>() {
            @Override
            public List<LogSegmentMetadata> apply(List<LogSegmentMetadata> segmentList) {
```

### Convert2Lambda
Anonymous new Function\>() can be replaced with lambda
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogHandler.java`
#### Snippet
```java
    public CompletableFuture<Long> asyncGetLogRecordCount(final DLSN beginDLSN) {
        return streamMetadataStore.logExists(logMetadata.getUri(), logMetadata.getLogName())
                .thenCompose(new Function<Void, CompletableFuture<Long>>() {
            public CompletableFuture<Long> apply(Void done) {

```

### Convert2Lambda
Anonymous new Function\>, CompletableFuture\>() can be replaced with lambda
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogHandler.java`
#### Snippet
```java
                        LogSegmentFilter.DEFAULT_FILTER,
                        null
                ).thenCompose(new Function<Versioned<List<LogSegmentMetadata>>, CompletableFuture<Long>>() {
                    public CompletableFuture<Long> apply(Versioned<List<LogSegmentMetadata>> ledgerList) {

```

### Convert2Lambda
Anonymous new Runnable() can be replaced with lambda
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/LedgerAllocatorPool.java`
#### Snippet
```java
    private void scheduleAllocatorRescue(final SimpleLedgerAllocator ledgerAllocator) {
        try {
            scheduledExecutorService.schedule(new Runnable() {
                @Override
                public void run() {
```

### Convert2Lambda
Anonymous new Callable() can be replaced with lambda
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogSegmentWriter.java`
#### Snippet
```java
                            backgroundFlush(true);
                        } else {
                            scheduleFlushWithDelayIfNeeded(new Callable<Void>() {
                                @Override
                                public Void call() throws Exception {
```

### Convert2Lambda
Anonymous new Callable() can be replaced with lambda
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogSegmentWriter.java`
#### Snippet
```java
                checkStateAndTransmit();
            } else {
                scheduleFlushWithDelayIfNeeded(new Callable<Void>() {
                    @Override
                    public Void call() throws Exception {
```

### Convert2Lambda
Anonymous new Runnable() can be replaced with lambda
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKLogSegmentWriter.java`
#### Snippet
```java
        this.periodicKeepAliveMs = conf.getPeriodicKeepAliveMilliSeconds();
        if (periodicKeepAliveMs > 0 && scheduler != null) {
            periodicKeepAliveSchedule = scheduler.scheduleAtFixedRate(new Runnable() {
                @Override
                public void run() {
```

### Convert2Lambda
Anonymous new Runnable() can be replaced with lambda
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/acl/ZKAccessControlManager.java`
#### Snippet
```java
            return;
        }
        scheduledExecutorService.schedule(new Runnable() {
            @Override
            public void run() {
```

### Convert2Lambda
Anonymous new Runnable() can be replaced with lambda
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/acl/ZKAccessControlManager.java`
#### Snippet
```java
            return;
        }
        scheduledExecutorService.schedule(new Runnable() {
            @Override
            public void run() {
```

### Convert2Lambda
Anonymous new Runnable() can be replaced with lambda
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/acl/ZKAccessControlManager.java`
#### Snippet
```java
            return;
        }
        scheduledExecutorService.schedule(new Runnable() {
            @Override
            public void run() {
```

### Convert2Lambda
Anonymous new Function, CompletionStage\>\>() can be replaced with lambda
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/bk/SimpleLedgerAllocator.java`
#### Snippet
```java
                                                                final ZooKeeperClient zkc) {
        return Utils.zkGetData(zkc, allocatePath, false)
                .thenCompose(new Function<Versioned<byte[]>, CompletionStage<Versioned<byte[]>>>() {
            @Override
            public CompletableFuture<Versioned<byte[]>> apply(Versioned<byte[]> result) {
```

### Convert2Lambda
Anonymous new Runnable() can be replaced with lambda
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/federated/FederatedZKLogMetadataStore.java`
#### Snippet
```java
                                      final CompletableFuture<URI> createPromise) {
        // TODO: rewrite this after we bump to zk 3.5, where we will have asynchronous version of multi
        scheduler.submit(new Runnable() {
            @Override
            public void run() {
```

### Convert2Lambda
Anonymous new Function\>() can be replaced with lambda
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKDistributedLogManager.java`
#### Snippet
```java
    private CompletableFuture<LogRecordWithDLSN> getLastLogRecordAsyncInternal(final boolean recover,
                                                                    final boolean includeEndOfStream) {
        return processReaderOperation(new Function<BKLogReadHandler, CompletableFuture<LogRecordWithDLSN>>() {
            @Override
            public CompletableFuture<LogRecordWithDLSN> apply(final BKLogReadHandler ledgerHandler) {
```

### Convert2Lambda
Anonymous new Function\>() can be replaced with lambda
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKDistributedLogManager.java`
#### Snippet
```java
        });
        // lock the stream - fetch the last commit position on success
        lockFuture.thenCompose(new Function<Void, CompletableFuture<AsyncLogReader>>() {
            @Override
            public CompletableFuture<AsyncLogReader> apply(Void complete) {
```

### Convert2Lambda
Anonymous new Function\>() can be replaced with lambda
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKDistributedLogManager.java`
#### Snippet
```java
    @Override
    public CompletableFuture<Long> getLogRecordCountAsync(final DLSN beginDLSN) {
        return processReaderOperation(new Function<BKLogReadHandler, CompletableFuture<Long>>() {
                    @Override
                    public CompletableFuture<Long> apply(BKLogReadHandler ledgerHandler) {
```

### Convert2Lambda
Anonymous new Function\>() can be replaced with lambda
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKDistributedLogManager.java`
#### Snippet
```java

    private CompletableFuture<LogRecordWithDLSN> getFirstRecordAsyncInternal() {
        return processReaderOperation(new Function<BKLogReadHandler, CompletableFuture<LogRecordWithDLSN>>() {
            @Override
            public CompletableFuture<LogRecordWithDLSN> apply(final BKLogReadHandler ledgerHandler) {
```

### Convert2Lambda
Anonymous new Function() can be replaced with lambda
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
                scheduler,
                entryStore
        ).thenApply(new Function<LogRecordWithDLSN, LogSegmentCandidate>() {
            @Override
            public LogSegmentCandidate apply(LogRecordWithDLSN record) {
```

### Convert2Lambda
Anonymous new Comparator() can be replaced with lambda
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java

    private static final Comparator<LogSegmentCandidate> LOG_SEGMENT_CANDIDATE_COMPARATOR =
            new Comparator<LogSegmentCandidate>() {
                @Override
                public int compare(LogSegmentCandidate o1, LogSegmentCandidate o2) {
```

### Convert2Lambda
Anonymous new Runnable() can be replaced with lambda
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/admin/DistributedLogAdmin.java`
#### Snippet
```java
        final AtomicInteger numPendingStreams = new AtomicInteger(streams.size());
        final CountDownLatch doneLatch = new CountDownLatch(1);
        Runnable checkRunnable = new Runnable() {
            @Override
            public void run() {
```

### Convert2Lambda
Anonymous new Runnable() can be replaced with lambda
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/auditor/DLAuditor.java`
#### Snippet
```java
                                    cbRc = BKException.Code.ZKException;
                                }
                                executorService.submit(new Runnable() {
                                    @Override
                                    public void run() {
```

### Convert2Lambda
Anonymous new Runnable() can be replaced with lambda
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/auditor/DLAuditor.java`
#### Snippet
```java
                                final AsyncCallback.VoidCallback cb) {
                numLedgers.incrementAndGet();
                executorService.submit(new Runnable() {
                    @Override
                    public void run() {
```

### Convert2Lambda
Anonymous new Runnable() can be replaced with lambda
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/auditor/DLAuditor.java`
#### Snippet
```java
                    final List<String> aps = allocationPaths.get(i);
                    i++;
                    executor.submit(new Runnable() {
                        @Override
                        public void run() {
```

### Convert2Lambda
Anonymous new Runnable() can be replaced with lambda
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/auditor/DLAuditor.java`
#### Snippet
```java
                    }
                }
                executorService.submit(new Runnable() {
                    @Override
                    public void run() {
```

### Convert2Lambda
Anonymous new Runnable() can be replaced with lambda
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/auditor/DLAuditor.java`
#### Snippet
```java
        try {
            for (int i = 0; i < numThreads; i++) {
                executorService.submit(new Runnable() {
                    @Override
                    public void run() {
```

### Convert2Lambda
Anonymous new Comparator() can be replaced with lambda
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/lock/ZKSessionLock.java`
#### Snippet
```java
    }

    static final Comparator<String> MEMBER_COMPARATOR = new Comparator<String>() {
        @Override
        public int compare(String o1, String o2) {
```

### Convert2Lambda
Anonymous new Function() can be replaced with lambda
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/lock/ZKSessionLock.java`
#### Snippet
```java
        final CompletableFuture<Boolean> waiterAcquireFuture = FutureUtils.createFuture();
        waiterAcquireFuture.whenComplete((value, cause) -> acquireFuture.completeExceptionally(cause));
        return result.thenApply(new Function<String, LockWaiter>() {
            @Override
            public LockWaiter apply(final String currentOwner) {
```

### Convert2Lambda
Anonymous new Comparator() can be replaced with lambda
in `bookkeeper-benchmark/src/main/java/org/apache/bookkeeper/benchmark/BenchReadThroughputLatency.java`
#### Snippet
```java
    private static final Pattern LEDGER_PATTERN = Pattern.compile("L([0-9]+)$");

    private static final Comparator<String> ZK_LEDGER_COMPARE = new Comparator<String>() {
        @Override
        public int compare(String o1, String o2) {
```

### Convert2Lambda
Anonymous new Runnable() can be replaced with lambda
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                for (int i = 0; i < numThreads; i++) {
                    final int tid = i;
                    executorService.submit(new Runnable() {
                        @Override
                        public void run() {
```

### Convert2Lambda
Anonymous new Comparator() can be replaced with lambda
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
    }

    static final Comparator<LogSegmentMetadata> LOGSEGMENT_COMPARATOR_BY_TIME = new Comparator<LogSegmentMetadata>() {
        @Override
        public int compare(LogSegmentMetadata o1, LogSegmentMetadata o2) {
```

### Convert2Lambda
Anonymous new Comparator\>() can be replaced with lambda
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
            List<Map.Entry<BookieId, Integer>> entries =
                    new ArrayList<Map.Entry<BookieId, Integer>>(totals.entrySet());
            Collections.sort(entries, new Comparator<Map.Entry<BookieId, Integer>>() {
                @Override
                public int compare(Map.Entry<BookieId, Integer> o1,
```

### Convert2Lambda
Anonymous new Runnable() can be replaced with lambda
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/tools/DistributedLogTool.java`
#### Snippet
```java
                    for (int i = 0; i < concurrency; i++) {
                        final int tid = i;
                        executorService.submit(new Runnable() {
                            @Override
                            public void run() {
```

### Convert2Lambda
Anonymous new SafeRunnable() can be replaced with lambda
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/SafeRunnable.java`
#### Snippet
```java
     */
    static SafeRunnable safeRun(Runnable runnable) {
        return new SafeRunnable() {
            @Override
            public void safeRun() {
```

## RuleId[id=UnnecessaryContinue]
### UnnecessaryContinue
`continue` is unnecessary as the last statement in a loop
in `stream/storage/impl/src/main/java/org/apache/bookkeeper/stream/storage/impl/sc/DefaultStorageContainerController.java`
#### Snippet
```java
                    log.trace("Host {} is not in current cluster anymore", host);
                }
                continue;
            } else {
                if (log.isTraceEnabled()) {
```

### UnnecessaryContinue
`continue` is unnecessary as the last statement in a loop
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/AbstractZkLedgerManager.java`
#### Snippet
```java
                // has an incorrect format. For now just continue and consider
                // this as a non-existent ledger.
                continue;
            }
        }
```

### UnnecessaryContinue
`continue` is unnecessary as the last statement in a loop
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/LegacyHierarchicalLedgerManager.java`
#### Snippet
```java
                if (!l2NodesIter.hasNext()) {
                    l2NodesIter = null;
                    continue;
                }
            }
```

### UnnecessaryContinue
`continue` is unnecessary as the last statement in a loop
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/meta/ZkLedgerUnderreplicationManager.java`
#### Snippet
```java
                for (String missingReplica : missingReplicas) {
                    if (existingUrLedgerFormat.getReplicaList().contains(missingReplica)) {
                        continue;
                    } else {
                        builder.addReplica(missingReplica);
```

### UnnecessaryContinue
`continue` is unnecessary as the last statement in a loop
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/SyncThread.java`
#### Snippet
```java
                        } catch (InterruptedException e) {
                            Thread.currentThread().interrupt();
                            continue;
                        }
                    }
```

### UnnecessaryContinue
`continue` is unnecessary as the last statement in a loop
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/LegacyCookieValidation.java`
#### Snippet
```java
                }
            } catch (BookieException.CookieNotFoundException e) {
                continue;
            }
        }
```

### UnnecessaryContinue
`continue` is unnecessary as the last statement in a loop
in `bookkeeper-server/src/main/java/org/apache/bookkeeper/bookie/storage/ldb/WriteCache.java`
#### Snippet
```java
                // If an entry is at the end of a segment, we need to get a new offset and try
                // again in next segment
                continue;
            } else {
                // Found a good offset
```

### UnnecessaryContinue
`continue` is unnecessary as the last statement in a loop
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdBookieRegister.java`
#### Snippet
```java
                    log.warn("Interrupted at backing off granting a new lease for leaseId {}", leaseId);
                }
                continue;
            }
        }
```

### UnnecessaryContinue
`continue` is unnecessary as the last statement in a loop
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdBookieRegister.java`
#### Snippet
```java
                throw new IllegalArgumentException("Should never reach here");
            } catch (TimeoutException e) {
                continue;
            }

```

### UnnecessaryContinue
`continue` is unnecessary as the last statement in a loop
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdBookieRegister.java`
#### Snippet
```java
                log.info("Keeping Alive at lease = {}", get());
                keepAliveFuture.get();
                continue;
            } catch (InterruptedException ie) {
                Thread.currentThread().interrupt();
```

### UnnecessaryContinue
`continue` is unnecessary as the last statement in a loop
in `metadata-drivers/etcd/src/main/java/org/apache/bookkeeper/metadata/etcd/EtcdRegistrationManager.java`
#### Snippet
```java
                || keyStr.equals(writableBookiesPath)
                || keyStr.equals(readonlyBookiesPath)) {
                continue;
            } else {
                hasBookiesAlive = true;
```

### UnnecessaryContinue
`continue` is unnecessary as the last statement in a loop
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/BKSyncLogReader.java`
#### Snippet
```java
                if (record.getTransactionId() < startTransactionId.get()) {
                    record = null;
                    continue;
                } else {
                    positioned = true;
```

### UnnecessaryContinue
`continue` is unnecessary as the last statement in a loop
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/logsegment/BKLogSegmentEntryReader.java`
#### Snippet
```java
                CacheEntry removedEntry = readAheadEntries.poll();
                removedEntry.release();
                continue;
            } else {
                completeExceptionally(new BKTransmitException("Encountered issue on reading entry " + entry.getEntryId()
```

### UnnecessaryContinue
`continue` is unnecessary as the last statement in a loop
in `stream/distributedlog/core/src/main/java/org/apache/distributedlog/impl/federated/FederatedZKLogMetadataStore.java`
#### Snippet
```java
            if (oldVersion < zkVersion) {
                done = zkSubnamespacesVersion.compareAndSet(oldVersion, zkVersion);
                continue;
            } else {
                done = true;
```

### UnnecessaryContinue
`continue` is unnecessary as the last statement in a loop
in `stream/distributedlog/io/dlfs/src/main/java/org/apache/distributedlog/fs/DLInputStream.java`
#### Snippet
```java
                this.pos = endPos;
                this.currentRecord = nextRecordStream(reader);
                continue;
            } else if (remaining == bytesLeft) {
                this.pos = endPos;
```

### UnnecessaryContinue
`continue` is unnecessary as the last statement in a loop
in `stream/distributedlog/io/dlfs/src/main/java/org/apache/distributedlog/fs/DLInputStream.java`
#### Snippet
```java
                currentRecord = nextRecordStream(reader);
                this.pos = endPos;
                continue;
            } else if (endPos == position){
                // find the record, but we defer read next record when actual read happens
```

### UnnecessaryContinue
`continue` is unnecessary as the last statement in a loop
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/dlog/DLInputStream.java`
#### Snippet
```java
                currentRecord = nextRecordStream(reader);
                this.pos = endPos;
                continue;
            } else if (endPos == position){
                // find the record, but we defer read next record when actual read happens
```

### UnnecessaryContinue
`continue` is unnecessary as the last statement in a loop
in `stream/statelib/src/main/java/org/apache/bookkeeper/statelib/impl/rocksdb/checkpoint/dlog/DLInputStream.java`
#### Snippet
```java
                this.pos = endPos;
                this.currentRecord = nextRecordStream(reader);
                continue;
            } else if (remaining == bytesLeft) {
                this.pos = endPos;
```

## RuleId[id=ThreadStartInConstruction]
### ThreadStartInConstruction
Call to `start()` during object construction
in `bookkeeper-common/src/main/java/org/apache/bookkeeper/common/util/SingleThreadExecutor.java`
#### Snippet
```java
        this.rejectExecution = rejectExecution;
        this.startLatch = new CountDownLatch(1);
        this.runner.start();

        // Ensure the runner is already fully working by the time the constructor is done
```

