# hudi 
 
# Bad smells
I found 3275 bad smells with 584 repairable:
| ruleID | number | fixable |
| --- | --- | --- |
| BoundedWildcard | 607 | false |
| RedundantFieldInitialization | 328 | false |
| UtilityClassWithoutPrivateConstructor | 203 | true |
| ReturnNull | 195 | false |
| SizeReplaceableByIsEmpty | 119 | true |
| UseOfPropertiesAsHashtable | 114 | false |
| NonProtectedConstructorInAbstractClass | 109 | true |
| AssignmentToMethodParameter | 102 | false |
| UnnecessaryFullyQualifiedName | 91 | false |
| ZeroLengthArrayInitialization | 90 | false |
| DynamicRegexReplaceableByCompiledPattern | 69 | false |
| SystemOutErr | 65 | false |
| DataFlowIssue | 61 | false |
| Convert2MethodRef | 61 | false |
| DefaultAnnotationParam | 58 | false |
| CodeBlock2Expr | 48 | true |
| UnnecessaryToStringCall | 43 | true |
| UnnecessarySuperQualifier | 41 | false |
| UnusedAssignment | 40 | false |
| FieldAccessedSynchronizedAndUnsynchronized | 39 | false |
| UnnecessaryLocalVariable | 38 | true |
| NonSerializableFieldInSerializableClass | 38 | false |
| ConstantValue | 36 | false |
| DuplicateBranchesInSwitch | 34 | false |
| SynchronizeOnThis | 32 | false |
| SimplifyStreamApiCallChains | 31 | false |
| RedundantMethodOverride | 28 | false |
| PublicFieldAccessedInSynchronizedContext | 27 | false |
| StringBufferReplaceableByString | 27 | false |
| RedundantImplements | 27 | false |
| NullableProblems | 24 | false |
| IgnoreResultOfCall | 23 | false |
| OptionalGetWithoutIsPresent | 23 | false |
| StringConcatenationInsideStringBufferAppend | 20 | false |
| AbstractClassNeverImplemented | 19 | false |
| DeprecatedIsStillUsed | 19 | false |
| WrapperTypeMayBePrimitive | 15 | false |
| EmptyMethod | 14 | false |
| InstanceofCatchParameter | 13 | false |
| MissingDeprecatedAnnotation | 12 | false |
| ThrowablePrintStackTrace | 12 | false |
| ToArrayCallWithZeroLengthArrayArgument | 11 | true |
| NestedAssignment | 10 | false |
| ReplaceAssignmentWithOperatorAssignment | 10 | false |
| AssignmentToStaticFieldFromInstanceMethod | 9 | false |
| BusyWait | 9 | false |
| TrivialStringConcatenation | 8 | false |
| CallToStringConcatCanBeReplacedByOperator | 8 | false |
| CommentedOutCode | 7 | false |
| UnnecessaryUnboxing | 7 | false |
| ClassNameSameAsAncestorName | 7 | false |
| MethodOverridesStaticMethod | 7 | false |
| IOResource | 7 | false |
| AbstractMethodCallInConstructor | 7 | false |
| DoubleCheckedLocking | 6 | false |
| KeySetIterationMayUseEntrySet | 6 | false |
| UnnecessarySemicolon | 6 | false |
| MissortedModifiers | 5 | false |
| RedundantStreamOptionalCall | 5 | false |
| InfiniteLoopStatement | 5 | false |
| NonFinalFieldOfException | 5 | false |
| BigDecimalMethodWithoutRoundingCalled | 5 | false |
| UnnecessaryModifier | 4 | true |
| RegExpRedundantEscape | 4 | false |
| ReplaceInefficientStreamCount | 4 | false |
| TypeParameterHidesVisibleType | 4 | false |
| RedundantSuppression | 4 | false |
| SuspiciousToArrayCall | 4 | false |
| ObsoleteCollection | 4 | false |
| NonShortCircuitBoolean | 4 | false |
| DoubleBraceInitialization | 3 | false |
| JavaReflectionMemberAccess | 3 | false |
| SynchronizationOnLocalVariableOrMethodParameter | 3 | false |
| AssignmentToLambdaParameter | 3 | false |
| RedundantArrayCreation | 3 | true |
| ThrowFromFinallyBlock | 3 | false |
| FieldMayBeStatic | 3 | false |
| Java8MapForEach | 3 | false |
| ComparatorCombinators | 3 | false |
| SuspiciousMethodCalls | 3 | false |
| UnnecessaryBoxing | 3 | false |
| SynchronizeOnNonFinalField | 3 | false |
| FinalStaticMethod | 2 | false |
| IntegerMultiplicationImplicitCastToLong | 2 | false |
| DuplicateThrows | 2 | false |
| StringOperationCanBeSimplified | 2 | false |
| SwitchStatementWithConfusingDeclaration | 2 | false |
| CaughtExceptionImmediatelyRethrown | 2 | false |
| UnnecessaryReturn | 2 | true |
| StringBufferReplaceableByStringBuilder | 2 | false |
| FuseStreamOperations | 2 | false |
| MismatchedJavadocCode | 2 | false |
| AssignmentToForLoopParameter | 2 | false |
| InnerClassMayBeStatic | 2 | true |
| StringEqualsEmptyString | 2 | false |
| Java8MapApi | 2 | false |
| Convert2Lambda | 2 | false |
| PointlessArithmeticExpression | 1 | false |
| WhileCanBeForeach | 1 | false |
| ForLoopReplaceableByWhile | 1 | false |
| FinalPrivateMethod | 1 | false |
| EqualsBetweenInconvertibleTypes | 1 | false |
| ReturnFromFinallyBlock | 1 | false |
| MismatchedCollectionQueryUpdate | 1 | false |
| EqualsAndHashcode | 1 | false |
| HtmlWrongAttributeValue | 1 | false |
| CastConflictsWithInstanceof | 1 | false |
| OptionalContainsCollection | 1 | false |
| FinallyBlockCannotCompleteNormally | 1 | false |
| NonSynchronizedMethodOverridesSynchronizedMethod | 1 | false |
| ProtectedMemberInFinalClass | 1 | true |
| NonStrictComparisonCanBeEquality | 1 | true |
| OptionalUsedAsFieldOrParameterType | 1 | false |
| CharsetObjectCanBeUsed | 1 | false |
| ImplicitArrayToString | 1 | false |
| PrimitiveArrayArgumentToVariableArgMethod | 1 | false |
| UseBulkOperation | 1 | false |
| ManualMinMaxCalculation | 1 | false |
| MismatchedStringBuilderQueryUpdate | 1 | false |
| AnonymousHasLambdaAlternative | 1 | false |
| NegativeIntConstantInLongContext | 1 | false |
| MalformedFormatString | 1 | false |
| ArrayEquality | 1 | false |
| RedundantStringFormatCall | 1 | false |
| RedundantUnmodifiable | 1 | false |
| NullArgumentToVariableArgMethod | 1 | false |
| RedundantOperationOnEmptyContainer | 1 | false |
| ConditionCoveredByFurtherCondition | 1 | false |
| EqualsWhichDoesntCheckParameterClass | 1 | false |
## RuleId[ruleID=ToArrayCallWithZeroLengthArrayArgument]
### ToArrayCallWithZeroLengthArrayArgument
Call to `toArray()` with pre-sized array argument 'new Comparable\[row.size()\]'
in `hudi-cli/src/main/java/org/apache/hudi/cli/utils/SparkTempViewProvider.java`
#### Snippet
```java
        structType = structType.add(DataTypes.createStructField(headersNoSpaces.get(i), headerDataType, true));
      }
      List<Row> records = rows.stream().map(row -> RowFactory.create(row.toArray(new Comparable[row.size()])))
              .collect(Collectors.toList());
      Dataset<Row> dataset = this.sqlContext.createDataFrame(records, structType);
```

### ToArrayCallWithZeroLengthArrayArgument
Call to `toArray()` with pre-sized array argument 'new Comparable\[commitDetails.size()\]'
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/ArchivedCommitsCommand.java`
#### Snippet
```java
      commitDetails.add(Option.ofNullable(record.get(metadataName)).orElse("{}").toString());
    }
    return commitDetails.toArray(new Comparable[commitDetails.size()]);
  }

```

### ToArrayCallWithZeroLengthArrayArgument
Call to `toArray()` with pre-sized array argument 'new String\[l.size()\]'
in `hudi-cli/src/main/java/org/apache/hudi/cli/HoodiePrintHelper.java`
#### Snippet
```java

    String[][] rows =
        buffer.getRenderRows().stream().map(l -> l.toArray(new String[l.size()])).toArray(String[][]::new);
    return printTextTable(header, rows);
  }
```

### ToArrayCallWithZeroLengthArrayArgument
Call to `toArray()` with pre-sized array argument 'new String\[uniquePaths.size()\]'
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/SparkRDDReadClient.java`
#### Snippet
```java
    // read files based on the file extension name
    if (paths.size() == 0 || paths.get(0).endsWith(HoodieFileFormat.PARQUET.getFileExtension())) {
      originalDF = sqlContextOpt.get().read().parquet(uniquePaths.toArray(new String[uniquePaths.size()]));
    } else if (paths.get(0).endsWith(HoodieFileFormat.ORC.getFileExtension())) {
      originalDF = sqlContextOpt.get().read().orc(uniquePaths.toArray(new String[uniquePaths.size()]));
```

### ToArrayCallWithZeroLengthArrayArgument
Call to `toArray()` with pre-sized array argument 'new String\[uniquePaths.size()\]'
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/SparkRDDReadClient.java`
#### Snippet
```java
      originalDF = sqlContextOpt.get().read().parquet(uniquePaths.toArray(new String[uniquePaths.size()]));
    } else if (paths.get(0).endsWith(HoodieFileFormat.ORC.getFileExtension())) {
      originalDF = sqlContextOpt.get().read().orc(uniquePaths.toArray(new String[uniquePaths.size()]));
    }
    StructType schema = originalDF.schema();
```

### ToArrayCallWithZeroLengthArrayArgument
Call to `toArray()` with pre-sized array argument 'new Path\[nonHoodiePaths.size()\]'
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/HoodieCopyOnWriteTableInputFormat.java`
#### Snippet
```java
    List<Path> nonHoodiePaths = inputPathHandler.getNonHoodieInputPaths();
    if (nonHoodiePaths.size() > 0) {
      setInputPaths(job, nonHoodiePaths.toArray(new Path[nonHoodiePaths.size()]));
      FileStatus[] fileStatuses = doListStatus(job);
      returns.addAll(Arrays.asList(fileStatuses));
```

### ToArrayCallWithZeroLengthArrayArgument
Call to `toArray()` with pre-sized array argument 'new CombineHiveInputSplit\[result.size()\]'
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/hive/HoodieCombineHiveInputFormat.java`
#### Snippet
```java

    LOG.info("number of splits " + result.size());
    return result.toArray(new CombineHiveInputSplit[result.size()]);
  }

```

### ToArrayCallWithZeroLengthArrayArgument
Call to `toArray()` with pre-sized array argument 'new CombineFileSplit\[combineFileSplits.size()\]'
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/hive/HoodieCombineHiveInputFormat.java`
#### Snippet
```java
          }
        }
        return combineFileSplits.toArray(new CombineFileSplit[combineFileSplits.size()]);
      } else {
        InputSplit[] splits = super.getSplits(job, numSplits);
```

### ToArrayCallWithZeroLengthArrayArgument
Call to `toArray()` with pre-sized array argument 'new HadoopShimsSecure.InputSplitShim\[inputSplitShims.size()\]'
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/hive/HoodieCombineHiveInputFormat.java`
#### Snippet
```java
        }
        return (CombineFileSplit[]) inputSplitShims
            .toArray(new HadoopShimsSecure.InputSplitShim[inputSplitShims.size()]);
      }
    }
```

### ToArrayCallWithZeroLengthArrayArgument
Call to `toArray()` with pre-sized array argument 'new InputSplit\[result.size()\]'
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/hive/HoodieCombineHiveInputFormat.java`
#### Snippet
```java
    LOG.info("Number of all splits " + result.size());
    perfLogger.PerfLogEnd(CLASS_NAME, PerfLogger.GET_SPLITS);
    return result.toArray(new InputSplit[result.size()]);
  }

```

### ToArrayCallWithZeroLengthArrayArgument
Call to `toArray()` with pre-sized array argument 'new Path\[paths.size()\]'
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/hive/HoodieCombineHiveInputFormat.java`
#### Snippet
```java
        try {
          List<Path> paths = Utilities.getInputPathsTez(job, mrwork);
          dirs = paths.toArray(new Path[paths.size()]);
        } catch (Exception e) {
          throw new IOException("Could not create input files", e);
```

## RuleId[ruleID=WrapperTypeMayBePrimitive]
### WrapperTypeMayBePrimitive
Type may be primitive
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/index/hbase/SparkHoodieHBaseIndex.java`
#### Snippet
```java
    try (HTable hTable = (HTable) hbaseConnection.getTable(TableName.valueOf(tableName));
         BufferedMutator mutator = hbaseConnection.getBufferedMutator(TableName.valueOf(tableName))) {
      Long rollbackTime = HoodieActiveTimeline.parseDateFromInstantTime(instantTime).getTime();
      Long currentTime = new Date().getTime();
      Scan scan = new Scan();
```

### WrapperTypeMayBePrimitive
Type may be primitive
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/index/hbase/SparkHoodieHBaseIndex.java`
#### Snippet
```java
         BufferedMutator mutator = hbaseConnection.getBufferedMutator(TableName.valueOf(tableName))) {
      Long rollbackTime = HoodieActiveTimeline.parseDateFromInstantTime(instantTime).getTime();
      Long currentTime = new Date().getTime();
      Scan scan = new Scan();
      scan.addFamily(SYSTEM_COLUMN_FAMILY);
```

### WrapperTypeMayBePrimitive
Type may be primitive
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/index/hbase/SparkHoodieHBaseIndex.java`
#### Snippet
```java
    // `multiGetBatchSize` is intended to be a batch per 100ms. To create a rate limiter that measures
    // operations per second, we need to multiply `multiGetBatchSize` by 10.
    Integer multiGetBatchSize = config.getHbaseIndexGetBatchSize();
    return (partitionNum, hoodieRecordIterator) -> {
      boolean updatePartitionPath = config.getHbaseIndexUpdatePartitionPath();
```

### WrapperTypeMayBePrimitive
Type may be primitive
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/BitCaskDiskMap.java`
#### Snippet
```java
      byte[] val = isCompressionEnabled ? DISK_COMPRESSION_REF.get().compressBytes(SerializationUtils.serialize(value)) :
          SerializationUtils.serialize(value);
      Integer valueSize = val.length;
      Long timestamp = System.currentTimeMillis();
      this.valueMetadataMap.put(key,
```

### WrapperTypeMayBePrimitive
Type may be primitive
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/BitCaskDiskMap.java`
#### Snippet
```java
          SerializationUtils.serialize(value);
      Integer valueSize = val.length;
      Long timestamp = System.currentTimeMillis();
      this.valueMetadataMap.put(key,
          new BitCaskDiskMap.ValueMetadata(this.filePath, valueSize, filePosition.get(), timestamp));
```

### WrapperTypeMayBePrimitive
Type may be primitive
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieCommitMetadata.java`
#### Snippet
```java

  public Long getTotalLogRecordsCompacted() {
    Long totalLogRecords = 0L;
    for (Map.Entry<String, List<HoodieWriteStat>> entry : partitionToWriteStats.entrySet()) {
      for (HoodieWriteStat writeStat : entry.getValue()) {
```

### WrapperTypeMayBePrimitive
Type may be primitive
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieCommitMetadata.java`
#### Snippet
```java

  public Long getTotalUpsertTime() {
    Long totalUpsertTime = 0L;
    for (Map.Entry<String, List<HoodieWriteStat>> entry : partitionToWriteStats.entrySet()) {
      for (HoodieWriteStat writeStat : entry.getValue()) {
```

### WrapperTypeMayBePrimitive
Type may be primitive
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieCommitMetadata.java`
#### Snippet
```java

  public Long getTotalCreateTime() {
    Long totalCreateTime = 0L;
    for (Map.Entry<String, List<HoodieWriteStat>> entry : partitionToWriteStats.entrySet()) {
      for (HoodieWriteStat writeStat : entry.getValue()) {
```

### WrapperTypeMayBePrimitive
Type may be primitive
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieCommitMetadata.java`
#### Snippet
```java

  public Long getTotalCompactedRecordsUpdated() {
    Long totalUpdateRecords = 0L;
    for (Map.Entry<String, List<HoodieWriteStat>> entry : partitionToWriteStats.entrySet()) {
      for (HoodieWriteStat writeStat : entry.getValue()) {
```

### WrapperTypeMayBePrimitive
Type may be primitive
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieCommitMetadata.java`
#### Snippet
```java

  public Long getTotalLogFilesCompacted() {
    Long totalLogFiles = 0L;
    for (Map.Entry<String, List<HoodieWriteStat>> entry : partitionToWriteStats.entrySet()) {
      for (HoodieWriteStat writeStat : entry.getValue()) {
```

### WrapperTypeMayBePrimitive
Type may be primitive
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieCommitMetadata.java`
#### Snippet
```java

  public Long getTotalLogFilesSize() {
    Long totalLogFilesSize = 0L;
    for (Map.Entry<String, List<HoodieWriteStat>> entry : partitionToWriteStats.entrySet()) {
      for (HoodieWriteStat writeStat : entry.getValue()) {
```

### WrapperTypeMayBePrimitive
Type may be primitive
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieCommitMetadata.java`
#### Snippet
```java

  public Long getTotalScanTime() {
    Long totalScanTime = 0L;
    for (Map.Entry<String, List<HoodieWriteStat>> entry : partitionToWriteStats.entrySet()) {
      for (HoodieWriteStat writeStat : entry.getValue()) {
```

### WrapperTypeMayBePrimitive
Type may be primitive
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieBackedTableMetadata.java`
#### Snippet
```java
  private Pair<HoodieSeekingFileReader<?>, Long> getBaseFileReader(FileSlice slice, HoodieTimer timer) throws IOException {
    HoodieSeekingFileReader<?> baseFileReader;
    Long baseFileOpenMs;
    // If the base file is present then create a reader
    Option<HoodieBaseFile> basefile = slice.getBaseFile();
```

### WrapperTypeMayBePrimitive
Type may be primitive
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/SchemaEvolutionContext.java`
#### Snippet
```java
        prunedSchema = InternalSchemaUtils.pruneInternalSchema(internalSchemaOption.get(), requiredColumns);
        InternalSchema querySchema = prunedSchema;
        Long commitTime = Long.valueOf(FSUtils.getCommitTime(finalPath.getName()));
        InternalSchema fileSchema = InternalSchemaCache.searchSchemaAndCache(commitTime, metaClient, false);
        InternalSchema mergedInternalSchema = new InternalSchemaMerger(fileSchema, querySchema, true,
```

### WrapperTypeMayBePrimitive
Type may be primitive
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/helpers/KafkaOffsetGen.java`
#### Snippet
```java

  private Long delayOffsetCalculation(Option<String> lastCheckpointStr, Set<TopicPartition> topicPartitions, KafkaConsumer consumer) {
    Long delayCount = 0L;
    Map<TopicPartition, Long> checkpointOffsets = CheckpointUtils.strToOffsets(lastCheckpointStr.get());
    Map<TopicPartition, Long> lastOffsets = consumer.endOffsets(topicPartitions);
```

## RuleId[ruleID=UnnecessaryModifier]
### UnnecessaryModifier
Modifier `transient` is redundant for a 'static' field
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/index/hbase/SparkHoodieHBaseIndex.java`
#### Snippet
```java
  private long totalNumInserts;
  private int numWriteStatusWithInserts;
  private static transient Thread shutdownThread;

  /**
```

### UnnecessaryModifier
Modifier `static` is redundant for inner enums
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/InstantRange.java`
#### Snippet
```java
   * Represents a range type.
   */
  public static enum RangeType {
    OPEN_CLOSE, CLOSE_CLOSE
  }
```

### UnnecessaryModifier
Modifier `private` is redundant for enum constructors
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/action/TableChange.java`
#### Snippet
```java
    private String name;

    private ColumnChangeID() {
      this.name = this.name().toLowerCase(Locale.ROOT);
    }
```

### UnnecessaryModifier
Modifier `transient` is redundant for a 'static' field
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/realtime/HoodieCombineRealtimeRecordReader.java`
#### Snippet
```java
public class HoodieCombineRealtimeRecordReader implements RecordReader<NullWritable, ArrayWritable> {

  private static final transient Logger LOG = LogManager.getLogger(HoodieCombineRealtimeRecordReader.class);
  // RecordReaders for each split
  List<HoodieRealtimeRecordReader> recordReaders = new LinkedList<>();
```

## RuleId[ruleID=PointlessArithmeticExpression]
### PointlessArithmeticExpression
`1 * 1024 * 1024` can be replaced with '1024 \* 1024'
in `hudi-common/src/main/java/org/apache/hudi/common/config/HoodieStorageConfig.java`
#### Snippet
```java
  public static final ConfigProperty<String> PARQUET_PAGE_SIZE = ConfigProperty
      .key("hoodie.parquet.page.size")
      .defaultValue(String.valueOf(1 * 1024 * 1024))
      .withDocumentation("Parquet page size in bytes. Page is the unit of read within a parquet file. "
          + "Within a block, pages are compressed separately.");
```

## RuleId[ruleID=DoubleCheckedLocking]
### DoubleCheckedLocking
Double-checked locking
in `hudi-common/src/main/java/org/apache/hudi/util/Transient.java`
#### Snippet
```java

  public T get() {
    if (!initialized) {
      synchronized (this) {
        if (!initialized) {
```

### DoubleCheckedLocking
Double-checked locking
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/RocksDbDiskMap.java`
#### Snippet
```java

  private RocksDBDAO getRocksDb() {
    if (null == rocksDb) {
      synchronized (this) {
        if (null == rocksDb) {
```

### DoubleCheckedLocking
Double-checked locking
in `hudi-common/src/main/java/org/apache/hudi/common/bootstrap/index/HFileBootstrapIndex.java`
#### Snippet
```java

    private HFile.Reader fileIdIndexReader() {
      if (null == indexByFileIdReader) {
        synchronized (this) {
          if (null == indexByFileIdReader) {
```

### DoubleCheckedLocking
Double-checked locking
in `hudi-common/src/main/java/org/apache/hudi/common/bootstrap/index/HFileBootstrapIndex.java`
#### Snippet
```java

    private HFile.Reader partitionIndexReader() {
      if (null == indexByPartitionReader) {
        synchronized (this) {
          if (null == indexByPartitionReader) {
```

### DoubleCheckedLocking
Double-checked locking
in `hudi-kafka-connect/src/main/java/org/apache/hudi/connect/kafka/KafkaConnectControlAgent.java`
#### Snippet
```java
  public static KafkaConnectControlAgent createKafkaControlManager(String bootstrapServers,
                                                                   String controlTopicName) {
    if (agent == null) {
      synchronized (LOCK) {
        if (agent == null) {
```

### DoubleCheckedLocking
Double-checked locking
in `hudi-timeline-service/src/main/java/org/apache/hudi/timeline/service/handlers/MarkerHandler.java`
#### Snippet
```java
    MarkerDirState markerDirState = getMarkerDirState(markerDir);
    markerDirState.addMarkerCreationFuture(future);
    if (!firstCreationRequestSeen) {
      synchronized (firstCreationRequestSeenLock) {
        if (!firstCreationRequestSeen) {
```

## RuleId[ruleID=WhileCanBeForeach]
### WhileCanBeForeach
`while` loop can be replaced with enhanced 'for'
in `hudi-common/src/main/java/org/apache/hudi/common/util/queue/BoundedInMemoryExecutor.java`
#### Snippet
```java
    try {
      Iterator<O> it = ((BoundedInMemoryQueue<I, O>) queue).iterator();
      while (it.hasNext()) {
        consumer.consume(it.next());
      }
```

## RuleId[ruleID=CommentedOutCode]
### CommentedOutCode
Commented out code (7 lines)
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/index/bloom/SparkHoodieBloomIndexHelper.java`
#### Snippet
```java
      String fileGroupId = partitionFileGroupId.getFileId();

      /*
      // TODO(HUDI-5619) uncomment when addressed
      String baseFileName =
```

### CommentedOutCode
Commented out code (7 lines)
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/compact/HoodieCompactor.java`
#### Snippet
```java
      } else {
        // TODO: we may directly rename original parquet file if there is not evolution/devolution of schema
        /*
        TaskContextSupplier taskContextSupplier = hoodieCopyOnWriteTable.getTaskContextSupplier();
        String newFileName = FSUtils.makeDataFileName(instantTime,
```

### CommentedOutCode
Commented out code (2 lines)
in `hudi-common/src/main/java/org/apache/hudi/io/storage/HoodieAvroHFileWriter.java`
#### Snippet
```java
    // TODO - compute this compression ratio dynamically by looking at the bytes written to the
    // stream and the actual file size reported by HDFS
    // this.maxFileSize = hfileConfig.getMaxFileSize()
    //    + Math.round(hfileConfig.getMaxFileSize() * hfileConfig.getCompressionRatio());
    this.maxFileSize = hfileConfig.getMaxFileSize();
```

### CommentedOutCode
Commented out code (4 lines)
in `hudi-common/src/main/java/org/apache/hudi/avro/ConvertingGenericData.java`
#### Snippet
```java
    // NOTE: Those are not supported in Avro 1.8.2
    // TODO re-enable upon upgrading to 1.10
    // addLogicalTypeConversion(TIME_MILLIS_CONVERSION);
    // addLogicalTypeConversion(TIMESTAMP_MILLIS_CONVERSION);
    // addLogicalTypeConversion(LOCAL_TIMESTAMP_MILLIS_CONVERSION);
```

### CommentedOutCode
Commented out code (4 lines)
in `hudi-common/src/main/java/org/apache/hudi/avro/ConvertingGenericData.java`
#### Snippet
```java
  // NOTE: Those are not supported in Avro 1.8.2
  // TODO re-enable upon upgrading to 1.10
  // private static final TimeConversions.TimestampMillisConversion TIMESTAMP_MILLIS_CONVERSION = new TimeConversions.TimestampMillisConversion();
  // private static final TimeConversions.TimeMillisConversion TIME_MILLIS_CONVERSION = new TimeConversions.TimeMillisConversion();
  // private static final TimeConversions.LocalTimestampMillisConversion LOCAL_TIMESTAMP_MILLIS_CONVERSION = new TimeConversions.LocalTimestampMillisConversion();
```

### CommentedOutCode
Commented out code (2 lines)
in `hudi-common/src/main/java/org/apache/hudi/common/fs/HoodieWrapperFileSystem.java`
#### Snippet
```java
    // Do not need to explicitly initialize the default filesystem, its done already in the above
    // FileSystem.get
    // fileSystem.initialize(FileSystem.getDefaultUri(conf), conf);
    // fileSystem.setConf(conf);
  }
```

### CommentedOutCode
Commented out code (10 lines)
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/HoodieParquetInputFormat.java`
#### Snippet
```java
                                                                   final Reporter reporter) throws IOException {
    // TODO enable automatic predicate pushdown after fixing issues
    // FileSplit fileSplit = (FileSplit) split;
    // HoodieTableMetadata metadata = getTableMetadata(fileSplit.getPath().getParent());
    // String tableName = metadata.getTableName();
```

## RuleId[ruleID=AssignmentToStaticFieldFromInstanceMethod]
### AssignmentToStaticFieldFromInstanceMethod
Assignment to static field `HoodieCLI.state` from instance context
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/TableCommand.java`
#### Snippet
```java
    HoodieCLI.connectTo(path, layoutVersion);
    HoodieCLI.initFS(true);
    HoodieCLI.state = HoodieCLI.CLIState.TABLE;
    return "Metadata for table " + HoodieCLI.getTableMetaClient().getTableConfig().getTableName() + " loaded";
  }
```

### AssignmentToStaticFieldFromInstanceMethod
Assignment to static field `HoodieCLI.syncTableMetadata` from instance context
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/CommitsCommand.java`
#### Snippet
```java
  @ShellMethod(key = "commits sync", value = "Sync commits with another Hoodie table")
  public String syncCommits(@ShellOption(value = {"--path"}, help = "Path of the table to sync to") final String path) {
    HoodieCLI.syncTableMetadata = HoodieTableMetaClient.builder().setConf(HoodieCLI.conf).setBasePath(path).build();
    HoodieCLI.state = HoodieCLI.CLIState.SYNC;
    return "Load sync state between " + HoodieCLI.getTableMetaClient().getTableConfig().getTableName() + " and "
```

### AssignmentToStaticFieldFromInstanceMethod
Assignment to static field `HoodieCLI.state` from instance context
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/CommitsCommand.java`
#### Snippet
```java
  public String syncCommits(@ShellOption(value = {"--path"}, help = "Path of the table to sync to") final String path) {
    HoodieCLI.syncTableMetadata = HoodieTableMetaClient.builder().setConf(HoodieCLI.conf).setBasePath(path).build();
    HoodieCLI.state = HoodieCLI.CLIState.SYNC;
    return "Load sync state between " + HoodieCLI.getTableMetaClient().getTableConfig().getTableName() + " and "
        + HoodieCLI.syncTableMetadata.getTableConfig().getTableName();
```

### AssignmentToStaticFieldFromInstanceMethod
Assignment to static field `hbaseConnection` from instance context
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/index/hbase/SparkHoodieHBaseIndex.java`
#### Snippet
```java
      synchronized (SparkHoodieHBaseIndex.class) {
        if (hbaseConnection == null || hbaseConnection.isClosed()) {
          hbaseConnection = getHBaseConnection();
        }
      }
```

### AssignmentToStaticFieldFromInstanceMethod
Assignment to static field `shutdownThread` from instance context
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/index/hbase/SparkHoodieHBaseIndex.java`
#### Snippet
```java
  private void addShutDownHook() {
    if (null == shutdownThread) {
      shutdownThread = new Thread(() -> {
        try {
          hbaseConnection.close();
```

### AssignmentToStaticFieldFromInstanceMethod
Assignment to static field `hbaseConnection` from instance context
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/index/hbase/SparkHoodieHBaseIndex.java`
#### Snippet
```java
    synchronized (SparkHoodieHBaseIndex.class) {
      if (hbaseConnection == null || hbaseConnection.isClosed()) {
        hbaseConnection = getHBaseConnection();
      }
    }
```

### AssignmentToStaticFieldFromInstanceMethod
Assignment to static field `SparkHoodieHBaseIndex.hbaseConnection` from instance context
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/index/hbase/SparkHoodieHBaseIndex.java`
#### Snippet
```java

  public void setHbaseConnection(Connection hbaseConnection) {
    SparkHoodieHBaseIndex.hbaseConnection = hbaseConnection;
  }

```

### AssignmentToStaticFieldFromInstanceMethod
Assignment to static field `hbaseConnection` from instance context
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/index/hbase/SparkHoodieHBaseIndex.java`
#### Snippet
```java
      synchronized (SparkHoodieHBaseIndex.class) {
        if (hbaseConnection == null || hbaseConnection.isClosed()) {
          hbaseConnection = getHBaseConnection();
        }
      }
```

### AssignmentToStaticFieldFromInstanceMethod
Assignment to static field `recordLocationMap` from instance context
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/index/inmemory/HoodieInMemoryHashIndex.java`
#### Snippet
```java
    synchronized (HoodieInMemoryHashIndex.class) {
      if (recordLocationMap == null) {
        recordLocationMap = new ConcurrentHashMap<>();
      }
    }
```

## RuleId[ruleID=RegExpRedundantEscape]
### RegExpRedundantEscape
Redundant character escape `\\]` in RegExp
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/utils/SerDeHelper.java`
#### Snippet
```java
  private static final String VALUE_OPTIONAL = "value_optional";

  private static final Pattern FIXED = Pattern.compile("fixed\\[(\\d+)\\]");
  private static final Pattern DECIMAL = Pattern.compile("decimal\\((\\d+),\\s+(\\d+)\\)");

```

### RegExpRedundantEscape
Redundant character escape `\\.` in RegExp
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/checkpointing/KafkaConnectHdfsProvider.java`
#### Snippet
```java
    private static final Pattern DIRECTORY_PATTERN = Pattern.compile(".*=.*");
    private static final Pattern PATTERN =
        Pattern.compile("[a-zA-Z0-9\\._\\-]+\\+\\d+\\+\\d+\\+\\d+(.\\w+)?");

    @Override
```

### RegExpRedundantEscape
Redundant character escape `\\+` in RegExp
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/checkpointing/KafkaConnectHdfsProvider.java`
#### Snippet
```java
 */
public class KafkaConnectHdfsProvider extends InitialCheckPointProvider {
  private static String FILENAME_SEPARATOR = "[\\+\\.]";

  public KafkaConnectHdfsProvider(TypedProperties props) {
```

### RegExpRedundantEscape
Redundant character escape `\\.` in RegExp
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/checkpointing/KafkaConnectHdfsProvider.java`
#### Snippet
```java
 */
public class KafkaConnectHdfsProvider extends InitialCheckPointProvider {
  private static String FILENAME_SEPARATOR = "[\\+\\.]";

  public KafkaConnectHdfsProvider(TypedProperties props) {
```

## RuleId[ruleID=KeySetIterationMayUseEntrySet]
### KeySetIterationMayUseEntrySet
Iteration over `timeStampMap.keySet()` may be replaced with 'entrySet()' iteration
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/replication/GlobalHiveSyncTool.java`
#### Snippet
```java

  public void setLastReplicatedTimeStamp(Map<String, Option<String>> timeStampMap) {
    for (String tableName : timeStampMap.keySet()) {
      Option<String> timestamp = timeStampMap.get(tableName);
      if (timestamp.isPresent()) {
```

### KeySetIterationMayUseEntrySet
Iteration over `commits.keySet()` may be replaced with 'entrySet()' iteration
in `hudi-common/src/main/java/org/apache/hudi/common/table/cdc/HoodieCDCExtractor.java`
#### Snippet
```java

    Map<HoodieFileGroupId, List<HoodieCDCFileSplit>> fgToCommitChanges = new HashMap<>();
    for (HoodieInstant instant : commits.keySet()) {
      HoodieCommitMetadata commitMetadata = commits.get(instant);

```

### KeySetIterationMayUseEntrySet
Iteration over `ptToWriteStats.keySet()` may be replaced with 'entrySet()' iteration
in `hudi-common/src/main/java/org/apache/hudi/common/table/cdc/HoodieCDCExtractor.java`
#### Snippet
```java
      // parse `partitionToWriteStats` in the metadata of commit
      Map<String, List<HoodieWriteStat>> ptToWriteStats = commitMetadata.getPartitionToWriteStats();
      for (String partition : ptToWriteStats.keySet()) {
        List<HoodieWriteStat> hoodieWriteStats = ptToWriteStats.get(partition);
        hoodieWriteStats.forEach(writeStat -> {
```

### KeySetIterationMayUseEntrySet
Iteration over `ptToReplacedFileId.keySet()` may be replaced with 'entrySet()' iteration
in `hudi-common/src/main/java/org/apache/hudi/common/table/cdc/HoodieCDCExtractor.java`
#### Snippet
```java
        HoodieReplaceCommitMetadata replaceCommitMetadata = (HoodieReplaceCommitMetadata) commitMetadata;
        Map<String, List<String>> ptToReplacedFileId = replaceCommitMetadata.getPartitionToReplaceFileIds();
        for (String partition : ptToReplacedFileId.keySet()) {
          List<String> fileIds = ptToReplacedFileId.get(partition);
          fileIds.forEach(fileId -> {
```

### KeySetIterationMayUseEntrySet
Iteration over `filesystemMetadata.keySet()` may be replaced with 'Map.forEach()' iteration
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieMetadataPayload.java`
#### Snippet
```java
      if (metadata != null) {
        filesystemMetadata = metadata;
        filesystemMetadata.keySet().forEach(k -> {
          GenericRecord v = filesystemMetadata.get(k);
          filesystemMetadata.put(k, new HoodieMetadataFileInfo((Long) v.get("size"), (Boolean) v.get("isDeleted")));
```

### KeySetIterationMayUseEntrySet
Iteration over `fileMarkersSetMap.keySet()` may be replaced with 'entrySet()' iteration
in `hudi-timeline-service/src/main/java/org/apache/hudi/timeline/service/handlers/marker/MarkerDirState.java`
#### Snippet
```java
    Map<String, Set<String>> fileMarkersSetMap = MarkerUtils.readTimelineServerBasedMarkersFromFileSystem(
        markerDirPath, fileSystem, hoodieEngineContext, parallelism);
    for (String markersFilePathStr : fileMarkersSetMap.keySet()) {
      Set<String> fileMarkers = fileMarkersSetMap.get(markersFilePathStr);
      if (!fileMarkers.isEmpty()) {
```

## RuleId[ruleID=ForLoopReplaceableByWhile]
### ForLoopReplaceableByWhile
`for` loop statement may be replace by 'while' loop
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/execution/bulkinsert/RDDPartitionSortPartitioner.java`
#### Snippet
```java
          // Sort locally in partition
          List<Tuple2<String, HoodieRecord<T>>> recordList = new ArrayList<>();
          for (; partition.hasNext(); ) {
            recordList.add(partition.next());
          }
```

## RuleId[ruleID=FinalPrivateMethod]
### FinalPrivateMethod
'private' method declared `final`
in `hudi-common/src/main/java/org/apache/hudi/common/table/timeline/HoodieInstant.java`
#### Snippet
```java
  }

  private static final Map<String, String> createComparableActionsMap() {
    Map<String, String> comparableMap = new HashMap<>();
    comparableMap.put(HoodieTimeline.COMPACTION_ACTION, HoodieTimeline.COMMIT_ACTION);
```

## RuleId[ruleID=SizeReplaceableByIsEmpty]
### SizeReplaceableByIsEmpty
`config.getSplitStrings(META_SYNC_PARTITION_FIELDS).size() > 0` can be replaced with '!config.getSplitStrings(META_SYNC_PARTITION_FIELDS).isEmpty()'
in `hudi-aws/src/main/java/org/apache/hudi/aws/sync/AWSGlueCatalogSyncClient.java`
#### Snippet
```java
  public void updateTableSchema(String tableName, MessageType newSchema) {
    // ToDo Cascade is set in Hive meta sync, but need to investigate how to configure it for Glue meta
    boolean cascade = config.getSplitStrings(META_SYNC_PARTITION_FIELDS).size() > 0;
    try {
      Table table = getTable(awsGlue, databaseName, tableName);
```

### SizeReplaceableByIsEmpty
`logFilePaths.size() > 0` can be replaced with '!logFilePaths.isEmpty()'
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/HoodieLogFileCommand.java`
#### Snippet
```java

    // logFilePaths size must > 1
    checkArgument(logFilePaths.size() > 0, "There is no log file");

    // TODO : readerSchema can change across blocks/log files, fix this inside Scanner
```

### SizeReplaceableByIsEmpty
`config.getSplitStrings(META_SYNC_PARTITION_FIELDS).size() > 0` can be replaced with '!config.getSplitStrings(META_SYNC_PARTITION_FIELDS).isEmpty()'
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/ddl/QueryBasedDDLExecutor.java`
#### Snippet
```java
      String newSchemaStr = HiveSchemaUtil.generateSchemaString(newSchema, config.getSplitStrings(META_SYNC_PARTITION_FIELDS), config.getBoolean(HIVE_SUPPORT_TIMESTAMP_TYPE));
      // Cascade clause should not be present for non-partitioned tables
      String cascadeClause = config.getSplitStrings(META_SYNC_PARTITION_FIELDS).size() > 0 ? " cascade" : "";
      StringBuilder sqlBuilder = new StringBuilder("ALTER TABLE ").append(HIVE_ESCAPE_CHARACTER)
          .append(databaseName).append(HIVE_ESCAPE_CHARACTER).append(".")
```

### SizeReplaceableByIsEmpty
`zkConnectUrl.length() > 0` can be replaced with '!zkConnectUrl.isEmpty()'
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/transaction/lock/HiveMetastoreBasedLockProvider.java`
#### Snippet
```java
    hiveConf.set("hive.lock.sleep.between.retries", lockConfiguration.getConfig().getString(LOCK_ACQUIRE_RETRY_WAIT_TIME_IN_MILLIS_PROP_KEY));
    String zkConnectUrl = lockConfiguration.getConfig().getOrDefault(ZK_CONNECT_URL_PROP_KEY, "").toString();
    if (zkConnectUrl.length() > 0) {
      hiveConf.set("hive.zookeeper.quorum", zkConnectUrl);
    }
```

### SizeReplaceableByIsEmpty
`zkPort.length() > 0` can be replaced with '!zkPort.isEmpty()'
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/transaction/lock/HiveMetastoreBasedLockProvider.java`
#### Snippet
```java
    }
    String zkPort = lockConfiguration.getConfig().getOrDefault(ZK_PORT_PROP_KEY, "").toString();
    if (zkPort.length() > 0) {
      hiveConf.set("hive.zookeeper.client.port", zkPort);
    }
```

### SizeReplaceableByIsEmpty
`zkSessionTimeout.length() > 0` can be replaced with '!zkSessionTimeout.isEmpty()'
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/transaction/lock/HiveMetastoreBasedLockProvider.java`
#### Snippet
```java
    }
    String zkSessionTimeout = lockConfiguration.getConfig().getOrDefault(ZK_SESSION_TIMEOUT_MS_PROP_KEY, "").toString();
    if (zkSessionTimeout.length() > 0) {
      hiveConf.set("hive.zookeeper.session.timeout", zkSessionTimeout);
    }
```

### SizeReplaceableByIsEmpty
`syncConfig.getSplitStrings(META_SYNC_PARTITION_FIELDS).size() > 0` can be replaced with '!syncConfig.getSplitStrings(META_SYNC_PARTITION_FIELDS).isEmpty()'
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/ddl/HMSDDLExecutor.java`
#### Snippet
```java
  public void updateTableDefinition(String tableName, MessageType newSchema) {
    try {
      boolean cascade = syncConfig.getSplitStrings(META_SYNC_PARTITION_FIELDS).size() > 0;
      List<FieldSchema> fieldSchema = HiveSchemaUtil.convertParquetSchemaToHiveFieldSchema(newSchema, syncConfig);
      Table table = client.getTable(databaseName, tableName);
```

### SizeReplaceableByIsEmpty
`partitionPaths.size() > 0` can be replaced with '!partitionPaths.isEmpty()'
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/table/action/commit/JavaInsertOverwriteTableCommitActionExecutor.java`
#### Snippet
```java
        table.getMetaClient().getBasePath(), config.isMetadataTableEnabled(), config.shouldAssumeDatePartitioning());

    if (partitionPaths != null && partitionPaths.size() > 0) {
      partitionToExistingFileIds = context.mapToPair(partitionPaths,
          partitionPath -> Pair.of(partitionPath, getAllExistingFileIds(partitionPath)), 1);
```

### SizeReplaceableByIsEmpty
`partitionPaths.size() > 0` can be replaced with '!partitionPaths.isEmpty()'
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/table/action/commit/JavaUpsertPartitioner.java`
#### Snippet
```java
    }

    if (partitionPaths != null && partitionPaths.size() > 0) {
      context.setJobStatus(this.getClass().getSimpleName(), "Getting small files from partitions: " + config.getTableName());
      partitionSmallFilesMap = context.mapToPair(partitionPaths,
```

### SizeReplaceableByIsEmpty
`insertedRecords.size() > 0` can be replaced with '!insertedRecords.isEmpty()'
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/table/action/deltacommit/JavaUpsertPreppedDeltaCommitActionExecutor.java`
#### Snippet
```java
      });

      if (insertedRecords.size() > 0) {
        HoodieWriteMetadata<List<WriteStatus>> insertResult = JavaBulkInsertHelper.newInstance()
            .bulkInsert(insertedRecords, instantTime, table, config, this, false, Option.empty());
```

### SizeReplaceableByIsEmpty
`op.getDeltaFilePaths().size() > 0` can be replaced with '!op.getDeltaFilePaths().isEmpty()'
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/client/clustering/run/strategy/JavaExecutionStrategy.java`
#### Snippet
```java
  private List<HoodieRecord<T>> readRecordsForGroup(HoodieClusteringGroup clusteringGroup, String instantTime) {
    List<ClusteringOperation> clusteringOps = clusteringGroup.getSlices().stream().map(ClusteringOperation::create).collect(Collectors.toList());
    boolean hasLogFiles = clusteringOps.stream().anyMatch(op -> op.getDeltaFilePaths().size() > 0);
    if (hasLogFiles) {
      // if there are log files, we read all records into memory for a file group and apply updates.
```

### SizeReplaceableByIsEmpty
`rolloverPaths.size() > 0` can be replaced with '!rolloverPaths.isEmpty()'
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/io/FlinkMergeHandle.java`
#### Snippet
```java
  @Override
  public Path getWritePath() {
    return rolloverPaths.size() > 0 ? rolloverPaths.get(0) : newFilePath;
  }
}
```

### SizeReplaceableByIsEmpty
`rolloverPaths.size() == 0` can be replaced with 'rolloverPaths.isEmpty()'
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/io/FlinkMergeHandle.java`
#### Snippet
```java
  public void finalizeWrite() {
    // The file visibility should be kept by the configured ConsistencyGuard instance.
    if (rolloverPaths.size() == 0) {
      // only one flush action, no need to roll over
      return;
```

### SizeReplaceableByIsEmpty
`statuses.size() > 0` can be replaced with '!statuses.isEmpty()'
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/execution/ExplicitWriteHandler.java`
#### Snippet
```java
  public List<WriteStatus> finish() {
    closeOpenHandle();
    checkState(statuses.size() > 0);
    return statuses;
  }
```

### SizeReplaceableByIsEmpty
`preppedRecordList.size() > 0` can be replaced with '!preppedRecordList.isEmpty()'
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/metadata/FlinkHoodieBackedTableMetadataWriter.java`
#### Snippet
```java
      }

      List<WriteStatus> statuses = preppedRecordList.size() > 0
          ? writeClient.upsertPreppedRecords(preppedRecordList, instantTime)
          : Collections.emptyList();
```

### SizeReplaceableByIsEmpty
`partitionPaths.size() > 0` can be replaced with '!partitionPaths.isEmpty()'
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/table/action/commit/UpsertPartitioner.java`
#### Snippet
```java
    }

    if (partitionPaths != null && partitionPaths.size() > 0) {
      context.setJobStatus(this.getClass().getSimpleName(), "Getting small files from partitions: " + config.getTableName());
      JavaRDD<String> partitionPathRdds = jsc.parallelize(partitionPaths, partitionPaths.size());
```

### SizeReplaceableByIsEmpty
`keys.size() > 0` can be replaced with '!keys.isEmpty()'
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/index/hbase/SparkHoodieHBaseIndex.java`
#### Snippet
```java

  private Result[] doGet(HTable hTable, List<Get> keys, RateLimiter limiter) throws IOException {
    if (keys.size() > 0) {
      limiter.tryAcquire(keys.size());
      return hTable.get(keys);
```

### SizeReplaceableByIsEmpty
`lr.getMatchingRecordKeys().size() > 0` can be replaced with '!lr.getMatchingRecordKeys().isEmpty()'
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/index/bloom/SparkHoodieBloomIndexHelper.java`
#### Snippet
```java

    return HoodieJavaPairRDD.of(keyLookupResultRDD.flatMap(List::iterator)
        .filter(lr -> lr.getMatchingRecordKeys().size() > 0)
        .flatMapToPair(lookupResult -> lookupResult.getMatchingRecordKeys().stream()
            .map(recordKey -> new Tuple2<>(new HoodieKey(recordKey, lookupResult.getPartitionPath()),
```

### SizeReplaceableByIsEmpty
`partitionPaths.size() > 0` can be replaced with '!partitionPaths.isEmpty()'
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/client/HoodieFlinkWriteClient.java`
#### Snippet
```java
        List<String> partitionPaths =
            FSUtils.getAllPartitionPaths(context, config.getMetadataConfig(), table.getMetaClient().getBasePath());
        if (partitionPaths != null && partitionPaths.size() > 0) {
          context.setJobStatus(this.getClass().getSimpleName(), "Getting ExistingFileIds of all partitions: " + config.getTableName());
          partitionToExistingFileIds = partitionPaths.stream().parallel()
```

### SizeReplaceableByIsEmpty
`paths.size() == 0` can be replaced with 'paths.isEmpty()'
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/SparkRDDReadClient.java`
#### Snippet
```java
    Dataset<Row> originalDF = null;
    // read files based on the file extension name
    if (paths.size() == 0 || paths.get(0).endsWith(HoodieFileFormat.PARQUET.getFileExtension())) {
      originalDF = sqlContextOpt.get().read().parquet(uniquePaths.toArray(new String[uniquePaths.size()]));
    } else if (paths.get(0).endsWith(HoodieFileFormat.ORC.getFileExtension())) {
```

### SizeReplaceableByIsEmpty
`op.getDeltaFilePaths().size() > 0` can be replaced with '!op.getDeltaFilePaths().isEmpty()'
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/clustering/run/strategy/MultipleSparkJobExecutionStrategy.java`
#### Snippet
```java
    List<ClusteringOperation> clusteringOps = clusteringGroup.getSlices().stream()
        .map(ClusteringOperation::create).collect(Collectors.toList());
    boolean hasLogFiles = clusteringOps.stream().anyMatch(op -> op.getDeltaFilePaths().size() > 0);
    SQLContext sqlContext = new SQLContext(jsc.sc());

```

### SizeReplaceableByIsEmpty
`op.getDeltaFilePaths().size() > 0` can be replaced with '!op.getDeltaFilePaths().isEmpty()'
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/clustering/run/strategy/MultipleSparkJobExecutionStrategy.java`
#### Snippet
```java
  private HoodieData<HoodieRecord<T>> readRecordsForGroup(JavaSparkContext jsc, HoodieClusteringGroup clusteringGroup, String instantTime) {
    List<ClusteringOperation> clusteringOps = clusteringGroup.getSlices().stream().map(ClusteringOperation::create).collect(Collectors.toList());
    boolean hasLogFiles = clusteringOps.stream().anyMatch(op -> op.getDeltaFilePaths().size() > 0);
    if (hasLogFiles) {
      // if there are log files, we read all records into memory for a file group and apply updates.
```

### SizeReplaceableByIsEmpty
`key.length() > 0` can be replaced with '!key.isEmpty()'
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/keygen/BuiltinKeyGenerator.java`
#### Snippet
```java

  protected static String requireNonNullNonEmptyKey(String key) {
    if (key != null && key.length() > 0) {
      return key;
    } else {
```

### SizeReplaceableByIsEmpty
`partitionPath.length() == 0` can be replaced with 'partitionPath.isEmpty()'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/io/HoodieAppendHandle.java`
#### Snippet
```java

  private String makeFilePath(HoodieLogFile logFile) {
    return partitionPath.length() == 0
        ? new Path(logFile.getFileName()).toString()
        : new Path(partitionPath, logFile.getFileName()).toString();
```

### SizeReplaceableByIsEmpty
`recordList.size() > 0` can be replaced with '!recordList.isEmpty()'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/io/HoodieAppendHandle.java`
#### Snippet
```java
      header.put(HoodieLogBlock.HeaderMetadataType.SCHEMA, writeSchemaWithMetaFields.toString());
      List<HoodieLogBlock> blocks = new ArrayList<>(2);
      if (recordList.size() > 0) {
        String keyField = config.populateMetaFields()
            ? HoodieRecord.RECORD_KEY_METADATA_FIELD
```

### SizeReplaceableByIsEmpty
`recordsToDelete.size() > 0` can be replaced with '!recordsToDelete.isEmpty()'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/io/HoodieAppendHandle.java`
#### Snippet
```java
      }

      if (appendDeleteBlocks && recordsToDelete.size() > 0) {
        blocks.add(new HoodieDeleteBlock(recordsToDelete.toArray(new DeleteRecord[0]), header));
      }
```

### SizeReplaceableByIsEmpty
`blocks.size() > 0` can be replaced with '!blocks.isEmpty()'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/io/HoodieAppendHandle.java`
#### Snippet
```java
      }

      if (blocks.size() > 0) {
        AppendResult appendResult = writer.appendBlocks(blocks);
        processAppendResult(appendResult, recordList);
```

### SizeReplaceableByIsEmpty
`lr.getMatchingRecordKeys().size() > 0` can be replaced with '!lr.getMatchingRecordKeys().isEmpty()'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/index/bloom/ListBasedHoodieBloomIndexHelper.java`
#### Snippet
```java
        )
            .flatMap(Collection::stream)
            .filter(lr -> lr.getMatchingRecordKeys().size() > 0)
            .collect(toList());

```

### SizeReplaceableByIsEmpty
`pendingCleanInstants.size() > 0` can be replaced with '!pendingCleanInstants.isEmpty()'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/clean/CleanActionExecutor.java`
#### Snippet
```java
    List<HoodieInstant> pendingCleanInstants = table.getCleanTimeline()
        .filterInflightsAndRequested().getInstants();
    if (pendingCleanInstants.size() > 0) {
      // try to clean old history schema.
      try {
```

### SizeReplaceableByIsEmpty
`cleanMetadataList.size() > 0` can be replaced with '!cleanMetadataList.isEmpty()'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/clean/CleanActionExecutor.java`
#### Snippet
```java
    // TODO (NA) : Clean only the earliest pending clean just like how we do for other table services
    // This requires the CleanActionExecutor to be refactored as BaseCommitActionExecutor
    return cleanMetadataList.size() > 0 ? cleanMetadataList.get(cleanMetadataList.size() - 1) : null;
  }
}
```

### SizeReplaceableByIsEmpty
`partitions.size() > 0` can be replaced with '!partitions.isEmpty()'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/HoodieTable.java`
#### Snippet
```java
  private void clearMetadataTablePartitionsConfig(Option<MetadataPartitionType> partitionType, boolean clearAll) {
    Set<String> partitions = metaClient.getTableConfig().getMetadataPartitions();
    if (clearAll && partitions.size() > 0) {
      LOG.info("Clear hoodie.table.metadata.partitions in hoodie.properties");
      metaClient.getTableConfig().setValue(TABLE_METADATA_PARTITIONS.key(), EMPTY_STRING);
```

### SizeReplaceableByIsEmpty
`subDirectories.size() > 0` can be replaced with '!subDirectories.isEmpty()'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/bootstrap/BootstrapUtils.java`
#### Snippet
```java
    }

    if (subDirectories.size() > 0) {
      result.addAll(context.flatMap(subDirectories, directory -> {
        PathFilter pathFilter = getFilePathFilter(baseFileExtension);
```

### SizeReplaceableByIsEmpty
`subDirectories.size() > 0` can be replaced with '!subDirectories.isEmpty()'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/marker/DirectWriteMarkers.java`
#### Snippet
```java
    }

    if (subDirectories.size() > 0) {
      parallelism = Math.min(subDirectories.size(), parallelism);
      SerializableConfiguration serializedConf = new SerializableConfiguration(fs.getConf());
```

### SizeReplaceableByIsEmpty
`commits.size() > 0` can be replaced with '!commits.isEmpty()'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/upgrade/ZeroToOneUpgradeHandler.java`
#### Snippet
```java
    List<String> commits = inflightTimeline.getReverseOrderedInstants().map(HoodieInstant::getTimestamp)
        .collect(Collectors.toList());
    if (commits.size() > 0 && instantTime != null) {
      // ignore the latest inflight commit since a new commit would have been started and we need to fix any pending commits from previous launch
      commits.remove(instantTime);
```

### SizeReplaceableByIsEmpty
`failedRecordKeys.size() != 0` can be replaced with '!failedRecordKeys.isEmpty()'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/HoodieInternalWriteStatus.java`
#### Snippet
```java

  public boolean hasErrors() {
    return failedRecordKeys.size() != 0;
  }

```

### SizeReplaceableByIsEmpty
`instantsOfOffendingPendingTableServiceAction.size() > 0` can be replaced with '!instantsOfOffendingPendingTableServiceAction.isEmpty()'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/utils/DeletePartitionUtils.java`
#### Snippet
```java
        .forEach(x -> instantsOfOffendingPendingTableServiceAction.add(x.getRight().getTimestamp()));

    if (instantsOfOffendingPendingTableServiceAction.size() > 0) {
      throw new HoodieDeletePartitionException("Failed to drop partitions. "
          + "Please ensure that there are no pending table service actions (clustering/compaction) for the partitions to be deleted: " + partitionsToDrop + ". "
```

### SizeReplaceableByIsEmpty
`records.size() > 0` can be replaced with '!records.isEmpty()'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/HoodieTimelineArchiver.java`
#### Snippet
```java

  private void writeToFile(Schema wrapperSchema, List<IndexedRecord> records) throws Exception {
    if (records.size() > 0) {
      Map<HeaderMetadataType, String> header = new HashMap<>();
      header.put(HoodieLogBlock.HeaderMetadataType.SCHEMA, wrapperSchema.toString());
```

### SizeReplaceableByIsEmpty
`statuses.size() > 0` can be replaced with '!statuses.isEmpty()'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/execution/CopyOnWriteInsertHandler.java`
#### Snippet
```java
  public List<WriteStatus> finish() {
    closeOpenHandles();
    checkState(statuses.size() > 0);
    return statuses;
  }
```

### SizeReplaceableByIsEmpty
`locations.size() > 0` can be replaced with '!locations.isEmpty()'
in `hudi-common/src/main/java/org/apache/hudi/avro/AvroSchemaCompatibility.java`
#### Snippet
```java
    private SchemaCompatibilityResult checkSchemaNames(final Schema reader, final Schema writer,
                                                       final Deque<LocationInfo> locations) {
      checkState(locations.size() > 0);
      // NOTE: We're only going to validate schema names in following cases
      //          - This is a top-level schema (ie enclosing one)
```

### SizeReplaceableByIsEmpty
`path.length() == 0` can be replaced with 'path.isEmpty()'
in `hudi-common/src/main/java/org/apache/hudi/common/util/PartitionPathEncodeUtils.java`
#### Snippet
```java
   */
  public static String escapePathName(String path, String defaultPath) {
    if (path == null || path.length() == 0) {
      if (defaultPath == null) {
        // previously, when path is empty or null and no default path is specified,
```

### SizeReplaceableByIsEmpty
`subPaths.size() > 0` can be replaced with '!subPaths.isEmpty()'
in `hudi-common/src/main/java/org/apache/hudi/common/fs/FSUtils.java`
#### Snippet
```java
      List<String> subPaths) {
    Map<String, T> result = new HashMap<>();
    if (subPaths.size() > 0) {
      SerializableConfiguration conf = new SerializableConfiguration(fs.getConf());
      int actualParallelism = Math.min(subPaths.size(), parallelism);
```

### SizeReplaceableByIsEmpty
`addresses.size() > 0` can be replaced with '!addresses.isEmpty()'
in `hudi-common/src/main/java/org/apache/hudi/common/util/NetworkUtils.java`
#### Snippet
```java
            .filter(NetworkUtils::validAddress)
            .collect(Collectors.toList());
        if (addresses.size() > 0) {
          // IPv4 has higher priority
          InetAddress address = addresses.stream()
```

### SizeReplaceableByIsEmpty
`list.size() == 0` can be replaced with 'list.isEmpty()'
in `hudi-common/src/main/java/org/apache/hudi/common/util/StringUtils.java`
#### Snippet
```java

  public static String join(final List<String> list, final String separator) {
    if (list == null || list.size() == 0) {
      return null;
    }
```

### SizeReplaceableByIsEmpty
`str.length() == 0` can be replaced with 'str.isEmpty()'
in `hudi-common/src/main/java/org/apache/hudi/common/util/StringUtils.java`
#### Snippet
```java

  public static boolean isNullOrEmpty(String str) {
    return str == null || str.length() == 0;
  }

```

### SizeReplaceableByIsEmpty
`children.size() == 0` can be replaced with 'children.isEmpty()'
in `hudi-common/src/main/java/org/apache/hudi/common/util/AvroOrcUtils.java`
#### Snippet
```java
          List<TypeDescription> children = childType.getChildren();
          if (value == null) {
            matches = children == null || children.size() == 0;
          } else {
            matches = addUnionValue(unionVector, children, avroSchema, value, vectorPos);
```

### SizeReplaceableByIsEmpty
`this.queue.size() == 0` can be replaced with 'this.queue.isEmpty()'
in `hudi-common/src/main/java/org/apache/hudi/common/util/queue/BoundedInMemoryQueue.java`
#### Snippet
```java
  @Override
  public boolean isEmpty() {
    return this.queue.size() == 0;
  }

```

### SizeReplaceableByIsEmpty
`logFiles.size() > 0` can be replaced with '!logFiles.isEmpty()'
in `hudi-common/src/main/java/org/apache/hudi/common/model/CompactionOperation.java`
#### Snippet
```java
      this.bootstrapFilePath = dataFile.get().getBootstrapBaseFile().map(BaseFile::getPath);
    } else {
      assert logFiles.size() > 0;
      this.dataFileName = Option.empty();
      this.baseInstantTime = FSUtils.getBaseCommitTimeFromLogPath(logFiles.get(0).getPath());
```

### SizeReplaceableByIsEmpty
`deltaPaths.size() > 0` can be replaced with '!deltaPaths.isEmpty()'
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/LogReaderUtils.java`
#### Snippet
```java
    List<String> deltaPaths = logFiles.stream().sorted(HoodieLogFile.getReverseLogFileComparator()).map(s -> s.getPath().toString())
        .collect(Collectors.toList());
    if (deltaPaths.size() > 0) {
      Map<String, HoodieLogFile> deltaFilePathToFileStatus = logFiles.stream().map(entry -> Pair.of(entry.getPath().toString(), entry))
          .collect(Collectors.toMap(Pair::getKey, Pair::getValue));
```

### SizeReplaceableByIsEmpty
`logFiles.size() > 0` can be replaced with '!logFiles.isEmpty()'
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/HoodieLogFormatReader.java`
#### Snippet
```java
    } else if (currentReader.hasNext()) {
      return true;
    } else if (logFiles.size() > 0) {
      try {
        HoodieLogFile nextLogFile = logFiles.remove(0);
```

### SizeReplaceableByIsEmpty
`logFiles.size() > 0` can be replaced with '!logFiles.isEmpty()'
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/HoodieLogFormatReader.java`
#### Snippet
```java
    this.enableInlineReading = enableRecordLookups;
    this.internalSchema = internalSchema == null ? InternalSchema.getEmptyInternalSchema() : internalSchema;
    if (logFiles.size() > 0) {
      HoodieLogFile nextLogFile = logFiles.remove(0);
      this.currentReader = new HoodieLogFileReader(fs, nextLogFile, readerSchema, bufferSize, readBlocksLazily, false,
```

### SizeReplaceableByIsEmpty
`p.length() > 0` can be replaced with '!p.isEmpty()'
in `hudi-common/src/main/java/org/apache/hudi/common/table/HoodieTableConfig.java`
#### Snippet
```java
    String keyFieldsValue = getStringOrDefault(RECORDKEY_FIELDS, HoodieRecord.RECORD_KEY_METADATA_FIELD);
    return Option.of(Arrays.stream(keyFieldsValue.split(","))
        .filter(p -> p.length() > 0).collect(Collectors.toList()).toArray(new String[] {}));
  }

```

### SizeReplaceableByIsEmpty
`p.length() > 0` can be replaced with '!p.isEmpty()'
in `hudi-common/src/main/java/org/apache/hudi/common/table/HoodieTableConfig.java`
#### Snippet
```java
    if (contains(PARTITION_FIELDS)) {
      return Option.of(Arrays.stream(getString(PARTITION_FIELDS).split(","))
          .filter(p -> p.length() > 0).collect(Collectors.toList()).toArray(new String[] {}));
    }
    return Option.empty();
```

### SizeReplaceableByIsEmpty
`records.size() == 0` can be replaced with 'records.isEmpty()'
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/block/HoodieParquetDataBlock.java`
#### Snippet
```java
  @Override
  protected byte[] serializeRecords(List<HoodieRecord> records) throws IOException {
    if (records.size() == 0) {
      return new byte[0];
    }
```

### SizeReplaceableByIsEmpty
`logBlocksList.size() == 0` can be replaced with 'logBlocksList.isEmpty()'
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/AbstractHoodieLogRecordReader.java`
#### Snippet
```java
          case DELETE_BLOCK:
            List<HoodieLogBlock> logBlocksList = instantToBlocksMap.getOrDefault(instantTime, new ArrayList<>());
            if (logBlocksList.size() == 0) {
              // Keep a track of instant Times in the order of arrival.
              orderedInstantsList.add(instantTime);
```

### SizeReplaceableByIsEmpty
`instantsBlocks.size() == 0` can be replaced with 'instantsBlocks.isEmpty()'
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/AbstractHoodieLogRecordReader.java`
#### Snippet
```java
        }
        List<HoodieLogBlock> instantsBlocks = instantToBlocksMap.get(instantTime);
        if (instantsBlocks.size() == 0) {
          throw new HoodieException("Data corrupted while writing. Found zero blocks for an instant " + instantTime);
        }
```

### SizeReplaceableByIsEmpty
`currentInstantLogBlocks.size() > 0` can be replaced with '!currentInstantLogBlocks.isEmpty()'
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/AbstractHoodieLogRecordReader.java`
#### Snippet
```java
   */
  private boolean isNewInstantBlock(HoodieLogBlock logBlock) {
    return currentInstantLogBlocks.size() > 0 && currentInstantLogBlocks.peek().getBlockType() != CORRUPT_BLOCK
        && !logBlock.getLogBlockHeader().get(INSTANT_TIME)
        .contentEquals(currentInstantLogBlocks.peek().getLogBlockHeader().get(INSTANT_TIME));
```

### SizeReplaceableByIsEmpty
`fileSlices.size() == 0` can be replaced with 'fileSlices.isEmpty()'
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/AbstractTableFileSystemView.java`
#### Snippet
```java
  private Option<FileSlice> fetchAllLogsMergedFileSlice(HoodieFileGroup fileGroup, String maxInstantTime) {
    List<FileSlice> fileSlices = fileGroup.getAllFileSlicesBeforeOn(maxInstantTime).collect(Collectors.toList());
    if (fileSlices.size() == 0) {
      return Option.empty();
    }
```

### SizeReplaceableByIsEmpty
`diffFromOldSchema.size() == 0` can be replaced with 'diffFromOldSchema.isEmpty()'
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/utils/AvroSchemaEvolutionUtils.java`
#### Snippet
```java
        .filter(f -> colNamesFromOldSchema.contains(f) && !inComingInternalSchema.findType(f).equals(oldTableSchema.findType(f)))
        .collect(Collectors.toList());
    if (colNamesFromIncoming.size() == colNamesFromOldSchema.size() && diffFromOldSchema.size() == 0 && typeChangeColumns.isEmpty()) {
      return oldTableSchema;
    }
```

### SizeReplaceableByIsEmpty
`recordsByKeys.size() == 0` can be replaced with 'recordsByKeys.isEmpty()'
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieBackedTableMetadata.java`
#### Snippet
```java
  protected Option<HoodieRecord<HoodieMetadataPayload>> getRecordByKey(String key, String partitionName) {
    List<Pair<String, Option<HoodieRecord<HoodieMetadataPayload>>>> recordsByKeys = getRecordsByKeys(Collections.singletonList(key), partitionName);
    return recordsByKeys.size() == 0 ? Option.empty() : recordsByKeys.get(0).getValue();
  }

```

### SizeReplaceableByIsEmpty
`this.fields.size() == 0` can be replaced with 'this.fields.isEmpty()'
in `hudi-examples/hudi-examples-flink/src/main/java/org/apache/hudi/examples/quickstart/utils/QuickstartConfigurations.java`
#### Snippet
```java

    public String end() {
      if (this.fields.size() == 0) {
        this.fields = FIELDS;
      }
```

### SizeReplaceableByIsEmpty
`nonHoodiePaths.size() > 0` can be replaced with '!nonHoodiePaths.isEmpty()'
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/HoodieCopyOnWriteTableInputFormat.java`
#### Snippet
```java
    // process non hoodie Paths next.
    List<Path> nonHoodiePaths = inputPathHandler.getNonHoodieInputPaths();
    if (nonHoodiePaths.size() > 0) {
      setInputPaths(job, nonHoodiePaths.toArray(new Path[nonHoodiePaths.size()]));
      FileStatus[] fileStatuses = doListStatus(job);
```

### SizeReplaceableByIsEmpty
`snapshotPaths.size() > 0` can be replaced with '!snapshotPaths.isEmpty()'
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/HoodieCopyOnWriteTableInputFormat.java`
#### Snippet
```java
    // process snapshot queries next.
    List<Path> snapshotPaths = inputPathHandler.getSnapshotPaths();
    if (snapshotPaths.size() > 0) {
      returns.addAll(listStatusForSnapshotMode(job, tableMetaClientMap, snapshotPaths));
    }
```

### SizeReplaceableByIsEmpty
`partitionFields.length() > 0` can be replaced with '!partitionFields.isEmpty()'
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/SchemaEvolutionContext.java`
#### Snippet
```java
      // Add partitioning fields to writer schema for resulting row to contain null values for these fields
      String partitionFields = job.get(hive_metastoreConstants.META_TABLE_PARTITION_COLUMNS, "");
      List<String> partitioningFields = partitionFields.length() > 0 ? Arrays.stream(partitionFields.split("/")).collect(Collectors.toList())
          : new ArrayList<>();
      Schema writerSchema = AvroInternalSchemaConverter.convert(internalSchemaOption.get(), tableAvroSchema.getName());
```

### SizeReplaceableByIsEmpty
`partitionFields.length() > 0` can be replaced with '!partitionFields.isEmpty()'
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/realtime/AbstractRealtimeRecordReader.java`
#### Snippet
```java
    String partitionFields = jobConf.get(hive_metastoreConstants.META_TABLE_PARTITION_COLUMNS, "");
    List<String> partitioningFields =
        partitionFields.length() > 0 ? Arrays.stream(partitionFields.split("/")).collect(Collectors.toList())
            : new ArrayList<>();
    writerSchema = HoodieRealtimeRecordReaderUtils.addPartitionFields(writerSchema, partitioningFields);
```

### SizeReplaceableByIsEmpty
`recordReaders.size() > 0` can be replaced with '!recordReaders.isEmpty()'
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/realtime/HoodieCombineRealtimeRecordReader.java`
#### Snippet
```java
    if (this.currentRecordReader.next(key, value)) {
      return true;
    } else if (recordReaders.size() > 0) {
      this.currentRecordReader.close();
      this.currentRecordReader = recordReaders.remove(0);
```

### SizeReplaceableByIsEmpty
`latestFileSlices.size() == 0` can be replaced with 'latestFileSlices.isEmpty()'
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieTableMetadataUtil.java`
#### Snippet
```java
      final List<FileSlice> latestFileSlices = HoodieTableMetadataUtil
          .getPartitionLatestFileSlices(metaClient.get(), fsView, partitionType.getPartitionPath());
      if (latestFileSlices.size() == 0 && !partitionType.getPartitionPath().equals(MetadataPartitionType.FILES.getPartitionPath())) {
        return getFileGroupCount(partitionType, metadataConfig);
      }
```

### SizeReplaceableByIsEmpty
`danglingFilePaths.size() > 0` can be replaced with '!danglingFilePaths.isEmpty()'
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDataTableValidator.java`
#### Snippet
```java
        }).collect(Collectors.toList());

        if (!danglingFilePaths.isEmpty() && danglingFilePaths.size() > 0) {
          LOG.error("Data table validation failed due to dangling files count " + danglingFilePaths.size() + ", found before active timeline");
          danglingFilePaths.forEach(entry -> LOG.error("Dangling file: " + entry.toString()));
```

### SizeReplaceableByIsEmpty
`inpFiles.size() > 0` can be replaced with '!inpFiles.isEmpty()'
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/hive/HoodieCombineHiveInputFormat.java`
#### Snippet
```java
      }

      if (inpFiles.size() > 0) {
        // Processing files
        for (Path filterPath : poolSet) {
```

### SizeReplaceableByIsEmpty
`nonCombinablePaths.size() > 0` can be replaced with '!nonCombinablePaths.isEmpty()'
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/hive/HoodieCombineHiveInputFormat.java`
#### Snippet
```java

    // Process the normal splits
    if (nonCombinablePaths.size() > 0) {
      FileInputFormat.setInputPaths(job, nonCombinablePaths.toArray(new Path[0]));
      InputSplit[] splits = super.getSplits(job, numSplits);
```

### SizeReplaceableByIsEmpty
`combinablePaths.size() > 0` can be replaced with '!combinablePaths.isEmpty()'
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/hive/HoodieCombineHiveInputFormat.java`
#### Snippet
```java

    // Process the combine splits
    if (combinablePaths.size() > 0) {
      FileInputFormat.setInputPaths(job, combinablePaths.toArray(new Path[0]));
      Map<Path, PartitionDesc> pathToPartitionInfo = this.pathToPartitionInfo != null ? this.pathToPartitionInfo
```

### SizeReplaceableByIsEmpty
`relativeFilePathsToDelete.size() > 0` can be replaced with '!relativeFilePathsToDelete.isEmpty()'
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieRepairTool.java`
#### Snippet
```java
          .flatMap(e -> e.getValue().stream())
          .collect(Collectors.toList());
      if (relativeFilePathsToDelete.size() > 0) {
        if (!backupFiles(relativeFilePathsToDelete)) {
          LOG.error("Error backing up dangling files. Exiting...");
```

### SizeReplaceableByIsEmpty
`partitions.size() > 0` can be replaced with '!partitions.isEmpty()'
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieSnapshotCopier.java`
#### Snippet
```java

    List<String> partitions = FSUtils.getAllPartitionPaths(context, baseDir, useFileListingFromMetadata, shouldAssumeDatePartitioning);
    if (partitions.size() > 0) {
      LOG.info(String.format("The job needs to copy %d partitions.", partitions.size()));

```

### SizeReplaceableByIsEmpty
`logFileStatus.size() > 0` can be replaced with '!logFileStatus.isEmpty()'
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/realtime/HoodieMergeOnReadTableInputFormat.java`
#### Snippet
```java
        if (f.getLatestFileSlice().isPresent() && baseFiles.isEmpty()) {
          List<FileStatus> logFileStatus = f.getLatestFileSlice().get().getLogFiles().map(logFile -> logFile.getFileStatus()).collect(Collectors.toList());
          if (logFileStatus.size() > 0) {
            List<HoodieLogFile> deltaLogFiles = logFileStatus.stream().map(l -> new HoodieLogFile(l.getPath(), l.getLen())).collect(Collectors.toList());
            RealtimeFileStatus fileStatus = new RealtimeFileStatus(logFileStatus.get(0), basePath,
```

### SizeReplaceableByIsEmpty
`singleList.size() == 0` can be replaced with 'singleList.isEmpty()'
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/helpers/CloudObjectsSelector.java`
#### Snippet
```java
  protected List<List<Message>> createListPartitions(List<Message> singleList, int eachBatchSize) {
    List<List<Message>> listPartitions = new ArrayList<>();
    if (singleList.size() == 0 || eachBatchSize < 1) {
      return listPartitions;
    }
```

### SizeReplaceableByIsEmpty
`fileStatus.size() == 0` can be replaced with 'fileStatus.isEmpty()'
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/checkpointing/KafkaConnectHdfsProvider.java`
#### Snippet
```java
      throw new HoodieException(e.toString());
    }
    if (fileStatus.size() == 0) {
      throw new HoodieException("No valid Kafka Connect Hdfs file found under:" + this.path.getName());
    }
```

### SizeReplaceableByIsEmpty
`ws.getErrors().size() > 0` can be replaced with '!ws.getErrors().isEmpty()'
in `hudi-kafka-connect/src/main/java/org/apache/hudi/connect/transaction/ConnectTransactionCoordinator.java`
#### Snippet
```java
          allWriteStatuses.stream().filter(WriteStatus::hasErrors).limit(100).forEach(ws -> {
            LOG.error("Global error :", ws.getGlobalError());
            if (ws.getErrors().size() > 0) {
              ws.getErrors().forEach((key, value) -> LOG.trace("Error for key:" + key + " is " + value));
            }
```

### SizeReplaceableByIsEmpty
`buckets.size() > 0` can be replaced with '!buckets.isEmpty()'
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/StreamWriteFunction.java`
#### Snippet
```java
    }
    final List<WriteStatus> writeStatus;
    if (buckets.size() > 0) {
      writeStatus = new ArrayList<>();
      this.buckets.values()
```

### SizeReplaceableByIsEmpty
`records.size() > 0` can be replaced with '!records.isEmpty()'
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/StreamWriteFunction.java`
#### Snippet
```java
          .forEach(bucket -> {
            List<HoodieRecord> records = bucket.writeBuffer();
            if (records.size() > 0) {
              if (config.getBoolean(FlinkOptions.PRE_COMBINE)) {
                Properties props = new Properties();
```

### SizeReplaceableByIsEmpty
`this.buckets.size() > 0` can be replaced with '!this.buckets.isEmpty()'
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/StreamWriteFunction.java`
#### Snippet
```java

  private boolean hasData() {
    return this.buckets.size() > 0
        && this.buckets.values().stream().anyMatch(bucket -> bucket.records.size() > 0);
  }
```

### SizeReplaceableByIsEmpty
`bucket.records.size() > 0` can be replaced with '!bucket.records.isEmpty()'
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/StreamWriteFunction.java`
#### Snippet
```java
  private boolean hasData() {
    return this.buckets.size() > 0
        && this.buckets.values().stream().anyMatch(bucket -> bucket.records.size() > 0);
  }

```

### SizeReplaceableByIsEmpty
`records.size() > 0` can be replaced with '!records.isEmpty()'
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/StreamWriteFunction.java`
#### Snippet
```java

    List<HoodieRecord> records = bucket.writeBuffer();
    ValidationUtils.checkState(records.size() > 0, "Data bucket to flush has no buffering records");
    if (config.getBoolean(FlinkOptions.PRE_COMBINE)) {
      Properties props = new Properties();
```

### SizeReplaceableByIsEmpty
`ws.getErrors().size() > 0` can be replaced with '!ws.getErrors().isEmpty()'
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/StreamWriteOperatorCoordinator.java`
#### Snippet
```java
        LOG.error("Global error for partition path {} and fileID {}: {}",
            ws.getGlobalError(), ws.getPartitionPath(), ws.getFileId());
        if (ws.getErrors().size() > 0) {
          ws.getErrors().forEach((key, value) -> LOG.trace("Error for key:" + key + " and value " + value));
        }
```

### SizeReplaceableByIsEmpty
`writeResults.size() == 0` can be replaced with 'writeResults.isEmpty()'
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/StreamWriteOperatorCoordinator.java`
#### Snippet
```java
        .collect(Collectors.toList());

    if (writeResults.size() == 0) {
      // No data has written, reset the buffer and returns early
      reset();
```

### SizeReplaceableByIsEmpty
`evt.getWriteStatuses().size() > 0` can be replaced with '!evt.getWriteStatuses().isEmpty()'
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/StreamWriteOperatorCoordinator.java`
#### Snippet
```java
      // start to initialize the instant.
      final String instant = Arrays.stream(eventBuffer)
          .filter(evt -> evt.getWriteStatuses().size() > 0)
          .findFirst().map(WriteMetadataEvent::getInstantTime)
          .orElse(WriteMetadataEvent.BOOTSTRAP_INSTANT);
```

### SizeReplaceableByIsEmpty
`this.messages.size() > 0` can be replaced with '!this.messages.isEmpty()'
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/meta/CkpMetadata.java`
#### Snippet
```java
  public String lastPendingInstant() {
    load();
    if (this.messages.size() > 0) {
      CkpMessage ckpMsg = this.messages.get(this.messages.size() - 1);
      // consider 'aborted' as pending too to reuse the instant
```

### SizeReplaceableByIsEmpty
`ws.getErrors().size() > 0` can be replaced with '!ws.getErrors().isEmpty()'
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/DeltaSync.java`
#### Snippet
```java
      writeStatusRDD.filter(WriteStatus::hasErrors).take(100).forEach(ws -> {
        LOG.error("Global error :", ws.getGlobalError());
        if (ws.getErrors().size() > 0) {
          ws.getErrors().forEach((key, value) -> LOG.trace("Error for key:" + key + " is " + value));
        }
```

### SizeReplaceableByIsEmpty
`smallFiles.size() > 0` can be replaced with '!smallFiles.isEmpty()'
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/partitioner/BucketAssigner.java`
#### Snippet
```java
    }
    List<SmallFile> smallFiles = smallFilesOfThisTask(writeProfile.getSmallFiles(partitionPath));
    if (smallFiles.size() > 0) {
      LOG.info("For partitionPath : " + partitionPath + " Small Files => " + smallFiles);
      SmallFileAssignState[] states = smallFiles.stream()
```

### SizeReplaceableByIsEmpty
`op.getDeltaFilePaths().size() > 0` can be replaced with '!op.getDeltaFilePaths().isEmpty()'
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/clustering/ClusteringOperator.java`
#### Snippet
```java

    List<ClusteringOperation> clusteringOps = clusteringGroupInfo.getOperations();
    boolean hasLogFiles = clusteringOps.stream().anyMatch(op -> op.getDeltaFilePaths().size() > 0);

    Iterator<RowData> iterator;
```

### SizeReplaceableByIsEmpty
`partitions.size() > 0` can be replaced with '!partitions.isEmpty()'
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/HoodieTableSink.java`
#### Snippet
```java
  public void applyStaticPartition(Map<String, String> partitions) {
    // #applyOverwrite should have been invoked.
    if (this.overwrite && partitions.size() > 0) {
      this.conf.setString(FlinkOptions.OPERATION, WriteOperationType.INSERT_OVERWRITE.value());
    }
```

### SizeReplaceableByIsEmpty
`types.size() == 0` can be replaced with 'types.isEmpty()'
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/util/AvroSchemaConverter.java`
#### Snippet
```java
   */
  private static boolean recordTypesOfSameNumFields(List<Schema> types) {
    if (types == null || types.size() == 0) {
      return false;
    }
```

### SizeReplaceableByIsEmpty
`pkColumns.size() > 0` can be replaced with '!pkColumns.isEmpty()'
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/HoodieTableFactory.java`
#### Snippet
```java
    List<String> pkColumns = table.getSchema().getPrimaryKey()
        .map(UniqueConstraint::getColumns).orElse(Collections.emptyList());
    if (pkColumns.size() > 0) {
      // the PRIMARY KEY syntax always has higher priority than option FlinkOptions#RECORD_KEY_FIELD
      String recordKey = String.join(",", pkColumns);
```

### SizeReplaceableByIsEmpty
`partitionKeys.size() > 0` can be replaced with '!partitionKeys.isEmpty()'
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/HoodieTableFactory.java`
#### Snippet
```java
    }
    List<String> partitionKeys = table.getPartitionKeys();
    if (partitionKeys.size() > 0) {
      // the PARTITIONED BY syntax always has higher priority than option FlinkOptions#PARTITION_PATH_FIELD
      conf.setString(FlinkOptions.PARTITION_PATH_FIELD, String.join(",", partitionKeys));
```

### SizeReplaceableByIsEmpty
`path.length() == 0` can be replaced with 'path.isEmpty()'
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/FilePathUtils.java`
#### Snippet
```java
   */
  private static String escapePathName(String path) {
    if (path == null || path.length() == 0) {
      throw new TableException("Path should not be null or empty: " + path);
    }
```

### SizeReplaceableByIsEmpty
`partitionKeys.size() == 0` can be replaced with 'partitionKeys.isEmpty()'
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/FilePathUtils.java`
#### Snippet
```java
      Map<String, String> partitionKVs,
      List<String> partitionKeys) {
    if (partitionKeys.size() == 0) {
      // in case the partition fields are not in schema
      return new LinkedHashMap<>(partitionKVs);
```

### SizeReplaceableByIsEmpty
`split.getLogPaths().get().size() > 0` can be replaced with '!split.getLogPaths().get().isEmpty()'
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/cdc/CdcInputFormat.java`
#### Snippet
```java

  private ClosableIterator<RowData> getFileSliceIterator(MergeOnReadInputSplit split) {
    if (!(split.getLogPaths().isPresent() && split.getLogPaths().get().size() > 0)) {
      // base file only
      return getBaseFileIteratorWithMetadata(split.getBasePath().get());
```

### SizeReplaceableByIsEmpty
`relPartitionPaths.size() == 0` can be replaced with 'relPartitionPaths.isEmpty()'
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/HoodieTableSource.java`
#### Snippet
```java
    fileIndex.setPartitionPaths(requiredPartitionPaths);
    List<String> relPartitionPaths = fileIndex.getOrBuildPartitionPaths();
    if (relPartitionPaths.size() == 0) {
      return Collections.emptyList();
    }
```

### SizeReplaceableByIsEmpty
`relPartitionPaths.size() == 0` can be replaced with 'relPartitionPaths.isEmpty()'
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/HoodieTableSource.java`
#### Snippet
```java
    fileIndex.setPartitionPaths(requiredPartitionPaths);
    List<String> relPartitionPaths = fileIndex.getOrBuildPartitionPaths();
    if (relPartitionPaths.size() == 0) {
      return new FileStatus[0];
    }
```

### SizeReplaceableByIsEmpty
`inputSplits.size() == 0` can be replaced with 'inputSplits.isEmpty()'
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/HoodieTableSource.java`
#### Snippet
```java
          case MERGE_ON_READ:
            final List<MergeOnReadInputSplit> inputSplits = buildFileIndex();
            if (inputSplits.size() == 0) {
              // When there is no input splits, just return an empty source.
              LOG.warn("No input splits generate for MERGE_ON_READ input format, returns empty collection instead");
```

### SizeReplaceableByIsEmpty
`split.getLogPaths().get().size() > 0` can be replaced with '!split.getLogPaths().get().isEmpty()'
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/mor/MergeOnReadInputFormat.java`
#### Snippet
```java

  protected ClosableIterator<RowData> initIterator(MergeOnReadInputSplit split) throws IOException {
    if (!(split.getLogPaths().isPresent() && split.getLogPaths().get().size() > 0)) {
      if (split.getInstantRange().isPresent()) {
        // base file only with commit time filtering
```

### SizeReplaceableByIsEmpty
`partitionKeys.size() > 0` can be replaced with '!partitionKeys.isEmpty()'
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/catalog/HoodieHiveCatalog.java`
#### Snippet
```java

    final List<String> partitionKeys = HoodieCatalogUtil.getPartitionKeys(catalogTable);
    if (partitionKeys.size() > 0) {
      Pair<List<FieldSchema>, List<FieldSchema>> splitSchemas = HiveSchemaUtils.splitSchemaByPartitionKeys(allColumns, partitionKeys);
      List<FieldSchema> regularColumns = splitSchemas.getLeft();
```

### SizeReplaceableByIsEmpty
`this.filters.size() == 0` can be replaced with 'this.filters.isEmpty()'
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/source/FileIndex.java`
#### Snippet
```java
      return null;
    }
    if (this.filters == null || this.filters.size() == 0) {
      return null;
    }
```

### SizeReplaceableByIsEmpty
`partitionKeys.size() == 0` can be replaced with 'partitionKeys.isEmpty()'
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/source/FileIndex.java`
#### Snippet
```java
      String defaultParName,
      boolean hivePartition) {
    if (partitionKeys.size() == 0) {
      // non partitioned table
      return Collections.emptyList();
```

### SizeReplaceableByIsEmpty
`filters.size() > 0` can be replaced with '!filters.isEmpty()'
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/source/FileIndex.java`
#### Snippet
```java
   */
  public void setFilters(List<ResolvedExpression> filters) {
    if (filters.size() > 0) {
      this.filters = new ArrayList<>(filters);
    }
```

### SizeReplaceableByIsEmpty
`this.inputSplits.size() == 0` can be replaced with 'this.inputSplits.isEmpty()'
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/source/IncrementalInputSplits.java`
#### Snippet
```java

    public boolean isEmpty() {
      return this.inputSplits.size() == 0;
    }

```

### SizeReplaceableByIsEmpty
`readPartitions.size() == 0` can be replaced with 'readPartitions.isEmpty()'
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/source/IncrementalInputSplits.java`
#### Snippet
```java
      FileIndex fileIndex = getFileIndex();
      readPartitions = new HashSet<>(fileIndex.getOrBuildPartitionPaths());
      if (readPartitions.size() == 0) {
        LOG.warn("No partitions found for reading in user provided path.");
        return Result.EMPTY;
```

### SizeReplaceableByIsEmpty
`instants.size() == 0` can be replaced with 'instants.isEmpty()'
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/source/IncrementalInputSplits.java`
#### Snippet
```java
      fileStatuses = fileIndex.getFilesInPartitions();
    } else {
      if (instants.size() == 0) {
        LOG.info("No new instant found for the table under path " + path + ", skip reading");
        return Result.EMPTY;
```

### SizeReplaceableByIsEmpty
`readPartitions.size() == 0` can be replaced with 'readPartitions.isEmpty()'
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/source/IncrementalInputSplits.java`
#### Snippet
```java
          .map(instant -> WriteProfiles.getCommitMetadata(tableName, path, instant, commitTimeline)).collect(Collectors.toList());
      readPartitions = getReadPartitions(metadataList);
      if (readPartitions.size() == 0) {
        LOG.warn("No partitions found for reading in user provided path.");
        return Result.EMPTY;
```

### SizeReplaceableByIsEmpty
`readPartitions.size() == 0` can be replaced with 'readPartitions.isEmpty()'
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/source/IncrementalInputSplits.java`
#### Snippet
```java
        FileIndex fileIndex = getFileIndex();
        readPartitions = new HashSet<>(fileIndex.getOrBuildPartitionPaths());
        if (readPartitions.size() == 0) {
          LOG.warn("No partitions found for reading in user provided path.");
          return Result.EMPTY;
```

### SizeReplaceableByIsEmpty
`instants.size() == 0` can be replaced with 'instants.isEmpty()'
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/source/IncrementalInputSplits.java`
#### Snippet
```java
    List<HoodieInstant> instants = filterInstantsWithRange(commitTimeline, issuedInstant);
    // get the latest instant that satisfies condition
    final HoodieInstant instantToIssue = instants.size() == 0 ? null : instants.get(instants.size() - 1);
    final InstantRange instantRange;
    if (instantToIssue != null) {
```

### SizeReplaceableByIsEmpty
`readPartitions.size() == 0` can be replaced with 'readPartitions.isEmpty()'
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/source/IncrementalInputSplits.java`
#### Snippet
```java
      FileIndex fileIndex = getFileIndex();
      readPartitions = new HashSet<>(fileIndex.getOrBuildPartitionPaths());
      if (readPartitions.size() == 0) {
        LOG.warn("No partitions found for reading under path: " + path);
        return Result.EMPTY;
```

### SizeReplaceableByIsEmpty
`archivedMetadataList.size() > 0` can be replaced with '!archivedMetadataList.isEmpty()'
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/source/IncrementalInputSplits.java`
#### Snippet
```java
          .map(instant -> WriteProfiles.getCommitMetadata(tableName, path, instant, commitTimeline)).collect(Collectors.toList());
      List<HoodieCommitMetadata> archivedMetadataList = getArchivedMetadata(metaClient, instantRange, commitTimeline, tableName);
      if (archivedMetadataList.size() > 0) {
        LOG.warn("\n"
            + "--------------------------------------------------------------------------------\n"
```

### SizeReplaceableByIsEmpty
`archivedMetadataList.size() > 0` can be replaced with '!archivedMetadataList.isEmpty()'
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/source/IncrementalInputSplits.java`
#### Snippet
```java
            + "--------------------------------------------------------------------------------");
      }
      List<HoodieCommitMetadata> metadataList = archivedMetadataList.size() > 0
          // IMPORTANT: the merged metadata list must be in ascending order by instant time
          ? mergeList(archivedMetadataList, activeMetadataList)
```

### SizeReplaceableByIsEmpty
`readPartitions.size() == 0` can be replaced with 'readPartitions.isEmpty()'
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/source/IncrementalInputSplits.java`
#### Snippet
```java

      readPartitions = getReadPartitions(metadataList);
      if (readPartitions.size() == 0) {
        LOG.warn("No partitions found for reading under path: " + path);
        return Result.EMPTY;
```

### SizeReplaceableByIsEmpty
`filtered.size() > 0` can be replaced with '!filtered.isEmpty()'
in `hudi-flink-datasource/hudi-flink1.13.x/src/main/java/org/apache/hudi/table/format/cow/ParquetSplitReaderUtil.java`
#### Snippet
```java
      }
    }
    ValidationUtils.checkState(filtered.size() > 0, "Corrupted Parquet schema");
    return filtered;
  }
```

### SizeReplaceableByIsEmpty
`filtered.size() > 0` can be replaced with '!filtered.isEmpty()'
in `hudi-flink-datasource/hudi-flink1.14.x/src/main/java/org/apache/hudi/table/format/cow/ParquetSplitReaderUtil.java`
#### Snippet
```java
      }
    }
    ValidationUtils.checkState(filtered.size() > 0, "Corrupted Parquet schema");
    return filtered;
  }
```

### SizeReplaceableByIsEmpty
`listCommitsSince(fs, basePath, commitTimestamp).size() > 0` can be replaced with '!listCommitsSince(fs, basePath, commitTimestamp).isEmpty()'
in `hudi-spark-datasource/hudi-spark/src/main/java/org/apache/hudi/HoodieDataSourceHelpers.java`
#### Snippet
```java
  @PublicAPIMethod(maturity = ApiMaturityLevel.STABLE)
  public static boolean hasNewCommits(FileSystem fs, String basePath, String commitTimestamp) {
    return listCommitsSince(fs, basePath, commitTimestamp).size() > 0;
  }

```

### SizeReplaceableByIsEmpty
`filtered.size() > 0` can be replaced with '!filtered.isEmpty()'
in `hudi-flink-datasource/hudi-flink1.15.x/src/main/java/org/apache/hudi/table/format/cow/ParquetSplitReaderUtil.java`
#### Snippet
```java
      }
    }
    ValidationUtils.checkState(filtered.size() > 0, "Corrupted Parquet schema");
    return filtered;
  }
```

### SizeReplaceableByIsEmpty
`filtered.size() > 0` can be replaced with '!filtered.isEmpty()'
in `hudi-flink-datasource/hudi-flink1.16.x/src/main/java/org/apache/hudi/table/format/cow/ParquetSplitReaderUtil.java`
#### Snippet
```java
      }
    }
    ValidationUtils.checkState(filtered.size() > 0, "Corrupted Parquet schema");
    return filtered;
  }
```

### SizeReplaceableByIsEmpty
`requestContextList.size() > 0` can be replaced with '!requestContextList.isEmpty()'
in `hudi-timeline-service/src/main/java/org/apache/hudi/timeline/service/handlers/marker/MarkerCreationDispatchingRunnable.java`
#### Snippet
```java
    }

    if (requestContextList.size() > 0) {
      executorService.execute(
          new BatchedMarkerCreationRunnable(requestContextList));
```

## RuleId[ruleID=FinalStaticMethod]
### FinalStaticMethod
'static' method declared `final`
in `hudi-common/src/main/java/org/apache/hudi/common/table/timeline/HoodieInstant.java`
#### Snippet
```java
  }

  private static final Map<String, String> createComparableActionsMap() {
    Map<String, String> comparableMap = new HashMap<>();
    comparableMap.put(HoodieTimeline.COMPACTION_ACTION, HoodieTimeline.COMMIT_ACTION);
```

### FinalStaticMethod
'static' method declared `final`
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/HoodieDeltaStreamer.java`
#### Snippet
```java
  }

  public static final Config getConfig(String[] args) {
    Config cfg = new Config();
    JCommander cmd = new JCommander(cfg, null, args);
```

## RuleId[ruleID=TrivialStringConcatenation]
### TrivialStringConcatenation
Empty string used in concatenation
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/utils/SparkInternalSchemaConverter.java`
#### Snippet
```java
          newV.putDouble(i, isInt ? oldV.getInt(i) : oldV.getLong(i));
        } else if (newType instanceof StringType) {
          newV.putByteArray(i, ((isInt ? oldV.getInt(i) : oldV.getLong(i)) + "").getBytes(StandardCharsets.UTF_8));
        } else if (newType instanceof DecimalType) {
          Decimal oldDecimal = Decimal.apply(isInt ? oldV.getInt(i) : oldV.getLong(i));
```

### TrivialStringConcatenation
Empty string used in concatenation
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/utils/SparkInternalSchemaConverter.java`
#### Snippet
```java
        // float -> double/string/decimal
        if (newType instanceof DoubleType) {
          newV.putDouble(i, Double.valueOf(oldV.getFloat(i) + ""));
        } else if (newType instanceof StringType) {
          newV.putByteArray(i, (oldV.getFloat(i) + "").getBytes(StandardCharsets.UTF_8));
```

### TrivialStringConcatenation
Empty string used in concatenation
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/utils/SparkInternalSchemaConverter.java`
#### Snippet
```java
          newV.putDouble(i, Double.valueOf(oldV.getFloat(i) + ""));
        } else if (newType instanceof StringType) {
          newV.putByteArray(i, (oldV.getFloat(i) + "").getBytes(StandardCharsets.UTF_8));
        } else if (newType instanceof DecimalType) {
          Decimal oldDecimal = Decimal.apply(oldV.getFloat(i));
```

### TrivialStringConcatenation
Empty string used in concatenation
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/utils/SparkInternalSchemaConverter.java`
#### Snippet
```java
          newV.putDecimal(i, oldDecimal, ((DecimalType) newType).precision());
        } else if (newType instanceof StringType) {
          newV.putByteArray(i, (oldV.getDouble(i) + "").getBytes(StandardCharsets.UTF_8));
        }
      }
```

### TrivialStringConcatenation
Empty string used in concatenation
in `hudi-common/src/main/java/org/apache/hudi/avro/HoodieAvroUtils.java`
#### Snippet
```java
        if (oldSchema.getType() == Schema.Type.FLOAT) {
          // java float cannot convert to double directly, deal with float precision change
          return Double.valueOf(oldValue + "");
        } else if (oldSchema.getType() == Schema.Type.INT) {
          return ((Integer) oldValue).doubleValue();
```

### TrivialStringConcatenation
Empty string used in concatenation
in `hudi-common/src/main/java/org/apache/hudi/common/util/NumericUtils.java`
#### Snippet
```java
    }
    int exp = (int) (Math.log(bytes) / Math.log(1024));
    String pre = "KMGTPE".charAt(exp - 1) + "";
    return String.format("%.1f %sB", bytes / Math.pow(1024, exp), pre);
  }
```

### TrivialStringConcatenation
Empty string used in concatenation
in `hudi-common/src/main/java/org/apache/hudi/common/util/InternalSchemaCache.java`
#### Snippet
```java
    Path candidateCommitFile = commitSet.stream().filter(fileName -> {
      String fileExtension = HoodieInstant.getTimelineFileExtension(fileName);
      return fileName.replace(fileExtension, "").equals(versionId + "");
    }).findFirst().map(f -> new Path(hoodieMetaPath, f)).orElse(null);
    if (candidateCommitFile != null) {
```

### TrivialStringConcatenation
Empty string used in concatenation
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/helpers/IncrSourceHelper.java`
#### Snippet
```java
    ValidationUtils.checkArgument(ts > 0, "Timestamp must be positive");
    long lower = ts - 1;
    return "" + lower;
  }

```

## RuleId[ruleID=NullableProblems]
### NullableProblems
Primitive type members cannot be annotated
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieRollingStat.java`
#### Snippet
```java
  @Nullable
  private long totalInputWriteBytesToDisk;
  @Nullable
  private long totalInputWriteBytesOnDisk;

```

### NullableProblems
Primitive type members cannot be annotated
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieRollingStat.java`
#### Snippet
```java
  private long deletes;
  // TODO
  @Nullable
  private long totalInputWriteBytesToDisk;
  @Nullable
```

### NullableProblems
Primitive type members cannot be annotated
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieWriteStat.java`
#### Snippet
```java
   * Total size of all log files for a file slice with this base fileid.
   */
  @Nullable
  private long totalLogSizeCompacted;

```

### NullableProblems
Getter for @Nullable field might be annotated @Nullable itself
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieWriteStat.java`
#### Snippet
```java
  }

  public String getPartitionPath() {
    return partitionPath;
  }
```

### NullableProblems
Setter parameter for @Nullable field might be annotated @Nullable itself
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieWriteStat.java`
#### Snippet
```java
  }

  public void setPartitionPath(String partitionPath) {
    this.partitionPath = partitionPath;
  }
```

### NullableProblems
Primitive type members cannot be annotated
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieWriteStat.java`
#### Snippet
```java
    }

    @Nullable
    public long getTotalCreateTime() {
      return totalCreateTime;
```

### NullableProblems
Getter for @Nullable field might be annotated @Nullable itself
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieWriteStat.java`
#### Snippet
```java
  }

  public Long getMinEventTime() {
    return minEventTime;
  }
```

### NullableProblems
Primitive type members cannot be annotated
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieWriteStat.java`
#### Snippet
```java
     * Total time taken to read and merge logblocks in a log file.
     */
    @Nullable
    private long totalScanTime;

```

### NullableProblems
Primitive type members cannot be annotated
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieWriteStat.java`
#### Snippet
```java
   * Total number of rollback blocks seen in a compaction operation.
   */
  @Nullable
  private long totalRollbackBlocks;

```

### NullableProblems
Primitive type members cannot be annotated
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieWriteStat.java`
#### Snippet
```java
   * Total number of log records that were compacted by a compaction operation.
   */
  @Nullable
  private long totalLogRecords;

```

### NullableProblems
Getter for @Nullable field might be annotated @Nullable itself
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieWriteStat.java`
#### Snippet
```java
  }

  public String getTempPath() {
    return this.tempPath;
  }
```

### NullableProblems
Primitive type members cannot be annotated
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieWriteStat.java`
#### Snippet
```java
    private long totalCreateTime;

    @Nullable
    public long getTotalScanTime() {
      return totalScanTime;
```

### NullableProblems
Primitive type members cannot be annotated
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieWriteStat.java`
#### Snippet
```java
   * Total number of corrupt blocks seen in a compaction operation.
   */
  @Nullable
  private long totalCorruptLogBlock;

```

### NullableProblems
Primitive type members cannot be annotated
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieWriteStat.java`
#### Snippet
```java
   * Total number of log blocks seen in a compaction operation.
   */
  @Nullable
  private long totalLogBlocks;

```

### NullableProblems
Primitive type members cannot be annotated
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieWriteStat.java`
#### Snippet
```java
    }

    @Nullable
    public long getTotalUpsertTime() {
      return totalUpsertTime;
```

### NullableProblems
Primitive type members cannot be annotated
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieWriteStat.java`
#### Snippet
```java
     * Total time taken by a Hoodie Merge for an existing file.
     */
    @Nullable
    private long totalUpsertTime;

```

### NullableProblems
Primitive type members cannot be annotated
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieWriteStat.java`
#### Snippet
```java
     * Total time taken by a Hoodie Insert to a file.
     */
    @Nullable
    private long totalCreateTime;

```

### NullableProblems
Primitive type members cannot be annotated
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieWriteStat.java`
#### Snippet
```java
    }

    public void setTotalUpsertTime(@Nullable long totalUpsertTime) {
      this.totalUpsertTime = totalUpsertTime;
    }
```

### NullableProblems
Getter for @Nullable field might be annotated @Nullable itself
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieWriteStat.java`
#### Snippet
```java
  }

  public Long getMaxEventTime() {
    return maxEventTime;
  }
```

### NullableProblems
Setter parameter for @Nullable field might be annotated @Nullable itself
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieWriteStat.java`
#### Snippet
```java
  }

  public void setTempPath(String tempPath) {
    this.tempPath = tempPath;
  }
```

### NullableProblems
Primitive type members cannot be annotated
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieWriteStat.java`
#### Snippet
```java
   * Total number of records updated by a compaction operation.
   */
  @Nullable
  private long totalUpdatedRecordsCompacted;

```

### NullableProblems
Primitive type members cannot be annotated
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieWriteStat.java`
#### Snippet
```java
   * Total number of log files compacted for a file slice with this base fileid.
   */
  @Nullable
  private long totalLogFilesCompacted;

```

### NullableProblems
Primitive type members cannot be annotated
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieWriteStat.java`
#### Snippet
```java
    }

    public void setTotalCreateTime(@Nullable long totalCreateTime) {
      this.totalCreateTime = totalCreateTime;
    }
```

### NullableProblems
Primitive type members cannot be annotated
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieWriteStat.java`
#### Snippet
```java
    }

    public void setTotalScanTime(@Nullable long totalScanTime) {
      this.totalScanTime = totalScanTime;
    }
```

## RuleId[ruleID=EqualsBetweenInconvertibleTypes]
### EqualsBetweenInconvertibleTypes
`equals` between objects of inconvertible types 'String' and 'StringType'
in `hudi-common/src/main/java/org/apache/hudi/common/util/AvroOrcUtils.java`
#### Snippet
```java
      case STRING:
        String stringType = avroSchema.getProp(GenericData.STRING_PROP);
        if (stringType == null || !stringType.equals(StringType.String)) {
          int stringLength = ((BytesColumnVector) colVector).length[vectorPos];
          int stringOffset = ((BytesColumnVector) colVector).start[vectorPos];
```

## RuleId[ruleID=IgnoreResultOfCall]
### IgnoreResultOfCall
Result of `File.delete()` is ignored
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/TableCommand.java`
#### Snippet
```java
    File outFile = new File(filePath);
    if (outFile.exists()) {
      outFile.delete();
    }
    OutputStream os = null;
```

### IgnoreResultOfCall
Result of `HoodieCLI.getTableMetaClient()` is ignored
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/MetadataCommand.java`
#### Snippet
```java
  public String listFiles(
      @ShellOption(value = {"--partition"}, help = "Name of the partition to list files", defaultValue = "") final String partition) throws IOException {
    HoodieCLI.getTableMetaClient();
    HoodieMetadataConfig config = HoodieMetadataConfig.newBuilder().enable(true).build();
    HoodieBackedTableMetadata metaReader = new HoodieBackedTableMetadata(
```

### IgnoreResultOfCall
Result of `HoodieCLI.getTableMetaClient()` is ignored
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/MetadataCommand.java`
#### Snippet
```java
  @ShellMethod(key = "metadata stats", value = "Print stats about the metadata")
  public String stats() throws IOException {
    HoodieCLI.getTableMetaClient();
    HoodieMetadataConfig config = HoodieMetadataConfig.newBuilder().enable(true).build();
    HoodieBackedTableMetadata metadata = new HoodieBackedTableMetadata(new HoodieLocalEngineContext(HoodieCLI.conf),
```

### IgnoreResultOfCall
Result of `HoodieCLI.getTableMetaClient()` is ignored
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/MetadataCommand.java`
#### Snippet
```java
      @ShellOption(value = "--sparkMaster", defaultValue = SparkUtil.DEFAULT_SPARK_MASTER, help = "Spark master") final String master
  ) throws IOException {
    HoodieCLI.getTableMetaClient();
    initJavaSparkContext(Option.of(master));
    HoodieMetadataConfig config = HoodieMetadataConfig.newBuilder().enable(true).build();
```

### IgnoreResultOfCall
Result of `HoodieCLI.getTableMetaClient()` is ignored
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/MetadataCommand.java`
#### Snippet
```java
                     @ShellOption(value = {"--readonly"}, defaultValue = "false",
                         help = "Open in read-only mode") final boolean readOnly) throws Exception {
    HoodieCLI.getTableMetaClient();
    Path metadataPath = new Path(getMetadataTableBasePath(HoodieCLI.basePath));
    try {
```

### IgnoreResultOfCall
Result of `HoodieCLI.getTableMetaClient()` is ignored
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/MetadataCommand.java`
#### Snippet
```java
  @ShellMethod(key = "metadata delete", value = "Remove the Metadata Table")
  public String delete() throws Exception {
    HoodieCLI.getTableMetaClient();
    Path metadataPath = new Path(getMetadataTableBasePath(HoodieCLI.basePath));
    try {
```

### IgnoreResultOfCall
Result of `HoodieCLI.getTableMetaClient()` is ignored
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/MetadataCommand.java`
#### Snippet
```java
      @ShellOption(value = "--sparkMaster", defaultValue = SparkUtil.DEFAULT_SPARK_MASTER, help = "Spark master") final String master
  ) throws IOException {
    HoodieCLI.getTableMetaClient();
    Path metadataPath = new Path(getMetadataTableBasePath(HoodieCLI.basePath));
    try {
```

### IgnoreResultOfCall
Result of `HoodieCLI.getTableMetaClient()` is ignored
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/MetadataCommand.java`
#### Snippet
```java
  public String validateFiles(
      @ShellOption(value = {"--verbose"}, help = "Print all file details", defaultValue = "false") final boolean verbose) throws IOException {
    HoodieCLI.getTableMetaClient();
    HoodieMetadataConfig config = HoodieMetadataConfig.newBuilder().enable(true).build();
    HoodieBackedTableMetadata metadataReader = new HoodieBackedTableMetadata(
```

### IgnoreResultOfCall
Result of `File.delete()` is ignored
in `hudi-common/src/main/java/org/apache/hudi/common/util/FileIOUtils.java`
#### Snippet
```java
  public static void deleteDirectory(File directory) throws IOException {
    if (directory.exists()) {
      Files.walk(directory.toPath()).sorted(Comparator.reverseOrder()).map(Path::toFile).forEach(File::delete);
      directory.delete();
      if (directory.exists()) {
```

### IgnoreResultOfCall
Result of `File.delete()` is ignored
in `hudi-common/src/main/java/org/apache/hudi/common/util/FileIOUtils.java`
#### Snippet
```java
    if (directory.exists()) {
      Files.walk(directory.toPath()).sorted(Comparator.reverseOrder()).map(Path::toFile).forEach(File::delete);
      directory.delete();
      if (directory.exists()) {
        throw new IOException("Unable to delete directory " + directory);
```

### IgnoreResultOfCall
Result of `File.mkdirs()` is ignored
in `hudi-common/src/main/java/org/apache/hudi/common/util/FileIOUtils.java`
#### Snippet
```java
  public static void mkdir(File directory) throws IOException {
    if (!directory.exists()) {
      directory.mkdirs();
    }

```

### IgnoreResultOfCall
Result of `File.delete()` is ignored
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/BitCaskDiskMap.java`
#### Snippet
```java
        }
      }
      writeOnlyFile.delete();
      this.iterators.forEach(ClosableIterator::close);
    } catch (Exception e) {
```

### IgnoreResultOfCall
Result of `File.delete()` is ignored
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/BitCaskDiskMap.java`
#### Snippet
```java
    } catch (Exception e) {
      // delete the file for any sort of exception
      writeOnlyFile.delete();
    } finally {
      super.close();
```

### IgnoreResultOfCall
Result of `File.delete()` is ignored
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/BitCaskDiskMap.java`
#### Snippet
```java
    // delete the file if it exists
    if (writeOnlyFile.exists()) {
      writeOnlyFile.delete();
    }
    if (!writeOnlyFile.getParentFile().exists()) {
```

### IgnoreResultOfCall
Result of `File.mkdir()` is ignored
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/BitCaskDiskMap.java`
#### Snippet
```java
    }
    if (!writeOnlyFile.getParentFile().exists()) {
      writeOnlyFile.getParentFile().mkdir();
    }
    writeOnlyFile.createNewFile();
```

### IgnoreResultOfCall
Result of `File.createNewFile()` is ignored
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/BitCaskDiskMap.java`
#### Snippet
```java
      writeOnlyFile.getParentFile().mkdir();
    }
    writeOnlyFile.createNewFile();
    LOG.debug("Spilling to file location " + writeOnlyFile.getAbsolutePath());
    // Make sure file is deleted when JVM exits
```

### IgnoreResultOfCall
Result of `File.mkdirs()` is ignored
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/SpillableMapBasedFileSystemView.java`
#### Snippet
```java
      LOG.info("Creating file group id to replace instant map using external spillable Map. Max Mem=" + maxMemoryForReplaceFileGroups
          + ", BaseDir=" + baseStoreDir);
      new File(baseStoreDir).mkdirs();
      Map<HoodieFileGroupId, HoodieInstant> pendingMap = new ExternalSpillableMap<>(
          maxMemoryForReplaceFileGroups, baseStoreDir, new DefaultSizeEstimator(), new DefaultSizeEstimator<>(),
```

### IgnoreResultOfCall
Result of `File.mkdirs()` is ignored
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/SpillableMapBasedFileSystemView.java`
#### Snippet
```java
      LOG.info("Creating file group id to clustering instant map using external spillable Map. Max Mem=" + maxMemoryForClusteringFileGroups
          + ", BaseDir=" + baseStoreDir);
      new File(baseStoreDir).mkdirs();
      Map<HoodieFileGroupId, HoodieInstant> pendingMap = new ExternalSpillableMap<>(
          maxMemoryForClusteringFileGroups, baseStoreDir, new DefaultSizeEstimator(), new DefaultSizeEstimator<>(),
```

### IgnoreResultOfCall
Result of `File.mkdirs()` is ignored
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/SpillableMapBasedFileSystemView.java`
#### Snippet
```java
      LOG.info("Creating Pending Compaction map using external spillable Map. Max Mem=" + maxMemoryForPendingCompaction
          + ", BaseDir=" + baseStoreDir);
      new File(baseStoreDir).mkdirs();
      Map<HoodieFileGroupId, Pair<String, CompactionOperation>> pendingMap = new ExternalSpillableMap<>(
          maxMemoryForPendingCompaction, baseStoreDir, new DefaultSizeEstimator(), new DefaultSizeEstimator<>(),
```

### IgnoreResultOfCall
Result of `File.mkdirs()` is ignored
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/SpillableMapBasedFileSystemView.java`
#### Snippet
```java
      LOG.info("Creating Partition To File groups map using external spillable Map. Max Mem=" + maxMemoryForFileGroupMap
          + ", BaseDir=" + baseStoreDir);
      new File(baseStoreDir).mkdirs();
      return (Map<String, List<HoodieFileGroup>>) (new ExternalSpillableMap<>(maxMemoryForFileGroupMap, baseStoreDir,
          new DefaultSizeEstimator(), new DefaultSizeEstimator<>(),
```

### IgnoreResultOfCall
Result of `File.mkdirs()` is ignored
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/SpillableMapBasedFileSystemView.java`
#### Snippet
```java
      LOG.info("Creating Pending Log Compaction map using external spillable Map. Max Mem=" + maxMemoryForPendingLogCompaction
          + ", BaseDir=" + baseStoreDir);
      new File(baseStoreDir).mkdirs();
      Map<HoodieFileGroupId, Pair<String, CompactionOperation>> pendingMap = new ExternalSpillableMap<>(
          maxMemoryForPendingLogCompaction, baseStoreDir, new DefaultSizeEstimator(), new DefaultSizeEstimator<>(),
```

### IgnoreResultOfCall
Result of `File.mkdirs()` is ignored
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/SpillableMapBasedFileSystemView.java`
#### Snippet
```java
      LOG.info("Creating bootstrap base File Map using external spillable Map. Max Mem=" + maxMemoryForBootstrapBaseFile
          + ", BaseDir=" + baseStoreDir);
      new File(baseStoreDir).mkdirs();
      Map<HoodieFileGroupId, BootstrapBaseFileMapping> pendingMap = new ExternalSpillableMap<>(
          maxMemoryForBootstrapBaseFile, baseStoreDir, new DefaultSizeEstimator(), new DefaultSizeEstimator<>(),
```

### IgnoreResultOfCall
Result of `DataInputStream.read()` is ignored
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/JdbcSource.java`
#### Snippet
```java
        passwordFileStream = fileSystem.open(new Path(properties.getString(Config.PASSWORD_FILE)));
        byte[] bytes = new byte[passwordFileStream.available()];
        passwordFileStream.read(bytes);
        dataFrameReader = dataFrameReader.option(Config.PASSWORD_PROP, new String(bytes));
      } else {
```

## RuleId[ruleID=UnnecessaryUnboxing]
### UnnecessaryUnboxing
Unnecessary unboxing
in `hudi-common/src/main/java/org/apache/hudi/common/fs/HoodieRetryWrapperFileSystem.java`
#### Snippet
```java
  public boolean rename(Path src, Path dst) throws IOException {
    return new RetryHelper<Boolean, IOException>(maxRetryIntervalMs, maxRetryNumbers, initialRetryIntervalMs, retryExceptionsList)
        .tryWith(() -> fileSystem.rename(src, dst)).start().booleanValue();
  }

```

### UnnecessaryUnboxing
Unnecessary unboxing
in `hudi-common/src/main/java/org/apache/hudi/common/fs/HoodieRetryWrapperFileSystem.java`
#### Snippet
```java
  @Override
  public boolean exists(Path f) throws IOException {
    return new RetryHelper<Boolean, IOException>(maxRetryIntervalMs, maxRetryNumbers, initialRetryIntervalMs, retryExceptionsList).tryWith(() -> fileSystem.exists(f)).start().booleanValue();
  }

```

### UnnecessaryUnboxing
Unnecessary unboxing
in `hudi-common/src/main/java/org/apache/hudi/common/fs/HoodieRetryWrapperFileSystem.java`
#### Snippet
```java
  @Override
  public boolean createNewFile(Path f) throws IOException {
    return new RetryHelper<Boolean, IOException>(maxRetryIntervalMs, maxRetryNumbers, initialRetryIntervalMs, retryExceptionsList).tryWith(() -> fileSystem.createNewFile(f)).start().booleanValue();
  }

```

### UnnecessaryUnboxing
Unnecessary unboxing
in `hudi-common/src/main/java/org/apache/hudi/common/fs/HoodieRetryWrapperFileSystem.java`
#### Snippet
```java
  public boolean delete(Path f, boolean recursive) throws IOException {
    return new RetryHelper<Boolean, IOException>(maxRetryIntervalMs, maxRetryNumbers, initialRetryIntervalMs, retryExceptionsList)
        .tryWith(() -> fileSystem.delete(f, recursive)).start().booleanValue();
  }

```

### UnnecessaryUnboxing
Unnecessary unboxing
in `hudi-common/src/main/java/org/apache/hudi/common/fs/HoodieRetryWrapperFileSystem.java`
#### Snippet
```java
  public boolean mkdirs(Path f, FsPermission permission) throws IOException {
    return new RetryHelper<Boolean, IOException>(maxRetryIntervalMs, maxRetryNumbers, initialRetryIntervalMs, retryExceptionsList)
        .tryWith(() -> fileSystem.mkdirs(f, permission)).start().booleanValue();
  }

```

### UnnecessaryUnboxing
Unnecessary unboxing
in `hudi-common/src/main/java/org/apache/hudi/common/fs/HoodieRetryWrapperFileSystem.java`
#### Snippet
```java
  @Override
  public boolean delete(Path f) throws IOException {
    return new RetryHelper<Boolean, IOException>(maxRetryIntervalMs, maxRetryNumbers, initialRetryIntervalMs, retryExceptionsList).tryWith(() -> fileSystem.delete(f, true)).start().booleanValue();
  }

```

### UnnecessaryUnboxing
Unnecessary unboxing
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/ArrayUtils.java`
#### Snippet
```java
    final long[] result = new long[array.length];
    for (int i = 0; i < array.length; i++) {
      result[i] = array[i].longValue();
    }
    return result;
```

## RuleId[ruleID=RedundantMethodOverride]
### RedundantMethodOverride
Method `getMetastoreSchema()` is identical to its super method
in `hudi-gcp/src/main/java/org/apache/hudi/gcp/bigquery/HoodieBigQuerySyncClient.java`
#### Snippet
```java

  @Override
  public Map<String, String> getMetastoreSchema(String tableName) {
    // TODO: Implement automatic schema evolution when you add a new column.
    return Collections.emptyMap();
```

### RedundantMethodOverride
Method `bulkInsertPrepped()` is identical to its super method
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/table/HoodieJavaMergeOnReadTable.java`
#### Snippet
```java

  @Override
  public HoodieWriteMetadata<List<WriteStatus>> bulkInsertPrepped(HoodieEngineContext context,
                                                                  String instantTime,
                                                                  List<HoodieRecord<T>> preppedRecords,
```

### RedundantMethodOverride
Method `isWorkloadProfileNeeded()` is identical to its super method
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/table/action/commit/BaseJavaCommitActionExecutor.java`
#### Snippet
```java

  @Override
  protected boolean isWorkloadProfileNeeded() {
    return true;
  }
```

### RedundantMethodOverride
Method `getCommitActionType()` is identical to its super method
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/table/action/commit/BaseJavaCommitActionExecutor.java`
#### Snippet
```java

  @Override
  protected String getCommitActionType() {
    return table.getMetaClient().getCommitActionType();
  }
```

### RedundantMethodOverride
Method `close()` only delegates to its super method
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/io/storage/row/HoodieRowDataParquetWriter.java`
#### Snippet
```java

  @Override
  public void close() throws IOException {
    super.close();
  }
```

### RedundantMethodOverride
Method `execute()` is identical to its super method
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/table/action/commit/FlinkInsertOverwriteTableCommitActionExecutor.java`
#### Snippet
```java

  @Override
  public HoodieWriteMetadata<List<WriteStatus>> execute() {
    return FlinkWriteHelper.newInstance().write(instantTime, inputRecords, context, table,
        config.shouldCombineBeforeInsert(), config.getInsertShuffleParallelism(), this, operationType);
```

### RedundantMethodOverride
Method `scheduleRollback()` is identical to its super method
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/table/HoodieFlinkMergeOnReadTable.java`
#### Snippet
```java

  @Override
  public Option<HoodieRollbackPlan> scheduleRollback(HoodieEngineContext context, String instantTime, HoodieInstant instantToRollback,
                                                     boolean skipTimelinePublish, boolean shouldRollbackUsingMarkers) {
    return new BaseRollbackPlanActionExecutor(context, config, this, instantTime, instantToRollback, skipTimelinePublish,
```

### RedundantMethodOverride
Method `isWorkloadProfileNeeded()` is identical to its super method
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/table/action/commit/BaseFlinkCommitActionExecutor.java`
#### Snippet
```java

  @Override
  protected boolean isWorkloadProfileNeeded() {
    return true;
  }
```

### RedundantMethodOverride
Method `getCommitActionType()` is identical to its super method
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/table/action/commit/BaseFlinkCommitActionExecutor.java`
#### Snippet
```java

  @Override
  protected String getCommitActionType() {
    return table.getMetaClient().getCommitActionType();
  }
```

### RedundantMethodOverride
Method `close()` only delegates to its super method
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/io/storage/HoodieSparkParquetWriter.java`
#### Snippet
```java

  @Override
  public void close() throws IOException {
    super.close();
  }
```

### RedundantMethodOverride
Method `rollbackCommit()` is identical to its super method
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/index/bucket/HoodieSparkConsistentBucketIndex.java`
#### Snippet
```java
   */
  @Override
  public boolean rollbackCommit(String instantTime) {
    return true;
  }
```

### RedundantMethodOverride
Method `getProperty()` is identical to its super method
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/client/common/HoodieFlinkEngineContext.java`
#### Snippet
```java
    }

    public Option<String> getProperty(EngineProperty prop) {
      return Option.empty();
    }
```

### RedundantMethodOverride
Method `finalizeWrite()` only delegates to its super method
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/table/HoodieSparkMergeOnReadTable.java`
#### Snippet
```java

  @Override
  public void finalizeWrite(HoodieEngineContext context, String instantTs, List<HoodieWriteStat> stats)
      throws HoodieIOException {
    // delegate to base class for MOR tables
```

### RedundantMethodOverride
Method `scheduleRollback()` is identical to its super method
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/table/HoodieSparkMergeOnReadTable.java`
#### Snippet
```java

  @Override
  public Option<HoodieRollbackPlan> scheduleRollback(HoodieEngineContext context,
                                                     String instantTime,
                                                     HoodieInstant instantToRollback, boolean skipTimelinePublish, boolean shouldRollbackUsingMarkers) {
```

### RedundantMethodOverride
Method `getCommitActionType()` is identical to its super method
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/table/action/commit/BaseSparkCommitActionExecutor.java`
#### Snippet
```java

  @Override
  protected String getCommitActionType() {
    return table.getMetaClient().getCommitActionType();
  }
```

### RedundantMethodOverride
Method `orderAndFilter()` is identical to its super method
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/compact/strategy/UnBoundedCompactionStrategy.java`
#### Snippet
```java

  @Override
  public List<HoodieCompactionOperation> orderAndFilter(HoodieWriteConfig config,
      List<HoodieCompactionOperation> operations, List<HoodieCompactionPlan> pendingCompactionWorkloads) {
    return operations;
```

### RedundantMethodOverride
Method `getOutputDateFormat()` is identical to its super method
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/keygen/parser/HoodieDateTimeParser.java`
#### Snippet
```java

  @Override
  public String getOutputDateFormat() {
    return config.getString(KeyGeneratorOptions.Config.TIMESTAMP_OUTPUT_DATE_FORMAT_PROP);
  }
```

### RedundantMethodOverride
Method `start()` only delegates to its super method
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metrics/prometheus/PushGatewayReporter.java`
#### Snippet
```java

  @Override
  public void start(long period, TimeUnit unit) {
    super.start(period, unit);
  }
```

### RedundantMethodOverride
Method `start()` is identical to its super method
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/execution/HoodieLazyInsertIterable.java`
#### Snippet
```java

  @Override
  protected void start() {}

  @Override
```

### RedundantMethodOverride
Method `end()` is identical to its super method
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/execution/HoodieLazyInsertIterable.java`
#### Snippet
```java

  @Override
  protected void end() {}

  protected CopyOnWriteInsertHandler getInsertHandler() {
```

### RedundantMethodOverride
Method `close()` only delegates to its super method
in `hudi-common/src/main/java/org/apache/hudi/io/storage/HoodieAvroParquetWriter.java`
#### Snippet
```java

  @Override
  public void close() throws IOException {
    super.close();
  }
```

### RedundantMethodOverride
Method `close()` only delegates to its super method
in `hudi-common/src/main/java/org/apache/hudi/common/fs/HoodieWrapperFileSystem.java`
#### Snippet
```java

  @Override
  public void close() throws IOException {
    // Don't close the wrapped `fileSystem` object. This will end up closing it for every thread since it
    // could be cached across jvm. We don't own that object anyway.
```

### RedundantMethodOverride
Method `hashCode()` is identical to its super method
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieReplaceCommitMetadata.java`
#### Snippet
```java

  @Override
  public int hashCode() {
    int result = partitionToWriteStats.hashCode();
    result = 31 * result + compacted.hashCode();
```

### RedundantMethodOverride
Method `isNestedType()` is identical to its super method
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/Type.java`
#### Snippet
```java
  abstract class PrimitiveType implements Type {
    @Override
    public boolean isNestedType() {
      return false;
    }
```

### RedundantMethodOverride
Method `withPositionChange()` is identical to its super method
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/action/TableChange.java`
#### Snippet
```java

    @Override
    public boolean withPositionChange() {
      return false;
    }
```

### RedundantMethodOverride
Method `withPositionChange()` is identical to its super method
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/action/TableChanges.java`
#### Snippet
```java

    @Override
    public boolean withPositionChange() {
      return false;
    }
```

### RedundantMethodOverride
Method `initializeState()` only delegates to its super method
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/bucket/BucketStreamWriteFunction.java`
#### Snippet
```java

  @Override
  public void initializeState(FunctionInitializationContext context) throws Exception {
    super.initializeState(context);
  }
```

### RedundantMethodOverride
Method `initialize()` only delegates to its super method
in `hudi-spark-datasource/hudi-spark2/src/main/java/org/apache/spark/sql/execution/datasources/parquet/Spark24HoodieVectorizedParquetRecordReader.java`
#### Snippet
```java

  @Override
  public void initialize(InputSplit inputSplit, TaskAttemptContext taskAttemptContext) throws IOException, InterruptedException, UnsupportedOperationException {
    super.initialize(inputSplit, taskAttemptContext);
  }
```

## RuleId[ruleID=ClassNameSameAsAncestorName]
### ClassNameSameAsAncestorName
Class name `Builder` is the same as one of its superclass' names
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/io/storage/HoodieSparkParquetStreamWriter.java`
#### Snippet
```java
  }

  private static class Builder<T> extends ParquetWriter.Builder<T, Builder<T>> {
    private final WriteSupport<T> writeSupport;

```

### ClassNameSameAsAncestorName
Class name `Builder` is the same as one of its superclass' names
in `hudi-common/src/main/java/org/apache/hudi/io/storage/HoodieParquetStreamWriter.java`
#### Snippet
```java
  }

  private static class Builder<T> extends ParquetWriter.Builder<T, Builder<T>> {
    private final WriteSupport<T> writeSupport;

```

### ClassNameSameAsAncestorName
Class name `Builder` is the same as one of its superclass' names
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/HoodieUnMergedLogRecordScanner.java`
#### Snippet
```java
   * Builder used to build {@code HoodieUnMergedLogRecordScanner}.
   */
  public static class Builder extends AbstractHoodieLogRecordReader.Builder {
    private FileSystem fs;
    private String basePath;
```

### ClassNameSameAsAncestorName
Class name `Builder` is the same as one of its superclass' names
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/HoodieMergedLogRecordScanner.java`
#### Snippet
```java
   * Builder used to build {@code HoodieUnMergedLogRecordScanner}.
   */
  public static class Builder extends AbstractHoodieLogRecordReader.Builder {
    private FileSystem fs;
    private String basePath;
```

### ClassNameSameAsAncestorName
Class name `Provider` is the same as one of its superclass' names
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/StreamWriteOperatorCoordinator.java`
#### Snippet
```java
   * Provider for {@link StreamWriteOperatorCoordinator}.
   */
  public static class Provider implements OperatorCoordinator.Provider {
    private final OperatorID operatorId;
    private final Configuration conf;
```

### ClassNameSameAsAncestorName
Class name `Builder` is the same as one of its superclass' names
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/cdc/CdcInputFormat.java`
#### Snippet
```java
   * Builder for {@link CdcInputFormat}.
   */
  public static class Builder extends MergeOnReadInputFormat.Builder {

    public Builder config(Configuration conf) {
```

### ClassNameSameAsAncestorName
Class name `AWSDmsAvroPayload` is the same as one of its superclass' names
in `hudi-spark-datasource/hudi-spark/src/main/java/org/apache/hudi/payload/AWSDmsAvroPayload.java`
#### Snippet
```java
 */
@Deprecated
public class AWSDmsAvroPayload extends org.apache.hudi.common.model.AWSDmsAvroPayload {

  public AWSDmsAvroPayload(GenericRecord record, Comparable orderingVal) {
```

## RuleId[ruleID=IntegerMultiplicationImplicitCastToLong]
### IntegerMultiplicationImplicitCastToLong
timeoutSecs \* 1000: integer multiplication implicitly cast to long
in `hudi-spark-datasource/hudi-spark/src/test/java/HoodieJavaStreamingApp.java`
#### Snippet
```java
    long beginTime = System.currentTimeMillis();
    long currTime = beginTime;
    long timeoutMsecs = timeoutSecs * 1000;

    while ((currTime - beginTime) < timeoutMsecs) {
```

### IntegerMultiplicationImplicitCastToLong
sleepSecsAfterEachRun \* 1000: integer multiplication implicitly cast to long
in `hudi-spark-datasource/hudi-spark/src/test/java/HoodieJavaStreamingApp.java`
#### Snippet
```java
        LOG.info("Got table not found exception. Retrying");
      } finally {
        Thread.sleep(sleepSecsAfterEachRun * 1000);
        currTime = System.currentTimeMillis();
      }
```

## RuleId[ruleID=NestedAssignment]
### NestedAssignment
Result of assignment expression used
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/WorkloadStat.java`
#### Snippet
```java

  public long addInserts(long numInserts) {
    return this.numInserts += numInserts;
  }

```

### NestedAssignment
Result of assignment expression used
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/WorkloadStat.java`
#### Snippet
```java
        location.getFileId(),
        Pair.of(location.getInstantTime(), numInserts + accNumInserts));
    return this.numInserts += numInserts;
  }

```

### NestedAssignment
Result of assignment expression used
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/WorkloadStat.java`
#### Snippet
```java
        location.getFileId(),
        Pair.of(location.getInstantTime(), numUpdates + accNumUpdates));
    return this.numUpdates += numUpdates;
  }

```

### NestedAssignment
Result of assignment expression used
in `hudi-common/src/main/java/org/apache/hudi/common/util/FileIOUtils.java`
#### Snippet
```java
    byte[] buffer = new byte[1024];
    int len;
    while ((len = inputStream.read(buffer)) != -1) {
      outputStream.write(buffer, 0, len);
    }
```

### NestedAssignment
Result of assignment expression used
in `hudi-common/src/main/java/org/apache/hudi/common/util/DateTimeUtils.java`
#### Snippet
```java

    char current;
    while (pos < len && (current = trimmed.charAt(pos)) >= '0' && current <= '9') {
      pos++;
    }
```

### NestedAssignment
Result of assignment expression used
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/BitCaskDiskMap.java`
#### Snippet
```java
      try (InputStream in = new InflaterInputStream(new ByteArrayInputStream(bytes))) {
        int len;
        while ((len = in.read(decompressIntermediateBuffer)) > 0) {
          decompressBaos.write(decompressIntermediateBuffer, 0, len);
        }
```

### NestedAssignment
Result of assignment expression used
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/HoodieLogFileReader.java`
#### Snippet
```java
    this.internalSchema = internalSchema == null ? InternalSchema.getEmptyInternalSchema() : internalSchema;
    if (this.reverseReader) {
      this.reverseLogFilePosition = this.lastReverseLogFilePosition = this.logFile.getFileSize();
    }

```

### NestedAssignment
Result of assignment expression used
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/block/HoodieAvroDataBlock.java`
#### Snippet
```java
      byte[] buffer = new byte[8192];
      int len;
      while ((len = in.read(buffer)) > 0) {
        baos.write(buffer, 0, len);
      }
```

### NestedAssignment
Result of assignment expression used
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/bulk/sort/SortOperator.java`
#### Snippet
```java
    BinaryRowData row = binarySerializer.createInstance();
    MutableObjectIterator<BinaryRowData> iterator = sorter.getIterator();
    while ((row = iterator.next(row)) != null) {
      collector.collect(row);
    }
```

### NestedAssignment
Result of assignment expression used
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/clustering/ClusteringOperator.java`
#### Snippet
```java

      BinaryRowData row = binarySerializer.createInstance();
      while ((row = sorter.getIterator().next(row)) != null) {
        writerHelper.write(row);
      }
```

## RuleId[ruleID=ReplaceAssignmentWithOperatorAssignment]
### ReplaceAssignmentWithOperatorAssignment
`copyCount = copyCount + 1` could be simplified to 'copyCount += 1'
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/ExportCommand.java`
#### Snippet
```java
      if (data != null) {
        writeToFile(localPath, data);
        copyCount = copyCount + 1;
      }
    }
```

### ReplaceAssignmentWithOperatorAssignment
`hiveJdbcUrl = hiveJdbcUrl + "/"` could be simplified to 'hiveJdbcUrl += "/"'
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/ddl/JDBCExecutor.java`
#### Snippet
```java
    }
    if (!hiveJdbcUrl.endsWith("/")) {
      hiveJdbcUrl = hiveJdbcUrl + "/";
    }
    return hiveJdbcUrl + (urlAppend == null ? "" : urlAppend);
```

### ReplaceAssignmentWithOperatorAssignment
``result = result + "`"`` could be simplified to 'result += "\`"'
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/util/HiveSchemaUtil.java`
#### Snippet
```java
    }
    if (!result.endsWith("`")) {
      result = result + "`";
    }
    return result;
```

### ReplaceAssignmentWithOperatorAssignment
`waitMs = waitMs * 2` could be simplified to 'waitMs \*= 2'
in `hudi-common/src/main/java/org/apache/hudi/common/fs/FailSafeConsistencyGuard.java`
#### Snippet
```java

      sleepSafe(waitMs);
      waitMs = waitMs * 2; // double check interval every attempt
      waitMs = Math.min(waitMs, consistencyGuardConfig.getMaxConsistencyCheckIntervalMs());
      attempt++;
```

### ReplaceAssignmentWithOperatorAssignment
`waitMs = waitMs * 2` could be simplified to 'waitMs \*= 2'
in `hudi-common/src/main/java/org/apache/hudi/common/fs/FailSafeConsistencyGuard.java`
#### Snippet
```java
      }
      sleepSafe(waitMs);
      waitMs = waitMs * 2; // double check interval every attempt
      waitMs = Math.min(waitMs, consistencyGuardConfig.getMaxConsistencyCheckIntervalMs());
      attempt++;
```

### ReplaceAssignmentWithOperatorAssignment
`temp = temp | (((long) paddedBytes[i] & 0xff) << (7 - i) * 8)` could be simplified to 'temp \|= (((long) paddedBytes\[i\] \& 0xff) \<\< (7 - i) \* 8)'
in `hudi-common/src/main/java/org/apache/hudi/common/util/BinaryUtil.java`
#### Snippet
```java
    long temp = 0L;
    for (int i = 7; i >= 0; i--) {
      temp = temp | (((long) paddedBytes[i] & 0xff) << (7 - i) * 8);
    }
    return temp;
```

### ReplaceAssignmentWithOperatorAssignment
`temp = (byte) (temp << (bpos - apos))` could be simplified to 'temp \<\<= (bpos - apos)'
in `hudi-common/src/main/java/org/apache/hudi/common/util/BinaryUtil.java`
#### Snippet
```java
    byte temp = (byte) (b & (1 << (7 - bpos)));
    if (apos < bpos) {
      temp = (byte) (temp << (bpos - apos));
    }
    if (apos > bpos) {
```

### ReplaceAssignmentWithOperatorAssignment
`temp = (byte) (temp >> (apos - bpos))` could be simplified to 'temp \>\>= (apos - bpos)'
in `hudi-common/src/main/java/org/apache/hudi/common/util/BinaryUtil.java`
#### Snippet
```java
    }
    if (apos > bpos) {
      temp = (byte) (temp >> (apos - bpos));
    }
    byte atemp = (byte) (a & (1 << (7 - apos)));
```

### ReplaceAssignmentWithOperatorAssignment
`logWriteToken = logWriteToken + suffix` could be simplified to 'logWriteToken += suffix'
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/HoodieLogFormat.java`
#### Snippet
```java
        // patch the write token with an optional suffix
        // instead of adding a new extension
        logWriteToken = logWriteToken + suffix;
        rolloverLogWriteToken = rolloverLogWriteToken + suffix;
      }
```

### ReplaceAssignmentWithOperatorAssignment
`rolloverLogWriteToken = rolloverLogWriteToken + suffix` could be simplified to 'rolloverLogWriteToken += suffix'
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/HoodieLogFormat.java`
#### Snippet
```java
        // instead of adding a new extension
        logWriteToken = logWriteToken + suffix;
        rolloverLogWriteToken = rolloverLogWriteToken + suffix;
      }

```

## RuleId[ruleID=ReturnFromFinallyBlock]
### ReturnFromFinallyBlock
'return' inside 'finally' block
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieMetadataTableValidator.java`
#### Snippet
```java
        asyncMetadataTableValidateService.get().shutdown(true);
      }
      return result;
    }
  }
```

## RuleId[ruleID=MismatchedCollectionQueryUpdate]
### MismatchedCollectionQueryUpdate
Contents of collection `metaClientMap` are updated, but never queried
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/utils/HoodieInputFormatUtils.java`
#### Snippet
```java
   */
  public static Map<Path, HoodieTableMetaClient> getTableMetaClientByPartitionPath(Configuration conf, Set<Path> partitions) {
    Map<Path, HoodieTableMetaClient> metaClientMap = new HashMap<>();
    return partitions.stream().collect(Collectors.toMap(Function.identity(), p -> {
      try {
```

## RuleId[ruleID=FieldAccessedSynchronizedAndUnsynchronized]
### FieldAccessedSynchronizedAndUnsynchronized
Field `hbaseConnection` is accessed in both synchronized and unsynchronized contexts
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/index/hbase/SparkHoodieHBaseIndex.java`
#### Snippet
```java

  private static final Logger LOG = LogManager.getLogger(SparkHoodieHBaseIndex.class);
  private static Connection hbaseConnection = null;
  private HBaseIndexQPSResourceAllocator hBaseIndexQPSResourceAllocator = null;
  private int maxQpsPerRegionServer;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `compactor` is accessed in both synchronized and unsynchronized contexts
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/async/AsyncCompactService.java`
#### Snippet
```java
  private final int maxConcurrentCompaction;
  protected transient HoodieEngineContext context;
  private transient BaseCompactor compactor;

  public AsyncCompactService(HoodieEngineContext context, BaseHoodieWriteClient client) {
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `clusteringClient` is accessed in both synchronized and unsynchronized contexts
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/async/AsyncClusteringService.java`
#### Snippet
```java
  private final int maxConcurrentClustering;
  protected transient HoodieEngineContext context;
  private transient BaseClusterer clusteringClient;

  public AsyncClusteringService(HoodieEngineContext context, BaseHoodieWriteClient writeClient) {
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `timelineServer` is accessed in both synchronized and unsynchronized contexts
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/BaseHoodieClient.java`
#### Snippet
```java
   * incremental fashion.
   */
  private transient Option<EmbeddedTimelineService> timelineServer;
  private final boolean shouldStopTimelineServer;

```

### FieldAccessedSynchronizedAndUnsynchronized
Field `currentTxnOwnerInstant` is accessed in both synchronized and unsynchronized contexts
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/transaction/TransactionManager.java`
#### Snippet
```java
  protected final LockManager lockManager;
  protected final boolean isOptimisticConcurrencyControlEnabled;
  protected Option<HoodieInstant> currentTxnOwnerInstant = Option.empty();
  private Option<HoodieInstant> lastCompletedTxnOwnerInstant = Option.empty();

```

### FieldAccessedSynchronizedAndUnsynchronized
Field `lastCompletedTxnOwnerInstant` is accessed in both synchronized and unsynchronized contexts
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/transaction/TransactionManager.java`
#### Snippet
```java
  protected final boolean isOptimisticConcurrencyControlEnabled;
  protected Option<HoodieInstant> currentTxnOwnerInstant = Option.empty();
  private Option<HoodieInstant> lastCompletedTxnOwnerInstant = Option.empty();

  public TransactionManager(HoodieWriteConfig config, FileSystem fs) {
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `lockDuration` is accessed in both synchronized and unsynchronized contexts
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/transaction/lock/metrics/HoodieLockMetrics.java`
#### Snippet
```java
  private transient Counter successfulLockAttempts;
  private transient Counter failedLockAttempts;
  private transient Timer lockDuration;
  private transient Timer lockApiRequestDuration;
  private static final Object REGISTRY_LOCK = new Object();
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `lockInfo` is accessed in both synchronized and unsynchronized contexts
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/transaction/lock/FileSystemBasedLockProvider.java`
#### Snippet
```java
  protected LockConfiguration lockConfiguration;
  private SimpleDateFormat sdf;
  private LockInfo lockInfo;
  private String currentOwnerLockInfo;

```

### FieldAccessedSynchronizedAndUnsynchronized
Field `instance` is accessed in both synchronized and unsynchronized contexts
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metrics/Metrics.java`
#### Snippet
```java

  private static volatile boolean initialized = false;
  private static Metrics instance = null;

  private final MetricRegistry registry;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `ref` is accessed in both synchronized and unsynchronized contexts
in `hudi-common/src/main/java/org/apache/hudi/util/Lazy.java`
#### Snippet
```java

  private Supplier<T> initializer;
  private T ref;

  private Lazy(Supplier<T> initializer) {
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `initialized` is accessed in both synchronized and unsynchronized contexts
in `hudi-common/src/main/java/org/apache/hudi/util/Transient.java`
#### Snippet
```java
  private SerializableSupplier<T> initializer;

  private transient boolean initialized;
  private transient T ref;

```

### FieldAccessedSynchronizedAndUnsynchronized
Field `ref` is accessed in both synchronized and unsynchronized contexts
in `hudi-common/src/main/java/org/apache/hudi/util/Transient.java`
#### Snippet
```java

  private transient boolean initialized;
  private transient T ref;

  private Transient(SerializableSupplier<T> initializer) {
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `isStarted` is accessed in both synchronized and unsynchronized contexts
in `hudi-common/src/main/java/org/apache/hudi/common/util/queue/DisruptorMessageQueue.java`
#### Snippet
```java

  private boolean isShutdown = false;
  private boolean isStarted = false;

  private static final long TIMEOUT_WAITING_SECS = 10L;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `isShutdown` is accessed in both synchronized and unsynchronized contexts
in `hudi-common/src/main/java/org/apache/hudi/common/util/queue/DisruptorMessageQueue.java`
#### Snippet
```java
  private final RingBuffer<HoodieDisruptorEvent> ringBuffer;

  private boolean isShutdown = false;
  private boolean isStarted = false;

```

### FieldAccessedSynchronizedAndUnsynchronized
Field `managedHandlesMap` is accessed in both synchronized and unsynchronized contexts
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/RocksDBDAO.java`
#### Snippet
```java
  private static final Logger LOG = LogManager.getLogger(RocksDBDAO.class);

  private transient ConcurrentHashMap<String, ColumnFamilyHandle> managedHandlesMap;
  private transient ConcurrentHashMap<String, ColumnFamilyDescriptor> managedDescriptorMap;
  private transient RocksDB rocksDB;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `managedDescriptorMap` is accessed in both synchronized and unsynchronized contexts
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/RocksDBDAO.java`
#### Snippet
```java

  private transient ConcurrentHashMap<String, ColumnFamilyHandle> managedHandlesMap;
  private transient ConcurrentHashMap<String, ColumnFamilyDescriptor> managedDescriptorMap;
  private transient RocksDB rocksDB;
  private boolean closed = false;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `closed` is accessed in both synchronized and unsynchronized contexts
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/RocksDBDAO.java`
#### Snippet
```java
  private transient ConcurrentHashMap<String, ColumnFamilyDescriptor> managedDescriptorMap;
  private transient RocksDB rocksDB;
  private boolean closed = false;
  private final String rocksDBBasePath;
  private long totalBytesWritten;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `rocksDb` is accessed in both synchronized and unsynchronized contexts
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/RocksDbDiskMap.java`
#### Snippet
```java
  // Stores the key and corresponding value's latest metadata spilled to disk
  private final Set<T> keySet;
  private RocksDBDAO rocksDb;

  public RocksDbDiskMap(String rocksDbStoragePath) throws IOException {
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `totalCorruptBlocks` is accessed in both synchronized and unsynchronized contexts
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/AbstractHoodieLogRecordReader.java`
#### Snippet
```java
  private AtomicLong totalRollbacks = new AtomicLong(0);
  // Total number of corrupt blocks written across all log files
  private AtomicLong totalCorruptBlocks = new AtomicLong(0);
  // Store the last instant log blocks (needed to implement rollback)
  private Deque<HoodieLogBlock> currentInstantLogBlocks = new ArrayDeque<>();
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `totalLogFiles` is accessed in both synchronized and unsynchronized contexts
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/AbstractHoodieLogRecordReader.java`
#### Snippet
```java
  private final FileSystem fs;
  // Total log files read - for metrics
  private AtomicLong totalLogFiles = new AtomicLong(0);
  // Internal schema, used to support full schema evolution.
  private final InternalSchema internalSchema;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `totalLogBlocks` is accessed in both synchronized and unsynchronized contexts
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/AbstractHoodieLogRecordReader.java`
#### Snippet
```java
  private final InternalSchema internalSchema;
  // Total log blocks read - for metrics
  private AtomicLong totalLogBlocks = new AtomicLong(0);
  // Total log records read - for metrics
  private AtomicLong totalLogRecords = new AtomicLong(0);
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `progress` is accessed in both synchronized and unsynchronized contexts
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/AbstractHoodieLogRecordReader.java`
#### Snippet
```java
  protected final boolean forceFullScan;
  // Progress
  private float progress = 0.0f;
  // Populate meta fields for the records
  private final boolean populateMetaFields;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `totalRollbacks` is accessed in both synchronized and unsynchronized contexts
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/AbstractHoodieLogRecordReader.java`
#### Snippet
```java
  private AtomicLong totalLogRecords = new AtomicLong(0);
  // Total number of rollbacks written across all log files
  private AtomicLong totalRollbacks = new AtomicLong(0);
  // Total number of corrupt blocks written across all log files
  private AtomicLong totalCorruptBlocks = new AtomicLong(0);
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `totalLogRecords` is accessed in both synchronized and unsynchronized contexts
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/AbstractHoodieLogRecordReader.java`
#### Snippet
```java
  private AtomicLong totalLogBlocks = new AtomicLong(0);
  // Total log records read - for metrics
  private AtomicLong totalLogRecords = new AtomicLong(0);
  // Total number of rollbacks written across all log files
  private AtomicLong totalRollbacks = new AtomicLong(0);
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `currentInstantLogBlocks` is accessed in both synchronized and unsynchronized contexts
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/AbstractHoodieLogRecordReader.java`
#### Snippet
```java
  private AtomicLong totalCorruptBlocks = new AtomicLong(0);
  // Store the last instant log blocks (needed to implement rollback)
  private Deque<HoodieLogBlock> currentInstantLogBlocks = new ArrayDeque<>();
  // Enables full scan of log records
  protected final boolean forceFullScan;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `counters` is accessed in both synchronized and unsynchronized contexts
in `hudi-common/src/main/java/org/apache/hudi/common/metrics/LocalRegistry.java`
#### Snippet
```java
 */
public class LocalRegistry implements Registry {
  ConcurrentHashMap<String, Counter> counters = new ConcurrentHashMap<>();
  private final String name;

```

### FieldAccessedSynchronizedAndUnsynchronized
Field `indexByPartitionReader` is accessed in both synchronized and unsynchronized contexts
in `hudi-common/src/main/java/org/apache/hudi/common/bootstrap/index/HFileBootstrapIndex.java`
#### Snippet
```java

    // Index Readers
    private transient HFile.Reader indexByPartitionReader;
    private transient HFile.Reader indexByFileIdReader;

```

### FieldAccessedSynchronizedAndUnsynchronized
Field `indexByFileIdReader` is accessed in both synchronized and unsynchronized contexts
in `hudi-common/src/main/java/org/apache/hudi/common/bootstrap/index/HFileBootstrapIndex.java`
#### Snippet
```java
    // Index Readers
    private transient HFile.Reader indexByPartitionReader;
    private transient HFile.Reader indexByFileIdReader;

    // Bootstrap Index Info
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `dataBuffer` is accessed in both synchronized and unsynchronized contexts
in `hudi-examples/hudi-examples-flink/src/main/java/org/apache/hudi/examples/quickstart/source/ContinuousFileSource.java`
#### Snippet
```java
  public static class BoundedSourceFunction implements SourceFunction<String>, CheckpointListener {
    private final Path path;
    private List<String> dataBuffer;

    private final int checkpoints;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `localResult` is accessed in both synchronized and unsynchronized contexts
in `hudi-examples/hudi-examples-flink/src/main/java/org/apache/hudi/examples/quickstart/factory/CollectSinkTableFactory.java`
#### Snippet
```java

    protected transient ListState<Row> resultState;
    protected transient List<Row> localResult;

    private int taskID;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `taskID` is accessed in both synchronized and unsynchronized contexts
in `hudi-examples/hudi-examples-flink/src/main/java/org/apache/hudi/examples/quickstart/factory/CollectSinkTableFactory.java`
#### Snippet
```java
    protected transient List<Row> localResult;

    private int taskID;

    protected CollectSinkFunction(DynamicTableSink.DataStructureConverter converter, RowTypeInfo rowTypeInfo) {
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `agent` is accessed in both synchronized and unsynchronized contexts
in `hudi-kafka-connect/src/main/java/org/apache/hudi/connect/kafka/KafkaConnectControlAgent.java`
#### Snippet
```java
  private static final int EXEC_SHUTDOWN_TIMEOUT_MS = 5000;

  private static KafkaConnectControlAgent agent;
  private final String bootstrapServers;
  private final String controlTopicName;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `fsView` is accessed in both synchronized and unsynchronized contexts
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/partitioner/profile/WriteProfile.java`
#### Snippet
```java
   * The file system view cache for one checkpoint interval.
   */
  protected SyncableFileSystemView fsView;

  /**
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `issuedInstant` is accessed in both synchronized and unsynchronized contexts
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/source/StreamReadMonitoringFunction.java`
#### Snippet
```java
  private volatile boolean isRunning = true;

  private String issuedInstant;

  private transient ListState<String> instantState;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `checkpointLock` is accessed in both synchronized and unsynchronized contexts
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/source/StreamReadMonitoringFunction.java`
#### Snippet
```java
  private final boolean cdcEnabled;

  private transient Object checkpointLock;

  private volatile boolean isRunning = true;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `firstCreationRequestSeen` is accessed in both synchronized and unsynchronized contexts
in `hudi-timeline-service/src/main/java/org/apache/hudi/timeline/service/handlers/MarkerHandler.java`
#### Snippet
```java
  private transient HoodieEngineContext hoodieEngineContext;
  private ScheduledFuture<?> dispatchingThreadFuture;
  private boolean firstCreationRequestSeen;
  private String currentMarkerDir = null;
  private TimelineServerBasedDetectionStrategy earlyConflictDetectionStrategy;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `earlyConflictDetectionStrategy` is accessed in both synchronized and unsynchronized contexts
in `hudi-timeline-service/src/main/java/org/apache/hudi/timeline/service/handlers/MarkerHandler.java`
#### Snippet
```java
  private boolean firstCreationRequestSeen;
  private String currentMarkerDir = null;
  private TimelineServerBasedDetectionStrategy earlyConflictDetectionStrategy;

  public MarkerHandler(Configuration conf, TimelineService.Config timelineServiceConfig,
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `dispatchingThreadFuture` is accessed in both synchronized and unsynchronized contexts
in `hudi-timeline-service/src/main/java/org/apache/hudi/timeline/service/handlers/MarkerHandler.java`
#### Snippet
```java
  private final Object earlyConflictDetectionLock = new Object();
  private transient HoodieEngineContext hoodieEngineContext;
  private ScheduledFuture<?> dispatchingThreadFuture;
  private boolean firstCreationRequestSeen;
  private String currentMarkerDir = null;
```

### FieldAccessedSynchronizedAndUnsynchronized
Field `isMarkerTypeWritten` is accessed in both synchronized and unsynchronized contexts
in `hudi-timeline-service/src/main/java/org/apache/hudi/timeline/service/handlers/marker/MarkerDirState.java`
#### Snippet
```java
  // in a round-robin fashion
  private int lastFileIndexUsed = -1;
  private boolean isMarkerTypeWritten = false;

  public MarkerDirState(String markerDirPath, int markerBatchNumThreads,
```

## RuleId[ruleID=EqualsAndHashcode]
### EqualsAndHashcode
Class has `equals()` defined but does not define `hashCode()`
in `hudi-common/src/main/java/org/apache/hudi/hadoop/SerializablePath.java`
#### Snippet
```java
 * {@link Serializable} wrapper encapsulating {@link Path}
 */
public class SerializablePath implements Serializable {

  private Path path;
```

## RuleId[ruleID=HtmlWrongAttributeValue]
### HtmlWrongAttributeValue
Wrong attribute value
in `log/indexing-diagnostic/project.15375f63/diagnostic-2023-02-26-12-36-11.124.html`
#### Snippet
```java
              <td>0</td>
              <td>0</td>
              <td><textarea rows="10" cols="75" readonly="true" placeholder="empty" style="white-space: pre; border: none">Not collected for refresh</textarea></td>
            </tr>
          </tbody>
```

## RuleId[ruleID=CallToStringConcatCanBeReplacedByOperator]
### CallToStringConcatCanBeReplacedByOperator
Call to `concat()` can be replaced with '+' expression
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieMetadataPayload.java`
#### Snippet
```java
  public static String getColumnStatsIndexKey(PartitionIndexID partitionIndexID, FileIndexID fileIndexID, ColumnIndexID columnIndexID) {
    return columnIndexID.asBase64EncodedString()
        .concat(partitionIndexID.asBase64EncodedString())
        .concat(fileIndexID.asBase64EncodedString());
  }
```

### CallToStringConcatCanBeReplacedByOperator
Call to `concat()` can be replaced with '+' expression
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieMetadataPayload.java`
#### Snippet
```java
    return columnIndexID.asBase64EncodedString()
        .concat(partitionIndexID.asBase64EncodedString())
        .concat(fileIndexID.asBase64EncodedString());
  }

```

### CallToStringConcatCanBeReplacedByOperator
Call to `concat()` can be replaced with '+' expression
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieMetadataPayload.java`
#### Snippet
```java
  public static String getBloomFilterIndexKey(PartitionIndexID partitionIndexID, FileIndexID fileIndexID) {
    return partitionIndexID.asBase64EncodedString()
        .concat(fileIndexID.asBase64EncodedString());
  }

```

### CallToStringConcatCanBeReplacedByOperator
Call to `concat()` can be replaced with '+' expression
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieMetadataPayload.java`
#### Snippet
```java
        "Invalid base file '" + baseFileName + "' for MetaIndexBloomFilter!");
    final String bloomFilterIndexKey = new PartitionIndexID(partitionName).asBase64EncodedString()
        .concat(new FileIndexID(baseFileName).asBase64EncodedString());
    HoodieKey key = new HoodieKey(bloomFilterIndexKey, MetadataPartitionType.BLOOM_FILTERS.getPartitionPath());

```

### CallToStringConcatCanBeReplacedByOperator
Call to `concat()` can be replaced with '+' expression
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/debezium/MysqlDebeziumSource.java`
#### Snippet
```java

  private static String generateUniqueSequence(String fileId, Long pos) {
    return fileId.substring(fileId.lastIndexOf('.') + 1).concat("." + pos);
  }
}
```

### CallToStringConcatCanBeReplacedByOperator
Call to `concat()` can be replaced with '+' expression
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/transform/SqlQueryBasedTransformer.java`
#### Snippet
```java

    // tmp table name doesn't like dashes
    String tmpTable = TMP_TABLE.concat(UUID.randomUUID().toString().replace("-", "_"));
    LOG.info("Registering tmp table : " + tmpTable);
    rowDataset.createOrReplaceTempView(tmpTable);
```

### CallToStringConcatCanBeReplacedByOperator
Call to `concat()` can be replaced with '+' expression
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/transform/FlatteningTransformer.java`
#### Snippet
```java

    // tmp table name doesn't like dashes
    String tmpTable = TMP_TABLE.concat(UUID.randomUUID().toString().replace("-", "_"));
    LOG.info("Registering tmp table : " + tmpTable);
    rowDataset.createOrReplaceTempView(tmpTable);
```

### CallToStringConcatCanBeReplacedByOperator
Call to `concat()` can be replaced with '+' expression
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/transform/SqlFileBasedTransformer.java`
#### Snippet
```java
    final FileSystem fs = FSUtils.getFs(sqlFile, jsc.hadoopConfiguration(), true);
    // tmp table name doesn't like dashes
    final String tmpTable = TMP_TABLE.concat(UUID.randomUUID().toString().replace("-", "_"));
    LOG.info("Registering tmp table : " + tmpTable);
    rowDataset.createOrReplaceTempView(tmpTable);
```

## RuleId[ruleID=DuplicateThrows]
### DuplicateThrows
There is a more general exception, 'java.io.IOException', in the throws list already.
in `hudi-common/src/main/java/org/apache/hudi/common/fs/HoodieRetryWrapperFileSystem.java`
#### Snippet
```java

  @Override
  public FileStatus[] listStatus(Path f) throws FileNotFoundException, IOException {
    return new RetryHelper<FileStatus[], IOException>(maxRetryIntervalMs, maxRetryNumbers, initialRetryIntervalMs, retryExceptionsList).tryWith(() -> fileSystem.listStatus(f)).start();
  }
```

### DuplicateThrows
There is a more general exception, 'java.io.IOException', in the throws list already.
in `hudi-common/src/main/java/org/apache/hudi/common/fs/inline/InMemoryFileSystem.java`
#### Snippet
```java

  @Override
  public FileStatus[] listStatus(Path inlinePath) throws FileNotFoundException, IOException {
    throw new UnsupportedOperationException("No support for listStatus");
  }
```

## RuleId[ruleID=SynchronizeOnThis]
### SynchronizeOnThis
Lock operations on a class may have unforeseen side-effects
in `hudi-sync/hudi-adb-sync/src/main/java/org/apache/hudi/sync/adb/AdbSyncTool.java`
#### Snippet
```java
    if (config.getBoolean(ADB_SYNC_AUTO_CREATE_DATABASE)) {
      try {
        synchronized (AdbSyncTool.class) {
          if (!syncClient.databaseExists(databaseName)) {
            syncClient.createDatabase(databaseName);
```

### SynchronizeOnThis
Lock operations on a class may have unforeseen side-effects
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/index/hbase/SparkHoodieHBaseIndex.java`
#### Snippet
```java
      List<WriteStatus> writeStatusList = new ArrayList<>();
      // Grab the global HBase connection
      synchronized (SparkHoodieHBaseIndex.class) {
        if (hbaseConnection == null || hbaseConnection.isClosed()) {
          hbaseConnection = getHBaseConnection();
```

### SynchronizeOnThis
Lock operations on a class may have unforeseen side-effects
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/index/hbase/SparkHoodieHBaseIndex.java`
#### Snippet
```java
    }

    synchronized (SparkHoodieHBaseIndex.class) {
      if (hbaseConnection == null || hbaseConnection.isClosed()) {
        hbaseConnection = getHBaseConnection();
```

### SynchronizeOnThis
Lock operations on a class may have unforeseen side-effects
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/index/hbase/SparkHoodieHBaseIndex.java`
#### Snippet
```java
      RateLimiter limiter = RateLimiter.create(multiGetBatchSize * 10, TimeUnit.SECONDS);
      // Grab the global HBase connection
      synchronized (SparkHoodieHBaseIndex.class) {
        if (hbaseConnection == null || hbaseConnection.isClosed()) {
          hbaseConnection = getHBaseConnection();
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/keygen/BuiltinKeyGenerator.java`
#### Snippet
```java
  private void tryInitRowConverter(StructType structType) {
    if (rowConverter == null) {
      synchronized (this) {
        if (rowConverter == null) {
          rowConverter = new SparkRowConverter(structType);
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/keygen/BuiltinKeyGenerator.java`
#### Snippet
```java
  private UTF8StringPartitionPathFormatter getUTF8StringPartitionPathFormatter() {
    if (utf8StringPartitionPathFormatter == null) {
      synchronized (this) {
        if (utf8StringPartitionPathFormatter == null) {
          this.utf8StringPartitionPathFormatter = new UTF8StringPartitionPathFormatter(
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/keygen/BuiltinKeyGenerator.java`
#### Snippet
```java
  protected void tryInitRowAccessor(StructType schema) {
    if (this.rowAccessor == null) {
      synchronized (this) {
        if (this.rowAccessor == null) {
          this.rowAccessor = new SparkRowAccessor(schema);
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/keygen/BuiltinKeyGenerator.java`
#### Snippet
```java
  private StringPartitionPathFormatter getStringPartitionPathFormatter() {
    if (stringPartitionPathFormatter == null) {
      synchronized (this) {
        if (stringPartitionPathFormatter == null) {
          this.stringPartitionPathFormatter = new StringPartitionPathFormatter(
```

### SynchronizeOnThis
Lock operations on a class may have unforeseen side-effects
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/index/inmemory/HoodieInMemoryHashIndex.java`
#### Snippet
```java
  public HoodieInMemoryHashIndex(HoodieWriteConfig config) {
    super(config);
    synchronized (HoodieInMemoryHashIndex.class) {
      if (recordLocationMap == null) {
        recordLocationMap = new ConcurrentHashMap<>();
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `hudi-common/src/main/java/org/apache/hudi/util/Lazy.java`
#### Snippet
```java
  public T get() {
    if (!initialized) {
      synchronized (this) {
        if (!initialized) {
          this.ref = initializer.get();
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `hudi-common/src/main/java/org/apache/hudi/util/Transient.java`
#### Snippet
```java

  public void destroy(ThrowingConsumer<T> cleaner) throws Exception {
    synchronized (this) {
      if (initialized) {
        cleaner.accept(ref);
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `hudi-common/src/main/java/org/apache/hudi/util/Transient.java`
#### Snippet
```java

  public void reset() {
    synchronized (this) {
      this.ref = null;
      this.initialized = false;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `hudi-common/src/main/java/org/apache/hudi/util/Transient.java`
#### Snippet
```java
  public T get() {
    if (!initialized) {
      synchronized (this) {
        if (!initialized) {
          this.ref = initializer.get();
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `hudi-common/src/main/java/org/apache/hudi/io/storage/HoodieAvroHFileReader.java`
#### Snippet
```java
  public void close() {
    try {
      synchronized (this) {
        reader.close();
      }
```

### SynchronizeOnThis
Lock operations on a class may have unforeseen side-effects
in `hudi-common/src/main/java/org/apache/hudi/common/util/HoodieRecordUtils.java`
#### Snippet
```java
      HoodieRecordMerger recordMerger = (HoodieRecordMerger) INSTANCE_CACHE.get(mergerClass);
      if (null == recordMerger) {
        synchronized (HoodieRecordMerger.class) {
          recordMerger = (HoodieRecordMerger) INSTANCE_CACHE.get(mergerClass);
          if (null == recordMerger) {
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `hudi-common/src/main/java/org/apache/hudi/common/util/queue/DisruptorMessageQueue.java`
#### Snippet
```java
  @Override
  public void close() {
    synchronized (this) {
      if (!isShutdown) {
        isShutdown = true;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `hudi-common/src/main/java/org/apache/hudi/common/util/queue/DisruptorMessageQueue.java`
#### Snippet
```java

  protected void start() {
    synchronized (this) {
      if (!isStarted) {
        queue.start();
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/RocksDbDiskMap.java`
#### Snippet
```java
  private RocksDBDAO getRocksDb() {
    if (null == rocksDb) {
      synchronized (this) {
        if (null == rocksDb) {
          rocksDb = new RocksDBDAO(ROCKSDB_COL_FAMILY, diskMapPath);
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/ExternalSpillableMap.java`
#### Snippet
```java
  private DiskMap<T, R> getDiskBasedMap() {
    if (null == diskBasedMap) {
      synchronized (this) {
        if (null == diskBasedMap) {
          try {
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/AbstractHoodieLogRecordReader.java`
#### Snippet
```java
   */
  protected final void scanInternal(Option<KeySpec> keySpecOpt, boolean skipProcessingBlocks) {
    synchronized (this) {
      if (enableOptimizedLogBlocksScan) {
        scanInternalV2(keySpecOpt, skipProcessingBlocks);
```

### SynchronizeOnThis
Lock operations on a class may have unforeseen side-effects
in `hudi-common/src/main/java/org/apache/hudi/common/metrics/Registry.java`
#### Snippet
```java
   */
  static Map<String, Long> getAllMetrics(boolean flush, boolean prefixWithRegistryName) {
    synchronized (Registry.class) {
      HashMap<String, Long> allMetrics = new HashMap<>();
      REGISTRY_MAP.forEach((registryName, registry) -> {
```

### SynchronizeOnThis
Lock operations on a class may have unforeseen side-effects
in `hudi-common/src/main/java/org/apache/hudi/common/metrics/Registry.java`
#### Snippet
```java
   */
  static Registry getRegistry(String registryName, String clazz) {
    synchronized (Registry.class) {
      if (!REGISTRY_MAP.containsKey(registryName)) {
        Registry registry = (Registry)ReflectionUtils.loadClass(clazz, registryName);
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `hudi-common/src/main/java/org/apache/hudi/common/bootstrap/index/HFileBootstrapIndex.java`
#### Snippet
```java

    private void initIndexInfo() {
      synchronized (this) {
        if (null == bootstrapIndexInfo) {
          try {
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `hudi-common/src/main/java/org/apache/hudi/common/bootstrap/index/HFileBootstrapIndex.java`
#### Snippet
```java
    private HFile.Reader fileIdIndexReader() {
      if (null == indexByFileIdReader) {
        synchronized (this) {
          if (null == indexByFileIdReader) {
            LOG.info("Opening fileId index :" + indexByFileIdPath);
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `hudi-common/src/main/java/org/apache/hudi/common/bootstrap/index/HFileBootstrapIndex.java`
#### Snippet
```java
    private HFile.Reader partitionIndexReader() {
      if (null == indexByPartitionReader) {
        synchronized (this) {
          if (null == indexByPartitionReader) {
            LOG.info("Opening partition index :" + indexByPartitionPath);
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieMetadataLogRecordReader.java`
#### Snippet
```java
    // NOTE: Locking is necessary since we're accessing [[HoodieMetadataLogRecordReader]]
    //       materialized state, to make sure there's no concurrent access
    synchronized (this) {
      logRecordScanner.scan();
      return logRecordScanner.getRecords().values()
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieMetadataLogRecordReader.java`
#### Snippet
```java
    // NOTE: Locking is necessary since we're accessing [[HoodieMetadataLogRecordReader]]
    //       materialized state, to make sure there's no concurrent access
    synchronized (this) {
      logRecordScanner.scanByFullKeys(keys);
      Map<String, HoodieRecord> allRecords = logRecordScanner.getRecords();
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieMetadataLogRecordReader.java`
#### Snippet
```java
    // NOTE: Locking is necessary since we're accessing [[HoodieMetadataLogRecordReader]]
    //       materialized state, to make sure there's no concurrent access
    synchronized (this) {
      logRecordScanner.scanByKeyPrefixes(keyPrefixes);
      Map<String, HoodieRecord> allRecords = logRecordScanner.getRecords();
```

### SynchronizeOnThis
Lock operations on a class may have unforeseen side-effects
in `hudi-common/src/main/java/org/apache/hudi/secondary/index/SecondaryIndexManager.java`
#### Snippet
```java
  public static SecondaryIndexManager getInstance() {
    if (_instance == null) {
      synchronized (SecondaryIndexManager.class) {
        if (_instance == null) {
          _instance = new SecondaryIndexManager();
```

### SynchronizeOnThis
Lock operations on a class may have unforeseen side-effects
in `hudi-examples/hudi-examples-flink/src/main/java/org/apache/hudi/examples/quickstart/factory/CollectSinkTableFactory.java`
#### Snippet
```java
      }
      this.taskID = getRuntimeContext().getIndexOfThisSubtask();
      synchronized (CollectSinkTableFactory.class) {
        RESULT.put(taskID, localResult);
      }
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `hudi-common/src/main/java/org/apache/hudi/common/table/TableSchemaResolver.java`
#### Snippet
```java
        HoodieInstant instant = instantAndCommitMetadata.get().getLeft();
        HoodieCommitMetadata metadata = instantAndCommitMetadata.get().getRight();
        synchronized (this) {
          if (latestCommitWithValidData == null) {
            latestCommitWithValidData = instant;
```

### SynchronizeOnThis
Lock operations on 'this' may have unforeseen side-effects
in `hudi-common/src/main/java/org/apache/hudi/common/table/TableSchemaResolver.java`
#### Snippet
```java
        HoodieInstant instant = instantAndCommitMetadata.get().getLeft();
        HoodieCommitMetadata metadata = instantAndCommitMetadata.get().getRight();
        synchronized (this) {
          if (latestCommitWithValidSchema == null) {
            latestCommitWithValidSchema = instant;
```

## RuleId[ruleID=DoubleBraceInitialization]
### DoubleBraceInitialization
Double brace initialization
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/util/PartitionFilterGenerator.java`
#### Snippet
```java
public class PartitionFilterGenerator {

  private static final Set<String> SUPPORT_TYPES = new HashSet<String>() {
    {
      add(HiveSchemaUtil.INT_TYPE_NAME);
```

### DoubleBraceInitialization
Double brace initialization
in `hudi-common/src/main/java/org/apache/hudi/avro/MercifulJsonConverter.java`
#### Snippet
```java
   */
  private static Map<Schema.Type, JsonToAvroFieldProcessor> getFieldTypeProcessors() {
    return Collections.unmodifiableMap(new HashMap<Schema.Type, JsonToAvroFieldProcessor>() {
      {
        put(Type.STRING, generateStringTypeHandler());
```

### DoubleBraceInitialization
Double brace initialization
in `hudi-common/src/main/java/org/apache/hudi/common/table/timeline/HoodieActiveTimeline.java`
#### Snippet
```java
      REQUESTED_SAVE_SCHEMA_ACTION_EXTENSION, INFLIGHT_SAVE_SCHEMA_ACTION_EXTENSION, SAVE_SCHEMA_ACTION_EXTENSION));

  private static final Set<String> NOT_PARSABLE_TIMESTAMPS = new HashSet<String>(3) {{
      add(HoodieTimeline.INIT_INSTANT_TS);
      add(HoodieTimeline.METADATA_BOOTSTRAP_INSTANT_TS);
```

## RuleId[ruleID=CastConflictsWithInstanceof]
### CastConflictsWithInstanceof
Cast to 'Timestamp' type conflicts with preceding 'instanceof Message' check
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/helpers/ProtoConversionUtil.java`
#### Snippet
```java
            // check if this is a Timestamp
            if (LogicalTypes.timestampMicros().equals(schema.getLogicalType())) {
              return Timestamps.toMicros((Timestamp) value);
            } else {
              tmpValue = getWrappedValue(value);
```

## RuleId[ruleID=UnusedAssignment]
### UnusedAssignment
The value changed at `idx++` is never used
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/FileSystemViewCommand.java`
#### Snippet
```java
        row[idx++] = fs.getLogFiles().filter(lf -> lf.getBaseCommitTime().equals(fs.getBaseInstantTime()))
            .collect(Collectors.toList()).toString();
        row[idx++] = fs.getLogFiles().filter(lf -> !lf.getBaseCommitTime().equals(fs.getBaseInstantTime()))
            .collect(Collectors.toList()).toString();
      }
```

### UnusedAssignment
The value changed at `idx++` is never used
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/FileSystemViewCommand.java`
#### Snippet
```java
        row[idx++] = fs.getLogFiles().count();
        row[idx++] = fs.getLogFiles().mapToLong(HoodieLogFile::getFileSize).sum();
        row[idx++] = fs.getLogFiles().collect(Collectors.toList()).toString();
      }
      rows.add(row);
```

### UnusedAssignment
Variable `data` initializer `null` is redundant
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/ExportCommand.java`
#### Snippet
```java
      String localPath = localFolder + Path.SEPARATOR + instant.getFileName();

      byte[] data = null;
      switch (instant.getAction()) {
        case HoodieTimeline.CLEAN_ACTION: {
```

### UnusedAssignment
Variable `metadata` initializer `null` is redundant
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/ExportCommand.java`
#### Snippet
```java
            }

            GenericRecord metadata = null;
            switch (action) {
              case HoodieTimeline.CLEAN_ACTION:
```

### UnusedAssignment
Variable `numCopied` initializer `0` is redundant
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/ExportCommand.java`
#### Snippet
```java
    final Set<String> actionSet = new HashSet<String>(Arrays.asList(filter.split(",")));
    int numExports = limit == -1 ? Integer.MAX_VALUE : limit;
    int numCopied = 0;

    if (!new File(localFolder).isDirectory()) {
```

### UnusedAssignment
Variable `result` initializer `null` is redundant
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/table/action/commit/JavaDeleteHelper.java`
#### Snippet
```java
                                                        BaseCommitActionExecutor<EmptyHoodieRecordPayload, List<HoodieRecord<EmptyHoodieRecordPayload>>, List<HoodieKey>, List<WriteStatus>, R> deleteExecutor) {
    try {
      HoodieWriteMetadata<List<WriteStatus>> result = null;
      List<HoodieKey> dedupedKeys = keys;
      final int parallelism = config.getDeleteShuffleParallelism();
```

### UnusedAssignment
Variable `result` initializer `null` is redundant
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/table/action/commit/FlinkDeleteHelper.java`
#### Snippet
```java
                                                        BaseCommitActionExecutor<EmptyHoodieRecordPayload, List<HoodieRecord<EmptyHoodieRecordPayload>>, List<HoodieKey>, List<WriteStatus>, R> deleteExecutor) {
    try {
      HoodieWriteMetadata<List<WriteStatus>> result = null;
      List<HoodieKey> dedupedKeys = keys;
      final int parallelism = config.getDeleteShuffleParallelism();
```

### UnusedAssignment
Variable `orcReader` initializer `null` is redundant
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/bootstrap/HoodieSparkBootstrapSchemaProvider.java`
#### Snippet
```java

  private static Schema getBootstrapSourceSchemaOrc(HoodieWriteConfig writeConfig, HoodieEngineContext context, Path filePath) {
    Reader orcReader = null;
    try {
      orcReader = OrcFile.createReader(filePath, OrcFile.readerOptions(context.getHadoopConf().get()));
```

### UnusedAssignment
Variable `preserveMetadata` initializer `false` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/io/CreateHandleFactory.java`
#### Snippet
```java
public class CreateHandleFactory<T, I, K, O> extends WriteHandleFactory<T, I, K, O> implements Serializable {

  private boolean preserveMetadata = false;

  public CreateHandleFactory() {
```

### UnusedAssignment
Variable `hoodieKeyList` initializer `new ArrayList<>()` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/io/HoodieKeyLocationFetchHandle.java`
#### Snippet
```java
    HoodieBaseFile baseFile = partitionPathBaseFilePair.getRight();
    BaseFileUtils baseFileUtils = BaseFileUtils.getInstance(baseFile.getPath());
    List<HoodieKey> hoodieKeyList = new ArrayList<>();
    if (keyGeneratorOpt.isPresent()) {
      hoodieKeyList = baseFileUtils.fetchHoodieKeys(hoodieTable.getHadoopConf(), new Path(baseFile.getPath()), keyGeneratorOpt);
```

### UnusedAssignment
Variable `bloomFilter` initializer `null` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/io/HoodieKeyLookupHandle.java`
#### Snippet
```java

  private BloomFilter getBloomFilter() {
    BloomFilter bloomFilter = null;
    HoodieTimer timer = HoodieTimer.start();
    try {
```

### UnusedAssignment
Variable `oldNumWrites` initializer `0` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/io/HoodieMergeHandle.java`
#### Snippet
```java
    }

    long oldNumWrites = 0;
    try (HoodieFileReader reader = HoodieFileReaderFactory.getReaderFactory(this.config.getRecordMerger().getRecordType()).getFileReader(hoodieTable.getHadoopConf(), oldFilePath)) {
      oldNumWrites = reader.getTotalRecords();
```

### UnusedAssignment
Variable `finalIndexPartitionInfos` initializer `null` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/index/RunIndexActionExecutor.java`
#### Snippet
```java
      // transition requested indexInstant to inflight
      table.getActiveTimeline().transitionIndexRequestedToInflight(indexInstant, Option.empty());
      List<HoodieIndexPartitionInfo> finalIndexPartitionInfos = null;
      if (!firstTimeInitializingMetadataTable) {
        // start indexing for each partition
```

### UnusedAssignment
Variable `totalIO` initializer `0` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/utils/FileSliceMetricUtils.java`
#### Snippet
```java
    long totalIORead = 0;
    long totalIOWrite = 0;
    long totalIO = 0;

    for (FileSlice slice : fileSlices) {
```

### UnusedAssignment
Variable `plan` initializer `null` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/HoodieTimelineArchiver.java`
#### Snippet
```java
      // we need to revert or complete last action.
      if (fs.exists(planPath)) {
        HoodieMergeArchiveFilePlan plan = null;
        try {
          plan = TimelineMetadataUtils.deserializeAvroMetadata(FileIOUtils.readDataFromPath(fs, planPath).get(), HoodieMergeArchiveFilePlan.class);
```

### UnusedAssignment
Variable `instants` initializer `null` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/HoodieTimelineArchiver.java`
#### Snippet
```java
   */
  private boolean deleteAllInstantsOlderOrEqualsInAuxMetaFolder(HoodieInstant thresholdInstant) throws IOException {
    List<HoodieInstant> instants = null;
    boolean success = true;
    try {
```

### UnusedAssignment
Variable `code` initializer `-1` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/util/PartitionPathEncodeUtils.java`
#### Snippet
```java
      char c = path.charAt(i);
      if (c == '%' && i + 2 < path.length()) {
        int code = -1;
        try {
          code = Integer.parseInt(path.substring(i + 1, i + 3), 16);
```

### UnusedAssignment
Variable `lines` initializer `new ArrayList<>()` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/util/FileIOUtils.java`
#### Snippet
```java
   */
  public static List<String> readAsUTFStringLines(InputStream input) {
    List<String> lines = new ArrayList<>();
    BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(input, StandardCharsets.UTF_8));
    lines = bufferedReader.lines().collect(Collectors.toList());
```

### UnusedAssignment
Variable `result` initializer `new HashMap<>()` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/fs/FSUtils.java`
#### Snippet
```java
      HoodieEngineContext hoodieEngineContext, FileSystem fs, Path dirPath, int parallelism,
      Predicate<FileStatus> subPathPredicate, SerializableFunction<Pair<String, SerializableConfiguration>, T> pairFunction) {
    Map<String, T> result = new HashMap<>();
    try {
      FileStatus[] fileStatuses = fs.listStatus(dirPath);
```

### UnusedAssignment
Variable `bigDecimal` initializer `null` is redundant
in `hudi-common/src/main/java/org/apache/hudi/avro/HoodieAvroUtils.java`
#### Snippet
```java
                  || oldSchema.getType() == Schema.Type.FLOAT) {
            LogicalTypes.Decimal decimal = (LogicalTypes.Decimal) newSchema.getLogicalType();
            BigDecimal bigDecimal = null;
            if (oldSchema.getType() == Schema.Type.STRING) {
              bigDecimal = new java.math.BigDecimal(oldValue.toString())
```

### UnusedAssignment
Variable `bytes` initializer `null` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/util/AvroOrcUtils.java`
#### Snippet
```java
      case STRING:
        BytesColumnVector bytesColVec = (BytesColumnVector) colVector;
        byte[] bytes = null;

        if (value instanceof String) {
```

### UnusedAssignment
Variable `functionResult` initializer `null` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/util/RetryHelper.java`
#### Snippet
```java
  public T start(CheckedFunction<T, R> func) throws R {
    int retries = 0;
    T functionResult = null;

    while (true) {
```

### UnusedAssignment
Variable `content` initializer `Option.empty()` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/util/MarkerUtils.java`
#### Snippet
```java
    Path markerTypeFilePath = new Path(markerDir, MARKER_TYPE_FILENAME);
    FSDataInputStream fsDataInputStream = null;
    Option<MarkerType> content = Option.empty();
    try {
      if (!doesMarkerTypeFileExist(fileSystem, markerDir)) {
```

### UnusedAssignment
Variable `internalSchema` initializer `InternalSchema.getEmptyInternalSchema()` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/HoodieLogFormatReader.java`
#### Snippet
```java
  private final FileSystem fs;
  private final Schema readerSchema;
  private InternalSchema internalSchema = InternalSchema.getEmptyInternalSchema();
  private final boolean readBlocksLazily;
  private final boolean reverseLogReader;
```

### UnusedAssignment
Variable `useColNameFromFileSchema` initializer `true` is redundant
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/action/InternalSchemaMerger.java`
#### Snippet
```java
  // eg: current column name is colOldName, now we rename it to colNewName,
  // we can pass colNewName to reWriteRecordWithNewSchema directly, everything is ok.
  private boolean useColNameFromFileSchema = true;

  public InternalSchemaMerger(InternalSchema fileSchema, InternalSchema querySchema, boolean ignoreRequiredAttribute, boolean useColumnTypeFromFileSchema, boolean useColNameFromFileSchema) {
```

### UnusedAssignment
Variable `useColumnTypeFromFileSchema` initializer `true` is redundant
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/action/InternalSchemaMerger.java`
#### Snippet
```java
  // eg: current column type is StringType, now we changed it to decimalType,
  // we can pass decimalType to reWriteRecordWithNewSchema directly, everything is ok.
  private boolean useColumnTypeFromFileSchema = true;

  // deal with rename
```

### UnusedAssignment
Variable `commitsToRollback` initializer `null` is redundant
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieBackedTableMetadata.java`
#### Snippet
```java
  private List<String> getRollbackedCommits(HoodieInstant instant, HoodieActiveTimeline timeline) {
    try {
      List<String> commitsToRollback = null;
      if (instant.getAction().equals(HoodieTimeline.ROLLBACK_ACTION)) {
        try {
```

### UnusedAssignment
Variable `supportPayload` initializer `true` is redundant
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/realtime/AbstractRealtimeRecordReader.java`
#### Snippet
```java
  protected SchemaEvolutionContext schemaEvolutionContext;
  // support merge operation
  protected boolean supportPayload = true;
  // handle hive type to avro record
  protected HiveAvroSerializer serializer;
```

### UnusedAssignment
Variable `source` initializer `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/HoodieIncrSource.java`
#### Snippet
```java
    }

    Dataset<Row> source = null;
    // Do Incr pull. Set end instant if available
    if (queryTypeAndInstantEndpts.getKey().equals(DataSourceReadOptions.QUERY_TYPE_INCREMENTAL_OPT_VAL())) {
```

### UnusedAssignment
Variable `sparkOptionsMap` initializer `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/S3EventsHoodieIncrSource.java`
#### Snippet
```java
    if (!StringUtils.isNullOrEmpty(props.getString(Config.SPARK_DATASOURCE_OPTIONS, null))) {
      final ObjectMapper mapper = new ObjectMapper();
      Map<String, String> sparkOptionsMap = null;
      try {
        sparkOptionsMap = mapper.readValue(props.getString(Config.SPARK_DATASOURCE_OPTIONS), Map.class);
```

### UnusedAssignment
Variable `source` initializer `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/S3EventsHoodieIncrSource.java`
#### Snippet
```java
    }

    Dataset<Row> source = null;
    // Do incremental pull. Set end instant if available.
    if (queryTypeAndInstantEndpts.getKey().equals(DataSourceReadOptions.QUERY_TYPE_INCREMENTAL_OPT_VAL())) {
```

### UnusedAssignment
Variable `sparkOptionsMap` initializer `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/helpers/IncrSourceCloudStorageHelper.java`
#### Snippet
```java

    final ObjectMapper mapper = new ObjectMapper();
    Map<String, String> sparkOptionsMap = null;

    try {
```

### UnusedAssignment
Variable `jssc` initializer `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/HoodieDeltaStreamer.java`
#### Snippet
```java
    final Config cfg = getConfig(args);
    Map<String, String> additionalSparkConfigs = SchedulerConfGenerator.getSparkSchedulingConfigs(cfg);
    JavaSparkContext jssc = null;
    if (StringUtils.isNullOrEmpty(cfg.sparkMaster)) {
      jssc = UtilHelpers.buildSparkContext("delta-streamer-" + cfg.targetTableName, additionalSparkConfigs);
```

### UnusedAssignment
Variable `catalogTable` initializer `null` is redundant
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/util/HoodiePipeline.java`
#### Snippet
```java
      tableEnv.executeSql(sql);
      String currentCatalog = tableEnv.getCurrentCatalog();
      ResolvedCatalogTable catalogTable = null;
      String defaultDatabase = null;
      try {
```

### UnusedAssignment
Variable `defaultDatabase` initializer `null` is redundant
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/util/HoodiePipeline.java`
#### Snippet
```java
      String currentCatalog = tableEnv.getCurrentCatalog();
      ResolvedCatalogTable catalogTable = null;
      String defaultDatabase = null;
      try {
        Catalog catalog = tableEnv.getCatalog(currentCatalog).get();
```

### UnusedAssignment
Variable `curAvroRecord` initializer `null` is redundant
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/mor/MergeOnReadInputFormat.java`
#### Snippet
```java
        while (logRecordsKeyIterator.hasNext()) {
          String curAvroKey = logRecordsKeyIterator.next();
          Option<IndexedRecord> curAvroRecord = null;
          final HoodieAvroRecord<?> hoodieRecord = (HoodieAvroRecord) scanner.getRecords().get(curAvroKey);
          try {
```

### UnusedAssignment
Variable `curAvroRecord` initializer `null` is redundant
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/mor/MergeOnReadInputFormat.java`
#### Snippet
```java
      public boolean hasNext() {
        while (recordsIterator.hasNext()) {
          Option<IndexedRecord> curAvroRecord = null;
          final HoodieAvroRecord<?> hoodieRecord = (HoodieAvroRecord) recordsIterator.next();
          try {
```

### UnusedAssignment
Variable `curAvroRecord` initializer `null` is redundant
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/mor/MergeOnReadInputFormat.java`
#### Snippet
```java
        while (logRecordsKeyIterator.hasNext()) {
          String curAvroKey = logRecordsKeyIterator.next();
          Option<IndexedRecord> curAvroRecord = null;
          final HoodieAvroRecord<?> hoodieRecord = (HoodieAvroRecord) scanner.getRecords().get(curAvroKey);
          try {
```

### UnusedAssignment
Variable `dataGen` initializer `null` is redundant
in `hudi-spark-datasource/hudi-spark/src/test/java/HoodieJavaApp.java`
#### Snippet
```java

    // Generator of some records to be loaded in.
    HoodieTestDataGenerator dataGen = null;
    if (nonPartitionedTable) {
      // All data goes to base-path
```

### UnusedAssignment
Variable `numInitialCommits` initializer `0` is redundant
in `hudi-spark-datasource/hudi-spark/src/test/java/HoodieJavaStreamingApp.java`
#### Snippet
```java
    // start streaming and showing
    ExecutorService executor = Executors.newFixedThreadPool(2);
    int numInitialCommits = 0;

    // thread for spark structured streaming
```

## RuleId[ruleID=ReplaceInefficientStreamCount]
### ReplaceInefficientStreamCount
Can be replaced with 'stream.anyMatch()'
in `hudi-cli/src/main/java/org/apache/hudi/cli/utils/SparkTempViewProvider.java`
#### Snippet
```java
      }

      if (rows.stream().filter(row -> row.size() != headers.size()).count() > 0) {
        throw new HoodieException("Invalid row, does not match headers " + headers.size() + " " + rows.size());
      }
```

### ReplaceInefficientStreamCount
Can be replaced with '!stream.findAny().isPresent()'
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/table/action/deltacommit/SparkUpsertDeltaCommitPartitioner.java`
#### Snippet
```java
                  // NOTE: We can not pad slices with existing log-files w/o compacting these,
                  //       hence skipping
                  fileSlice.getLogFiles().count() < 1
                  && fileSlice.getBaseFile().get().getFileSize() < config.getParquetSmallFileLimit())
          .sorted(Comparator.comparing(fileSlice -> fileSlice.getBaseFile().get().getFileSize()))
```

### ReplaceInefficientStreamCount
Can be replaced with 'stream.findAny().isPresent()'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/compact/plan/generators/BaseHoodieCompactionPlanGenerator.java`
#### Snippet
```java

  protected boolean filterFileSlice(FileSlice fileSlice, String lastCompletedInstantTime, Set<HoodieFileGroupId> pendingFileGroupIds) {
    return fileSlice.getLogFiles().count() > 0 && !pendingFileGroupIds.contains(fileSlice.getFileGroupId());
  }

```

### ReplaceInefficientStreamCount
Can be replaced with 'stream.findAny().isPresent()'
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/RocksDbBasedFileSystemView.java`
#### Snippet
```java
                    // Add remaining log files back
                    logFiles.values().forEach(newFileSlice::addLogFile);
                    if (newFileSlice.getBaseFile().isPresent() || (newFileSlice.getLogFiles().count() > 0)) {
                      LOG.info("Adding back new file-slice after remove FS=" + newFileSlice);
                      return newFileSlice;
```

## RuleId[ruleID=UnnecessarySemicolon]
### UnnecessarySemicolon
Unnecessary semicolon `;`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metrics/datadog/DatadogReporter.java`
#### Snippet
```java

  enum MetricType {
    gauge;
  }
}
```

### UnnecessarySemicolon
Unnecessary semicolon `;`
in `hudi-common/src/main/java/org/apache/hudi/avro/AvroSchemaCompatibility.java`
#### Snippet
```java

    /** Used internally to tag a reader/writer schema pair and prevent recursion. */
    RECURSION_IN_PROGRESS;
  }

```

### UnnecessarySemicolon
Unnecessary semicolon `;`
in `hudi-common/src/main/java/org/apache/hudi/avro/AvroSchemaCompatibility.java`
#### Snippet
```java
  public enum SchemaIncompatibilityType {
    NAME_MISMATCH, FIXED_SIZE_MISMATCH, MISSING_ENUM_SYMBOLS, READER_FIELD_MISSING_DEFAULT_VALUE, TYPE_MISMATCH,
    MISSING_UNION_BRANCH;
  }

```

### UnnecessarySemicolon
Unnecessary semicolon `;`
in `hudi-common/src/main/java/org/apache/hudi/common/util/OrcUtils.java`
#### Snippet
```java
  public Set<String> filterRowKeys(Configuration conf, Path filePath, Set<String> filter)
      throws HoodieIOException {
    try (Reader reader = OrcFile.createReader(filePath, OrcFile.readerOptions(conf));) {
      TypeDescription schema = reader.getSchema();
      try (RecordReader recordReader = reader.rows(new Options(conf).schema(schema))) {
```

### UnnecessarySemicolon
Unnecessary semicolon `;`
in `hudi-common/src/main/java/org/apache/hudi/common/table/cdc/HoodieCDCInferenceCase.java`
#### Snippet
```java
  BASE_FILE_DELETE,
  LOG_FILE,
  REPLACE_COMMIT;

}
```

### UnnecessarySemicolon
Unnecessary semicolon `;`
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/helpers/gcs/MessageValidity.java`
#### Snippet
```java
  public enum ProcessingDecision {
    DO_PROCESS,
    DO_SKIP;
  }
}
```

## RuleId[ruleID=SimplifyStreamApiCallChains]
### SimplifyStreamApiCallChains
''stream().forEach()'' can be replaced with 'forEach()'' (may change semantics)
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/ddl/JDBCExecutor.java`
#### Snippet
```java
    LOG.info("Adding partitions " + partitionsToDrop.size() + " to table " + tableName);
    List<String> sqls = constructDropPartitions(tableName, partitionsToDrop);
    sqls.stream().forEach(sql -> runSQL(sql));
  }

```

### SimplifyStreamApiCallChains
''stream().forEach()'' can be replaced with 'forEach()'' (may change semantics)
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/ddl/QueryBasedDDLExecutor.java`
#### Snippet
```java
    LOG.info("Adding partitions " + partitionsToAdd.size() + " to table " + tableName);
    List<String> sqls = constructAddPartitions(tableName, partitionsToAdd);
    sqls.stream().forEach(sql -> runSQL(sql));
  }

```

### SimplifyStreamApiCallChains
''stream().forEach()'' can be replaced with 'forEach()'' (may change semantics)
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/client/common/HoodieJavaEngineContext.java`
#### Snippet
```java
  @Override
  public <I> void foreach(List<I> data, SerializableConsumer<I> consumer, int parallelism) {
    data.stream().forEach(throwingForeachWrapper(consumer));
  }

```

### SimplifyStreamApiCallChains
'Collections.singletonList().stream()' can be replaced with 'Stream.of()'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/index/RunIndexActionExecutor.java`
#### Snippet
```java
        String indexUptoInstant = fileIndexPartitionInfo.getIndexUptoInstant();
        // save index commit metadata and update table config
        finalIndexPartitionInfos = Collections.singletonList(fileIndexPartitionInfo).stream()
            .map(info -> new HoodieIndexPartitionInfo(
                info.getVersion(),
```

### SimplifyStreamApiCallChains
'Collections.singletonList().stream()' can be replaced with 'Stream.of()'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/rollback/BaseRollbackHelper.java`
#### Snippet
```java
                    .withRollbackBlockAppendResults(filesToNumBlocksRollback)
                    .build()))
            .stream();
      } else {
        return Collections.singletonList(
```

### SimplifyStreamApiCallChains
'Collections.singletonList().stream()' can be replaced with 'Stream.of()'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/rollback/BaseRollbackHelper.java`
#### Snippet
```java
                    .withPartitionPath(rollbackRequest.getPartitionPath())
                    .build()))
            .stream();
      }
    }, numPartitions);
```

### SimplifyStreamApiCallChains
Can be replaced with 'String.join'
in `hudi-common/src/main/java/org/apache/hudi/avro/HoodieAvroUtils.java`
#### Snippet
```java
      List<String> parentNames = new ArrayList<>();
      fieldNames.descendingIterator().forEachRemaining(parentNames::add);
      result = parentNames.stream().collect(Collectors.joining("."));
    }
    return result;
```

### SimplifyStreamApiCallChains
''stream().forEach()'' can be replaced with 'forEach()'' (may change semantics)
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/IncrementalTimelineSyncFileSystemView.java`
#### Snippet
```java
        HoodieReplaceCommitMetadata.fromBytes(timeline.getInstantDetails(instant).get(), HoodieReplaceCommitMetadata.class);
    updatePartitionWriteFileGroups(replaceMetadata.getPartitionToWriteStats(), timeline, instant);
    replaceMetadata.getPartitionToReplaceFileIds().entrySet().stream().forEach(entry -> {
      String partition = entry.getKey();
      Map<HoodieFileGroupId, HoodieInstant> replacedFileIds = entry.getValue().stream()
```

### SimplifyStreamApiCallChains
''stream().forEach()'' can be replaced with 'forEach()'' (may change semantics)
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/IncrementalTimelineSyncFileSystemView.java`
#### Snippet
```java
          }));
        }).collect(Collectors.groupingBy(Pair::getKey));
    partitionFiles.entrySet().stream().forEach(e -> {
      removeFileSlicesForPartition(timeline, instant, e.getKey(),
          e.getValue().stream().map(x -> x.getValue()).collect(Collectors.toList()));
```

### SimplifyStreamApiCallChains
''stream().forEach()'' can be replaced with 'forEach()'' (may change semantics)
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/IncrementalTimelineSyncFileSystemView.java`
#### Snippet
```java
        break;
      case REMOVE:
        deltaDataFiles.keySet().stream().forEach(p -> viewDataFiles.remove(p));
        deltaLogFiles.keySet().stream().forEach(p -> viewLogFiles.remove(p));
        break;
```

### SimplifyStreamApiCallChains
''stream().forEach()'' can be replaced with 'forEach()'' (may change semantics)
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/IncrementalTimelineSyncFileSystemView.java`
#### Snippet
```java
      case REMOVE:
        deltaDataFiles.keySet().stream().forEach(p -> viewDataFiles.remove(p));
        deltaLogFiles.keySet().stream().forEach(p -> viewLogFiles.remove(p));
        break;
      default:
```

### SimplifyStreamApiCallChains
''stream().forEach()'' can be replaced with 'forEach()'' (may change semantics)
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/IncrementalTimelineSyncFileSystemView.java`
#### Snippet
```java
                                              HoodieTimeline timeline,
                                              HoodieInstant instant) {
    partitionToWriteStats.entrySet().stream().forEach(entry -> {
      String partition = entry.getKey();
      if (isPartitionAvailableInStore(partition)) {
```

### SimplifyStreamApiCallChains
''stream().forEach()'' can be replaced with 'forEach()'' (may change semantics)
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/IncrementalTimelineSyncFileSystemView.java`
#### Snippet
```java

    // First remove pending compaction instants which were completed
    diffResult.getFinishedCompactionInstants().stream().forEach(instant -> {
      try {
        removePendingCompactionInstant(timeline, instant);
```

### SimplifyStreamApiCallChains
''stream().forEach()'' can be replaced with 'forEach()'' (may change semantics)
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/IncrementalTimelineSyncFileSystemView.java`
#### Snippet
```java

    // Now remove pending log compaction instants which were completed or removed
    diffResult.getFinishedOrRemovedLogCompactionInstants().stream().forEach(instant -> {
      try {
        removePendingLogCompactionInstant(timeline, instant);
```

### SimplifyStreamApiCallChains
''stream().forEach()'' can be replaced with 'forEach()'' (may change semantics)
in `hudi-common/src/main/java/org/apache/hudi/common/table/timeline/dto/FileSliceDTO.java`
#### Snippet
```java
    FileSlice slice = new FileSlice(dto.partitionPath, dto.baseInstantTime, dto.fileId);
    slice.setBaseFile(BaseFileDTO.toHoodieBaseFile(dto.baseFile));
    dto.logFiles.stream().forEach(lf -> slice.addLogFile(LogFileDTO.toHoodieLogFile(lf)));
    return slice;
  }
```

### SimplifyStreamApiCallChains
''stream().forEach()'' can be replaced with 'forEach()'' (may change semantics)
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/RocksDbBasedFileSystemView.java`
#### Snippet
```java
    Map<String, List<Map.Entry<HoodieFileGroupId, HoodieInstant>>> partitionToReplacedFileGroups =
        replacedFileGroups.entrySet().stream().collect(Collectors.groupingBy(e -> e.getKey().getPartitionPath()));
    partitionToReplacedFileGroups.entrySet().stream().forEach(partitionToReplacedFileGroupsEntry -> {
      String partitionPath = partitionToReplacedFileGroupsEntry.getKey();
      List<Map.Entry<HoodieFileGroupId, HoodieInstant>> replacedFileGroupsInPartition = partitionToReplacedFileGroupsEntry.getValue();
```

### SimplifyStreamApiCallChains
''stream().forEach()'' can be replaced with 'forEach()'' (may change semantics)
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/RocksDbBasedFileSystemView.java`
#### Snippet
```java
      // Now add them
      rocksDB.writeBatch(batch ->
          replacedFileGroupsInPartition.stream().forEach(fgToReplacedInstant -> {
            rocksDB.putInBatch(batch, schemaHelper.getColFamilyForReplacedFileGroups(),
                schemaHelper.getKeyForReplacedFileGroup(fgToReplacedInstant.getKey()), fgToReplacedInstant.getValue());
```

### SimplifyStreamApiCallChains
''stream().forEach()'' can be replaced with 'forEach()'' (may change semantics)
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/utils/AvroSchemaEvolutionUtils.java`
#### Snippet
```java

    TableChanges.ColumnAddChange addChange = TableChanges.ColumnAddChange.get(oldTableSchema);
    finalAddAction.entrySet().stream().forEach(f -> {
      String name = f.getValue();
      int splitPoint = name.lastIndexOf(".");
```

### SimplifyStreamApiCallChains
Can be replaced with 'min()'
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/utils/AvroSchemaEvolutionUtils.java`
#### Snippet
```java
                  && c.startsWith(parentName)
                  && inComingInternalSchema.findIdByName(c) >  inComingInternalSchema.findIdByName(name)
                  && oldTableSchema.findIdByName(c) > 0).sorted((s1, s2) -> oldTableSchema.findIdByName(s1) - oldTableSchema.findIdByName(s2)).findFirst();
      addChange.addColumns(parentName, rawName, inComingInternalSchema.findType(name), null);
      inferPosition.map(i -> addChange.addPositionChange(name, i, "before"));
```

### SimplifyStreamApiCallChains
Can be replaced with 'String.join'
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/utils/InternalSchemaUtils.java`
#### Snippet
```java
      List<String> parentNames = new ArrayList<>();
      fieldNames.descendingIterator().forEachRemaining(parentNames::add);
      result = parentNames.stream().collect(Collectors.joining(".")) + "." + result;
    }
    return result;
```

### SimplifyStreamApiCallChains
''stream().forEach()'' can be replaced with 'forEach()'' (may change semantics)
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/utils/InternalSchemaUtils.java`
#### Snippet
```java
    // find top parent field ID. eg: a.b.c, f.g.h, only collect id of a and f ignore all child field.
    List<Integer> topParentFieldIds = new ArrayList<>();
    names.stream().forEach(f -> {
      int id = schema.findIdByName(f.split("\\.")[0]);
      if (!topParentFieldIds.contains(id)) {
```

### SimplifyStreamApiCallChains
''stream().forEach()'' can be replaced with 'forEach()'' (may change semantics)
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/convert/AvroInternalSchemaConverter.java`
#### Snippet
```java
        }
        nextId.set(nextAssignId + fields.size());
        fields.stream().forEach(field -> {
          fieldTypes.add(visitAvroSchemaToBuildType(field.schema(), visited, false, nextId));
        });
```

### SimplifyStreamApiCallChains
''stream().forEach()'' can be replaced with 'forEach()'' (may change semantics)
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/convert/AvroInternalSchemaConverter.java`
#### Snippet
```java
      case UNION:
        List<Type> fTypes = new ArrayList<>();
        schema.getTypes().stream().forEach(t -> {
          fTypes.add(visitAvroSchemaToBuildType(t, visited, false, nextId));
        });
```

### SimplifyStreamApiCallChains
''stream().forEach()'' can be replaced with 'forEach()'' (may change semantics)
in `hudi-common/src/main/java/org/apache/hudi/common/engine/HoodieLocalEngineContext.java`
#### Snippet
```java
  @Override
  public <I> void foreach(List<I> data, SerializableConsumer<I> consumer, int parallelism) {
    data.stream().forEach(throwingForeachWrapper(consumer));
  }

```

### SimplifyStreamApiCallChains
Can be replaced with 'String.join'
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/utils/HiveAvroSerializer.java`
#### Snippet
```java
            allStructFieldRefs.get(i).getFieldObjectInspector(), record, field);
      } catch (Exception e) {
        LOG.error(String.format("current columnNames: %s", columnNames.stream().collect(Collectors.joining(","))));
        LOG.error(String.format("current type: %s", columnTypes.stream().map(f -> f.getTypeName()).collect(Collectors.joining(","))));
        LOG.error(String.format("current value: %s", HoodieRealtimeRecordReaderUtils.arrayWritableToString((ArrayWritable) o)));
```

### SimplifyStreamApiCallChains
Can be replaced with 'java.util.ArrayList' constructor
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDataTableValidator.java`
#### Snippet
```java
            return Stream.empty();
          }
        }, hoodieInstants.size()).stream().collect(Collectors.toList());

        if (!danglingFiles.isEmpty()) {
```

### SimplifyStreamApiCallChains
''stream().forEach()'' can be replaced with 'forEach()'' (may change semantics)
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/realtime/HoodieMergeOnReadTableInputFormat.java`
#### Snippet
```java

    List<FileStatus> result = new ArrayList<>();
    fileGroups.stream().forEach(f -> {
      try {
        List<FileSlice> baseFiles = f.getAllFileSlices().filter(slice -> slice.getBaseFile().isPresent()).collect(Collectors.toList());
```

### SimplifyStreamApiCallChains
Can be replaced with 'collection.toArray()'
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/HoodieIncrSource.java`
#### Snippet
```java

    // Remove Hoodie meta columns except partition path from input source
    String[] colsToDrop = shouldDropMetaFields ? HoodieRecord.HOODIE_META_COLUMNS.stream().toArray(String[]::new) :
        HoodieRecord.HOODIE_META_COLUMNS.stream().filter(x -> !x.equals(HoodieRecord.PARTITION_PATH_METADATA_FIELD)).toArray(String[]::new);
    final Dataset<Row> src = source.drop(colsToDrop);
```

### SimplifyStreamApiCallChains
Can be replaced with 'collection.toArray()'
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/util/DataTypeUtils.java`
#### Snippet
```java
      fields.add(DataTypes.FIELD(fieldNames.get(i), fieldTypes.get(i)));
    }
    return DataTypes.ROW(fields.stream().toArray(DataTypes.Field[]::new)).notNull();
  }

```

### SimplifyStreamApiCallChains
''stream().forEach()'' can be replaced with 'forEach()'' (may change semantics)
in `hudi-spark-datasource/hudi-spark2/src/main/java/org/apache/spark/sql/execution/datasources/parquet/Spark24HoodieVectorizedParquetRecordReader.java`
#### Snippet
```java
    boolean result = super.nextBatch();
    if (idToColumnVectors != null) {
      idToColumnVectors.entrySet().stream().forEach(e -> e.getValue().reset());
    }
    numBatched = resultBatch().numRows();
```

### SimplifyStreamApiCallChains
''stream().forEach()'' can be replaced with 'forEach()'' (may change semantics)
in `hudi-spark-datasource/hudi-spark2/src/main/java/org/apache/spark/sql/execution/datasources/parquet/Spark24HoodieVectorizedParquetRecordReader.java`
#### Snippet
```java
      typeChangeInfos.entrySet()
          .stream()
          .forEach(f -> {
            WritableColumnVector vector =
                memoryMode == MemoryMode.OFF_HEAP ? new OffHeapColumnVector(capacity, f.getValue().getLeft()) : new OnHeapColumnVector(capacity, f.getValue().getLeft());
```

## RuleId[ruleID=StringOperationCanBeSimplified]
### StringOperationCanBeSimplified
`toUpperCase()` call can be replaced with 'equalsIgnoreCase()'
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/utils/HoodieHiveUtils.java`
#### Snippet
```java
        .getValByRegex(HOODIE_CONSUME_MODE_PATTERN_STRING.pattern());
    List<String> result = tablesModeMap.entrySet().stream().map(s -> {
      if (s.getValue().trim().toUpperCase().equals(INCREMENTAL_SCAN_MODE)) {
        Matcher matcher = HOODIE_CONSUME_MODE_PATTERN_STRING.matcher(s.getKey());
        return (!matcher.find() ? null : matcher.group(1));
```

### StringOperationCanBeSimplified
Call to `toString()` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDataTableValidator.java`
#### Snippet
```java
        if (!danglingFiles.isEmpty()) {
          LOG.error("Data table validation failed due to extra files found for completed commits " + danglingFiles.size());
          danglingFiles.forEach(entry -> LOG.error("Dangling file: " + entry.toString()));
          finalResult = false;
          if (!cfg.ignoreFailed) {
```

## RuleId[ruleID=TypeParameterHidesVisibleType]
### TypeParameterHidesVisibleType
Type parameter `T` hides type parameter 'T'
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/table/HoodieFlinkTable.java`
#### Snippet
```java
   */
  @Override
  protected <T extends SpecificRecordBase> Option<HoodieTableMetadataWriter> getMetadataWriter(
      String triggeringInstantTimestamp,
      HoodieFailedWritesCleaningPolicy failedWritesCleaningPolicy,
```

### TypeParameterHidesVisibleType
Type parameter `T` hides type parameter 'T'
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/LazyFileIterable.java`
#### Snippet
```java
   * Iterator implementation for the iterable defined above.
   */
  public class LazyFileIterator<T, R> implements ClosableIterator<R> {

    private final String filePath;
```

### TypeParameterHidesVisibleType
Type parameter `R` hides type parameter 'R'
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/LazyFileIterable.java`
#### Snippet
```java
   * Iterator implementation for the iterable defined above.
   */
  public class LazyFileIterator<T, R> implements ClosableIterator<R> {

    private final String filePath;
```

### TypeParameterHidesVisibleType
Type parameter `R` hides type parameter 'R'
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/ExternalSpillableMap.java`
#### Snippet
```java
   * in-memory map 2) diskLazyFileIterator - Iterates over all the data spilled to disk.
   */
  private class IteratorWrapper<R> implements Iterator<R> {

    private final Iterator<R> inMemoryIterator;
```

## RuleId[ruleID=OptionalContainsCollection]
### OptionalContainsCollection
'Optional' contains collection `List`>
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/HoodieTableSource.java`
#### Snippet
```java

  @Override
  public Optional<List<Map<String, String>>> listPartitions() {
    List<Map<String, String>> partitions = this.fileIndex.getPartitions(
        this.partitionKeys, defaultPartName, conf.getBoolean(FlinkOptions.HIVE_STYLE_PARTITIONING));
```

## RuleId[ruleID=JavaReflectionMemberAccess]
### JavaReflectionMemberAccess
Cannot resolve method 'getWithoutRegisterFns'
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/ddl/HiveQueryDDLExecutor.java`
#### Snippet
```java
    IMetaStoreClient tempMetaStoreClient;
    try {
      tempMetaStoreClient = ((Hive) Hive.class.getMethod("getWithoutRegisterFns", HiveConf.class).invoke(null, hiveConf)).getMSC();
    } catch (NoSuchMethodException | IllegalAccessException | IllegalArgumentException | InvocationTargetException ex) {
      tempMetaStoreClient = Hive.get(hiveConf).getMSC();
```

### JavaReflectionMemberAccess
Cannot resolve method 'getWithoutRegisterFns'
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/ddl/HMSDDLExecutor.java`
#### Snippet
```java
    IMetaStoreClient tempMetaStoreClient;
    try {
      tempMetaStoreClient = ((Hive) Hive.class.getMethod("getWithoutRegisterFns", HiveConf.class).invoke(null, hiveConf)).getMSC();
    } catch (NoSuchMethodException | IllegalAccessException | IllegalArgumentException | InvocationTargetException ex) {
      tempMetaStoreClient = Hive.get(hiveConf).getMSC();
```

### JavaReflectionMemberAccess
Cannot resolve method 'getFromPathRecursively'
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/hive/HoodieCombineHiveInputFormat.java`
#### Snippet
```java
      } catch (NoSuchMethodException e) {
        // HiveFileFormatUtils.getFromPathRecursively method only available in Hive 3.x
        method = hiveUtilsClass.getMethod("getFromPathRecursively", Map.class, Path.class, Map.class);
      }
      return (PartitionDesc) method.invoke(null, pathToPartitionInfo, dir, cacheMap);
```

## RuleId[ruleID=FinallyBlockCannotCompleteNormally]
### FinallyBlockCannotCompleteNormally
`finally` block can not complete normally
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieMetadataTableValidator.java`
#### Snippet
```java
    } catch (Exception e) {
      throw new HoodieException("Unable to do hoodie metadata table validation in " + cfg.basePath, e);
    } finally {

      if (asyncMetadataTableValidateService.isPresent()) {
```

## RuleId[ruleID=NonSynchronizedMethodOverridesSynchronizedMethod]
### NonSynchronizedMethodOverridesSynchronizedMethod
Unsynchronized method `remove()` overrides synchronized method
in `hudi-common/src/main/java/org/apache/hudi/common/config/OrderedProperties.java`
#### Snippet
```java

  @Override
  public Object remove(Object key) {
    keys.remove(key);
    return super.remove(key);
```

## RuleId[ruleID=ProtectedMemberInFinalClass]
### ProtectedMemberInFinalClass
Class member declared `protected` in 'final' class
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/BitCaskDiskMap.java`
#### Snippet
```java
    private Long timestamp;

    protected ValueMetadata(String filePath, int sizeOfValue, long offsetOfValue, long timestamp) {
      this.filePath = filePath;
      this.sizeOfValue = sizeOfValue;
```

## RuleId[ruleID=SwitchStatementWithConfusingDeclaration]
### SwitchStatementWithConfusingDeclaration
Local variable `propsFilePath` declared in one 'switch' branch and used in another
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/SparkMain.java`
#### Snippet
```java
        case UPSERT:
          assert (args.length >= 13);
          String propsFilePath = null;
          if (!StringUtils.isNullOrEmpty(args[12])) {
            propsFilePath = args[12];
```

### SwitchStatementWithConfusingDeclaration
Local variable `configs` declared in one 'switch' branch and used in another
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/SparkMain.java`
#### Snippet
```java
            propsFilePath = args[12];
          }
          List<String> configs = new ArrayList<>();
          if (args.length > 13) {
            configs.addAll(Arrays.asList(args).subList(13, args.length));
```

## RuleId[ruleID=PublicFieldAccessedInSynchronizedContext]
### PublicFieldAccessedInSynchronizedContext
Non-private field `tempViewProvider` accessed in synchronized context
in `hudi-cli/src/main/java/org/apache/hudi/cli/HoodieCLI.java`
#### Snippet
```java

  public static synchronized TempViewProvider getTempViewProvider() {
    if (tempViewProvider == null) {
      tempViewProvider = new SparkTempViewProvider(HoodieCLI.class.getSimpleName());
    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `tempViewProvider` accessed in synchronized context
in `hudi-cli/src/main/java/org/apache/hudi/cli/HoodieCLI.java`
#### Snippet
```java
  public static synchronized TempViewProvider getTempViewProvider() {
    if (tempViewProvider == null) {
      tempViewProvider = new SparkTempViewProvider(HoodieCLI.class.getSimpleName());
    }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `tempViewProvider` accessed in synchronized context
in `hudi-cli/src/main/java/org/apache/hudi/cli/HoodieCLI.java`
#### Snippet
```java
    }

    return tempViewProvider;
  }
}
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `rowConverter` accessed in synchronized context
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/keygen/BuiltinKeyGenerator.java`
#### Snippet
```java
    if (rowConverter == null) {
      synchronized (this) {
        if (rowConverter == null) {
          rowConverter = new SparkRowConverter(structType);
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `rowConverter` accessed in synchronized context
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/keygen/BuiltinKeyGenerator.java`
#### Snippet
```java
      synchronized (this) {
        if (rowConverter == null) {
          rowConverter = new SparkRowConverter(structType);
        }
      }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `utf8StringPartitionPathFormatter` accessed in synchronized context
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/keygen/BuiltinKeyGenerator.java`
#### Snippet
```java
    if (utf8StringPartitionPathFormatter == null) {
      synchronized (this) {
        if (utf8StringPartitionPathFormatter == null) {
          this.utf8StringPartitionPathFormatter = new UTF8StringPartitionPathFormatter(
              UTF8StringPartitionPathFormatter.UTF8StringBuilder::new, hiveStylePartitioning, encodePartitionPath);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.utf8StringPartitionPathFormatter` accessed in synchronized context
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/keygen/BuiltinKeyGenerator.java`
#### Snippet
```java
      synchronized (this) {
        if (utf8StringPartitionPathFormatter == null) {
          this.utf8StringPartitionPathFormatter = new UTF8StringPartitionPathFormatter(
              UTF8StringPartitionPathFormatter.UTF8StringBuilder::new, hiveStylePartitioning, encodePartitionPath);
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.rowAccessor` accessed in synchronized context
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/keygen/BuiltinKeyGenerator.java`
#### Snippet
```java
    if (this.rowAccessor == null) {
      synchronized (this) {
        if (this.rowAccessor == null) {
          this.rowAccessor = new SparkRowAccessor(schema);
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.rowAccessor` accessed in synchronized context
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/keygen/BuiltinKeyGenerator.java`
#### Snippet
```java
      synchronized (this) {
        if (this.rowAccessor == null) {
          this.rowAccessor = new SparkRowAccessor(schema);
        }
      }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `stringPartitionPathFormatter` accessed in synchronized context
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/keygen/BuiltinKeyGenerator.java`
#### Snippet
```java
    if (stringPartitionPathFormatter == null) {
      synchronized (this) {
        if (stringPartitionPathFormatter == null) {
          this.stringPartitionPathFormatter = new StringPartitionPathFormatter(
              StringPartitionPathFormatter.JavaStringBuilder::new, hiveStylePartitioning, encodePartitionPath);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.stringPartitionPathFormatter` accessed in synchronized context
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/keygen/BuiltinKeyGenerator.java`
#### Snippet
```java
      synchronized (this) {
        if (stringPartitionPathFormatter == null) {
          this.stringPartitionPathFormatter = new StringPartitionPathFormatter(
              StringPartitionPathFormatter.JavaStringBuilder::new, hiveStylePartitioning, encodePartitionPath);
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.currentTxnOwnerInstant` accessed in synchronized context
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/transaction/TransactionManager.java`
#### Snippet
```java
                                       Option<HoodieInstant> newTxnOwnerInstant,
                                       Option<HoodieInstant> lastCompletedTxnOwnerInstant) {
    if (!this.currentTxnOwnerInstant.isPresent() || this.currentTxnOwnerInstant.get().equals(callerInstant.get())) {
      this.currentTxnOwnerInstant = newTxnOwnerInstant;
      this.lastCompletedTxnOwnerInstant = lastCompletedTxnOwnerInstant;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.currentTxnOwnerInstant` accessed in synchronized context
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/transaction/TransactionManager.java`
#### Snippet
```java
                                       Option<HoodieInstant> newTxnOwnerInstant,
                                       Option<HoodieInstant> lastCompletedTxnOwnerInstant) {
    if (!this.currentTxnOwnerInstant.isPresent() || this.currentTxnOwnerInstant.get().equals(callerInstant.get())) {
      this.currentTxnOwnerInstant = newTxnOwnerInstant;
      this.lastCompletedTxnOwnerInstant = lastCompletedTxnOwnerInstant;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.currentTxnOwnerInstant` accessed in synchronized context
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/transaction/TransactionManager.java`
#### Snippet
```java
                                       Option<HoodieInstant> lastCompletedTxnOwnerInstant) {
    if (!this.currentTxnOwnerInstant.isPresent() || this.currentTxnOwnerInstant.get().equals(callerInstant.get())) {
      this.currentTxnOwnerInstant = newTxnOwnerInstant;
      this.lastCompletedTxnOwnerInstant = lastCompletedTxnOwnerInstant;
      return true;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `activeTimeline` accessed in synchronized context
in `hudi-common/src/main/java/org/apache/hudi/common/table/HoodieTableMetaClient.java`
#### Snippet
```java
   */
  public synchronized HoodieActiveTimeline reloadActiveTimeline() {
    activeTimeline = new HoodieActiveTimeline(this);
    return activeTimeline;
  }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `activeTimeline` accessed in synchronized context
in `hudi-common/src/main/java/org/apache/hudi/common/table/HoodieTableMetaClient.java`
#### Snippet
```java
  public synchronized HoodieActiveTimeline reloadActiveTimeline() {
    activeTimeline = new HoodieActiveTimeline(this);
    return activeTimeline;
  }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `activeTimeline` accessed in synchronized context
in `hudi-common/src/main/java/org/apache/hudi/common/table/HoodieTableMetaClient.java`
#### Snippet
```java
   */
  public synchronized HoodieActiveTimeline getActiveTimeline() {
    if (activeTimeline == null) {
      activeTimeline = new HoodieActiveTimeline(this);
    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `activeTimeline` accessed in synchronized context
in `hudi-common/src/main/java/org/apache/hudi/common/table/HoodieTableMetaClient.java`
#### Snippet
```java
  public synchronized HoodieActiveTimeline getActiveTimeline() {
    if (activeTimeline == null) {
      activeTimeline = new HoodieActiveTimeline(this);
    }
    return activeTimeline;
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `activeTimeline` accessed in synchronized context
in `hudi-common/src/main/java/org/apache/hudi/common/table/HoodieTableMetaClient.java`
#### Snippet
```java
      activeTimeline = new HoodieActiveTimeline(this);
    }
    return activeTimeline;
  }

```

### PublicFieldAccessedInSynchronizedContext
Non-private field `counters` accessed in synchronized context
in `hudi-common/src/main/java/org/apache/hudi/common/metrics/LocalRegistry.java`
#### Snippet
```java

  private synchronized Counter getCounter(String name) {
    if (!counters.containsKey(name)) {
      counters.put(name, new Counter());
    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `counters` accessed in synchronized context
in `hudi-common/src/main/java/org/apache/hudi/common/metrics/LocalRegistry.java`
#### Snippet
```java
  private synchronized Counter getCounter(String name) {
    if (!counters.containsKey(name)) {
      counters.put(name, new Counter());
    }
    return counters.get(name);
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `counters` accessed in synchronized context
in `hudi-common/src/main/java/org/apache/hudi/common/metrics/LocalRegistry.java`
#### Snippet
```java
      counters.put(name, new Counter());
    }
    return counters.get(name);
  }
}
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `localResult` accessed in synchronized context
in `hudi-examples/hudi-examples-flink/src/main/java/org/apache/hudi/examples/quickstart/factory/CollectSinkTableFactory.java`
#### Snippet
```java
      this.taskID = getRuntimeContext().getIndexOfThisSubtask();
      synchronized (CollectSinkTableFactory.class) {
        RESULT.put(taskID, localResult);
      }
    }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.conf` accessed in synchronized context
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/realtime/HoodieHFileRealtimeInputFormat.java`
#### Snippet
```java
          HoodieRealtimeInputFormatUtils.addRequiredProjectionFields(jobConf, Option.empty(), Option.empty());

          this.conf = jobConf;
          this.conf.set(HoodieInputFormatUtils.HOODIE_READ_COLUMNS_PROP, "true");
        }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.conf` accessed in synchronized context
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/realtime/HoodieHFileRealtimeInputFormat.java`
#### Snippet
```java

          this.conf = jobConf;
          this.conf.set(HoodieInputFormatUtils.HOODIE_READ_COLUMNS_PROP, "true");
        }
      }
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.fsView` accessed in synchronized context
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/partitioner/profile/WriteProfile.java`
#### Snippet
```java
    this.metaClient.reloadActiveTimeline();
    // release the old fs view and create a new one
    SyncableFileSystemView oldFsView = this.fsView;
    this.fsView = getFileSystemView();
    oldFsView.close();
```

### PublicFieldAccessedInSynchronizedContext
Non-private field `this.fsView` accessed in synchronized context
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/partitioner/profile/WriteProfile.java`
#### Snippet
```java
    // release the old fs view and create a new one
    SyncableFileSystemView oldFsView = this.fsView;
    this.fsView = getFileSystemView();
    oldFsView.close();

```

## RuleId[ruleID=RedundantSuppression]
### RedundantSuppression
Redundant suppression
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/execution/bulkinsert/PartitionPathRDDPartitioner.java`
#### Snippet
```java
  @SuppressWarnings("unchecked")
  @Override
  public int getPartition(Object o) {
    return Math.abs(Objects.hash(partitionPathExtractor.apply(o))) % numPartitions;
  }
```

### RedundantSuppression
Redundant suppression
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/Triple.java`
#### Snippet
```java
  @SuppressWarnings("deprecation") // ObjectUtils.equals(Object, Object) has been deprecated in 3.2
  @Override
  public boolean equals(final Object obj) {
    if (obj == this) {
      return true;
```

### RedundantSuppression
Redundant suppression
in `hudi-spark-datasource/hudi-spark-common/src/main/java/org/apache/hudi/DataSourceUtils.java`
#### Snippet
```java

  @SuppressWarnings("unchecked")
  public static JavaRDD<HoodieRecord> dropDuplicates(JavaSparkContext jssc, JavaRDD<HoodieRecord> incomingHoodieRecords,
      Map<String, String> parameters) {
    HoodieWriteConfig writeConfig =
```

### RedundantSuppression
Redundant suppression
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieMetadataTableValidator.java`
#### Snippet
```java

    @SuppressWarnings({"rawtypes", "unchecked"})
    public List<HoodieColumnRangeMetadata<Comparable>> getSortedColumnStatsList(
        String partitionPath, List<String> baseFileNameList) {
      LOG.info("All column names for getting column stats: " + allColumnNameList);
```

## RuleId[ruleID=NonStrictComparisonCanBeEquality]
### NonStrictComparisonCanBeEquality
Can be replaced with equality
in `hudi-common/src/main/java/org/apache/hudi/common/util/CollectionUtils.java`
#### Snippet
```java
    checkArgument(batchSize > 0, "batch size must be positive.");
    int total = list.size();
    if (total <= 0) {
      return Stream.empty();
    }
```

## RuleId[ruleID=OptionalUsedAsFieldOrParameterType]
### OptionalUsedAsFieldOrParameterType
`Optional` used as type for parameter 'v'
in `hudi-common/src/main/java/org/apache/hudi/common/util/Option.java`
#### Snippet
```java
   * @return Option
   */
  public static <T> Option<T> fromJavaOptional(Optional<T> v) {
    return Option.ofNullable(v.orElse(null));
  }
```

## RuleId[ruleID=CharsetObjectCanBeUsed]
### CharsetObjectCanBeUsed
StandardCharsets.UTF_8 can be used instead
in `hudi-common/src/main/java/org/apache/hudi/common/util/BinaryUtil.java`
#### Snippet
```java

  public static byte[] utf8To8Byte(String a) {
    return paddingTo8Byte(a.getBytes(Charset.forName("utf-8")));
  }

```

## RuleId[ruleID=SystemOutErr]
### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `hudi-cli/src/main/java/org/apache/hudi/cli/Main.java`
#### Snippet
```java

  public static void main(String[] args) throws IOException {
    System.out.println("Main called");
    SpringApplication.run(Main.class, args);
  }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `hudi-cli/src/main/java/org/apache/hudi/cli/utils/HiveUtil.java`
#### Snippet
```java
    String startDateStr = dateTime.getYear() + "-" + String.format("%02d", dateTime.getMonthOfYear()) + "-"
        + String.format("%02d", dateTime.getDayOfMonth());
    System.out.println("Start date " + startDateStr + " and end date " + endDateStr);
    return countRecords(jdbcUrl, source, srcDb, startDateStr, endDateStr, user, pass);
  }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `hudi-cli/src/main/java/org/apache/hudi/cli/utils/HiveUtil.java`
#### Snippet
```java
        count = rs.getLong("cnt");
      }
      System.out.println("Total records in " + source.getTableConfig().getTableName() + " is " + count);
      return count;
    } finally {
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/KerberosAuthenticationCommand.java`
#### Snippet
```java
      @ShellOption(value = "--krb5conf", help = "Path to krb5.conf", defaultValue = "/etc/krb5.conf") String krb5ConfPath) throws IOException {

    System.out.println("Destroy Kerberos authentication");
    System.out.println("Parameters:");
    System.out.println("--krb5conf: " + krb5ConfPath);
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/KerberosAuthenticationCommand.java`
#### Snippet
```java

    System.out.println("Destroy Kerberos authentication");
    System.out.println("Parameters:");
    System.out.println("--krb5conf: " + krb5ConfPath);

```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/KerberosAuthenticationCommand.java`
#### Snippet
```java
    System.out.println("Destroy Kerberos authentication");
    System.out.println("Parameters:");
    System.out.println("--krb5conf: " + krb5ConfPath);

    System.setProperty("java.security.krb5.conf", krb5ConfPath);
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/KerberosAuthenticationCommand.java`
#### Snippet
```java
      UserGroupInformation.reset();
    } else {
      System.out.println("Currently, no user login with kerberos, do nothing");
    }

```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/KerberosAuthenticationCommand.java`
#### Snippet
```java
    }

    System.out.println("Current user: " + UserGroupInformation.getCurrentUser());
    System.out.println("Login user: " + UserGroupInformation.getLoginUser());

```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/KerberosAuthenticationCommand.java`
#### Snippet
```java

    System.out.println("Current user: " + UserGroupInformation.getCurrentUser());
    System.out.println("Login user: " + UserGroupInformation.getLoginUser());

    return "Destroy Kerberos authentication success";
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/KerberosAuthenticationCommand.java`
#### Snippet
```java
          @ShellOption(value = "--keytab", help = "Path to keytab") String keytabPath) throws IOException {

    System.out.println("Perform Kerberos authentication");
    System.out.println("Parameters:");
    System.out.println("--krb5conf: " + krb5ConfPath);
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/KerberosAuthenticationCommand.java`
#### Snippet
```java

    System.out.println("Perform Kerberos authentication");
    System.out.println("Parameters:");
    System.out.println("--krb5conf: " + krb5ConfPath);
    System.out.println("--principal: " + principal);
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/KerberosAuthenticationCommand.java`
#### Snippet
```java
    System.out.println("Perform Kerberos authentication");
    System.out.println("Parameters:");
    System.out.println("--krb5conf: " + krb5ConfPath);
    System.out.println("--principal: " + principal);
    System.out.println("--keytab: " + keytabPath);
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/KerberosAuthenticationCommand.java`
#### Snippet
```java
    System.out.println("Parameters:");
    System.out.println("--krb5conf: " + krb5ConfPath);
    System.out.println("--principal: " + principal);
    System.out.println("--keytab: " + keytabPath);

```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/KerberosAuthenticationCommand.java`
#### Snippet
```java
    System.out.println("--krb5conf: " + krb5ConfPath);
    System.out.println("--principal: " + principal);
    System.out.println("--keytab: " + keytabPath);

    System.setProperty("java.security.krb5.conf", krb5ConfPath);
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/KerberosAuthenticationCommand.java`
#### Snippet
```java
    UserGroupInformation.loginUserFromKeytab(principal, keytabPath);

    System.out.println("Kerberos current user: " + UserGroupInformation.getCurrentUser());
    System.out.println("Kerberos login user: " + UserGroupInformation.getLoginUser());

```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/KerberosAuthenticationCommand.java`
#### Snippet
```java

    System.out.println("Kerberos current user: " + UserGroupInformation.getCurrentUser());
    System.out.println("Kerberos login user: " + UserGroupInformation.getLoginUser());

    return "Kerberos authentication success";
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `hudi-cli/src/main/java/org/apache/hudi/cli/utils/SparkTempViewProvider.java`
#### Snippet
```java
      Dataset<Row> dataset = this.sqlContext.createDataFrame(records, structType);
      dataset.createOrReplaceTempView(tableName);
      System.out.println("Wrote table view: " + tableName);
    } catch (Throwable ex) {
      // log full stack trace and rethrow. Without this its difficult to debug failures, if any
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/TableCommand.java`
#### Snippet
```java

  static {
    System.out.println("Table command getting loaded");
  }

```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/CompactionCommand.java`
#### Snippet
```java
        Option.fromJavaOptional(res.stream().map(r -> r.isExecuted() && r.isSuccess()).reduce(Boolean::logicalAnd));
    if (result.isPresent()) {
      System.out.println("There were some file renames that needed to be done to " + operation);

      if (result.get()) {
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/CompactionCommand.java`
#### Snippet
```java

      if (result.get()) {
        System.out.println("All renames successfully completed to " + operation + " done !!");
      } else {
        System.out.println("Some renames failed. table could be in inconsistent-state. Try running compaction repair");
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/CompactionCommand.java`
#### Snippet
```java
        System.out.println("All renames successfully completed to " + operation + " done !!");
      } else {
        System.out.println("Some renames failed. table could be in inconsistent-state. Try running compaction repair");
      }

```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/ArchivedCommitsCommand.java`
#### Snippet
```java
              defaultValue = "false") final boolean headerOnly)
      throws IOException {
    System.out.println("===============> Showing only " + limit + " archived commits <===============");
    String basePath = HoodieCLI.getTableMetaClient().getBasePath();
    Path archivePath = new Path(HoodieCLI.getTableMetaClient().getArchivePath() + "/.commits_.archive*");
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/ArchivedCommitsCommand.java`
#### Snippet
```java
      throws IOException {

    System.out.println("===============> Showing only " + limit + " archived commits <===============");
    HoodieTableMetaClient metaClient = HoodieCLI.getTableMetaClient();
    String basePath = metaClient.getBasePath();
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/HoodieLogFileCommand.java`
#### Snippet
```java
      throws IOException {

    System.out.println("===============> Showing only " + limit + " records <===============");

    HoodieTableMetaClient client = HoodieCLI.getTableMetaClient();
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/HoodieLogFileCommand.java`
#### Snippet
```java

    if (shouldMerge) {
      System.out.println("===========================> MERGING RECORDS <===================");
      HoodieMergedLogRecordScanner scanner =
          HoodieMergedLogRecordScanner.newBuilder()
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `packaging/hudi-aws-bundle/src/main/java/org/apache/hudi/aws/bundle/Main.java`
#### Snippet
```java

  public static void main(String[] args) {
    ReflectionUtils.getTopLevelClassesInClasspath(Main.class).forEach(System.out::println);
  }
}
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `packaging/hudi-cli-bundle/src/main/java/org/apache/hudi/cli/bundle/Main.java`
#### Snippet
```java
public class Main {
  public static void main(String[] args) {
    ReflectionUtils.getTopLevelClassesInClasspath(Main.class).forEach(System.out::println);
  }
}
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `packaging/hudi-gcp-bundle/src/main/java/org/apache/hudi/gcp/bigquery/bundle/Main.java`
#### Snippet
```java

  public static void main(String[] args) {
    ReflectionUtils.getTopLevelClassesInClasspath(Main.class).forEach(System.out::println);
  }
}
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `packaging/hudi-flink-bundle/src/main/java/org/apache/hudi/flink/bundle/Main.java`
#### Snippet
```java

  public static void main(String[] args) {
    ReflectionUtils.getTopLevelClassesInClasspath(Main.class).forEach(System.out::println);
  }
}
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `packaging/hudi-spark-bundle/src/main/java/org/apache/hudi/spark/bundle/Main.java`
#### Snippet
```java

  public static void main(String[] args) {
    ReflectionUtils.getTopLevelClassesInClasspath(Main.class).forEach(System.out::println);
  }
}
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `packaging/hudi-presto-bundle/src/main/java/org/apache/hudi/presto/bundle/Main.java`
#### Snippet
```java

  public static void main(String[] args) {
    ReflectionUtils.getTopLevelClassesInClasspath(Main.class).forEach(System.out::println);
  }
}
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `packaging/hudi-trino-bundle/src/main/java/org/apache/hudi/trino/bundle/Main.java`
#### Snippet
```java

  public static void main(String[] args) {
    ReflectionUtils.getTopLevelClassesInClasspath(Main.class).forEach(System.out::println);
  }
}
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `packaging/hudi-hadoop-mr-bundle/src/main/java/org/apache/hudi/hadoop/bundle/Main.java`
#### Snippet
```java

  public static void main(String[] args) {
    ReflectionUtils.getTopLevelClassesInClasspath(Main.class).forEach(System.out::println);
  }
}
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `packaging/hudi-utilities-bundle/src/main/java/org/apache/hudi/utilities/bundle/Main.java`
#### Snippet
```java

  public static void main(String[] args) {
    ReflectionUtils.getTopLevelClassesInClasspath(Main.class).forEach(System.out::println);
  }
}
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `packaging/hudi-hive-sync-bundle/src/main/java/org/apache/hudi/hive/bundle/Main.java`
#### Snippet
```java

  public static void main(String[] args) {
    ReflectionUtils.getTopLevelClassesInClasspath(Main.class).forEach(System.out::println);
  }
}
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `packaging/hudi-kafka-connect-bundle/src/main/java/org/apache/hudi/kafka/connect/bundle/Main.java`
#### Snippet
```java

  public static void main(String[] args) {
    ReflectionUtils.getTopLevelClassesInClasspath(Main.class).forEach(System.out::println);
  }
}
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `packaging/hudi-utilities-slim-bundle/src/main/java/org/apache/hudi/utilities/bundle/Main.java`
#### Snippet
```java

  public static void main(String[] args) {
    ReflectionUtils.getTopLevelClassesInClasspath(Main.class).forEach(System.out::println);
  }
}
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `packaging/hudi-datahub-sync-bundle/src/main/java/org/apache/hudi/datahub/bundle/Main.java`
#### Snippet
```java

  public static void main(String[] args) {
    ReflectionUtils.getTopLevelClassesInClasspath(Main.class).forEach(System.out::println);
  }
}
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `packaging/hudi-timeline-server-bundle/src/main/java/org/apache/hudi/timeline/server/bundle/Main.java`
#### Snippet
```java

  public static void main(String[] args) {
    ReflectionUtils.getTopLevelClassesInClasspath(Main.class).forEach(System.out::println);
  }
}
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/validator/SqlQueryInequalityPreCommitValidator.java`
#### Snippet
```java
    if (areDatasetsEqual) {
      LOG.error("query validation failed. See stdout for sample query results. Query: " + query);
      System.out.println("Expected query results to be different, but they are same. Result (sample records only):");
      prevRows.show();
      throw new HoodieValidationException("Query validation failed for '" + query 
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/validator/SqlQueryEqualityPreCommitValidator.java`
#### Snippet
```java
    if (!areDatasetsEqual) {
      LOG.error("query validation failed. See stdout for sample query results. Query: " + query);
      System.out.println("Expected result (sample records only):");
      prevRows.show();
      System.out.println("Actual result (sample records only):");
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/validator/SqlQueryEqualityPreCommitValidator.java`
#### Snippet
```java
      System.out.println("Expected result (sample records only):");
      prevRows.show();
      System.out.println("Actual result (sample records only):");
      newRows.show();
      throw new HoodieValidationException("Query validation failed for '" + query + "'. See stdout for expected vs actual records");
```

### SystemOutErr
Uses of `System.err` should probably be replaced with more robust logging
in `hudi-examples/hudi-examples-java/src/main/java/org/apache/hudi/examples/java/HoodieJavaWriteClientExample.java`
#### Snippet
```java
  public static void main(String[] args) throws Exception {
    if (args.length < 2) {
      System.err.println("Usage: HoodieJavaWriteClientExample <tablePath> <tableName>");
      System.exit(1);
    }
```

### SystemOutErr
Uses of `System.err` should probably be replaced with more robust logging
in `hudi-examples/hudi-examples-flink/src/main/java/org/apache/hudi/examples/quickstart/HoodieFlinkQuickstart.java`
#### Snippet
```java
  public static void main(String[] args) throws TableNotExistException, InterruptedException {
    if (args.length < 3) {
      System.err.println("Usage: HoodieWriteClientExample <tablePath> <tableName> <tableType>");
      System.exit(1);
    }
```

### SystemOutErr
Uses of `System.err` should probably be replaced with more robust logging
in `hudi-examples/hudi-examples-spark/src/main/java/org/apache/hudi/examples/spark/HoodieSparkBootstrapExample.java`
#### Snippet
```java
  public static void main(String[] args) throws Exception {
    if (args.length < 5) {
      System.err.println("Usage: HoodieSparkBootstrapExample <recordKey> <tableName> <partitionPath> <preCombineField> <basePath>");
      System.exit(1);
    }
```

### SystemOutErr
Uses of `System.err` should probably be replaced with more robust logging
in `hudi-examples/hudi-examples-spark/src/main/java/org/apache/hudi/examples/spark/HoodieWriteClientExample.java`
#### Snippet
```java
  public static void main(String[] args) throws Exception {
    if (args.length < 2) {
      System.err.println("Usage: HoodieWriteClientExample <tablePath> <tableName>");
      System.exit(1);
    }
```

### SystemOutErr
Uses of `System.err` should probably be replaced with more robust logging
in `hudi-examples/hudi-examples-spark/src/main/java/org/apache/hudi/examples/quickstart/HoodieSparkQuickstart.java`
#### Snippet
```java
  public static void main(String[] args) {
    if (args.length < 2) {
      System.err.println("Usage: HoodieWriteClientExample <tablePath> <tableName>");
      System.exit(1);
    }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieWithTimelineServer.java`
#### Snippet
```java
    try (CloseableHttpClient client = HttpClientBuilder.create().build()) {

      System.out.println("Sleeping for " + cfg.delaySecs + " secs ");
      Thread.sleep(cfg.delaySecs * 1000);
      System.out.println("Woke up after sleeping for " + cfg.delaySecs + " secs ");
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieWithTimelineServer.java`
#### Snippet
```java
      System.out.println("Sleeping for " + cfg.delaySecs + " secs ");
      Thread.sleep(cfg.delaySecs * 1000);
      System.out.println("Woke up after sleeping for " + cfg.delaySecs + " secs ");

      HttpGet request = new HttpGet(url);
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieWithTimelineServer.java`
#### Snippet
```java
      HttpResponse response = client.execute(request);

      System.out.println("Response Code from(" + url + ") : " + response.getStatusLine().getStatusCode());

      try (BufferedReader rd = new BufferedReader(new InputStreamReader(response.getEntity().getContent()))) {
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieWithTimelineServer.java`
#### Snippet
```java
        StringBuilder result = new StringBuilder();
        rd.lines().forEach(result::append);
        System.out.println("Got result (" + result + ")");
        return result.toString();
      } catch (IOException e) {
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieWithTimelineServer.java`
#### Snippet
```java
    startService();
    final String driverHost = InetAddress.getLocalHost().getHostAddress();
    System.out.println("Driver Hostname is :" + driverHost);
    List<String> messages = new ArrayList<>();
    IntStream.range(0, cfg.numPartitions).forEach(i -> messages.add("Hello World"));
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieWithTimelineServer.java`
#### Snippet
```java
    context.setJobStatus(this.getClass().getSimpleName(), "Sending requests to driver host");
    List<String> gotMessages = context.map(messages, msg -> sendRequest(driverHost, cfg.serverPort), messages.size());
    System.out.println("Got Messages :" + gotMessages);
    ValidationUtils.checkArgument(gotMessages.equals(messages), "Got expected reply from Server");
  }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieCompactionAdminTool.java`
#### Snippet
```java
   */
  private <T> void printOperationResult(String initialLine, List<T> result) {
    System.out.println(initialLine);
    for (T r : result) {
      System.out.print(r);
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieCompactionAdminTool.java`
#### Snippet
```java
    System.out.println(initialLine);
    for (T r : result) {
      System.out.print(r);
    }
  }
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieCompactionAdminTool.java`
#### Snippet
```java
              new HoodieFileGroupId(cfg.partitionPath, cfg.fileId), cfg.skipValidation, cfg.dryRun);
          if (cfg.printOutput) {
            System.out.println(r);
          }
          serializeOperationResult(fs, r);
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/perf/TimelineServerPerf.java`
#### Snippet
```java
        }
      });
      System.out.println("SLICES are=");
      slices.forEach(s -> System.out.println("\t\tFileSlice=" + s));
      return result.stream();
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/perf/TimelineServerPerf.java`
#### Snippet
```java
      });
      System.out.println("SLICES are=");
      slices.forEach(s -> System.out.println("\t\tFileSlice=" + s));
      return result.stream();
    }, cfg.numExecutors);
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/perf/TimelineServerPerf.java`
#### Snippet
```java
        String row = String.format("%s,%d,%d,%d,%f,%f,%f,%f\n", x.partition, x.id, x.minTime, x.maxTime, x.meanTime,
            x.medianTime, x.p75, x.p95);
        System.out.println(row);
        try {
          outputStream.write(row.getBytes());
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/perf/TimelineServerPerf.java`
#### Snippet
```java
      Option<FileSlice> c = fsView.getLatestFileSlice(partition, fileId);
      long endTs = System.currentTimeMillis();
      System.out.println("Latest File Slice for part=" + partition + ", fileId=" + fileId + ", Slice=" + c + ", Time="
          + (endTs - beginTs));
      latencyHistogram.update(endTs - beginTs);
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/perf/TimelineServerPerf.java`
#### Snippet
```java

    String dumpPrefix = UUID.randomUUID().toString();
    System.out.println("First Iteration to load all partitions");
    Dumper d = new Dumper(metaClient.getFs(), new Path(reportDir, String.format("1_%s.csv", dumpPrefix)));
    d.init();
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/perf/TimelineServerPerf.java`
#### Snippet
```java
    d.dump(runLookups(jsc, selected, fsView, 1, 0));
    d.close();
    System.out.println("\n\n\n First Iteration is done");

    Dumper d2 = new Dumper(metaClient.getFs(), new Path(reportDir, String.format("2_%s.csv", dumpPrefix)));
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/perf/TimelineServerPerf.java`
#### Snippet
```java
    d2.close();

    System.out.println("\n\n\nDumping all File Slices");
    selected.forEach(p -> fsView.getAllFileSlices(p).forEach(s -> System.out.println("\tMyFileSlice=" + s)));

```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/perf/TimelineServerPerf.java`
#### Snippet
```java

    System.out.println("\n\n\nDumping all File Slices");
    selected.forEach(p -> fsView.getAllFileSlices(p).forEach(s -> System.out.println("\tMyFileSlice=" + s)));

    // Waiting for curl queries
```

### SystemOutErr
Uses of `System.out` should probably be replaced with more robust logging
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/perf/TimelineServerPerf.java`
#### Snippet
```java
    // Waiting for curl queries
    if (!useExternalTimelineServer && cfg.waitForManualQueries) {
      System.out.println("Timeline Server Host Address=" + hostAddr + ", port=" + timelineServer.getServerPort());
      while (true) {
        try {
```

## RuleId[ruleID=ImplicitArrayToString]
### ImplicitArrayToString
Implicit call to 'toString()' on array returned by call to `record.value()`
in `hudi-kafka-connect/src/main/java/org/apache/hudi/connect/kafka/KafkaConnectControlAgent.java`
#### Snippet
```java
          try {
            LOG.debug(String.format("Kafka consumerGroupId = %s topic = %s, partition = %s, offset = %s, customer = %s, country = %s",
                "", record.topic(), record.partition(), record.offset(), record.key(), record.value()));
            ControlMessage message = ControlMessage.parseFrom(record.value());
            String senderTopic = message.getTopicName();
```

## RuleId[ruleID=DynamicRegexReplaceableByCompiledPattern]
### DynamicRegexReplaceableByCompiledPattern
`replaceFirst()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-aws/src/main/java/org/apache/hudi/aws/utils/S3Utils.java`
#### Snippet
```java

  public static String s3aToS3(String s3aUrl) {
    return s3aUrl.replaceFirst("(?i)^s3a://", "s3://");
  }
}
```

### DynamicRegexReplaceableByCompiledPattern
`replaceAll()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-cli/src/main/java/org/apache/hudi/cli/utils/SparkTempViewProvider.java`
#### Snippet
```java

      // replace all whitespaces in headers to make it easy to write sql queries
      List<String> headersNoSpaces = headers.stream().map(title -> title.replaceAll("\\s+",""))
              .collect(Collectors.toList());

```

### DynamicRegexReplaceableByCompiledPattern
`replaceAll()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-sync/hudi-adb-sync/src/main/java/org/apache/hudi/sync/adb/HoodieAdbJdbcClient.java`
#### Snippet
```java
            String sub = table.substring(index + TBL_PROPERTIES_STR.length());
            sub = sub
                .replaceAll("\\(", "")
                .replaceAll("\\)", "")
                .replaceAll("'", "");
```

### DynamicRegexReplaceableByCompiledPattern
`replaceAll()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-sync/hudi-adb-sync/src/main/java/org/apache/hudi/sync/adb/HoodieAdbJdbcClient.java`
#### Snippet
```java
            sub = sub
                .replaceAll("\\(", "")
                .replaceAll("\\)", "")
                .replaceAll("'", "");
            String[] str = sub.split(",");
```

### DynamicRegexReplaceableByCompiledPattern
`replaceAll()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-sync/hudi-adb-sync/src/main/java/org/apache/hudi/sync/adb/HoodieAdbJdbcClient.java`
#### Snippet
```java
                .replaceAll("\\(", "")
                .replaceAll("\\)", "")
                .replaceAll("'", "");
            String[] str = sub.split(",");

```

### DynamicRegexReplaceableByCompiledPattern
`replace()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/ddl/QueryBasedDDLExecutor.java`
#### Snippet
```java
      String type = field.getValue().getLeft();
      String comment = field.getValue().getRight();
      comment = comment.replace("'","");
      sql.append("ALTER TABLE ").append(HIVE_ESCAPE_CHARACTER)
              .append(databaseName).append(HIVE_ESCAPE_CHARACTER).append(".")
```

### DynamicRegexReplaceableByCompiledPattern
`replaceAll()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/util/HiveSchemaUtil.java`
#### Snippet
```java
    // schema.
    // HDrone sync should not fail because of this.
    finalStr = finalStr.replaceAll("-", "_");
    return finalStr;
  }
```

### DynamicRegexReplaceableByCompiledPattern
`replaceAll()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/util/HiveSchemaUtil.java`
#### Snippet
```java
          continue;
        }
        tableColumnType = tableColumnType.replaceAll("\\s+", "");

        String expectedType = getExpectedType(newTableSchema, tickSurroundedFieldName);
```

### DynamicRegexReplaceableByCompiledPattern
`replaceAll()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/util/HiveSchemaUtil.java`
#### Snippet
```java

        String expectedType = getExpectedType(newTableSchema, tickSurroundedFieldName);
        expectedType = expectedType.replaceAll("\\s+", "");
        expectedType = expectedType.replaceAll("`", "");

```

### DynamicRegexReplaceableByCompiledPattern
`replaceAll()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/util/HiveSchemaUtil.java`
#### Snippet
```java
        String expectedType = getExpectedType(newTableSchema, tickSurroundedFieldName);
        expectedType = expectedType.replaceAll("\\s+", "");
        expectedType = expectedType.replaceAll("`", "");

        if (!tableColumnType.equalsIgnoreCase(expectedType)) {
```

### DynamicRegexReplaceableByCompiledPattern
`replaceAll()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/validator/SqlQueryInequalityPreCommitValidator.java`
#### Snippet
```java
  @Override
  protected void validateUsingQuery(String query, String prevTableSnapshot, String newTableSnapshot, SQLContext sqlContext) {
    String queryWithPrevSnapshot = query.replaceAll(HoodiePreCommitValidatorConfig.VALIDATOR_TABLE_VARIABLE, prevTableSnapshot);
    String queryWithNewSnapshot = query.replaceAll(HoodiePreCommitValidatorConfig.VALIDATOR_TABLE_VARIABLE, newTableSnapshot);
    LOG.info("Running query on previous state: " + queryWithPrevSnapshot);
```

### DynamicRegexReplaceableByCompiledPattern
`replaceAll()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/validator/SqlQueryInequalityPreCommitValidator.java`
#### Snippet
```java
  protected void validateUsingQuery(String query, String prevTableSnapshot, String newTableSnapshot, SQLContext sqlContext) {
    String queryWithPrevSnapshot = query.replaceAll(HoodiePreCommitValidatorConfig.VALIDATOR_TABLE_VARIABLE, prevTableSnapshot);
    String queryWithNewSnapshot = query.replaceAll(HoodiePreCommitValidatorConfig.VALIDATOR_TABLE_VARIABLE, newTableSnapshot);
    LOG.info("Running query on previous state: " + queryWithPrevSnapshot);
    Dataset<Row> prevRows = sqlContext.sql(queryWithPrevSnapshot);
```

### DynamicRegexReplaceableByCompiledPattern
`replaceAll()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/validator/SqlQuerySingleResultPreCommitValidator.java`
#### Snippet
```java
    String expectedResult = queryWithExpectedResult[1];
    LOG.info("Running query on new state: " + queryToRun);
    String queryWithNewSnapshot = queryToRun.replaceAll(HoodiePreCommitValidatorConfig.VALIDATOR_TABLE_VARIABLE, newTableSnapshot);
    List<Row> newRows  = sqlContext.sql(queryWithNewSnapshot).collectAsList();
    if (newRows.size() != 1 && newRows.get(0).size() != 1) {
```

### DynamicRegexReplaceableByCompiledPattern
`replaceAll()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/validator/SqlQueryEqualityPreCommitValidator.java`
#### Snippet
```java
  @Override
  protected void validateUsingQuery(String query, String prevTableSnapshot, String newTableSnapshot, SQLContext sqlContext) {
    String queryWithPrevSnapshot = query.replaceAll(HoodiePreCommitValidatorConfig.VALIDATOR_TABLE_VARIABLE, prevTableSnapshot);
    String queryWithNewSnapshot = query.replaceAll(HoodiePreCommitValidatorConfig.VALIDATOR_TABLE_VARIABLE, newTableSnapshot);
    LOG.info("Running query on previous state: " + queryWithPrevSnapshot);
```

### DynamicRegexReplaceableByCompiledPattern
`replaceAll()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/validator/SqlQueryEqualityPreCommitValidator.java`
#### Snippet
```java
  protected void validateUsingQuery(String query, String prevTableSnapshot, String newTableSnapshot, SQLContext sqlContext) {
    String queryWithPrevSnapshot = query.replaceAll(HoodiePreCommitValidatorConfig.VALIDATOR_TABLE_VARIABLE, prevTableSnapshot);
    String queryWithNewSnapshot = query.replaceAll(HoodiePreCommitValidatorConfig.VALIDATOR_TABLE_VARIABLE, newTableSnapshot);
    LOG.info("Running query on previous state: " + queryWithPrevSnapshot);
    Dataset<Row> prevRows = sqlContext.sql(queryWithPrevSnapshot);
```

### DynamicRegexReplaceableByCompiledPattern
`replaceFirst()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/index/bucket/BucketIdentifier.java`
#### Snippet
```java

  public static String newBucketFileIdPrefix(String bucketId) {
    return FSUtils.createNewFileIdPfx().replaceFirst(".{8}", bucketId);
  }

```

### DynamicRegexReplaceableByCompiledPattern
`replace()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/compact/strategy/UnBoundedPartitionAwareCompactionStrategy.java`
#### Snippet
```java
  public List<String> filterPartitionPaths(HoodieWriteConfig writeConfig, List<String> partitionPaths) {
    List<String> allPartitionPaths =
        partitionPaths.stream().map(partition -> partition.replace("/", "-")).sorted(Comparator.reverseOrder())
            .map(partitionPath -> partitionPath.replace("-", "/")).collect(Collectors.toList());
    BoundedPartitionAwareCompactionStrategy boundedPartitionAwareCompactionStrategy =
```

### DynamicRegexReplaceableByCompiledPattern
`replace()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/compact/strategy/UnBoundedPartitionAwareCompactionStrategy.java`
#### Snippet
```java
    List<String> allPartitionPaths =
        partitionPaths.stream().map(partition -> partition.replace("/", "-")).sorted(Comparator.reverseOrder())
            .map(partitionPath -> partitionPath.replace("-", "/")).collect(Collectors.toList());
    BoundedPartitionAwareCompactionStrategy boundedPartitionAwareCompactionStrategy =
        new BoundedPartitionAwareCompactionStrategy();
```

### DynamicRegexReplaceableByCompiledPattern
`replaceFirst()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/compact/strategy/DayBasedCompactionStrategy.java`
#### Snippet
```java
  protected static String getPartitionPathWithoutPartitionKeys(String partitionPath) {
    if (partitionPath.contains("=")) {
      return partitionPath.replaceFirst(".*?=", "").replaceAll("/.*?=", "/");
    }
    return partitionPath;
```

### DynamicRegexReplaceableByCompiledPattern
`replaceAll()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/compact/strategy/DayBasedCompactionStrategy.java`
#### Snippet
```java
  protected static String getPartitionPathWithoutPartitionKeys(String partitionPath) {
    if (partitionPath.contains("=")) {
      return partitionPath.replaceFirst(".*?=", "").replaceAll("/.*?=", "/");
    }
    return partitionPath;
```

### DynamicRegexReplaceableByCompiledPattern
`replace()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/compact/strategy/DayBasedCompactionStrategy.java`
#### Snippet
```java
  @Override
  public List<String> filterPartitionPaths(HoodieWriteConfig writeConfig, List<String> allPartitionPaths) {
    return allPartitionPaths.stream().map(partition -> partition.replace("/", "-"))
        .sorted(Comparator.reverseOrder()).map(partitionPath -> partitionPath.replace("-", "/"))
        .collect(Collectors.toList()).subList(0, Math.min(allPartitionPaths.size(),
```

### DynamicRegexReplaceableByCompiledPattern
`replace()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/compact/strategy/DayBasedCompactionStrategy.java`
#### Snippet
```java
  public List<String> filterPartitionPaths(HoodieWriteConfig writeConfig, List<String> allPartitionPaths) {
    return allPartitionPaths.stream().map(partition -> partition.replace("/", "-"))
        .sorted(Comparator.reverseOrder()).map(partitionPath -> partitionPath.replace("-", "/"))
        .collect(Collectors.toList()).subList(0, Math.min(allPartitionPaths.size(),
            writeConfig.getTargetPartitionsPerDayBasedCompaction()));
```

### DynamicRegexReplaceableByCompiledPattern
`replace()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/compact/strategy/BoundedPartitionAwareCompactionStrategy.java`
#### Snippet
```java
        dateFormat.get().format(getDateAtOffsetFromToday(-1 * writeConfig.getTargetPartitionsPerDayBasedCompaction()));
    // Get all partitions and sort them
    return partitionPaths.stream().map(partition -> partition.replace("/", "-"))
        .sorted(Comparator.reverseOrder()).map(partitionPath -> partitionPath.replace("-", "/"))
        .filter(e -> DayBasedCompactionStrategy.comparator.compare(earliestPartitionPathToCompact, e) >= 0).collect(Collectors.toList());
```

### DynamicRegexReplaceableByCompiledPattern
`replace()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/compact/strategy/BoundedPartitionAwareCompactionStrategy.java`
#### Snippet
```java
    // Get all partitions and sort them
    return partitionPaths.stream().map(partition -> partition.replace("/", "-"))
        .sorted(Comparator.reverseOrder()).map(partitionPath -> partitionPath.replace("-", "/"))
        .filter(e -> DayBasedCompactionStrategy.comparator.compare(earliestPartitionPathToCompact, e) >= 0).collect(Collectors.toList());
  }
```

### DynamicRegexReplaceableByCompiledPattern
`split()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java`
#### Snippet
```java
  public List<String> getDatadogMetricTags() {
    return Arrays.stream(getStringOrDefault(
        HoodieMetricsDatadogConfig.METRIC_TAG_VALUES, ",").split("\\s*,\\s*")).collect(Collectors.toList());
  }

```

### DynamicRegexReplaceableByCompiledPattern
`split()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-common/src/main/java/org/apache/hudi/common/fs/inline/InLineFSUtils.java`
#### Snippet
```java
    assertInlineFSPath(inlineFSPath);

    String[] slices = inlineFSPath.toString().split("[?&=]");
    return Long.parseLong(slices[slices.length - 3]);
  }
```

### DynamicRegexReplaceableByCompiledPattern
`split()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-common/src/main/java/org/apache/hudi/common/fs/inline/InLineFSUtils.java`
#### Snippet
```java
    assertInlineFSPath(inlinePath);

    String[] slices = inlinePath.toString().split("[?&=]");
    return Long.parseLong(slices[slices.length - 1]);
  }
```

### DynamicRegexReplaceableByCompiledPattern
`replace()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-common/src/main/java/org/apache/hudi/avro/AvroSchemaCompatibility.java`
#### Snippet
```java
        }
        // Apply JSON pointer escaping.
        s.append(coordinate.replace("~", "~0").replace("/", "~1"));
      }
      return s.toString();
```

### DynamicRegexReplaceableByCompiledPattern
`replace()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-common/src/main/java/org/apache/hudi/avro/AvroSchemaCompatibility.java`
#### Snippet
```java
        }
        // Apply JSON pointer escaping.
        s.append(coordinate.replace("~", "~0").replace("/", "~1"));
      }
      return s.toString();
```

### DynamicRegexReplaceableByCompiledPattern
`replace()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-common/src/main/java/org/apache/hudi/common/fs/HoodieWrapperFileSystem.java`
#### Snippet
```java
    // Remove 'hoodie-' prefix from path
    if (path.toString().startsWith(HOODIE_SCHEME_PREFIX)) {
      path = new Path(path.toString().replace(HOODIE_SCHEME_PREFIX, ""));
      this.uri = path.toUri();
    } else {
```

### DynamicRegexReplaceableByCompiledPattern
`replace()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-common/src/main/java/org/apache/hudi/common/fs/FSUtils.java`
#### Snippet
```java
      if (prop.getKey().startsWith(HOODIE_ENV_PROPS_PREFIX)) {
        LOG.info("Picking up value for hoodie env var :" + prop.getKey());
        conf.set(prop.getKey().replace(HOODIE_ENV_PROPS_PREFIX, "").replaceAll("_DOT_", "."), prop.getValue());
      }
    }
```

### DynamicRegexReplaceableByCompiledPattern
`replaceAll()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-common/src/main/java/org/apache/hudi/common/fs/FSUtils.java`
#### Snippet
```java
      if (prop.getKey().startsWith(HOODIE_ENV_PROPS_PREFIX)) {
        LOG.info("Picking up value for hoodie env var :" + prop.getKey());
        conf.set(prop.getKey().replace(HOODIE_ENV_PROPS_PREFIX, "").replaceAll("_DOT_", "."), prop.getValue());
      }
    }
```

### DynamicRegexReplaceableByCompiledPattern
`matches()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-common/src/main/java/org/apache/hudi/avro/HoodieAvroUtils.java`
#### Snippet
```java
   */
  public static String sanitizeName(String name) {
    if (name.substring(0, 1).matches(INVALID_AVRO_FIRST_CHAR_IN_NAMES)) {
      name = name.replaceFirst(INVALID_AVRO_FIRST_CHAR_IN_NAMES, MASK_FOR_INVALID_CHARS_IN_NAMES);
    }
```

### DynamicRegexReplaceableByCompiledPattern
`replaceFirst()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-common/src/main/java/org/apache/hudi/avro/HoodieAvroUtils.java`
#### Snippet
```java
  public static String sanitizeName(String name) {
    if (name.substring(0, 1).matches(INVALID_AVRO_FIRST_CHAR_IN_NAMES)) {
      name = name.replaceFirst(INVALID_AVRO_FIRST_CHAR_IN_NAMES, MASK_FOR_INVALID_CHARS_IN_NAMES);
    }
    return name.replaceAll(INVALID_AVRO_CHARS_IN_NAMES, MASK_FOR_INVALID_CHARS_IN_NAMES);
```

### DynamicRegexReplaceableByCompiledPattern
`replaceAll()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-common/src/main/java/org/apache/hudi/avro/HoodieAvroUtils.java`
#### Snippet
```java
      name = name.replaceFirst(INVALID_AVRO_FIRST_CHAR_IN_NAMES, MASK_FOR_INVALID_CHARS_IN_NAMES);
    }
    return name.replaceAll(INVALID_AVRO_CHARS_IN_NAMES, MASK_FOR_INVALID_CHARS_IN_NAMES);
  }

```

### DynamicRegexReplaceableByCompiledPattern
`replace()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-common/src/main/java/org/apache/hudi/common/util/RocksDBSchemaHelper.java`
#### Snippet
```java

  public RocksDBSchemaHelper(HoodieTableMetaClient metaClient) {
    this.colFamilyForBootstrapBaseFile = "hudi_bootstrap_basefile_" + metaClient.getBasePath().replace("/", "_");
    this.colFamilyForPendingCompaction = "hudi_pending_compaction_" + metaClient.getBasePath().replace("/", "_");
    this.colFamilyForPendingLogCompaction = "hudi_pending_log_compaction_" + metaClient.getBasePath().replace("/", "_");
```

### DynamicRegexReplaceableByCompiledPattern
`replace()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-common/src/main/java/org/apache/hudi/common/util/RocksDBSchemaHelper.java`
#### Snippet
```java
  public RocksDBSchemaHelper(HoodieTableMetaClient metaClient) {
    this.colFamilyForBootstrapBaseFile = "hudi_bootstrap_basefile_" + metaClient.getBasePath().replace("/", "_");
    this.colFamilyForPendingCompaction = "hudi_pending_compaction_" + metaClient.getBasePath().replace("/", "_");
    this.colFamilyForPendingLogCompaction = "hudi_pending_log_compaction_" + metaClient.getBasePath().replace("/", "_");
    this.colFamilyForStoredPartitions = "hudi_partitions_" + metaClient.getBasePath().replace("/", "_");
```

### DynamicRegexReplaceableByCompiledPattern
`replace()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-common/src/main/java/org/apache/hudi/common/util/RocksDBSchemaHelper.java`
#### Snippet
```java
    this.colFamilyForBootstrapBaseFile = "hudi_bootstrap_basefile_" + metaClient.getBasePath().replace("/", "_");
    this.colFamilyForPendingCompaction = "hudi_pending_compaction_" + metaClient.getBasePath().replace("/", "_");
    this.colFamilyForPendingLogCompaction = "hudi_pending_log_compaction_" + metaClient.getBasePath().replace("/", "_");
    this.colFamilyForStoredPartitions = "hudi_partitions_" + metaClient.getBasePath().replace("/", "_");
    this.colFamilyForView = "hudi_view_" + metaClient.getBasePath().replace("/", "_");
```

### DynamicRegexReplaceableByCompiledPattern
`replace()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-common/src/main/java/org/apache/hudi/common/util/RocksDBSchemaHelper.java`
#### Snippet
```java
    this.colFamilyForPendingCompaction = "hudi_pending_compaction_" + metaClient.getBasePath().replace("/", "_");
    this.colFamilyForPendingLogCompaction = "hudi_pending_log_compaction_" + metaClient.getBasePath().replace("/", "_");
    this.colFamilyForStoredPartitions = "hudi_partitions_" + metaClient.getBasePath().replace("/", "_");
    this.colFamilyForView = "hudi_view_" + metaClient.getBasePath().replace("/", "_");
    this.colFamilyForReplacedFileGroups = "hudi_replaced_fg" + metaClient.getBasePath().replace("/", "_");
```

### DynamicRegexReplaceableByCompiledPattern
`replace()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-common/src/main/java/org/apache/hudi/common/util/RocksDBSchemaHelper.java`
#### Snippet
```java
    this.colFamilyForPendingLogCompaction = "hudi_pending_log_compaction_" + metaClient.getBasePath().replace("/", "_");
    this.colFamilyForStoredPartitions = "hudi_partitions_" + metaClient.getBasePath().replace("/", "_");
    this.colFamilyForView = "hudi_view_" + metaClient.getBasePath().replace("/", "_");
    this.colFamilyForReplacedFileGroups = "hudi_replaced_fg" + metaClient.getBasePath().replace("/", "_");
    this.colFamilyForPendingClusteringFileGroups = "hudi_pending_clustering_fg" + metaClient.getBasePath().replace("/", "_");
```

### DynamicRegexReplaceableByCompiledPattern
`replace()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-common/src/main/java/org/apache/hudi/common/util/RocksDBSchemaHelper.java`
#### Snippet
```java
    this.colFamilyForStoredPartitions = "hudi_partitions_" + metaClient.getBasePath().replace("/", "_");
    this.colFamilyForView = "hudi_view_" + metaClient.getBasePath().replace("/", "_");
    this.colFamilyForReplacedFileGroups = "hudi_replaced_fg" + metaClient.getBasePath().replace("/", "_");
    this.colFamilyForPendingClusteringFileGroups = "hudi_pending_clustering_fg" + metaClient.getBasePath().replace("/", "_");
  }
```

### DynamicRegexReplaceableByCompiledPattern
`replace()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-common/src/main/java/org/apache/hudi/common/util/RocksDBSchemaHelper.java`
#### Snippet
```java
    this.colFamilyForView = "hudi_view_" + metaClient.getBasePath().replace("/", "_");
    this.colFamilyForReplacedFileGroups = "hudi_replaced_fg" + metaClient.getBasePath().replace("/", "_");
    this.colFamilyForPendingClusteringFileGroups = "hudi_pending_clustering_fg" + metaClient.getBasePath().replace("/", "_");
  }

```

### DynamicRegexReplaceableByCompiledPattern
`replace()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/RocksDBDAO.java`
#### Snippet
```java
  public RocksDBDAO(String basePath, String rocksDBBasePath) {
    this.rocksDBBasePath =
        String.format("%s/%s/%s", rocksDBBasePath, basePath.replace("/", "_"), UUID.randomUUID().toString());
    init();
    totalBytesWritten = 0L;
```

### DynamicRegexReplaceableByCompiledPattern
`replace()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-common/src/main/java/org/apache/hudi/common/table/HoodieTableConfig.java`
#### Snippet
```java
    // There could be tables written with payload class from com.uber.hoodie. Need to transparently
    // change to org.apache.hudi
    return getStringOrDefault(PAYLOAD_CLASS_NAME).replace("com.uber.hoodie",
        "org.apache.hudi");
  }
```

### DynamicRegexReplaceableByCompiledPattern
`replaceFirst()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-common/src/main/java/org/apache/hudi/common/table/timeline/HoodieInstant.java`
#### Snippet
```java

    // Next read the action for this marker
    action = fileExtension.replaceFirst(".", "");
    if (action.equals("inflight")) {
      // This is to support backwards compatibility on how in-flight commit files were written
```

### DynamicRegexReplaceableByCompiledPattern
`replace()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-common/src/main/java/org/apache/hudi/common/table/timeline/HoodieInstant.java`
#### Snippet
```java
    } else if (action.contains(HoodieTimeline.INFLIGHT_EXTENSION)) {
      state = State.INFLIGHT;
      action = action.replace(HoodieTimeline.INFLIGHT_EXTENSION, "");
    } else if (action.contains(HoodieTimeline.REQUESTED_EXTENSION)) {
      state = State.REQUESTED;
```

### DynamicRegexReplaceableByCompiledPattern
`replace()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-common/src/main/java/org/apache/hudi/common/table/timeline/HoodieInstant.java`
#### Snippet
```java
    } else if (action.contains(HoodieTimeline.REQUESTED_EXTENSION)) {
      state = State.REQUESTED;
      action = action.replace(HoodieTimeline.REQUESTED_EXTENSION, "");
    }
  }
```

### DynamicRegexReplaceableByCompiledPattern
`replace()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-common/src/main/java/org/apache/hudi/common/table/timeline/HoodieTimeline.java`
#### Snippet
```java

  static String makeFileNameAsComplete(String fileName) {
    return fileName.replace(HoodieTimeline.INFLIGHT_EXTENSION, "");
  }

```

### DynamicRegexReplaceableByCompiledPattern
`replaceAll()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-common/src/main/java/org/apache/hudi/common/config/DFSPropertiesConfiguration.java`
#### Snippet
```java

  private String[] splitProperty(String line) {
    line = line.replaceAll("\\s+", " ");
    String delimiter = line.contains("=") ? "=" : " ";
    int ind = line.indexOf(delimiter);
```

### DynamicRegexReplaceableByCompiledPattern
`matches()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-common/src/main/java/org/apache/hudi/common/config/DFSPropertiesConfiguration.java`
#### Snippet
```java
      return false;
    }
    return line.contains("=") || line.matches(".*\\s.*");
  }
}
```

### DynamicRegexReplaceableByCompiledPattern
`replaceAll()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-examples/hudi-examples-common/src/main/java/org/apache/hudi/examples/common/HoodieExampleDataGenerator.java`
#### Snippet
```java
          .toString();
      str = "{" + str.substring(str.indexOf("\"ts\":"));
      return Option.of(str.replaceAll("}", ", \"partitionpath\": \"" + record.getPartitionPath() + "\"}"));
    } catch (IOException e) {
      return Option.empty();
```

### DynamicRegexReplaceableByCompiledPattern
`replaceAll()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/schema/converter/JsonToAvroSchemaConverter.java`
#### Snippet
```java

  private static String sanitizeAsAvroName(String s) {
    return s.replaceAll("[^A-Za-z0-9_]+", "_");
  }

```

### DynamicRegexReplaceableByCompiledPattern
`split()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/JdbcSource.java`
#### Snippet
```java
      String prop = property.toString();
      if (prop.startsWith(Config.EXTRA_OPTIONS)) {
        String key = String.join("", prop.split(Config.EXTRA_OPTIONS));
        String value = properties.getString(prop);
        if (!StringUtils.isNullOrEmpty(value)) {
```

### DynamicRegexReplaceableByCompiledPattern
`replace()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/helpers/S3EventsMetaSelector.java`
#### Snippet
```java

      for (Map<String, Object> eventRecord : eventRecords) {
        filteredEventRecords.add(new ObjectMapper().writeValueAsString(eventRecord).replace("%3D", "=")
            .replace("%24", "$").replace("%A3", "£").replace("%23", "#").replace("%26", "&").replace("%3F", "?")
            .replace("%7E", "~").replace("%25", "%").replace("%2B", "+"));
```

### DynamicRegexReplaceableByCompiledPattern
`replace()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/helpers/S3EventsMetaSelector.java`
#### Snippet
```java
      for (Map<String, Object> eventRecord : eventRecords) {
        filteredEventRecords.add(new ObjectMapper().writeValueAsString(eventRecord).replace("%3D", "=")
            .replace("%24", "$").replace("%A3", "£").replace("%23", "#").replace("%26", "&").replace("%3F", "?")
            .replace("%7E", "~").replace("%25", "%").replace("%2B", "+"));
      }
```

### DynamicRegexReplaceableByCompiledPattern
`replace()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/helpers/S3EventsMetaSelector.java`
#### Snippet
```java
      for (Map<String, Object> eventRecord : eventRecords) {
        filteredEventRecords.add(new ObjectMapper().writeValueAsString(eventRecord).replace("%3D", "=")
            .replace("%24", "$").replace("%A3", "£").replace("%23", "#").replace("%26", "&").replace("%3F", "?")
            .replace("%7E", "~").replace("%25", "%").replace("%2B", "+"));
      }
```

### DynamicRegexReplaceableByCompiledPattern
`replace()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/helpers/S3EventsMetaSelector.java`
#### Snippet
```java
      for (Map<String, Object> eventRecord : eventRecords) {
        filteredEventRecords.add(new ObjectMapper().writeValueAsString(eventRecord).replace("%3D", "=")
            .replace("%24", "$").replace("%A3", "£").replace("%23", "#").replace("%26", "&").replace("%3F", "?")
            .replace("%7E", "~").replace("%25", "%").replace("%2B", "+"));
      }
```

### DynamicRegexReplaceableByCompiledPattern
`replace()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/helpers/S3EventsMetaSelector.java`
#### Snippet
```java
      for (Map<String, Object> eventRecord : eventRecords) {
        filteredEventRecords.add(new ObjectMapper().writeValueAsString(eventRecord).replace("%3D", "=")
            .replace("%24", "$").replace("%A3", "£").replace("%23", "#").replace("%26", "&").replace("%3F", "?")
            .replace("%7E", "~").replace("%25", "%").replace("%2B", "+"));
      }
```

### DynamicRegexReplaceableByCompiledPattern
`replace()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/helpers/S3EventsMetaSelector.java`
#### Snippet
```java
      for (Map<String, Object> eventRecord : eventRecords) {
        filteredEventRecords.add(new ObjectMapper().writeValueAsString(eventRecord).replace("%3D", "=")
            .replace("%24", "$").replace("%A3", "£").replace("%23", "#").replace("%26", "&").replace("%3F", "?")
            .replace("%7E", "~").replace("%25", "%").replace("%2B", "+"));
      }
```

### DynamicRegexReplaceableByCompiledPattern
`replace()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/helpers/S3EventsMetaSelector.java`
#### Snippet
```java
        filteredEventRecords.add(new ObjectMapper().writeValueAsString(eventRecord).replace("%3D", "=")
            .replace("%24", "$").replace("%A3", "£").replace("%23", "#").replace("%26", "&").replace("%3F", "?")
            .replace("%7E", "~").replace("%25", "%").replace("%2B", "+"));
      }
      // Return the old checkpoint if no messages to consume from queue.
```

### DynamicRegexReplaceableByCompiledPattern
`replace()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/helpers/S3EventsMetaSelector.java`
#### Snippet
```java
        filteredEventRecords.add(new ObjectMapper().writeValueAsString(eventRecord).replace("%3D", "=")
            .replace("%24", "$").replace("%A3", "£").replace("%23", "#").replace("%26", "&").replace("%3F", "?")
            .replace("%7E", "~").replace("%25", "%").replace("%2B", "+"));
      }
      // Return the old checkpoint if no messages to consume from queue.
```

### DynamicRegexReplaceableByCompiledPattern
`replace()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/helpers/S3EventsMetaSelector.java`
#### Snippet
```java
        filteredEventRecords.add(new ObjectMapper().writeValueAsString(eventRecord).replace("%3D", "=")
            .replace("%24", "$").replace("%A3", "£").replace("%23", "#").replace("%26", "&").replace("%3F", "?")
            .replace("%7E", "~").replace("%25", "%").replace("%2B", "+"));
      }
      // Return the old checkpoint if no messages to consume from queue.
```

### DynamicRegexReplaceableByCompiledPattern
`replace()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/transform/SqlQueryBasedTransformer.java`
#### Snippet
```java

    // tmp table name doesn't like dashes
    String tmpTable = TMP_TABLE.concat(UUID.randomUUID().toString().replace("-", "_"));
    LOG.info("Registering tmp table : " + tmpTable);
    rowDataset.createOrReplaceTempView(tmpTable);
```

### DynamicRegexReplaceableByCompiledPattern
`replaceAll()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/transform/SqlQueryBasedTransformer.java`
#### Snippet
```java
    LOG.info("Registering tmp table : " + tmpTable);
    rowDataset.createOrReplaceTempView(tmpTable);
    String sqlStr = transformerSQL.replaceAll(SRC_PATTERN, tmpTable);
    LOG.debug("SQL Query for transformation : (" + sqlStr + ")");
    Dataset<Row> transformed = sparkSession.sql(sqlStr);
```

### DynamicRegexReplaceableByCompiledPattern
`replace()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/transform/FlatteningTransformer.java`
#### Snippet
```java

    // tmp table name doesn't like dashes
    String tmpTable = TMP_TABLE.concat(UUID.randomUUID().toString().replace("-", "_"));
    LOG.info("Registering tmp table : " + tmpTable);
    rowDataset.createOrReplaceTempView(tmpTable);
```

### DynamicRegexReplaceableByCompiledPattern
`replace()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/transform/FlatteningTransformer.java`
#### Snippet
```java
        selectSQLQuery.append(colName);
        selectSQLQuery.append(" as ");
        selectSQLQuery.append(colName.replace(".", "_"));
      }

```

### DynamicRegexReplaceableByCompiledPattern
`replace()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/transform/SqlFileBasedTransformer.java`
#### Snippet
```java
    final FileSystem fs = FSUtils.getFs(sqlFile, jsc.hadoopConfiguration(), true);
    // tmp table name doesn't like dashes
    final String tmpTable = TMP_TABLE.concat(UUID.randomUUID().toString().replace("-", "_"));
    LOG.info("Registering tmp table : " + tmpTable);
    rowDataset.createOrReplaceTempView(tmpTable);
```

### DynamicRegexReplaceableByCompiledPattern
`replaceAll()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/transform/SqlFileBasedTransformer.java`
#### Snippet
```java
      while (scanner.hasNext()) {
        String sqlStr = scanner.next();
        sqlStr = sqlStr.replaceAll(SRC_PATTERN, tmpTable).trim();
        if (!sqlStr.isEmpty()) {
          LOG.info(sqlStr);
```

### DynamicRegexReplaceableByCompiledPattern
`replaceAll()` could be replaced with compiled 'java.util.regex.Pattern' construct
in `hudi-spark-datasource/hudi-spark/src/main/java/org/apache/hudi/QuickstartUtils.java`
#### Snippet
```java
          .toString();
      str = "{" + str.substring(str.indexOf("\"ts\":"));
      return Option.of(str.replaceAll("}", ", \"partitionpath\": \"" + record.getPartitionPath() + "\"}"));
    } catch (IOException e) {
      return Option.empty();
```

## RuleId[ruleID=SuspiciousToArrayCall]
### SuspiciousToArrayCall
Array of type 'java.lang.Object\[\]' expected, 'java.lang.Comparable\[\]' found
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/ArchivedCommitsCommand.java`
#### Snippet
```java
      commitDetails.add(Option.ofNullable(record.get(metadataName)).orElse("{}").toString());
    }
    return commitDetails.toArray(new Comparable[commitDetails.size()]);
  }

```

### SuspiciousToArrayCall
Array of type 'org.apache.hadoop.mapred.InputSplit\[\]' expected, 'org.apache.hudi.hadoop.hive.HoodieCombineHiveInputFormat.CombineHiveInputSplit\[\]' found
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/hive/HoodieCombineHiveInputFormat.java`
#### Snippet
```java

    LOG.info("number of splits " + result.size());
    return result.toArray(new CombineHiveInputSplit[result.size()]);
  }

```

### SuspiciousToArrayCall
Array of type 'org.apache.hadoop.mapred.SplitLocationInfo\[\]' expected, 'java.lang.String\[\]' found
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/realtime/HoodieMergeOnReadTableInputFormat.java`
#### Snippet
```java
    try {
      String[] hosts = split.getLocationInfo() != null ? Arrays.stream(split.getLocationInfo())
          .filter(x -> !x.isInMemory()).toArray(String[]::new) : new String[0];
      String[] inMemoryHosts = split.getLocationInfo() != null ? Arrays.stream(split.getLocationInfo())
          .filter(SplitLocationInfo::isInMemory).toArray(String[]::new) : new String[0];
```

### SuspiciousToArrayCall
Array of type 'org.apache.hadoop.mapred.SplitLocationInfo\[\]' expected, 'java.lang.String\[\]' found
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/realtime/HoodieMergeOnReadTableInputFormat.java`
#### Snippet
```java
          .filter(x -> !x.isInMemory()).toArray(String[]::new) : new String[0];
      String[] inMemoryHosts = split.getLocationInfo() != null ? Arrays.stream(split.getLocationInfo())
          .filter(SplitLocationInfo::isInMemory).toArray(String[]::new) : new String[0];
      FileSplit baseSplit = new FileSplit(split.getPath(), split.getStart(), split.getLength(),
          hosts, inMemoryHosts);
```

## RuleId[ruleID=NonProtectedConstructorInAbstractClass]
### NonProtectedConstructorInAbstractClass
Constructor `LeafExpression()` of an abstract class should not be declared 'public'
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/expression/LeafExpression.java`
#### Snippet
```java
public abstract class LeafExpression extends Expression {

  public LeafExpression() {
    super(null);
  }
```

### NonProtectedConstructorInAbstractClass
Constructor `Expression()` of an abstract class should not be declared 'public'
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/expression/Expression.java`
#### Snippet
```java
  private final List<Expression> children;

  public Expression(List<Expression> children) {
    this.children = children;
  }
```

### NonProtectedConstructorInAbstractClass
Constructor `QueryBasedDDLExecutor()` of an abstract class should not be declared 'public'
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/ddl/QueryBasedDDLExecutor.java`
#### Snippet
```java
  protected final PartitionValueExtractor partitionValueExtractor;

  public QueryBasedDDLExecutor(HiveSyncConfig config) {
    this.config = config;
    this.databaseName = config.getStringOrDefault(META_SYNC_DATABASE_NAME);
```

### NonProtectedConstructorInAbstractClass
Constructor `HoodieSyncTool()` of an abstract class should not be declared 'public'
in `hudi-sync/hudi-sync-common/src/main/java/org/apache/hudi/sync/common/HoodieSyncTool.java`
#### Snippet
```java

  @Deprecated
  public HoodieSyncTool(Properties props, FileSystem fileSystem) {
    this(props, fileSystem.getConf());
  }
```

### NonProtectedConstructorInAbstractClass
Constructor `HoodieSyncTool()` of an abstract class should not be declared 'public'
in `hudi-sync/hudi-sync-common/src/main/java/org/apache/hudi/sync/common/HoodieSyncTool.java`
#### Snippet
```java
  protected Configuration hadoopConf;

  public HoodieSyncTool(Properties props) {
    this(props, ConfigUtils.createHadoopConf(props));
  }
```

### NonProtectedConstructorInAbstractClass
Constructor `HoodieSyncTool()` of an abstract class should not be declared 'public'
in `hudi-sync/hudi-sync-common/src/main/java/org/apache/hudi/sync/common/HoodieSyncTool.java`
#### Snippet
```java
  }

  public HoodieSyncTool(Properties props, Configuration hadoopConf) {
    this.props = props;
    this.hadoopConf = hadoopConf;
```

### NonProtectedConstructorInAbstractClass
Constructor `HoodieSyncTool()` of an abstract class should not be declared 'public'
in `hudi-sync/hudi-sync-common/src/main/java/org/apache/hudi/sync/common/HoodieSyncTool.java`
#### Snippet
```java

  @Deprecated
  public HoodieSyncTool(TypedProperties props, Configuration conf, FileSystem fs) {
    this(props, conf);
  }
```

### NonProtectedConstructorInAbstractClass
Constructor `HoodieSyncClient()` of an abstract class should not be declared 'public'
in `hudi-sync/hudi-sync-common/src/main/java/org/apache/hudi/sync/common/HoodieSyncClient.java`
#### Snippet
```java
  protected final HoodieTableMetaClient metaClient;

  public HoodieSyncClient(HoodieSyncConfig config) {
    this.config = config;
    this.partitionValueExtractor = ReflectionUtils.loadClass(config.getStringOrDefault(META_SYNC_PARTITION_EXTRACTOR_CLASS));
```

### NonProtectedConstructorInAbstractClass
Constructor `BaseJavaDeltaCommitActionExecutor()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/table/action/deltacommit/BaseJavaDeltaCommitActionExecutor.java`
#### Snippet
```java
public abstract class BaseJavaDeltaCommitActionExecutor<T> extends BaseJavaCommitActionExecutor<T> {

  public BaseJavaDeltaCommitActionExecutor(HoodieEngineContext context, HoodieWriteConfig config, HoodieTable table,
                                           String instantTime, WriteOperationType operationType) {
    super(context, config, table, instantTime, operationType);
```

### NonProtectedConstructorInAbstractClass
Constructor `JavaExecutionStrategy()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/client/clustering/run/strategy/JavaExecutionStrategy.java`
#### Snippet
```java
  private static final Logger LOG = LogManager.getLogger(JavaExecutionStrategy.class);

  public JavaExecutionStrategy(
      HoodieTable table, HoodieEngineContext engineContext, HoodieWriteConfig writeConfig) {
    super(table, engineContext, writeConfig);
```

### NonProtectedConstructorInAbstractClass
Constructor `BaseJavaCommitActionExecutor()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/table/action/commit/BaseJavaCommitActionExecutor.java`
#### Snippet
```java
  private static final Logger LOG = LogManager.getLogger(BaseJavaCommitActionExecutor.class);

  public BaseJavaCommitActionExecutor(HoodieEngineContext context,
                                       HoodieWriteConfig config,
                                       HoodieTable table,
```

### NonProtectedConstructorInAbstractClass
Constructor `BaseJavaCommitActionExecutor()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/table/action/commit/BaseJavaCommitActionExecutor.java`
#### Snippet
```java
  }

  public BaseJavaCommitActionExecutor(HoodieEngineContext context,
                                       HoodieWriteConfig config,
                                       HoodieTable table,
```

### NonProtectedConstructorInAbstractClass
Constructor `BaseFlinkDeltaCommitActionExecutor()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/table/action/commit/delta/BaseFlinkDeltaCommitActionExecutor.java`
#### Snippet
```java
    extends BaseFlinkCommitActionExecutor<T> {

  public BaseFlinkDeltaCommitActionExecutor(HoodieEngineContext context,
                                            FlinkAppendHandle<?, ?, ?, ?> writeHandle,
                                            HoodieWriteConfig config,
```

### NonProtectedConstructorInAbstractClass
Constructor `AbstractHoodieRowData()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/client/model/AbstractHoodieRowData.java`
#### Snippet
```java
  protected final int metaColumnsNum;

  public AbstractHoodieRowData(String commitTime,
                               String commitSeqNumber,
                               String recordKey,
```

### NonProtectedConstructorInAbstractClass
Constructor `BaseFlinkCommitActionExecutor()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/table/action/commit/BaseFlinkCommitActionExecutor.java`
#### Snippet
```java
  protected HoodieWriteHandle<?, ?, ?, ?> writeHandle;

  public BaseFlinkCommitActionExecutor(HoodieEngineContext context,
                                       HoodieWriteHandle<?, ?, ?, ?> writeHandle,
                                       HoodieWriteConfig config,
```

### NonProtectedConstructorInAbstractClass
Constructor `BaseFlinkCommitActionExecutor()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/table/action/commit/BaseFlinkCommitActionExecutor.java`
#### Snippet
```java
  }

  public BaseFlinkCommitActionExecutor(HoodieEngineContext context,
                                       HoodieWriteHandle<?, ?, ?, ?> writeHandle,
                                       HoodieWriteConfig config,
```

### NonProtectedConstructorInAbstractClass
Constructor `SparkHoodiePartitioner()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/table/action/commit/SparkHoodiePartitioner.java`
#### Snippet
```java
  protected final HoodieTable table;

  public SparkHoodiePartitioner(WorkloadProfile profile, HoodieTable table) {
    this.profile = profile;
    this.table = table;
```

### NonProtectedConstructorInAbstractClass
Constructor `BaseBootstrapMetadataHandler()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/table/action/bootstrap/BaseBootstrapMetadataHandler.java`
#### Snippet
```java
  protected HoodieFileStatus srcFileStatus;

  public BaseBootstrapMetadataHandler(HoodieWriteConfig config, HoodieTable table, HoodieFileStatus srcFileStatus) {
    this.config = config;
    this.table = table;
```

### NonProtectedConstructorInAbstractClass
Constructor `BaseSparkDeltaCommitActionExecutor()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/table/action/deltacommit/BaseSparkDeltaCommitActionExecutor.java`
#### Snippet
```java
  private SparkUpsertDeltaCommitPartitioner<T> mergeOnReadUpsertPartitioner;

  public BaseSparkDeltaCommitActionExecutor(HoodieSparkEngineContext context, HoodieWriteConfig config, HoodieTable table,
                                                String instantTime, WriteOperationType operationType) {
    this(context, config, table, instantTime, operationType, Option.empty());
```

### NonProtectedConstructorInAbstractClass
Constructor `BaseSparkDeltaCommitActionExecutor()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/table/action/deltacommit/BaseSparkDeltaCommitActionExecutor.java`
#### Snippet
```java
  }

  public BaseSparkDeltaCommitActionExecutor(HoodieSparkEngineContext context, HoodieWriteConfig config, HoodieTable table,
                                                String instantTime, WriteOperationType operationType,
                                                Option<Map<String, String>> extraMetadata) {
```

### NonProtectedConstructorInAbstractClass
Constructor `SqlQueryPreCommitValidator()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/validator/SqlQueryPreCommitValidator.java`
#### Snippet
```java
  private static final AtomicInteger TABLE_COUNTER = new AtomicInteger(0);

  public SqlQueryPreCommitValidator(HoodieSparkTable<T> table, HoodieEngineContext engineContext, HoodieWriteConfig config) {
    super(table, engineContext, config);
  }
```

### NonProtectedConstructorInAbstractClass
Constructor `SingleSparkJobExecutionStrategy()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/clustering/run/strategy/SingleSparkJobExecutionStrategy.java`
#### Snippet
```java
  private static final Logger LOG = LogManager.getLogger(SingleSparkJobExecutionStrategy.class);

  public SingleSparkJobExecutionStrategy(HoodieTable table, HoodieEngineContext engineContext, HoodieWriteConfig writeConfig) {
    super(table, engineContext, writeConfig);
  }
```

### NonProtectedConstructorInAbstractClass
Constructor `BaseSparkCommitActionExecutor()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/table/action/commit/BaseSparkCommitActionExecutor.java`
#### Snippet
```java
  }

  public BaseSparkCommitActionExecutor(HoodieEngineContext context,
                                       HoodieWriteConfig config,
                                       HoodieTable table,
```

### NonProtectedConstructorInAbstractClass
Constructor `BaseSparkCommitActionExecutor()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/table/action/commit/BaseSparkCommitActionExecutor.java`
#### Snippet
```java
  protected final Option<BaseKeyGenerator> keyGeneratorOpt;

  public BaseSparkCommitActionExecutor(HoodieEngineContext context,
                                       HoodieWriteConfig config,
                                       HoodieTable table,
```

### NonProtectedConstructorInAbstractClass
Constructor `BaseSparkUpdateStrategy()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/clustering/update/strategy/BaseSparkUpdateStrategy.java`
#### Snippet
```java
public abstract class BaseSparkUpdateStrategy<T> extends UpdateStrategy<T, HoodieData<HoodieRecord<T>>> {

  public BaseSparkUpdateStrategy(HoodieEngineContext engineContext, HoodieTable table,
                                 Set<HoodieFileGroupId> fileGroupsInPendingClustering) {
    super(engineContext, table, fileGroupsInPendingClustering);
```

### NonProtectedConstructorInAbstractClass
Constructor `MultipleSparkJobExecutionStrategy()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/clustering/run/strategy/MultipleSparkJobExecutionStrategy.java`
#### Snippet
```java
  private static final Logger LOG = LogManager.getLogger(MultipleSparkJobExecutionStrategy.class);

  public MultipleSparkJobExecutionStrategy(HoodieTable table, HoodieEngineContext engineContext, HoodieWriteConfig writeConfig) {
    super(table, engineContext, writeConfig);
  }
```

### NonProtectedConstructorInAbstractClass
Constructor `SpatialCurveSortPartitionerBase()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/execution/bulkinsert/SpatialCurveSortPartitionerBase.java`
#### Snippet
```java
  }

  public SpatialCurveSortPartitionerBase(String[] orderByColumns,
                                         HoodieClusteringConfig.LayoutOptimizationStrategy layoutOptStrategy,
                                         HoodieClusteringConfig.SpatialCurveCompositionStrategyType curveCompositionStrategyType) {
```

### NonProtectedConstructorInAbstractClass
Constructor `SpatialCurveSortPartitionerBase()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/execution/bulkinsert/SpatialCurveSortPartitionerBase.java`
#### Snippet
```java
  private final HoodieClusteringConfig.SpatialCurveCompositionStrategyType curveCompositionStrategyType;

  public SpatialCurveSortPartitionerBase(String orderByColumns,
                                         HoodieClusteringConfig.LayoutOptimizationStrategy layoutOptStrategy,
                                         HoodieClusteringConfig.SpatialCurveCompositionStrategyType curveCompositionStrategyType) {
```

### NonProtectedConstructorInAbstractClass
Constructor `HoodieReadHandle()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/io/HoodieReadHandle.java`
#### Snippet
```java
  protected final Pair<String, String> partitionPathFileIDPair;

  public HoodieReadHandle(HoodieWriteConfig config, HoodieTable<T, I, K, O> hoodieTable,
                          Pair<String, String> partitionPathFileIDPair) {
    super(config, Option.empty(), hoodieTable);
```

### NonProtectedConstructorInAbstractClass
Constructor `HoodieWriteHandle()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/io/HoodieWriteHandle.java`
#### Snippet
```java
  protected final boolean schemaOnReadEnabled;

  public HoodieWriteHandle(HoodieWriteConfig config, String instantTime, String partitionPath,
                           String fileId, HoodieTable<T, I, K, O> hoodieTable, TaskContextSupplier taskContextSupplier) {
    this(config, instantTime, partitionPath, fileId, hoodieTable,
```

### NonProtectedConstructorInAbstractClass
Constructor `AsyncCompactService()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/async/AsyncCompactService.java`
#### Snippet
```java
  }

  public AsyncCompactService(HoodieEngineContext context, BaseHoodieWriteClient client, boolean runInDaemonMode) {
    super(client.getConfig(), runInDaemonMode);
    this.context = context;
```

### NonProtectedConstructorInAbstractClass
Constructor `AsyncCompactService()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/async/AsyncCompactService.java`
#### Snippet
```java
  private transient BaseCompactor compactor;

  public AsyncCompactService(HoodieEngineContext context, BaseHoodieWriteClient client) {
    this(context, client, false);
  }
```

### NonProtectedConstructorInAbstractClass
Constructor `AsyncClusteringService()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/async/AsyncClusteringService.java`
#### Snippet
```java
  private transient BaseClusterer clusteringClient;

  public AsyncClusteringService(HoodieEngineContext context, BaseHoodieWriteClient writeClient) {
    this(context, writeClient, false);
  }
```

### NonProtectedConstructorInAbstractClass
Constructor `AsyncClusteringService()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/async/AsyncClusteringService.java`
#### Snippet
```java
  }

  public AsyncClusteringService(HoodieEngineContext context, BaseHoodieWriteClient writeClient, boolean runInDaemonMode) {
    super(writeClient.getConfig(), runInDaemonMode);
    this.clusteringClient = createClusteringClient(writeClient);
```

### NonProtectedConstructorInAbstractClass
Constructor `HoodieBucketIndex()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/index/bucket/HoodieBucketIndex.java`
#### Snippet
```java
  protected final List<String> indexKeyFields;

  public HoodieBucketIndex(HoodieWriteConfig config) {
    super(config);

```

### NonProtectedConstructorInAbstractClass
Constructor `FileIdPrefixProvider()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/FileIdPrefixProvider.java`
#### Snippet
```java
  private final TypedProperties props;

  public FileIdPrefixProvider(TypedProperties props) {
    this.props = props;
  }
```

### NonProtectedConstructorInAbstractClass
Constructor `BaseActionExecutor()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/BaseActionExecutor.java`
#### Snippet
```java
  protected final String instantTime;

  public BaseActionExecutor(HoodieEngineContext context, HoodieWriteConfig config, HoodieTable<T, I, K, O> table, String instantTime) {
    this.context = context;
    this.hadoopConf = context.getHadoopConf().get();
```

### NonProtectedConstructorInAbstractClass
Constructor `UpdateStrategy()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/cluster/strategy/UpdateStrategy.java`
#### Snippet
```java
  protected final Set<HoodieFileGroupId> fileGroupsInPendingClustering;

  public UpdateStrategy(HoodieEngineContext engineContext, HoodieTable table, Set<HoodieFileGroupId> fileGroupsInPendingClustering) {
    this.engineContext = engineContext;
    this.table = table;
```

### NonProtectedConstructorInAbstractClass
Constructor `ClusteringExecutionStrategy()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/cluster/strategy/ClusteringExecutionStrategy.java`
#### Snippet
```java
  protected final HoodieRecordType recordType;

  public ClusteringExecutionStrategy(HoodieTable table, HoodieEngineContext engineContext, HoodieWriteConfig writeConfig) {
    this.writeConfig = writeConfig;
    this.hoodieTable = table;
```

### NonProtectedConstructorInAbstractClass
Constructor `PartitionAwareClusteringPlanStrategy()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/cluster/strategy/PartitionAwareClusteringPlanStrategy.java`
#### Snippet
```java
  private static final Logger LOG = LogManager.getLogger(PartitionAwareClusteringPlanStrategy.class);

  public PartitionAwareClusteringPlanStrategy(HoodieTable table, HoodieEngineContext engineContext, HoodieWriteConfig writeConfig) {
    super(table, engineContext, writeConfig);
  }
```

### NonProtectedConstructorInAbstractClass
Constructor `ClusteringPlanStrategy()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/cluster/strategy/ClusteringPlanStrategy.java`
#### Snippet
```java
  }

  public ClusteringPlanStrategy(HoodieTable table, HoodieEngineContext engineContext, HoodieWriteConfig writeConfig) {
    this.writeConfig = writeConfig;
    this.hoodieTable = table;
```

### NonProtectedConstructorInAbstractClass
Constructor `BaseHoodieCompactionPlanGenerator()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/compact/plan/generators/BaseHoodieCompactionPlanGenerator.java`
#### Snippet
```java
  protected final transient HoodieEngineContext engineContext;

  public BaseHoodieCompactionPlanGenerator(HoodieTable table, HoodieEngineContext engineContext, HoodieWriteConfig writeConfig) {
    this.hoodieTable = table;
    this.writeConfig = writeConfig;
```

### NonProtectedConstructorInAbstractClass
Constructor `BaseCommitActionExecutor()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/commit/BaseCommitActionExecutor.java`
#### Snippet
```java
  protected Set<String> pendingInflightAndRequestedInstants;

  public BaseCommitActionExecutor(HoodieEngineContext context, HoodieWriteConfig config,
                                  HoodieTable<T, I, K, O> table, String instantTime, WriteOperationType operationType,
                                  Option<Map<String, String>> extraMetadata) {
```

### NonProtectedConstructorInAbstractClass
Constructor `BaseRestoreActionExecutor()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/restore/BaseRestoreActionExecutor.java`
#### Snippet
```java
  private final TransactionManager txnManager;

  public BaseRestoreActionExecutor(HoodieEngineContext context,
                                   HoodieWriteConfig config,
                                   HoodieTable<T, I, K, O> table,
```

### NonProtectedConstructorInAbstractClass
Constructor `HoodieStorageLayout()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/storage/HoodieStorageLayout.java`
#### Snippet
```java
  protected final HoodieWriteConfig config;

  public HoodieStorageLayout(HoodieWriteConfig config) {
    this.config = config;
  }
```

### NonProtectedConstructorInAbstractClass
Constructor `WriteMarkers()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/marker/WriteMarkers.java`
#### Snippet
```java
  protected final String instantTime;

  public WriteMarkers(String basePath, String markerFolderPath, String instantTime) {
    this.basePath = basePath;
    this.markerDirPath = new Path(markerFolderPath);
```

### NonProtectedConstructorInAbstractClass
Constructor `BaseClusterer()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/BaseClusterer.java`
#### Snippet
```java
  protected transient BaseHoodieWriteClient<T, I, K, O> clusteringClient;

  public BaseClusterer(BaseHoodieWriteClient<T, I, K, O> clusteringClient) {
    this.clusteringClient = clusteringClient;
  }
```

### NonProtectedConstructorInAbstractClass
Constructor `BaseCompactor()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/BaseCompactor.java`
#### Snippet
```java
  protected transient BaseHoodieWriteClient<T, I, K, O> compactionClient;

  public BaseCompactor(BaseHoodieWriteClient<T, I, K, O> compactionClient) {
    this.compactionClient = compactionClient;
  }
```

### NonProtectedConstructorInAbstractClass
Constructor `BaseRollbackActionExecutor()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/rollback/BaseRollbackActionExecutor.java`
#### Snippet
```java
  }

  public BaseRollbackActionExecutor(HoodieEngineContext context,
      HoodieWriteConfig config,
      HoodieTable<T, I, K, O> table,
```

### NonProtectedConstructorInAbstractClass
Constructor `BaseRollbackActionExecutor()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/rollback/BaseRollbackActionExecutor.java`
#### Snippet
```java
  protected HoodieInstant resolvedInstant;

  public BaseRollbackActionExecutor(HoodieEngineContext context,
                                    HoodieWriteConfig config,
                                    HoodieTable<T, I, K, O> table,
```

### NonProtectedConstructorInAbstractClass
Constructor `LazyIterableIterator()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/utils/LazyIterableIterator.java`
#### Snippet
```java
  private boolean endCalled = false;

  public LazyIterableIterator(Iterator<I> in) {
    inputItr = in;
  }
```

### NonProtectedConstructorInAbstractClass
Constructor `FullRecordBootstrapDataProvider()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/bootstrap/FullRecordBootstrapDataProvider.java`
#### Snippet
```java
  protected final transient HoodieEngineContext context;

  public FullRecordBootstrapDataProvider(TypedProperties props, HoodieEngineContext context) {
    this.props = props;
    this.context = context;
```

### NonProtectedConstructorInAbstractClass
Constructor `HoodieBootstrapSchemaProvider()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/bootstrap/HoodieBootstrapSchemaProvider.java`
#### Snippet
```java
  protected final HoodieWriteConfig writeConfig;

  public HoodieBootstrapSchemaProvider(HoodieWriteConfig writeConfig) {
    this.writeConfig = writeConfig;
  }
```

### NonProtectedConstructorInAbstractClass
Constructor `BootstrapPartitionPathTranslator()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/bootstrap/translator/BootstrapPartitionPathTranslator.java`
#### Snippet
```java
  private final TypedProperties properties;

  public BootstrapPartitionPathTranslator(TypedProperties properties) {
    this.properties = properties;
  }
```

### NonProtectedConstructorInAbstractClass
Constructor `BootstrapModeSelector()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/bootstrap/selector/BootstrapModeSelector.java`
#### Snippet
```java
  protected final HoodieWriteConfig writeConfig;

  public BootstrapModeSelector(HoodieWriteConfig writeConfig) {
    this.writeConfig = writeConfig;
  }
```

### NonProtectedConstructorInAbstractClass
Constructor `UniformBootstrapModeSelector()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/bootstrap/selector/UniformBootstrapModeSelector.java`
#### Snippet
```java
  private final BootstrapMode bootstrapMode;

  public UniformBootstrapModeSelector(HoodieWriteConfig bootstrapConfig, BootstrapMode bootstrapMode) {
    super(bootstrapConfig);
    this.bootstrapMode = bootstrapMode;
```

### NonProtectedConstructorInAbstractClass
Constructor `BaseHoodieDateTimeParser()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/keygen/parser/BaseHoodieDateTimeParser.java`
#### Snippet
```java
  protected final String configInputDateFormatDelimiter;

  public BaseHoodieDateTimeParser(TypedProperties config) {
    this.config = config;
    this.configInputDateFormatDelimiter = initInputDateFormatDelimiter();
```

### NonProtectedConstructorInAbstractClass
Constructor `CustomizableMetricsReporter()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metrics/custom/CustomizableMetricsReporter.java`
#### Snippet
```java
  private MetricRegistry registry;

  public CustomizableMetricsReporter(Properties props, MetricRegistry registry) {
    this.props = props;
    this.registry = registry;
```

### NonProtectedConstructorInAbstractClass
Constructor `AbstractUserDefinedMetricsReporter()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metrics/userdefined/AbstractUserDefinedMetricsReporter.java`
#### Snippet
```java
public abstract class AbstractUserDefinedMetricsReporter extends CustomizableMetricsReporter {

  public AbstractUserDefinedMetricsReporter(Properties props, MetricRegistry registry) {
    super(props, registry);
  }
```

### NonProtectedConstructorInAbstractClass
Constructor `HoodieLazyInsertIterable()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/execution/HoodieLazyInsertIterable.java`
#### Snippet
```java
  }

  public HoodieLazyInsertIterable(Iterator<HoodieRecord<T>> recordItr, boolean areRecordsSorted,
                                  HoodieWriteConfig config, String instantTime, HoodieTable hoodieTable,
                                  String idPrefix, TaskContextSupplier taskContextSupplier,
```

### NonProtectedConstructorInAbstractClass
Constructor `HoodieLazyInsertIterable()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/execution/HoodieLazyInsertIterable.java`
#### Snippet
```java
  protected WriteHandleFactory writeHandleFactory;

  public HoodieLazyInsertIterable(Iterator<HoodieRecord<T>> recordItr,
                                  boolean areRecordsSorted,
                                  HoodieWriteConfig config,
```

### NonProtectedConstructorInAbstractClass
Constructor `HoodieBaseParquetWriter()` of an abstract class should not be declared 'public'
in `hudi-common/src/main/java/org/apache/hudi/io/storage/HoodieBaseParquetWriter.java`
#### Snippet
```java
  private long lastCachedDataSize = -1;

  public HoodieBaseParquetWriter(Path file,
                                 HoodieParquetConfig<? extends WriteSupport<R>> parquetConfig) throws IOException {
    super(HoodieWrapperFileSystem.convertToHoodiePath(file, parquetConfig.getHadoopConf()),
```

### NonProtectedConstructorInAbstractClass
Constructor `HoodieBloomFilterWriteSupport()` of an abstract class should not be declared 'public'
in `hudi-common/src/main/java/org/apache/hudi/avro/HoodieBloomFilterWriteSupport.java`
#### Snippet
```java
  private T maxRecordKey;

  public HoodieBloomFilterWriteSupport(BloomFilter bloomFilter) {
    this.bloomFilter = bloomFilter;
  }
```

### NonProtectedConstructorInAbstractClass
Constructor `BaseHoodieTableFileIndex()` of an abstract class should not be declared 'public'
in `hudi-common/src/main/java/org/apache/hudi/BaseHoodieTableFileIndex.java`
#### Snippet
```java
   * @param fileStatusCache transient cache of fetched [[FileStatus]]es
   */
  public BaseHoodieTableFileIndex(HoodieEngineContext engineContext,
                                  HoodieTableMetaClient metaClient,
                                  TypedProperties configProperties,
```

### NonProtectedConstructorInAbstractClass
Constructor `HoodieBackedTableMetadataWriter()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metadata/HoodieBackedTableMetadataWriter.java`
#### Snippet
```java
  }

  public HoodieBackedTableMetadataWriter(Configuration hadoopConf, HoodieWriteConfig writeConfig,
                                         HoodieEngineContext engineContext) {
    this(hadoopConf, writeConfig, EAGER, engineContext, Option.empty(), Option.empty());
```

### NonProtectedConstructorInAbstractClass
Constructor `BaseHoodieWriteClient()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/BaseHoodieWriteClient.java`
#### Snippet
```java
   */
  @Deprecated
  public BaseHoodieWriteClient(HoodieEngineContext context,
                               HoodieWriteConfig writeConfig,
                               SupportsUpgradeDowngrade upgradeDowngradeHelper) {
```

### NonProtectedConstructorInAbstractClass
Constructor `BaseHoodieWriteClient()` of an abstract class should not be declared 'public'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/BaseHoodieWriteClient.java`
#### Snippet
```java
   */
  @Deprecated
  public BaseHoodieWriteClient(HoodieEngineContext context,
                               HoodieWriteConfig writeConfig,
                               Option<EmbeddedTimelineService> timelineService,
```

### NonProtectedConstructorInAbstractClass
Constructor `BaseHoodieQueueBasedExecutor()` of an abstract class should not be declared 'public'
in `hudi-common/src/main/java/org/apache/hudi/common/util/queue/BaseHoodieQueueBasedExecutor.java`
#### Snippet
```java
  protected final Option<HoodieConsumer<O, E>> consumer;

  public BaseHoodieQueueBasedExecutor(List<HoodieProducer<I>> producers,
                                      Option<HoodieConsumer<O, E>> consumer,
                                      HoodieMessageQueue<I, O> queue,
```

### NonProtectedConstructorInAbstractClass
Constructor `DiskMap()` of an abstract class should not be declared 'public'
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/DiskMap.java`
#### Snippet
```java
  protected final String diskMapPath;

  public DiskMap(String basePath, String prefix) throws IOException {
    this.diskMapPath =
        String.format("%s/%s-%s-%s", basePath, SUBFOLDER_PREFIX, prefix, UUID.randomUUID().toString());
```

### NonProtectedConstructorInAbstractClass
Constructor `BaseAvroPayload()` of an abstract class should not be declared 'public'
in `hudi-common/src/main/java/org/apache/hudi/common/model/BaseAvroPayload.java`
#### Snippet
```java
   * @param orderingVal {@link Comparable} to be used in pre combine.
   */
  public BaseAvroPayload(GenericRecord record, Comparable orderingVal) {
    this.recordBytes = record != null ? HoodieAvroUtils.avroToBytes(record) : new byte[0];
    this.orderingVal = orderingVal;
```

### NonProtectedConstructorInAbstractClass
Constructor `AbstractDebeziumAvroPayload()` of an abstract class should not be declared 'public'
in `hudi-common/src/main/java/org/apache/hudi/common/model/debezium/AbstractDebeziumAvroPayload.java`
#### Snippet
```java
  }

  public AbstractDebeziumAvroPayload(Option<GenericRecord> record) {
    super(record);
  }
```

### NonProtectedConstructorInAbstractClass
Constructor `AbstractDebeziumAvroPayload()` of an abstract class should not be declared 'public'
in `hudi-common/src/main/java/org/apache/hudi/common/model/debezium/AbstractDebeziumAvroPayload.java`
#### Snippet
```java
  private static final Logger LOG = LogManager.getLogger(AbstractDebeziumAvroPayload.class);

  public AbstractDebeziumAvroPayload(GenericRecord record, Comparable orderingVal) {
    super(record, orderingVal);
  }
```

### NonProtectedConstructorInAbstractClass
Constructor `HoodieRecord()` of an abstract class should not be declared 'public'
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieRecord.java`
#### Snippet
```java
  }

  public HoodieRecord(HoodieKey key, T data, HoodieOperation operation, Option<Map<String, String>> metaData) {
    this.key = key;
    this.data = data;
```

### NonProtectedConstructorInAbstractClass
Constructor `HoodieRecord()` of an abstract class should not be declared 'public'
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieRecord.java`
#### Snippet
```java
  }

  public HoodieRecord(HoodieRecord<T> record) {
    this(record.key, record.data, record.operation, record.metaData);
    this.currentLocation = record.currentLocation;
```

### NonProtectedConstructorInAbstractClass
Constructor `HoodieRecord()` of an abstract class should not be declared 'public'
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieRecord.java`
#### Snippet
```java
  protected Option<Map<String, String>> metaData;

  public HoodieRecord(HoodieKey key, T data) {
    this(key, data, null, Option.empty());
  }
```

### NonProtectedConstructorInAbstractClass
Constructor `HoodieRecord()` of an abstract class should not be declared 'public'
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieRecord.java`
#### Snippet
```java
  }

  public HoodieRecord() {}

  public abstract HoodieRecord<T> newInstance();
```

### NonProtectedConstructorInAbstractClass
Constructor `HoodieRecord()` of an abstract class should not be declared 'public'
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieRecord.java`
#### Snippet
```java
  }

  public HoodieRecord(
      HoodieKey key,
      T data,
```

### NonProtectedConstructorInAbstractClass
Constructor `InstantRange()` of an abstract class should not be declared 'public'
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/InstantRange.java`
#### Snippet
```java
  protected final String endInstant;

  public InstantRange(String startInstant, String endInstant) {
    this.startInstant = startInstant;
    this.endInstant = endInstant;
```

### NonProtectedConstructorInAbstractClass
Constructor `HoodieLogBlock()` of an abstract class should not be declared 'public'
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/block/HoodieLogBlock.java`
#### Snippet
```java
  protected boolean readBlockLazily;

  public HoodieLogBlock(
      @Nonnull Map<HeaderMetadataType, String> logBlockHeader,
      @Nonnull Map<HeaderMetadataType, String> logBlockFooter,
```

### NonProtectedConstructorInAbstractClass
Constructor `HoodieDataBlock()` of an abstract class should not be declared 'public'
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/block/HoodieDataBlock.java`
#### Snippet
```java
   * NOTE: This ctor is used on the write-path (ie when records ought to be written into the log)
   */
  public HoodieDataBlock(List<HoodieRecord> records,
                         Map<HeaderMetadataType, String> header,
                         Map<HeaderMetadataType, String> footer,
```

### NonProtectedConstructorInAbstractClass
Constructor `AbstractMigratorBase()` of an abstract class should not be declared 'public'
in `hudi-common/src/main/java/org/apache/hudi/common/table/timeline/versioning/AbstractMigratorBase.java`
#### Snippet
```java
  protected final HoodieTableMetaClient metaClient;

  public AbstractMigratorBase(HoodieTableMetaClient metaClient) {
    this.metaClient = metaClient;
  }
```

### NonProtectedConstructorInAbstractClass
Constructor `HoodieEngineContext()` of an abstract class should not be declared 'public'
in `hudi-common/src/main/java/org/apache/hudi/common/engine/HoodieEngineContext.java`
#### Snippet
```java
  protected TaskContextSupplier taskContextSupplier;

  public HoodieEngineContext(SerializableConfiguration hadoopConf, TaskContextSupplier taskContextSupplier) {
    this.hadoopConf = hadoopConf;
    this.taskContextSupplier = taskContextSupplier;
```

### NonProtectedConstructorInAbstractClass
Constructor `TimelineServerBasedDetectionStrategy()` of an abstract class should not be declared 'public'
in `hudi-common/src/main/java/org/apache/hudi/common/conflict/detection/TimelineServerBasedDetectionStrategy.java`
#### Snippet
```java
  protected final boolean checkCommitConflict;

  public TimelineServerBasedDetectionStrategy(String basePath, String markerDir, String markerName, Boolean checkCommitConflict) {
    this.basePath = basePath;
    this.markerDir = markerDir;
```

### NonProtectedConstructorInAbstractClass
Constructor `DirectMarkerBasedDetectionStrategy()` of an abstract class should not be declared 'public'
in `hudi-common/src/main/java/org/apache/hudi/common/conflict/detection/DirectMarkerBasedDetectionStrategy.java`
#### Snippet
```java
  protected final HoodieConfig config;

  public DirectMarkerBasedDetectionStrategy(HoodieWrapperFileSystem fs, String partitionPath, String fileId, String instantTime,
                                            HoodieActiveTimeline activeTimeline, HoodieConfig config) {
    this.fs = fs;
```

### NonProtectedConstructorInAbstractClass
Constructor `BootstrapIndex()` of an abstract class should not be declared 'public'
in `hudi-common/src/main/java/org/apache/hudi/common/bootstrap/index/BootstrapIndex.java`
#### Snippet
```java
  protected final HoodieTableMetaClient metaClient;

  public BootstrapIndex(HoodieTableMetaClient metaClient) {
    this.metaClient = metaClient;
  }
```

### NonProtectedConstructorInAbstractClass
Constructor `IndexWriter()` of an abstract class should not be declared 'public'
in `hudi-common/src/main/java/org/apache/hudi/common/bootstrap/index/BootstrapIndex.java`
#### Snippet
```java
    protected final HoodieTableMetaClient metaClient;

    public IndexWriter(HoodieTableMetaClient metaClient) {
      this.metaClient = metaClient;
    }
```

### NonProtectedConstructorInAbstractClass
Constructor `IndexReader()` of an abstract class should not be declared 'public'
in `hudi-common/src/main/java/org/apache/hudi/common/bootstrap/index/BootstrapIndex.java`
#### Snippet
```java
    protected final HoodieTableMetaClient metaClient;

    public IndexReader(HoodieTableMetaClient metaClient) {
      this.metaClient = metaClient;
    }
```

### NonProtectedConstructorInAbstractClass
Constructor `AbstractRealtimeRecordReader()` of an abstract class should not be declared 'public'
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/realtime/AbstractRealtimeRecordReader.java`
#### Snippet
```java
  protected HiveAvroSerializer serializer;

  public AbstractRealtimeRecordReader(RealtimeSplit split, JobConf job) {
    this.split = split;
    this.jobConf = job;
```

### NonProtectedConstructorInAbstractClass
Constructor `SchemaProvider()` of an abstract class should not be declared 'public'
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/schema/SchemaProvider.java`
#### Snippet
```java
  protected JavaSparkContext jssc;

  public SchemaProvider(TypedProperties props) {
    this(props, null);
  }
```

### NonProtectedConstructorInAbstractClass
Constructor `AvroSource()` of an abstract class should not be declared 'public'
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/AvroSource.java`
#### Snippet
```java
public abstract class AvroSource extends Source<JavaRDD<GenericRecord>> {

  public AvroSource(TypedProperties props, JavaSparkContext sparkContext, SparkSession sparkSession,
      SchemaProvider schemaProvider) {
    super(props, sparkContext, sparkSession, schemaProvider, SourceType.AVRO);
```

### NonProtectedConstructorInAbstractClass
Constructor `RowSource()` of an abstract class should not be declared 'public'
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/RowSource.java`
#### Snippet
```java
public abstract class RowSource extends Source<Dataset<Row>> {

  public RowSource(TypedProperties props, JavaSparkContext sparkContext, SparkSession sparkSession,
      SchemaProvider schemaProvider) {
    super(props, sparkContext, sparkSession, schemaProvider, SourceType.ROW);
```

### NonProtectedConstructorInAbstractClass
Constructor `JsonSource()` of an abstract class should not be declared 'public'
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/JsonSource.java`
#### Snippet
```java
public abstract class JsonSource extends Source<JavaRDD<String>> {

  public JsonSource(TypedProperties props, JavaSparkContext sparkContext, SparkSession sparkSession,
      SchemaProvider schemaProvider) {
    super(props, sparkContext, sparkSession, schemaProvider, SourceType.JSON);
```

### NonProtectedConstructorInAbstractClass
Constructor `JsonKafkaSourcePostProcessor()` of an abstract class should not be declared 'public'
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/processor/JsonKafkaSourcePostProcessor.java`
#### Snippet
```java
  protected TypedProperties props;

  public JsonKafkaSourcePostProcessor(TypedProperties props) {
    this.props = props;
  }
```

### NonProtectedConstructorInAbstractClass
Constructor `InitialCheckPointProvider()` of an abstract class should not be declared 'public'
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/checkpointing/InitialCheckPointProvider.java`
#### Snippet
```java
   * @param props All properties passed to Delta Streamer
   */
  public InitialCheckPointProvider(TypedProperties props) {
    this.props = props;
    this.path = new Path(props.getString(Config.CHECKPOINT_PROVIDER_PATH_PROP));
```

### NonProtectedConstructorInAbstractClass
Constructor `AbstractConnectWriter()` of an abstract class should not be declared 'public'
in `hudi-kafka-connect/src/main/java/org/apache/hudi/connect/writers/AbstractConnectWriter.java`
#### Snippet
```java
  protected final KafkaConnectConfigs connectConfigs;

  public AbstractConnectWriter(KafkaConnectConfigs connectConfigs,
                               KeyGenerator keyGenerator,
                               SchemaProvider schemaProvider, String instantTime) {
```

### NonProtectedConstructorInAbstractClass
Constructor `DebeziumSource()` of an abstract class should not be declared 'public'
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/debezium/DebeziumSource.java`
#### Snippet
```java
  private final String deserializerClassName;

  public DebeziumSource(TypedProperties props, JavaSparkContext sparkContext,
                        SparkSession sparkSession,
                        SchemaProvider schemaProvider,
```

### NonProtectedConstructorInAbstractClass
Constructor `AbstractWriteOperator()` of an abstract class should not be declared 'public'
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/common/AbstractWriteOperator.java`
#### Snippet
```java
  private final AbstractWriteFunction<I> function;

  public AbstractWriteOperator(AbstractWriteFunction<I> function) {
    super(function);
    this.function = function;
```

### NonProtectedConstructorInAbstractClass
Constructor `AbstractStreamWriteFunction()` of an abstract class should not be declared 'public'
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/common/AbstractStreamWriteFunction.java`
#### Snippet
```java
   * @param config The config options
   */
  public AbstractStreamWriteFunction(Configuration config) {
    this.config = config;
  }
```

### NonProtectedConstructorInAbstractClass
Constructor `AbstractColumnReader()` of an abstract class should not be declared 'public'
in `hudi-flink-datasource/hudi-flink1.13.x/src/main/java/org/apache/hudi/table/format/cow/vector/reader/AbstractColumnReader.java`
#### Snippet
```java
  private RunLengthDecoder dictionaryIdsDecoder;

  public AbstractColumnReader(
      ColumnDescriptor descriptor,
      PageReader pageReader) throws IOException {
```

### NonProtectedConstructorInAbstractClass
Constructor `BaseVectorizedColumnReader()` of an abstract class should not be declared 'public'
in `hudi-flink-datasource/hudi-flink1.13.x/src/main/java/org/apache/hudi/table/format/cow/vector/reader/BaseVectorizedColumnReader.java`
#### Snippet
```java
  protected final LogicalType logicalType;

  public BaseVectorizedColumnReader(
      ColumnDescriptor descriptor,
      PageReader pageReader,
```

### NonProtectedConstructorInAbstractClass
Constructor `AbstractColumnReader()` of an abstract class should not be declared 'public'
in `hudi-flink-datasource/hudi-flink1.14.x/src/main/java/org/apache/hudi/table/format/cow/vector/reader/AbstractColumnReader.java`
#### Snippet
```java
  private RunLengthDecoder dictionaryIdsDecoder;

  public AbstractColumnReader(
      ColumnDescriptor descriptor,
      PageReader pageReader) throws IOException {
```

### NonProtectedConstructorInAbstractClass
Constructor `BaseVectorizedColumnReader()` of an abstract class should not be declared 'public'
in `hudi-flink-datasource/hudi-flink1.14.x/src/main/java/org/apache/hudi/table/format/cow/vector/reader/BaseVectorizedColumnReader.java`
#### Snippet
```java
  protected final LogicalType logicalType;

  public BaseVectorizedColumnReader(
      ColumnDescriptor descriptor,
      PageReader pageReader,
```

### NonProtectedConstructorInAbstractClass
Constructor `AbstractColumnReader()` of an abstract class should not be declared 'public'
in `hudi-flink-datasource/hudi-flink1.15.x/src/main/java/org/apache/hudi/table/format/cow/vector/reader/AbstractColumnReader.java`
#### Snippet
```java
  private RunLengthDecoder dictionaryIdsDecoder;

  public AbstractColumnReader(
      ColumnDescriptor descriptor,
      PageReader pageReader) throws IOException {
```

### NonProtectedConstructorInAbstractClass
Constructor `BaseVectorizedColumnReader()` of an abstract class should not be declared 'public'
in `hudi-flink-datasource/hudi-flink1.15.x/src/main/java/org/apache/hudi/table/format/cow/vector/reader/BaseVectorizedColumnReader.java`
#### Snippet
```java
  protected final LogicalType logicalType;

  public BaseVectorizedColumnReader(
      ColumnDescriptor descriptor,
      PageReader pageReader,
```

### NonProtectedConstructorInAbstractClass
Constructor `AbstractColumnReader()` of an abstract class should not be declared 'public'
in `hudi-flink-datasource/hudi-flink1.16.x/src/main/java/org/apache/hudi/table/format/cow/vector/reader/AbstractColumnReader.java`
#### Snippet
```java
  private RunLengthDecoder dictionaryIdsDecoder;

  public AbstractColumnReader(
      ColumnDescriptor descriptor,
      PageReader pageReader) throws IOException {
```

### NonProtectedConstructorInAbstractClass
Constructor `BaseVectorizedColumnReader()` of an abstract class should not be declared 'public'
in `hudi-flink-datasource/hudi-flink1.16.x/src/main/java/org/apache/hudi/table/format/cow/vector/reader/BaseVectorizedColumnReader.java`
#### Snippet
```java
  protected final LogicalType logicalType;

  public BaseVectorizedColumnReader(
      ColumnDescriptor descriptor,
      PageReader pageReader,
```

### NonProtectedConstructorInAbstractClass
Constructor `SchemaProvider()` of an abstract class should not be declared 'public'
in `hudi-spark-datasource/hudi-spark/src/main/java/org/apache/hudi/cli/SchemaProvider.java`
#### Snippet
```java
  protected JavaSparkContext jssc;

  public SchemaProvider(TypedProperties props) {
    this(props, null);
  }
```

### NonProtectedConstructorInAbstractClass
Constructor `SparkFullBootstrapDataProviderBase()` of an abstract class should not be declared 'public'
in `hudi-spark-datasource/hudi-spark/src/main/java/org/apache/hudi/bootstrap/SparkFullBootstrapDataProviderBase.java`
#### Snippet
```java
  private final transient SparkSession sparkSession;

  public SparkFullBootstrapDataProviderBase(TypedProperties props,
                                            HoodieSparkEngineContext context) {
    super(props, context);
```

### NonProtectedConstructorInAbstractClass
Constructor `Handler()` of an abstract class should not be declared 'public'
in `hudi-timeline-service/src/main/java/org/apache/hudi/timeline/service/handlers/Handler.java`
#### Snippet
```java
  protected final FileSystemViewManager viewManager;

  public Handler(Configuration conf, TimelineService.Config timelineServiceConfig,
                 FileSystem fileSystem, FileSystemViewManager viewManager) throws IOException {
    this.conf = conf;
```

## RuleId[ruleID=CaughtExceptionImmediatelyRethrown]
### CaughtExceptionImmediatelyRethrown
Caught exception `e` is immediately rethrown
in `hudi-common/src/main/java/org/apache/hudi/common/fs/HoodieWrapperFileSystem.java`
#### Snippet
```java
      String scheme = FSUtils.getFs(file.toString(), conf).getScheme();
      return convertPathWithScheme(file, getHoodieScheme(scheme));
    } catch (HoodieIOException e) {
      throw e;
    }
```

### CaughtExceptionImmediatelyRethrown
Caught exception `e` is immediately rethrown
in `hudi-common/src/main/java/org/apache/hudi/common/util/InternalSchemaCache.java`
#### Snippet
```java
        try (FSDataInputStream is = fs.open(candidateCommitFile)) {
          data = FileIOUtils.readAsByteArray(is);
        } catch (IOException e) {
          throw e;
        }
```

## RuleId[ruleID=AssignmentToMethodParameter]
### AssignmentToMethodParameter
Assignment to method parameter `dynamoDB`
in `hudi-aws/src/main/java/org/apache/hudi/aws/transaction/lock/DynamoDBBasedLockProvider.java`
#### Snippet
```java
    long leaseDuration = Long.parseLong(lockConfiguration.getConfig().getString(LOCK_ACQUIRE_WAIT_TIMEOUT_MS_PROP_KEY));
    if (dynamoDB == null) {
      dynamoDB = getDynamoDBClient();
    }
    // build the dynamoDb lock client
```

### AssignmentToMethodParameter
Assignment to method parameter `maxInstant`
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/FileSystemViewCommand.java`
#### Snippet
```java
    } else {
      if (maxInstant.isEmpty()) {
        maxInstant = HoodieCLI.getTableMetaClient().getActiveTimeline().filterCompletedAndCompactionInstants().lastInstant()
            .get().getTimestamp();
      }
```

### AssignmentToMethodParameter
Assignment to method parameter `globRegex`
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/FileSystemViewCommand.java`
#### Snippet
```java
      throws IOException {

    globRegex = globRegex == null ? "" : globRegex;

    HoodieTableFileSystemView fsView = buildFileSystemView(globRegex, maxInstant, baseFileOnly, includeMaxInstant,
```

### AssignmentToMethodParameter
Assignment to method parameter `startTs`
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/DiffCommand.java`
#### Snippet
```java
  private HoodieDefaultTimeline getTimelineInRange(String startTs, String endTs, boolean includeArchivedTimeline) {
    if (isNullOrEmpty(startTs)) {
      startTs = getTimeDaysAgo(10);
    }
    if (isNullOrEmpty(endTs)) {
```

### AssignmentToMethodParameter
Assignment to method parameter `endTs`
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/DiffCommand.java`
#### Snippet
```java
    }
    if (isNullOrEmpty(endTs)) {
      endTs = getTimeDaysAgo(1);
    }
    checkArgument(nonEmpty(startTs), "startTs is null or empty");
```

### AssignmentToMethodParameter
Assignment to method parameter `startTs`
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/CommitsCommand.java`
#### Snippet
```java
      throws IOException {
    if (StringUtils.isNullOrEmpty(startTs)) {
      startTs = getTimeDaysAgo(10);
    }
    if (StringUtils.isNullOrEmpty(endTs)) {
```

### AssignmentToMethodParameter
Assignment to method parameter `endTs`
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/CommitsCommand.java`
#### Snippet
```java
    }
    if (StringUtils.isNullOrEmpty(endTs)) {
      endTs = getTimeDaysAgo(1);
    }
    HoodieArchivedTimeline archivedTimeline = HoodieCLI.getTableMetaClient().getArchivedTimeline();
```

### AssignmentToMethodParameter
Assignment to method parameter `compactionInstantTime`
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/CompactionCommand.java`
#### Snippet
```java
        return "NO PENDING COMPACTION TO RUN";
      }
      compactionInstantTime = firstPendingInstant.get();
    }
    String sparkPropertiesPath =
```

### AssignmentToMethodParameter
Assignment to method parameter `startTs`
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/CompactionCommand.java`
#### Snippet
```java
              defaultValue = "false") final boolean headerOnly) {
    if (StringUtils.isNullOrEmpty(startTs)) {
      startTs = getTimeDaysAgo(10);
    }
    if (StringUtils.isNullOrEmpty(endTs)) {
```

### AssignmentToMethodParameter
Assignment to method parameter `endTs`
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/CompactionCommand.java`
#### Snippet
```java
    }
    if (StringUtils.isNullOrEmpty(endTs)) {
      endTs = getTimeDaysAgo(1);
    }

```

### AssignmentToMethodParameter
Assignment to method parameter `sparkPropertiesPath`
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/RepairsCommand.java`
#### Snippet
```java
    }
    if (StringUtils.isNullOrEmpty(sparkPropertiesPath)) {
      sparkPropertiesPath =
          Utils.getDefaultPropertiesFile(JavaConverters.mapAsScalaMapConverter(System.getenv()).asScala());
    }
```

### AssignmentToMethodParameter
Assignment to method parameter `sparkPropertiesPath`
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/RepairsCommand.java`
#### Snippet
```java
          help = "Spark executor memory") final String sparkMemory) throws Exception {
    if (StringUtils.isNullOrEmpty(sparkPropertiesPath)) {
      sparkPropertiesPath =
          Utils.getDefaultPropertiesFile(JavaConverters.mapAsScalaMapConverter(System.getenv()).asScala());
    }
```

### AssignmentToMethodParameter
Assignment to method parameter `sparkPropertiesPath`
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/RepairsCommand.java`
#### Snippet
```java
          help = "Spark executor memory") final String sparkMemory) throws Exception {
    if (StringUtils.isNullOrEmpty(sparkPropertiesPath)) {
      sparkPropertiesPath =
          Utils.getDefaultPropertiesFile(JavaConverters.mapAsScalaMapConverter(System.getenv()).asScala());
    }
```

### AssignmentToMethodParameter
Assignment to method parameter `colName`
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/util/ColumnNameXLator.java`
#### Snippet
```java
  public static String translateNestedColumn(String colName) {
    Map.Entry<String,String> entry;
    for (Iterator<Map.Entry<String, String>> ic = xformMap.entrySet().iterator(); ic.hasNext(); colName =
        colName.replaceAll(entry.getKey(), entry.getValue())) {
      entry = ic.next();
```

### AssignmentToMethodParameter
Assignment to method parameter `result`
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/util/HiveSchemaUtil.java`
#### Snippet
```java
  private static String tickSurround(String result) {
    if (!result.startsWith("`")) {
      result = "`" + result;
    }
    if (!result.endsWith("`")) {
```

### AssignmentToMethodParameter
Assignment to method parameter `result`
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/util/HiveSchemaUtil.java`
#### Snippet
```java
    }
    if (!result.endsWith("`")) {
      result = result + "`";
    }
    return result;
```

### AssignmentToMethodParameter
Assignment to method parameter `result`
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/util/HiveSchemaUtil.java`
#### Snippet
```java
  private static String removeSurroundingTick(String result) {
    if (result.startsWith("`") && result.endsWith("`")) {
      result = result.substring(1, result.length() - 1);
    }

```

### AssignmentToMethodParameter
Assignment to method parameter `prevType`
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/util/HiveSchemaUtil.java`
#### Snippet
```java
      return false;
    }
    prevType = prevType.toLowerCase();
    newType = newType.toLowerCase();
    if (prevType.equals(newType)) {
```

### AssignmentToMethodParameter
Assignment to method parameter `newType`
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/util/HiveSchemaUtil.java`
#### Snippet
```java
    }
    prevType = prevType.toLowerCase();
    newType = newType.toLowerCase();
    if (prevType.equals(newType)) {
      return true;
```

### AssignmentToMethodParameter
Assignment to method parameter `newFileName`
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/io/FlinkMergeHandle.java`
#### Snippet
```java

        rolloverPaths.add(newFilePath);
        newFileName = newFileNameWithRollover(rollNumber++);
        newFilePath = makeNewFilePath(partitionPath, newFileName);
        LOG.warn("Duplicate write for MERGE bucket with path: " + oldFilePath + ", rolls over to new path: " + newFilePath);
```

### AssignmentToMethodParameter
Assignment to method parameter `newFileName`
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/io/FlinkMergeAndReplaceHandle.java`
#### Snippet
```java
      while (fs.exists(newFilePath)) {
        Path oldPath = newFilePath;
        newFileName = newFileNameWithRollover(rollNumber++);
        newFilePath = makeNewFilePath(partitionPath, newFileName);
        LOG.warn("Duplicate write for MERGE and REPLACE handle with path: " + oldPath + ", rolls over to new path: " + newFilePath);
```

### AssignmentToMethodParameter
Assignment to method parameter `requestedSchema`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/io/storage/HoodieSparkParquetReader.java`
#### Snippet
```java
  private ClosableIterator<InternalRow> getInternalRowIterator(Schema readerSchema, Schema requestedSchema) throws IOException {
    if (requestedSchema == null) {
      requestedSchema = readerSchema;
    }
    StructType readerStructType = HoodieInternalRowUtils.getCachedSchema(readerSchema);
```

### AssignmentToMethodParameter
Assignment to method parameter `dataset`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/validator/SqlQueryPreCommitValidator.java`
#### Snippet
```java
  protected void printAllRowsIfDebugEnabled(Dataset<Row> dataset) {
    if (LOG.isDebugEnabled()) {
      dataset = dataset.cache();
      LOG.debug("Printing all rows from query validation:");
      dataset.show(Integer.MAX_VALUE,false);
```

### AssignmentToMethodParameter
Assignment to method parameter `root`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/index/bloom/KeyRangeLookupTree.java`
#### Snippet
```java
  private KeyRangeNode insert(KeyRangeNode root, KeyRangeNode newNode) {
    if (root == null) {
      root = newNode;
      return root;
    }
```

### AssignmentToMethodParameter
Assignment to method parameter `partitionPaths`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/cluster/strategy/PartitionAwareClusteringPlanStrategy.java`
#### Snippet
```java
    String pattern = config.getClusteringPartitionFilterRegexPattern();
    if (!StringUtils.isNullOrEmpty(pattern)) {
      partitionPaths = partitionPaths.stream()
          .filter(partition -> Pattern.matches(pattern, partition))
          .collect(Collectors.toList());
```

### AssignmentToMethodParameter
Assignment to method parameter `parallelism`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/marker/DirectWriteMarkers.java`
#### Snippet
```java

    if (subDirectories.size() > 0) {
      parallelism = Math.min(subDirectories.size(), parallelism);
      SerializableConfiguration serializedConf = new SerializableConfiguration(fs.getConf());
      context.setJobStatus(this.getClass().getSimpleName(), "Obtaining marker files for all created, merged paths");
```

### AssignmentToMethodParameter
Assignment to method parameter `instantToBeDeleted`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/rollback/BaseRollbackActionExecutor.java`
#### Snippet
```java
      if (instantToBeDeleted.isInflight() && !table.getMetaClient().getTimelineLayoutVersion().isNullVersion()) {
        // Delete corresponding requested instant
        instantToBeDeleted = new HoodieInstant(HoodieInstant.State.REQUESTED, instantToBeDeleted.getAction(),
            instantToBeDeleted.getTimestamp());
        activeTimeline.deletePending(instantToBeDeleted);
```

### AssignmentToMethodParameter
Assignment to method parameter `schema`
in `hudi-common/src/main/java/org/apache/hudi/avro/MercifulJsonConverter.java`
#### Snippet
```java
        return null;
      } else {
        schema = getNonNull(schema);
      }
    } else if (value == null) {
```

### AssignmentToMethodParameter
Assignment to method parameter `n`
in `hudi-common/src/main/java/org/apache/hudi/common/fs/BoundedFsDataInputStream.java`
#### Snippet
```java
    long fileLength = getFileLength();
    if (n + curPos > fileLength) {
      n = fileLength - curPos;
    }
    return super.skip(n);
```

### AssignmentToMethodParameter
Assignment to method parameter `val`
in `hudi-common/src/main/java/org/apache/hudi/common/util/BinaryUtil.java`
#### Snippet
```java
    for (int i = 3; i > 0; i--) {
      b[i] = (byte) val;
      val >>>= 8;
    }
    b[0] = (byte) val;
```

### AssignmentToMethodParameter
Assignment to method parameter `metaClient`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/BaseHoodieWriteClient.java`
#### Snippet
```java

    if (upgradeDowngrade.needsUpgradeOrDowngrade(HoodieTableVersion.current())) {
      metaClient = HoodieTableMetaClient.reload(metaClient);
      // Ensure no inflight commits by setting EAGER policy and explicitly cleaning all failed commits
      List<String> instantsToRollback = tableServiceClient.getInstantsToRollback(metaClient, HoodieFailedWritesCleaningPolicy.EAGER, instantTime);
```

### AssignmentToMethodParameter
Assignment to method parameter `basePath`
in `hudi-common/src/main/java/org/apache/hudi/common/fs/FSUtils.java`
#### Snippet
```java
   */
  public static String getRelativePartitionPath(Path basePath, Path fullPartitionPath) {
    basePath = getPathWithoutSchemeAndAuthority(basePath);
    fullPartitionPath = getPathWithoutSchemeAndAuthority(fullPartitionPath);

```

### AssignmentToMethodParameter
Assignment to method parameter `fullPartitionPath`
in `hudi-common/src/main/java/org/apache/hudi/common/fs/FSUtils.java`
#### Snippet
```java
  public static String getRelativePartitionPath(Path basePath, Path fullPartitionPath) {
    basePath = getPathWithoutSchemeAndAuthority(basePath);
    fullPartitionPath = getPathWithoutSchemeAndAuthority(fullPartitionPath);

    String fullPartitionPathStr = fullPartitionPath.toString();
```

### AssignmentToMethodParameter
Assignment to method parameter `name`
in `hudi-common/src/main/java/org/apache/hudi/avro/HoodieAvroUtils.java`
#### Snippet
```java
  public static String sanitizeName(String name) {
    if (name.substring(0, 1).matches(INVALID_AVRO_FIRST_CHAR_IN_NAMES)) {
      name = name.replaceFirst(INVALID_AVRO_FIRST_CHAR_IN_NAMES, MASK_FOR_INVALID_CHARS_IN_NAMES);
    }
    return name.replaceAll(INVALID_AVRO_CHARS_IN_NAMES, MASK_FOR_INVALID_CHARS_IN_NAMES);
```

### AssignmentToMethodParameter
Assignment to method parameter `avroSchema`
in `hudi-common/src/main/java/org/apache/hudi/common/util/AvroOrcUtils.java`
#### Snippet
```java

    if (avroSchema.getType().equals(Schema.Type.UNION)) {
      avroSchema = getActualSchemaType(avroSchema);
    }

```

### AssignmentToMethodParameter
Assignment to method parameter `vectorPos`
in `hudi-common/src/main/java/org/apache/hudi/common/util/AvroOrcUtils.java`
#### Snippet
```java

    if (colVector.isRepeating) {
      vectorPos = 0;
    }

```

### AssignmentToMethodParameter
Assignment to method parameter `avroSchema`
in `hudi-common/src/main/java/org/apache/hudi/common/util/AvroOrcUtils.java`
#### Snippet
```java

    if (avroSchema.getType().equals(Schema.Type.UNION)) {
      avroSchema = getActualSchemaType(avroSchema);
    }
    LogicalType logicalType = avroSchema != null ? avroSchema.getLogicalType() : null;
```

### AssignmentToMethodParameter
Assignment to method parameter `value`
in `hudi-common/src/main/java/org/apache/hudi/common/util/AvroOrcUtils.java`
#### Snippet
```java

    if (value == null && matchValue != null) {
      value = matchValue;
    }

```

### AssignmentToMethodParameter
Assignment to method parameter `len`
in `hudi-common/src/main/java/org/apache/hudi/common/util/BufferedRandomAccessFile.java`
#### Snippet
```java

    // copy data to buffer, until all data is copied or to buffer capacity.
    len = Math.min(len, (int) (this.validLastPosition - this.currentPosition));
    int buffOff = (int) (this.currentPosition - this.startPosition);
    System.arraycopy(b, off, this.dataBuffer.array(), buffOff, len);
```

### AssignmentToMethodParameter
Assignment to method parameter `len`
in `hudi-common/src/main/java/org/apache/hudi/common/util/BufferedRandomAccessFile.java`
#### Snippet
```java

    // copy data from buffer
    len = Math.min(len, (int) (this.validLastPosition - this.currentPosition));
    int buffOff = (int) (this.currentPosition - this.startPosition);
    System.arraycopy(this.dataBuffer.array(), buffOff, b, off, len);
```

### AssignmentToMethodParameter
Assignment to method parameter `off`
in `hudi-common/src/main/java/org/apache/hudi/common/util/BufferedRandomAccessFile.java`
#### Snippet
```java
    while (len > 0) {
      int n = this.writeAtMost(b, off, len);
      off += n;
      len -= n;
      this.isDirty = true;
```

### AssignmentToMethodParameter
Assignment to method parameter `len`
in `hudi-common/src/main/java/org/apache/hudi/common/util/BufferedRandomAccessFile.java`
#### Snippet
```java
      int n = this.writeAtMost(b, off, len);
      off += n;
      len -= n;
      this.isDirty = true;
    }
```

### AssignmentToMethodParameter
Assignment to method parameter `readerSchema`
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/block/HoodieAvroDataBlock.java`
#### Snippet
```java

    if (readerSchema == null) {
      readerSchema = writerSchema;
    }

```

### AssignmentToMethodParameter
Assignment to method parameter `readerSchema`
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/block/HoodieAvroDataBlock.java`
#### Snippet
```java

    if (!internalSchema.isEmptySchema()) {
      readerSchema = writerSchema;
    }

```

### AssignmentToMethodParameter
Assignment to method parameter `metadata`
in `hudi-common/src/main/java/org/apache/hudi/common/table/timeline/versioning/MetadataMigrator.java`
#### Snippet
```java
    while (newVersion <= latestVersion) {
      VersionMigrator<T> upgrader = migrators.get(newVersion);
      metadata = upgrader.upgradeFrom(metadata);
      newVersion += 1;
    }
```

### AssignmentToMethodParameter
Assignment to method parameter `metadata`
in `hudi-common/src/main/java/org/apache/hudi/common/table/timeline/versioning/MetadataMigrator.java`
#### Snippet
```java
    while (newVersion <= targetVersion) {
      VersionMigrator<T> upgrader = migrators.get(newVersion);
      metadata = upgrader.upgradeFrom(metadata);
      newVersion += 1;
    }
```

### AssignmentToMethodParameter
Assignment to method parameter `metadata`
in `hudi-common/src/main/java/org/apache/hudi/common/table/timeline/versioning/MetadataMigrator.java`
#### Snippet
```java
    while (newVersion >= targetVersion) {
      VersionMigrator<T> downgrader = migrators.get(newVersion);
      metadata = downgrader.downgradeFrom(metadata);
      newVersion -= 1;
    }
```

### AssignmentToMethodParameter
Assignment to method parameter `line`
in `hudi-common/src/main/java/org/apache/hudi/common/config/DFSPropertiesConfiguration.java`
#### Snippet
```java

  private String[] splitProperty(String line) {
    line = line.replaceAll("\\s+", " ");
    String delimiter = line.contains("=") ? "=" : " ";
    int ind = line.indexOf(delimiter);
```

### AssignmentToMethodParameter
Assignment to method parameter `basePath`
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieTableMetadata.java`
#### Snippet
```java
    }
    if (basePath.endsWith(Path.SEPARATOR)) {
      basePath = basePath.substring(0, basePath.length() - 1);
    }
    return basePath.endsWith(HoodieTableMetaClient.METADATA_TABLE_FOLDER_PATH);
```

### AssignmentToMethodParameter
Assignment to method parameter `schema`
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/utils/HiveAvroSerializer.java`
#### Snippet
```java

    if (isNullableType(schema)) {
      schema = getOtherTypeFromNullableType(schema);
    }
    /* Because we use Hive's 'string' type when Avro calls for enum, we have to expressly check for enum-ness */
```

### AssignmentToMethodParameter
Assignment to method parameter `value`
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieTableMetadataUtil.java`
#### Snippet
```java
    if (valueScale != scale) {
      try {
        value = value.setScale(scale, RoundingMode.UNNECESSARY);
        scaleAdjusted = true;
      } catch (ArithmeticException aex) {
```

### AssignmentToMethodParameter
Assignment to method parameter `path`
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/hive/HoodieCombineHiveInputFormat.java`
#### Snippet
```java
          break;
        }
        path = path.getParent();
      }
      return find;
```

### AssignmentToMethodParameter
Assignment to method parameter `maxRetryCount`
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/UtilHelpers.java`
#### Snippet
```java
      do {
        ret = supplier.get();
      } while (ret != 0 && maxRetryCount-- > 0);
    } catch (Throwable t) {
      LOG.error(errorMessage, t);
```

### AssignmentToMethodParameter
Assignment to method parameter `lastCheckpointStr`
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/helpers/KafkaOffsetGen.java`
#### Snippet
```java

      if (Config.KAFKA_CHECKPOINT_TYPE_TIMESTAMP.equals(kafkaCheckpointType) && isValidTimestampCheckpointType(lastCheckpointStr)) {
        lastCheckpointStr = getOffsetsByTimestamp(consumer, partitionInfoList, topicPartitions, topicName, Long.parseLong(lastCheckpointStr.get()));
      }
      // Determine the offset ranges to read from
```

### AssignmentToMethodParameter
Assignment to method parameter `dataset`
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/debezium/DebeziumSource.java`
#### Snippet
```java

    for (String colName : arrayColumns) {
      dataset = dataset.withColumn(colName, functions.col(colName).cast(DataTypes.StringType));
    }

```

### AssignmentToMethodParameter
Assignment to method parameter `dataset`
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/debezium/DebeziumSource.java`
#### Snippet
```java

      for (String dateCol : dateFields) {
        dataset = dataset.withColumn(dateCol, functions.col(dateCol).cast(DataTypes.DateType));
      }
    }
```

### AssignmentToMethodParameter
Assignment to method parameter `recordKeyValue`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/bulk/RowDataKeyGen.java`
#### Snippet
```java
  // reference: org.apache.hudi.keygen.KeyGenUtils.getRecordKey
  public static String getRecordKey(Object recordKeyValue, String recordKeyField,boolean consistentLogicalTimestampEnabled) {
    recordKeyValue = getTimestampValue(consistentLogicalTimestampEnabled, recordKeyValue);
    String recordKey = StringUtils.objToString(recordKeyValue);
    if (recordKey == null || recordKey.isEmpty()) {
```

### AssignmentToMethodParameter
Assignment to method parameter `value`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/bulk/RowDataKeyGen.java`
#### Snippet
```java
      if (value instanceof TimestampData) {
        TimestampData timestampData = (TimestampData) value;
        value = timestampData.toTimestamp().toInstant().toEpochMilli();
      }
    }
```

### AssignmentToMethodParameter
Assignment to method parameter `targetSchema`
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/DeltaSync.java`
#### Snippet
```java
    LOG.info("Setting up new Hoodie Write Client");
    if (isDropPartitionColumns()) {
      targetSchema = HoodieAvroUtils.removeFields(targetSchema, getPartitionColumns(keyGenerator, props));
    }
    registerAvroSchemas(sourceSchema, targetSchema);
```

### AssignmentToMethodParameter
Assignment to method parameter `records`
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/DeltaSync.java`
#### Snippet
```java
    // filter dupes if needed
    if (cfg.filterDupes) {
      records = DataSourceUtils.dropDuplicates(jssc, records, writeClient.getConfig());
    }

```

### AssignmentToMethodParameter
Assignment to method parameter `dataStream`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/utils/Pipelines.java`
#### Snippet
```java

      Map<String, String> bucketIdToFileId = new HashMap<>();
      dataStream = dataStream.partitionCustom(partitioner, keyGen::getHoodieKey)
          .map(record -> BucketBulkInsertWriterHelper.rowWithFileId(bucketIdToFileId, keyGen, record, indexKeys, numBuckets), typeInfo)
          .setParallelism(conf.getInteger(FlinkOptions.WRITE_TASKS)); // same parallelism as write task to avoid shuffle
```

### AssignmentToMethodParameter
Assignment to method parameter `dataStream`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/utils/Pipelines.java`
#### Snippet
```java
      if (conf.getBoolean(FlinkOptions.WRITE_BULK_INSERT_SORT_INPUT)) {
        SortOperatorGen sortOperatorGen = BucketBulkInsertWriterHelper.getFileIdSorterGen(rowTypeWithFileId);
        dataStream = dataStream.transform("file_sorter", typeInfo, sortOperatorGen.createSortOperator())
            .setParallelism(conf.getInteger(FlinkOptions.WRITE_TASKS)); // same parallelism as write task to avoid shuffle
        ExecNodeUtil.setManagedMemoryWeight(dataStream.getTransformation(),
```

### AssignmentToMethodParameter
Assignment to method parameter `dataStream`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/utils/Pipelines.java`
#### Snippet
```java
        Partitioner<String> partitioner = (key, channels) -> KeyGroupRangeAssignment.assignKeyToParallelOperator(key,
            KeyGroupRangeAssignment.computeDefaultMaxParallelism(conf.getInteger(FlinkOptions.WRITE_TASKS)), channels);
        dataStream = dataStream.partitionCustom(partitioner, rowDataKeyGen::getPartitionPath);
      }
      if (conf.getBoolean(FlinkOptions.WRITE_BULK_INSERT_SORT_INPUT)) {
```

### AssignmentToMethodParameter
Assignment to method parameter `dataStream`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/utils/Pipelines.java`
#### Snippet
```java
        SortOperatorGen sortOperatorGen = new SortOperatorGen(rowType, sortFields);
        // sort by partition keys or (partition keys and record keys)
        dataStream = dataStream
            .transform(operatorName,
                InternalTypeInfo.of(rowType),
```

### AssignmentToMethodParameter
Assignment to method parameter `dataStream`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/utils/Pipelines.java`
#### Snippet
```java
    final RowDataKeyGen rowDataKeyGen = RowDataKeyGen.instance(conf, rowType);
    // shuffle by partition keys
    dataStream = dataStream
        .keyBy(rowDataKeyGen::getPartitionPath);

```

### AssignmentToMethodParameter
Assignment to method parameter `minNumSplits`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/cow/CopyOnWriteInputFormat.java`
#### Snippet
```java

    // take the desired number of splits into account
    minNumSplits = Math.max(minNumSplits, this.numSplits);

    final List<FileInputSplit> inputSplits = new ArrayList<>(minNumSplits);
```

### AssignmentToMethodParameter
Assignment to method parameter `currPath`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/FilePathUtils.java`
#### Snippet
```java
      }
      kvs.add(kv);
      currPath = currPath.getParent();
      curDepth++;
    } while (currPath != null && !currPath.getName().isEmpty() && curDepth < partitionKeys.length);
```

### AssignmentToMethodParameter
Assignment to method parameter `numBytes`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/cdc/CdcInputFormat.java`
#### Snippet
```java
      while (numBytes > 0) {
        int skipped = this.skipBytes(numBytes);
        numBytes -= skipped;
      }
    }
```

### AssignmentToMethodParameter
Assignment to method parameter `rowId`
in `hudi-flink-datasource/hudi-flink1.13.x/src/main/java/org/apache/hudi/table/format/cow/vector/reader/RunLengthDecoder.java`
#### Snippet
```java
          throw new AssertionError();
      }
      rowId += n;
      left -= n;
      currentCount -= n;
```

### AssignmentToMethodParameter
Assignment to method parameter `rowId`
in `hudi-flink-datasource/hudi-flink1.13.x/src/main/java/org/apache/hudi/table/format/cow/vector/reader/RunLengthDecoder.java`
#### Snippet
```java
          throw new AssertionError();
      }
      rowId += n;
      left -= n;
      currentCount -= n;
```

### AssignmentToMethodParameter
Assignment to method parameter `readNumber`
in `hudi-flink-datasource/hudi-flink1.13.x/src/main/java/org/apache/hudi/table/format/cow/vector/reader/AbstractColumnReader.java`
#### Snippet
```java
      valuesRead += num;
      rowId += num;
      readNumber -= num;
    }
  }
```

### AssignmentToMethodParameter
Assignment to method parameter `timeline`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/source/IncrementalInputSplits.java`
#### Snippet
```java
    if (this.skipCompaction) {
      // the compaction commit uses 'commit' as action which is tricky
      timeline = timeline.filter(instant -> !instant.getAction().equals(HoodieTimeline.COMMIT_ACTION));
    }
    if (this.skipClustering) {
```

### AssignmentToMethodParameter
Assignment to method parameter `timeline`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/source/IncrementalInputSplits.java`
#### Snippet
```java
    }
    if (this.skipClustering) {
      timeline = timeline.filter(instant -> !ClusteringUtil.isClusteringInstant(instant, oriTimeline));
    }
    return timeline;
```

### AssignmentToMethodParameter
Assignment to method parameter `rowCount`
in `hudi-flink-datasource/hudi-flink1.13.x/src/main/java/org/apache/hudi/table/format/cow/vector/reader/ParquetColumnarRowSplitReader.java`
#### Snippet
```java
        rowsInBatch = (int) metaData.getRowCount();
        nextRow = (int) metaData.getRowCount();
        rowCount -= metaData.getRowCount();
      }
    }
```

### AssignmentToMethodParameter
Assignment to method parameter `readNumber`
in `hudi-flink-datasource/hudi-flink1.14.x/src/main/java/org/apache/hudi/table/format/cow/vector/reader/AbstractColumnReader.java`
#### Snippet
```java
      valuesRead += num;
      rowId += num;
      readNumber -= num;
    }
  }
```

### AssignmentToMethodParameter
Assignment to method parameter `rowId`
in `hudi-flink-datasource/hudi-flink1.14.x/src/main/java/org/apache/hudi/table/format/cow/vector/reader/RunLengthDecoder.java`
#### Snippet
```java
          throw new AssertionError();
      }
      rowId += n;
      left -= n;
      currentCount -= n;
```

### AssignmentToMethodParameter
Assignment to method parameter `rowId`
in `hudi-flink-datasource/hudi-flink1.14.x/src/main/java/org/apache/hudi/table/format/cow/vector/reader/RunLengthDecoder.java`
#### Snippet
```java
          throw new AssertionError();
      }
      rowId += n;
      left -= n;
      currentCount -= n;
```

### AssignmentToMethodParameter
Assignment to method parameter `rowCount`
in `hudi-flink-datasource/hudi-flink1.14.x/src/main/java/org/apache/hudi/table/format/cow/vector/reader/ParquetColumnarRowSplitReader.java`
#### Snippet
```java
        rowsInBatch = (int) metaData.getRowCount();
        nextRow = (int) metaData.getRowCount();
        rowCount -= metaData.getRowCount();
      }
    }
```

### AssignmentToMethodParameter
Assignment to method parameter `value`
in `hudi-flink-datasource/hudi-flink1.13.x/src/main/java/org/apache/hudi/table/format/cow/ParquetSplitReaderUtil.java`
#### Snippet
```java
      case DATE:
        if (value instanceof LocalDate) {
          value = Date.valueOf((LocalDate) value);
        }
        return createVectorFromConstant(
```

### AssignmentToMethodParameter
Assignment to method parameter `rowId`
in `hudi-flink-datasource/hudi-flink1.15.x/src/main/java/org/apache/hudi/table/format/cow/vector/reader/RunLengthDecoder.java`
#### Snippet
```java
          throw new AssertionError();
      }
      rowId += n;
      left -= n;
      currentCount -= n;
```

### AssignmentToMethodParameter
Assignment to method parameter `rowId`
in `hudi-flink-datasource/hudi-flink1.15.x/src/main/java/org/apache/hudi/table/format/cow/vector/reader/RunLengthDecoder.java`
#### Snippet
```java
          throw new AssertionError();
      }
      rowId += n;
      left -= n;
      currentCount -= n;
```

### AssignmentToMethodParameter
Assignment to method parameter `readNumber`
in `hudi-flink-datasource/hudi-flink1.15.x/src/main/java/org/apache/hudi/table/format/cow/vector/reader/AbstractColumnReader.java`
#### Snippet
```java
      valuesRead += num;
      rowId += num;
      readNumber -= num;
    }
  }
```

### AssignmentToMethodParameter
Assignment to method parameter `rowCount`
in `hudi-flink-datasource/hudi-flink1.15.x/src/main/java/org/apache/hudi/table/format/cow/vector/reader/ParquetColumnarRowSplitReader.java`
#### Snippet
```java
        rowsInBatch = (int) metaData.getRowCount();
        nextRow = (int) metaData.getRowCount();
        rowCount -= metaData.getRowCount();
      }
    }
```

### AssignmentToMethodParameter
Assignment to method parameter `value`
in `hudi-flink-datasource/hudi-flink1.14.x/src/main/java/org/apache/hudi/table/format/cow/ParquetSplitReaderUtil.java`
#### Snippet
```java
      case DATE:
        if (value instanceof LocalDate) {
          value = Date.valueOf((LocalDate) value);
        }
        return createVectorFromConstant(
```

### AssignmentToMethodParameter
Assignment to method parameter `rowId`
in `hudi-flink-datasource/hudi-flink1.16.x/src/main/java/org/apache/hudi/table/format/cow/vector/reader/RunLengthDecoder.java`
#### Snippet
```java
          throw new AssertionError();
      }
      rowId += n;
      left -= n;
      currentCount -= n;
```

### AssignmentToMethodParameter
Assignment to method parameter `rowId`
in `hudi-flink-datasource/hudi-flink1.16.x/src/main/java/org/apache/hudi/table/format/cow/vector/reader/RunLengthDecoder.java`
#### Snippet
```java
          throw new AssertionError();
      }
      rowId += n;
      left -= n;
      currentCount -= n;
```

### AssignmentToMethodParameter
Assignment to method parameter `readNumber`
in `hudi-flink-datasource/hudi-flink1.16.x/src/main/java/org/apache/hudi/table/format/cow/vector/reader/AbstractColumnReader.java`
#### Snippet
```java
      valuesRead += num;
      rowId += num;
      readNumber -= num;
    }
  }
```

### AssignmentToMethodParameter
Assignment to method parameter `rowCount`
in `hudi-flink-datasource/hudi-flink1.16.x/src/main/java/org/apache/hudi/table/format/cow/vector/reader/ParquetColumnarRowSplitReader.java`
#### Snippet
```java
        rowsInBatch = (int) metaData.getRowCount();
        nextRow = (int) metaData.getRowCount();
        rowCount -= metaData.getRowCount();
      }
    }
```

### AssignmentToMethodParameter
Assignment to method parameter `value`
in `hudi-flink-datasource/hudi-flink1.15.x/src/main/java/org/apache/hudi/table/format/cow/ParquetSplitReaderUtil.java`
#### Snippet
```java
      case DATE:
        if (value instanceof LocalDate) {
          value = Date.valueOf((LocalDate) value);
        }
        return createVectorFromConstant(
```

### AssignmentToMethodParameter
Assignment to method parameter `writer`
in `hudi-spark-datasource/hudi-spark/src/test/java/HoodieJavaApp.java`
#### Snippet
```java
    if (enableHiveSync) {
      LOG.info("Enabling Hive sync to " + hiveJdbcUrl);
      writer = writer.option(META_SYNC_TABLE_NAME.key(), hiveTable)
          .option(META_SYNC_DATABASE_NAME.key(), hiveDB)
          .option(HIVE_URL.key(), hiveJdbcUrl)
```

### AssignmentToMethodParameter
Assignment to method parameter `writer`
in `hudi-spark-datasource/hudi-spark/src/test/java/HoodieJavaGenerateApp.java`
#### Snippet
```java
    if (enableHiveSync) {
      LOG.info("Enabling Hive sync to " + hiveJdbcUrl);
      writer = writer.option(META_SYNC_TABLE_NAME.key(), hiveTable)
          .option(META_SYNC_DATABASE_NAME.key(), hiveDB)
          .option(HIVE_URL.key(), hiveJdbcUrl)
```

### AssignmentToMethodParameter
Assignment to method parameter `writer`
in `hudi-spark-datasource/hudi-spark/src/test/java/HoodieJavaGenerateApp.java`
#### Snippet
```java
          .option(HIVE_SYNC_ENABLED.key(), "true");
      if (nonPartitionedTable) {
        writer = writer
            .option(HiveSyncConfig.META_SYNC_PARTITION_EXTRACTOR_CLASS.key(),
                NonPartitionedExtractor.class.getCanonicalName())
```

### AssignmentToMethodParameter
Assignment to method parameter `writer`
in `hudi-spark-datasource/hudi-spark/src/test/java/HoodieJavaApp.java`
#### Snippet
```java
          .option(HIVE_SYNC_ENABLED.key(), "true");
      if (nonPartitionedTable) {
        writer = writer
            .option(HiveSyncConfig.META_SYNC_PARTITION_EXTRACTOR_CLASS.key(),
                NonPartitionedExtractor.class.getCanonicalName())
```

### AssignmentToMethodParameter
Assignment to method parameter `writer`
in `hudi-spark-datasource/hudi-spark/src/test/java/HoodieJavaGenerateApp.java`
#### Snippet
```java
            .option(DataSourceWriteOptions.PARTITIONPATH_FIELD().key(), "");
      } else if (useMultiPartitionKeys) {
        writer = writer.option(HiveSyncConfig.META_SYNC_PARTITION_FIELDS.key(), "year,month,day").option(
            HiveSyncConfig.META_SYNC_PARTITION_EXTRACTOR_CLASS.key(),
            MultiPartKeysValueExtractor.class.getCanonicalName());
```

### AssignmentToMethodParameter
Assignment to method parameter `writer`
in `hudi-spark-datasource/hudi-spark/src/test/java/HoodieJavaGenerateApp.java`
#### Snippet
```java
            MultiPartKeysValueExtractor.class.getCanonicalName());
      } else {
        writer = writer.option(HiveSyncConfig.META_SYNC_PARTITION_FIELDS.key(), "dateStr").option(
            HiveSyncConfig.META_SYNC_PARTITION_EXTRACTOR_CLASS.key(),
            SlashEncodedDayPartitionValueExtractor.class.getCanonicalName());
```

### AssignmentToMethodParameter
Assignment to method parameter `writer`
in `hudi-spark-datasource/hudi-spark/src/test/java/HoodieJavaApp.java`
#### Snippet
```java
            .option(DataSourceWriteOptions.PARTITIONPATH_FIELD().key(), "");
      } else if (useMultiPartitionKeys) {
        writer = writer.option(HiveSyncConfig.META_SYNC_PARTITION_FIELDS.key(), "year,month,day").option(
            HiveSyncConfig.META_SYNC_PARTITION_EXTRACTOR_CLASS.key(),
            MultiPartKeysValueExtractor.class.getCanonicalName());
```

### AssignmentToMethodParameter
Assignment to method parameter `writer`
in `hudi-spark-datasource/hudi-spark/src/test/java/HoodieJavaApp.java`
#### Snippet
```java
            MultiPartKeysValueExtractor.class.getCanonicalName());
      } else {
        writer = writer.option(HiveSyncConfig.META_SYNC_PARTITION_FIELDS.key(), "dateStr").option(
            HiveSyncConfig.META_SYNC_PARTITION_EXTRACTOR_CLASS.key(),
            SlashEncodedDayPartitionValueExtractor.class.getCanonicalName());
```

### AssignmentToMethodParameter
Assignment to method parameter `value`
in `hudi-flink-datasource/hudi-flink1.16.x/src/main/java/org/apache/hudi/table/format/cow/ParquetSplitReaderUtil.java`
#### Snippet
```java
      case DATE:
        if (value instanceof LocalDate) {
          value = Date.valueOf((LocalDate) value);
        }
        return createVectorFromConstant(
```

### AssignmentToMethodParameter
Assignment to method parameter `writer`
in `hudi-spark-datasource/hudi-spark/src/test/java/HoodieJavaStreamingApp.java`
#### Snippet
```java
    if (enableHiveSync) {
      LOG.info("Enabling Hive sync to " + hiveJdbcUrl);
      writer = writer.option(META_SYNC_TABLE_NAME.key(), hiveTable)
          .option(META_SYNC_DATABASE_NAME.key(), hiveDB)
          .option(HIVE_URL.key(), hiveJdbcUrl)
```

### AssignmentToMethodParameter
Assignment to method parameter `writer`
in `hudi-spark-datasource/hudi-spark/src/test/java/HoodieJavaStreamingApp.java`
#### Snippet
```java
          .option(HIVE_SYNC_ENABLED.key(), "true");
      if (useMultiPartitionKeys) {
        writer = writer.option(HiveSyncConfig.META_SYNC_PARTITION_FIELDS.key(), "year,month,day").option(
            HiveSyncConfig.META_SYNC_PARTITION_EXTRACTOR_CLASS.key(),
            MultiPartKeysValueExtractor.class.getCanonicalName());
```

### AssignmentToMethodParameter
Assignment to method parameter `writer`
in `hudi-spark-datasource/hudi-spark/src/test/java/HoodieJavaStreamingApp.java`
#### Snippet
```java
            MultiPartKeysValueExtractor.class.getCanonicalName());
      } else {
        writer = writer.option(HiveSyncConfig.META_SYNC_PARTITION_FIELDS.key(), "dateStr").option(
            HiveSyncConfig.META_SYNC_PARTITION_EXTRACTOR_CLASS.key(),
            SlashEncodedDayPartitionValueExtractor.class.getCanonicalName());
```

### AssignmentToMethodParameter
Assignment to method parameter `retry`
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HDFSParquetImporter.java`
#### Snippet
```java
      do {
        ret = dataImport(jsc);
      } while (ret != 0 && retry-- > 0);
    } catch (Throwable t) {
      LOG.error(t);
```

## RuleId[ruleID=PrimitiveArrayArgumentToVariableArgMethod]
### PrimitiveArrayArgumentToVariableArgMethod
Confusing primitive array argument to varargs method
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/ProtoKafkaSource.java`
#### Snippet
```java
    public Message parse(byte[] bytes) {
      try {
        return (Message) getParseMethod().invoke(getClass(), bytes);
      } catch (IllegalAccessException | InvocationTargetException ex) {
        throw new HoodieException("Failed to parse proto message from kafka", ex);
```

## RuleId[ruleID=SynchronizationOnLocalVariableOrMethodParameter]
### SynchronizationOnLocalVariableOrMethodParameter
Synchronization on method parameter `jobConf`
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/realtime/HoodieHFileRealtimeInputFormat.java`
#### Snippet
```java
    // actual heavy lifting of reading the parquet files happen.
    if (jobConf.get(HoodieInputFormatUtils.HOODIE_READ_COLUMNS_PROP) == null) {
      synchronized (jobConf) {
        LOG.info(
            "Before adding Hoodie columns, Projections :" + jobConf.get(ColumnProjectionUtils.READ_COLUMN_NAMES_CONF_STR)
```

### SynchronizationOnLocalVariableOrMethodParameter
Synchronization on method parameter `jobConf`
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/realtime/HoodieParquetRealtimeInputFormat.java`
#### Snippet
```java
    // actual heavy lifting of reading the parquet files happen.
    if (HoodieRealtimeInputFormatUtils.canAddProjectionToJobConf(realtimeSplit, jobConf)) {
      synchronized (jobConf) {
        LOG.info(
            "Before adding Hoodie columns, Projections :" + jobConf.get(ColumnProjectionUtils.READ_COLUMN_NAMES_CONF_STR)
```

### SynchronizationOnLocalVariableOrMethodParameter
Synchronization on local variable `view`
in `hudi-timeline-service/src/main/java/org/apache/hudi/timeline/service/RequestHandler.java`
#### Snippet
```java
      String lastKnownInstantFromClient = ctx.queryParamAsClass(RemoteHoodieTableFileSystemView.LAST_INSTANT_TS, String.class).getOrDefault(HoodieTimeline.INVALID_INSTANT_TS);
      SyncableFileSystemView view = viewManager.getFileSystemView(basePath);
      synchronized (view) {
        if (isLocalViewBehind(ctx)) {
          HoodieTimeline localTimeline = viewManager.getFileSystemView(basePath).getTimeline();
```

## RuleId[ruleID=ReturnNull]
### ReturnNull
Return of `null`
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/CompactionCommand.java`
#### Snippet
```java
      }
    } else {
      return null;
    }
  }
```

### ReturnNull
Return of `null`
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/CompactionCommand.java`
#### Snippet
```java
        } catch (HoodieIOException ioe) {
          // SKIP
          return null;
        }
      } else {
```

### ReturnNull
Return of `null`
in `hudi-sync/hudi-sync-common/src/main/java/org/apache/hudi/sync/common/HoodieMetaSyncOperations.java`
#### Snippet
```java
   */
  default MessageType getStorageSchema() {
    return null;
  }

```

### ReturnNull
Return of `null`
in `hudi-sync/hudi-sync-common/src/main/java/org/apache/hudi/sync/common/HoodieMetaSyncOperations.java`
#### Snippet
```java
   */
  default MessageType getStorageSchema(boolean includeMetadataField) {
    return null;
  }

```

### ReturnNull
Return of `null`
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/util/PartitionFilterGenerator.java`
#### Snippet
```java

      if (!SUPPORT_TYPES.contains(fieldSchema.getType())) {
        return null;
      }

```

### ReturnNull
Return of `null`
in `hudi-sync/hudi-sync-common/src/main/java/org/apache/hudi/sync/common/util/ConfigUtils.java`
#### Snippet
```java
  public static String configToString(Map<String, String> config) {
    if (config == null) {
      return null;
    }
    StringBuilder sb = new StringBuilder();
```

### ReturnNull
Return of `null`
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/util/HiveSchemaUtil.java`
#### Snippet
```java
      }
    }
    return null;
  }

```

### ReturnNull
Return of `null`
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/util/FlinkClientUtil.java`
#### Snippet
```java
      return hadoopConfiguration;
    }
    return null;
  }
}
```

### ReturnNull
Return of `null`
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/client/HoodieFlinkTableServiceClient.java`
#### Snippet
```java
  @Override
  public HoodieWriteMetadata<List<WriteStatus>> cluster(String clusteringInstant, boolean shouldComplete) {
    return null;
  }

```

### ReturnNull
Return of `null`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/table/action/bootstrap/SparkBootstrapCommitActionExecutor.java`
#### Snippet
```java
  public HoodieWriteMetadata<HoodieData<WriteStatus>> execute(HoodieData<HoodieRecord<T>> inputRecords) {
    // NO_OP
    return null;
  }

```

### ReturnNull
Return of `null`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/keygen/StringPartitionPathFormatter.java`
#### Snippet
```java
  @Override
  protected String toString(Object o) {
    return o == null ? null : o.toString();
  }

```

### ReturnNull
Return of `null`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/keygen/BuiltinKeyGenerator.java`
#### Snippet
```java
  private static Object convertToLogicalDataType(DataType dataType, Object value) {
    if (value == null) {
      return null;
    } else if (dataType instanceof TimestampType) {
      // Provided value have to be [[Long]] in this case, representing micros since epoch
```

### ReturnNull
Return of `null`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/keygen/BuiltinKeyGenerator.java`
#### Snippet
```java
  static UTF8String toUTF8String(Object o) {
    if (o == null) {
      return null;
    } else if (o instanceof UTF8String) {
      return (UTF8String) o;
```

### ReturnNull
Return of `null`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/keygen/BuiltinKeyGenerator.java`
#### Snippet
```java
      } catch (Exception e) {
        if (returnNull) {
          return null;
        }
        LOG.error(String.format("Failed to resolve nested field-paths (%s) in schema (%s)", fieldPaths, schema), e);
```

### ReturnNull
Return of `null`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/keygen/BuiltinKeyGenerator.java`
#### Snippet
```java

  private static String toString(Object o) {
    return o == null ? null : o.toString();
  }

```

### ReturnNull
Return of `null`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/common/model/HoodieSparkRecord.java`
#### Snippet
```java
  private static UnsafeRow convertToUnsafeRow(InternalRow payload, StructType schema) {
    if (payload == null) {
      return null;
    } else if (payload instanceof UnsafeRow) {
      return (UnsafeRow) payload;
```

### ReturnNull
Return of `null`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/io/HoodieCDCLogger.java`
#### Snippet
```java

  private GenericRecord removeCommitMetadata(GenericRecord record) {
    return record == null ? null : HoodieAvroUtils.rewriteRecordWithNewSchema(record, dataSchema, Collections.emptyMap());
  }

```

### ReturnNull
Return of `null`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/async/AsyncArchiveService.java`
#### Snippet
```java
    if (!config.isAutoArchive() || !config.isAsyncArchive()) {
      LOG.info("The HoodieWriteClient is not configured to auto & async archive. Async archive service will not start.");
      return null;
    }
    AsyncArchiveService asyncArchiveService = new AsyncArchiveService(writeClient);
```

### ReturnNull
Return of `null`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/async/AsyncCleanerService.java`
#### Snippet
```java
    if (!config.isAutoClean() || !config.isAsyncClean()) {
      LOG.info("The HoodieWriteClient is not configured to auto & async clean. Async clean service will not start.");
      return null;
    }
    AsyncCleanerService asyncCleanerService = new AsyncCleanerService(writeClient);
```

### ReturnNull
Return of `null`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/clean/CleanActionExecutor.java`
#### Snippet
```java
    // TODO (NA) : Clean only the earliest pending clean just like how we do for other table services
    // This requires the CleanActionExecutor to be refactored as BaseCommitActionExecutor
    return cleanMetadataList.size() > 0 ? cleanMetadataList.get(cleanMetadataList.size() - 1) : null;
  }
}
```

### ReturnNull
Return of `null`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/clean/CleanPlanner.java`
#### Snippet
```java
    }
    // There is no version of this file which is <= instantTime
    return null;
  }

```

### ReturnNull
Return of `null`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/restore/RestoreUtils.java`
#### Snippet
```java
    //find last instant before first rollback
    Option<HoodieInstant> savepointInstance = table.getActiveTimeline().getSavePointTimeline().findInstantsBefore(firstRollback).lastInstant();
    return savepointInstance.isPresent() ? savepointInstance.get().getTimestamp() : null;
  }

```

### ReturnNull
Return of `null`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/transaction/lock/metrics/HoodieLockMetrics.java`
#### Snippet
```java

  private String getMetricsName(String metric) {
    return writeConfig == null ? null : String.format("%s.%s", writeConfig.getMetricReporterMetricsNamePrefix(), metric);
  }

```

### ReturnNull
Return of `null`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/keygen/parser/HoodieDateTimeParser.java`
#### Snippet
```java
      inputTimeZone = config.getString(KeyGeneratorOptions.Config.TIMESTAMP_INPUT_TIMEZONE_FORMAT_PROP, "");
    }
    return !inputTimeZone.trim().isEmpty() ? DateTimeZone.forTimeZone(TimeZone.getTimeZone(inputTimeZone)) : null;
  }

```

### ReturnNull
Return of `null`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/keygen/parser/HoodieDateTimeParser.java`
#### Snippet
```java
      outputTimeZone = config.getString(KeyGeneratorOptions.Config.TIMESTAMP_OUTPUT_TIMEZONE_FORMAT_PROP, "");
    }
    return !outputTimeZone.trim().isEmpty() ? DateTimeZone.forTimeZone(TimeZone.getTimeZone(outputTimeZone)) : null;
  }

```

### ReturnNull
Return of `null`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/keygen/KeyGenUtils.java`
#### Snippet
```java
                return kvArray[0];
              } else if (kvArray[1].equals(NULL_RECORDKEY_PLACEHOLDER)) {
                return null;
              } else if (kvArray[1].equals(EMPTY_RECORDKEY_PLACEHOLDER)) {
                return "";
```

### ReturnNull
Return of `null`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metrics/HoodieMetrics.java`
#### Snippet
```java
      commitTimer = createTimer(commitTimerName);
    }
    return commitTimer == null ? null : commitTimer.time();
  }

```

### ReturnNull
Return of `null`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metrics/HoodieMetrics.java`
#### Snippet
```java
      cleanTimer = createTimer(cleanTimerName);
    }
    return cleanTimer == null ? null : cleanTimer.time();
  }

```

### ReturnNull
Return of `null`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metrics/HoodieMetrics.java`
#### Snippet
```java
      compactionTimer = createTimer(commitTimerName);
    }
    return compactionTimer == null ? null : compactionTimer.time();
  }

```

### ReturnNull
Return of `null`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metrics/HoodieMetrics.java`
#### Snippet
```java
      rollbackTimer = createTimer(rollbackTimerName);
    }
    return rollbackTimer == null ? null : rollbackTimer.time();
  }

```

### ReturnNull
Return of `null`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metrics/HoodieMetrics.java`
#### Snippet
```java

  String getMetricsName(String action, String metric) {
    return config == null ? null : String.format("%s.%s.%s", config.getMetricReporterMetricsNamePrefix(), action, metric);
  }

```

### ReturnNull
Return of `null`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metrics/HoodieMetrics.java`
#### Snippet
```java

  private Timer createTimer(String name) {
    return config.isMetricsOn() ? Metrics.getInstance().getRegistry().timer(name) : null;
  }

```

### ReturnNull
Return of `null`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metrics/HoodieMetrics.java`
#### Snippet
```java
      logCompactionTimer = createTimer(commitTimerName);
    }
    return logCompactionTimer == null ? null : logCompactionTimer.time();
  }

```

### ReturnNull
Return of `null`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metrics/HoodieMetrics.java`
#### Snippet
```java
      deltaCommitTimer = createTimer(deltaCommitTimerName);
    }
    return deltaCommitTimer == null ? null : deltaCommitTimer.time();
  }

```

### ReturnNull
Return of `null`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metrics/HoodieMetrics.java`
#### Snippet
```java
      indexTimer = createTimer(indexTimerName);
    }
    return indexTimer == null ? null : indexTimer.time();
  }

```

### ReturnNull
Return of `null`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metrics/HoodieMetrics.java`
#### Snippet
```java
      finalizeTimer = createTimer(finalizeTimerName);
    }
    return finalizeTimer == null ? null : finalizeTimer.time();
  }

```

### ReturnNull
Return of `null`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metrics/HoodieMetrics.java`
#### Snippet
```java
      clusteringTimer = createTimer(replaceCommitTimerName);
    }
    return clusteringTimer == null ? null : clusteringTimer.time();
  }

```

### ReturnNull
Return of `null`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metrics/HoodieMetrics.java`
#### Snippet
```java
      conflictResolutionTimer = createTimer(conflictResolutionTimerName);
    }
    return conflictResolutionTimer == null ? null : conflictResolutionTimer.time();
  }

```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/avro/MercifulJsonConverter.java`
#### Snippet
```java
    if (isOptional(schema)) {
      if (value == null) {
        return null;
      } else {
        schema = getNonNull(schema);
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/fs/TimedFSDataInputStream.java`
#### Snippet
```java
        path, length, () -> {
          super.readFully(position, buffer, offset, length);
          return null;
        });
  }
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/fs/TimedFSDataInputStream.java`
#### Snippet
```java
        path, buffer.length, () -> {
          super.readFully(position, buffer);
          return null;
        });
  }
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/fs/SizeAwareFSDataOutputStream.java`
#### Snippet
```java
          bytesWritten.addAndGet(b.length);
          super.write(b);
          return null;
        });
  }
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/fs/SizeAwareFSDataOutputStream.java`
#### Snippet
```java
          bytesWritten.addAndGet(len);
          super.write(b, off, len);
          return null;
        });
  }
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/fs/inline/InMemoryFileSystem.java`
#### Snippet
```java
  @Override
  public FSDataOutputStream append(Path path, int i, Progressable progressable) throws IOException {
    return null;
  }

```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/fs/inline/InMemoryFileSystem.java`
#### Snippet
```java
  @Override
  public FSDataInputStream open(Path inlinePath, int bufferSize) {
    return null;
  }

```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/fs/inline/InMemoryFileSystem.java`
#### Snippet
```java
  @Override
  public Path getWorkingDirectory() {
    return null;
  }

```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/avro/AvroSchemaCompatibility.java`
#### Snippet
```java
    switch (writerFields.size()) {
      case 0:
        return null;
      case 1:
        return writerFields.get(0);
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/util/OrcReaderIterator.java`
#### Snippet
```java
    // No more records left to read from ORC file
    if (!ensureBatch()) {
      return null;
    }

```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/util/FileIOUtils.java`
#### Snippet
```java
      return System.getProperty("java.io.tmpdir").split(",");
    } else {
      return null;
    }
  }
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/fs/FSUtils.java`
#### Snippet
```java
    }
    String val = matcher.group(9);
    return val == null ? null : Integer.parseInt(val);
  }

```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/fs/FSUtils.java`
#### Snippet
```java
    }
    String val = matcher.group(8);
    return val == null ? null : Integer.parseInt(val);
  }

```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/fs/FSUtils.java`
#### Snippet
```java
    }
    String val = matcher.group(7);
    return val == null ? null : Integer.parseInt(val);
  }

```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/avro/HoodieAvroUtils.java`
#### Snippet
```java
    } else if (fieldValue == null) {
      checkState(isNullable(fieldSchema));
      return null;
    }

```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/avro/HoodieAvroUtils.java`
#### Snippet
```java
    if (record.getSchema().getField(key) == null) {
      if (returnNullIfNotFound) {
        return null;
      } else {
        // Since avro 1.10, arvo will throw AvroRuntimeException("Not a valid schema field: " + key)
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/avro/HoodieAvroUtils.java`
#### Snippet
```java
  private static Object rewriteRecordWithNewSchema(Object oldRecord, Schema oldAvroSchema, Schema newSchema, Map<String, String> renameCols, Deque<String> fieldNames) {
    if (oldRecord == null) {
      return null;
    }
    // try to get real schema for union type
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/avro/HoodieAvroUtils.java`
#### Snippet
```java

  public static final String AVRO_VERSION = Schema.class.getPackage().getImplementationVersion();
  private static final ThreadLocal<BinaryEncoder> BINARY_ENCODER = ThreadLocal.withInitial(() -> null);
  private static final ThreadLocal<BinaryDecoder> BINARY_DECODER = ThreadLocal.withInitial(() -> null);

```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/avro/HoodieAvroUtils.java`
#### Snippet
```java
  public static final String AVRO_VERSION = Schema.class.getPackage().getImplementationVersion();
  private static final ThreadLocal<BinaryEncoder> BINARY_ENCODER = ThreadLocal.withInitial(() -> null);
  private static final ThreadLocal<BinaryDecoder> BINARY_DECODER = ThreadLocal.withInitial(() -> null);

  private static final long MILLIS_PER_DAY = 86400000L;
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/avro/HoodieAvroUtils.java`
#### Snippet
```java
      } catch (AvroRuntimeException e) {
        if (returnNullIfNotFound) {
          return null;
        } else {
          throw new HoodieException(
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/avro/HoodieAvroUtils.java`
#### Snippet
```java
        // return, if last part of name
        if (val == null) {
          return null;
        } else {
          Schema fieldSchema = valueNode.getSchema().getField(part).schema();
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/avro/HoodieAvroUtils.java`
#### Snippet
```java
        if (!(val instanceof GenericRecord)) {
          if (returnNullIfNotFound) {
            return null;
          } else {
            throw new HoodieException("Cannot find a record at part value :" + part);
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/avro/HoodieAvroUtils.java`
#### Snippet
```java
    // This can only be reached if the length of parts is 0
    if (returnNullIfNotFound) {
      return null;
    } else {
      throw new HoodieException(
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/util/StringUtils.java`
#### Snippet
```java
  public static String join(final List<String> list, final String separator) {
    if (list == null || list.size() == 0) {
      return null;
    }
    return org.apache.hadoop.util.StringUtils.join(separator, list.toArray(new String[0]));
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/util/StringUtils.java`
#### Snippet
```java
  public static String join(CharSequence delimiter, Iterable<? extends CharSequence> elements) {
    if (elements == null) {
      return null;
    }
    return String.join(delimiter, elements);
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/util/StringUtils.java`
#### Snippet
```java
  public static String objToString(@Nullable Object obj) {
    if (obj == null) {
      return null;
    }
    return obj instanceof ByteBuffer ? toHexString(((ByteBuffer) obj).array()) : obj.toString();
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/util/StringUtils.java`
#### Snippet
```java
  public static String join(final String[] array, final String separator) {
    if (array == null) {
      return null;
    }
    return org.apache.hadoop.util.StringUtils.join(separator, array);
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/util/HoodieRecordUtils.java`
#### Snippet
```java
            } catch (HoodieException e) {
              LOG.warn(String.format("Unable to init %s", clazz), e);
              return null;
            }
          })
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/util/AvroOrcUtils.java`
#### Snippet
```java

    if (colVector.isNull[vectorPos]) {
      return null;
    }

```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/util/queue/BaseHoodieQueueBasedExecutor.java`
#### Snippet
```java
      // NOTE: To properly support mode when there's no consumer, we have to fall back
      //       to producing future as the trigger for us to shut down the queue
      return producing.thenCombine(consuming, (aVoid, anotherVoid) -> null)
          .whenComplete((ignored, throwable) -> {
            // Close the queue to release the resources
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/ArrayUtils.java`
#### Snippet
```java
  public static long[] toPrimitive(Long[] array) {
    if (array == null) {
      return null;
    } else if (array.length == 0) {
      return EMPTY_LONG_ARRAY;
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/util/ParquetUtils.java`
#### Snippet
```java
  private static Comparable<?> convertToNativeJavaType(PrimitiveType primitiveType, Comparable<?> val) {
    if (val == null) {
      return null;
    }

```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/util/ParquetUtils.java`
#### Snippet
```java
    int scale = decimalMetadata.getScale();
    if (val == null) {
      return null;
    } else if (val instanceof Integer) {
      return BigDecimal.valueOf((Integer) val, scale);
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/RocksDBDAO.java`
#### Snippet
```java
    try {
      byte[] val = getRocksDB().get(managedHandlesMap.get(columnFamilyName), SerializationUtils.serialize(key));
      return val == null ? null : SerializationUtils.deserialize(val);
    } catch (Exception e) {
      throw new HoodieException(e);
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/RocksDBDAO.java`
#### Snippet
```java
    try {
      byte[] val = getRocksDB().get(managedHandlesMap.get(columnFamilyName), key.getBytes());
      return val == null ? null : SerializationUtils.deserialize(val);
    } catch (RocksDBException e) {
      throw new HoodieException(e);
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/RocksDbDiskMap.java`
#### Snippet
```java
  public R get(Object key) {
    if (!containsKey(key)) {
      return null;
    }
    return getRocksDb().get(ROCKSDB_COL_FAMILY, (T) key);
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/bloom/InternalDynamicBloomFilter.java`
#### Snippet
```java

    if (currentNbRecord >= nr && (matrix.length * nr) < maxNr) {
      return null;
    } else if (currentNbRecord >= nr && (matrix.length * nr) >= maxNr) {
      reachedMax = true;
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/ExternalSpillableMap.java`
#### Snippet
```java
      return getDiskBasedMap().remove(key);
    }
    return null;
  }

```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/ExternalSpillableMap.java`
#### Snippet
```java
      return getDiskBasedMap().get(key);
    }
    return null;
  }

```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/BitCaskDiskMap.java`
#### Snippet
```java
    ValueMetadata entry = valueMetadataMap.get(key);
    if (entry == null) {
      return null;
    }
    return get(entry);
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieOperation.java`
#### Snippet
```java
  public static HoodieOperation fromName(Option<String> nameOpt) {
    if (!nameOpt.isPresent()) {
      return null;
    }
    return fromName(nameOpt.get());
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieEmptyRecord.java`
#### Snippet
```java
  @Override
  public T getData() {
    return null;
  }

```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieEmptyRecord.java`
#### Snippet
```java
    this.orderingVal = (Comparable<?>) kryo.readClassAndObject(input);
    // NOTE: [[EmptyRecord]]'s payload is always null
    return null;
  }
}
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieRecord.java`
#### Snippet
```java
    @Override
    public Object get(String key) {
      return null;
    }
  }
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieRecord.java`
#### Snippet
```java
    @Override
    public Object get(int i) {
      return null;
    }

```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieRecord.java`
#### Snippet
```java
    @Override
    public Schema getSchema() {
      return null;
    }

```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/LogReaderUtils.java`
#### Snippet
```java
      }
    }
    return null;
  }
}
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/table/timeline/dto/FSPermissionDTO.java`
#### Snippet
```java
  public static FSPermissionDTO fromFsPermission(FsPermission permission) {
    if (null == permission) {
      return null;
    }
    FSPermissionDTO dto = new FSPermissionDTO();
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/table/timeline/dto/FSPermissionDTO.java`
#### Snippet
```java
  public static FsPermission fromFsPermissionDTO(FSPermissionDTO dto) {
    if (null == dto) {
      return null;
    }
    return new FsPermission(dto.useraction, dto.groupaction, dto.otheraction, dto.stickyBit);
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/table/timeline/dto/FilePathDTO.java`
#### Snippet
```java
  public static Path toPath(FilePathDTO dto) {
    if (null == dto) {
      return null;
    }

```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/table/timeline/dto/FilePathDTO.java`
#### Snippet
```java
  public static FilePathDTO fromPath(Path path) {
    if (null == path) {
      return null;
    }
    FilePathDTO dto = new FilePathDTO();
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/table/timeline/dto/InstantDTO.java`
#### Snippet
```java
  public static InstantDTO fromInstant(HoodieInstant instant) {
    if (null == instant) {
      return null;
    }

```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/table/timeline/dto/InstantDTO.java`
#### Snippet
```java
  public static HoodieInstant toInstant(InstantDTO dto) {
    if (null == dto) {
      return null;
    }

```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/table/timeline/dto/FileStatusDTO.java`
#### Snippet
```java
  public static FileStatus toFileStatus(FileStatusDTO dto) {
    if (null == dto) {
      return null;
    }

```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/table/timeline/dto/FileStatusDTO.java`
#### Snippet
```java
  public static FileStatusDTO fromFileStatus(FileStatus fileStatus) {
    if (null == fileStatus) {
      return null;
    }

```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/table/timeline/dto/BaseFileDTO.java`
#### Snippet
```java
  public static BaseFileDTO fromHoodieBaseFile(BaseFile baseFile) {
    if (null == baseFile) {
      return null;
    }

```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/table/timeline/dto/BaseFileDTO.java`
#### Snippet
```java
  public static HoodieBaseFile toHoodieBaseFile(BaseFileDTO dto) {
    if (null == dto) {
      return null;
    }

```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/table/timeline/dto/BaseFileDTO.java`
#### Snippet
```java
  private static BaseFile toBaseFile(BaseFileDTO dto) {
    if (null == dto) {
      return null;
    }

```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/RocksDbBasedFileSystemView.java`
#### Snippet
```java
            .map(Pair::getValue).reduce(null,
                (x, y) -> ((x == null) ? y
                    : (y == null) ? null
                        : HoodieTimeline.compareTimestamps(x.getCommitTime(), HoodieTimeline.GREATER_THAN, y.getCommitTime())
                            ? x
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/RocksDbBasedFileSystemView.java`
#### Snippet
```java
                    fs.getBaseFile().orElseGet(() -> {
                      oldSlice.getBaseFile().ifPresent(newFileSlice::setBaseFile);
                      return null;
                    });

```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/RocksDbBasedFileSystemView.java`
#### Snippet
```java
                      return newFileSlice;
                    }
                    return null;
                  }
                  default:
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/RocksDbBasedFileSystemView.java`
#### Snippet
```java
        .map(Pair::getValue).reduce(null,
            (x, y) -> ((x == null) ? y
                : (y == null) ? null
                    : HoodieTimeline.compareTimestamps(x.getBaseInstantTime(), HoodieTimeline.GREATER_THAN, y.getBaseInstantTime()
            ) ? x : y)));
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/table/timeline/HoodieArchivedTimeline.java`
#### Snippet
```java
          }
        }
        return null;
      });
    }
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/bootstrap/FileStatusUtils.java`
#### Snippet
```java
  public static Path toPath(HoodiePath path) {
    if (null == path) {
      return null;
    }
    return new Path(path.getUri());
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/bootstrap/FileStatusUtils.java`
#### Snippet
```java
  public static HoodiePath fromPath(Path path) {
    if (null == path) {
      return null;
    }
    return HoodiePath.newBuilder().setUri(path.toString()).build();
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/bootstrap/FileStatusUtils.java`
#### Snippet
```java
  public static FileStatus toFileStatus(HoodieFileStatus fileStatus) {
    if (null == fileStatus) {
      return null;
    }

```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/bootstrap/FileStatusUtils.java`
#### Snippet
```java
  public static HoodieFileStatus fromFileStatus(FileStatus fileStatus) {
    if (null == fileStatus) {
      return null;
    }

```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/bootstrap/FileStatusUtils.java`
#### Snippet
```java
  public static HoodieFSPermission fromFSPermission(FsPermission fsPermission) {
    if (null == fsPermission) {
      return null;
    }
    String userAction = fsPermission.getUserAction() != null ? fsPermission.getUserAction().name() : null;
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/bootstrap/FileStatusUtils.java`
#### Snippet
```java
  public static FsPermission toFSPermission(HoodieFSPermission fsPermission) {
    if (null == fsPermission) {
      return null;
    }
    FsAction userAction = fsPermission.getUserAction() != null ? FsAction.valueOf(fsPermission.getUserAction()) : null;
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/InternalSchema.java`
#### Snippet
```java
      return field.type();
    }
    return null;
  }

```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/InternalSchema.java`
#### Snippet
```java
  public Type findType(String name) {
    if (name == null || name.isEmpty()) {
      return null;
    }
    Integer id = buildNameToId().get(name);
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/InternalSchema.java`
#### Snippet
```java
      return findType(id);
    }
    return null;
  }

```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/InternalSchema.java`
#### Snippet
```java
  public Field findField(String name) {
    if (name == null || name.isEmpty()) {
      return null;
    }
    Integer id = buildNameToId().get(name);
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/InternalSchema.java`
#### Snippet
```java
      return buildIdToField().get(id);
    }
    return null;
  }

```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/Types.java`
#### Snippet
```java
        return field.type();
      }
      return null;
    }

```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/Types.java`
#### Snippet
```java
        return elementType();
      }
      return null;
    }

```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/Types.java`
#### Snippet
```java
        return valueField;
      }
      return null;
    }

```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/Types.java`
#### Snippet
```java
        return elementField;
      }
      return null;
    }

```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/Types.java`
#### Snippet
```java
        return valueField.type();
      }
      return null;
    }

```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/visitor/InternalSchemaVisitor.java`
#### Snippet
```java

  public T primitive(Type.PrimitiveType primitive) {
    return null;
  }
}
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/visitor/InternalSchemaVisitor.java`
#### Snippet
```java

  public T map(Types.MapType map, T keyResult, T valueResult) {
    return null;
  }

```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/visitor/InternalSchemaVisitor.java`
#### Snippet
```java

  public T record(Types.RecordType record, List<T> fieldResults) {
    return null;
  }

```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/visitor/InternalSchemaVisitor.java`
#### Snippet
```java

  public T schema(InternalSchema schema, T recordResult) {
    return null;
  }

```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/visitor/InternalSchemaVisitor.java`
#### Snippet
```java

  public T field(Types.Field field, T fieldResult) {
    return null;
  }

```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/visitor/InternalSchemaVisitor.java`
#### Snippet
```java

  public T array(Types.ArrayType array, T elementResult) {
    return null;
  }

```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/utils/InternalSchemaUtils.java`
#### Snippet
```java
        }
        if (newFields.isEmpty()) {
          return null;
        }
        if (newFields.size() == fields.size() && !changed) {
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/utils/InternalSchemaUtils.java`
#### Snippet
```java
          return Types.ArrayType.get(array.elementId(), array.isElementOptional(), newElementType);
        }
        return null;
      case MAP:
        Types.MapType map = (Types.MapType) type;
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/utils/InternalSchemaUtils.java`
#### Snippet
```java
          return Types.MapType.get(map.keyId(), map.valueId(), map.keyType(), newValueType, map.isValueOptional());
        }
        return null;
      default:
        return null;
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/utils/InternalSchemaUtils.java`
#### Snippet
```java
        return null;
      default:
        return null;
    }
  }
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/action/TableChanges.java`
#### Snippet
```java
    public Type applyDelete(int id, Type type) {
      if (deletes.contains(id)) {
        return null;
      }
      return type;
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/convert/AvroInternalSchemaConverter.java`
#### Snippet
```java
        return Types.BinaryType.get();
      case NULL:
        return null;
      default:
        throw new UnsupportedOperationException("Unsupported primitive type: " + primitive);
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/secondary/index/SecondaryIndexUtils.java`
#### Snippet
```java
  public static <T> T fromJsonString(String jsonStr, TypeReference<T> type) throws Exception {
    if (jsonStr == null || jsonStr.isEmpty()) {
      return null;
    }

```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieMetadataPayload.java`
#### Snippet
```java
    // NOTE: This routine is more lightweight than {@code HoodieAvroUtils.getNestedFieldVal}
    if (record.getSchema().getField(fieldName) == null) {
      return null;
    }

```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieMetadataPayload.java`
#### Snippet
```java
  public static Comparable<?> unwrapStatisticValueWrapper(Object statValueWrapper) {
    if (statValueWrapper == null) {
      return null;
    } else if (statValueWrapper instanceof DateWrapper) {
      return LocalDate.ofEpochDay(((DateWrapper) statValueWrapper).getValue());
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieMetadataPayload.java`
#### Snippet
```java
                //          currently)
                newFileInfo.getIsDeleted()
                    ? null
                    : new HoodieMetadataFileInfo(Math.max(newFileInfo.getSize(), oldFileInfo.getSize()), false));
      });
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieMetadataPayload.java`
#### Snippet
```java
  private static Object wrapStatisticValue(Comparable<?> statValue) {
    if (statValue == null) {
      return null;
    } else if (statValue instanceof Date || statValue instanceof LocalDate) {
      // NOTE: Due to breaking changes in code-gen b/w Avro 1.8.2 and 1.10, we can't
```

### ReturnNull
Return of `null`
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/HoodieHFileRecordReader.java`
#### Snippet
```java
  @Override
  public NullWritable createKey() {
    return null;
  }

```

### ReturnNull
Return of `null`
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/HoodieROTablePathFilter.java`
#### Snippet
```java
      return path.getParent().getParent().getParent();
    }
    return null;
  }

```

### ReturnNull
Return of `null`
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/HoodieCopyOnWriteTableInputFormat.java`
#### Snippet
```java
    Option<HoodieTimeline> timeline = HoodieInputFormatUtils.getFilteredCommitsTimeline(jobContext, tableMetaClient);
    if (!timeline.isPresent()) {
      return null;
    }
    Option<List<HoodieInstant>> commitsToCheck = HoodieInputFormatUtils.getCommitsForIncrementalQuery(jobContext, incrementalTable, timeline.get());
```

### ReturnNull
Return of `null`
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/HoodieCopyOnWriteTableInputFormat.java`
#### Snippet
```java
    Option<List<HoodieInstant>> commitsToCheck = HoodieInputFormatUtils.getCommitsForIncrementalQuery(jobContext, incrementalTable, timeline.get());
    if (!commitsToCheck.isPresent()) {
      return null;
    }
    Option<String> incrementalInputPaths = HoodieInputFormatUtils.getAffectedPartitions(commitsToCheck.get(), tableMetaClient, timeline.get(), inputPaths);
```

### ReturnNull
Return of `null`
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/HoodieCopyOnWriteTableInputFormat.java`
#### Snippet
```java
    // Mutate the JobConf to set the input paths to only partitions touched by incremental pull.
    if (!incrementalInputPaths.isPresent()) {
      return null;
    }
    setInputPaths(job, incrementalInputPaths.get());
```

### ReturnNull
Return of `null`
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/SchemaEvolutionContext.java`
#### Snippet
```java
    } catch (Exception e) {
      LOG.warn(String.format("Not a valid hoodie table, table path: %s", ((FileSplit)split).getPath()), e);
      return null;
    }
  }
```

### ReturnNull
Return of `null`
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/utils/HoodieHiveUtils.java`
#### Snippet
```java
      if (s.getValue().trim().toUpperCase().equals(INCREMENTAL_SCAN_MODE)) {
        Matcher matcher = HOODIE_CONSUME_MODE_PATTERN_STRING.matcher(s.getKey());
        return (!matcher.find() ? null : matcher.group(1));
      }
      return null;
```

### ReturnNull
Return of `null`
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/utils/HoodieHiveUtils.java`
#### Snippet
```java
        return (!matcher.find() ? null : matcher.group(1));
      }
      return null;
    }).filter(Objects::nonNull).collect(Collectors.toList());
    if (result == null) {
```

### ReturnNull
Return of `null`
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/utils/HoodieRealtimeRecordReaderUtils.java`
#### Snippet
```java

    if (value == null) {
      return null;
    }

```

### ReturnNull
Return of `null`
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/utils/HoodieRealtimeRecordReaderUtils.java`
#### Snippet
```java
        return new BooleanWritable((Boolean) value);
      case NULL:
        return null;
      case RECORD:
        GenericRecord record = (GenericRecord) value;
```

### ReturnNull
Return of `null`
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/utils/HoodieRealtimeRecordReaderUtils.java`
#### Snippet
```java
        return new BytesWritable(((GenericFixed) value).bytes());
      default:
        return null;
    }
  }
```

### ReturnNull
Return of `null`
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/realtime/HoodieEmptyRecordReader.java`
#### Snippet
```java
  @Override
  public NullWritable createKey() {
    return null;
  }

```

### ReturnNull
Return of `null`
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/realtime/RealtimeUnmergedRecordReader.java`
#### Snippet
```java
          // Scan all the delta-log files, filling in the queue
          scanner.scan();
          return null;
        }),
        new IteratorBasedQueueProducer<>(parquetRecordsIterator)
```

### ReturnNull
Return of `null`
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/utils/HiveAvroSerializer.java`
#### Snippet
```java
  private Object serialize(TypeInfo typeInfo, ObjectInspector fieldOI, Object structFieldData, Schema schema) throws HoodieException {
    if (null == structFieldData) {
      return null;
    }

```

### ReturnNull
Return of `null`
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/utils/HiveAvroSerializer.java`
#### Snippet
```java
        throw new HoodieException("Received UNKNOWN primitive category.");
      case VOID:
        return null;
      default: // All other primitive types are simple
        return fieldOI.getPrimitiveJavaObject(structFieldData);
```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieTableMetadataUtil.java`
#### Snippet
```java
  private static Comparable<?> coerceToComparable(Schema schema, Object val) {
    if (val == null) {
      return null;
    }

```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieTableMetadataUtil.java`
#### Snippet
```java
      case RECORD:
      case ARRAY:
        return null;

      default:
```

### ReturnNull
Return of `null`
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HiveIncrementalPuller.java`
#### Snippet
```java
      }
    }
    return null;
  }

```

### ReturnNull
Return of `null`
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HiveIncrementalPuller.java`
#### Snippet
```java
                  .filterCompletedInstants().getInstants()
              + " and from commit time is " + config.fromCommitTime);
      return null;
    }
    LOG.info("Syncing commits " + commitsToSync);
```

### ReturnNull
Return of `null`
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/schema/NullTargetSchemaRegistryProvider.java`
#### Snippet
```java
  @Override
  public Schema getTargetSchema() {
    return null;
  }
}
```

### ReturnNull
Return of `null`
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/schema/SparkAvroPostProcessor.java`
#### Snippet
```java
  public Schema processSchema(Schema schema) {
    if (schema == null) {
      return null;
    }

```

### ReturnNull
Return of `null`
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/UtilHelpers.java`
#### Snippet
```java

    if (provider == null) {
      return null;
    }

```

### ReturnNull
Return of `null`
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/UtilHelpers.java`
#### Snippet
```java
  public static JsonKafkaSourcePostProcessor createJsonKafkaSourcePostProcessor(String postProcessorClassNames, TypedProperties props) throws IOException {
    if (StringUtils.isNullOrEmpty(postProcessorClassNames)) {
      return null;
    }

```

### ReturnNull
Return of `null`
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/UtilHelpers.java`
#### Snippet
```java
                                                    JavaSparkContext jssc) throws IOException {
    try {
      return StringUtils.isNullOrEmpty(schemaProviderClass) ? null
          : (SchemaProvider) ReflectionUtils.loadClass(schemaProviderClass, cfg, jssc);
    } catch (Throwable e) {
```

### ReturnNull
Return of `null`
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/UtilHelpers.java`
#### Snippet
```java

    if (StringUtils.isNullOrEmpty(schemaPostProcessorClassNames)) {
      return null;
    }

```

### ReturnNull
Return of `null`
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/helpers/IncrSourceHelper.java`
#### Snippet
```java
    }

    return null;
  }
}
```

### ReturnNull
Return of `null`
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/helpers/ProtoConversionUtil.java`
#### Snippet
```java
    private static Object convertObject(Schema schema, Object value) {
      if (value == null) {
        return null;
      }
      // if we've reached max recursion depth in the provided schema, write out message to bytes
```

### ReturnNull
Return of `null`
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/helpers/ProtoConversionUtil.java`
#### Snippet
```java
          return mapCopy;
        case NULL:
          return null;
        case RECORD:
          GenericData.Record newRecord = new GenericData.Record(schema);
```

### ReturnNull
Return of `null`
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/processor/maxwell/MaxwellJsonKafkaSourcePostProcessor.java`
#### Snippet
```java
        } else {
          // there might be some ddl data, ignore it
          return null;
        }
      } else {
```

### ReturnNull
Return of `null`
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/processor/maxwell/MaxwellJsonKafkaSourcePostProcessor.java`
#### Snippet
```java
      } else {
        // not the data from target table(s), ignore it
        return null;
      }
    }).filter(Objects::nonNull);
```

### ReturnNull
Return of `null`
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/checkpointing/InitialCheckpointFromAnotherHoodieTimelineProvider.java`
#### Snippet
```java
            return commitMetadata.getMetadata(CHECKPOINT_KEY);
          } catch (IOException e) {
            return null;
          }
        }).filter(Objects::nonNull).findFirst().get();
```

### ReturnNull
Return of `null`
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/HoodieDeltaStreamerMetrics.java`
#### Snippet
```java

  private Timer createTimer(String name) {
    return config.isMetricsOn() ? Metrics.getInstance().getRegistry().timer(name) : null;
  }

```

### ReturnNull
Return of `null`
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/HoodieDeltaStreamerMetrics.java`
#### Snippet
```java
      metaSyncTimer = createTimer(metaSyncTimerName);
    }
    return metaSyncTimer == null ? null : metaSyncTimer.time();
  }

```

### ReturnNull
Return of `null`
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/HoodieDeltaStreamerMetrics.java`
#### Snippet
```java
      overallTimer = createTimer(overallTimerName);
    }
    return overallTimer == null ? null : overallTimer.time();
  }

```

### ReturnNull
Return of `null`
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/HoodieDeltaStreamerMetrics.java`
#### Snippet
```java

  String getMetricsName(String action, String metric) {
    return config == null ? null : String.format("%s.%s.%s", config.getMetricReporterMetricsNamePrefix(), action, metric);
  }

```

### ReturnNull
Return of `null`
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/HoodieDeltaStreamerMetrics.java`
#### Snippet
```java
      hiveSyncTimer = createTimer(hiveSyncTimerName);
    }
    return hiveSyncTimer == null ? null : hiveSyncTimer.time();
  }

```

### ReturnNull
Return of `null`
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/DeltaSync.java`
#### Snippet
```java
      String commitActionType = CommitUtils.getCommitActionType(cfg.operation, HoodieTableType.valueOf(cfg.tableType));
      hoodieMetrics.updateMetricsForEmptyData(commitActionType);
      return null;
    }

```

### ReturnNull
Return of `null`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/partitioner/BucketAssigner.java`
#### Snippet
```java
    }
    smallFileAssignMap.put(partitionPath, null);
    return null;
  }

```

### ReturnNull
Return of `null`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/util/StringToRowDataConverter.java`
#### Snippet
```java
    switch (logicalType.getTypeRoot()) {
      case NULL:
        return field -> null;
      case TINYINT:
        return Byte::parseByte;
```

### ReturnNull
Return of `null`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/util/AvroToRowDataConverters.java`
#### Snippet
```java
    switch (type.getTypeRoot()) {
      case NULL:
        return avroObject -> null;
      case TINYINT:
        return avroObject -> ((Integer) avroObject).byteValue();
```

### ReturnNull
Return of `null`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/util/AvroToRowDataConverters.java`
#### Snippet
```java
    return avroObject -> {
      if (avroObject == null) {
        return null;
      }
      return converter.convert(avroObject);
```

### ReturnNull
Return of `null`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/util/RowDataToAvroConverters.java`
#### Snippet
```java
              @Override
              public Object convert(Schema schema, Object object) {
                return null;
              }
            };
```

### ReturnNull
Return of `null`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/util/RowDataToAvroConverters.java`
#### Snippet
```java
      public Object convert(Schema schema, Object object) {
        if (object == null) {
          return null;
        }

```

### ReturnNull
Return of `null`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/util/StreamerUtil.java`
#### Snippet
```java
    final String basePath = conf.getString(FlinkOptions.PATH);
    if (conf.getBoolean(FlinkOptions.READ_AS_STREAMING) && !tableExists(basePath, hadoopConf)) {
      return null;
    } else {
      return createMetaClient(basePath, hadoopConf);
```

### ReturnNull
Return of `null`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/util/StreamerUtil.java`
#### Snippet
```java
  public static Schema getLatestTableSchema(String path, org.apache.hadoop.conf.Configuration hadoopConf) {
    if (StringUtils.isNullOrEmpty(path) || !StreamerUtil.tableExists(path, hadoopConf)) {
      return null;
    }

```

### ReturnNull
Return of `null`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/util/StreamerUtil.java`
#### Snippet
```java
      LOG.warn("Error while resolving the latest table schema", e);
    }
    return null;
  }

```

### ReturnNull
Return of `null`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/util/DataTypeUtils.java`
#### Snippet
```java
  public static Object resolvePartition(String partition, DataType type) {
    if (partition == null) {
      return null;
    }

```

### ReturnNull
Return of `null`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/FormatUtils.java`
#### Snippet
```java
        // Scan all the delta-log files, filling in the queue
        scanner.scan();
        return null;
      }));

```

### ReturnNull
Return of `null`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/FormatUtils.java`
#### Snippet
```java

  private static Object getVal(IndexedRecord record, int pos) {
    return pos == -1 ? null : record.get(pos);
  }

```

### ReturnNull
Return of `null`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/cow/CopyOnWriteInputFormat.java`
#### Snippet
```java
      return getInflaterInputStreamFactory(fileExtension);
    } else {
      return null;
    }
  }
```

### ReturnNull
Return of `null`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/mor/MergeOnReadInputFormat.java`
#### Snippet
```java
  public BaseStatistics getStatistics(BaseStatistics baseStatistics) {
    // statistics not supported yet.
    return null;
  }

```

### ReturnNull
Return of `null`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/configuration/OptionsResolver.java`
#### Snippet
```java
  public static String getPreCombineField(Configuration conf) {
    final String preCombineField = conf.getString(FlinkOptions.PRECOMBINE_FIELD);
    return preCombineField.equals(FlinkOptions.NO_PRE_COMBINE) ? null : preCombineField;
  }

```

### ReturnNull
Return of `null`
in `hudi-flink-datasource/hudi-flink1.13.x/src/main/java/org/apache/hudi/table/format/cow/vector/reader/ArrayColumnReader.java`
#### Snippet
```java
  private Object dictionaryDecodeValue(LogicalType category, Integer dictionaryValue) {
    if (dictionaryValue == null) {
      return null;
    }

```

### ReturnNull
Return of `null`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/source/stats/ColumnStatsIndices.java`
#### Snippet
```java
      }
    }
    return null;
  }

```

### ReturnNull
Return of `null`
in `hudi-flink-datasource/hudi-flink1.14.x/src/main/java/org/apache/hudi/table/format/cow/vector/reader/ArrayColumnReader.java`
#### Snippet
```java
  private Object dictionaryDecodeValue(LogicalType category, Integer dictionaryValue) {
    if (dictionaryValue == null) {
      return null;
    }

```

### ReturnNull
Return of `null`
in `hudi-flink-datasource/hudi-flink1.15.x/src/main/java/org/apache/hudi/table/format/cow/vector/reader/ArrayColumnReader.java`
#### Snippet
```java
  private Object dictionaryDecodeValue(LogicalType category, Integer dictionaryValue) {
    if (dictionaryValue == null) {
      return null;
    }

```

### ReturnNull
Return of `null`
in `hudi-flink-datasource/hudi-flink1.16.x/src/main/java/org/apache/hudi/table/format/cow/vector/reader/ArrayColumnReader.java`
#### Snippet
```java
  private Object dictionaryDecodeValue(LogicalType category, Integer dictionaryValue) {
    if (dictionaryValue == null) {
      return null;
    }

```

### ReturnNull
Return of `null`
in `hudi-spark-datasource/hudi-spark/src/main/java/org/apache/hudi/cli/BootstrapExecutorUtils.java`
#### Snippet
```java
                                                    JavaSparkContext jssc) throws IOException {
    try {
      return StringUtils.isNullOrEmpty(schemaProviderClass) ? null
          : (SchemaProvider) ReflectionUtils.loadClass(schemaProviderClass, cfg, jssc);
    } catch (Throwable e) {
```

### ReturnNull
Return of `null`
in `hudi-spark-datasource/hudi-spark2/src/main/java/org/apache/hudi/internal/DefaultSource.java`
#### Snippet
```java
  @Override
  public DataSourceReader createReader(StructType schema, DataSourceOptions options) {
    return null;
  }

```

### ReturnNull
Return of `null`
in `hudi-spark-datasource/hudi-spark2/src/main/java/org/apache/hudi/internal/DefaultSource.java`
#### Snippet
```java
  @Override
  public DataSourceReader createReader(DataSourceOptions options) {
    return null;
  }

```

### ReturnNull
Return of `null`
in `hudi-common/src/main/java/org/apache/hudi/common/table/TableSchemaResolver.java`
#### Snippet
```java
        }
      }
      return lastBlock != null ? new AvroSchemaConverter().convert(lastBlock.getSchema()) : null;
    }
  }
```

## RuleId[ruleID=AssignmentToLambdaParameter]
### AssignmentToLambdaParameter
Assignment to lambda parameter `leftPartition`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/compact/strategy/DayBasedCompactionStrategy.java`
#### Snippet
```java
  protected static Comparator<String> comparator = (String leftPartition, String rightPartition) -> {
    try {
      leftPartition = getPartitionPathWithoutPartitionKeys(leftPartition);
      rightPartition = getPartitionPathWithoutPartitionKeys(rightPartition);
      Date left = DATE_FORMAT.get().parse(leftPartition);
```

### AssignmentToLambdaParameter
Assignment to lambda parameter `rightPartition`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/compact/strategy/DayBasedCompactionStrategy.java`
#### Snippet
```java
    try {
      leftPartition = getPartitionPathWithoutPartitionKeys(leftPartition);
      rightPartition = getPartitionPathWithoutPartitionKeys(rightPartition);
      Date left = DATE_FORMAT.get().parse(leftPartition);
      Date right = DATE_FORMAT.get().parse(rightPartition);
```

### AssignmentToLambdaParameter
Assignment to lambda parameter `instant`
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieMetadataTableValidator.java`
#### Snippet
```java
        try {
          // convert inflight instant to requested and get clean plan
          instant = new HoodieInstant(HoodieInstant.State.REQUESTED, instant.getAction(), instant.getTimestamp());
          HoodieCleanerPlan cleanerPlan = CleanerUtils.getCleanerPlan(metaClient, instant);

```

## RuleId[ruleID=UnnecessaryLocalVariable]
### UnnecessaryLocalVariable
Local variable `restorePlan` is redundant
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/RestoresCommand.java`
#### Snippet
```java
            restoreInstant.getTimestamp());
    Option<byte[]> instantDetails = activeTimeline.getInstantDetails(instantKey);
    HoodieRestorePlan restorePlan = TimelineMetadataUtils
            .deserializeAvroMetadata(instantDetails.get(), HoodieRestorePlan.class);
    return restorePlan;
```

### UnnecessaryLocalVariable
Local variable `state` is redundant
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/replication/HiveSyncGlobalCommitTool.java`
#### Snippet
```java
        forRemote ? REMOTE_HIVE_SITE_URI : LOCAL_HIVE_SITE_URI)));
    // TODO: get clusterId as input parameters
    ReplicationStateSync state = new ReplicationStateSync(params.mkGlobalHiveSyncProps(forRemote),
        hiveConf, forRemote ? "REMOTESYNC" : "LOCALSYNC");
    return state;
```

### UnnecessaryLocalVariable
Local variable `softDeleteUndoProposal` is redundant
in `hudi-sync/hudi-datahub-sync/src/main/java/org/apache/hudi/sync/datahub/DataHubSyncClient.java`
#### Snippet
```java

  private MetadataChangeProposalWrapper createUndoSoftDelete() {
    MetadataChangeProposalWrapper softDeleteUndoProposal = MetadataChangeProposalWrapper.builder()
            .entityType("dataset")
            .entityUrn(datasetUrn)
```

### UnnecessaryLocalVariable
Local variable `enableBloomFilter` is redundant
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/io/storage/HoodieSparkFileWriterFactory.java`
#### Snippet
```java
      TaskContextSupplier taskContextSupplier) throws IOException {
    boolean populateMetaFields = config.getBooleanOrDefault(HoodieTableConfig.POPULATE_META_FIELDS);
    boolean enableBloomFilter = populateMetaFields;
    Option<BloomFilter> filter = enableBloomFilter ? Option.of(createBloomFilter(config)) : Option.empty();
    String compressionCodecName = config.getStringOrDefault(HoodieStorageConfig.PARQUET_COMPRESSION_CODEC_NAME);
```

### UnnecessaryLocalVariable
Local variable `partitionPathToInPendingClusteringFileId` is redundant
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/table/action/commit/UpsertPartitioner.java`
#### Snippet
```java
   */
  private Map<String, Set<String>> getPartitionPathToPendingClusteringFileGroupsId() {
    Map<String, Set<String>>  partitionPathToInPendingClusteringFileId =
        table.getFileSystemView().getFileGroupsInPendingClustering()
            .map(fileGroupIdAndInstantPair ->
```

### UnnecessaryLocalVariable
Local variable `rec` is redundant
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/table/action/bootstrap/OrcBootstrapMetadataHandler.java`
#### Snippet
```java
        gr.put(HoodieRecord.RECORD_KEY_METADATA_FIELD, recKey);
        BootstrapRecordPayload payload = new BootstrapRecordPayload(gr);
        HoodieRecord rec = new HoodieAvroRecord(new HoodieKey(recKey, partitionPath), payload);
        return rec;
      }, table.getPreExecuteRunnable());
```

### UnnecessaryLocalVariable
Local variable `numRSAlive` is redundant
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/index/hbase/SparkHoodieHBaseIndex.java`
#### Snippet
```java
    public int getBatchSize(int numRegionServersForTable, int maxQpsPerRegionServer,
                            int numTasksDuringPut, int maxExecutors, float qpsFraction) {
      int numRSAlive = numRegionServersForTable;
      int maxReqPerSec = getMaxReqPerSec(numRSAlive, maxQpsPerRegionServer, qpsFraction);
      int numTasks = numTasksDuringPut;
```

### UnnecessaryLocalVariable
Local variable `numTasks` is redundant
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/index/hbase/SparkHoodieHBaseIndex.java`
#### Snippet
```java
      int numRSAlive = numRegionServersForTable;
      int maxReqPerSec = getMaxReqPerSec(numRSAlive, maxQpsPerRegionServer, qpsFraction);
      int numTasks = numTasksDuringPut;
      int maxParallelPutsTask = Math.max(1, Math.min(numTasks, maxExecutors));
      int multiPutBatchSizePerSecPerTask = Math.max(1, (int) Math.ceil(maxReqPerSec / maxParallelPutsTask));
```

### UnnecessaryLocalVariable
Local variable `schema` is redundant
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/bootstrap/HoodieSparkBootstrapSchemaProvider.java`
#### Snippet
```java
  @Override
  protected Schema getBootstrapSourceSchema(HoodieEngineContext context, List<Pair<String, List<HoodieFileStatus>>> partitions) {
    Schema schema = partitions.stream().flatMap(p -> p.getValue().stream()).map(fs -> {
          Path filePath = FileStatusUtils.toPath(fs.getPath());
          String extension = FSUtils.getFileExtension(filePath.getName());
```

### UnnecessaryLocalVariable
Local variable `hoodieRecord` is redundant
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/clustering/run/strategy/ExecutionStrategyUtil.java`
#### Snippet
```java

    HoodieRecordPayload avroPayload = new RewriteAvroPayload(record);
    HoodieRecord hoodieRecord = new HoodieAvroRecord(hoodieKey, avroPayload);
    return hoodieRecord;
  }
```

### UnnecessaryLocalVariable
Local variable `mappingIterator` is redundant
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/clustering/run/strategy/SingleSparkJobExecutionStrategy.java`
#### Snippet
```java
          //       payload pointing into a shared, mutable (underlying) buffer we get a clean copy of
          //       it since these records will be shuffled later.
          CloseableMappingIterator mappingIterator = new CloseableMappingIterator((ClosableIterator<HoodieRecord>) baseFileReader.getRecordIterator(readerSchema),
              rec -> ((HoodieRecord) rec).copy().wrapIntoHoodieRecordPayloadWithKeyGen(readerSchema,
                  getWriteConfig().getProps(), keyGeneratorOp));
```

### UnnecessaryLocalVariable
Local variable `keyPartStr` is redundant
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/keygen/StringPartitionPathFormatter.java`
#### Snippet
```java
    } else {
      // NOTE: [[toString]] is a no-op if key-part was already a [[String]]
      String keyPartStr = partitionPathPart;
      return keyPartStr.isEmpty() ? HUDI_DEFAULT_PARTITION_PATH : keyPartStr;
    }
```

### UnnecessaryLocalVariable
Local variable `hoodieRecord` is redundant
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/execution/bulkinsert/RDDSpatialCurveSortPartitioner.java`
#### Snippet
```java
            String partition = record.get(HoodieRecord.PARTITION_PATH_METADATA_FIELD).toString();
            HoodieKey hoodieKey = new HoodieKey(key, partition);
            HoodieRecord hoodieRecord = new HoodieAvroRecord(hoodieKey, new RewriteAvroPayload(record));
            return hoodieRecord;
          });
```

### UnnecessaryLocalVariable
Local variable `sortColumns` is redundant
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/execution/bulkinsert/RowCustomColumnsSortPartitioner.java`
#### Snippet
```java
  @Override
  public Dataset<Row> repartitionRecords(Dataset<Row> records, int outputSparkPartitions) {
    final String[] sortColumns = this.sortColumnNames;
    return records.sort(HoodieRecord.PARTITION_PATH_METADATA_FIELD, sortColumns)
        .coalesce(outputSparkPartitions);
```

### UnnecessaryLocalVariable
Local variable `executionStrategy` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/compact/HoodieCompactor.java`
#### Snippet
```java
      return new CompactionExecutionHelper();
    } else {
      CompactionExecutionHelper executionStrategy = ReflectionUtils.loadClass(compactionPlan.getStrategy().getCompactorClassName());
      return executionStrategy;
    }
```

### UnnecessaryLocalVariable
Local variable `maxInstantTime` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/compact/HoodieCompactor.java`
#### Snippet
```java

  public String getMaxInstantTime(HoodieTableMetaClient metaClient) {
    String maxInstantTime = metaClient
        .getActiveTimeline().getTimelineOfActions(CollectionUtils.createSet(HoodieTimeline.COMMIT_ACTION,
            HoodieTimeline.ROLLBACK_ACTION, HoodieTimeline.DELTA_COMMIT_ACTION))
```

### UnnecessaryLocalVariable
Local variable `inflightTimelineExcludeClusteringCommit` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/BaseHoodieTableServiceClient.java`
#### Snippet
```java
  private HoodieTimeline getInflightTimelineExcludeCompactionAndClustering(HoodieTableMetaClient metaClient) {
    HoodieTimeline inflightTimelineWithReplaceCommit = metaClient.getCommitsTimeline().filterPendingExcludingCompaction();
    HoodieTimeline inflightTimelineExcludeClusteringCommit = inflightTimelineWithReplaceCommit.filter(instant -> {
      if (instant.getAction().equals(HoodieTimeline.REPLACE_COMMIT_ACTION)) {
        Option<Pair<HoodieInstant, HoodieClusteringPlan>> instantPlan = ClusteringUtils.getClusteringPlan(metaClient, instant);
```

### UnnecessaryLocalVariable
Local variable `enableBloomFilter` is redundant
in `hudi-common/src/main/java/org/apache/hudi/io/storage/HoodieAvroFileWriterFactory.java`
#### Snippet
```java
      TaskContextSupplier taskContextSupplier) throws IOException {
    boolean populateMetaFields = config.getBooleanOrDefault(HoodieTableConfig.POPULATE_META_FIELDS);
    boolean enableBloomFilter = populateMetaFields;
    Option<BloomFilter> filter = enableBloomFilter ? Option.of(createBloomFilter(config)) : Option.empty();
    HoodieAvroWriteSupport writeSupport = new HoodieAvroWriteSupport(new AvroSchemaConverter(conf).convert(schema), schema, filter);
```

### UnnecessaryLocalVariable
Local variable `newTableMetadata` is redundant
in `hudi-common/src/main/java/org/apache/hudi/BaseHoodieTableFileIndex.java`
#### Snippet
```java
      Path basePath
  ) {
    HoodieTableMetadata newTableMetadata = HoodieTableMetadata.create(engineContext, metadataConfig, basePath.toString(),
        FileSystemViewStorageConfig.SPILLABLE_DIR.defaultValue(), true);
    return newTableMetadata;
```

### UnnecessaryLocalVariable
Local variable `toReturn` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/fs/inline/InLineFileSystem.java`
#### Snippet
```java
    FileSystem outerFs = outerPath.getFileSystem(conf);
    FileStatus status = outerFs.getFileStatus(outerPath);
    FileStatus toReturn = new FileStatus(InLineFSUtils.length(inlinePath), status.isDirectory(), status.getReplication(), status.getBlockSize(),
        status.getModificationTime(), status.getAccessTime(), status.getPermission(), status.getOwner(),
        status.getGroup(), inlinePath);
```

### UnnecessaryLocalVariable
Local variable `julianDays` is redundant
in `hudi-common/src/main/java/org/apache/hudi/avro/HoodieAvroUtils.java`
#### Snippet
```java
    long millisUtc = date.getTime();
    long millisLocal = millisUtc + TimeZone.getDefault().getOffset(millisUtc);
    int julianDays = Math.toIntExact(Math.floorDiv(millisLocal, MILLIS_PER_DAY));
    return julianDays;
  }
```

### UnnecessaryLocalVariable
Local variable `nullUnion` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/util/AvroOrcUtils.java`
#### Snippet
```java
      case NULL:
        // empty union represents null type
        final TypeDescription nullUnion = TypeDescription.createUnion();
        return nullUnion;
      case LONG:
```

### UnnecessaryLocalVariable
Local variable `hoodieRecord` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieAvroIndexedRecord.java`
#### Snippet
```java

    HoodieRecordPayload avroPayload = new RewriteAvroPayload(record);
    HoodieRecord hoodieRecord = new HoodieAvroRecord(hoodieKey, avroPayload);
    return hoodieRecord;
  }
```

### UnnecessaryLocalVariable
Local variable `iterator` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/block/HoodieParquetDataBlock.java`
#### Snippet
```java
    Schema writerSchema = new Schema.Parser().parse(this.getLogBlockHeader().get(HeaderMetadataType.SCHEMA));

    ClosableIterator<HoodieRecord<T>> iterator = HoodieFileReaderFactory.getReaderFactory(type).getFileReader(inlineConf, inlineLogFilePath, PARQUET)
        .getRecordIterator(writerSchema, readerSchema);
    return iterator;
```

### UnnecessaryLocalVariable
Local variable `reservedForExternalDataFile` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/FileSystemViewStorageConfig.java`
#### Snippet
```java
  public long getMaxMemoryForBootstrapBaseFile() {
    long totalMemory = getLong(SPILLABLE_MEMORY);
    long reservedForExternalDataFile =
        new Double(totalMemory * getDouble(BOOTSTRAP_BASE_FILE_MEM_FRACTION))
            .longValue();
```

### UnnecessaryLocalVariable
Local variable `fgInpendingClustering` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/HoodieTableFileSystemView.java`
#### Snippet
```java

  protected Map<HoodieFileGroupId, HoodieInstant> createFileIdToPendingClusteringMap(final Map<HoodieFileGroupId, HoodieInstant> fileGroupsInClustering) {
    Map<HoodieFileGroupId, HoodieInstant> fgInpendingClustering = new ConcurrentHashMap<>(fileGroupsInClustering);
    return fgInpendingClustering;
  }
```

### UnnecessaryLocalVariable
Local variable `replacedFileGroupsMap` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/HoodieTableFileSystemView.java`
#### Snippet
```java

  protected Map<HoodieFileGroupId, HoodieInstant> createFileIdToReplaceInstantMap(final Map<HoodieFileGroupId, HoodieInstant> replacedFileGroups) {
    Map<HoodieFileGroupId, HoodieInstant> replacedFileGroupsMap = new ConcurrentHashMap<>(replacedFileGroups);
    return replacedFileGroupsMap;
  }
```

### UnnecessaryLocalVariable
Local variable `status` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/IncrementalTimelineSyncFileSystemView.java`
#### Snippet
```java
        LOG.info("Syncing partition (" + partition + ") of instant (" + instant + ")");
        FileStatus[] statuses = entry.getValue().stream().map(p -> {
          FileStatus status = new FileStatus(p.getFileSizeInBytes(), false, 0, 0, 0, 0, null, null, null,
              new Path(String.format("%s/%s", metaClient.getBasePath(), p.getPath())));
          return status;
```

### UnnecessaryLocalVariable
Local variable `configProperty` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/config/ConfigProperty.java`
#### Snippet
```java
      Objects.requireNonNull(value);
      Objects.requireNonNull(docOnDefaultValue);
      ConfigProperty<T> configProperty = new ConfigProperty<>(key, value, docOnDefaultValue, "", Option.empty(), Option.empty(), Option.empty(), Collections.emptySet());
      return configProperty;
    }
```

### UnnecessaryLocalVariable
Local variable `configProperty` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/config/ConfigProperty.java`
#### Snippet
```java

    public ConfigProperty<String> noDefaultValue(String docOnDefaultValue) {
      ConfigProperty<String> configProperty = new ConfigProperty<>(key, null, docOnDefaultValue, "", Option.empty(),
          Option.empty(), Option.empty(), Collections.emptySet());
      return configProperty;
```

### UnnecessaryLocalVariable
Local variable `snapshotBeforeDelete` is redundant
in `hudi-examples/hudi-examples-spark/src/main/java/org/apache/hudi/examples/quickstart/HoodieSparkQuickstart.java`
#### Snippet
```java
    pointInTimeQuery(spark, tablePath, tableName);

    Dataset<Row> snapshotBeforeDelete = snapshotAfterUpdate;
    Dataset<Row> deleteDf = delete(spark, tablePath, tableName);
    queryData(spark, jsc, tablePath, tableName, dataGen);
```

### UnnecessaryLocalVariable
Local variable `snapshotBeforeOverwrite` is redundant
in `hudi-examples/hudi-examples-spark/src/main/java/org/apache/hudi/examples/quickstart/HoodieSparkQuickstart.java`
#### Snippet
```java
    assert snapshotBeforeDelete.except(deleteDf).except(snapshotAfterDelete).count() == 0;

    Dataset<Row> snapshotBeforeOverwrite = snapshotAfterDelete;
    Dataset<Row> overwriteDf = insertOverwriteData(spark, jsc, tablePath, tableName, dataGen);
    queryData(spark, jsc, tablePath, tableName, dataGen);
```

### UnnecessaryLocalVariable
Local variable `snapshotBeforeDeleteByPartition` is redundant
in `hudi-examples/hudi-examples-spark/src/main/java/org/apache/hudi/examples/quickstart/HoodieSparkQuickstart.java`
#### Snippet
```java


    Dataset<Row> snapshotBeforeDeleteByPartition = snapshotAfterOverwrite;
    deleteByPartition(spark, tablePath, tableName);
    queryData(spark, jsc, tablePath, tableName, dataGen);
```

### UnnecessaryLocalVariable
Local variable `fixed` is redundant
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/utils/HiveAvroSerializer.java`
#### Snippet
```java
          return AvroSerdeUtils.getBufferFromBytes((byte[])fieldOI.getPrimitiveJavaObject(structFieldData));
        } else if (schema.getType() == Schema.Type.FIXED) {
          GenericData.Fixed fixed = new GenericData.Fixed(schema, (byte[])fieldOI.getPrimitiveJavaObject(structFieldData));
          return fixed;
        } else {
```

### UnnecessaryLocalVariable
Local variable `record` is redundant
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/realtime/RealtimeCompactedRecordReader.java`
#### Snippet
```java

  private GenericRecord convertArrayWritableToHoodieRecord(ArrayWritable arrayWritable) {
    GenericRecord record = serializer.serialize(arrayWritable, getHiveSchema());
    return record;
  }
```

### UnnecessaryLocalVariable
Local variable `columnRangeMetadataList` is redundant
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieTableMetadataUtil.java`
#### Snippet
```java
      if (filePath.endsWith(HoodieFileFormat.PARQUET.getFileExtension())) {
        Path fullFilePath = new Path(datasetMetaClient.getBasePath(), filePath);
        List<HoodieColumnRangeMetadata<Comparable>> columnRangeMetadataList =
            new ParquetUtils().readRangeFromParquetMetadata(datasetMetaClient.getHadoopConf(), fullFilePath, columnsToIndex);

```

### UnnecessaryLocalVariable
Local variable `ret` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieCompactor.java`
#### Snippet
```java
    LOG.info(cfg);

    int ret = UtilHelpers.retry(retry, () -> {
      switch (cfg.runningMode.toLowerCase()) {
        case SCHEDULE: {
```

### UnnecessaryLocalVariable
Local variable `recordMerger` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/UtilHelpers.java`
#### Snippet
```java
    List<String> recordMergerImplClasses = ConfigUtils.split2List(props.getProperty(HoodieWriteConfig.RECORD_MERGER_IMPLS.key(),
        HoodieWriteConfig.RECORD_MERGER_IMPLS.defaultValue()));
    HoodieRecordMerger recordMerger = HoodieRecordUtils.createRecordMerger(null, EngineType.SPARK, recordMergerImplClasses,
        props.getProperty(HoodieWriteConfig.RECORD_MERGER_STRATEGY.key(), HoodieWriteConfig.RECORD_MERGER_STRATEGY.defaultValue()));

```

## RuleId[ruleID=BusyWait]
### BusyWait
Call to `Thread.sleep()` in a loop, probably busy-waiting
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/index/RunIndexActionExecutor.java`
#### Snippet
```java
            instant = currentInstant.orElse(instant);
            // so that timeline is not reloaded very frequently
            Thread.sleep(TIMELINE_RELOAD_INTERVAL_MILLIS);
          } catch (InterruptedException e) {
            throw new HoodieIndexException(String.format("Thread interrupted while running indexing check for instant: %s", instant), e);
```

### BusyWait
Call to `Thread.sleep()` in a loop, probably busy-waiting
in `hudi-common/src/main/java/org/apache/hudi/common/util/RateLimiter.java`
#### Snippet
```java
    try {
      while (!semaphore.tryAcquire(numOps)) {
        Thread.sleep(WAIT_BEFORE_NEXT_ACQUIRE_PERMIT_IN_MS);
      }
      LOG.debug(String.format("acquire permits: %s, maxPremits: %s", numOps, maxPermits));
```

### BusyWait
Call to `Thread.sleep()` in a loop, probably busy-waiting
in `hudi-common/src/main/java/org/apache/hudi/common/util/RetryHelper.java`
#### Snippet
```java
        LOG.warn("Catch Exception for " + taskInfo + ", will retry after " + waitTime + " ms.", e);
        try {
          Thread.sleep(waitTime);
        } catch (InterruptedException ex) {
          // ignore InterruptedException here
```

### BusyWait
Call to `Thread.sleep()` in a loop, probably busy-waiting
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDataTableValidator.java`
#### Snippet
```java
              LOG.info("Last validate ran less than min validate interval: " + cfg.minValidateIntervalSeconds + " s, sleep: "
                  + toSleepMs + " ms.");
              Thread.sleep(toSleepMs);
            }
          } catch (HoodieValidationException e) {
```

### BusyWait
Call to `Thread.sleep()` in a loop, probably busy-waiting
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/perf/TimelineServerPerf.java`
#### Snippet
```java
      while (true) {
        try {
          Thread.sleep(60000);
        } catch (InterruptedException e) {
          // skip it
```

### BusyWait
Call to `Thread.sleep()` in a loop, probably busy-waiting
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieMetadataTableValidator.java`
#### Snippet
```java
              LOG.info("Last validate ran less than min validate interval: " + cfg.minValidateIntervalSeconds + " s, sleep: "
                  + toSleepMs + " ms.");
              Thread.sleep(toSleepMs);
            }
          } catch (HoodieValidationException e) {
```

### BusyWait
Call to `Thread.sleep()` in a loop, probably busy-waiting
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/HoodieDeltaStreamer.java`
#### Snippet
```java
                LOG.info("Last sync ran less than min sync interval: " + cfg.minSyncIntervalSeconds + " s, sleep: "
                    + toSleepMs + " ms.");
                Thread.sleep(toSleepMs);
              }
            } catch (HoodieUpsertException ue) {
```

### BusyWait
Call to `Thread.sleep()` in a loop, probably busy-waiting
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/compact/HoodieFlinkCompactor.java`
#### Snippet
```java
            try {
              compact();
              Thread.sleep(cfg.minCompactionIntervalSeconds * 1000);
            } catch (ApplicationExecutionException aee) {
              if (aee.getMessage().contains(NO_EXECUTE_KEYWORD)) {
```

### BusyWait
Call to `Thread.sleep()` in a loop, probably busy-waiting
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/clustering/HoodieFlinkClusteringJob.java`
#### Snippet
```java
            try {
              cluster();
              Thread.sleep(cfg.minClusteringIntervalSeconds * 1000);
            } catch (ApplicationExecutionException aee) {
              if (aee.getMessage().contains(NO_EXECUTE_KEYWORD)) {
```

## RuleId[ruleID=UseBulkOperation]
### UseBulkOperation
Iteration can be replaced with bulk 'Map.putAll()' call
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/deser/KafkaAvroSchemaDeserializer.java`
#### Snippet
```java
    TypedProperties typedProperties = new TypedProperties();
    for (Entry<String, ?> entry : configs.entrySet()) {
      typedProperties.put(entry.getKey(), entry.getValue());
    }
    return typedProperties;
```

## RuleId[ruleID=ObsoleteCollection]
### ObsoleteCollection
Obsolete collection type `Hashtable<>` used
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/upgrade/ThreeToFourUpgradeHandler.java`
#### Snippet
```java
  @Override
  public Map<ConfigProperty, String> upgrade(HoodieWriteConfig config, HoodieEngineContext context, String instantTime, SupportsUpgradeDowngrade upgradeDowngradeHelper) {
    Map<ConfigProperty, String> tablePropsToAdd = new Hashtable<>();
    tablePropsToAdd.put(TABLE_CHECKSUM, String.valueOf(HoodieTableConfig.generateChecksum(config.getProps())));
    // if metadata is enabled and files partition exist then update TABLE_METADATA_INDEX_COMPLETED
```

### ObsoleteCollection
Obsolete collection type `Hashtable<>` used
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/upgrade/TwoToThreeUpgradeHandler.java`
#### Snippet
```java
      HoodieTableMetadataUtil.deleteMetadataTable(config.getBasePath(), context);
    }
    Map<ConfigProperty, String> tablePropsToAdd = new Hashtable<>();
    tablePropsToAdd.put(HoodieTableConfig.URL_ENCODE_PARTITIONING, config.getStringOrDefault(HoodieTableConfig.URL_ENCODE_PARTITIONING));
    tablePropsToAdd.put(HoodieTableConfig.HIVE_STYLE_PARTITIONING_ENABLE, config.getStringOrDefault(HoodieTableConfig.HIVE_STYLE_PARTITIONING_ENABLE));
```

### ObsoleteCollection
Obsolete collection type `Hashtable<>` used
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/upgrade/OneToTwoUpgradeHandler.java`
#### Snippet
```java
      HoodieWriteConfig config, HoodieEngineContext context, String instantTime,
      SupportsUpgradeDowngrade upgradeDowngradeHelper) {
    Map<ConfigProperty, String> tablePropsToAdd = new Hashtable<>();
    tablePropsToAdd.put(HoodieTableConfig.PARTITION_FIELDS, upgradeDowngradeHelper.getPartitionColumns(config));
    tablePropsToAdd.put(HoodieTableConfig.RECORDKEY_FIELDS, config.getString(KeyGeneratorOptions.RECORDKEY_FIELD_NAME.key()));
```

### ObsoleteCollection
Obsolete collection type `Hashtable<>` used
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/upgrade/UpgradeDowngrade.java`
#### Snippet
```java
    // Perform the actual upgrade/downgrade; this has to be idempotent, for now.
    LOG.info("Attempting to move table from version " + fromVersion + " to " + toVersion);
    Map<ConfigProperty, String> tableProps = new Hashtable<>();
    if (fromVersion.versionCode() < toVersion.versionCode()) {
      // upgrade
```

## RuleId[ruleID=RedundantArrayCreation]
### RedundantArrayCreation
Redundant array creation for calling varargs method
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/SchemaEvolutionContext.java`
#### Snippet
```java
        return typeInfo;
      case TIME:
        throw new UnsupportedOperationException(String.format("cannot convert %s type to hive", new Object[] { type }));
      default:
        LOG.error(String.format("cannot convert unknown type: %s to Hive", new Object[] { type }));
```

### RedundantArrayCreation
Redundant array creation for calling varargs method
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/SchemaEvolutionContext.java`
#### Snippet
```java
        throw new UnsupportedOperationException(String.format("cannot convert %s type to hive", new Object[] { type }));
      default:
        LOG.error(String.format("cannot convert unknown type: %s to Hive", new Object[] { type }));
        throw new UnsupportedOperationException(String.format("cannot convert unknown type: %s to Hive", new Object[] { type }));
    }
```

### RedundantArrayCreation
Redundant array creation for calling varargs method
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/SchemaEvolutionContext.java`
#### Snippet
```java
      default:
        LOG.error(String.format("cannot convert unknown type: %s to Hive", new Object[] { type }));
        throw new UnsupportedOperationException(String.format("cannot convert unknown type: %s to Hive", new Object[] { type }));
    }
  }
```

## RuleId[ruleID=DuplicateBranchesInSwitch]
### DuplicateBranchesInSwitch
Branch in 'switch' is a duplicate of the default branch
in `hudi-cli/src/main/java/org/apache/hudi/cli/HoodiePrompt.java`
#### Snippet
```java
          return new AttributedString("hudi->");
        case TABLE:
          return new AttributedString("hudi:" + tableName + "->");
        case SYNC:
          return new AttributedString("hudi:" + tableName + " <==> " + HoodieCLI.syncTableMetadata.getTableConfig().getTableName() + "->");
```

### DuplicateBranchesInSwitch
Duplicate branch in 'switch'
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/io/storage/row/parquet/ParquetSchemaConverter.java`
#### Snippet
```java
                break;
              case INT_32:
                typeInfo = BasicTypeInfo.INT_TYPE_INFO;
                break;
              default:
```

### DuplicateBranchesInSwitch
Duplicate branch in 'switch'
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/index/SparkHoodieIndexFactory.java`
#### Snippet
```java
        return true;
      case INMEMORY:
        return true;
      case BLOOM:
        return false;
```

### DuplicateBranchesInSwitch
Duplicate branch in 'switch'
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/index/SparkHoodieIndexFactory.java`
#### Snippet
```java
        return false;
      case GLOBAL_BLOOM:
        return true;
      case SIMPLE:
        return false;
```

### DuplicateBranchesInSwitch
Duplicate branch in 'switch'
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/index/SparkHoodieIndexFactory.java`
#### Snippet
```java
        return true;
      case SIMPLE:
        return false;
      case GLOBAL_SIMPLE:
        return true;
```

### DuplicateBranchesInSwitch
Duplicate branch in 'switch'
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/index/SparkHoodieIndexFactory.java`
#### Snippet
```java
        return false;
      case GLOBAL_SIMPLE:
        return true;
      case BUCKET:
        return false;
```

### DuplicateBranchesInSwitch
Duplicate branch in 'switch'
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/index/SparkHoodieIndexFactory.java`
#### Snippet
```java
        return true;
      case BUCKET:
        return false;
      default:
        return createIndex(config).isGlobal();
```

### DuplicateBranchesInSwitch
Duplicate branch in 'switch'
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/utils/SparkInternalSchemaConverter.java`
#### Snippet
```java
        return StringType$.MODULE$;
      case UUID:
        return StringType$.MODULE$;
      case FIXED:
        return BinaryType$.MODULE$;
```

### DuplicateBranchesInSwitch
Duplicate branch in 'switch'
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/utils/SparkInternalSchemaConverter.java`
#### Snippet
```java
        return BinaryType$.MODULE$;
      case BINARY:
        return BinaryType$.MODULE$;
      case DECIMAL:
        Types.DecimalType decimal = (Types.DecimalType) type;
```

### DuplicateBranchesInSwitch
Duplicate branch in 'switch'
in `hudi-common/src/main/java/org/apache/hudi/avro/AvroSchemaCompatibility.java`
#### Snippet
```java
            return result.mergedWith(typeMismatch(reader, writer, locations));
          case BOOLEAN:
            return result.mergedWith(typeMismatch(reader, writer, locations));
          case INT:
            return result.mergedWith(typeMismatch(reader, writer, locations));
```

### DuplicateBranchesInSwitch
Duplicate branch in 'switch'
in `hudi-common/src/main/java/org/apache/hudi/avro/AvroSchemaCompatibility.java`
#### Snippet
```java
            return result.mergedWith(typeMismatch(reader, writer, locations));
          case INT:
            return result.mergedWith(typeMismatch(reader, writer, locations));
          case LONG: {
            return (writer.getType() == Type.INT) ? result : result.mergedWith(typeMismatch(reader, writer, locations));
```

### DuplicateBranchesInSwitch
Duplicate branch in 'switch'
in `hudi-common/src/main/java/org/apache/hudi/avro/AvroSchemaCompatibility.java`
#### Snippet
```java

          case ARRAY:
            return result.mergedWith(typeMismatch(reader, writer, locations));
          case MAP:
            return result.mergedWith(typeMismatch(reader, writer, locations));
```

### DuplicateBranchesInSwitch
Duplicate branch in 'switch'
in `hudi-common/src/main/java/org/apache/hudi/avro/AvroSchemaCompatibility.java`
#### Snippet
```java
            return result.mergedWith(typeMismatch(reader, writer, locations));
          case MAP:
            return result.mergedWith(typeMismatch(reader, writer, locations));
          case FIXED:
            return result.mergedWith(typeMismatch(reader, writer, locations));
```

### DuplicateBranchesInSwitch
Duplicate branch in 'switch'
in `hudi-common/src/main/java/org/apache/hudi/avro/AvroSchemaCompatibility.java`
#### Snippet
```java
            return result.mergedWith(typeMismatch(reader, writer, locations));
          case FIXED:
            return result.mergedWith(typeMismatch(reader, writer, locations));
          case ENUM:
            return result.mergedWith(typeMismatch(reader, writer, locations));
```

### DuplicateBranchesInSwitch
Duplicate branch in 'switch'
in `hudi-common/src/main/java/org/apache/hudi/avro/AvroSchemaCompatibility.java`
#### Snippet
```java
            return result.mergedWith(typeMismatch(reader, writer, locations));
          case ENUM:
            return result.mergedWith(typeMismatch(reader, writer, locations));
          case RECORD:
            return result.mergedWith(typeMismatch(reader, writer, locations));
```

### DuplicateBranchesInSwitch
Duplicate branch in 'switch'
in `hudi-common/src/main/java/org/apache/hudi/avro/AvroSchemaCompatibility.java`
#### Snippet
```java
            return result.mergedWith(typeMismatch(reader, writer, locations));
          case RECORD:
            return result.mergedWith(typeMismatch(reader, writer, locations));
          case UNION: {
            for (final Schema readerBranch : reader.getTypes()) {
```

### DuplicateBranchesInSwitch
Duplicate branch in 'switch'
in `hudi-common/src/main/java/org/apache/hudi/common/util/AvroOrcUtils.java`
#### Snippet
```java
      case SHORT:
        // smallint (16 bit), use int to hold it
        return Schema.create(Schema.Type.INT);
      case INT:
        // the Avro logical type could be AvroTypeUtil.LOGICAL_TYPE_TIME_MILLIS, but there is no way to distinguish
```

### DuplicateBranchesInSwitch
Duplicate branch in 'switch'
in `hudi-common/src/main/java/org/apache/hudi/common/util/AvroOrcUtils.java`
#### Snippet
```java
      case INT:
        // the Avro logical type could be AvroTypeUtil.LOGICAL_TYPE_TIME_MILLIS, but there is no way to distinguish
        return Schema.create(Schema.Type.INT);
      case LONG:
        // the Avro logical type could be AvroTypeUtil.LOGICAL_TYPE_TIME_MICROS, but there is no way to distinguish
```

### DuplicateBranchesInSwitch
Duplicate branch in 'switch'
in `hudi-common/src/main/java/org/apache/hudi/common/util/AvroOrcUtils.java`
#### Snippet
```java
      case ENUM:
        // represent as String for now
        return TypeDescription.createString();
      case FIXED:
        return TypeDescription.createBinary();
```

### DuplicateBranchesInSwitch
Duplicate branch in 'switch'
in `hudi-common/src/main/java/org/apache/hudi/common/util/AvroOrcUtils.java`
#### Snippet
```java
        return TypeDescription.createString();
      case FIXED:
        return TypeDescription.createBinary();
      default:
        throw new IllegalStateException(String.format("Unrecognized Avro type: %s", type.getName()));
```

### DuplicateBranchesInSwitch
Duplicate branch in 'switch'
in `hudi-common/src/main/java/org/apache/hudi/common/util/AvroOrcUtils.java`
#### Snippet
```java
      case DATE:
        // convert to daysSinceEpoch for LogicalType.Date
        return (int) ((LongColumnVector) colVector).vector[vectorPos];
      case TIMESTAMP:
        // The unit of time in ORC is millis. Convert (time,nanos) to the desired unit per logicalType
```

### DuplicateBranchesInSwitch
Duplicate branch in 'switch'
in `hudi-common/src/main/java/org/apache/hudi/common/util/AvroOrcUtils.java`
#### Snippet
```java
      case SHORT:
        // smallint (16 bit), use int to hold it
        return Schema.create(Schema.Type.INT);
      case INT:
        // the Avro logical type could be AvroTypeUtil.LOGICAL_TYPE_TIME_MILLIS, but there is no way to distinguish
```

### DuplicateBranchesInSwitch
Duplicate branch in 'switch'
in `hudi-common/src/main/java/org/apache/hudi/common/util/AvroOrcUtils.java`
#### Snippet
```java
      case INT:
        // the Avro logical type could be AvroTypeUtil.LOGICAL_TYPE_TIME_MILLIS, but there is no way to distinguish
        return Schema.create(Schema.Type.INT);
      case LONG:
        // the Avro logical type could be AvroTypeUtil.LOGICAL_TYPE_TIME_MICROS, but there is no way to distinguish
```

### DuplicateBranchesInSwitch
Branch in 'switch' is a duplicate of the default branch
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/HoodieLogFormatVersion.java`
#### Snippet
```java
    switch (super.getVersion()) {
      case DEFAULT_VERSION:
        return false;
      case 1:
        return true;
```

### DuplicateBranchesInSwitch
Branch in 'switch' is a duplicate of the default branch
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/HoodieLogFormatVersion.java`
#### Snippet
```java
    switch (super.getVersion()) {
      case DEFAULT_VERSION:
        return true;
      default:
        return true;
```

### DuplicateBranchesInSwitch
Branch in 'switch' is a duplicate of the default branch
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/HoodieLogFormatVersion.java`
#### Snippet
```java
    switch (super.getVersion()) {
      case DEFAULT_VERSION:
        return false;
      case 1:
        return true;
```

### DuplicateBranchesInSwitch
Branch in 'switch' is a duplicate of the default branch
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/HoodieLogFormatVersion.java`
#### Snippet
```java
    switch (super.getVersion()) {
      case DEFAULT_VERSION:
        return true;
      default:
        return true;
```

### DuplicateBranchesInSwitch
Branch in 'switch' is a duplicate of the default branch
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/HoodieLogFormatVersion.java`
#### Snippet
```java
    switch (super.getVersion()) {
      case DEFAULT_VERSION:
        return true;
      default:
        return true;
```

### DuplicateBranchesInSwitch
Branch in 'switch' is a duplicate of the default branch
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/HoodieLogFormatVersion.java`
#### Snippet
```java
    switch (super.getVersion()) {
      case DEFAULT_VERSION:
        return true;
      default:
        return true;
```

### DuplicateBranchesInSwitch
Branch in 'switch' is a duplicate of the default branch
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/block/HoodieAvroDataBlockVersion.java`
#### Snippet
```java
    switch (super.getVersion()) {
      case DEFAULT_VERSION:
        return true;
      default:
        return true;
```

### DuplicateBranchesInSwitch
Branch in 'switch' is a duplicate of the default branch
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/utils/HoodieRealtimeRecordReaderUtils.java`
#### Snippet
```java
        return new BooleanWritable((Boolean) value);
      case NULL:
        return null;
      case RECORD:
        GenericRecord record = (GenericRecord) value;
```

### DuplicateBranchesInSwitch
Duplicate branch in 'switch'
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/utils/HoodieRealtimeRecordReaderUtils.java`
#### Snippet
```java
        return new ArrayWritable(Writable.class, recordValues);
      case ENUM:
        return new Text(value.toString());
      case ARRAY:
        GenericArray arrayValue = (GenericArray) value;
```

### DuplicateBranchesInSwitch
Duplicate branch in 'switch'
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/utils/HoodieInputFormatUtils.java`
#### Snippet
```java
        return MapredParquetOutputFormat.class.getName();
      case HFILE:
        return MapredParquetOutputFormat.class.getName();
      case ORC:
        return OrcOutputFormat.class.getName();
```

### DuplicateBranchesInSwitch
Duplicate branch in 'switch'
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/utils/HoodieInputFormatUtils.java`
#### Snippet
```java
        return ParquetHiveSerDe.class.getName();
      case HFILE:
        return ParquetHiveSerDe.class.getName();
      case ORC:
        return OrcSerde.class.getName();
```

## RuleId[ruleID=StringBufferReplaceableByString]
### StringBufferReplaceableByString
`StringBuilder` can be replaced with 'String'
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/execution/bulkinsert/JavaGlobalSortPartitioner.java`
#### Snippet
```java
        HoodieRecord o11 = (HoodieRecord) o1;
        HoodieRecord o22 = (HoodieRecord) o2;
        String left = new StringBuilder()
            .append(o11.getPartitionPath())
            .append("+")
```

### StringBufferReplaceableByString
`StringBuilder` can be replaced with 'String'
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/execution/bulkinsert/JavaGlobalSortPartitioner.java`
#### Snippet
```java
            .append(o11.getRecordKey())
            .toString();
        String right = new StringBuilder()
            .append(o22.getPartitionPath())
            .append("+")
```

### StringBufferReplaceableByString
`StringBuilder` can be replaced with 'String'
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/util/HiveSchemaUtil.java`
#### Snippet
```java
    for (String partitionKey : config.getSplitStrings(META_SYNC_PARTITION_FIELDS)) {
      String partitionKeyWithTicks = tickSurround(partitionKey);
      partitionFields.add(new StringBuilder().append(partitionKeyWithTicks).append(" ")
          .append(getPartitionKeyType(hiveSchema, partitionKeyWithTicks)).toString());
    }
```

### StringBufferReplaceableByString
`StringBuilder` can be replaced with 'String'
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/execution/bulkinsert/GlobalSortPartitioner.java`
#### Snippet
```java
      // the records split evenly across RDD partitions, such that small partitions fit
      // into 1 RDD partition, while big ones spread evenly across multiple RDD partitions
      return new StringBuilder()
          .append(record.getPartitionPath())
          .append("+")
```

### StringBufferReplaceableByString
`StringBuilder` can be replaced with 'String'
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/execution/bulkinsert/RDDPartitionSortPartitioner.java`
#### Snippet
```java
        .mapToPair(record ->
            new Tuple2<>(
                new StringBuilder()
                    .append(record.getPartitionPath())
                    .append("+")
```

### StringBufferReplaceableByString
`StringBuilder sb` can be replaced with 'String'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/index/bloom/BloomIndexFileInfo.java`
#### Snippet
```java
  @Override
  public String toString() {
    final StringBuilder sb = new StringBuilder("BloomIndexFileInfo {");
    sb.append(" fileId=").append(fileId);
    sb.append(" minRecordKey=").append(minRecordKey);
```

### StringBufferReplaceableByString
`StringBuilder sb` can be replaced with 'String'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/WorkloadStat.java`
#### Snippet
```java
  @Override
  public String toString() {
    final StringBuilder sb = new StringBuilder("WorkloadStat {");
    sb.append("numInserts=").append(numInserts).append(", ");
    sb.append("numUpdates=").append(numUpdates);
```

### StringBufferReplaceableByString
`StringBuilder sb` can be replaced with 'String'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/WorkloadProfile.java`
#### Snippet
```java
  @Override
  public String toString() {
    final StringBuilder sb = new StringBuilder("WorkloadProfile {");
    sb.append("globalStat=").append(globalStat).append(", ");
    sb.append("InputPartitionStat=").append(inputPartitionPathStatMap).append(", ");
```

### StringBufferReplaceableByString
`StringBuilder sb` can be replaced with 'String'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/commit/InsertBucket.java`
#### Snippet
```java
  @Override
  public String toString() {
    final StringBuilder sb = new StringBuilder("InsertBucket {");
    sb.append("bucketNumber=").append(bucketNumber).append(", ");
    sb.append("weight=").append(weight);
```

### StringBufferReplaceableByString
`StringBuilder sb` can be replaced with 'String'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/commit/SmallFile.java`
#### Snippet
```java
  @Override
  public String toString() {
    final StringBuilder sb = new StringBuilder("SmallFile {");
    sb.append("location=").append(location).append(", ");
    sb.append("sizeBytes=").append(sizeBytes);
```

### StringBufferReplaceableByString
`StringBuilder sb` can be replaced with 'String'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/commit/BucketInfo.java`
#### Snippet
```java
  @Override
  public String toString() {
    final StringBuilder sb = new StringBuilder("BucketInfo {");
    sb.append("bucketType=").append(bucketType).append(", ");
    sb.append("fileIdPrefix=").append(fileIdPrefix).append(", ");
```

### StringBufferReplaceableByString
`StringBuilder sb` can be replaced with 'String'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/WriteStatus.java`
#### Snippet
```java
  @Override
  public String toString() {
    final StringBuilder sb = new StringBuilder("WriteStatus {");
    sb.append("fileId=").append(fileId);
    sb.append(", writeStat=").append(stat);
```

### StringBufferReplaceableByString
`StringBuilder` can be replaced with 'String'
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/Pair.java`
#### Snippet
```java
  @Override
  public String toString() {
    return new StringBuilder().append('(').append(getLeft()).append(',').append(getRight()).append(')').toString();
  }

```

### StringBufferReplaceableByString
`StringBuilder` can be replaced with 'String'
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/Triple.java`
#### Snippet
```java
  @Override
  public String toString() {
    return new StringBuilder().append('(').append(getLeft()).append(',').append(getMiddle()).append(',')
        .append(getRight()).append(')').toString();
  }
```

### StringBufferReplaceableByString
`StringBuilder sb` can be replaced with 'String'
in `hudi-common/src/main/java/org/apache/hudi/common/model/ConsistentHashingNode.java`
#### Snippet
```java
  @Override
  public String toString() {
    final StringBuilder sb = new StringBuilder("ConsistentHashingNode{");
    sb.append("value=").append(value);
    sb.append(", fileIdPfx='").append(fileIdPrefix).append('\'');
```

### StringBufferReplaceableByString
`StringBuilder sb` can be replaced with 'String'
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieRecordLocation.java`
#### Snippet
```java
  @Override
  public String toString() {
    final StringBuilder sb = new StringBuilder("HoodieRecordLocation {");
    sb.append("instantTime=").append(instantTime).append(", ");
    sb.append("fileId=").append(fileId);
```

### StringBufferReplaceableByString
`StringBuilder sb` can be replaced with 'String'
in `hudi-common/src/main/java/org/apache/hudi/common/model/FileSlice.java`
#### Snippet
```java
  @Override
  public String toString() {
    final StringBuilder sb = new StringBuilder("FileSlice {");
    sb.append("fileGroupId=").append(fileGroupId);
    sb.append(", baseCommitTime=").append(baseInstantTime);
```

### StringBufferReplaceableByString
`StringBuilder sb` can be replaced with 'String'
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieRecordGlobalLocation.java`
#### Snippet
```java
  @Override
  public String toString() {
    final StringBuilder sb = new StringBuilder("HoodieGlobalRecordLocation {");
    sb.append("partitionPath=").append(partitionPath).append(", ");
    sb.append("instantTime=").append(instantTime).append(", ");
```

### StringBufferReplaceableByString
`StringBuilder sb` can be replaced with 'String'
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieFileGroup.java`
#### Snippet
```java
  @Override
  public String toString() {
    final StringBuilder sb = new StringBuilder("HoodieFileGroup {");
    sb.append("id=").append(fileGroupId);
    sb.append(", fileSlices='").append(fileSlices).append('\'');
```

### StringBufferReplaceableByString
`StringBuilder sb` can be replaced with 'String'
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieKey.java`
#### Snippet
```java
  @Override
  public String toString() {
    final StringBuilder sb = new StringBuilder("HoodieKey {");
    sb.append(" recordKey=").append(recordKey);
    sb.append(" partitionPath=").append(partitionPath);
```

### StringBufferReplaceableByString
`StringBuilder sb` can be replaced with 'String'
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieRecord.java`
#### Snippet
```java
  @Override
  public String toString() {
    final StringBuilder sb = new StringBuilder("HoodieRecord{");
    sb.append("key=").append(key);
    sb.append(", currentLocation='").append(currentLocation).append('\'');
```

### StringBufferReplaceableByString
`StringBuilder sb` can be replaced with 'String'
in `hudi-common/src/main/java/org/apache/hudi/common/table/HoodieTableMetaClient.java`
#### Snippet
```java
  @Override
  public String toString() {
    final StringBuilder sb = new StringBuilder("HoodieTableMetaClient{");
    sb.append("basePath='").append(basePath).append('\'');
    sb.append(", metaPath='").append(metaPath).append('\'');
```

### StringBufferReplaceableByString
`StringBuilder builder` can be replaced with 'String'
in `hudi-examples/hudi-examples-flink/src/main/java/org/apache/hudi/examples/quickstart/utils/QuickstartConfigurations.java`
#### Snippet
```java

  public static String getCreateHudiCatalogDDL(final String catalogName, final String catalogPath) {
    StringBuilder builder = new StringBuilder();
    builder.append("create catalog ").append(catalogName).append(" with (\n");
    builder.append("  'type' = 'hudi',\n"
```

### StringBufferReplaceableByString
`StringBuilder sb` can be replaced with 'String'
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/hive/HoodieCombineHiveInputFormat.java`
#### Snippet
```java
    @Override
    public String toString() {
      StringBuilder sb = new StringBuilder();
      sb.append(inputSplitShim.toString());
      sb.append("InputFormatClass: " + inputFormatClassName);
```

### StringBufferReplaceableByString
`StringBuilder sb` can be replaced with 'String'
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/helpers/KafkaOffsetGen.java`
#### Snippet
```java
     */
    public static String offsetsToStr(OffsetRange[] ranges) {
      StringBuilder sb = new StringBuilder();
      // at least 1 partition will be present.
      sb.append(ranges[0].topic() + ",");
```

### StringBufferReplaceableByString
`StringBuilder sb` can be replaced with 'String'
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/HoodieTableSource.java`
#### Snippet
```java
        .mapToObj(i -> schemaFieldNames[i])
        .collect(Collectors.toList());
    StringBuilder sb = new StringBuilder();
    sb.append(operatorName)
        .append("(")
```

### StringBufferReplaceableByString
`StringBuffer stringBuffer` can be replaced with 'String'
in `hudi-spark-datasource/hudi-spark/src/main/java/org/apache/hudi/QuickstartUtils.java`
#### Snippet
```java

  private static Option<String> convertToString(String uuid, String partitionPath, Long ts) {
    StringBuffer stringBuffer = new StringBuffer();
    stringBuffer.append("{");
    stringBuffer.append("\"ts\": \"" + (ts == null ? "0.0" : ts) + "\",");
```

## RuleId[ruleID=UnnecessaryReturn]
### UnnecessaryReturn
`return` is unnecessary as the last statement in a 'void' method
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/InternalSchemaBuilder.java`
#### Snippet
```java
        return;
      default:
        return;
    }
  }
```

### UnnecessaryReturn
`return` is unnecessary as the last statement in a 'void' method
in `hudi-common/src/main/java/org/apache/hudi/secondary/index/HoodieSecondaryIndex.java`
#### Snippet
```java
        break;
      default:
        return;
    }
  }
```

## RuleId[ruleID=NonShortCircuitBoolean]
### NonShortCircuitBoolean
Non-short-circuit boolean expression `hasNonNullNonEmptyPart |= !isNullOrEmptyKeyPartPredicate.test(convertedKeyPart)`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/keygen/BuiltinKeyGenerator.java`
#### Snippet
```java
      // This check is to validate that overall composite-key has at least one non-null, non-empty
      // segment
      hasNonNullNonEmptyPart |= !isNullOrEmptyKeyPartPredicate.test(convertedKeyPart);

      if (i < recordKeyParts.length - 1) {
```

### NonShortCircuitBoolean
Non-short-circuit boolean expression `success &= metaClient.getFs().delete(metaFile, false)`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/HoodieTimelineArchiver.java`
#### Snippet
```java
      Path metaFile = new Path(metaClient.getMetaAuxiliaryPath(), deleteInstant.getFileName());
      if (metaClient.getFs().exists(metaFile)) {
        success &= metaClient.getFs().delete(metaFile, false);
        LOG.info("Deleted instant file in auxiliary meta path : " + metaFile);
      }
```

### NonShortCircuitBoolean
Non-short-circuit boolean expression `finalResult &= res.getKey()`
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieMetadataTableValidator.java`
#### Snippet
```java

    for (Pair<Boolean, String> res : result) {
      finalResult &= res.getKey();
      if (res.getKey().equals(false)) {
        LOG.error("Metadata Validation failed for table: " + cfg.basePath + " with error: " + res.getValue());
```

### NonShortCircuitBoolean
Non-short-circuit boolean expression `this.lastBatch |= other.lastBatch`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/event/WriteMetadataEvent.java`
#### Snippet
```java
    // the instant time could be monotonically increasing
    this.instantTime = other.instantTime;
    this.lastBatch |= other.lastBatch; // true if one of the event lastBatch is true
    List<WriteStatus> statusList = new ArrayList<>();
    statusList.addAll(this.writeStatuses);
```

## RuleId[ruleID=ManualMinMaxCalculation]
### ManualMinMaxCalculation
Can be replaced with 'Math.min()' call
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/clustering/ClusteringOperator.java`
#### Snippet
```java
    // target size should larger than small file limit
    this.conf.setLong(FlinkOptions.CLUSTERING_PLAN_STRATEGY_SMALL_FILE_LIMIT.key(),
        this.conf.getLong(FlinkOptions.CLUSTERING_PLAN_STRATEGY_TARGET_FILE_MAX_BYTES) > this.conf.getLong(FlinkOptions.CLUSTERING_PLAN_STRATEGY_SMALL_FILE_LIMIT)
          ? this.conf.getLong(FlinkOptions.CLUSTERING_PLAN_STRATEGY_SMALL_FILE_LIMIT)
            : this.conf.getLong(FlinkOptions.CLUSTERING_PLAN_STRATEGY_TARGET_FILE_MAX_BYTES));
  }

```

## RuleId[ruleID=MismatchedStringBuilderQueryUpdate]
### MismatchedStringBuilderQueryUpdate
Contents of `StringBuilder str` are updated, but never queried
in `hudi-common/src/main/java/org/apache/hudi/common/config/SerializableConfiguration.java`
#### Snippet
```java
  @Override
  public String toString() {
    StringBuilder str = new StringBuilder();
    configuration.iterator().forEachRemaining(e -> str.append(String.format("%s => %s \n", e.getKey(), e.getValue())));
    return configuration.toString();
```

## RuleId[ruleID=AbstractClassNeverImplemented]
### AbstractClassNeverImplemented
Abstract class `JavaHoodieIndex` has no concrete subclass
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/index/JavaHoodieIndex.java`
#### Snippet
```java
import java.util.stream.Collectors;

public abstract class JavaHoodieIndex<T> extends HoodieIndex<List<HoodieRecord<T>>, List<WriteStatus>> {
  protected JavaHoodieIndex(HoodieWriteConfig config) {
    super(config);
```

### AbstractClassNeverImplemented
Abstract class `JavaBulkInsertInternalPartitionerFactory` has no concrete subclass
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/execution/bulkinsert/JavaBulkInsertInternalPartitionerFactory.java`
#### Snippet
```java
 * expected number of output spark partitions for bulk insert operation.
 */
public abstract class JavaBulkInsertInternalPartitionerFactory {

  public static BulkInsertPartitioner get(BulkInsertSortMode sortMode) {
```

### AbstractClassNeverImplemented
Abstract class `FlinkHoodieIndex` has no concrete subclass
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/index/FlinkHoodieIndex.java`
#### Snippet
```java
 * Base flink implementation of {@link HoodieIndex}.
 */
public abstract class FlinkHoodieIndex<T> extends HoodieIndex<List<HoodieRecord<T>>, List<WriteStatus>> {
  protected FlinkHoodieIndex(HoodieWriteConfig config) {
    super(config);
```

### AbstractClassNeverImplemented
Abstract class `HoodieRowDataCreation` has no concrete subclass
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/client/model/HoodieRowDataCreation.java`
#### Snippet
```java
 * The factory clazz for hoodie row data.
 */
public abstract class HoodieRowDataCreation {
  /**
   * Creates a {@link AbstractHoodieRowData} instance based on the given configuration.
```

### AbstractClassNeverImplemented
Abstract class `SparkHoodieIndex` has no concrete subclass
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/index/SparkHoodieIndex.java`
#### Snippet
```java

@SuppressWarnings("checkstyle:LineLength")
public abstract class SparkHoodieIndex<T>
    extends HoodieIndex<JavaRDD<HoodieRecord<T>>, JavaRDD<WriteStatus>> {
  protected SparkHoodieIndex(HoodieWriteConfig config) {
```

### AbstractClassNeverImplemented
Abstract class `SingleSparkJobExecutionStrategy` has no concrete subclass
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/clustering/run/strategy/SingleSparkJobExecutionStrategy.java`
#### Snippet
```java
 * MultipleSparkJobExecution strategy is not ideal for use cases that require large number of clustering groups
 */
public abstract class SingleSparkJobExecutionStrategy<T>
    extends ClusteringExecutionStrategy<T, HoodieData<HoodieRecord<T>>, HoodieData<HoodieKey>, HoodieData<WriteStatus>> {
  private static final Logger LOG = LogManager.getLogger(SingleSparkJobExecutionStrategy.class);
```

### AbstractClassNeverImplemented
Abstract class `BulkInsertInternalPartitionerFactory` has no concrete subclass
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/execution/bulkinsert/BulkInsertInternalPartitionerFactory.java`
#### Snippet
```java
 * expected number of output spark partitions for bulk insert operation.
 */
public abstract class BulkInsertInternalPartitionerFactory {

  public static BulkInsertPartitioner get(HoodieTable table,
```

### AbstractClassNeverImplemented
Abstract class `BulkInsertInternalPartitionerWithRowsFactory` has no concrete subclass
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/execution/bulkinsert/BulkInsertInternalPartitionerWithRowsFactory.java`
#### Snippet
```java
 * expected number of output spark partitions for bulk insert operation.
 */
public abstract class BulkInsertInternalPartitionerWithRowsFactory {

  public static BulkInsertPartitioner<Dataset<Row>> get(HoodieWriteConfig config,
```

### AbstractClassNeverImplemented
Abstract class `AbstractUserDefinedMetricsReporter` has no concrete subclass
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metrics/userdefined/AbstractUserDefinedMetricsReporter.java`
#### Snippet
```java
 */
@Deprecated
public abstract class AbstractUserDefinedMetricsReporter extends CustomizableMetricsReporter {

  public AbstractUserDefinedMetricsReporter(Properties props, MetricRegistry registry) {
```

### AbstractClassNeverImplemented
Abstract class `RowDataToHoodieFunctions` has no concrete subclass
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/transform/RowDataToHoodieFunctions.java`
#### Snippet
```java
 * Utilities for {@link RowDataToHoodieFunction}.
 */
public abstract class RowDataToHoodieFunctions {
  private RowDataToHoodieFunctions() {
  }
```

### AbstractClassNeverImplemented
Abstract class `BucketAssigners` has no concrete subclass
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/partitioner/BucketAssigners.java`
#### Snippet
```java
 * Utilities for {@code BucketAssigner}.
 */
public abstract class BucketAssigners {

  private BucketAssigners() {
```

### AbstractClassNeverImplemented
Abstract class `RecordIterators` has no concrete subclass
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/RecordIterators.java`
#### Snippet
```java
 * Factory clazz for record iterators.
 */
public abstract class RecordIterators {

  public static ClosableIterator<RowData> getParquetRecordIterator(
```

### AbstractClassNeverImplemented
Abstract class `AbstractStreamOperatorFactoryAdapter` has no concrete subclass
in `hudi-flink-datasource/hudi-flink1.13.x/src/main/java/org/apache/hudi/adapter/AbstractStreamOperatorFactoryAdapter.java`
#### Snippet
```java
 * Adapter clazz for {@link AbstractStreamOperatorFactory}.
 */
public abstract class AbstractStreamOperatorFactoryAdapter<O>
    extends AbstractStreamOperatorFactory<O> implements YieldingOperatorFactory<O> {
  private transient MailboxExecutor mailboxExecutor;
```

### AbstractClassNeverImplemented
Abstract class `AbstractStreamOperatorAdapter` has no concrete subclass
in `hudi-flink-datasource/hudi-flink1.13.x/src/main/java/org/apache/hudi/adapter/AbstractStreamOperatorAdapter.java`
#### Snippet
```java
 * Adapter clazz for {@code AbstractStreamOperator}.
 */
public abstract class AbstractStreamOperatorAdapter<O> extends AbstractStreamOperator<O> {
  @Override
  public void close() throws Exception {
```

### AbstractClassNeverImplemented
Abstract class `AbstractStreamOperatorFactoryAdapter` has no concrete subclass
in `hudi-flink-datasource/hudi-flink1.14.x/src/main/java/org/apache/hudi/adapter/AbstractStreamOperatorFactoryAdapter.java`
#### Snippet
```java
 * Adapter clazz for {@link AbstractStreamOperatorFactory}.
 */
public abstract class AbstractStreamOperatorFactoryAdapter<O>
    extends AbstractStreamOperatorFactory<O> implements YieldingOperatorFactory<O> {

```

### AbstractClassNeverImplemented
Abstract class `AbstractStreamOperatorAdapter` has no concrete subclass
in `hudi-flink-datasource/hudi-flink1.14.x/src/main/java/org/apache/hudi/adapter/AbstractStreamOperatorAdapter.java`
#### Snippet
```java
 * Adapter clazz for {@code AbstractStreamOperator}.
 */
public abstract class AbstractStreamOperatorAdapter<O> extends AbstractStreamOperator<O> {
}

```

### AbstractClassNeverImplemented
Abstract class `AbstractStreamOperatorFactoryAdapter` has no concrete subclass
in `hudi-flink-datasource/hudi-flink1.15.x/src/main/java/org/apache/hudi/adapter/AbstractStreamOperatorFactoryAdapter.java`
#### Snippet
```java
 * Adapter clazz for {@link AbstractStreamOperatorFactory}.
 */
public abstract class AbstractStreamOperatorFactoryAdapter<O>
    extends AbstractStreamOperatorFactory<O> implements YieldingOperatorFactory<O> {

```

### AbstractClassNeverImplemented
Abstract class `AbstractStreamOperatorAdapter` has no concrete subclass
in `hudi-flink-datasource/hudi-flink1.15.x/src/main/java/org/apache/hudi/adapter/AbstractStreamOperatorAdapter.java`
#### Snippet
```java
 * Adapter clazz for {@code AbstractStreamOperator}.
 */
public abstract class AbstractStreamOperatorAdapter<O> extends AbstractStreamOperator<O> {
}

```

### AbstractClassNeverImplemented
Abstract class `SchemaProvider` has no concrete subclass
in `hudi-spark-datasource/hudi-spark/src/main/java/org/apache/hudi/cli/SchemaProvider.java`
#### Snippet
```java
 */
@PublicAPIClass(maturity = ApiMaturityLevel.STABLE)
public abstract class SchemaProvider implements Serializable {

  protected TypedProperties config;
```

## RuleId[ruleID=BoundedWildcard]
### BoundedWildcard
Can generalize to `? super MetricDatum`
in `hudi-aws/src/main/java/org/apache/hudi/aws/cloudwatch/CloudWatchReporter.java`
#### Snippet
```java
                                StandardUnit standardUnit,
                                long timestampMilliSec,
                                List<MetricDatum> metricData) {
    String[] metricNameParts = metricName.split("\\.", 2);
    String tableName = metricNameParts[0];
```

### BoundedWildcard
Can generalize to `? extends Function`
in `hudi-cli/src/main/java/org/apache/hudi/cli/Table.java`
#### Snippet
```java

  public Table(
      TableHeader rowHeader, Map<String, Function<Object, String>> fieldNameToConverterMap,
      boolean addRowNo, Option<String> orderingFieldNameOptional,
      Option<Boolean> isDescendingOptional, Option<Integer> limitOptional) {
```

### BoundedWildcard
Can generalize to `? extends Comparable`
in `hudi-cli/src/main/java/org/apache/hudi/cli/Table.java`
#### Snippet
```java
   * @param row Row
   */
  public Table add(List<Comparable> row) {
    if (finishedAdding) {
      throw new IllegalStateException("Container already marked done for adding. No more entries can be added.");
```

### BoundedWildcard
Can generalize to `? extends List`
in `hudi-cli/src/main/java/org/apache/hudi/cli/Table.java`
#### Snippet
```java
   * @return
   */
  public Table addAll(List<List<Comparable>> rows) {
    rows.forEach(this::add);
    return this;
```

### BoundedWildcard
Can generalize to `? extends List`
in `hudi-cli/src/main/java/org/apache/hudi/cli/utils/SparkTempViewProvider.java`
#### Snippet
```java

  @Override
  public void createOrReplace(String tableName, List<String> headers, List<List<Comparable>> rows) {
    try {
      if (headers.isEmpty() || rows.isEmpty()) {
```

### BoundedWildcard
Can generalize to `? super HoodieWriteStat`
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/DiffCommand.java`
#### Snippet
```java

  private void populateRows(List<Comparable[]> rows, HoodieInstant commit, HoodieWriteStat hoodieWriteStat,
                            String value, BiFunction<HoodieWriteStat, String, Boolean> checker) {
    if (checker.apply(hoodieWriteStat, value)) {
      rows.add(new Comparable[] {
```

### BoundedWildcard
Can generalize to `? super String`
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/DiffCommand.java`
#### Snippet
```java

  private void populateRows(List<Comparable[]> rows, HoodieInstant commit, HoodieWriteStat hoodieWriteStat,
                            String value, BiFunction<HoodieWriteStat, String, Boolean> checker) {
    if (checker.apply(hoodieWriteStat, value)) {
      rows.add(new Comparable[] {
```

### BoundedWildcard
Can generalize to `? extends HoodieInstant`
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/CommitsCommand.java`
#### Snippet
```java
  }

  private Option<HoodieCommitMetadata> getHoodieCommitMetadata(HoodieTimeline timeline, Option<HoodieInstant> hoodieInstant) throws IOException {
    if (hoodieInstant.isPresent()) {
      return Option.of(TimelineUtils.getCommitMetadata(hoodieInstant.get(), timeline));
```

### BoundedWildcard
Can generalize to `? extends RenameOpResult`
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/CompactionCommand.java`
#### Snippet
```java
  }

  private String getRenamesToBePrinted(List<RenameOpResult> res, Integer limit, String sortByField, boolean descending,
                                       boolean headerOnly, String operation) {

```

### BoundedWildcard
Can generalize to `? super HoodieInstant`
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/CompactionCommand.java`
#### Snippet
```java
  private <T extends HoodieDefaultTimeline, U extends HoodieInstant, V extends HoodieCompactionPlan>
      Function<HoodieInstant, HoodieCompactionPlan> compactionPlanReader(
      BiFunction<T, HoodieInstant, HoodieCompactionPlan> f, T timeline) {

    return (y) -> f.apply(timeline, y);
```

### BoundedWildcard
Can generalize to `? extends PartitionEvent`
in `hudi-sync/hudi-adb-sync/src/main/java/org/apache/hudi/sync/adb/AdbSyncTool.java`
#### Snippet
```java
  }

  private List<String> filterPartitions(List<PartitionEvent> events, PartitionEventType eventType) {
    return events.stream().filter(s -> s.eventType == eventType)
        .map(s -> s.storagePartition).collect(Collectors.toList());
```

### BoundedWildcard
Can generalize to `? extends PartitionEvent`
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/HiveSyncTool.java`
#### Snippet
```java
  }

  private List<String> filterPartitions(List<PartitionEvent> events, PartitionEventType eventType) {
    return events.stream().filter(s -> s.eventType == eventType).map(s -> s.storagePartition)
        .collect(Collectors.toList());
```

### BoundedWildcard
Can generalize to `? extends Map`
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/TimelineCommand.java`
#### Snippet
```java
  private String getFormattedDate(
      String instantTimestamp, HoodieInstant.State state,
      Map<String, Map<HoodieInstant.State, HoodieInstantWithModTime>> instantInfoMap,
      boolean showTimeSeconds) {
    Long timeMs = null;
```

### BoundedWildcard
Can generalize to `? super ResultSet`
in `hudi-sync/hudi-adb-sync/src/main/java/org/apache/hudi/sync/adb/HoodieAdbJdbcClient.java`
#### Snippet
```java
  }

  private <T> T executeQuerySQL(String sql, Function<ResultSet, T> function) {
    Statement stmt = null;
    try {
```

### BoundedWildcard
Can generalize to `? extends HoodieException`
in `hudi-sync/hudi-sync-common/src/main/java/org/apache/hudi/sync/common/util/SyncUtilHelpers.java`
#### Snippet
```java
  }

  public static HoodieException getExceptionFromList(Collection<HoodieException> exceptions) {
    if (exceptions.size() == 1) {
      return exceptions.stream().findFirst().get();
```

### BoundedWildcard
Can generalize to `? extends Partition`
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/util/PartitionFilterGenerator.java`
#### Snippet
```java
   *     And(Equal(Attribute(date), Literal(2022-09-02)), Equal(Attribute(hour), Literal(13))))
   */
  private static Expression buildPartitionExpression(List<Partition> partitions, List<FieldSchema> partitionFields) {
    return partitions.stream().map(partition -> {
      List<String> partitionValues = partition.getValues();
```

### BoundedWildcard
Can generalize to `? extends FieldSchema`
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/util/PartitionFilterGenerator.java`
#### Snippet
```java
   *     And(Equal(Attribute(date), Literal(2022-09-02)), Equal(Attribute(hour), Literal(13))))
   */
  private static Expression buildPartitionExpression(List<Partition> partitions, List<FieldSchema> partitionFields) {
    return partitions.stream().map(partition -> {
      List<String> partitionValues = partition.getValues();
```

### BoundedWildcard
Can generalize to `? extends Partition`
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/util/PartitionFilterGenerator.java`
#### Snippet
```java
   * corresponding partition fieldSchemas.
   */
  private static List<Pair<FieldSchema, String[]>> extractFieldValues(List<Partition> partitions, List<FieldSchema> partitionFields) {
    return IntStream.range(0, partitionFields.size())
        .mapToObj(i -> {
```

### BoundedWildcard
Can generalize to `? extends Partition`
in `hudi-sync/hudi-sync-common/src/main/java/org/apache/hudi/sync/common/HoodieSyncClient.java`
#### Snippet
```java
   * Generate a list of PartitionEvent based on the changes required.
   */
  public List<PartitionEvent> getPartitionEvents(List<Partition> tablePartitions, List<String> partitionStoragePartitions, Set<String> droppedPartitions) {
    Map<String, String> paths = new HashMap<>();
    for (Partition tablePartition : tablePartitions) {
```

### BoundedWildcard
Can generalize to `? extends Pair`
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/ddl/HMSDDLExecutor.java`
#### Snippet
```java

  @Override
  public void updateTableComments(String tableName, Map<String, Pair<String, String>> alterSchema) {
    try {
      Table table = client.getTable(databaseName, tableName);
```

### BoundedWildcard
Can generalize to `? extends FieldSchema`
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/HoodieHiveSyncClient.java`
#### Snippet
```java

  @Override
  public void updateTableComments(String tableName, List<FieldSchema> fromMetastore, List<FieldSchema> fromStorage) {
    Map<String, FieldSchema> metastoreMap = fromMetastore.stream().collect(Collectors.toMap(f -> f.getName().toLowerCase(Locale.ROOT), f -> f));
    Map<String, FieldSchema> storageMap = fromStorage.stream().collect(Collectors.toMap(f -> f.getName().toLowerCase(Locale.ROOT), f -> f));
```

### BoundedWildcard
Can generalize to `? extends FieldSchema`
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/HoodieHiveSyncClient.java`
#### Snippet
```java

  @Override
  public void updateTableComments(String tableName, List<FieldSchema> fromMetastore, List<FieldSchema> fromStorage) {
    Map<String, FieldSchema> metastoreMap = fromMetastore.stream().collect(Collectors.toMap(f -> f.getName().toLowerCase(Locale.ROOT), f -> f));
    Map<String, FieldSchema> storageMap = fromStorage.stream().collect(Collectors.toMap(f -> f.getName().toLowerCase(Locale.ROOT), f -> f));
```

### BoundedWildcard
Can generalize to `? extends HoodieData`
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/table/HoodieJavaTable.java`
#### Snippet
```java

  public static HoodieWriteMetadata<List<WriteStatus>> convertMetadata(
      HoodieWriteMetadata<HoodieData<WriteStatus>> metadata) {
    return metadata.clone(metadata.getWriteStatuses().collectAsList());
  }
```

### BoundedWildcard
Can generalize to `? extends List`
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/table/action/commit/JavaInsertOverwriteCommitActionExecutor.java`
#### Snippet
```java

  @Override
  protected Map<String, List<String>> getPartitionToReplacedFileIds(HoodieWriteMetadata<List<WriteStatus>> writeResult) {
    return context.mapToPair(
        writeResult.getWriteStatuses().stream().map(status -> status.getStat().getPartitionPath()).distinct().collect(Collectors.toList()),
```

### BoundedWildcard
Can generalize to `? extends HoodieRecord`
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/table/action/deltacommit/JavaUpsertPreppedDeltaCommitActionExecutor.java`
#### Snippet
```java

  public JavaUpsertPreppedDeltaCommitActionExecutor(HoodieJavaEngineContext context, HoodieWriteConfig config, HoodieTable table,
                                                    String instantTime, List<HoodieRecord<T>> preppedInputRecords) {
    super(context, config, table, instantTime, WriteOperationType.UPSERT_PREPPED);
    this.preppedInputRecords = preppedInputRecords;
```

### BoundedWildcard
Can generalize to `? extends Type`
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/util/HiveSchemaUtil.java`
#### Snippet
```java
   * @return : Equivalent 'struct' Hive schema
   */
  private static String createHiveStruct(List<Type> parquetFields, boolean supportTimestamp, boolean doFormat) {
    StringBuilder struct = new StringBuilder();
    struct.append(doFormat ? "STRUCT< " : "STRUCT<");
```

### BoundedWildcard
Can generalize to `? extends ClusteringOperation`
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/client/clustering/run/strategy/JavaExecutionStrategy.java`
#### Snippet
```java
   * Read records from baseFiles.
   */
  private List<HoodieRecord<T>> readRecordsForGroupBaseFiles(List<ClusteringOperation> clusteringOps) {
    List<HoodieRecord<T>> records = new ArrayList<>();
    clusteringOps.forEach(clusteringOp -> {
```

### BoundedWildcard
Can generalize to `? extends ClusteringOperation`
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/client/clustering/run/strategy/JavaExecutionStrategy.java`
#### Snippet
```java
   * Read records from baseFiles and apply updates.
   */
  private List<HoodieRecord<T>> readRecordsForGroupWithLogs(List<ClusteringOperation> clusteringOps,
                                                            String instantTime) {
    HoodieWriteConfig config = getWriteConfig();
```

### BoundedWildcard
Can generalize to `? extends List`
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/client/HoodieJavaWriteClient.java`
#### Snippet
```java

  @Override
  protected List<WriteStatus> postWrite(HoodieWriteMetadata<List<WriteStatus>> result,
                                        String instantTime,
                                        HoodieTable hoodieTable) {
```

### BoundedWildcard
Can generalize to `? super List`>
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/table/action/commit/JavaDeleteHelper.java`
#### Snippet
```java
                                                        HoodieWriteConfig config,
                                                        HoodieTable<EmptyHoodieRecordPayload, List<HoodieRecord<EmptyHoodieRecordPayload>>, List<HoodieKey>, List<WriteStatus>> table,
                                                        BaseCommitActionExecutor<EmptyHoodieRecordPayload, List<HoodieRecord<EmptyHoodieRecordPayload>>, List<HoodieKey>, List<WriteStatus>, R> deleteExecutor) {
    try {
      HoodieWriteMetadata<List<WriteStatus>> result = null;
```

### BoundedWildcard
Can generalize to `? super List`
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/table/action/commit/BaseJavaCommitActionExecutor.java`
#### Snippet
```java
  }

  protected List<WriteStatus> updateIndex(List<WriteStatus> writeStatuses, HoodieWriteMetadata<List<WriteStatus>> result) {
    Instant indexStartTime = Instant.now();
    // Update the index back
```

### BoundedWildcard
Can generalize to `? extends HoodieRecord`
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/table/action/commit/BaseJavaCommitActionExecutor.java`
#### Snippet
```java
  }

  protected Pair<HashMap<String, WorkloadStat>, WorkloadStat> buildProfile(List<HoodieRecord<T>> inputRecords) {
    HashMap<String, WorkloadStat> partitionPathStatMap = new HashMap<>();
    WorkloadStat globalStat = new WorkloadStat();
```

### BoundedWildcard
Can generalize to `? extends List`
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/table/action/commit/BaseJavaCommitActionExecutor.java`
#### Snippet
```java
  }

  protected void setCommitMetadata(HoodieWriteMetadata<List<WriteStatus>> result) {
    result.setCommitMetadata(Option.of(CommitUtils.buildMetadata(result.getWriteStatuses().stream().map(WriteStatus::getStat).collect(Collectors.toList()),
        result.getPartitionToReplaceFileIds(), extraMetadata, operationType, getSchemaToStoreInCommit(), getCommitActionType())));
```

### BoundedWildcard
Can generalize to `? extends HoodieRecord`
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/io/FlinkMergeHandleWithChangeLog.java`
#### Snippet
```java
  }

  protected boolean writeUpdateRecord(HoodieRecord<T> newRecord, HoodieRecord<T> oldRecord, Option<HoodieRecord> combineRecordOpt, Schema writerSchema)
      throws IOException {
    // TODO [HUDI-5019] Remove these unnecessary newInstance invocations
```

### BoundedWildcard
Can generalize to `? extends HoodieRecord`
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/io/FlinkConcatHandle.java`
#### Snippet
```java

  public FlinkConcatHandle(HoodieWriteConfig config, String instantTime, HoodieTable<T, I, K, O> hoodieTable,
                           Iterator<HoodieRecord<T>> recordItr, String partitionPath, String fileId,
                           TaskContextSupplier taskContextSupplier) {
    super(config, instantTime, hoodieTable, Collections.emptyIterator(), partitionPath, fileId, taskContextSupplier);
```

### BoundedWildcard
Can generalize to `? extends HoodieRecord`
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/io/FlinkConcatAndReplaceHandle.java`
#### Snippet
```java

  public FlinkConcatAndReplaceHandle(HoodieWriteConfig config, String instantTime, HoodieTable<T, I, K, O> hoodieTable,
                                     Iterator<HoodieRecord<T>> recordItr, String partitionPath, String fileId,
                                     TaskContextSupplier taskContextSupplier, Path basePath) {
    super(config, instantTime, hoodieTable, Collections.emptyIterator(), partitionPath, fileId, taskContextSupplier, basePath);
```

### BoundedWildcard
Can generalize to `? extends HoodieRecord`
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/io/FlinkMergeAndReplaceHandleWithChangeLog.java`
#### Snippet
```java
  }

  protected boolean writeUpdateRecord(HoodieRecord<T> newRecord, HoodieRecord<T> oldRecord, Option<HoodieRecord> combineRecordOpt, Schema writerSchema)
      throws IOException {
    // TODO [HUDI-5019] Remove these unnecessary newInstance invocations
```

### BoundedWildcard
Can generalize to `? extends Type`
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/io/storage/row/parquet/ParquetSchemaConverter.java`
#### Snippet
```java
  }

  public static TypeInformation<?> convertFields(List<Type> parquetFields) {
    List<TypeInformation<?>> types = new ArrayList<>();
    List<String> names = new ArrayList<>();
```

### BoundedWildcard
Can generalize to `? extends HoodieData`
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/table/HoodieFlinkTable.java`
#### Snippet
```java

  public static HoodieWriteMetadata<List<WriteStatus>> convertMetadata(
      HoodieWriteMetadata<HoodieData<WriteStatus>> metadata) {
    return metadata.clone(metadata.getWriteStatuses().collectAsList());
  }
```

### BoundedWildcard
Can generalize to `? extends I`
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/client/common/HoodieJavaEngineContext.java`
#### Snippet
```java

  @Override
  public <I, K, V> Map<K, V> mapToPair(List<I> data, SerializablePairFunction<I, K, V> func, Integer parallelism) {
    return data.stream().map(throwingMapToPairWrapper(func)).collect(
        Collectors.toMap(Pair::getLeft, Pair::getRight, (oldVal, newVal) -> newVal)
```

### BoundedWildcard
Can generalize to `? super I`
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/client/common/HoodieJavaEngineContext.java`
#### Snippet
```java

  @Override
  public <I, K, V> Map<K, V> mapToPair(List<I> data, SerializablePairFunction<I, K, V> func, Integer parallelism) {
    return data.stream().map(throwingMapToPairWrapper(func)).collect(
        Collectors.toMap(Pair::getLeft, Pair::getRight, (oldVal, newVal) -> newVal)
```

### BoundedWildcard
Can generalize to `? extends K`
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/client/common/HoodieJavaEngineContext.java`
#### Snippet
```java

  @Override
  public <I, K, V> Map<K, V> mapToPair(List<I> data, SerializablePairFunction<I, K, V> func, Integer parallelism) {
    return data.stream().map(throwingMapToPairWrapper(func)).collect(
        Collectors.toMap(Pair::getLeft, Pair::getRight, (oldVal, newVal) -> newVal)
```

### BoundedWildcard
Can generalize to `? extends V`
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/client/common/HoodieJavaEngineContext.java`
#### Snippet
```java

  @Override
  public <I, K, V> Map<K, V> mapToPair(List<I> data, SerializablePairFunction<I, K, V> func, Integer parallelism) {
    return data.stream().map(throwingMapToPairWrapper(func)).collect(
        Collectors.toMap(Pair::getLeft, Pair::getRight, (oldVal, newVal) -> newVal)
```

### BoundedWildcard
Can generalize to `? extends I`
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/client/common/HoodieJavaEngineContext.java`
#### Snippet
```java

  @Override
  public <I, O> List<O> map(List<I> data, SerializableFunction<I, O> func, int parallelism) {
    return data.stream().parallel().map(throwingMapWrapper(func)).collect(toList());
  }
```

### BoundedWildcard
Can generalize to `? super I`
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/client/common/HoodieJavaEngineContext.java`
#### Snippet
```java

  @Override
  public <I, O> List<O> map(List<I> data, SerializableFunction<I, O> func, int parallelism) {
    return data.stream().parallel().map(throwingMapWrapper(func)).collect(toList());
  }
```

### BoundedWildcard
Can generalize to `? extends O`
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/client/common/HoodieJavaEngineContext.java`
#### Snippet
```java

  @Override
  public <I, O> List<O> map(List<I> data, SerializableFunction<I, O> func, int parallelism) {
    return data.stream().parallel().map(throwingMapWrapper(func)).collect(toList());
  }
```

### BoundedWildcard
Can generalize to `? extends I`
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/client/common/HoodieJavaEngineContext.java`
#### Snippet
```java

  @Override
  public <I> void foreach(List<I> data, SerializableConsumer<I> consumer, int parallelism) {
    data.stream().forEach(throwingForeachWrapper(consumer));
  }
```

### BoundedWildcard
Can generalize to `? super I`
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/client/common/HoodieJavaEngineContext.java`
#### Snippet
```java

  @Override
  public <I> void foreach(List<I> data, SerializableConsumer<I> consumer, int parallelism) {
    data.stream().forEach(throwingForeachWrapper(consumer));
  }
```

### BoundedWildcard
Can generalize to `? extends Pair`
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/client/common/HoodieJavaEngineContext.java`
#### Snippet
```java
  @Override
  public <I, K, V> List<V> reduceByKey(
      List<Pair<K, V>> data, SerializableBiFunction<V, V, V> reduceFunc, int parallelism) {
    return data.stream().parallel()
        .collect(Collectors.groupingBy(p -> p.getKey())).values().stream()
```

### BoundedWildcard
Can generalize to `? extends I`
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/client/common/HoodieJavaEngineContext.java`
#### Snippet
```java

  @Override
  public <I, O> List<O> flatMap(List<I> data, SerializableFunction<I, Stream<O>> func, int parallelism) {
    return data.stream().parallel().flatMap(throwingFlatMapWrapper(func)).collect(toList());
  }
```

### BoundedWildcard
Can generalize to `? super I`
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/client/common/HoodieJavaEngineContext.java`
#### Snippet
```java

  @Override
  public <I, O> List<O> flatMap(List<I> data, SerializableFunction<I, Stream<O>> func, int parallelism) {
    return data.stream().parallel().flatMap(throwingFlatMapWrapper(func)).collect(toList());
  }
```

### BoundedWildcard
Can generalize to `? extends I`
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/client/common/HoodieJavaEngineContext.java`
#### Snippet
```java

  @Override
  public <I, K, V> List<V> mapToPairAndReduceByKey(List<I> data, SerializablePairFunction<I, K, V> mapToPairFunc, SerializableBiFunction<V, V, V> reduceFunc, int parallelism) {
    return data.stream().parallel().map(throwingMapToPairWrapper(mapToPairFunc))
        .collect(Collectors.groupingBy(p -> p.getKey())).values().stream()
```

### BoundedWildcard
Can generalize to `? super I`
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/client/common/HoodieJavaEngineContext.java`
#### Snippet
```java

  @Override
  public <I, K, V> List<V> mapToPairAndReduceByKey(List<I> data, SerializablePairFunction<I, K, V> mapToPairFunc, SerializableBiFunction<V, V, V> reduceFunc, int parallelism) {
    return data.stream().parallel().map(throwingMapToPairWrapper(mapToPairFunc))
        .collect(Collectors.groupingBy(p -> p.getKey())).values().stream()
```

### BoundedWildcard
Can generalize to `? super Iterator`
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/client/common/HoodieJavaEngineContext.java`
#### Snippet
```java

  @Override
  public <I, K, V> Stream<ImmutablePair<K, V>> mapPartitionsToPairAndReduceByKey(Stream<I> data, SerializablePairFlatMapFunction<Iterator<I>, K, V> flatMapToPairFunc,
                                                                                 SerializableBiFunction<V, V, V> reduceFunc, int parallelism) {
    return throwingFlatMapToPairWrapper(flatMapToPairFunc).apply(data.parallel().iterator())
```

### BoundedWildcard
Can generalize to `? super List`>
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/table/action/commit/FlinkWriteHelper.java`
#### Snippet
```java
  public HoodieWriteMetadata<List<WriteStatus>> write(String instantTime, List<HoodieRecord<T>> inputRecords, HoodieEngineContext context,
                                                      HoodieTable<T, List<HoodieRecord<T>>, List<HoodieKey>, List<WriteStatus>> table, boolean shouldCombine, int configuredShuffleParallelism,
                                                      BaseCommitActionExecutor<T, List<HoodieRecord<T>>, List<HoodieKey>, List<WriteStatus>, R> executor, WriteOperationType operationType) {
    try {
      Instant lookupBegin = Instant.now();
```

### BoundedWildcard
Can generalize to `? super String`
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/io/FlinkWriteHandleFactory.java`
#### Snippet
```java
    @Override
    public HoodieWriteHandle<?, ?, ?, ?> create(
        Map<String, Path> bucketToHandles,
        HoodieRecord<T> record,
        HoodieWriteConfig config,
```

### BoundedWildcard
Can generalize to `? extends Map`
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/client/HoodieFlinkTableServiceClient.java`
#### Snippet
```java

  @Override
  public void commitCompaction(String compactionInstantTime, HoodieCommitMetadata metadata, Option<Map<String, String>> extraMetadata) {
    extraMetadata.ifPresent(m -> m.forEach(metadata::addMetadata));
    completeCompaction(metadata, getHoodieTable(), compactionInstantTime);
```

### BoundedWildcard
Can generalize to `? extends List`
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/table/action/commit/BaseFlinkCommitActionExecutor.java`
#### Snippet
```java
  }

  protected void setCommitMetadata(HoodieWriteMetadata<List<WriteStatus>> result) {
    result.setCommitMetadata(Option.of(CommitUtils.buildMetadata(result.getWriteStatuses().stream().map(WriteStatus::getStat).collect(Collectors.toList()),
        result.getPartitionToReplaceFileIds(),
```

### BoundedWildcard
Can generalize to `? super List`
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/table/action/commit/BaseFlinkCommitActionExecutor.java`
#### Snippet
```java
  protected void setUpWriteMetadata(
      List<WriteStatus> statuses,
      HoodieWriteMetadata<List<WriteStatus>> result) {
    // No need to update the index because the update happens before the write.
    result.setWriteStatuses(statuses);
```

### BoundedWildcard
Can generalize to `? super List`>
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/table/action/commit/FlinkDeleteHelper.java`
#### Snippet
```java
                                                        HoodieWriteConfig config,
                                                        HoodieTable<EmptyHoodieRecordPayload, List<HoodieRecord<EmptyHoodieRecordPayload>>, List<HoodieKey>, List<WriteStatus>> table,
                                                        BaseCommitActionExecutor<EmptyHoodieRecordPayload, List<HoodieRecord<EmptyHoodieRecordPayload>>, List<HoodieKey>, List<WriteStatus>, R> deleteExecutor) {
    try {
      HoodieWriteMetadata<List<WriteStatus>> result = null;
```

### BoundedWildcard
Can generalize to `? extends HoodieTableFileSystemView`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/index/bloom/HoodieFileProbingFunction.java`
#### Snippet
```java
  private final SerializableConfiguration hadoopConf;

  public HoodieFileProbingFunction(Broadcast<HoodieTableFileSystemView> baseFileOnlyViewBroadcast,
                                   SerializableConfiguration hadoopConf) {
    this.baseFileOnlyViewBroadcast = baseFileOnlyViewBroadcast;
```

### BoundedWildcard
Can generalize to `? extends HoodieFileGroupId`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/index/bloom/BucketizedBloomCheckPartitioner.java`
#### Snippet
```java
   * @param keysPerBucket maximum number of keys to pack in a single bucket
   */
  public BucketizedBloomCheckPartitioner(int targetPartitions, Map<HoodieFileGroupId, Long> fileGroupToComparisons,
      int keysPerBucket) {
    this.fileGroupToPartitions = new HashMap<>();
```

### BoundedWildcard
Can generalize to `? extends HoodieTableFileSystemView`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/index/bloom/HoodieMetadataBloomFilterProbingFunction.java`
#### Snippet
```java
   *       on executor once
   */
  public HoodieMetadataBloomFilterProbingFunction(Broadcast<HoodieTableFileSystemView> baseFileOnlyViewBroadcast,
                                                  HoodieTable hoodieTable) {
    this.baseFileOnlyViewBroadcast = baseFileOnlyViewBroadcast;
```

### BoundedWildcard
Can generalize to `? super Pair`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/data/HoodieJavaPairRDD.java`
#### Snippet
```java

  @Override
  public <O> HoodieData<O> map(SerializableFunction<Pair<K, V>, O> func) {
    return HoodieJavaRDD.of(pairRDDData.map(
        tuple -> func.apply(new ImmutablePair<>(tuple._1, tuple._2))));
```

### BoundedWildcard
Can generalize to `? extends O`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/data/HoodieJavaPairRDD.java`
#### Snippet
```java

  @Override
  public <O> HoodieData<O> map(SerializableFunction<Pair<K, V>, O> func) {
    return HoodieJavaRDD.of(pairRDDData.map(
        tuple -> func.apply(new ImmutablePair<>(tuple._1, tuple._2))));
```

### BoundedWildcard
Can generalize to `? super V`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/data/HoodieJavaPairRDD.java`
#### Snippet
```java

  @Override
  public <W> HoodiePairData<K, W> mapValues(SerializableFunction<V, W> func) {
    return HoodieJavaPairRDD.of(pairRDDData.mapValues(func::apply));
  }
```

### BoundedWildcard
Can generalize to `? extends W`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/data/HoodieJavaPairRDD.java`
#### Snippet
```java

  @Override
  public <W> HoodiePairData<K, W> mapValues(SerializableFunction<V, W> func) {
    return HoodieJavaPairRDD.of(pairRDDData.mapValues(func::apply));
  }
```

### BoundedWildcard
Can generalize to `? super V`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/data/HoodieJavaPairRDD.java`
#### Snippet
```java

  @Override
  public HoodiePairData<K, V> reduceByKey(SerializableBiFunction<V, V, V> combiner, int parallelism) {
    return HoodieJavaPairRDD.of(pairRDDData.reduceByKey(combiner::apply, parallelism));
  }
```

### BoundedWildcard
Can generalize to `? super V`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/data/HoodieJavaPairRDD.java`
#### Snippet
```java

  @Override
  public HoodiePairData<K, V> reduceByKey(SerializableBiFunction<V, V, V> combiner, int parallelism) {
    return HoodieJavaPairRDD.of(pairRDDData.reduceByKey(combiner::apply, parallelism));
  }
```

### BoundedWildcard
Can generalize to `? extends V`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/data/HoodieJavaPairRDD.java`
#### Snippet
```java

  @Override
  public HoodiePairData<K, V> reduceByKey(SerializableBiFunction<V, V, V> combiner, int parallelism) {
    return HoodieJavaPairRDD.of(pairRDDData.reduceByKey(combiner::apply, parallelism));
  }
```

### BoundedWildcard
Can generalize to `? super Pair`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/data/HoodieJavaPairRDD.java`
#### Snippet
```java

  @Override
  public <L, W> HoodiePairData<L, W> mapToPair(SerializablePairFunction<Pair<K, V>, L, W> mapToPairFunc) {
    return HoodieJavaPairRDD.of(pairRDDData.mapToPair(pair -> {
      Pair<L, W> newPair = mapToPairFunc.call(new ImmutablePair<>(pair._1, pair._2));
```

### BoundedWildcard
Can generalize to `? extends W`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/data/HoodieJavaPairRDD.java`
#### Snippet
```java

  @Override
  public <W> HoodiePairData<K, Pair<V, Option<W>>> leftOuterJoin(HoodiePairData<K, W> other) {
    return HoodieJavaPairRDD.of(JavaPairRDD.fromJavaRDD(
        pairRDDData.leftOuterJoin(HoodieJavaPairRDD.getJavaPairRDD(other))
```

### BoundedWildcard
Can generalize to `? super Iterator`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/data/HoodieJavaRDD.java`
#### Snippet
```java

  @Override
  public <O> HoodieData<O> mapPartitions(SerializableFunction<Iterator<T>, Iterator<O>> func, boolean preservesPartitioning) {
    return HoodieJavaRDD.of(rddData.mapPartitions(func::apply, preservesPartitioning));
  }
```

### BoundedWildcard
Can generalize to `? extends Iterator`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/data/HoodieJavaRDD.java`
#### Snippet
```java

  @Override
  public <O> HoodieData<O> mapPartitions(SerializableFunction<Iterator<T>, Iterator<O>> func, boolean preservesPartitioning) {
    return HoodieJavaRDD.of(rddData.mapPartitions(func::apply, preservesPartitioning));
  }
```

### BoundedWildcard
Can generalize to `? super T`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/data/HoodieJavaRDD.java`
#### Snippet
```java

  @Override
  public <O> HoodieData<O> flatMap(SerializableFunction<T, Iterator<O>> func) {
    // NOTE: Unrolling this lambda into a method reference results in [[ClassCastException]]
    //       due to weird interop b/w Scala and Java
```

### BoundedWildcard
Can generalize to `? extends Iterator`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/data/HoodieJavaRDD.java`
#### Snippet
```java

  @Override
  public <O> HoodieData<O> flatMap(SerializableFunction<T, Iterator<O>> func) {
    // NOTE: Unrolling this lambda into a method reference results in [[ClassCastException]]
    //       due to weird interop b/w Scala and Java
```

### BoundedWildcard
Can generalize to `? super T`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/data/HoodieJavaRDD.java`
#### Snippet
```java

  @Override
  public HoodieData<T> filter(SerializableFunction<T, Boolean> filterFunc) {
    return HoodieJavaRDD.of(rddData.filter(filterFunc::apply));
  }
```

### BoundedWildcard
Can generalize to `? super T`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/data/HoodieJavaRDD.java`
#### Snippet
```java

  @Override
  public <O> HoodieData<O> map(SerializableFunction<T, O> func) {
    return HoodieJavaRDD.of(rddData.map(func::apply));
  }
```

### BoundedWildcard
Can generalize to `? extends O`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/data/HoodieJavaRDD.java`
#### Snippet
```java

  @Override
  public <O> HoodieData<O> map(SerializableFunction<T, O> func) {
    return HoodieJavaRDD.of(rddData.map(func::apply));
  }
```

### BoundedWildcard
Can generalize to `? super T`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/data/HoodieJavaRDD.java`
#### Snippet
```java

  @Override
  public <K, V> HoodiePairData<K, V> mapToPair(SerializablePairFunction<T, K, V> func) {
    return HoodieJavaPairRDD.of(rddData.mapToPair(input -> {
      Pair<K, V> pair = func.call(input);
```

### BoundedWildcard
Can generalize to `? super T`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/data/HoodieJavaRDD.java`
#### Snippet
```java

  @Override
  public <K, V> HoodiePairData<K, V> flatMapToPair(SerializableFunction<T, Iterator<? extends Pair<K, V>>> func) {
    return HoodieJavaPairRDD.of(
        rddData.flatMapToPair(e ->
```

### BoundedWildcard
Can generalize to `? extends Iterator``>`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/data/HoodieJavaRDD.java`
#### Snippet
```java

  @Override
  public <K, V> HoodiePairData<K, V> flatMapToPair(SerializableFunction<T, Iterator<? extends Pair<K, V>>> func) {
    return HoodieJavaPairRDD.of(
        rddData.flatMapToPair(e ->
```

### BoundedWildcard
Can generalize to `? extends I`
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/client/common/HoodieFlinkEngineContext.java`
#### Snippet
```java

  @Override
  public <I, K, V> Map<K, V> mapToPair(List<I> data, SerializablePairFunction<I, K, V> func, Integer parallelism) {
    return data.stream().parallel().map(throwingMapToPairWrapper(func)).collect(Collectors.toMap(Pair::getLeft, Pair::getRight));
  }
```

### BoundedWildcard
Can generalize to `? super I`
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/client/common/HoodieFlinkEngineContext.java`
#### Snippet
```java

  @Override
  public <I, K, V> Map<K, V> mapToPair(List<I> data, SerializablePairFunction<I, K, V> func, Integer parallelism) {
    return data.stream().parallel().map(throwingMapToPairWrapper(func)).collect(Collectors.toMap(Pair::getLeft, Pair::getRight));
  }
```

### BoundedWildcard
Can generalize to `? extends K`
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/client/common/HoodieFlinkEngineContext.java`
#### Snippet
```java

  @Override
  public <I, K, V> Map<K, V> mapToPair(List<I> data, SerializablePairFunction<I, K, V> func, Integer parallelism) {
    return data.stream().parallel().map(throwingMapToPairWrapper(func)).collect(Collectors.toMap(Pair::getLeft, Pair::getRight));
  }
```

### BoundedWildcard
Can generalize to `? extends V`
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/client/common/HoodieFlinkEngineContext.java`
#### Snippet
```java

  @Override
  public <I, K, V> Map<K, V> mapToPair(List<I> data, SerializablePairFunction<I, K, V> func, Integer parallelism) {
    return data.stream().parallel().map(throwingMapToPairWrapper(func)).collect(Collectors.toMap(Pair::getLeft, Pair::getRight));
  }
```

### BoundedWildcard
Can generalize to `? extends I`
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/client/common/HoodieFlinkEngineContext.java`
#### Snippet
```java

  @Override
  public <I, K, V> List<V> mapToPairAndReduceByKey(List<I> data, SerializablePairFunction<I, K, V> mapToPairFunc, SerializableBiFunction<V, V, V> reduceFunc, int parallelism) {
    return data.stream().parallel().map(throwingMapToPairWrapper(mapToPairFunc))
        .collect(Collectors.groupingBy(p -> p.getKey())).values().stream()
```

### BoundedWildcard
Can generalize to `? super I`
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/client/common/HoodieFlinkEngineContext.java`
#### Snippet
```java

  @Override
  public <I, K, V> List<V> mapToPairAndReduceByKey(List<I> data, SerializablePairFunction<I, K, V> mapToPairFunc, SerializableBiFunction<V, V, V> reduceFunc, int parallelism) {
    return data.stream().parallel().map(throwingMapToPairWrapper(mapToPairFunc))
        .collect(Collectors.groupingBy(p -> p.getKey())).values().stream()
```

### BoundedWildcard
Can generalize to `? extends Pair`
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/client/common/HoodieFlinkEngineContext.java`
#### Snippet
```java
  @Override
  public <I, K, V> List<V> reduceByKey(
      List<Pair<K, V>> data, SerializableBiFunction<V, V, V> reduceFunc, int parallelism) {
    return data.stream().parallel()
        .collect(Collectors.groupingBy(p -> p.getKey())).values().stream()
```

### BoundedWildcard
Can generalize to `? extends I`
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/client/common/HoodieFlinkEngineContext.java`
#### Snippet
```java

  @Override
  public <I> void foreach(List<I> data, SerializableConsumer<I> consumer, int parallelism) {
    data.forEach(throwingForeachWrapper(consumer));
  }
```

### BoundedWildcard
Can generalize to `? super I`
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/client/common/HoodieFlinkEngineContext.java`
#### Snippet
```java

  @Override
  public <I> void foreach(List<I> data, SerializableConsumer<I> consumer, int parallelism) {
    data.forEach(throwingForeachWrapper(consumer));
  }
```

### BoundedWildcard
Can generalize to `? extends I`
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/client/common/HoodieFlinkEngineContext.java`
#### Snippet
```java

  @Override
  public <I, O> List<O> flatMap(List<I> data, SerializableFunction<I, Stream<O>> func, int parallelism) {
    return data.stream().parallel().flatMap(throwingFlatMapWrapper(func)).collect(Collectors.toList());
  }
```

### BoundedWildcard
Can generalize to `? super I`
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/client/common/HoodieFlinkEngineContext.java`
#### Snippet
```java

  @Override
  public <I, O> List<O> flatMap(List<I> data, SerializableFunction<I, Stream<O>> func, int parallelism) {
    return data.stream().parallel().flatMap(throwingFlatMapWrapper(func)).collect(Collectors.toList());
  }
```

### BoundedWildcard
Can generalize to `? extends I`
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/client/common/HoodieFlinkEngineContext.java`
#### Snippet
```java

  @Override
  public <I, O> List<O> map(List<I> data, SerializableFunction<I, O> func, int parallelism) {
    return data.stream().parallel().map(throwingMapWrapper(func)).collect(Collectors.toList());
  }
```

### BoundedWildcard
Can generalize to `? super I`
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/client/common/HoodieFlinkEngineContext.java`
#### Snippet
```java

  @Override
  public <I, O> List<O> map(List<I> data, SerializableFunction<I, O> func, int parallelism) {
    return data.stream().parallel().map(throwingMapWrapper(func)).collect(Collectors.toList());
  }
```

### BoundedWildcard
Can generalize to `? extends O`
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/client/common/HoodieFlinkEngineContext.java`
#### Snippet
```java

  @Override
  public <I, O> List<O> map(List<I> data, SerializableFunction<I, O> func, int parallelism) {
    return data.stream().parallel().map(throwingMapWrapper(func)).collect(Collectors.toList());
  }
```

### BoundedWildcard
Can generalize to `? super Iterator`
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/client/common/HoodieFlinkEngineContext.java`
#### Snippet
```java
  @Override
  public <I, K, V> Stream<ImmutablePair<K, V>> mapPartitionsToPairAndReduceByKey(
      Stream<I> data, SerializablePairFlatMapFunction<Iterator<I>, K, V> flatMapToPairFunc,
      SerializableBiFunction<V, V, V> reduceFunc, int parallelism) {
    return throwingFlatMapToPairWrapper(flatMapToPairFunc).apply(data.parallel().iterator())
```

### BoundedWildcard
Can generalize to `? extends HoodieData`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/table/action/commit/SparkInsertOverwriteCommitActionExecutor.java`
#### Snippet
```java

  @Override
  protected Map<String, List<String>> getPartitionToReplacedFileIds(HoodieWriteMetadata<HoodieData<WriteStatus>> writeMetadata) {
    return HoodieJavaPairRDD.getJavaPairRDD(writeMetadata.getWriteStatuses().map(status -> status.getStat().getPartitionPath()).distinct().mapToPair(partitionPath ->
        Pair.of(partitionPath, getAllExistingFileIds(partitionPath)))).collectAsMap();
```

### BoundedWildcard
Can generalize to `? extends Mutation`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/index/hbase/SparkHoodieHBaseIndex.java`
#### Snippet
```java
   * Helper method to facilitate performing mutations (including puts and deletes) in Hbase.
   */
  private void doMutations(BufferedMutator mutator, List<Mutation> mutations, RateLimiter limiter) throws IOException {
    if (mutations.isEmpty()) {
      return;
```

### BoundedWildcard
Can generalize to `? extends WriteStatus`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/index/hbase/SparkHoodieHBaseIndex.java`
#### Snippet
```java
  }

  Tuple2<Long, Integer> getHBasePutAccessParallelism(final JavaRDD<WriteStatus> writeStatusRDD) {
    final JavaPairRDD<Long, Integer> insertOnlyWriteStatusRDD = writeStatusRDD
        .filter(w -> w.getStat().getNumInserts() > 0).mapToPair(w -> new Tuple2<>(w.getStat().getNumInserts(), 1));
```

### BoundedWildcard
Can generalize to `? extends WriteStatus`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/index/hbase/SparkHoodieHBaseIndex.java`
#### Snippet
```java
  }

  Map<String, Integer> mapFileWithInsertsToUniquePartition(JavaRDD<WriteStatus> writeStatusRDD) {
    final Map<String, Integer> fileIdPartitionMap = new HashMap<>();
    int partitionIndex = 0;
```

### BoundedWildcard
Can generalize to `? extends List`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/index/bloom/SparkHoodieBloomIndexHelper.java`
#### Snippet
```java
      final HoodieWriteConfig config,
      final Map<String, Long> recordsPerPartition,
      final Map<String, List<BloomIndexFileInfo>> partitionToFileInfo,
      final JavaPairRDD<HoodieFileGroupId, String> fileComparisonsRDD,
      final HoodieEngineContext context) {
```

### BoundedWildcard
Can generalize to `? extends HoodieTableFileSystemView`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/index/bloom/SparkHoodieBloomIndexHelper.java`
#### Snippet
```java
    private final int targetPartitions;

    AffineBloomIndexFileGroupPartitioner(Broadcast<HoodieTableFileSystemView> baseFileOnlyViewBroadcast,
                                         int targetPartitions) {
      this.targetPartitions = targetPartitions;
```

### BoundedWildcard
Can generalize to `? extends WriteStatus`
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/client/HoodieFlinkWriteClient.java`
#### Snippet
```java
  public Map<String, List<String>> getPartitionToReplacedFileIds(
      WriteOperationType writeOperationType,
      List<WriteStatus> writeStatuses) {
    HoodieFlinkTable<T> table = getHoodieTable();
    switch (writeOperationType) {
```

### BoundedWildcard
Can generalize to `? extends List`
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/client/HoodieFlinkWriteClient.java`
#### Snippet
```java

  @Override
  protected List<WriteStatus> postWrite(HoodieWriteMetadata<List<WriteStatus>> result,
                                        String instantTime,
                                        HoodieTable hoodieTable) {
```

### BoundedWildcard
Can generalize to `? extends HoodieLogFile`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/table/action/deltacommit/SparkUpsertDeltaCommitPartitioner.java`
#### Snippet
```java

  // TODO (NA) : Make this static part of utility
  public long convertLogFilesSizeToExpectedParquetSize(List<HoodieLogFile> hoodieLogFiles) {
    long totalSizeOfLogFiles =
        hoodieLogFiles.stream()
```

### BoundedWildcard
Can generalize to `? extends Map`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/SparkRDDTableServiceClient.java`
#### Snippet
```java

  @Override
  public void commitCompaction(String compactionInstantTime, HoodieCommitMetadata metadata, Option<Map<String, String>> extraMetadata) {
    HoodieSparkTable<T> table = HoodieSparkTable.create(config, context);
    extraMetadata.ifPresent(m -> m.forEach(metadata::addMetadata));
```

### BoundedWildcard
Can generalize to `? extends HoodieKey`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/SparkRDDReadClient.java`
#### Snippet
```java
   * component (without scheme) of the URI underlying file
   */
  public JavaPairRDD<HoodieKey, Option<Pair<String, String>>> checkExists(JavaRDD<HoodieKey> hoodieKeys) {
    return HoodieJavaRDD.getJavaRDD(
        index.tagLocation(HoodieJavaRDD.of(hoodieKeys.map(k -> new HoodieAvroRecord<>(k, null))),
```

### BoundedWildcard
Can generalize to `? extends Pair`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/SparkRDDReadClient.java`
#### Snippet
```java
  }

  private Option<String> convertToDataFilePath(Option<Pair<String, String>> partitionPathFileIDPair) {
    if (partitionPathFileIDPair.isPresent()) {
      HoodieBaseFile dataFile = hoodieTable.getBaseFileOnlyView()
```

### BoundedWildcard
Can generalize to `? extends O`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/validator/SparkPreCommitValidator.java`
#### Snippet
```java
  }
  
  protected Set<String> getPartitionsModified(HoodieWriteMetadata<O> writeResult) {
    Set<String> partitionsModified;
    if (writeResult.getWriteStats().isPresent()) {
```

### BoundedWildcard
Can generalize to `? super String`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/utils/SparkInternalSchemaConverter.java`
#### Snippet
```java
  }

  private static void addFullName(DataType sparkType, String name, Deque<String> fieldNames, List<String> resultSet) {
    if (!(sparkType instanceof StructType) && !(sparkType instanceof ArrayType) && !(sparkType instanceof MapType)) {
      resultSet.add(InternalSchemaUtils.createFullName(name, fieldNames));
```

### BoundedWildcard
Can generalize to `? extends Map`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/table/action/bootstrap/SparkBootstrapCommitActionExecutor.java`
#### Snippet
```java
  }

  protected void commit(Option<Map<String, String>> extraMetadata, HoodieWriteMetadata<HoodieData<WriteStatus>> result, List<HoodieWriteStat> stats) {
    String actionType = table.getMetaClient().getCommitActionType();
    LOG.info("Committing " + instantTime + ", action Type " + actionType);
```

### BoundedWildcard
Can generalize to `? super HoodieData`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/table/action/bootstrap/SparkBootstrapCommitActionExecutor.java`
#### Snippet
```java
  }

  private void updateIndexAndCommitIfNeeded(HoodieData<WriteStatus> writeStatuses, HoodieWriteMetadata<HoodieData<WriteStatus>> result) {
    // cache writeStatusRDD before updating index, so that all actions before this are not triggered again for future
    // RDD actions that are performed after updating the index.
```

### BoundedWildcard
Can generalize to `? extends HoodieFileGroupId`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/clustering/run/strategy/SparkSingleFileSortExecutionStrategy.java`
#### Snippet
```java
                                                                 Map<String, String> strategyParams,
                                                                 Schema schema,
                                                                 List<HoodieFileGroupId> fileGroupIdList,
                                                                 boolean shouldPreserveHoodieMetadata,
                                                                 Map<String, String> extraMetadata) {
```

### BoundedWildcard
Can generalize to `? extends ClusteringOperation`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/clustering/run/strategy/SingleSparkJobExecutionStrategy.java`
#### Snippet
```java
   * Read records from baseFiles and get iterator.
   */
  private Iterator<HoodieRecord<T>> readRecordsForGroupBaseFiles(List<ClusteringOperation> clusteringOps) {
    List<Iterator<HoodieRecord<T>>> iteratorsForPartition = clusteringOps.stream().map(clusteringOp -> {

```

### BoundedWildcard
Can generalize to `? extends HoodieData`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/table/action/commit/BaseSparkCommitActionExecutor.java`
#### Snippet
```java

  @Override
  protected void setCommitMetadata(HoodieWriteMetadata<HoodieData<WriteStatus>> result) {
    result.setCommitMetadata(Option.of(CommitUtils.buildMetadata(result.getWriteStatuses().map(WriteStatus::getStat).collectAsList(),
        result.getPartitionToReplaceFileIds(),
```

### BoundedWildcard
Can generalize to `? extends HoodieRecord`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/table/action/commit/BaseSparkCommitActionExecutor.java`
#### Snippet
```java
  }

  private HoodieData<WriteStatus> mapPartitionsAsRDD(HoodieData<HoodieRecord<T>> dedupedRecords, Partitioner partitioner) {
    JavaPairRDD<Tuple2<HoodieKey, Option<HoodieRecordLocation>>, HoodieRecord<T>> mappedRDD = HoodieJavaPairRDD.getJavaPairRDD(
        dedupedRecords.mapToPair(record -> Pair.of(new Tuple2<>(record.getKey(), Option.ofNullable(record.getCurrentLocation())), record)));
```

### BoundedWildcard
Can generalize to `? extends HoodieRecord`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/table/action/commit/BaseSparkCommitActionExecutor.java`
#### Snippet
```java
   * Count the number of updates/inserts for each file in each partition.
   */
  private Pair<HashMap<String, WorkloadStat>, WorkloadStat> buildProfile(HoodieData<HoodieRecord<T>> inputRecords) {
    HashMap<String, WorkloadStat> partitionPathStatMap = new HashMap<>();
    WorkloadStat globalStat = new WorkloadStat();
```

### BoundedWildcard
Can generalize to `? super HoodieData`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/table/action/commit/BaseSparkCommitActionExecutor.java`
#### Snippet
```java
  }

  protected HoodieData<WriteStatus> updateIndex(HoodieData<WriteStatus> writeStatuses, HoodieWriteMetadata<HoodieData<WriteStatus>> result) {
    // cache writeStatusRDD before updating index, so that all actions before this are not triggered again for future
    // RDD actions that are performed after updating the index.
```

### BoundedWildcard
Can generalize to `? extends I`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/common/HoodieSparkEngineContext.java`
#### Snippet
```java

  @Override
  public <I, O> List<O> map(List<I> data, SerializableFunction<I, O> func, int parallelism) {
    return javaSparkContext.parallelize(data, parallelism).map(func::apply).collect();
  }
```

### BoundedWildcard
Can generalize to `? super I`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/common/HoodieSparkEngineContext.java`
#### Snippet
```java

  @Override
  public <I, O> List<O> map(List<I> data, SerializableFunction<I, O> func, int parallelism) {
    return javaSparkContext.parallelize(data, parallelism).map(func::apply).collect();
  }
```

### BoundedWildcard
Can generalize to `? super Iterator`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/common/HoodieSparkEngineContext.java`
#### Snippet
```java
  @Override
  public <I, K, V> Stream<ImmutablePair<K, V>> mapPartitionsToPairAndReduceByKey(
      Stream<I> data, SerializablePairFlatMapFunction<Iterator<I>, K, V> flatMapToPairFunc,
      SerializableBiFunction<V, V, V> reduceFunc, int parallelism) {
    return javaSparkContext.parallelize(data.collect(Collectors.toList()), parallelism)
```

### BoundedWildcard
Can generalize to `? super V`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/common/HoodieSparkEngineContext.java`
#### Snippet
```java
  public <I, K, V> Stream<ImmutablePair<K, V>> mapPartitionsToPairAndReduceByKey(
      Stream<I> data, SerializablePairFlatMapFunction<Iterator<I>, K, V> flatMapToPairFunc,
      SerializableBiFunction<V, V, V> reduceFunc, int parallelism) {
    return javaSparkContext.parallelize(data.collect(Collectors.toList()), parallelism)
        .mapPartitionsToPair((PairFlatMapFunction<Iterator<I>, K, V>) iterator ->
```

### BoundedWildcard
Can generalize to `? super V`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/common/HoodieSparkEngineContext.java`
#### Snippet
```java
  public <I, K, V> Stream<ImmutablePair<K, V>> mapPartitionsToPairAndReduceByKey(
      Stream<I> data, SerializablePairFlatMapFunction<Iterator<I>, K, V> flatMapToPairFunc,
      SerializableBiFunction<V, V, V> reduceFunc, int parallelism) {
    return javaSparkContext.parallelize(data.collect(Collectors.toList()), parallelism)
        .mapPartitionsToPair((PairFlatMapFunction<Iterator<I>, K, V>) iterator ->
```

### BoundedWildcard
Can generalize to `? extends V`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/common/HoodieSparkEngineContext.java`
#### Snippet
```java
  public <I, K, V> Stream<ImmutablePair<K, V>> mapPartitionsToPairAndReduceByKey(
      Stream<I> data, SerializablePairFlatMapFunction<Iterator<I>, K, V> flatMapToPairFunc,
      SerializableBiFunction<V, V, V> reduceFunc, int parallelism) {
    return javaSparkContext.parallelize(data.collect(Collectors.toList()), parallelism)
        .mapPartitionsToPair((PairFlatMapFunction<Iterator<I>, K, V>) iterator ->
```

### BoundedWildcard
Can generalize to `? extends I`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/common/HoodieSparkEngineContext.java`
#### Snippet
```java

  @Override
  public <I, K, V> List<V> mapToPairAndReduceByKey(List<I> data, SerializablePairFunction<I, K, V> mapToPairFunc, SerializableBiFunction<V, V, V> reduceFunc, int parallelism) {
    return javaSparkContext.parallelize(data, parallelism).mapToPair(input -> {
      Pair<K, V> pair = mapToPairFunc.call(input);
```

### BoundedWildcard
Can generalize to `? super I`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/common/HoodieSparkEngineContext.java`
#### Snippet
```java

  @Override
  public <I, K, V> List<V> mapToPairAndReduceByKey(List<I> data, SerializablePairFunction<I, K, V> mapToPairFunc, SerializableBiFunction<V, V, V> reduceFunc, int parallelism) {
    return javaSparkContext.parallelize(data, parallelism).mapToPair(input -> {
      Pair<K, V> pair = mapToPairFunc.call(input);
```

### BoundedWildcard
Can generalize to `? super V`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/common/HoodieSparkEngineContext.java`
#### Snippet
```java

  @Override
  public <I, K, V> List<V> mapToPairAndReduceByKey(List<I> data, SerializablePairFunction<I, K, V> mapToPairFunc, SerializableBiFunction<V, V, V> reduceFunc, int parallelism) {
    return javaSparkContext.parallelize(data, parallelism).mapToPair(input -> {
      Pair<K, V> pair = mapToPairFunc.call(input);
```

### BoundedWildcard
Can generalize to `? super V`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/common/HoodieSparkEngineContext.java`
#### Snippet
```java

  @Override
  public <I, K, V> List<V> mapToPairAndReduceByKey(List<I> data, SerializablePairFunction<I, K, V> mapToPairFunc, SerializableBiFunction<V, V, V> reduceFunc, int parallelism) {
    return javaSparkContext.parallelize(data, parallelism).mapToPair(input -> {
      Pair<K, V> pair = mapToPairFunc.call(input);
```

### BoundedWildcard
Can generalize to `? extends V`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/common/HoodieSparkEngineContext.java`
#### Snippet
```java

  @Override
  public <I, K, V> List<V> mapToPairAndReduceByKey(List<I> data, SerializablePairFunction<I, K, V> mapToPairFunc, SerializableBiFunction<V, V, V> reduceFunc, int parallelism) {
    return javaSparkContext.parallelize(data, parallelism).mapToPair(input -> {
      Pair<K, V> pair = mapToPairFunc.call(input);
```

### BoundedWildcard
Can generalize to `? extends I`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/common/HoodieSparkEngineContext.java`
#### Snippet
```java

  @Override
  public <I, O> List<O> flatMap(List<I> data, SerializableFunction<I, Stream<O>> func, int parallelism) {
    return javaSparkContext.parallelize(data, parallelism).flatMap(x -> func.apply(x).iterator()).collect();
  }
```

### BoundedWildcard
Can generalize to `? super I`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/common/HoodieSparkEngineContext.java`
#### Snippet
```java

  @Override
  public <I, O> List<O> flatMap(List<I> data, SerializableFunction<I, Stream<O>> func, int parallelism) {
    return javaSparkContext.parallelize(data, parallelism).flatMap(x -> func.apply(x).iterator()).collect();
  }
```

### BoundedWildcard
Can generalize to `? extends Stream`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/common/HoodieSparkEngineContext.java`
#### Snippet
```java

  @Override
  public <I, O> List<O> flatMap(List<I> data, SerializableFunction<I, Stream<O>> func, int parallelism) {
    return javaSparkContext.parallelize(data, parallelism).flatMap(x -> func.apply(x).iterator()).collect();
  }
```

### BoundedWildcard
Can generalize to `? extends Pair`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/common/HoodieSparkEngineContext.java`
#### Snippet
```java
  @Override
  public <I, K, V> List<V> reduceByKey(
      List<Pair<K, V>> data, SerializableBiFunction<V, V, V> reduceFunc, int parallelism) {
    return javaSparkContext.parallelize(data, parallelism).mapToPair(pair -> new Tuple2<K, V>(pair.getLeft(), pair.getRight()))
        .reduceByKey(reduceFunc::apply).map(Tuple2::_2).collect();
```

### BoundedWildcard
Can generalize to `? super V`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/common/HoodieSparkEngineContext.java`
#### Snippet
```java
  @Override
  public <I, K, V> List<V> reduceByKey(
      List<Pair<K, V>> data, SerializableBiFunction<V, V, V> reduceFunc, int parallelism) {
    return javaSparkContext.parallelize(data, parallelism).mapToPair(pair -> new Tuple2<K, V>(pair.getLeft(), pair.getRight()))
        .reduceByKey(reduceFunc::apply).map(Tuple2::_2).collect();
```

### BoundedWildcard
Can generalize to `? super V`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/common/HoodieSparkEngineContext.java`
#### Snippet
```java
  @Override
  public <I, K, V> List<V> reduceByKey(
      List<Pair<K, V>> data, SerializableBiFunction<V, V, V> reduceFunc, int parallelism) {
    return javaSparkContext.parallelize(data, parallelism).mapToPair(pair -> new Tuple2<K, V>(pair.getLeft(), pair.getRight()))
        .reduceByKey(reduceFunc::apply).map(Tuple2::_2).collect();
```

### BoundedWildcard
Can generalize to `? extends V`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/common/HoodieSparkEngineContext.java`
#### Snippet
```java
  @Override
  public <I, K, V> List<V> reduceByKey(
      List<Pair<K, V>> data, SerializableBiFunction<V, V, V> reduceFunc, int parallelism) {
    return javaSparkContext.parallelize(data, parallelism).mapToPair(pair -> new Tuple2<K, V>(pair.getLeft(), pair.getRight()))
        .reduceByKey(reduceFunc::apply).map(Tuple2::_2).collect();
```

### BoundedWildcard
Can generalize to `? extends I`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/common/HoodieSparkEngineContext.java`
#### Snippet
```java

  @Override
  public <I, K, V> Map<K, V> mapToPair(List<I> data, SerializablePairFunction<I, K, V> func, Integer parallelism) {
    if (Objects.nonNull(parallelism)) {
      return javaSparkContext.parallelize(data, parallelism).mapToPair(input -> {
```

### BoundedWildcard
Can generalize to `? super I`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/common/HoodieSparkEngineContext.java`
#### Snippet
```java

  @Override
  public <I, K, V> Map<K, V> mapToPair(List<I> data, SerializablePairFunction<I, K, V> func, Integer parallelism) {
    if (Objects.nonNull(parallelism)) {
      return javaSparkContext.parallelize(data, parallelism).mapToPair(input -> {
```

### BoundedWildcard
Can generalize to `? extends I`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/common/HoodieSparkEngineContext.java`
#### Snippet
```java

  @Override
  public <I> void foreach(List<I> data, SerializableConsumer<I> consumer, int parallelism) {
    javaSparkContext.parallelize(data, parallelism).foreach(consumer::accept);
  }
```

### BoundedWildcard
Can generalize to `? super I`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/common/HoodieSparkEngineContext.java`
#### Snippet
```java

  @Override
  public <I> void foreach(List<I> data, SerializableConsumer<I> consumer, int parallelism) {
    javaSparkContext.parallelize(data, parallelism).foreach(consumer::accept);
  }
```

### BoundedWildcard
Can generalize to `? extends HoodieRecord`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/clustering/update/strategy/BaseSparkUpdateStrategy.java`
#### Snippet
```java
   * @return the records matched file group ids
   */
  protected List<HoodieFileGroupId> getGroupIdsWithUpdate(HoodieData<HoodieRecord<T>> inputRecords) {
    return inputRecords
            .filter(record -> record.getCurrentLocation() != null)
```

### BoundedWildcard
Can generalize to `? extends StringBuilder`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/keygen/PartitionPathFormatterBase.java`
#### Snippet
```java
  private final boolean useEncoding;

  PartitionPathFormatterBase(Supplier<StringBuilder<S>> stringBuilderFactory,
                             boolean useHiveStylePartitioning,
                             boolean useEncoding) {
```

### BoundedWildcard
Can generalize to `? extends JavaRDD`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/SparkRDDWriteClient.java`
#### Snippet
```java

  @Override
  protected JavaRDD<WriteStatus> postWrite(HoodieWriteMetadata<JavaRDD<WriteStatus>> result,
                                           String instantTime,
                                           HoodieTable hoodieTable) {
```

### BoundedWildcard
Can generalize to `? extends Map`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/SparkRDDWriteClient.java`
#### Snippet
```java

  @Override
  public void commitLogCompaction(String logCompactionInstantTime, HoodieCommitMetadata metadata, Option<Map<String, String>> extraMetadata) {
    HoodieSparkTable<T> table = HoodieSparkTable.create(config, context);
    extraMetadata.ifPresent(m -> m.forEach(metadata::addMetadata));
```

### BoundedWildcard
Can generalize to `? extends ClusteringOperation`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/clustering/run/strategy/MultipleSparkJobExecutionStrategy.java`
#### Snippet
```java
   */
  private HoodieData<HoodieRecord<T>> readRecordsForGroupBaseFiles(JavaSparkContext jsc,
                                                                   List<ClusteringOperation> clusteringOps) {
    SerializableConfiguration hadoopConf = new SerializableConfiguration(getHoodieTable().getHadoopConf());
    HoodieWriteConfig writeConfig = getWriteConfig();
```

### BoundedWildcard
Can generalize to `? extends ClusteringOperation`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/clustering/run/strategy/MultipleSparkJobExecutionStrategy.java`
#### Snippet
```java
   */
  private HoodieData<HoodieRecord<T>> readRecordsForGroupWithLogs(JavaSparkContext jsc,
                                                                  List<ClusteringOperation> clusteringOps,
                                                                  String instantTime) {
    HoodieWriteConfig config = getWriteConfig();
```

### BoundedWildcard
Can generalize to `? extends PartitionPathFormatterBase.StringBuilder`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/keygen/BuiltinKeyGenerator.java`
#### Snippet
```java

  private <S> S combineRecordKeyInternal(
      Supplier<PartitionPathFormatterBase.StringBuilder<S>> builderFactory,
      Function<Object, S> converter,
      Function<S, S> emptyKeyPartHandler,
```

### BoundedWildcard
Can generalize to `? extends S`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/keygen/BuiltinKeyGenerator.java`
#### Snippet
```java
  private <S> S combineRecordKeyInternal(
      Supplier<PartitionPathFormatterBase.StringBuilder<S>> builderFactory,
      Function<Object, S> converter,
      Function<S, S> emptyKeyPartHandler,
      List<String> fieldNames,
```

### BoundedWildcard
Can generalize to `? super S`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/keygen/BuiltinKeyGenerator.java`
#### Snippet
```java
      Supplier<PartitionPathFormatterBase.StringBuilder<S>> builderFactory,
      Function<Object, S> converter,
      Function<S, S> emptyKeyPartHandler,
      List<String> fieldNames,
      List<Object> recordKeyParts
```

### BoundedWildcard
Can generalize to `? extends S`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/keygen/BuiltinKeyGenerator.java`
#### Snippet
```java
      Supplier<PartitionPathFormatterBase.StringBuilder<S>> builderFactory,
      Function<Object, S> converter,
      Function<S, S> emptyKeyPartHandler,
      List<String> fieldNames,
      List<Object> recordKeyParts
```

### BoundedWildcard
Can generalize to `? extends PartitionPathFormatterBase.StringBuilder`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/keygen/BuiltinKeyGenerator.java`
#### Snippet
```java

  private <S> S combineCompositeRecordKeyInternal(
      Supplier<PartitionPathFormatterBase.StringBuilder<S>> builderFactory,
      Function<Object, S> converter,
      Function<S, S> emptyKeyPartHandler,
```

### BoundedWildcard
Can generalize to `? extends S`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/keygen/BuiltinKeyGenerator.java`
#### Snippet
```java
  private <S> S combineCompositeRecordKeyInternal(
      Supplier<PartitionPathFormatterBase.StringBuilder<S>> builderFactory,
      Function<Object, S> converter,
      Function<S, S> emptyKeyPartHandler,
      Predicate<S> isNullOrEmptyKeyPartPredicate,
```

### BoundedWildcard
Can generalize to `? super S`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/keygen/BuiltinKeyGenerator.java`
#### Snippet
```java
      Supplier<PartitionPathFormatterBase.StringBuilder<S>> builderFactory,
      Function<Object, S> converter,
      Function<S, S> emptyKeyPartHandler,
      Predicate<S> isNullOrEmptyKeyPartPredicate,
      Object... recordKeyParts
```

### BoundedWildcard
Can generalize to `? extends S`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/keygen/BuiltinKeyGenerator.java`
#### Snippet
```java
      Supplier<PartitionPathFormatterBase.StringBuilder<S>> builderFactory,
      Function<Object, S> converter,
      Function<S, S> emptyKeyPartHandler,
      Predicate<S> isNullOrEmptyKeyPartPredicate,
      Object... recordKeyParts
```

### BoundedWildcard
Can generalize to `? super S`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/keygen/BuiltinKeyGenerator.java`
#### Snippet
```java
      Function<Object, S> converter,
      Function<S, S> emptyKeyPartHandler,
      Predicate<S> isNullOrEmptyKeyPartPredicate,
      Object... recordKeyParts
  ) {
```

### BoundedWildcard
Can generalize to `? extends HoodieRecord`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/execution/bulkinsert/RDDConsistentBucketPartitioner.java`
#### Snippet
```java
   * the mapping from partition to its bucket identifier is constructed.
   */
  private Map<String, ConsistentBucketIdentifier> initializeBucketIdentifier(JavaRDD<HoodieRecord<T>> records) {
    return records.map(HoodieRecord::getPartitionPath).distinct().collect().stream()
        .collect(Collectors.toMap(p -> p, p -> getBucketIdentifier(p)));
```

### BoundedWildcard
Can generalize to `? extends HoodieRecord`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/execution/bulkinsert/RDDConsistentBucketPartitioner.java`
#### Snippet
```java
   * @return
   */
  private JavaRDD<HoodieRecord<T>> doPartitionAndSortByRecordKey(JavaRDD<HoodieRecord<T>> records, Partitioner partitioner) {
    if (table.getConfig().getBulkInsertSortMode() == BulkInsertSortMode.GLOBAL_SORT) {
      LOG.warn("Consistent bucket does not support global sort mode, the sort will only be done within each data partition");
```

### BoundedWildcard
Can generalize to `? extends ConsistentBucketIdentifier`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/execution/bulkinsert/RDDConsistentBucketPartitioner.java`
#### Snippet
```java
   * @param partitionToIdentifier Mapping from table partition to bucket identifier
   */
  private Map<String, Map<String, Integer>> generateFileIdPfx(Map<String, ConsistentBucketIdentifier> partitionToIdentifier) {
    Map<String, Map<String, Integer>> partitionToFileIdPfxIdxMap = new HashMap(partitionToIdentifier.size() * 2);
    doAppend = new ArrayList<>();
```

### BoundedWildcard
Can generalize to `? extends HoodieBaseFile`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/io/HoodieKeyLocationFetchHandle.java`
#### Snippet
```java

  public HoodieKeyLocationFetchHandle(HoodieWriteConfig config, HoodieTable<T, I, K, O> hoodieTable,
                                      Pair<String, HoodieBaseFile> partitionPathBaseFilePair, Option<BaseKeyGenerator> keyGeneratorOpt) {
    super(config, hoodieTable, Pair.of(partitionPathBaseFilePair.getLeft(), partitionPathBaseFilePair.getRight().getFileId()));
    this.partitionPathBaseFilePair = partitionPathBaseFilePair;
```

### BoundedWildcard
Can generalize to `? extends FileSlice`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/io/HoodieWriteHandle.java`
#### Snippet
```java

  protected HoodieLogFormat.Writer createLogWriter(
      Option<FileSlice> fileSlice, String baseCommitTime, String suffix) throws IOException {
    Option<HoodieLogFile> latestLogFile = fileSlice.isPresent()
        ? fileSlice.get().getLatestLogFile()
```

### BoundedWildcard
Can generalize to `? extends HoodieRecord`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/io/HoodieConcatHandle.java`
#### Snippet
```java

  public HoodieConcatHandle(HoodieWriteConfig config, String instantTime, HoodieTable<T, I, K, O> hoodieTable,
                            Iterator<HoodieRecord<T>> recordItr, String partitionPath, String fileId,
                            TaskContextSupplier taskContextSupplier, Option<BaseKeyGenerator> keyGeneratorOpt) {
    super(config, instantTime, hoodieTable, Collections.emptyIterator(), partitionPath, fileId, taskContextSupplier, keyGeneratorOpt);
```

### BoundedWildcard
Can generalize to `? super Boolean`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/async/HoodieAsyncService.java`
#### Snippet
```java
   */
  @SuppressWarnings("unchecked")
  private void shutdownCallback(Function<Boolean, Boolean> callback) {
    if (future == null) {
      return;
```

### BoundedWildcard
Can generalize to `? extends HoodieRecord`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/io/HoodieMergeHandleWithChangeLog.java`
#### Snippet
```java
  }

  protected boolean writeUpdateRecord(HoodieRecord<T> newRecord, HoodieRecord<T> oldRecord, Option<HoodieRecord> combinedRecordOpt, Schema writerSchema)
      throws IOException {
    // TODO [HUDI-5019] Remove these unnecessary newInstance invocations
```

### BoundedWildcard
Can generalize to `? extends HoodieRecordLocation`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/index/HoodieIndexUtils.java`
#### Snippet
```java
   * @return the tagged {@link HoodieRecord}
   */
  public static HoodieRecord getTaggedRecord(HoodieRecord inputRecord, Option<HoodieRecordLocation> location) {
    HoodieRecord<?> record = inputRecord;
    if (location.isPresent()) {
```

### BoundedWildcard
Can generalize to `? super String`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/index/bloom/KeyRangeLookupTree.java`
#### Snippet
```java
   * @param lookupKey the key to be searched for
   */
  private void getMatchingIndexFiles(KeyRangeNode root, String lookupKey, Set<String> matchingFileNameSet) {
    if (root == null) {
      return;
```

### BoundedWildcard
Can generalize to `? extends List`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/index/bloom/IntervalTreeBasedIndexFileFilter.java`
#### Snippet
```java
   * @param partitionToFileIndexInfo Map of partition to List of {@link BloomIndexFileInfo}s
   */
  IntervalTreeBasedIndexFileFilter(final Map<String, List<BloomIndexFileInfo>> partitionToFileIndexInfo) {
    partitionToFileIndexInfo.forEach((partition, bloomIndexFiles) -> {
      // Note that the interval tree implementation doesn't have auto-balancing to ensure logN search time.
```

### BoundedWildcard
Can generalize to `? extends List`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/index/bloom/IntervalTreeBasedGlobalIndexFileFilter.java`
#### Snippet
```java
   * @param partitionToFileIndexInfo Map of partition to List of {@link BloomIndexFileInfo}s
   */
  IntervalTreeBasedGlobalIndexFileFilter(final Map<String, List<BloomIndexFileInfo>> partitionToFileIndexInfo) {
    List<BloomIndexFileInfo> allIndexFiles = new ArrayList<>();

```

### BoundedWildcard
Can generalize to `? super I`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/index/bloom/HoodieBloomIndexCheckFunction.java`
#### Snippet
```java
  public HoodieBloomIndexCheckFunction(HoodieTable hoodieTable,
                                       HoodieWriteConfig config,
                                       SerializableFunction<I, HoodieFileGroupId> fileGroupIdExtractor,
                                       SerializableFunction<I, String> recordKeyExtractor) {
    this.hoodieTable = hoodieTable;
```

### BoundedWildcard
Can generalize to `? extends HoodieFileGroupId`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/index/bloom/HoodieBloomIndexCheckFunction.java`
#### Snippet
```java
  public HoodieBloomIndexCheckFunction(HoodieTable hoodieTable,
                                       HoodieWriteConfig config,
                                       SerializableFunction<I, HoodieFileGroupId> fileGroupIdExtractor,
                                       SerializableFunction<I, String> recordKeyExtractor) {
    this.hoodieTable = hoodieTable;
```

### BoundedWildcard
Can generalize to `? super I`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/index/bloom/HoodieBloomIndexCheckFunction.java`
#### Snippet
```java
                                       HoodieWriteConfig config,
                                       SerializableFunction<I, HoodieFileGroupId> fileGroupIdExtractor,
                                       SerializableFunction<I, String> recordKeyExtractor) {
    this.hoodieTable = hoodieTable;
    this.config = config;
```

### BoundedWildcard
Can generalize to `? extends List`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/index/bloom/ListBasedIndexFileFilter.java`
#### Snippet
```java
   * @param partitionToFileIndexInfo Map of partition to List of {@link BloomIndexFileInfo}
   */
  ListBasedIndexFileFilter(final Map<String, List<BloomIndexFileInfo>> partitionToFileIndexInfo) {
    this.partitionToFileIndexInfo = partitionToFileIndexInfo;
  }
```

### BoundedWildcard
Can generalize to `? extends HoodieRecord`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/io/HoodieAppendHandle.java`
#### Snippet
```java
  }

  private void processAppendResult(AppendResult result, List<HoodieRecord> recordList) throws IOException {
    HoodieDeltaWriteStat stat = (HoodieDeltaWriteStat) this.writeStatus.getStat();

```

### BoundedWildcard
Can generalize to `? extends HoodieKey`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/index/bloom/HoodieGlobalBloomIndex.java`
#### Snippet
```java
  @Override
  protected <R> HoodieData<HoodieRecord<R>> tagLocationBacktoRecords(
      HoodiePairData<HoodieKey, HoodieRecordLocation> keyLocationPairs,
      HoodieData<HoodieRecord<R>> records) {

```

### BoundedWildcard
Can generalize to `? extends HoodieRecordLocation`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/index/bloom/HoodieGlobalBloomIndex.java`
#### Snippet
```java
  @Override
  protected <R> HoodieData<HoodieRecord<R>> tagLocationBacktoRecords(
      HoodiePairData<HoodieKey, HoodieRecordLocation> keyLocationPairs,
      HoodieData<HoodieRecord<R>> records) {

```

### BoundedWildcard
Can generalize to `? extends HoodieRecord`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/index/bloom/HoodieGlobalBloomIndex.java`
#### Snippet
```java
  protected <R> HoodieData<HoodieRecord<R>> tagLocationBacktoRecords(
      HoodiePairData<HoodieKey, HoodieRecordLocation> keyLocationPairs,
      HoodieData<HoodieRecord<R>> records) {

    HoodiePairData<String, HoodieRecord<R>> incomingRowKeyRecordPairs =
```

### BoundedWildcard
Can generalize to `? extends HoodieRecord`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/index/inmemory/HoodieInMemoryHashIndex.java`
#### Snippet
```java
  @Override
  public <R> HoodieData<HoodieRecord<R>> tagLocation(
      HoodieData<HoodieRecord<R>> records, HoodieEngineContext context,
      HoodieTable hoodieTable) {
    return records.mapPartitions(hoodieRecordIterator -> {
```

### BoundedWildcard
Can generalize to `? extends WriteStatus`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/index/inmemory/HoodieInMemoryHashIndex.java`
#### Snippet
```java
  @Override
  public HoodieData<WriteStatus> updateLocation(
      HoodieData<WriteStatus> writeStatuses, HoodieEngineContext context,
      HoodieTable hoodieTable) {
    return writeStatuses.map(writeStatus -> {
```

### BoundedWildcard
Can generalize to `? extends Pair`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/index/simple/HoodieSimpleIndex.java`
#### Snippet
```java
  protected HoodiePairData<HoodieKey, HoodieRecordLocation> fetchRecordLocations(
      HoodieEngineContext context, HoodieTable hoodieTable, int parallelism,
      List<Pair<String, HoodieBaseFile>> baseFiles) {
    int fetchParallelism = Math.max(1, Math.min(baseFiles.size(), parallelism));

```

### BoundedWildcard
Can generalize to `? extends HoodieKey`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/index/simple/HoodieSimpleIndex.java`
#### Snippet
```java
   */
  protected HoodiePairData<HoodieKey, HoodieRecordLocation> fetchRecordLocationsForAffectedPartitions(
      HoodieData<HoodieKey> hoodieKeys, HoodieEngineContext context, HoodieTable hoodieTable,
      int parallelism) {
    List<String> affectedPartitionPathList =
```

### BoundedWildcard
Can generalize to `? extends HoodieRecord`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/index/simple/HoodieSimpleIndex.java`
#### Snippet
```java
   */
  protected <R> HoodieData<HoodieRecord<R>> tagLocationInternal(
      HoodieData<HoodieRecord<R>> inputRecords, HoodieEngineContext context,
      HoodieTable hoodieTable) {
    if (config.getSimpleIndexUseCaching()) {
```

### BoundedWildcard
Can generalize to `? extends HoodieRecord`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/index/simple/HoodieGlobalSimpleIndex.java`
#### Snippet
```java
   */
  private <R> HoodieData<HoodieRecord<R>> getTaggedRecords(
      HoodiePairData<String, HoodieRecord<R>> incomingRecords,
      HoodiePairData<HoodieKey, HoodieRecordLocation> existingRecords) {
    HoodiePairData<String, Pair<String, HoodieRecordLocation>> existingRecordByRecordKey =
```

### BoundedWildcard
Can generalize to `? extends HoodieKey`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/index/simple/HoodieGlobalSimpleIndex.java`
#### Snippet
```java
  private <R> HoodieData<HoodieRecord<R>> getTaggedRecords(
      HoodiePairData<String, HoodieRecord<R>> incomingRecords,
      HoodiePairData<HoodieKey, HoodieRecordLocation> existingRecords) {
    HoodiePairData<String, Pair<String, HoodieRecordLocation>> existingRecordByRecordKey =
        existingRecords.mapToPair(
```

### BoundedWildcard
Can generalize to `? extends HoodieRecordLocation`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/index/simple/HoodieGlobalSimpleIndex.java`
#### Snippet
```java
  private <R> HoodieData<HoodieRecord<R>> getTaggedRecords(
      HoodiePairData<String, HoodieRecord<R>> incomingRecords,
      HoodiePairData<HoodieKey, HoodieRecordLocation> existingRecords) {
    HoodiePairData<String, Pair<String, HoodieRecordLocation>> existingRecordByRecordKey =
        existingRecords.mapToPair(
```

### BoundedWildcard
Can generalize to `? extends HoodieRecord`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/index/simple/HoodieGlobalSimpleIndex.java`
#### Snippet
```java
  @Override
  protected <R> HoodieData<HoodieRecord<R>> tagLocationInternal(
      HoodieData<HoodieRecord<R>> inputRecords, HoodieEngineContext context,
      HoodieTable hoodieTable) {

```

### BoundedWildcard
Can generalize to `? extends HoodieRecordLocation`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/index/bloom/HoodieBloomIndex.java`
#### Snippet
```java
   */
  protected <R> HoodieData<HoodieRecord<R>> tagLocationBacktoRecords(
      HoodiePairData<HoodieKey, HoodieRecordLocation> keyFilenamePair,
      HoodieData<HoodieRecord<R>> records) {
    HoodiePairData<HoodieKey, HoodieRecord<R>> keyRecordPairs =
```

### BoundedWildcard
Can generalize to `? extends HoodieRecord`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/index/bloom/HoodieBloomIndex.java`
#### Snippet
```java
  protected <R> HoodieData<HoodieRecord<R>> tagLocationBacktoRecords(
      HoodiePairData<HoodieKey, HoodieRecordLocation> keyFilenamePair,
      HoodieData<HoodieRecord<R>> records) {
    HoodiePairData<HoodieKey, HoodieRecord<R>> keyRecordPairs =
        records.mapToPair(record -> new ImmutablePair<>(record.getKey(), record));
```

### BoundedWildcard
Can generalize to `? super I`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/commit/ParallelismHelper.java`
#### Snippet
```java
  private final SerializableFunctionUnchecked<I, Integer> partitionNumberExtractor;

  protected ParallelismHelper(SerializableFunctionUnchecked<I, Integer> partitionNumberExtractor) {
    this.partitionNumberExtractor = partitionNumberExtractor;
  }
```

### BoundedWildcard
Can generalize to `? super I`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/commit/BaseWriteHelper.java`
#### Snippet
```java
                                      boolean shouldCombine,
                                      int configuredShuffleParallelism,
                                      BaseCommitActionExecutor<T, I, K, O, R> executor,
                                      WriteOperationType operationType) {
    try {
```

### BoundedWildcard
Can generalize to `? extends HoodieRecord`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/io/HoodieMergeHandle.java`
#### Snippet
```java
  }

  private boolean writeRecord(HoodieRecord<T> newRecord, Option<HoodieRecord> combineRecord, Schema schema, Properties prop, boolean isDelete) throws IOException {
    Option recordMetadata = newRecord.getMetadata();
    if (!partitionPath.equals(newRecord.getPartitionPath())) {
```

### BoundedWildcard
Can generalize to `? extends HoodieRecord`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/io/HoodieMergeHandle.java`
#### Snippet
```java
   * Load the new incoming records in a map and return partitionPath.
   */
  protected void init(String fileId, Iterator<HoodieRecord<T>> newRecordsItr) {
    initializeIncomingRecordsMap();
    while (newRecordsItr.hasNext()) {
```

### BoundedWildcard
Can generalize to `? extends Pair`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/clean/CleanActionExecutor.java`
#### Snippet
```java
  }

  private static Stream<Pair<String, PartitionCleanStat>> deleteFilesFunc(Iterator<Pair<String, CleanFileInfo>> cleanFileInfo, HoodieTable table) {
    Map<String, PartitionCleanStat> partitionCleanStatMap = new HashMap<>();
    FileSystem fs = table.getMetaClient().getFs();
```

### BoundedWildcard
Can generalize to `? extends HoodieRecord`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/io/HoodieCreateHandle.java`
#### Snippet
```java
   */
  public HoodieCreateHandle(HoodieWriteConfig config, String instantTime, HoodieTable<T, I, K, O> hoodieTable,
      String partitionPath, String fileId, Map<String, HoodieRecord<T>> recordMap,
      TaskContextSupplier taskContextSupplier) {
    this(config, instantTime, hoodieTable, partitionPath, fileId, taskContextSupplier, config.isPreserveHoodieCommitMetadataForCompaction());
```

### BoundedWildcard
Can generalize to `? extends List`>
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/HoodieTable.java`
#### Snippet
```java
   * @param visibility Appear/Disappear
   */
  private void waitForAllFiles(HoodieEngineContext context, Map<String, List<Pair<String, String>>> groupByPartition, FileVisibility visibility) {
    // This will either ensure all files to be deleted are present.
    context.setJobStatus(this.getClass().getSimpleName(), "Wait for all files to appear/disappear: " + config.getTableName());
```

### BoundedWildcard
Can generalize to `? super String`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/HoodieTable.java`
#### Snippet
```java
   */
  private void rollbackInflightInstant(HoodieInstant inflightInstant,
                                       Function<String, Option<HoodiePendingRollbackInfo>> getPendingRollbackInstantFunc) {
    final String commitTime = getPendingRollbackInstantFunc.apply(inflightInstant.getTimestamp()).map(entry
        -> entry.getRollbackInstant().getTimestamp()).orElse(HoodieActiveTimeline.createNewInstantTime());
```

### BoundedWildcard
Can generalize to `? extends Pair`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/HoodieTable.java`
#### Snippet
```java
  }

  private boolean waitForCondition(String partitionPath, Stream<Pair<String, String>> partitionFilePaths, FileVisibility visibility) {
    final FileSystem fileSystem = metaClient.getRawFs();
    List<String> fileList = partitionFilePaths.map(Pair::getValue).collect(Collectors.toList());
```

### BoundedWildcard
Can generalize to `? super String`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/HoodieTable.java`
#### Snippet
```java
   * @param inflightInstant Inflight Compaction Instant
   */
  public void rollbackInflightLogCompaction(HoodieInstant inflightInstant, Function<String, Option<HoodiePendingRollbackInfo>> getPendingRollbackInstantFunc) {
    final String commitTime = getPendingRollbackInstantFunc.apply(inflightInstant.getTimestamp()).map(entry
        -> entry.getRollbackInstant().getTimestamp()).orElse(HoodieActiveTimeline.createNewInstantTime());
```

### BoundedWildcard
Can generalize to `? extends HoodieWriteStat`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/HoodieTable.java`
#### Snippet
```java
  protected void reconcileAgainstMarkers(HoodieEngineContext context,
                                         String instantTs,
                                         List<HoodieWriteStat> stats,
                                         boolean consistencyCheckEnabled) throws HoodieIOException {
    try {
```

### BoundedWildcard
Can generalize to `? extends List`>
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/HoodieTable.java`
#### Snippet
```java
  }

  private void deleteInvalidFilesByPartitions(HoodieEngineContext context, Map<String, List<Pair<String, String>>> invalidFilesByPartition) {
    // Now delete partially written files
    context.setJobStatus(this.getClass().getSimpleName(), "Delete invalid files generated during the write operation: " + config.getTableName());
```

### BoundedWildcard
Can generalize to `? extends FileSlice`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/clean/CleanPlanner.java`
#### Snippet
```java
   * Gets the latest version < instantTime. This version file could still be used by queries.
   */
  private String getLatestVersionBeforeCommit(List<FileSlice> fileSliceList, HoodieInstant instantTime) {
    for (FileSlice file : fileSliceList) {
      String fileCommitTime = file.getBaseInstantTime();
```

### BoundedWildcard
Can generalize to `? extends HoodieInstant`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/clean/CleanPlanner.java`
#### Snippet
```java
  }

  private List<CleanFileInfo> getReplacedFilesEligibleToClean(List<String> savepointedFiles, String partitionPath, Option<HoodieInstant> earliestCommitToRetain) {
    final Stream<HoodieFileGroup> replacedGroups;
    if (earliestCommitToRetain.isPresent()) {
```

### BoundedWildcard
Can generalize to `? extends HoodieBaseFile`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/compact/CompactionExecutionHelper.java`
#### Snippet
```java
                                                                  String instantTime,
                                                                  HoodieMergedLogRecordScanner scanner,
                                                                  Option<HoodieBaseFile> oldDataFileOpt) throws IOException {
    Iterator<List<WriteStatus>> result;
    // If the dataFile is present, perform updates else perform inserts into a new base file.
```

### BoundedWildcard
Can generalize to `? super HoodieData`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/commit/BaseCommitActionExecutor.java`
#### Snippet
```java
  }

  private HoodieData<WriteStatus> updateIndex(HoodieData<WriteStatus> writeStatuses, HoodieWriteMetadata<HoodieData<WriteStatus>> result) {
    Instant indexStartTime = Instant.now();
    // Update the index back
```

### BoundedWildcard
Can generalize to `? super HoodieData`>
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/commit/HoodieDeleteHelper.java`
#### Snippet
```java
                                                              HoodieWriteConfig config,
                                                              HoodieTable<T, HoodieData<HoodieRecord<T>>, HoodieData<HoodieKey>, HoodieData<WriteStatus>> table,
                                                              BaseCommitActionExecutor<T, HoodieData<HoodieRecord<T>>, HoodieData<HoodieKey>, HoodieData<WriteStatus>, R> deleteExecutor) {
    try {
      int targetParallelism =
```

### BoundedWildcard
Can generalize to `? extends HoodieKey`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/commit/HoodieDeleteHelper.java`
#### Snippet
```java
  }

  private static HoodieData createPhonyRecords(HoodieWriteConfig config, HoodieData<HoodieKey> keys) {
    HoodieRecordType recordType = config.getRecordMerger().getRecordType();
    if (recordType == HoodieRecordType.AVRO) {
```

### BoundedWildcard
Can generalize to `? extends HoodieCommitMetadata`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/rollback/ListingBasedRollbackStrategy.java`
#### Snippet
```java
  private FileStatus[] fetchFilesFromInstant(HoodieInstant instantToRollback, String partitionPath, String basePath,
                                             String baseFileExtension, HoodieWrapperFileSystem fs,
                                             Option<HoodieCommitMetadata> commitMetadataOptional,
                                             Boolean isCommitMetadataCompleted) throws IOException {
    if (isCommitMetadataCompleted) {
```

### BoundedWildcard
Can generalize to `? extends HoodieCommitMetadata`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/rollback/ListingBasedRollbackStrategy.java`
#### Snippet
```java

  private Boolean checkCommitMetadataCompleted(HoodieInstant instantToRollback,
                                               Option<HoodieCommitMetadata> commitMetadataOptional) {
    return commitMetadataOptional.isPresent() && instantToRollback.isCompleted()
        && !WriteOperationType.UNKNOWN.equals(commitMetadataOptional.get().getOperationType());
```

### BoundedWildcard
Can generalize to `? extends Path`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/repair/RepairUtils.java`
#### Snippet
```java
   */
  public static Map<String, List<String>> tagInstantsOfBaseAndLogFiles(
      String basePath, List<Path> allPaths) {
    // Instant time -> Set of base and log file paths
    Map<String, List<String>> instantToFilesMap = new HashMap<>();
```

### BoundedWildcard
Can generalize to `? extends Map`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/WriteStatus.java`
#### Snippet
```java
   * @param optionalRecordMetadata optional metadata related to data contained in {@link HoodieRecord} before deflation.
   */
  public void markSuccess(HoodieRecord record, Option<Map<String, String>> optionalRecordMetadata) {
    if (trackSuccessRecords) {
      writtenRecords.add(record);
```

### BoundedWildcard
Can generalize to `? extends HoodieInstant`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/utils/TransactionUtils.java`
#### Snippet
```java
  public static Option<HoodieCommitMetadata> resolveWriteConflictIfAny(
      final HoodieTable table,
      final Option<HoodieInstant> currentTxnOwnerInstant,
      final Option<HoodieCommitMetadata> thisCommitMetadata,
      final HoodieWriteConfig config,
```

### BoundedWildcard
Can generalize to `? extends FileSlice`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/utils/FileSliceMetricUtils.java`
#### Snippet
```java
  public static final String TOTAL_LOG_FILES = "TOTAL_LOG_FILES";

  public static void addFileSliceCommonMetrics(List<FileSlice> fileSlices, Map<String, Double> metrics, long defaultBaseFileSize) {
    int numLogFiles = 0;
    long totalLogFileSize = 0;
```

### BoundedWildcard
Can generalize to `? super String`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/utils/FileSliceMetricUtils.java`
#### Snippet
```java
  public static final String TOTAL_LOG_FILES = "TOTAL_LOG_FILES";

  public static void addFileSliceCommonMetrics(List<FileSlice> fileSlices, Map<String, Double> metrics, long defaultBaseFileSize) {
    int numLogFiles = 0;
    long totalLogFileSize = 0;
```

### BoundedWildcard
Can generalize to `? super Double`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/utils/FileSliceMetricUtils.java`
#### Snippet
```java
  public static final String TOTAL_LOG_FILES = "TOTAL_LOG_FILES";

  public static void addFileSliceCommonMetrics(List<FileSlice> fileSlices, Map<String, Double> metrics, long defaultBaseFileSize) {
    int numLogFiles = 0;
    long totalLogFileSize = 0;
```

### BoundedWildcard
Can generalize to `? extends T`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/utils/MergingIterator.java`
#### Snippet
```java
  private final BiFunction<T, T, T> mergeFunction;

  public MergingIterator(Iterator<T> leftIterator, Iterator<T> rightIterator, BiFunction<T, T, T> mergeFunction) {
    this.leftIterator = leftIterator;
    this.rightIterator = rightIterator;
```

### BoundedWildcard
Can generalize to `? extends T`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/utils/MergingIterator.java`
#### Snippet
```java
  private final BiFunction<T, T, T> mergeFunction;

  public MergingIterator(Iterator<T> leftIterator, Iterator<T> rightIterator, BiFunction<T, T, T> mergeFunction) {
    this.leftIterator = leftIterator;
    this.rightIterator = rightIterator;
```

### BoundedWildcard
Can generalize to `? super T`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/utils/MergingIterator.java`
#### Snippet
```java
  private final BiFunction<T, T, T> mergeFunction;

  public MergingIterator(Iterator<T> leftIterator, Iterator<T> rightIterator, BiFunction<T, T, T> mergeFunction) {
    this.leftIterator = leftIterator;
    this.rightIterator = rightIterator;
```

### BoundedWildcard
Can generalize to `? super T`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/utils/MergingIterator.java`
#### Snippet
```java
  private final BiFunction<T, T, T> mergeFunction;

  public MergingIterator(Iterator<T> leftIterator, Iterator<T> rightIterator, BiFunction<T, T, T> mergeFunction) {
    this.leftIterator = leftIterator;
    this.rightIterator = rightIterator;
```

### BoundedWildcard
Can generalize to `? extends T`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/utils/MergingIterator.java`
#### Snippet
```java
  private final BiFunction<T, T, T> mergeFunction;

  public MergingIterator(Iterator<T> leftIterator, Iterator<T> rightIterator, BiFunction<T, T, T> mergeFunction) {
    this.leftIterator = leftIterator;
    this.rightIterator = rightIterator;
```

### BoundedWildcard
Can generalize to `? extends Pair`>
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/bootstrap/selector/BootstrapRegexModeSelector.java`
#### Snippet
```java

  @Override
  public Map<BootstrapMode, List<String>> select(List<Pair<String, List<HoodieFileStatus>>> partitions) {
    return partitions.stream()
        .map(p -> Pair.of(pattern.matcher(p.getKey()).matches() ? bootstrapModeOnMatch : defaultMode, p.getKey()))
```

### BoundedWildcard
Can generalize to `? extends HoodieInstant`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/transaction/SimpleConcurrentFileWritesConflictResolutionStrategy.java`
#### Snippet
```java
  @Override
  public Stream<HoodieInstant> getCandidateInstants(HoodieActiveTimeline activeTimeline, HoodieInstant currentInstant,
                                                 Option<HoodieInstant> lastSuccessfulInstant) {

    // To find which instants are conflicting, we apply the following logic
```

### BoundedWildcard
Can generalize to `? extends Pair`>
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/bootstrap/selector/UniformBootstrapModeSelector.java`
#### Snippet
```java

  @Override
  public Map<BootstrapMode, List<String>> select(List<Pair<String, List<HoodieFileStatus>>> partitions) {
    return partitions.stream().map(p -> Pair.of(bootstrapMode, p))
        .collect(Collectors.groupingBy(Pair::getKey, Collectors.mapping(x -> x.getValue().getKey(),
```

### BoundedWildcard
Can generalize to `? extends HoodieFileReader`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/common/table/log/HoodieFileSliceReader.java`
#### Snippet
```java

  public static HoodieFileSliceReader getFileSliceReader(
      Option<HoodieFileReader> baseFileReader, HoodieMergedLogRecordScanner scanner, Schema schema, Properties props, Option<Pair<String, String>> simpleKeyGenFieldsOpt) throws IOException {
    if (baseFileReader.isPresent()) {
      Iterator<HoodieRecord> baseIterator = baseFileReader.get().getRecordIterator(schema);
```

### BoundedWildcard
Can generalize to `? extends HoodieRecord`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/common/table/log/HoodieFileSliceReader.java`
#### Snippet
```java
  }

  private HoodieFileSliceReader(Iterator<HoodieRecord<T>> recordsItr) {
    this.recordsIterator = recordsItr;
  }
```

### BoundedWildcard
Can generalize to `? extends HoodieTableFileSystemView`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/CompactionAdminClient.java`
#### Snippet
```java
   */
  private ValidationOpResult validateCompactionOperation(HoodieTableMetaClient metaClient, String compactionInstant,
      CompactionOperation operation, Option<HoodieTableFileSystemView> fsViewOpt) throws IOException {
    HoodieTableFileSystemView fileSystemView = fsViewOpt.isPresent() ? fsViewOpt.get()
        : new HoodieTableFileSystemView(metaClient, metaClient.getCommitsAndCompactionTimeline());
```

### BoundedWildcard
Can generalize to `? extends HoodieLogFile`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/CompactionAdminClient.java`
#### Snippet
```java
    }

    public RenameOpResult(Pair<HoodieLogFile, HoodieLogFile> op, boolean executed, boolean success,
        Option<Exception> exception) {
      super(
```

### BoundedWildcard
Can generalize to `? extends HoodieLogFile`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/CompactionAdminClient.java`
#### Snippet
```java
    }

    public RenameOpResult(Pair<HoodieLogFile, HoodieLogFile> op, boolean executed, boolean success,
        Option<Exception> exception) {
      super(
```

### BoundedWildcard
Can generalize to `? extends Pair`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/CompactionAdminClient.java`
#### Snippet
```java
   */
  private List<RenameOpResult> runRenamingOps(HoodieTableMetaClient metaClient,
      List<Pair<HoodieLogFile, HoodieLogFile>> renameActions, int parallelism, boolean dryRun) {
    if (renameActions.isEmpty()) {
      LOG.info("No renaming of log-files needed. Proceeding to removing file-id from compaction-plan");
```

### BoundedWildcard
Can generalize to `? extends HoodieTableFileSystemView`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/CompactionAdminClient.java`
#### Snippet
```java
  protected static List<Pair<HoodieLogFile, HoodieLogFile>> getRenamingActionsToAlignWithCompactionOperation(
      HoodieTableMetaClient metaClient, String compactionInstant, CompactionOperation op,
      Option<HoodieTableFileSystemView> fsViewOpt) {
    HoodieTableFileSystemView fileSystemView = fsViewOpt.isPresent() ? fsViewOpt.get()
        : new HoodieTableFileSystemView(metaClient, metaClient.getCommitsAndCompactionTimeline());
```

### BoundedWildcard
Can generalize to `? extends HoodieLogFile`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/CompactionAdminClient.java`
#### Snippet
```java
    public RenameOpResult() {}

    public RenameOpResult(Pair<HoodieLogFile, HoodieLogFile> op, boolean success, Option<Exception> exception) {
      super(
          new RenameInfo(op.getKey().getFileId(), op.getKey().getPath().toString(), op.getRight().getPath().toString()),
```

### BoundedWildcard
Can generalize to `? extends HoodieLogFile`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/CompactionAdminClient.java`
#### Snippet
```java
    public RenameOpResult() {}

    public RenameOpResult(Pair<HoodieLogFile, HoodieLogFile> op, boolean success, Option<Exception> exception) {
      super(
          new RenameInfo(op.getKey().getFileId(), op.getKey().getPath().toString(), op.getRight().getPath().toString()),
```

### BoundedWildcard
Can generalize to `? extends HoodieTableFileSystemView`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/CompactionAdminClient.java`
#### Snippet
```java
  public List<Pair<HoodieLogFile, HoodieLogFile>> getRenamingActionsForUnschedulingCompactionOperation(
      HoodieTableMetaClient metaClient, String compactionInstant, CompactionOperation operation,
      Option<HoodieTableFileSystemView> fsViewOpt, boolean skipValidation) throws IOException {
    List<Pair<HoodieLogFile, HoodieLogFile>> result = new ArrayList<>();
    HoodieTableFileSystemView fileSystemView = fsViewOpt.isPresent() ? fsViewOpt.get()
```

### BoundedWildcard
Can generalize to `? extends BaseKeyGenerator`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/keygen/KeyGenUtils.java`
#### Snippet
```java
   * @return the record key for the passed in generic record.
   */
  public static String getRecordKeyFromGenericRecord(GenericRecord genericRecord, Option<BaseKeyGenerator> keyGeneratorOpt) {
    return keyGeneratorOpt.isPresent() ? keyGeneratorOpt.get().getRecordKey(genericRecord) : genericRecord.get(HoodieRecord.RECORD_KEY_METADATA_FIELD).toString();
  }
```

### BoundedWildcard
Can generalize to `? extends BaseKeyGenerator`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/keygen/KeyGenUtils.java`
#### Snippet
```java
   * @return the partition path for the passed in generic record.
   */
  public static String getPartitionPathFromGenericRecord(GenericRecord genericRecord, Option<BaseKeyGenerator> keyGeneratorOpt) {
    return keyGeneratorOpt.isPresent() ? keyGeneratorOpt.get().getPartitionPath(genericRecord) : genericRecord.get(HoodieRecord.PARTITION_PATH_METADATA_FIELD).toString();
  }
```

### BoundedWildcard
Can generalize to `? extends IndexedRecord`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/HoodieTimelineArchiver.java`
#### Snippet
```java
  }

  private void writeToFile(Schema wrapperSchema, List<IndexedRecord> records) throws Exception {
    if (records.size() > 0) {
      Map<HeaderMetadataType, String> header = new HashMap<>();
```

### BoundedWildcard
Can generalize to `? extends Path`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/HoodieTimelineArchiver.java`
#### Snippet
```java
   * If at least one of candidate small archive files existed, the merged archive file was created and last operation was failed during deleting the small archive files.
   */
  private boolean candidateAllExists(List<Path> candidates) throws IOException {
    for (Path archiveFile : candidates) {
      if (!metaClient.getFs().exists(archiveFile)) {
```

### BoundedWildcard
Can generalize to `? extends List`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metrics/datadog/DatadogReporter.java`
#### Snippet
```java
      String prefix,
      Option<String> host,
      Option<List<String>> tags,
      MetricFilter filter,
      TimeUnit rateUnit,
```

### BoundedWildcard
Can generalize to `? extends Schema`
in `hudi-common/src/main/java/org/apache/hudi/io/storage/HoodieAvroParquetReader.java`
#### Snippet
```java
  }

  private ClosableIterator<IndexedRecord> getIndexedRecordIteratorInternal(Schema schema, Option<Schema> requestedSchema) throws IOException {
    // NOTE: We have to set both Avro read-schema and projection schema to make
    //       sure that in case the file-schema is not equal to read-schema we'd still
```

### BoundedWildcard
Can generalize to `? super Schema`
in `hudi-common/src/main/java/org/apache/hudi/avro/AvroSchemaUtils.java`
#### Snippet
```java
  private static boolean isProjectionOfInternal(Schema sourceSchema,
                                                Schema targetSchema,
                                                BiFunction<Schema, Schema, Boolean> atomicTypeEqualityPredicate) {
    if (sourceSchema.getType() == targetSchema.getType()) {
      if (sourceSchema.getType() == Schema.Type.RECORD) {
```

### BoundedWildcard
Can generalize to `? super Schema`
in `hudi-common/src/main/java/org/apache/hudi/avro/AvroSchemaUtils.java`
#### Snippet
```java
  private static boolean isProjectionOfInternal(Schema sourceSchema,
                                                Schema targetSchema,
                                                BiFunction<Schema, Schema, Boolean> atomicTypeEqualityPredicate) {
    if (sourceSchema.getType() == targetSchema.getType()) {
      if (sourceSchema.getType() == Schema.Type.RECORD) {
```

### BoundedWildcard
Can generalize to `? extends Schema.Field`
in `hudi-common/src/main/java/org/apache/hudi/avro/AvroSchemaUtils.java`
#### Snippet
```java
   *       of the source schema as is
   */
  public static Schema appendFieldsToSchema(Schema schema, List<Schema.Field> newFields) {
    List<Schema.Field> fields = schema.getFields().stream()
        .map(field -> new Schema.Field(field.name(), field.schema(), field.doc(), field.defaultVal()))
```

### BoundedWildcard
Can generalize to `? extends T`
in `hudi-common/src/main/java/org/apache/hudi/util/Lazy.java`
#### Snippet
```java
  private T ref;

  private Lazy(Supplier<T> initializer) {
    this.initializer = initializer;
    this.ref = null;
```

### BoundedWildcard
Can generalize to `? super T`
in `hudi-common/src/main/java/org/apache/hudi/util/Transient.java`
#### Snippet
```java
  }

  public void destroy(ThrowingConsumer<T> cleaner) throws Exception {
    synchronized (this) {
      if (initialized) {
```

### BoundedWildcard
Can generalize to `? extends T`
in `hudi-common/src/main/java/org/apache/hudi/util/Transient.java`
#### Snippet
```java
  }

  private Transient(T value, SerializableSupplier<T> initializer) {
    checkArgument(value != null);
    checkArgument(initializer != null);
```

### BoundedWildcard
Can generalize to `? extends T`
in `hudi-common/src/main/java/org/apache/hudi/util/Transient.java`
#### Snippet
```java
  private transient T ref;

  private Transient(SerializableSupplier<T> initializer) {
    checkArgument(initializer != null);

```

### BoundedWildcard
Can generalize to `? extends FileStatus`
in `hudi-common/src/main/java/org/apache/hudi/common/HoodieRollbackStat.java`
#### Snippet
```java
    private String partitionPath;

    public Builder withDeletedFileResults(Map<FileStatus, Boolean> deletedFiles) {
      // noinspection Convert2MethodRef
      successDeleteFiles = deletedFiles.entrySet().stream().filter(s -> s.getValue())
```

### BoundedWildcard
Can generalize to `? extends HoodieInstant`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metadata/HoodieBackedTableMetadataWriter.java`
#### Snippet
```java
   * @return True if the initialize is not needed, False otherwise
   */
  private <T extends SpecificRecordBase> boolean isBootstrapNeeded(Option<HoodieInstant> latestMetadataInstant,
                                                                   Option<T> actionMetadata) {
    if (!latestMetadataInstant.isPresent()) {
```

### BoundedWildcard
Can generalize to `? extends DirectoryInfo`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metadata/HoodieBackedTableMetadataWriter.java`
#### Snippet
```java
  }

  private HoodieData<HoodieRecord> getFilesPartitionRecords(String createInstantTime, List<DirectoryInfo> partitionInfoList, HoodieRecord allPartitionRecord) {
    HoodieData<HoodieRecord> filesPartitionRecords = engineContext.parallelize(Arrays.asList(allPartitionRecord), 1);
    if (partitionInfoList.isEmpty()) {
```

### BoundedWildcard
Can generalize to `? super T`
in `hudi-common/src/main/java/org/apache/hudi/common/data/HoodieData.java`
#### Snippet
```java
  HoodieData<T> repartition(int parallelism);

  default <O> HoodieData<T> distinctWithKey(SerializableFunction<T, O> keyGetter, int parallelism) {
    return mapToPair(i -> Pair.of(keyGetter.apply(i), i))
        .reduceByKey((value1, value2) -> value1, parallelism)
```

### BoundedWildcard
Can generalize to `? extends HoodieInstant`
in `hudi-common/src/main/java/org/apache/hudi/common/HoodieCleanStat.java`
#### Snippet
```java
    }

    public Builder withEarliestCommitRetained(Option<HoodieInstant> earliestCommitToRetain) {
      this.earliestCommitToRetain =
          (earliestCommitToRetain.isPresent()) ? earliestCommitToRetain.get().getTimestamp() : "";
```

### BoundedWildcard
Can generalize to `? super T`
in `hudi-common/src/main/java/org/apache/hudi/common/data/HoodieListData.java`
#### Snippet
```java

  @Override
  public <O> HoodieData<T> distinctWithKey(SerializableFunction<T, O> keyGetter, int parallelism) {
    return mapToPair(i -> Pair.of(keyGetter.apply(i), i))
        .reduceByKey((value1, value2) -> value1, parallelism)
```

### BoundedWildcard
Can generalize to `? super T`
in `hudi-common/src/main/java/org/apache/hudi/common/data/HoodieListData.java`
#### Snippet
```java

  @Override
  public HoodieData<T> filter(SerializableFunction<T, Boolean> filterFunc) {
    return new HoodieListData<>(asStream().filter(r -> throwingMapWrapper(filterFunc).apply(r)), lazy);
  }
```

### BoundedWildcard
Can generalize to `? super T`
in `hudi-common/src/main/java/org/apache/hudi/common/data/HoodieListData.java`
#### Snippet
```java

  @Override
  public <O> HoodieData<O> map(SerializableFunction<T, O> func) {
    return new HoodieListData<>(asStream().map(throwingMapWrapper(func)), lazy);
  }
```

### BoundedWildcard
Can generalize to `? extends O`
in `hudi-common/src/main/java/org/apache/hudi/common/data/HoodieListData.java`
#### Snippet
```java

  @Override
  public <O> HoodieData<O> map(SerializableFunction<T, O> func) {
    return new HoodieListData<>(asStream().map(throwingMapWrapper(func)), lazy);
  }
```

### BoundedWildcard
Can generalize to `? extends T`
in `hudi-common/src/main/java/org/apache/hudi/common/util/Option.java`
#### Snippet
```java
   * @return Option
   */
  public static <T> Option<T> fromJavaOptional(Optional<T> v) {
    return Option.ofNullable(v.orElse(null));
  }
```

### BoundedWildcard
Can generalize to `? extends BiConsumer`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/BaseHoodieWriteClient.java`
#### Snippet
```java
  public boolean commitStats(String instantTime, List<HoodieWriteStat> stats, Option<Map<String, String>> extraMetadata,
                             String commitActionType, Map<String, List<String>> partitionToReplaceFileIds,
                             Option<BiConsumer<HoodieTableMetaClient, HoodieCommitMetadata>> extraPreCommitFunc) {
    // Skip the empty commit if not allowed
    if (!config.allowEmptyCommit() && stats.isEmpty()) {
```

### BoundedWildcard
Can generalize to `? super Pair`
in `hudi-common/src/main/java/org/apache/hudi/common/fs/FSUtils.java`
#### Snippet
```java
      FileSystem fs,
      int parallelism,
      SerializableFunction<Pair<String, SerializableConfiguration>, T> pairFunction,
      List<String> subPaths) {
    Map<String, T> result = new HashMap<>();
```

### BoundedWildcard
Can generalize to `? extends T`
in `hudi-common/src/main/java/org/apache/hudi/common/fs/FSUtils.java`
#### Snippet
```java
      FileSystem fs,
      int parallelism,
      SerializableFunction<Pair<String, SerializableConfiguration>, T> pairFunction,
      List<String> subPaths) {
    Map<String, T> result = new HashMap<>();
```

### BoundedWildcard
Can generalize to `? super FileStatus`
in `hudi-common/src/main/java/org/apache/hudi/common/fs/FSUtils.java`
#### Snippet
```java
  public static <T> Map<String, T> parallelizeSubPathProcess(
      HoodieEngineContext hoodieEngineContext, FileSystem fs, Path dirPath, int parallelism,
      Predicate<FileStatus> subPathPredicate, SerializableFunction<Pair<String, SerializableConfiguration>, T> pairFunction) {
    Map<String, T> result = new HashMap<>();
    try {
```

### BoundedWildcard
Can generalize to `? super FileStatus`
in `hudi-common/src/main/java/org/apache/hudi/common/fs/FSUtils.java`
#### Snippet
```java
   * @throws IOException -
   */
  public static void processFiles(FileSystem fs, String basePathStr, Function<FileStatus, Boolean> consumer,
                                  boolean excludeMetaFolder) throws IOException {
    PathFilter pathFilter = excludeMetaFolder ? getExcludeMetaPathFilter() : ALLOW_ALL_FILTER;
```

### BoundedWildcard
Can generalize to `? extends GenericRecord`
in `hudi-common/src/main/java/org/apache/hudi/avro/HoodieAvroUtils.java`
#### Snippet
```java
   * To better understand conversion rules please check {@link #rewriteRecord(GenericRecord, Schema)}
   */
  public static List<GenericRecord> rewriteRecords(List<GenericRecord> records, Schema newSchema) {
    return records.stream().map(r -> rewriteRecord(r, newSchema)).collect(Collectors.toList());
  }
```

### BoundedWildcard
Can generalize to `? extends Pair`
in `hudi-common/src/main/java/org/apache/hudi/avro/HoodieAvroUtils.java`
#### Snippet
```java
      String payloadClass,
      String preCombineField,
      Option<Pair<String, String>> simpleKeyGenFieldsOpt,
      Boolean withOperation,
      Option<String> partitionNameOp,
```

### BoundedWildcard
Can generalize to `? extends CompletableFuture`
in `hudi-common/src/main/java/org/apache/hudi/common/util/FutureUtils.java`
#### Snippet
```java
   * @return a new CompletableFuture which will completed when all of the given CompletableFutures complete.
   */
  public static <T> CompletableFuture<List<T>> allOf(@Nonnull List<CompletableFuture<T>> futures) {
    return CompletableFuture.allOf(futures.toArray(new CompletableFuture[0]))
        .thenApply(aVoid ->
```

### BoundedWildcard
Can generalize to `? extends EnumT`
in `hudi-common/src/main/java/org/apache/hudi/common/util/TypeUtils.java`
#### Snippet
```java
   */
  public static <EnumT extends Enum<EnumT>> Map<String, EnumT> getValueToEnumMap(
      @Nonnull Class<EnumT> klass,
      @Nonnull Function<EnumT, String> valueMapper
  ) {
```

### BoundedWildcard
Can generalize to `? super EnumT`
in `hudi-common/src/main/java/org/apache/hudi/common/util/TypeUtils.java`
#### Snippet
```java
  public static <EnumT extends Enum<EnumT>> Map<String, EnumT> getValueToEnumMap(
      @Nonnull Class<EnumT> klass,
      @Nonnull Function<EnumT, String> valueMapper
  ) {
    return Arrays.stream(klass.getEnumConstants())
```

### BoundedWildcard
Can generalize to `? extends TypeDescription`
in `hudi-common/src/main/java/org/apache/hudi/common/util/AvroOrcUtils.java`
#### Snippet
```java
  public static boolean addUnionValue(
      UnionColumnVector unionVector,
      List<TypeDescription> unionChildTypes,
      Schema avroSchema,
      Object value,
```

### BoundedWildcard
Can generalize to `? extends HoodieWriteStat`
in `hudi-common/src/main/java/org/apache/hudi/common/util/CommitUtils.java`
#### Snippet
```java
  }

  private static HoodieCommitMetadata buildMetadataFromStats(List<HoodieWriteStat> writeStats,
                                                             Map<String, List<String>> partitionToReplaceFileIds,
                                                             String commitActionType,
```

### BoundedWildcard
Can generalize to `? extends Map`
in `hudi-common/src/main/java/org/apache/hudi/common/util/CommitUtils.java`
#### Snippet
```java
  public static HoodieCommitMetadata buildMetadata(List<HoodieWriteStat> writeStats,
                                                   Map<String, List<String>> partitionToReplaceFileIds,
                                                   Option<Map<String, String>> extraMetadata,
                                                   WriteOperationType operationType,
                                                   String schemaToStoreInCommit,
```

### BoundedWildcard
Can generalize to `? extends FileSlice`
in `hudi-common/src/main/java/org/apache/hudi/common/util/ClusteringUtils.java`
#### Snippet
```java
  }

  private static Map<String, Double> buildMetrics(List<FileSlice> fileSlices) {
    int numLogFiles = 0;
    long totalLogFileSize = 0;
```

### BoundedWildcard
Can generalize to `? extends T`
in `hudi-common/src/main/java/org/apache/hudi/common/util/RetryHelper.java`
#### Snippet
```java
  }

  public T start(CheckedFunction<T, R> func) throws R {
    int retries = 0;
    T functionResult = null;
```

### BoundedWildcard
Can generalize to `? extends R`
in `hudi-common/src/main/java/org/apache/hudi/common/util/RetryHelper.java`
#### Snippet
```java
  }

  public T start(CheckedFunction<T, R> func) throws R {
    int retries = 0;
    T functionResult = null;
```

### BoundedWildcard
Can generalize to `? super I`
in `hudi-common/src/main/java/org/apache/hudi/common/util/queue/IteratorBasedQueueProducer.java`
#### Snippet
```java

  @Override
  public void produce(HoodieMessageQueue<I, ?> queue) throws Exception {
    LOG.info("starting to buffer records");
    while (inputIterator.hasNext()) {
```

### BoundedWildcard
Can generalize to `? extends I`
in `hudi-common/src/main/java/org/apache/hudi/common/util/queue/IteratorBasedQueueProducer.java`
#### Snippet
```java
  private final Iterator<I> inputIterator;

  public IteratorBasedQueueProducer(Iterator<I> inputIterator) {
    this.inputIterator = inputIterator;
  }
```

### BoundedWildcard
Can generalize to `? extends Path`
in `hudi-common/src/main/java/org/apache/hudi/common/util/MarkerUtils.java`
#### Snippet
```java
   * @return
   */
  public static List<String> getCandidateInstants(HoodieActiveTimeline activeTimeline, List<Path> instants, String currentInstantTime,
                                                  long maxAllowableHeartbeatIntervalInMs, FileSystem fs, String basePath) {

```

### BoundedWildcard
Can generalize to `? super HoodieMessageQueue`
in `hudi-common/src/main/java/org/apache/hudi/common/util/queue/FunctionBasedQueueProducer.java`
#### Snippet
```java
  private final Function<HoodieMessageQueue<I, ?>, Boolean> producerFunction;

  public FunctionBasedQueueProducer(Function<HoodieMessageQueue<I, ?>, Boolean> producerFunction) {
    this.producerFunction = producerFunction;
  }
```

### BoundedWildcard
Can generalize to `? extends I`
in `hudi-common/src/main/java/org/apache/hudi/common/util/queue/SimpleExecutor.java`
#### Snippet
```java
  private final Function<I, O> transformFunction;

  public SimpleExecutor(Iterator<I> inputItr,
                        HoodieConsumer<O, E> consumer,
                        Function<I, O> transformFunction) {
```

### BoundedWildcard
Can generalize to `? super O`
in `hudi-common/src/main/java/org/apache/hudi/common/util/queue/SimpleExecutor.java`
#### Snippet
```java

  public SimpleExecutor(Iterator<I> inputItr,
                        HoodieConsumer<O, E> consumer,
                        Function<I, O> transformFunction) {
    this.itr = inputItr;
```

### BoundedWildcard
Can generalize to `? extends E`
in `hudi-common/src/main/java/org/apache/hudi/common/util/queue/SimpleExecutor.java`
#### Snippet
```java

  public SimpleExecutor(Iterator<I> inputItr,
                        HoodieConsumer<O, E> consumer,
                        Function<I, O> transformFunction) {
    this.itr = inputItr;
```

### BoundedWildcard
Can generalize to `? super I`
in `hudi-common/src/main/java/org/apache/hudi/common/util/queue/SimpleExecutor.java`
#### Snippet
```java
  public SimpleExecutor(Iterator<I> inputItr,
                        HoodieConsumer<O, E> consumer,
                        Function<I, O> transformFunction) {
    this.itr = inputItr;
    this.consumer = consumer;
```

### BoundedWildcard
Can generalize to `? extends O`
in `hudi-common/src/main/java/org/apache/hudi/common/util/queue/SimpleExecutor.java`
#### Snippet
```java
  public SimpleExecutor(Iterator<I> inputItr,
                        HoodieConsumer<O, E> consumer,
                        Function<I, O> transformFunction) {
    this.itr = inputItr;
    this.consumer = consumer;
```

### BoundedWildcard
Can generalize to `? extends HoodieProducer`
in `hudi-common/src/main/java/org/apache/hudi/common/util/queue/BaseHoodieQueueBasedExecutor.java`
#### Snippet
```java
  protected final Option<HoodieConsumer<O, E>> consumer;

  public BaseHoodieQueueBasedExecutor(List<HoodieProducer<I>> producers,
                                      Option<HoodieConsumer<O, E>> consumer,
                                      HoodieMessageQueue<I, O> queue,
```

### BoundedWildcard
Can generalize to `? super I`
in `hudi-common/src/main/java/org/apache/hudi/common/util/queue/BoundedInMemoryQueue.java`
#### Snippet
```java
   * @param payloadSizeEstimator Payload Size Estimator
   */
  public BoundedInMemoryQueue(final long memoryLimit, final Function<I, O> transformFunction,
                              final SizeEstimator<O> payloadSizeEstimator) {
    this.memoryLimit = memoryLimit;
```

### BoundedWildcard
Can generalize to `? extends O`
in `hudi-common/src/main/java/org/apache/hudi/common/util/queue/BoundedInMemoryQueue.java`
#### Snippet
```java
   * @param payloadSizeEstimator Payload Size Estimator
   */
  public BoundedInMemoryQueue(final long memoryLimit, final Function<I, O> transformFunction,
                              final SizeEstimator<O> payloadSizeEstimator) {
    this.memoryLimit = memoryLimit;
```

### BoundedWildcard
Can generalize to `? super O`
in `hudi-common/src/main/java/org/apache/hudi/common/util/queue/BoundedInMemoryQueue.java`
#### Snippet
```java
   */
  public BoundedInMemoryQueue(final long memoryLimit, final Function<I, O> transformFunction,
                              final SizeEstimator<O> payloadSizeEstimator) {
    this.memoryLimit = memoryLimit;
    this.transformFunction = transformFunction;
```

### BoundedWildcard
Can generalize to `? extends K`
in `hudi-common/src/main/java/org/apache/hudi/common/util/CollectionUtils.java`
#### Snippet
```java
   * Zip two lists into a Map. Will throw Exception if the size is different between these two lists.
   */
  public static <K, V> Map<K, V> zipToMap(List<K> keys, List<V> values) {
    checkArgument(keys.size() == values.size(),
        "keys' size must be equal with the values' size");
```

### BoundedWildcard
Can generalize to `? extends V`
in `hudi-common/src/main/java/org/apache/hudi/common/util/CollectionUtils.java`
#### Snippet
```java
   * Zip two lists into a Map. Will throw Exception if the size is different between these two lists.
   */
  public static <K, V> Map<K, V> zipToMap(List<K> keys, List<V> values) {
    checkArgument(keys.size() == values.size(),
        "keys' size must be equal with the values' size");
```

### BoundedWildcard
Can generalize to `? extends T`
in `hudi-common/src/main/java/org/apache/hudi/common/util/CollectionUtils.java`
#### Snippet
```java
  }

  public static <T> List<T> createImmutableList(final List<T> list) {
    return Collections.unmodifiableList(list);
  }
```

### BoundedWildcard
Can generalize to `? extends E`
in `hudi-common/src/main/java/org/apache/hudi/common/util/CollectionUtils.java`
#### Snippet
```java
   *       as a holding collection to support duplicate elements use-cases
   */
  public static <E> List<E> diff(Collection<E> one, Collection<E> another) {
    List<E> diff = new ArrayList<>(one);
    diff.removeAll(another);
```

### BoundedWildcard
Can generalize to `? extends T`
in `hudi-common/src/main/java/org/apache/hudi/common/util/CollectionUtils.java`
#### Snippet
```java
   * Collects provided {@link Iterator} to a {@link Stream}
   */
  public static <T> Stream<T> toStream(Iterator<T> iterator) {
    return StreamSupport.stream(
        Spliterators.spliteratorUnknownSize(iterator, Spliterator.ORDERED),
```

### BoundedWildcard
Can generalize to `? extends K`
in `hudi-common/src/main/java/org/apache/hudi/common/util/CollectionUtils.java`
#### Snippet
```java
   *       values from the first one
   */
  public static <K, V> HashMap<K, V> combine(Map<K, V> one, Map<K, V> another, BiFunction<V, V, V> merge) {
    HashMap<K, V> combined = new HashMap<>(one.size() + another.size());
    combined.putAll(one);
```

### BoundedWildcard
Can generalize to `? extends V`
in `hudi-common/src/main/java/org/apache/hudi/common/util/CollectionUtils.java`
#### Snippet
```java
   *       values from the first one
   */
  public static <K, V> HashMap<K, V> combine(Map<K, V> one, Map<K, V> another, BiFunction<V, V, V> merge) {
    HashMap<K, V> combined = new HashMap<>(one.size() + another.size());
    combined.putAll(one);
```

### BoundedWildcard
Can generalize to `? extends K`
in `hudi-common/src/main/java/org/apache/hudi/common/util/CollectionUtils.java`
#### Snippet
```java
   *       values from the first one
   */
  public static <K, V> HashMap<K, V> combine(Map<K, V> one, Map<K, V> another, BiFunction<V, V, V> merge) {
    HashMap<K, V> combined = new HashMap<>(one.size() + another.size());
    combined.putAll(one);
```

### BoundedWildcard
Can generalize to `? extends V`
in `hudi-common/src/main/java/org/apache/hudi/common/util/CollectionUtils.java`
#### Snippet
```java
   *       values from the first one
   */
  public static <K, V> HashMap<K, V> combine(Map<K, V> one, Map<K, V> another, BiFunction<V, V, V> merge) {
    HashMap<K, V> combined = new HashMap<>(one.size() + another.size());
    combined.putAll(one);
```

### BoundedWildcard
Can generalize to `? super V`
in `hudi-common/src/main/java/org/apache/hudi/common/util/CollectionUtils.java`
#### Snippet
```java
   *       values from the first one
   */
  public static <K, V> HashMap<K, V> combine(Map<K, V> one, Map<K, V> another, BiFunction<V, V, V> merge) {
    HashMap<K, V> combined = new HashMap<>(one.size() + another.size());
    combined.putAll(one);
```

### BoundedWildcard
Can generalize to `? super V`
in `hudi-common/src/main/java/org/apache/hudi/common/util/CollectionUtils.java`
#### Snippet
```java
   *       values from the first one
   */
  public static <K, V> HashMap<K, V> combine(Map<K, V> one, Map<K, V> another, BiFunction<V, V, V> merge) {
    HashMap<K, V> combined = new HashMap<>(one.size() + another.size());
    combined.putAll(one);
```

### BoundedWildcard
Can generalize to `? extends V`
in `hudi-common/src/main/java/org/apache/hudi/common/util/CollectionUtils.java`
#### Snippet
```java
   *       values from the first one
   */
  public static <K, V> HashMap<K, V> combine(Map<K, V> one, Map<K, V> another, BiFunction<V, V, V> merge) {
    HashMap<K, V> combined = new HashMap<>(one.size() + another.size());
    combined.putAll(one);
```

### BoundedWildcard
Can generalize to `? extends E`
in `hudi-common/src/main/java/org/apache/hudi/common/util/CollectionUtils.java`
#### Snippet
```java
   * Combines provided {@link List}s into one, returning new instance of {@link ArrayList}
   */
  public static <E> List<E> combine(List<E> one, List<E> another) {
    ArrayList<E> combined = new ArrayList<>(one.size() + another.size());
    combined.addAll(one);
```

### BoundedWildcard
Can generalize to `? extends E`
in `hudi-common/src/main/java/org/apache/hudi/common/util/CollectionUtils.java`
#### Snippet
```java
   * Combines provided {@link List}s into one, returning new instance of {@link ArrayList}
   */
  public static <E> List<E> combine(List<E> one, List<E> another) {
    ArrayList<E> combined = new ArrayList<>(one.size() + another.size());
    combined.addAll(one);
```

### BoundedWildcard
Can generalize to `? extends T`
in `hudi-common/src/main/java/org/apache/hudi/common/util/CollectionUtils.java`
#### Snippet
```java
  }

  public static <T> Set<T> createImmutableSet(final Set<T> set) {
    return Collections.unmodifiableSet(set);
  }
```

### BoundedWildcard
Can generalize to `? extends E`
in `hudi-common/src/main/java/org/apache/hudi/common/util/CollectionUtils.java`
#### Snippet
```java
   * Returns difference b/w {@code one} {@link Set} of elements and {@code another}
   */
  public static <E> Set<E> diffSet(Set<E> one, Set<E> another) {
    Set<E> diff = new HashSet<>(one);
    diff.removeAll(another);
```

### BoundedWildcard
Can generalize to `? extends K`
in `hudi-common/src/main/java/org/apache/hudi/common/util/CollectionUtils.java`
#### Snippet
```java
   *       values from the first one
   */
  public static <K, V> HashMap<K, V> combine(Map<K, V> one, Map<K, V> another) {
    HashMap<K, V> combined = new HashMap<>(one.size() + another.size());
    combined.putAll(one);
```

### BoundedWildcard
Can generalize to `? extends V`
in `hudi-common/src/main/java/org/apache/hudi/common/util/CollectionUtils.java`
#### Snippet
```java
   *       values from the first one
   */
  public static <K, V> HashMap<K, V> combine(Map<K, V> one, Map<K, V> another) {
    HashMap<K, V> combined = new HashMap<>(one.size() + another.size());
    combined.putAll(one);
```

### BoundedWildcard
Can generalize to `? extends K`
in `hudi-common/src/main/java/org/apache/hudi/common/util/CollectionUtils.java`
#### Snippet
```java
   *       values from the first one
   */
  public static <K, V> HashMap<K, V> combine(Map<K, V> one, Map<K, V> another) {
    HashMap<K, V> combined = new HashMap<>(one.size() + another.size());
    combined.putAll(one);
```

### BoundedWildcard
Can generalize to `? extends V`
in `hudi-common/src/main/java/org/apache/hudi/common/util/CollectionUtils.java`
#### Snippet
```java
   *       values from the first one
   */
  public static <K, V> HashMap<K, V> combine(Map<K, V> one, Map<K, V> another) {
    HashMap<K, V> combined = new HashMap<>(one.size() + another.size());
    combined.putAll(one);
```

### BoundedWildcard
Can generalize to `? extends T`
in `hudi-common/src/main/java/org/apache/hudi/common/util/CollectionUtils.java`
#### Snippet
```java
   * @return result of the reduction of the collection using reducing operator
   */
  public static <T, U> U reduce(Collection<T> c, U identity, BiFunction<U, T, U> reducer) {
    return c.stream()
        .sequential()
```

### BoundedWildcard
Can generalize to `? super T`
in `hudi-common/src/main/java/org/apache/hudi/common/util/CollectionUtils.java`
#### Snippet
```java
   * @return result of the reduction of the collection using reducing operator
   */
  public static <T, U> U reduce(Collection<T> c, U identity, BiFunction<U, T, U> reducer) {
    return c.stream()
        .sequential()
```

### BoundedWildcard
Can generalize to `? extends K`
in `hudi-common/src/main/java/org/apache/hudi/common/util/CollectionUtils.java`
#### Snippet
```java
  }

  public static <K,V> Map<K,V> createImmutableMap(final Map<K,V> map) {
    return Collections.unmodifiableMap(map);
  }
```

### BoundedWildcard
Can generalize to `? extends V`
in `hudi-common/src/main/java/org/apache/hudi/common/util/CollectionUtils.java`
#### Snippet
```java
  }

  public static <K,V> Map<K,V> createImmutableMap(final Map<K,V> map) {
    return Collections.unmodifiableMap(map);
  }
```

### BoundedWildcard
Can generalize to `? super O`
in `hudi-common/src/main/java/org/apache/hudi/common/util/queue/DisruptorMessageQueue.java`
#### Snippet
```java
  }

  protected void setHandlers(HoodieConsumer<O, ?> consumer) {
    queue.handleEventsWith((event, sequence, endOfBatch) -> {
      try {
```

### BoundedWildcard
Can generalize to `? super I`
in `hudi-common/src/main/java/org/apache/hudi/common/util/queue/DisruptorMessageQueue.java`
#### Snippet
```java
  private static final long TIMEOUT_WAITING_SECS = 10L;

  public DisruptorMessageQueue(int bufferSize, Function<I, O> transformFunction, String waitStrategyId, int totalProducers, Runnable preExecuteRunnable) {
    WaitStrategy waitStrategy = WaitStrategyFactory.build(waitStrategyId);
    CustomizedThreadFactory threadFactory = new CustomizedThreadFactory("disruptor", true, preExecuteRunnable);
```

### BoundedWildcard
Can generalize to `? extends O`
in `hudi-common/src/main/java/org/apache/hudi/common/util/queue/DisruptorMessageQueue.java`
#### Snippet
```java
  private static final long TIMEOUT_WAITING_SECS = 10L;

  public DisruptorMessageQueue(int bufferSize, Function<I, O> transformFunction, String waitStrategyId, int totalProducers, Runnable preExecuteRunnable) {
    WaitStrategy waitStrategy = WaitStrategyFactory.build(waitStrategyId);
    CustomizedThreadFactory threadFactory = new CustomizedThreadFactory("disruptor", true, preExecuteRunnable);
```

### BoundedWildcard
Can generalize to `? extends E`
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/ClosableIterator.java`
#### Snippet
```java
  void close(); // override to not throw exception

  static <E> ClosableIterator<E> wrap(Iterator<E> iterator) {
    return new ClosableIterator<E>() {
      @Override
```

### BoundedWildcard
Can generalize to `? extends GenericRecord`
in `hudi-common/src/main/java/org/apache/hudi/common/util/ParquetUtils.java`
#### Snippet
```java
    }

    private HoodieKeyIterator(ClosableIterator<GenericRecord> nestedItr, Option<BaseKeyGenerator> keyGenerator) {
      this.nestedItr = nestedItr;
      if (keyGenerator.isPresent()) {
```

### BoundedWildcard
Can generalize to `? extends T`
in `hudi-common/src/main/java/org/apache/hudi/common/util/ParquetUtils.java`
#### Snippet
```java

  private <T extends Comparable<T>> HoodieColumnRangeMetadata<T> combineRanges(
      HoodieColumnRangeMetadata<T> one,
      HoodieColumnRangeMetadata<T> another
  ) {
```

### BoundedWildcard
Can generalize to `? extends T`
in `hudi-common/src/main/java/org/apache/hudi/common/util/ParquetUtils.java`
#### Snippet
```java
  private <T extends Comparable<T>> HoodieColumnRangeMetadata<T> combineRanges(
      HoodieColumnRangeMetadata<T> one,
      HoodieColumnRangeMetadata<T> another
  ) {
    final T minValue;
```

### BoundedWildcard
Can generalize to `? extends I`
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/FlatteningIterator.java`
#### Snippet
```java
  private Iterator<T> innerSourceIterator;

  public FlatteningIterator(Iterator<I> source) {
    this.sourceIterator = source;
  }
```

### BoundedWildcard
Can generalize to `? super V`
in `hudi-common/src/main/java/org/apache/hudi/common/data/HoodieListPairData.java`
#### Snippet
```java

  @Override
  public HoodiePairData<K, V> reduceByKey(SerializableBiFunction<V, V, V> combiner, int parallelism) {
    Map<K, java.util.Optional<V>> reducedMap = asStream().collect(
        Collectors.groupingBy(
```

### BoundedWildcard
Can generalize to `? super V`
in `hudi-common/src/main/java/org/apache/hudi/common/data/HoodieListPairData.java`
#### Snippet
```java

  @Override
  public HoodiePairData<K, V> reduceByKey(SerializableBiFunction<V, V, V> combiner, int parallelism) {
    Map<K, java.util.Optional<V>> reducedMap = asStream().collect(
        Collectors.groupingBy(
```

### BoundedWildcard
Can generalize to `? extends V`
in `hudi-common/src/main/java/org/apache/hudi/common/data/HoodieListPairData.java`
#### Snippet
```java

  @Override
  public HoodiePairData<K, V> reduceByKey(SerializableBiFunction<V, V, V> combiner, int parallelism) {
    Map<K, java.util.Optional<V>> reducedMap = asStream().collect(
        Collectors.groupingBy(
```

### BoundedWildcard
Can generalize to `? extends K`
in `hudi-common/src/main/java/org/apache/hudi/common/data/HoodieListPairData.java`
#### Snippet
```java
  }

  private static <K, V> Stream<Pair<K, V>> explode(Map<K, List<V>> data) {
    return data.entrySet().stream()
        .flatMap(e -> e.getValue().stream().map(v -> Pair.of(e.getKey(), v)));
```

### BoundedWildcard
Can generalize to `? extends List`
in `hudi-common/src/main/java/org/apache/hudi/common/data/HoodieListPairData.java`
#### Snippet
```java
  }

  private static <K, V> Stream<Pair<K, V>> explode(Map<K, List<V>> data) {
    return data.entrySet().stream()
        .flatMap(e -> e.getValue().stream().map(v -> Pair.of(e.getKey(), v)));
```

### BoundedWildcard
Can generalize to `? super Pair`
in `hudi-common/src/main/java/org/apache/hudi/common/data/HoodieListPairData.java`
#### Snippet
```java

  @Override
  public <L, W> HoodiePairData<L, W> mapToPair(SerializablePairFunction<Pair<K, V>, L, W> mapToPairFunc) {
    return new HoodieListPairData<>(asStream().map(p -> throwingMapToPairWrapper(mapToPairFunc).apply(p)), lazy);
  }
```

### BoundedWildcard
Can generalize to `? super I`
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/MappingIterator.java`
#### Snippet
```java
  private final Function<I, O> mapper;

  public MappingIterator(Iterator<I> source, Function<I, O> mapper) {
    this.source = source;
    this.mapper = mapper;
```

### BoundedWildcard
Can generalize to `? extends O`
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/MappingIterator.java`
#### Snippet
```java
  private final Function<I, O> mapper;

  public MappingIterator(Iterator<I> source, Function<I, O> mapper) {
    this.source = source;
    this.mapper = mapper;
```

### BoundedWildcard
Can generalize to `? extends Key`
in `hudi-common/src/main/java/org/apache/hudi/common/bloom/InternalFilter.java`
#### Snippet
```java
   * @param keys The list of keys.
   */
  public void add(List<Key> keys) {
    if (keys == null) {
      throw new IllegalArgumentException("ArrayList<Key> may not be null");
```

### BoundedWildcard
Can generalize to `? extends Key`
in `hudi-common/src/main/java/org/apache/hudi/common/bloom/InternalFilter.java`
#### Snippet
```java
   * @param keys The collection of keys.
   */
  public void add(Collection<Key> keys) {
    if (keys == null) {
      throw new IllegalArgumentException("Collection<Key> may not be null");
```

### BoundedWildcard
Can generalize to `? super T`
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/ExternalSpillableMap.java`
#### Snippet
```java
  }

  public ExternalSpillableMap(Long maxInMemorySizeInBytes, String baseFilePath, SizeEstimator<T> keySizeEstimator,
                              SizeEstimator<R> valueSizeEstimator, DiskMapType diskMapType, boolean isCompressionEnabled) throws IOException {
    this.inMemoryMap = new HashMap<>();
```

### BoundedWildcard
Can generalize to `? super R`
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/ExternalSpillableMap.java`
#### Snippet
```java

  public ExternalSpillableMap(Long maxInMemorySizeInBytes, String baseFilePath, SizeEstimator<T> keySizeEstimator,
                              SizeEstimator<R> valueSizeEstimator, DiskMapType diskMapType, boolean isCompressionEnabled) throws IOException {
    this.inMemoryMap = new HashMap<>();
    this.baseFilePath = baseFilePath;
```

### BoundedWildcard
Can generalize to `? extends R`
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/ExternalSpillableMap.java`
#### Snippet
```java
    private final Iterator<R> diskLazyFileIterator;

    public IteratorWrapper(Iterator<R> inMemoryIterator, Iterator<R> diskLazyFileIterator) {
      this.inMemoryIterator = inMemoryIterator;
      this.diskLazyFileIterator = diskLazyFileIterator;
```

### BoundedWildcard
Can generalize to `? extends R`
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/ExternalSpillableMap.java`
#### Snippet
```java
    private final Iterator<R> diskLazyFileIterator;

    public IteratorWrapper(Iterator<R> inMemoryIterator, Iterator<R> diskLazyFileIterator) {
      this.inMemoryIterator = inMemoryIterator;
      this.diskLazyFileIterator = diskLazyFileIterator;
```

### BoundedWildcard
Can generalize to `? extends GenericRecord`
in `hudi-common/src/main/java/org/apache/hudi/common/model/OverwriteWithLatestAvroPayload.java`
#### Snippet
```java
  }

  public OverwriteWithLatestAvroPayload(Option<GenericRecord> record) {
    this(record.isPresent() ? record.get() : null, 0); // natural order
  }
```

### BoundedWildcard
Can generalize to `? extends T`
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/FlatLists.java`
#### Snippet
```java
    }

    static <T extends Comparable<T>> int compare(List<T> list0, List<T> list1, int size) {
      for (int i = 0; i < size; i++) {
        Comparable o0 = list0.get(i);
```

### BoundedWildcard
Can generalize to `? extends T`
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/FlatLists.java`
#### Snippet
```java
    }

    static <T extends Comparable<T>> int compare(List<T> list0, List<T> list1, int size) {
      for (int i = 0; i < size; i++) {
        Comparable o0 = list0.get(i);
```

### BoundedWildcard
Can generalize to `? extends GenericRecord`
in `hudi-common/src/main/java/org/apache/hudi/common/model/DefaultHoodieRecordPayload.java`
#### Snippet
```java
  }

  public DefaultHoodieRecordPayload(Option<GenericRecord> record) {
    this(record.isPresent() ? record.get() : null, 0); // natural order
  }
```

### BoundedWildcard
Can generalize to `? extends GenericRecord`
in `hudi-common/src/main/java/org/apache/hudi/common/model/EventTimeAvroPayload.java`
#### Snippet
```java
  }

  public EventTimeAvroPayload(Option<GenericRecord> record) {
    this(record.isPresent() ? record.get() : null, 0); // natural order
  }
```

### BoundedWildcard
Can generalize to `? extends GenericRecord`
in `hudi-common/src/main/java/org/apache/hudi/common/model/AWSDmsAvroPayload.java`
#### Snippet
```java
  }

  public AWSDmsAvroPayload(Option<GenericRecord> record) {
    this(record.isPresent() ? record.get() : null, 0); // natural order
  }
```

### BoundedWildcard
Can generalize to `? super O`
in `hudi-common/src/main/java/org/apache/hudi/common/util/queue/BoundedInMemoryExecutor.java`
#### Snippet
```java

  @Override
  protected void doConsume(HoodieMessageQueue<I, O> queue, HoodieConsumer<O, E> consumer) {
    LOG.info("Starting consumer, consuming records from the queue");
    try {
```

### BoundedWildcard
Can generalize to `? extends HoodieColumnRangeMetadata`
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieDeltaWriteStat.java`
#### Snippet
```java

  private static Map<String, HoodieColumnRangeMetadata<Comparable>> mergeRecordsStats(
      Map<String, HoodieColumnRangeMetadata<Comparable>> stats1,
      Map<String, HoodieColumnRangeMetadata<Comparable>> stats2) {
    Map<String, HoodieColumnRangeMetadata<Comparable>> mergedStats = new HashMap<>(stats1);
```

### BoundedWildcard
Can generalize to `? extends BaseKeyGenerator`
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieAvroIndexedRecord.java`
#### Snippet
```java
  @Override
  public HoodieRecord wrapIntoHoodieRecordPayloadWithKeyGen(Schema recordSchema,
      Properties props, Option<BaseKeyGenerator> keyGen) {
    GenericRecord record = (GenericRecord) data;
    String key;
```

### BoundedWildcard
Can generalize to `? extends BaseKeyGenerator`
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieAvroIndexedRecord.java`
#### Snippet
```java

  @Override
  public String getRecordKey(Schema recordSchema, Option<BaseKeyGenerator> keyGeneratorOpt) {
    return keyGeneratorOpt.isPresent() ? keyGeneratorOpt.get().getRecordKey((GenericRecord) data) : ((GenericRecord) data).get(HoodieRecord.RECORD_KEY_METADATA_FIELD).toString();
  }
```

### BoundedWildcard
Can generalize to `? extends HoodieBaseFile`
in `hudi-common/src/main/java/org/apache/hudi/common/model/CompactionOperation.java`
#### Snippet
```java
  }

  public CompactionOperation(Option<HoodieBaseFile> dataFile, String partitionPath, List<HoodieLogFile> logFiles,
      Map<String, Double> metrics) {
    if (dataFile.isPresent()) {
```

### BoundedWildcard
Can generalize to `? extends HoodieLogFile`
in `hudi-common/src/main/java/org/apache/hudi/common/model/CompactionOperation.java`
#### Snippet
```java
  }

  public CompactionOperation(Option<HoodieBaseFile> dataFile, String partitionPath, List<HoodieLogFile> logFiles,
      Map<String, Double> metrics) {
    if (dataFile.isPresent()) {
```

### BoundedWildcard
Can generalize to `? extends T`
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieRecord.java`
#### Snippet
```java
  }

  public HoodieRecord(HoodieRecord<T> record) {
    this(record.key, record.data, record.operation, record.metaData);
    this.currentLocation = record.currentLocation;
```

### BoundedWildcard
Can generalize to `? extends HoodieLogFile`
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/LogReaderUtils.java`
#### Snippet
```java
  }

  public static Schema readLatestSchemaFromLogFiles(String basePath, List<HoodieLogFile> logFiles, Configuration config)
      throws IOException {
    HoodieTableMetaClient metaClient = HoodieTableMetaClient.builder().setConf(config).setBasePath(basePath).build();
```

### BoundedWildcard
Can generalize to `? extends HoodieLogFile`
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/HoodieLogFormatReader.java`
#### Snippet
```java
  private static final Logger LOG = LogManager.getLogger(HoodieLogFormatReader.class);

  HoodieLogFormatReader(FileSystem fs, List<HoodieLogFile> logFiles, Schema readerSchema, boolean readBlocksLazily,
                        boolean reverseLogReader, int bufferSize, boolean enableRecordLookups,
                        String recordKeyField, InternalSchema internalSchema) throws IOException {
```

### BoundedWildcard
Can generalize to `? super Properties`
in `hudi-common/src/main/java/org/apache/hudi/common/table/HoodieTableConfig.java`
#### Snippet
```java
  }

  private static void modify(FileSystem fs, Path metadataFolder, Properties modifyProps, BiConsumer<Properties, Properties> modifyFn) {
    Path cfgPath = new Path(metadataFolder, HOODIE_PROPERTIES_FILE);
    Path backupCfgPath = new Path(metadataFolder, HOODIE_PROPERTIES_FILE_BACKUP);
```

### BoundedWildcard
Can generalize to `? super Properties`
in `hudi-common/src/main/java/org/apache/hudi/common/table/HoodieTableConfig.java`
#### Snippet
```java
  }

  private static void modify(FileSystem fs, Path metadataFolder, Properties modifyProps, BiConsumer<Properties, Properties> modifyFn) {
    Path cfgPath = new Path(metadataFolder, HOODIE_PROPERTIES_FILE);
    Path backupCfgPath = new Path(metadataFolder, HOODIE_PROPERTIES_FILE_BACKUP);
```

### BoundedWildcard
Can generalize to `? extends HoodieLogBlock`
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/HoodieLogFormatWriter.java`
#### Snippet
```java

  @Override
  public AppendResult appendBlocks(List<HoodieLogBlock> blocks) throws IOException, InterruptedException {
    // Find current version
    HoodieLogFormat.LogFormatVersion currentLogFormatVersion =
```

### BoundedWildcard
Can generalize to `? extends HoodieRecord`
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/block/HoodieParquetDataBlock.java`
#### Snippet
```java

  @Override
  protected byte[] serializeRecords(List<HoodieRecord> records) throws IOException {
    if (records.size() == 0) {
      return new byte[0];
```

### BoundedWildcard
Can generalize to `? extends HoodieRecord`
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/block/HoodieAvroDataBlock.java`
#### Snippet
```java

  @Override
  protected byte[] serializeRecords(List<HoodieRecord> records) throws IOException {
    Schema schema = new Schema.Parser().parse(super.getLogBlockHeader().get(HeaderMetadataType.SCHEMA));
    GenericDatumWriter<IndexedRecord> writer = new GenericDatumWriter<>(schema);
```

### BoundedWildcard
Can generalize to `? extends HoodieRecord`
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/block/HoodieDataBlock.java`
#### Snippet
```java
    private HoodieRecord<T> next;

    private FilteringIterator(ClosableIterator<HoodieRecord<T>> nested, Set<String> keys, boolean fullKey, Function<HoodieRecord<T>, Option<String>> keyExtract) {
      this.nested = nested;
      this.keys = keys;
```

### BoundedWildcard
Can generalize to `? super HoodieRecord`
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/block/HoodieDataBlock.java`
#### Snippet
```java
    private HoodieRecord<T> next;

    private FilteringIterator(ClosableIterator<HoodieRecord<T>> nested, Set<String> keys, boolean fullKey, Function<HoodieRecord<T>, Option<String>> keyExtract) {
      this.nested = nested;
      this.keys = keys;
```

### BoundedWildcard
Can generalize to `? extends InstantRange`
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/AbstractHoodieLogRecordReader.java`
#### Snippet
```java
  protected AbstractHoodieLogRecordReader(FileSystem fs, String basePath, List<String> logFilePaths,
                                          Schema readerSchema, String latestInstantTime, boolean readBlocksLazily,
                                          boolean reverseReader, int bufferSize, Option<InstantRange> instantRange,
                                          boolean withOperationField, boolean forceFullScan,
                                          Option<String> partitionNameOverride,
```

### BoundedWildcard
Can generalize to `? extends KeySpec`
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/AbstractHoodieLogRecordReader.java`
#### Snippet
```java

  private Pair<ClosableIterator<HoodieRecord>, Schema> getRecordsIterator(
      HoodieDataBlock dataBlock, Option<KeySpec> keySpecOpt) throws IOException {
    ClosableIterator<HoodieRecord> blockRecordsIterator;
    if (keySpecOpt.isPresent()) {
```

### BoundedWildcard
Can generalize to `? extends HoodieLogBlock`
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/AbstractHoodieLogRecordReader.java`
#### Snippet
```java
   * Process the set of log blocks belonging to the last instant which is read fully.
   */
  private void processQueuedBlocksForInstant(Deque<HoodieLogBlock> logBlocks, int numLogFilesSeen,
                                             Option<KeySpec> keySpecOpt) throws Exception {
    while (!logBlocks.isEmpty()) {
```

### BoundedWildcard
Can generalize to `? extends HoodieTableMetadata`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/FileSystemViewManager.java`
#### Snippet
```java
   */
  private static HoodieTableFileSystemView createInMemoryFileSystemView(HoodieMetadataConfig metadataConfig, FileSystemViewStorageConfig viewConf,
                                                                        HoodieTableMetaClient metaClient, SerializableSupplier<HoodieTableMetadata> metadataSupplier) {
    LOG.info("Creating InMemory based view for basePath " + metaClient.getBasePath());
    HoodieTimeline timeline = metaClient.getActiveTimeline().filterCompletedAndCompactionInstants();
```

### BoundedWildcard
Can generalize to `? super HoodieTableMetaClient`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/FileSystemViewManager.java`
#### Snippet
```java

  private FileSystemViewManager(HoodieEngineContext context, FileSystemViewStorageConfig viewStorageConfig,
      Function2<HoodieTableMetaClient, FileSystemViewStorageConfig, SyncableFileSystemView> viewCreator) {
    this.conf = context.getHadoopConf();
    this.viewStorageConfig = viewStorageConfig;
```

### BoundedWildcard
Can generalize to `? super FileSystemViewStorageConfig`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/FileSystemViewManager.java`
#### Snippet
```java

  private FileSystemViewManager(HoodieEngineContext context, FileSystemViewStorageConfig viewStorageConfig,
      Function2<HoodieTableMetaClient, FileSystemViewStorageConfig, SyncableFileSystemView> viewCreator) {
    this.conf = context.getHadoopConf();
    this.viewStorageConfig = viewStorageConfig;
```

### BoundedWildcard
Can generalize to `? extends SyncableFileSystemView`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/FileSystemViewManager.java`
#### Snippet
```java

  private FileSystemViewManager(HoodieEngineContext context, FileSystemViewStorageConfig viewStorageConfig,
      Function2<HoodieTableMetaClient, FileSystemViewStorageConfig, SyncableFileSystemView> viewCreator) {
    this.conf = context.getHadoopConf();
    this.viewStorageConfig = viewStorageConfig;
```

### BoundedWildcard
Can generalize to `? extends HoodieWriteStat`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/HoodieTablePreCommitFileSystemView.java`
#### Snippet
```java
  public HoodieTablePreCommitFileSystemView(HoodieTableMetaClient metaClient,
                                            SyncableFileSystemView completedCommitsFileSystemView,
                                            List<HoodieWriteStat> filesWritten,
                                            Map<String, List<String>> partitionToReplaceFileIds,
                                            String instantTime) {
```

### BoundedWildcard
Can generalize to `? super T1`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/PriorityBasedFileSystemView.java`
#### Snippet
```java
  }

  private <T1, R> R execute(T1 val, Function1<T1, R> preferredFunction, Function1<T1, R> secondaryFunction) {
    if (errorOnPreferredView) {
      LOG.warn("Routing request to secondary file-system view");
```

### BoundedWildcard
Can generalize to `? extends R`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/PriorityBasedFileSystemView.java`
#### Snippet
```java
  }

  private <T1, R> R execute(T1 val, Function1<T1, R> preferredFunction, Function1<T1, R> secondaryFunction) {
    if (errorOnPreferredView) {
      LOG.warn("Routing request to secondary file-system view");
```

### BoundedWildcard
Can generalize to `? super T1`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/PriorityBasedFileSystemView.java`
#### Snippet
```java
  }

  private <T1, R> R execute(T1 val, Function1<T1, R> preferredFunction, Function1<T1, R> secondaryFunction) {
    if (errorOnPreferredView) {
      LOG.warn("Routing request to secondary file-system view");
```

### BoundedWildcard
Can generalize to `? extends R`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/PriorityBasedFileSystemView.java`
#### Snippet
```java
  }

  private <T1, R> R execute(T1 val, Function1<T1, R> preferredFunction, Function1<T1, R> secondaryFunction) {
    if (errorOnPreferredView) {
      LOG.warn("Routing request to secondary file-system view");
```

### BoundedWildcard
Can generalize to `? super T1`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/PriorityBasedFileSystemView.java`
#### Snippet
```java
  }

  private <T1, T2, R> R execute(T1 val, T2 val2, Function2<T1, T2, R> preferredFunction,
      Function2<T1, T2, R> secondaryFunction) {
    if (errorOnPreferredView) {
```

### BoundedWildcard
Can generalize to `? super T2`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/PriorityBasedFileSystemView.java`
#### Snippet
```java
  }

  private <T1, T2, R> R execute(T1 val, T2 val2, Function2<T1, T2, R> preferredFunction,
      Function2<T1, T2, R> secondaryFunction) {
    if (errorOnPreferredView) {
```

### BoundedWildcard
Can generalize to `? extends R`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/PriorityBasedFileSystemView.java`
#### Snippet
```java
  }

  private <T1, T2, R> R execute(T1 val, T2 val2, Function2<T1, T2, R> preferredFunction,
      Function2<T1, T2, R> secondaryFunction) {
    if (errorOnPreferredView) {
```

### BoundedWildcard
Can generalize to `? super T1`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/PriorityBasedFileSystemView.java`
#### Snippet
```java

  private <T1, T2, R> R execute(T1 val, T2 val2, Function2<T1, T2, R> preferredFunction,
      Function2<T1, T2, R> secondaryFunction) {
    if (errorOnPreferredView) {
      LOG.warn("Routing request to secondary file-system view");
```

### BoundedWildcard
Can generalize to `? super T2`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/PriorityBasedFileSystemView.java`
#### Snippet
```java

  private <T1, T2, R> R execute(T1 val, T2 val2, Function2<T1, T2, R> preferredFunction,
      Function2<T1, T2, R> secondaryFunction) {
    if (errorOnPreferredView) {
      LOG.warn("Routing request to secondary file-system view");
```

### BoundedWildcard
Can generalize to `? extends R`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/PriorityBasedFileSystemView.java`
#### Snippet
```java

  private <T1, T2, R> R execute(T1 val, T2 val2, Function2<T1, T2, R> preferredFunction,
      Function2<T1, T2, R> secondaryFunction) {
    if (errorOnPreferredView) {
      LOG.warn("Routing request to secondary file-system view");
```

### BoundedWildcard
Can generalize to `? super T1`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/PriorityBasedFileSystemView.java`
#### Snippet
```java
  }

  private <T1, T2, T3, R> R execute(T1 val, T2 val2, T3 val3, Function3<T1, T2, T3, R> preferredFunction,
      Function3<T1, T2, T3, R> secondaryFunction) {
    if (errorOnPreferredView) {
```

### BoundedWildcard
Can generalize to `? super T2`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/PriorityBasedFileSystemView.java`
#### Snippet
```java
  }

  private <T1, T2, T3, R> R execute(T1 val, T2 val2, T3 val3, Function3<T1, T2, T3, R> preferredFunction,
      Function3<T1, T2, T3, R> secondaryFunction) {
    if (errorOnPreferredView) {
```

### BoundedWildcard
Can generalize to `? super T3`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/PriorityBasedFileSystemView.java`
#### Snippet
```java
  }

  private <T1, T2, T3, R> R execute(T1 val, T2 val2, T3 val3, Function3<T1, T2, T3, R> preferredFunction,
      Function3<T1, T2, T3, R> secondaryFunction) {
    if (errorOnPreferredView) {
```

### BoundedWildcard
Can generalize to `? extends R`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/PriorityBasedFileSystemView.java`
#### Snippet
```java
  }

  private <T1, T2, T3, R> R execute(T1 val, T2 val2, T3 val3, Function3<T1, T2, T3, R> preferredFunction,
      Function3<T1, T2, T3, R> secondaryFunction) {
    if (errorOnPreferredView) {
```

### BoundedWildcard
Can generalize to `? super T1`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/PriorityBasedFileSystemView.java`
#### Snippet
```java

  private <T1, T2, T3, R> R execute(T1 val, T2 val2, T3 val3, Function3<T1, T2, T3, R> preferredFunction,
      Function3<T1, T2, T3, R> secondaryFunction) {
    if (errorOnPreferredView) {
      LOG.warn("Routing request to secondary file-system view");
```

### BoundedWildcard
Can generalize to `? super T2`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/PriorityBasedFileSystemView.java`
#### Snippet
```java

  private <T1, T2, T3, R> R execute(T1 val, T2 val2, T3 val3, Function3<T1, T2, T3, R> preferredFunction,
      Function3<T1, T2, T3, R> secondaryFunction) {
    if (errorOnPreferredView) {
      LOG.warn("Routing request to secondary file-system view");
```

### BoundedWildcard
Can generalize to `? super T3`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/PriorityBasedFileSystemView.java`
#### Snippet
```java

  private <T1, T2, T3, R> R execute(T1 val, T2 val2, T3 val3, Function3<T1, T2, T3, R> preferredFunction,
      Function3<T1, T2, T3, R> secondaryFunction) {
    if (errorOnPreferredView) {
      LOG.warn("Routing request to secondary file-system view");
```

### BoundedWildcard
Can generalize to `? extends R`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/PriorityBasedFileSystemView.java`
#### Snippet
```java

  private <T1, T2, T3, R> R execute(T1 val, T2 val2, T3 val3, Function3<T1, T2, T3, R> preferredFunction,
      Function3<T1, T2, T3, R> secondaryFunction) {
    if (errorOnPreferredView) {
      LOG.warn("Routing request to secondary file-system view");
```

### BoundedWildcard
Can generalize to `? extends R`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/PriorityBasedFileSystemView.java`
#### Snippet
```java
  }

  private <R> R execute(Function0<R> preferredFunction, Function0<R> secondaryFunction) {
    if (errorOnPreferredView) {
      LOG.warn("Routing request to secondary file-system view");
```

### BoundedWildcard
Can generalize to `? extends R`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/PriorityBasedFileSystemView.java`
#### Snippet
```java
  }

  private <R> R execute(Function0<R> preferredFunction, Function0<R> secondaryFunction) {
    if (errorOnPreferredView) {
      LOG.warn("Routing request to secondary file-system view");
```

### BoundedWildcard
Can generalize to `? extends HoodieFileGroupId`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/SpillableMapBasedFileSystemView.java`
#### Snippet
```java

  @Override
  protected Map<HoodieFileGroupId, HoodieInstant> createFileIdToReplaceInstantMap(final Map<HoodieFileGroupId, HoodieInstant> replacedFileGroups) {
    try {
      LOG.info("Creating file group id to replace instant map using external spillable Map. Max Mem=" + maxMemoryForReplaceFileGroups
```

### BoundedWildcard
Can generalize to `? extends HoodieInstant`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/SpillableMapBasedFileSystemView.java`
#### Snippet
```java

  @Override
  protected Map<HoodieFileGroupId, HoodieInstant> createFileIdToReplaceInstantMap(final Map<HoodieFileGroupId, HoodieInstant> replacedFileGroups) {
    try {
      LOG.info("Creating file group id to replace instant map using external spillable Map. Max Mem=" + maxMemoryForReplaceFileGroups
```

### BoundedWildcard
Can generalize to `? extends HoodieFileGroupId`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/SpillableMapBasedFileSystemView.java`
#### Snippet
```java

  @Override
  protected Map<HoodieFileGroupId, HoodieInstant> createFileIdToPendingClusteringMap(final Map<HoodieFileGroupId, HoodieInstant> fileGroupsInClustering) {
    try {
      LOG.info("Creating file group id to clustering instant map using external spillable Map. Max Mem=" + maxMemoryForClusteringFileGroups
```

### BoundedWildcard
Can generalize to `? extends HoodieInstant`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/SpillableMapBasedFileSystemView.java`
#### Snippet
```java

  @Override
  protected Map<HoodieFileGroupId, HoodieInstant> createFileIdToPendingClusteringMap(final Map<HoodieFileGroupId, HoodieInstant> fileGroupsInClustering) {
    try {
      LOG.info("Creating file group id to clustering instant map using external spillable Map. Max Mem=" + maxMemoryForClusteringFileGroups
```

### BoundedWildcard
Can generalize to `? extends HoodieFileGroupId`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/SpillableMapBasedFileSystemView.java`
#### Snippet
```java
  @Override
  protected Map<HoodieFileGroupId, Pair<String, CompactionOperation>> createFileIdToPendingCompactionMap(
      Map<HoodieFileGroupId, Pair<String, CompactionOperation>> fgIdToPendingCompaction) {
    try {
      LOG.info("Creating Pending Compaction map using external spillable Map. Max Mem=" + maxMemoryForPendingCompaction
```

### BoundedWildcard
Can generalize to `? extends Pair`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/SpillableMapBasedFileSystemView.java`
#### Snippet
```java
  @Override
  protected Map<HoodieFileGroupId, Pair<String, CompactionOperation>> createFileIdToPendingCompactionMap(
      Map<HoodieFileGroupId, Pair<String, CompactionOperation>> fgIdToPendingCompaction) {
    try {
      LOG.info("Creating Pending Compaction map using external spillable Map. Max Mem=" + maxMemoryForPendingCompaction
```

### BoundedWildcard
Can generalize to `? extends HoodieFileGroupId`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/SpillableMapBasedFileSystemView.java`
#### Snippet
```java
  @Override
  protected Map<HoodieFileGroupId, Pair<String, CompactionOperation>> createFileIdToPendingLogCompactionMap(
      Map<HoodieFileGroupId, Pair<String, CompactionOperation>> fgIdToPendingLogCompaction) {
    try {
      LOG.info("Creating Pending Log Compaction map using external spillable Map. Max Mem=" + maxMemoryForPendingLogCompaction
```

### BoundedWildcard
Can generalize to `? extends Pair`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/SpillableMapBasedFileSystemView.java`
#### Snippet
```java
  @Override
  protected Map<HoodieFileGroupId, Pair<String, CompactionOperation>> createFileIdToPendingLogCompactionMap(
      Map<HoodieFileGroupId, Pair<String, CompactionOperation>> fgIdToPendingLogCompaction) {
    try {
      LOG.info("Creating Pending Log Compaction map using external spillable Map. Max Mem=" + maxMemoryForPendingLogCompaction
```

### BoundedWildcard
Can generalize to `? extends HoodieFileGroupId`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/SpillableMapBasedFileSystemView.java`
#### Snippet
```java
  @Override
  protected Map<HoodieFileGroupId, BootstrapBaseFileMapping> createFileIdToBootstrapBaseFileMap(
      Map<HoodieFileGroupId, BootstrapBaseFileMapping> fileGroupIdBootstrapBaseFileMap) {
    try {
      LOG.info("Creating bootstrap base File Map using external spillable Map. Max Mem=" + maxMemoryForBootstrapBaseFile
```

### BoundedWildcard
Can generalize to `? extends BootstrapBaseFileMapping`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/SpillableMapBasedFileSystemView.java`
#### Snippet
```java
  @Override
  protected Map<HoodieFileGroupId, BootstrapBaseFileMapping> createFileIdToBootstrapBaseFileMap(
      Map<HoodieFileGroupId, BootstrapBaseFileMapping> fileGroupIdBootstrapBaseFileMap) {
    try {
      LOG.info("Creating bootstrap base File Map using external spillable Map. Max Mem=" + maxMemoryForBootstrapBaseFile
```

### BoundedWildcard
Can generalize to `? extends BootstrapBaseFileMapping`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/HoodieTableFileSystemView.java`
#### Snippet
```java

  @Override
  void addBootstrapBaseFileMapping(Stream<BootstrapBaseFileMapping> bootstrapBaseFileStream) {
    bootstrapBaseFileStream.forEach(bootstrapBaseFile -> {
      ValidationUtils.checkArgument(!fgIdToBootstrapBaseFile.containsKey(bootstrapBaseFile.getFileGroupId()),
```

### BoundedWildcard
Can generalize to `? extends HoodieFileGroupId`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/HoodieTableFileSystemView.java`
#### Snippet
```java

  @Override
  protected void addReplacedFileGroups(final Map<HoodieFileGroupId, HoodieInstant> replacedFileGroups) {
    fgIdToReplaceInstants.putAll(replacedFileGroups);
  }
```

### BoundedWildcard
Can generalize to `? extends HoodieInstant`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/HoodieTableFileSystemView.java`
#### Snippet
```java

  @Override
  protected void addReplacedFileGroups(final Map<HoodieFileGroupId, HoodieInstant> replacedFileGroups) {
    fgIdToReplaceInstants.putAll(replacedFileGroups);
  }
```

### BoundedWildcard
Can generalize to `? extends Pair`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/HoodieTableFileSystemView.java`
#### Snippet
```java

  @Override
  protected void addPendingLogCompactionOperations(Stream<Pair<String, CompactionOperation>> operations) {
    operations.forEach(opInstantPair -> {
      ValidationUtils.checkArgument(!fgIdToPendingLogCompaction.containsKey(opInstantPair.getValue().getFileGroupId()),
```

### BoundedWildcard
Can generalize to `? extends Pair`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/HoodieTableFileSystemView.java`
#### Snippet
```java

  @Override
  void addFileGroupsInPendingClustering(Stream<Pair<HoodieFileGroupId, HoodieInstant>> fileGroups) {
    fileGroups.forEach(fileGroupInstantPair -> {
      ValidationUtils.checkArgument(fgIdToPendingClustering.containsKey(fileGroupInstantPair.getLeft()),
```

### BoundedWildcard
Can generalize to `? extends HoodieFileGroup`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/HoodieTableFileSystemView.java`
#### Snippet
```java

  @Override
  protected void storePartitionView(String partitionPath, List<HoodieFileGroup> fileGroups) {
    LOG.debug("Adding file-groups for partition :" + partitionPath + ", #FileGroups=" + fileGroups.size());
    List<HoodieFileGroup> newList = new ArrayList<>(fileGroups);
```

### BoundedWildcard
Can generalize to `? extends Pair`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/HoodieTableFileSystemView.java`
#### Snippet
```java

  @Override
  protected void resetPendingLogCompactionOperations(Stream<Pair<String, CompactionOperation>> operations) {
    // Build fileId to Pending Log Compaction Instants
    this.fgIdToPendingLogCompaction = createFileIdToPendingLogCompactionMap(operations.map(entry ->
```

### BoundedWildcard
Can generalize to `? extends Pair`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/HoodieTableFileSystemView.java`
#### Snippet
```java

  @Override
  protected void removePendingLogCompactionOperations(Stream<Pair<String, CompactionOperation>> operations) {
    operations.forEach(opInstantPair -> {
      ValidationUtils.checkArgument(fgIdToPendingLogCompaction.containsKey(opInstantPair.getValue().getFileGroupId()),
```

### BoundedWildcard
Can generalize to `? extends HoodieFileGroupId`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/HoodieTableFileSystemView.java`
#### Snippet
```java
  }

  protected Map<HoodieFileGroupId, HoodieInstant> createFileIdToReplaceInstantMap(final Map<HoodieFileGroupId, HoodieInstant> replacedFileGroups) {
    Map<HoodieFileGroupId, HoodieInstant> replacedFileGroupsMap = new ConcurrentHashMap<>(replacedFileGroups);
    return replacedFileGroupsMap;
```

### BoundedWildcard
Can generalize to `? extends HoodieInstant`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/HoodieTableFileSystemView.java`
#### Snippet
```java
  }

  protected Map<HoodieFileGroupId, HoodieInstant> createFileIdToReplaceInstantMap(final Map<HoodieFileGroupId, HoodieInstant> replacedFileGroups) {
    Map<HoodieFileGroupId, HoodieInstant> replacedFileGroupsMap = new ConcurrentHashMap<>(replacedFileGroups);
    return replacedFileGroupsMap;
```

### BoundedWildcard
Can generalize to `? extends BootstrapBaseFileMapping`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/HoodieTableFileSystemView.java`
#### Snippet
```java

  @Override
  void removeBootstrapBaseFileMapping(Stream<BootstrapBaseFileMapping> bootstrapBaseFileStream) {
    bootstrapBaseFileStream.forEach(bootstrapBaseFile -> {
      ValidationUtils.checkArgument(fgIdToBootstrapBaseFile.containsKey(bootstrapBaseFile.getFileGroupId()),
```

### BoundedWildcard
Can generalize to `? extends BootstrapBaseFileMapping`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/HoodieTableFileSystemView.java`
#### Snippet
```java

  @Override
  void resetBootstrapBaseFileMapping(Stream<BootstrapBaseFileMapping> bootstrapBaseFileStream) {
    // Build fileId to bootstrap Data File
    this.fgIdToBootstrapBaseFile = createFileIdToBootstrapBaseFileMap(bootstrapBaseFileStream
```

### BoundedWildcard
Can generalize to `? extends Pair`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/HoodieTableFileSystemView.java`
#### Snippet
```java

  @Override
  protected void removePendingCompactionOperations(Stream<Pair<String, CompactionOperation>> operations) {
    operations.forEach(opInstantPair -> {
      ValidationUtils.checkArgument(fgIdToPendingCompaction.containsKey(opInstantPair.getValue().getFileGroupId()),
```

### BoundedWildcard
Can generalize to `? extends Pair`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/HoodieTableFileSystemView.java`
#### Snippet
```java

  @Override
  protected void addPendingCompactionOperations(Stream<Pair<String, CompactionOperation>> operations) {
    operations.forEach(opInstantPair -> {
      ValidationUtils.checkArgument(!fgIdToPendingCompaction.containsKey(opInstantPair.getValue().getFileGroupId()),
```

### BoundedWildcard
Can generalize to `? extends HoodieFileGroupId`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/HoodieTableFileSystemView.java`
#### Snippet
```java
  }

  protected Map<HoodieFileGroupId, HoodieInstant> createFileIdToPendingClusteringMap(final Map<HoodieFileGroupId, HoodieInstant> fileGroupsInClustering) {
    Map<HoodieFileGroupId, HoodieInstant> fgInpendingClustering = new ConcurrentHashMap<>(fileGroupsInClustering);
    return fgInpendingClustering;
```

### BoundedWildcard
Can generalize to `? extends HoodieInstant`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/HoodieTableFileSystemView.java`
#### Snippet
```java
  }

  protected Map<HoodieFileGroupId, HoodieInstant> createFileIdToPendingClusteringMap(final Map<HoodieFileGroupId, HoodieInstant> fileGroupsInClustering) {
    Map<HoodieFileGroupId, HoodieInstant> fgInpendingClustering = new ConcurrentHashMap<>(fileGroupsInClustering);
    return fgInpendingClustering;
```

### BoundedWildcard
Can generalize to `? extends Pair`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/HoodieTableFileSystemView.java`
#### Snippet
```java

  @Override
  void removeFileGroupsInPendingClustering(Stream<Pair<HoodieFileGroupId, HoodieInstant>> fileGroups) {
    fileGroups.forEach(fileGroupInstantPair -> {
      ValidationUtils.checkArgument(fgIdToPendingClustering.containsKey(fileGroupInstantPair.getLeft()),
```

### BoundedWildcard
Can generalize to `? extends Pair`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/HoodieTableFileSystemView.java`
#### Snippet
```java

  @Override
  protected void resetPendingCompactionOperations(Stream<Pair<String, CompactionOperation>> operations) {
    // Build fileId to Pending Compaction Instants
    this.fgIdToPendingCompaction = createFileIdToPendingCompactionMap(operations.map(entry ->
```

### BoundedWildcard
Can generalize to `? extends HoodieInstant`
in `hudi-common/src/main/java/org/apache/hudi/common/table/timeline/TimelineLayout.java`
#### Snippet
```java

    @Override
    public Stream<HoodieInstant> filterHoodieInstants(Stream<HoodieInstant> instantStream) {
      return instantStream.collect(Collectors.groupingBy(instant -> Pair.of(instant.getTimestamp(),
          HoodieInstant.getComparableAction(instant.getAction())))).values().stream()
```

### BoundedWildcard
Can generalize to `? super String`
in `hudi-common/src/main/java/org/apache/hudi/common/table/timeline/HoodieTimeline.java`
#### Snippet
```java
  BiPredicate<String, String> LESSER_THAN = (commit1, commit2) -> commit1.compareTo(commit2) < 0;

  static boolean compareTimestamps(String commit1, BiPredicate<String, String> predicateToApply, String commit2) {
    return predicateToApply.test(commit1, commit2);
  }
```

### BoundedWildcard
Can generalize to `? super String`
in `hudi-common/src/main/java/org/apache/hudi/common/table/timeline/HoodieTimeline.java`
#### Snippet
```java
  BiPredicate<String, String> LESSER_THAN = (commit1, commit2) -> commit1.compareTo(commit2) < 0;

  static boolean compareTimestamps(String commit1, BiPredicate<String, String> predicateToApply, String commit2) {
    return predicateToApply.test(commit1, commit2);
  }
```

### BoundedWildcard
Can generalize to `? extends HoodieFileGroup`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/IncrementalTimelineSyncFileSystemView.java`
#### Snippet
```java
   * @param mode Delta Apply mode
   */
  protected void applyDeltaFileSlicesToPartitionView(String partition, List<HoodieFileGroup> deltaFileGroups,
      DeltaApplyMode mode) {
    if (deltaFileGroups.isEmpty()) {
```

### BoundedWildcard
Can generalize to `? extends List`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/IncrementalTimelineSyncFileSystemView.java`
#### Snippet
```java
  }

  private void updatePartitionWriteFileGroups(Map<String, List<HoodieWriteStat>> partitionToWriteStats,
                                              HoodieTimeline timeline,
                                              HoodieInstant instant) {
```

### BoundedWildcard
Can generalize to `? extends HoodieInstant`
in `hudi-common/src/main/java/org/apache/hudi/common/table/timeline/HoodieDefaultTimeline.java`
#### Snippet
```java
  private String timelineHash;

  public HoodieDefaultTimeline(Stream<HoodieInstant> instants, Function<HoodieInstant, Option<byte[]>> details) {
    this.details = details;
    setInstants(instants.collect(Collectors.toList()));
```

### BoundedWildcard
Can generalize to `? super HoodieInstant`
in `hudi-common/src/main/java/org/apache/hudi/common/table/timeline/HoodieDefaultTimeline.java`
#### Snippet
```java

  @Override
  public HoodieTimeline filter(Predicate<HoodieInstant> filter) {
    return new HoodieDefaultTimeline(getInstantsAsStream().filter(filter), details);
  }
```

### BoundedWildcard
Can generalize to `? extends Pair`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/RocksDbBasedFileSystemView.java`
#### Snippet
```java

  @Override
  protected void addPendingLogCompactionOperations(Stream<Pair<String, CompactionOperation>> operations) {
    rocksDB.writeBatch(batch ->
        operations.forEach(opInstantPair -> {
```

### BoundedWildcard
Can generalize to `? extends FileSlice`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/RocksDbBasedFileSystemView.java`
#### Snippet
```java
  }

  private Stream<HoodieFileGroup> getFileGroups(Stream<FileSlice> sliceStream) {
    return sliceStream.map(s -> Pair.of(Pair.of(s.getPartitionPath(), s.getFileId()), s))
        .collect(Collectors.groupingBy(Pair::getKey)).entrySet().stream().map(slicePair -> {
```

### BoundedWildcard
Can generalize to `? extends BootstrapBaseFileMapping`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/RocksDbBasedFileSystemView.java`
#### Snippet
```java

  @Override
  void resetBootstrapBaseFileMapping(Stream<BootstrapBaseFileMapping> bootstrapBaseFileStream) {
    rocksDB.writeBatch(batch -> {
      bootstrapBaseFileStream.forEach(externalBaseFile -> {
```

### BoundedWildcard
Can generalize to `? extends Pair`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/RocksDbBasedFileSystemView.java`
#### Snippet
```java

  @Override
  protected void addPendingCompactionOperations(Stream<Pair<String, CompactionOperation>> operations) {
    rocksDB.writeBatch(batch ->
        operations.forEach(opInstantPair -> {
```

### BoundedWildcard
Can generalize to `? extends HoodieFileGroupId`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/RocksDbBasedFileSystemView.java`
#### Snippet
```java

  @Override
  void resetFileGroupsInPendingClustering(Map<HoodieFileGroupId, HoodieInstant> fgIdToInstantMap) {
    LOG.info("Resetting file groups in pending clustering to ROCKSDB based file-system view at "
        + config.getRocksdbBasePath() + ", Total file-groups=" + fgIdToInstantMap.size());
```

### BoundedWildcard
Can generalize to `? extends HoodieInstant`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/RocksDbBasedFileSystemView.java`
#### Snippet
```java

  @Override
  void resetFileGroupsInPendingClustering(Map<HoodieFileGroupId, HoodieInstant> fgIdToInstantMap) {
    LOG.info("Resetting file groups in pending clustering to ROCKSDB based file-system view at "
        + config.getRocksdbBasePath() + ", Total file-groups=" + fgIdToInstantMap.size());
```

### BoundedWildcard
Can generalize to `? extends HoodieFileGroup`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/RocksDbBasedFileSystemView.java`
#### Snippet
```java

  @Override
  protected void storePartitionView(String partitionPath, List<HoodieFileGroup> fileGroups) {
    LOG.info("Resetting and adding new partition (" + partitionPath + ") to ROCKSDB based file-system view at "
        + config.getRocksdbBasePath() + ", Total file-groups=" + fileGroups.size());
```

### BoundedWildcard
Can generalize to `? extends Pair`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/RocksDbBasedFileSystemView.java`
#### Snippet
```java

  @Override
  protected void resetPendingLogCompactionOperations(Stream<Pair<String, CompactionOperation>> operations) {
    rocksDB.writeBatch(batch -> {
      operations.forEach(opPair ->
```

### BoundedWildcard
Can generalize to `? extends Pair`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/RocksDbBasedFileSystemView.java`
#### Snippet
```java

  @Override
  void removePendingCompactionOperations(Stream<Pair<String, CompactionOperation>> operations) {
    rocksDB.writeBatch(batch ->
        operations.forEach(opInstantPair -> {
```

### BoundedWildcard
Can generalize to `? extends BootstrapBaseFileMapping`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/RocksDbBasedFileSystemView.java`
#### Snippet
```java

  @Override
  void addBootstrapBaseFileMapping(Stream<BootstrapBaseFileMapping> bootstrapBaseFileStream) {
    rocksDB.writeBatch(batch -> {
      bootstrapBaseFileStream.forEach(externalBaseFile -> {
```

### BoundedWildcard
Can generalize to `? extends Pair`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/RocksDbBasedFileSystemView.java`
#### Snippet
```java

  @Override
  void removePendingLogCompactionOperations(Stream<Pair<String, CompactionOperation>> operations) {
    rocksDB.writeBatch(batch ->
        operations.forEach(opInstantPair -> {
```

### BoundedWildcard
Can generalize to `? extends Pair`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/RocksDbBasedFileSystemView.java`
#### Snippet
```java

  @Override
  protected void resetPendingCompactionOperations(Stream<Pair<String, CompactionOperation>> operations) {
    rocksDB.writeBatch(batch -> {
      operations.forEach(opPair ->
```

### BoundedWildcard
Can generalize to `? extends BootstrapBaseFileMapping`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/RocksDbBasedFileSystemView.java`
#### Snippet
```java

  @Override
  void removeBootstrapBaseFileMapping(Stream<BootstrapBaseFileMapping> bootstrapBaseFileStream) {
    rocksDB.writeBatch(batch -> {
      bootstrapBaseFileStream.forEach(externalBaseFile -> {
```

### BoundedWildcard
Can generalize to `? extends Pair`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/RocksDbBasedFileSystemView.java`
#### Snippet
```java

  @Override
  void addFileGroupsInPendingClustering(Stream<Pair<HoodieFileGroupId, HoodieInstant>> fileGroups) {
    rocksDB.writeBatch(batch ->
        fileGroups.forEach(fgIdToClusterInstant -> {
```

### BoundedWildcard
Can generalize to `? extends Pair`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/RocksDbBasedFileSystemView.java`
#### Snippet
```java

  @Override
  void removeFileGroupsInPendingClustering(Stream<Pair<HoodieFileGroupId, HoodieInstant>> fileGroups) {
    rocksDB.writeBatch(batch ->
        fileGroups.forEach(fgToPendingClusteringInstant -> {
```

### BoundedWildcard
Can generalize to `? extends HoodieFileGroup`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/RocksDbBasedFileSystemView.java`
#### Snippet
```java
   * This is overridden to incrementally apply file-slices to rocks DB
   */
  protected void applyDeltaFileSlicesToPartitionView(String partition, List<HoodieFileGroup> deltaFileGroups,
      DeltaApplyMode mode) {
    rocksDB.writeBatch(batch ->
```

### BoundedWildcard
Can generalize to `? extends HoodieBaseFile`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/AbstractTableFileSystemView.java`
#### Snippet
```java
  }

  protected List<HoodieFileGroup> buildFileGroups(Stream<HoodieBaseFile> baseFileStream,
                                                  Stream<HoodieLogFile> logFileStream, HoodieTimeline timeline, boolean addPendingCompactionFileSlice) {
    Map<Pair<String, String>, List<HoodieBaseFile>> baseFiles =
```

### BoundedWildcard
Can generalize to `? extends HoodieLogFile`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/AbstractTableFileSystemView.java`
#### Snippet
```java

  protected List<HoodieFileGroup> buildFileGroups(Stream<HoodieBaseFile> baseFileStream,
                                                  Stream<HoodieLogFile> logFileStream, HoodieTimeline timeline, boolean addPendingCompactionFileSlice) {
    Map<Pair<String, String>, List<HoodieBaseFile>> baseFiles =
        baseFileStream.collect(Collectors.groupingBy(baseFile -> {
```

### BoundedWildcard
Can generalize to `? extends Pair`
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/AbstractTableFileSystemView.java`
#### Snippet
```java
   */
  protected Map<Pair<String, Path>, FileStatus[]> listPartitions(
      List<Pair<String, Path>> partitionPathList) throws IOException {
    Map<Pair<String, Path>, FileStatus[]> fileStatusMap = new HashMap<>();

```

### BoundedWildcard
Can generalize to `? super I`
in `hudi-common/src/main/java/org/apache/hudi/common/function/FunctionWrapper.java`
#### Snippet
```java
public class FunctionWrapper {

  public static <I, O> Function<I, O> throwingMapWrapper(SerializableFunction<I, O> throwingMapFunction) {
    return v1 -> {
      try {
```

### BoundedWildcard
Can generalize to `? extends O`
in `hudi-common/src/main/java/org/apache/hudi/common/function/FunctionWrapper.java`
#### Snippet
```java
public class FunctionWrapper {

  public static <I, O> Function<I, O> throwingMapWrapper(SerializableFunction<I, O> throwingMapFunction) {
    return v1 -> {
      try {
```

### BoundedWildcard
Can generalize to `? super V`
in `hudi-common/src/main/java/org/apache/hudi/common/function/FunctionWrapper.java`
#### Snippet
```java
  }

  public static <V> BinaryOperator<V> throwingReduceWrapper(SerializableBiFunction<V, V, V> throwingReduceFunction) {
    return (v1, v2) -> {
      try {
```

### BoundedWildcard
Can generalize to `? super V`
in `hudi-common/src/main/java/org/apache/hudi/common/function/FunctionWrapper.java`
#### Snippet
```java
  }

  public static <V> BinaryOperator<V> throwingReduceWrapper(SerializableBiFunction<V, V, V> throwingReduceFunction) {
    return (v1, v2) -> {
      try {
```

### BoundedWildcard
Can generalize to `? extends V`
in `hudi-common/src/main/java/org/apache/hudi/common/function/FunctionWrapper.java`
#### Snippet
```java
  }

  public static <V> BinaryOperator<V> throwingReduceWrapper(SerializableBiFunction<V, V, V> throwingReduceFunction) {
    return (v1, v2) -> {
      try {
```

### BoundedWildcard
Can generalize to `? super I`
in `hudi-common/src/main/java/org/apache/hudi/common/function/FunctionWrapper.java`
#### Snippet
```java
  }

  public static <I, K, V> Function<I, Pair<K, V>> throwingMapToPairWrapper(SerializablePairFunction<I, K, V> throwingPairFunction) {
    return v1 -> {
      try {
```

### BoundedWildcard
Can generalize to `? super I`
in `hudi-common/src/main/java/org/apache/hudi/common/function/FunctionWrapper.java`
#### Snippet
```java
  }

  public static <I> Consumer<I> throwingForeachWrapper(SerializableConsumer<I> throwingConsumer) {
    return v1 -> {
      try {
```

### BoundedWildcard
Can generalize to `? super I`
in `hudi-common/src/main/java/org/apache/hudi/common/function/FunctionWrapper.java`
#### Snippet
```java
  }

  public static <I, O> Function<I, Stream<O>> throwingFlatMapWrapper(SerializableFunction<I, Stream<O>> throwingFlatMapFunction) {
    return v1 -> {
      try {
```

### BoundedWildcard
Can generalize to `? extends Stream`
in `hudi-common/src/main/java/org/apache/hudi/common/function/FunctionWrapper.java`
#### Snippet
```java
  }

  public static <I, O> Function<I, Stream<O>> throwingFlatMapWrapper(SerializableFunction<I, Stream<O>> throwingFlatMapFunction) {
    return v1 -> {
      try {
```

### BoundedWildcard
Can generalize to `? super I`
in `hudi-common/src/main/java/org/apache/hudi/common/function/FunctionWrapper.java`
#### Snippet
```java

  public static <I, K, V> Function<I, Stream<Pair<K, V>>> throwingFlatMapToPairWrapper(
      SerializablePairFlatMapFunction<I, K, V> throwingPairFlatMapFunction) {
    return v1 -> {
      try {
```

### BoundedWildcard
Can generalize to `? super String`
in `hudi-common/src/main/java/org/apache/hudi/common/bootstrap/index/HFileBootstrapIndex.java`
#### Snippet
```java
    }

    private <T> List<T> getAllKeys(HFileScanner scanner, Function<String, T> converter) {
      List<T> keys = new ArrayList<>();
      try {
```

### BoundedWildcard
Can generalize to `? extends T`
in `hudi-common/src/main/java/org/apache/hudi/common/bootstrap/index/HFileBootstrapIndex.java`
#### Snippet
```java
    }

    private <T> List<T> getAllKeys(HFileScanner scanner, Function<String, T> converter) {
      List<T> keys = new ArrayList<>();
      try {
```

### BoundedWildcard
Can generalize to `? super Integer`
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/InternalSchemaBuilder.java`
#### Snippet
```java
  }

  private void index2Parents(Type type, Deque<Integer> pids, Map<Integer, Integer> id2p) {
    switch (type.typeId()) {
      case RECORD:
```

### BoundedWildcard
Can generalize to `? super Integer`
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/InternalSchemaBuilder.java`
#### Snippet
```java
  }

  private void index2Parents(Type type, Deque<Integer> pids, Map<Integer, Integer> id2p) {
    switch (type.typeId()) {
      case RECORD:
```

### BoundedWildcard
Can generalize to `? super Integer`
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/InternalSchemaBuilder.java`
#### Snippet
```java
  }

  private void visitIdToField(Type type, Map<Integer, Types.Field> index) {
    switch (type.typeId()) {
      case RECORD:
```

### BoundedWildcard
Can generalize to `? super Types.Field`
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/InternalSchemaBuilder.java`
#### Snippet
```java
  }

  private void visitIdToField(Type type, Map<Integer, Types.Field> index) {
    switch (type.typeId()) {
      case RECORD:
```

### BoundedWildcard
Can generalize to `? extends Types.Field`
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/action/TableChangesHelper.java`
#### Snippet
```java
   * @return column fields after adjusting the position.
   */
  public static List<Types.Field> applyAddChange2Fields(List<Types.Field> fields, ArrayList<Types.Field> adds, ArrayList<TableChange.ColumnPositionChange> pchanges) {
    if (adds == null && pchanges == null) {
      return fields;
```

### BoundedWildcard
Can generalize to `? extends TableChange.ColumnPositionChange`
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/action/TableChangesHelper.java`
#### Snippet
```java
   * @return column fields after adjusting the position.
   */
  public static List<Types.Field> applyAddChange2Fields(List<Types.Field> fields, ArrayList<Types.Field> adds, ArrayList<TableChange.ColumnPositionChange> pchanges) {
    if (adds == null && pchanges == null) {
      return fields;
```

### BoundedWildcard
Can generalize to `? extends InternalSchema`
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/utils/SerDeHelper.java`
#### Snippet
```java
   * @return a string
   */
  public static String toJson(List<InternalSchema> internalSchemas) {
    try {
      StringWriter writer = new StringWriter();
```

### BoundedWildcard
Can generalize to `? extends InternalSchema`
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/utils/InternalSchemaUtils.java`
#### Snippet
```java
   * @return a internalSchema.
   */
  public static InternalSchema searchSchema(long versionId, List<InternalSchema> internalSchemas) {
    TreeMap<Long, InternalSchema> treeMap = new TreeMap<>();
    internalSchemas.forEach(s -> treeMap.put(s.schemaId(), s));
```

### BoundedWildcard
Can generalize to `? extends Types.Field`
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/action/InternalSchemaMerger.java`
#### Snippet
```java
  }

  private List<Types.Field> buildRecordType(List<Types.Field> oldFields, List<Type> newTypes) {
    List<Types.Field> newFields = new ArrayList<>();
    for (int i = 0; i < newTypes.size(); i++) {
```

### BoundedWildcard
Can generalize to `? extends Type`
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/action/InternalSchemaMerger.java`
#### Snippet
```java
  }

  private List<Types.Field> buildRecordType(List<Types.Field> oldFields, List<Type> newTypes) {
    List<Types.Field> newFields = new ArrayList<>();
    for (int i = 0; i < newTypes.size(); i++) {
```

### BoundedWildcard
Can generalize to `? super String`
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/convert/AvroInternalSchemaConverter.java`
#### Snippet
```java
   * @return a hudi type match avro schema.
   */
  private static Type visitAvroSchemaToBuildType(Schema schema, Deque<String> visited, Boolean firstVisitRoot, AtomicInteger nextId) {
    switch (schema.getType()) {
      case RECORD:
```

### BoundedWildcard
Can generalize to `? extends Schema`
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/convert/AvroInternalSchemaConverter.java`
#### Snippet
```java
   * this is auxiliary function used by visitInternalSchemaToBuildAvroSchema
   */
  private static Schema visitInternalRecordToBuildAvroRecord(Types.RecordType recordType, List<Schema> fieldSchemas, String recordNameFallback) {
    List<Types.Field> fields = recordType.fields();
    List<Schema.Field> avroFields = new ArrayList<>();
```

### BoundedWildcard
Can generalize to `? super Type`
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/convert/AvroInternalSchemaConverter.java`
#### Snippet
```java
   * @return a Avro schema match this type
   */
  private static Schema visitInternalSchemaToBuildAvroSchema(Type type, Map<Type, Schema> cache, String recordName) {
    switch (type.typeId()) {
      case RECORD:
```

### BoundedWildcard
Can generalize to `? super Iterator`
in `hudi-common/src/main/java/org/apache/hudi/common/engine/HoodieLocalEngineContext.java`
#### Snippet
```java
  @Override
  public <I, K, V> Stream<ImmutablePair<K, V>> mapPartitionsToPairAndReduceByKey(
      Stream<I> data, SerializablePairFlatMapFunction<Iterator<I>, K, V> flatMapToPairFunc,
      SerializableBiFunction<V, V, V> reduceFunc, int parallelism) {
    return throwingFlatMapToPairWrapper(flatMapToPairFunc).apply(data.parallel().iterator())
```

### BoundedWildcard
Can generalize to `? extends I`
in `hudi-common/src/main/java/org/apache/hudi/common/engine/HoodieLocalEngineContext.java`
#### Snippet
```java
  @Override
  public <I, K, V> List<V> mapToPairAndReduceByKey(
      List<I> data, SerializablePairFunction<I, K, V> mapToPairFunc, SerializableBiFunction<V, V, V> reduceFunc, int parallelism) {
    return data.stream().parallel().map(throwingMapToPairWrapper(mapToPairFunc))
        .collect(Collectors.groupingBy(p -> p.getKey())).values().stream()
```

### BoundedWildcard
Can generalize to `? super I`
in `hudi-common/src/main/java/org/apache/hudi/common/engine/HoodieLocalEngineContext.java`
#### Snippet
```java
  @Override
  public <I, K, V> List<V> mapToPairAndReduceByKey(
      List<I> data, SerializablePairFunction<I, K, V> mapToPairFunc, SerializableBiFunction<V, V, V> reduceFunc, int parallelism) {
    return data.stream().parallel().map(throwingMapToPairWrapper(mapToPairFunc))
        .collect(Collectors.groupingBy(p -> p.getKey())).values().stream()
```

### BoundedWildcard
Can generalize to `? extends I`
in `hudi-common/src/main/java/org/apache/hudi/common/engine/HoodieLocalEngineContext.java`
#### Snippet
```java

  @Override
  public <I, K, V> Map<K, V> mapToPair(List<I> data, SerializablePairFunction<I, K, V> func, Integer parallelism) {
    return data.stream().map(throwingMapToPairWrapper(func)).collect(
        Collectors.toMap(Pair::getLeft, Pair::getRight, (oldVal, newVal) -> newVal)
```

### BoundedWildcard
Can generalize to `? super I`
in `hudi-common/src/main/java/org/apache/hudi/common/engine/HoodieLocalEngineContext.java`
#### Snippet
```java

  @Override
  public <I, K, V> Map<K, V> mapToPair(List<I> data, SerializablePairFunction<I, K, V> func, Integer parallelism) {
    return data.stream().map(throwingMapToPairWrapper(func)).collect(
        Collectors.toMap(Pair::getLeft, Pair::getRight, (oldVal, newVal) -> newVal)
```

### BoundedWildcard
Can generalize to `? extends K`
in `hudi-common/src/main/java/org/apache/hudi/common/engine/HoodieLocalEngineContext.java`
#### Snippet
```java

  @Override
  public <I, K, V> Map<K, V> mapToPair(List<I> data, SerializablePairFunction<I, K, V> func, Integer parallelism) {
    return data.stream().map(throwingMapToPairWrapper(func)).collect(
        Collectors.toMap(Pair::getLeft, Pair::getRight, (oldVal, newVal) -> newVal)
```

### BoundedWildcard
Can generalize to `? extends V`
in `hudi-common/src/main/java/org/apache/hudi/common/engine/HoodieLocalEngineContext.java`
#### Snippet
```java

  @Override
  public <I, K, V> Map<K, V> mapToPair(List<I> data, SerializablePairFunction<I, K, V> func, Integer parallelism) {
    return data.stream().map(throwingMapToPairWrapper(func)).collect(
        Collectors.toMap(Pair::getLeft, Pair::getRight, (oldVal, newVal) -> newVal)
```

### BoundedWildcard
Can generalize to `? extends Pair`
in `hudi-common/src/main/java/org/apache/hudi/common/engine/HoodieLocalEngineContext.java`
#### Snippet
```java
  @Override
  public <I, K, V> List<V> reduceByKey(
      List<Pair<K, V>> data, SerializableBiFunction<V, V, V> reduceFunc, int parallelism) {
    return data.stream().parallel()
        .collect(Collectors.groupingBy(p -> p.getKey())).values().stream()
```

### BoundedWildcard
Can generalize to `? extends I`
in `hudi-common/src/main/java/org/apache/hudi/common/engine/HoodieLocalEngineContext.java`
#### Snippet
```java

  @Override
  public <I> void foreach(List<I> data, SerializableConsumer<I> consumer, int parallelism) {
    data.stream().forEach(throwingForeachWrapper(consumer));
  }
```

### BoundedWildcard
Can generalize to `? super I`
in `hudi-common/src/main/java/org/apache/hudi/common/engine/HoodieLocalEngineContext.java`
#### Snippet
```java

  @Override
  public <I> void foreach(List<I> data, SerializableConsumer<I> consumer, int parallelism) {
    data.stream().forEach(throwingForeachWrapper(consumer));
  }
```

### BoundedWildcard
Can generalize to `? extends I`
in `hudi-common/src/main/java/org/apache/hudi/common/engine/HoodieLocalEngineContext.java`
#### Snippet
```java

  @Override
  public <I, O> List<O> flatMap(List<I> data, SerializableFunction<I, Stream<O>> func, int parallelism) {
    return data.stream().parallel().flatMap(throwingFlatMapWrapper(func)).collect(toList());
  }
```

### BoundedWildcard
Can generalize to `? super I`
in `hudi-common/src/main/java/org/apache/hudi/common/engine/HoodieLocalEngineContext.java`
#### Snippet
```java

  @Override
  public <I, O> List<O> flatMap(List<I> data, SerializableFunction<I, Stream<O>> func, int parallelism) {
    return data.stream().parallel().flatMap(throwingFlatMapWrapper(func)).collect(toList());
  }
```

### BoundedWildcard
Can generalize to `? extends I`
in `hudi-common/src/main/java/org/apache/hudi/common/engine/HoodieLocalEngineContext.java`
#### Snippet
```java

  @Override
  public <I, O> List<O> map(List<I> data, SerializableFunction<I, O> func, int parallelism) {
    return data.stream().parallel().map(throwingMapWrapper(func)).collect(toList());
  }
```

### BoundedWildcard
Can generalize to `? super I`
in `hudi-common/src/main/java/org/apache/hudi/common/engine/HoodieLocalEngineContext.java`
#### Snippet
```java

  @Override
  public <I, O> List<O> map(List<I> data, SerializableFunction<I, O> func, int parallelism) {
    return data.stream().parallel().map(throwingMapWrapper(func)).collect(toList());
  }
```

### BoundedWildcard
Can generalize to `? extends O`
in `hudi-common/src/main/java/org/apache/hudi/common/engine/HoodieLocalEngineContext.java`
#### Snippet
```java

  @Override
  public <I, O> List<O> map(List<I> data, SerializableFunction<I, O> func, int parallelism) {
    return data.stream().parallel().map(throwingMapWrapper(func)).collect(toList());
  }
```

### BoundedWildcard
Can generalize to `? extends Pair`
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieMetadataFileSystemView.java`
#### Snippet
```java
  
  @Override
  protected Map<Pair<String, Path>, FileStatus[]> listPartitions(List<Pair<String, Path>> partitionPathList) throws IOException {
    Map<String, Pair<String, Path>> absoluteToPairMap = partitionPathList.stream()
        .collect(Collectors.toMap(
```

### BoundedWildcard
Can generalize to `? extends Type`
in `hudi-common/src/main/java/org/apache/parquet/avro/HoodieAvroReadSupport.java`
#### Snippet
```java
   * Convert non-legacy map to legacy map.
   */
  private List<Type> convertLegacyMap(List<Type> oldTypes) {
    List<Type> newTypes = new ArrayList<>(oldTypes.size());
    for (Type type : oldTypes) {
```

### BoundedWildcard
Can generalize to `? extends Type`
in `hudi-common/src/main/java/org/apache/parquet/avro/HoodieAvroReadSupport.java`
#### Snippet
```java
   *    }
   */
  private boolean checkLegacyMode(List<Type> parquetFields) {
    for (Type type : parquetFields) {
      if (!type.isPrimitive()) {
```

### BoundedWildcard
Can generalize to `? extends Path`
in `hudi-common/src/main/java/org/apache/hudi/metadata/BaseTableMetadata.java`
#### Snippet
```java
  }

  Map<String, FileStatus[]> fetchAllFilesInPartitionPaths(List<Path> partitionPaths) throws IOException {
    Map<String, Path> partitionIdToPathMap =
        partitionPaths.parallelStream()
```

### BoundedWildcard
Can generalize to `? extends List`
in `hudi-common/src/main/java/org/apache/hudi/secondary/index/SecondaryIndexManager.java`
#### Snippet
```java
   */
  private boolean indexExists(
      Option<List<HoodieSecondaryIndex>> secondaryIndexes,
      String indexName,
      Option<String> indexType,
```

### BoundedWildcard
Can generalize to `? extends Set`
in `hudi-common/src/main/java/org/apache/hudi/secondary/index/SecondaryIndexManager.java`
#### Snippet
```java
      String indexName,
      Option<String> indexType,
      Option<Set<String>> colNames) {
    return secondaryIndexes.map(indexes ->
        indexes.stream().anyMatch(index -> {
```

### BoundedWildcard
Can generalize to `? extends DataType`
in `hudi-examples/hudi-examples-flink/src/main/java/org/apache/hudi/examples/quickstart/utils/SchemaBuilder.java`
#### Snippet
```java
  }

  public SchemaBuilder fields(List<String> names, List<DataType> types) {
    List<Column> columns = IntStream.range(0, names.size())
        .mapToObj(idx -> Column.physical(names.get(idx), types.get(idx)))
```

### BoundedWildcard
Can generalize to `? super Long`
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieBackedTableMetadata.java`
#### Snippet
```java
                                                                                  List<String> keys,
                                                                                  boolean fullKey,
                                                                                  List<Long> timings) {
    HoodieTimer timer = HoodieTimer.start();

```

### BoundedWildcard
Can generalize to `? extends HoodieSeekingFileReader`
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieBackedTableMetadata.java`
#### Snippet
```java
  }

  private void closeReader(Pair<HoodieSeekingFileReader<?>, HoodieMetadataLogRecordReader> readers) {
    if (readers != null) {
      try {
```

### BoundedWildcard
Can generalize to `? extends HoodieMetadataLogRecordReader`
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieBackedTableMetadata.java`
#### Snippet
```java
  }

  private void closeReader(Pair<HoodieSeekingFileReader<?>, HoodieMetadataLogRecordReader> readers) {
    if (readers != null) {
      try {
```

### BoundedWildcard
Can generalize to `? super Long`
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieBackedTableMetadata.java`
#### Snippet
```java
                                                                                                             boolean fullKeys,
                                                                                                             Map<String, Option<HoodieRecord<HoodieMetadataPayload>>> logRecords,
                                                                                                             List<Long> timings,
                                                                                                             String partitionName) throws IOException {
    HoodieTimer timer = HoodieTimer.start();
```

### BoundedWildcard
Can generalize to `? extends HoodieRecord`
in `hudi-examples/hudi-examples-common/src/main/java/org/apache/hudi/examples/common/HoodieExampleDataGenerator.java`
#### Snippet
```java
  }

  public List<String> convertToStringList(List<HoodieRecord<T>> records) {
    return records.stream().map(this::convertToString).filter(Option::isPresent).map(Option::get)
        .collect(Collectors.toList());
```

### BoundedWildcard
Can generalize to `? super Integer`
in `hudi-examples/hudi-examples-common/src/main/java/org/apache/hudi/examples/common/HoodieExampleDataGenerator.java`
#### Snippet
```java
  }

  public HoodieExampleDataGenerator(String[] partitionPaths, Map<Integer, KeyPartition> keyPartitionMap) {
    this.partitionPaths = Arrays.copyOf(partitionPaths, partitionPaths.length);
    this.existingKeys = keyPartitionMap;
```

### BoundedWildcard
Can generalize to `? super String`
in `hudi-examples/hudi-examples-flink/src/main/java/org/apache/hudi/examples/quickstart/utils/QuickstartConfigurations.java`
#### Snippet
```java
      String tableName,
      List<String> fields,
      Map<String, String> options,
      boolean havePartition,
      String pkField,
```

### BoundedWildcard
Can generalize to `? super ArrayWritable`
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/SafeParquetRecordReaderWrapper.java`
#### Snippet
```java
  private final int numValueFields;

  public SafeParquetRecordReaderWrapper(RecordReader<NullWritable, ArrayWritable> parquetReader) {
    this.parquetReader = parquetReader;
    ArrayWritable arrayWritable = parquetReader.createValue();
```

### BoundedWildcard
Can generalize to `? extends HoodieVirtualKeyInfo`
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/utils/HoodieRealtimeInputFormatUtils.java`
#### Snippet
```java
  }

  public static void addRequiredProjectionFields(Configuration configuration, Option<HoodieVirtualKeyInfo> hoodieVirtualKeyInfo, Option<String> preCombineKeyOpt) {
    // Need this to do merge records in HoodieRealtimeRecordReader
    if (!hoodieVirtualKeyInfo.isPresent()) {
```

### BoundedWildcard
Can generalize to `? extends HoodieVirtualKeyInfo`
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/utils/HoodieRealtimeInputFormatUtils.java`
#### Snippet
```java
  }

  public static boolean requiredProjectionFieldsExistInConf(Configuration configuration, Option<HoodieVirtualKeyInfo> hoodieVirtualKeyInfo) {
    String readColNames = configuration.get(ColumnProjectionUtils.READ_COLUMN_NAMES_CONF_STR, "");
    if (!hoodieVirtualKeyInfo.isPresent()) {
```

### BoundedWildcard
Can generalize to `? extends Types.Field`
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/SchemaEvolutionContext.java`
#### Snippet
```java
  }

  public void setColumnTypeList(JobConf job, List<Types.Field> fields) {
    List<TypeInfo> fullTypeInfos = TypeInfoUtils.getTypeInfosFromTypeString(job.get(serdeConstants.LIST_COLUMN_TYPES));
    List<Integer> tmpColIdList = Arrays.stream(job.get(ColumnProjectionUtils.READ_COLUMN_IDS_CONF_STR).split(","))
```

### BoundedWildcard
Can generalize to `? extends Types.Field`
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/SchemaEvolutionContext.java`
#### Snippet
```java
  }

  private void setColumnNameList(JobConf job, List<Types.Field> fields) {
    if (fields == null) {
      return;
```

### BoundedWildcard
Can generalize to `? extends Field`
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/realtime/AbstractRealtimeRecordReader.java`
#### Snippet
```java
  }

  public Schema constructHiveOrderedSchema(Schema writerSchema, Map<String, Field> schemaFieldsMap, String hiveColumnString) {
    String[] hiveColumns = hiveColumnString.split(",");
    LOG.info("Hive Columns : " + hiveColumnString);
```

### BoundedWildcard
Can generalize to `? extends Schema.Field`
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/utils/HoodieRealtimeRecordReaderUtils.java`
#### Snippet
```java
   * Generate a reader schema off the provided writeSchema, to just project out the provided columns.
   */
  public static Schema generateProjectionSchema(Schema writeSchema, Map<String, Schema.Field> schemaFieldsMap,
                                                List<String> fieldNames) {
    /**
```

### BoundedWildcard
Can generalize to `? extends TypeInfo`
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/utils/HiveAvroSerializer.java`
#### Snippet
```java
  private static final Logger LOG = LogManager.getLogger(HiveAvroSerializer.class);

  public HiveAvroSerializer(ObjectInspector objectInspector, List<String> columnNames, List<TypeInfo> columnTypes) {
    this.columnNames = columnNames;
    this.columnTypes = columnTypes;
```

### BoundedWildcard
Can generalize to `? extends HoodieInstant`
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/utils/HoodieInputFormatUtils.java`
#### Snippet
```java
   */
  public static List<FileStatus> filterIncrementalFileStatus(Job job, HoodieTableMetaClient tableMetaClient,
      HoodieTimeline timeline, FileStatus[] fileStatuses, List<HoodieInstant> commitsToCheck) throws IOException {
    TableFileSystemView.BaseFileOnlyView roView = new HoodieTableFileSystemView(tableMetaClient, timeline, fileStatuses);
    List<String> commitsList = commitsToCheck.stream().map(HoodieInstant::getTimestamp).collect(Collectors.toList());
```

### BoundedWildcard
Can generalize to `? extends HoodieCommitMetadata`
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/utils/HoodieInputFormatUtils.java`
#### Snippet
```java
   * @return the partition path set
   */
  public static Set<String> getWritePartitionPaths(List<HoodieCommitMetadata> metadataList) {
    return metadataList.stream()
        .map(HoodieCommitMetadata::getWritePartitionPaths)
```

### BoundedWildcard
Can generalize to `? extends HoodieCommitMetadata`
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/utils/HoodieInputFormatUtils.java`
#### Snippet
```java
   * @return the affected file status array
   */
  public static FileStatus[] listAffectedFilesForCommits(Configuration hadoopConf, Path basePath, List<HoodieCommitMetadata> metadataList) {
    // TODO: Use HoodieMetaTable to extract affected file directly.
    HashMap<String, FileStatus> fullPathToFileStatus = new HashMap<>();
```

### BoundedWildcard
Can generalize to `? extends Path`
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/utils/HoodieInputFormatUtils.java`
#### Snippet
```java
   * @return partition path to table meta client mapping
   */
  public static Map<Path, HoodieTableMetaClient> getTableMetaClientByPartitionPath(Configuration conf, Set<Path> partitions) {
    Map<Path, HoodieTableMetaClient> metaClientMap = new HashMap<>();
    return partitions.stream().collect(Collectors.toMap(Function.identity(), p -> {
```

### BoundedWildcard
Can generalize to `? extends HoodieInstant`
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/utils/HoodieInputFormatUtils.java`
#### Snippet
```java
   * @throws IOException
   */
  public static Option<String> getAffectedPartitions(List<HoodieInstant> commitsToCheck,
                                      HoodieTableMetaClient tableMetaClient,
                                      HoodieTimeline timeline,
```

### BoundedWildcard
Can generalize to `? extends Path`
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/utils/HoodieInputFormatUtils.java`
#### Snippet
```java
                                      HoodieTableMetaClient tableMetaClient,
                                      HoodieTimeline timeline,
                                      List<Path> inputPaths) throws IOException {
    Set<String> partitionsToList = new HashSet<>();
    for (HoodieInstant commit : commitsToCheck) {
```

### BoundedWildcard
Can generalize to `? extends HoodieTableMetaClient`
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/utils/HoodieInputFormatUtils.java`
#### Snippet
```java
   */
  public static Map<HoodieTableMetaClient, List<FileStatus>> groupFileStatusForSnapshotPaths(
      FileStatus[] fileStatuses, String fileExtension, Collection<HoodieTableMetaClient> metaClientList) {
    // This assumes the paths for different tables are grouped together
    Map<HoodieTableMetaClient, List<FileStatus>> grouped = new HashMap<>();
```

### BoundedWildcard
Can generalize to `? extends HoodieTableMetaClient`
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/utils/HoodieInputFormatUtils.java`
#### Snippet
```java

  public static Map<HoodieTableMetaClient, List<Path>> groupSnapshotPathsByMetaClient(
      Collection<HoodieTableMetaClient> metaClientList,
      List<Path> snapshotPaths
  ) {
```

### BoundedWildcard
Can generalize to `? extends Path`
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/utils/HoodieInputFormatUtils.java`
#### Snippet
```java
  public static Map<HoodieTableMetaClient, List<Path>> groupSnapshotPathsByMetaClient(
      Collection<HoodieTableMetaClient> metaClientList,
      List<Path> snapshotPaths
  ) {
    Map<HoodieTableMetaClient, List<Path>> grouped = new HashMap<>();
```

### BoundedWildcard
Can generalize to `? extends HoodieAvroIndexedRecord`
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/realtime/RealtimeCompactedRecordReader.java`
#### Snippet
```java
  }

  private void setUpWritable(Option<HoodieAvroIndexedRecord> rec, ArrayWritable arrayWritable, String key) {
    GenericRecord recordToReturn = (GenericRecord) rec.get().getData();
    if (usesCustomPayload) {
```

### BoundedWildcard
Can generalize to `? extends RecordReader`
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/realtime/HoodieCombineRealtimeRecordReader.java`
#### Snippet
```java

  public HoodieCombineRealtimeRecordReader(JobConf jobConf, CombineFileSplit split,
      List<RecordReader> readers) {
    try {
      ValidationUtils.checkArgument(((HoodieCombineRealtimeFileSplit) split).getRealtimeFileSplits().size() == readers
```

### BoundedWildcard
Can generalize to `? extends HoodieTableMetaClient`
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieTableMetadataUtil.java`
#### Snippet
```java
   */
  public static int getPartitionFileGroupCount(final MetadataPartitionType partitionType,
                                               final Option<HoodieTableMetaClient> metaClient,
                                               final Option<HoodieTableFileSystemView> fsView,
                                               final HoodieMetadataConfig metadataConfig, boolean isBootstrapCompleted) {
```

### BoundedWildcard
Can generalize to `? extends Map`
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieTableMetadataUtil.java`
#### Snippet
```java
   */
  private static List<HoodieRecord> convertFilesToFilesPartitionRecords(Map<String, List<String>> partitionToDeletedFiles,
                                                                        Map<String, Map<String, Long>> partitionToAppendedFiles,
                                                                        String instantTime, String operation) {
    List<HoodieRecord> records = new LinkedList<>();
```

### BoundedWildcard
Can generalize to `? extends Schema.Field`
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieTableMetadataUtil.java`
#### Snippet
```java
   */
  public static Map<String, HoodieColumnRangeMetadata<Comparable>> collectColumnRangeMetadata(List<IndexedRecord> records,
                                                                                              List<Schema.Field> targetFields,
                                                                                              String filePath) {
    // Helper class to calculate column stats
```

### BoundedWildcard
Can generalize to `? extends CombineFileSplit`
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/hive/HoodieCombineHiveInputFormat.java`
#### Snippet
```java
   * @return the sampled splits
   */
  private List<CombineFileSplit> sampleSplits(List<CombineFileSplit> splits) {
    HashMap<String, SplitSample> nameToSamples = mrwork.getNameToSplitSample();
    List<CombineFileSplit> retLists = new ArrayList<>();
```

### BoundedWildcard
Can generalize to `? super CombineFileSplit`
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/hive/HoodieCombineHiveInputFormat.java`
#### Snippet
```java
  }

  private void processPaths(JobConf job, CombineFileInputFormatShim combine, List<CombineFileSplit> iss, Path... path)
      throws IOException {
    JobConf currJob = new JobConf(job);
```

### BoundedWildcard
Can generalize to `? extends FileSplit`
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/realtime/HoodieMergeOnReadTableInputFormat.java`
#### Snippet
```java
  }

  private static List<FileSplit> filterIncrementalQueryFileSplits(List<FileSplit> fileSplits) {
    return fileSplits.stream().filter(HoodieRealtimeInputFormatUtils::doesBelongToIncrementalQuery)
        .collect(Collectors.toList());
```

### BoundedWildcard
Can generalize to `? extends HoodieLogFile`
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/realtime/HoodieMergeOnReadTableInputFormat.java`
#### Snippet
```java
   */
  private static RealtimeFileStatus createRealtimeFileStatusUnchecked(HoodieLogFile latestLogFile,
                                                                      Stream<HoodieLogFile> logFiles,
                                                                      String basePath,
                                                                      Option<HoodieInstant> latestCompletedInstantOpt,
```

### BoundedWildcard
Can generalize to `? extends HoodieInstant`
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/realtime/HoodieMergeOnReadTableInputFormat.java`
#### Snippet
```java
                                                                      Stream<HoodieLogFile> logFiles,
                                                                      String basePath,
                                                                      Option<HoodieInstant> latestCompletedInstantOpt,
                                                                      Option<HoodieVirtualKeyInfo> virtualKeyInfoOpt) {
    List<HoodieLogFile> sortedLogFiles = logFiles.sorted(HoodieLogFile.getLogFileComparator()).collect(Collectors.toList());
```

### BoundedWildcard
Can generalize to `? extends HoodieLogFile`
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/realtime/HoodieMergeOnReadTableInputFormat.java`
#### Snippet
```java
   */
  private static RealtimeFileStatus createRealtimeFileStatusUnchecked(HoodieBaseFile baseFile,
                                                                      Stream<HoodieLogFile> logFiles,
                                                                      String basePath,
                                                                      Option<HoodieInstant> latestCompletedInstantOpt,
```

### BoundedWildcard
Can generalize to `? extends HoodieInstant`
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/realtime/HoodieMergeOnReadTableInputFormat.java`
#### Snippet
```java
                                                                      Stream<HoodieLogFile> logFiles,
                                                                      String basePath,
                                                                      Option<HoodieInstant> latestCompletedInstantOpt,
                                                                      Option<HoodieVirtualKeyInfo> virtualKeyInfoOpt) {
    FileStatus baseFileStatus = getFileStatusUnchecked(baseFile);
```

### BoundedWildcard
Can generalize to `? extends FileSplit`
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/realtime/HoodieMergeOnReadTableInputFormat.java`
#### Snippet
```java
  }

  private static boolean containsIncrementalQuerySplits(List<FileSplit> fileSplits) {
    return fileSplits.stream().anyMatch(HoodieRealtimeInputFormatUtils::doesBelongToIncrementalQuery);
  }
```

### BoundedWildcard
Can generalize to `? extends HoodieFileGroup`
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/realtime/HoodieMergeOnReadTableInputFormat.java`
#### Snippet
```java
  }

  private static List<FileStatus> collectAllIncrementalFiles(List<HoodieFileGroup> fileGroups,
                                                             String maxCommitTime,
                                                             String basePath,
```

### BoundedWildcard
Can generalize to `? extends FileStatus`
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/realtime/HoodieMergeOnReadTableInputFormat.java`
#### Snippet
```java
                                                             String maxCommitTime,
                                                             String basePath,
                                                             Map<String, FileStatus> candidateFileStatus,
                                                             Option<HoodieVirtualKeyInfo> virtualKeyInfoOpt) {

```

### BoundedWildcard
Can generalize to `? extends SchemaPostProcessor`
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/schema/SchemaProviderWithPostProcessor.java`
#### Snippet
```java

  public SchemaProviderWithPostProcessor(SchemaProvider schemaProvider,
      Option<SchemaPostProcessor> schemaPostProcessor) {
    super(null, null);
    this.schemaProvider = schemaProvider;
```

### BoundedWildcard
Can generalize to `? extends SchemaPostProcessor`
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/schema/postprocessor/ChainedSchemaPostProcessor.java`
#### Snippet
```java
  }

  public ChainedSchemaPostProcessor(TypedProperties props, JavaSparkContext jssc, List<SchemaPostProcessor> processors) {
    super(props, jssc);
    this.processors = processors;
```

### BoundedWildcard
Can generalize to `? extends WriteStatus`
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/UtilHelpers.java`
#### Snippet
```java
  }

  public static int handleErrors(JavaSparkContext jsc, String instantTime, JavaRDD<WriteStatus> writeResponse) {
    LongAccumulator errors = jsc.sc().longAccumulator();
    writeResponse.foreach(writeStatus -> {
```

### BoundedWildcard
Can generalize to `? extends FileSlice`
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieMetadataTableValidator.java`
#### Snippet
```java

  private void validateFileSlices(
      List<FileSlice> fileSliceListFromMetadataTable, List<FileSlice> fileSliceListFromFS,
      String partitionPath, HoodieTableMetaClient metaClient, String label) {
    boolean mismatch = false;
```

### BoundedWildcard
Can generalize to `? extends FileSlice`
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieMetadataTableValidator.java`
#### Snippet
```java

  private void validateFileSlices(
      List<FileSlice> fileSliceListFromMetadataTable, List<FileSlice> fileSliceListFromFS,
      String partitionPath, HoodieTableMetaClient metaClient, String label) {
    boolean mismatch = false;
```

### BoundedWildcard
Can generalize to `? extends HoodieBaseFile`
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieMetadataTableValidator.java`
#### Snippet
```java
  }

  private List<HoodieBaseFile> filterBaseFileBasedOnInflightCleaning(List<HoodieBaseFile> sortedBaseFileList, Set<String> baseDataFilesForCleaning) {
    return sortedBaseFileList.stream()
        .filter(baseFile -> {
```

### BoundedWildcard
Can generalize to `? super String`
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieMetadataTableValidator.java`
#### Snippet
```java
      Set<String> logFilePathSet,
      HoodieTableMetaClient metaClient,
      Map<String, Set<String>> committedFilesMap) {
    if (logFilePathSet.isEmpty()) {
      return false;
```

### BoundedWildcard
Can generalize to `? extends FileSlice`
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieMetadataTableValidator.java`
#### Snippet
```java
  }

  private List<FileSlice> filterFileSliceBasedOnInflightCleaning(List<FileSlice> sortedLatestFileSliceList, Set<String> baseDataFilesForCleaning) {
    return sortedLatestFileSliceList.stream()
        .filter(fileSlice -> {
```

### BoundedWildcard
Can generalize to `? extends Message`
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/helpers/CloudObjectsSelector.java`
#### Snippet
```java
   * Delete batch of messages from queue.
   */
  protected void deleteBatchOfMessages(AmazonSQS sqs, String queueUrl, List<Message> messagesToBeDeleted) {
    DeleteMessageBatchRequest deleteBatchReq =
        new DeleteMessageBatchRequest().withQueueUrl(queueUrl);
```

### BoundedWildcard
Can generalize to `? extends Message`
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/helpers/CloudObjectsSelector.java`
#### Snippet
```java
   * functionality, due to https://github.com/apache/hudi/blob/master/style/checkstyle.xml#L270
   */
  protected List<List<Message>> createListPartitions(List<Message> singleList, int eachBatchSize) {
    List<List<Message>> listPartitions = new ArrayList<>();
    if (singleList.size() == 0 || eachBatchSize < 1) {
```

### BoundedWildcard
Can generalize to `? super Message`
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/helpers/S3EventsMetaSelector.java`
#### Snippet
```java
  }

  private List<Map<String, Object>> processAndDeleteInvalidMessages(List<Message> processedMessages,
                                                                    List<Message> messages) throws IOException {
    List<Map<String, Object>> validEvents = new ArrayList<>();
```

### BoundedWildcard
Can generalize to `? extends Message`
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/helpers/S3EventsMetaSelector.java`
#### Snippet
```java

  private List<Map<String, Object>> processAndDeleteInvalidMessages(List<Message> processedMessages,
                                                                    List<Message> messages) throws IOException {
    List<Map<String, Object>> validEvents = new ArrayList<>();
    for (Message message : messages) {
```

### BoundedWildcard
Can generalize to `? extends JsonKafkaSourcePostProcessor`
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/processor/ChainedJsonKafkaSourcePostProcessor.java`
#### Snippet
```java
  private final List<JsonKafkaSourcePostProcessor> processors;

  public ChainedJsonKafkaSourcePostProcessor(List<JsonKafkaSourcePostProcessor> processors, TypedProperties props) {
    super(props);
    this.processors = processors;
```

### BoundedWildcard
Can generalize to `? extends PartitionInfo`
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/helpers/KafkaOffsetGen.java`
#### Snippet
```java
   * @return
   */
  private Option<String> getOffsetsByTimestamp(KafkaConsumer consumer, List<PartitionInfo> partitionInfoList, Set<TopicPartition> topicPartitions,
                                               String topicName, Long timestamp) {

```

### BoundedWildcard
Can generalize to `? extends Transformer`
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/transform/ChainedTransformer.java`
#### Snippet
```java
  private List<Transformer> transformers;

  public ChainedTransformer(List<Transformer> transformers) {
    this.transformers = transformers;
  }
```

### BoundedWildcard
Can generalize to `? extends WriteStatus`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/StreamWriteOperatorCoordinator.java`
#### Snippet
```java
   */
  @SuppressWarnings("unchecked")
  private void doCommit(String instant, List<WriteStatus> writeResults) {
    // commit or rollback
    long totalErrorRecords = writeResults.stream().map(WriteStatus::getTotalErrorRecords).reduce(Long::sum).orElse(0L);
```

### BoundedWildcard
Can generalize to `? extends TimestampBasedAvroKeyGenerator`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/bulk/RowDataKeyGen.java`
#### Snippet
```java
      boolean hiveStylePartitioning,
      boolean encodePartitionPath,
      Option<TimestampBasedAvroKeyGenerator> keyGenOpt) {
    if (keyGenOpt.isPresent()) {
      TimestampBasedAvroKeyGenerator keyGenerator = keyGenOpt.get();
```

### BoundedWildcard
Can generalize to `? extends WriteStatus`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/event/WriteMetadataEvent.java`
#### Snippet
```java
      int taskID,
      String instantTime,
      List<WriteStatus> writeStatuses,
      boolean lastBatch,
      boolean endInput,
```

### BoundedWildcard
Can generalize to `? super String`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/bucket/BucketBulkInsertWriterHelper.java`
#### Snippet
```java
  }

  private static String getFileId(Map<String, String> bucketIdToFileId, RowDataKeyGen keyGen, RowData record, String indexKeys, int numBuckets) {
    String recordKey = keyGen.getRecordKey(record);
    String partition = keyGen.getPartitionPath(record);
```

### BoundedWildcard
Can generalize to `? extends HoodieTimeline`
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/DeltaSync.java`
#### Snippet
```java
  }

  private Option<String> getLastPendingClusteringInstant(Option<HoodieTimeline> commitTimelineOpt) {
    if (commitTimelineOpt.isPresent()) {
      Option<HoodieInstant> pendingClusteringInstant = commitTimelineOpt.get().filterPendingReplaceTimeline().lastInstant();
```

### BoundedWildcard
Can generalize to `? super SparkRDDWriteClient`
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/DeltaSync.java`
#### Snippet
```java
  public DeltaSync(HoodieDeltaStreamer.Config cfg, SparkSession sparkSession, SchemaProvider schemaProvider,
                   TypedProperties props, JavaSparkContext jssc, FileSystem fs, Configuration conf,
                   Function<SparkRDDWriteClient, Boolean> onInitializingHoodieWriteClient) throws IOException {

    this.cfg = cfg;
```

### BoundedWildcard
Can generalize to `? extends HoodieTimeline`
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/DeltaSync.java`
#### Snippet
```java
   * @throws IOException
   */
  private Option<String> getCheckpointToResume(Option<HoodieTimeline> commitTimelineOpt) throws IOException {
    Option<String> resumeCheckpointStr = Option.empty();
    Option<HoodieInstant> lastCommit = commitTimelineOpt.get().lastInstant();
```

### BoundedWildcard
Can generalize to `? super CompactionCommitEvent`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/compact/CompactOperator.java`
#### Snippet
```java
  private void doCompaction(String instantTime,
                            CompactionOperation compactionOperation,
                            Collector<CompactionCommitEvent> collector,
                            HoodieWriteConfig writeConfig) throws IOException {
    HoodieFlinkMergeOnReadTableCompactor<?> compactor = new HoodieFlinkMergeOnReadTableCompactor<>();
```

### BoundedWildcard
Can generalize to `? extends CompactionCommitEvent`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/compact/CompactionCommitSink.java`
#### Snippet
```java

  @SuppressWarnings("unchecked")
  private void doCommit(String instant, Collection<CompactionCommitEvent> events) throws IOException {
    List<WriteStatus> statuses = events.stream()
        .map(CompactionCommitEvent::getWriteStatuses)
```

### BoundedWildcard
Can generalize to `? extends Transformer`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/transform/ChainedTransformer.java`
#### Snippet
```java
  private List<Transformer> transformers;

  public ChainedTransformer(List<Transformer> transformers) {
    this.transformers = transformers;
  }
```

### BoundedWildcard
Can generalize to `? extends ClusteringCommitEvent`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/clustering/ClusteringCommitSink.java`
#### Snippet
```java
  }

  private void doCommit(String instant, HoodieClusteringPlan clusteringPlan, List<ClusteringCommitEvent> events) {
    List<WriteStatus> statuses = events.stream()
        .map(ClusteringCommitEvent::getWriteStatuses)
```

### BoundedWildcard
Can generalize to `? super O`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/partitioner/BucketAssignFunction.java`
#### Snippet
```java

  @SuppressWarnings("unchecked")
  private void processRecord(HoodieRecord<?> record, Collector<O> out) throws Exception {
    // 1. put the record into the BucketAssigner;
    // 2. look up the state for location, if the record has a location, just send it out;
```

### BoundedWildcard
Can generalize to `? extends HoodieInstant`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/partitioner/profile/WriteProfile.java`
#### Snippet
```java
   * whose instant does not belong to the given instants {@code instants}.
   */
  private void cleanMetadataCache(Stream<HoodieInstant> instants) {
    Set<String> timestampSet = instants.map(HoodieInstant::getTimestamp).collect(Collectors.toSet());
    this.metadataCache.keySet().retainAll(timestampSet);
```

### BoundedWildcard
Can generalize to `? extends HoodieLogFile`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/partitioner/profile/DeltaWriteProfile.java`
#### Snippet
```java

  // TODO (NA) : Make this static part of utility
  public long convertLogFilesSizeToExpectedParquetSize(List<HoodieLogFile> hoodieLogFiles) {
    long totalSizeOfLogFiles = hoodieLogFiles.stream().map(HoodieLogFile::getFileSize)
        .filter(size -> size > 0).reduce(Long::sum).orElse(0L);
```

### BoundedWildcard
Can generalize to `? extends SmallFile`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/partitioner/BucketAssigner.java`
#### Snippet
```java

  @VisibleForTesting
  public List<SmallFile> smallFilesOfThisTask(List<SmallFile> smallFiles) {
    // computes the small files to write inserts for this task.
    return smallFiles.stream()
```

### BoundedWildcard
Can generalize to `? extends HoodieCommitMetadata`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/partitioner/profile/WriteProfiles.java`
#### Snippet
```java
      Path basePath,
      Configuration hadoopConf,
      List<HoodieCommitMetadata> metadataList,
      HoodieTableType tableType) {
    FileSystem fs = FSUtils.getFs(basePath.toString(), hadoopConf);
```

### BoundedWildcard
Can generalize to `? extends HoodieCommitMetadata`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/partitioner/profile/WriteProfiles.java`
#### Snippet
```java
      Path basePath,
      Configuration hadoopConf,
      List<HoodieCommitMetadata> metadataList,
      HoodieTableType tableType) {
    Map<String, FileStatus> uniqueIdToFileStatus = new HashMap<>();
```

### BoundedWildcard
Can generalize to `? extends ClusteringOperation`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/clustering/ClusteringOperator.java`
#### Snippet
```java
   */
  @SuppressWarnings("unchecked")
  private Iterator<RowData> readRecordsForGroupWithLogs(List<ClusteringOperation> clusteringOps, String instantTime) {
    List<Iterator<RowData>> recordIterators = new ArrayList<>();

```

### BoundedWildcard
Can generalize to `? extends ClusteringOperation`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/clustering/ClusteringOperator.java`
#### Snippet
```java
   * Read records from baseFiles and get iterator.
   */
  private Iterator<RowData> readRecordsForGroupBaseFiles(List<ClusteringOperation> clusteringOps) {
    List<Iterator<RowData>> iteratorsForPartition = clusteringOps.stream().map(clusteringOp -> {
      Iterable<IndexedRecord> indexedRecords = () -> {
```

### BoundedWildcard
Can generalize to `? extends ResolvedExpression`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/util/ExpressionUtils.java`
#### Snippet
```java
   * only simple call expression is supported.
   */
  public static String[] referencedColumns(List<ResolvedExpression> exprs) {
    return exprs.stream()
        .map(ExpressionUtils::getReferencedColumns)
```

### BoundedWildcard
Can generalize to `? extends Expression`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/util/ExpressionUtils.java`
#### Snippet
```java
  }

  private static boolean isFieldReferenceAndLiteral(List<Expression> exprs) {
    if (exprs.size() != 2) {
      return false;
```

### BoundedWildcard
Can generalize to `? extends RowData`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/SchemaEvolvedRecordIterator.java`
#### Snippet
```java
  private final RowDataProjection castProjection;

  public SchemaEvolvedRecordIterator(ClosableIterator<RowData> nested, RowDataProjection castProjection) {
    this.nested = nested;
    this.castProjection = castProjection;
```

### BoundedWildcard
Can generalize to `? extends Schema`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/util/AvroSchemaConverter.java`
#### Snippet
```java
   * Returns true if all the types are RECORD type with same number of fields.
   */
  private static boolean recordTypesOfSameNumFields(List<Schema> types) {
    if (types == null || types.size() == 0) {
      return false;
```

### BoundedWildcard
Can generalize to `? super FileStatus`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/cow/CopyOnWriteInputFormat.java`
#### Snippet
```java
   * @return the total length of accepted files.
   */
  private long addFilesInDir(org.apache.hadoop.fs.Path path, List<FileStatus> files, boolean logExcludedFiles)
      throws IOException {
    final org.apache.hadoop.fs.Path hadoopPath = new org.apache.hadoop.fs.Path(path.toUri());
```

### BoundedWildcard
Can generalize to `? extends Map`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/FilePathUtils.java`
#### Snippet
```java
  public static Set<String> toRelativePartitionPaths(
      List<String> partitionKeys,
      List<Map<String, String>> partitionPaths,
      boolean hivePartition) {
    return partitionPaths.stream()
```

### BoundedWildcard
Can generalize to `? extends Map`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/FilePathUtils.java`
#### Snippet
```java
      Path path,
      List<String> partitionKeys,
      List<Map<String, String>> partitionPaths,
      boolean hivePartition) {
    return partitionPaths.stream()
```

### BoundedWildcard
Can generalize to `? super FileStatus`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/FilePathUtils.java`
#### Snippet
```java
      int level,
      int expectLevel,
      List<FileStatus> results) throws IOException {
    if (expectLevel == level && !isHiddenFile(fileStatus)) {
      results.add(fileStatus);
```

### BoundedWildcard
Can generalize to `? super MergeOnReadInputSplit`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/cdc/CdcInputFormat.java`
#### Snippet
```java
        long maxCompactionMemoryInBytes,
        HoodieCDCFileSplit fileSplit,
        Function<MergeOnReadInputSplit, ClosableIterator<RowData>> splitIteratorFunc) {
      // init before images

```

### BoundedWildcard
Can generalize to `? extends ClosableIterator`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/cdc/CdcInputFormat.java`
#### Snippet
```java
        long maxCompactionMemoryInBytes,
        HoodieCDCFileSplit fileSplit,
        Function<MergeOnReadInputSplit, ClosableIterator<RowData>> splitIteratorFunc) {
      // init before images

```

### BoundedWildcard
Can generalize to `? extends RowData`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/cdc/CdcInputFormat.java`
#### Snippet
```java
    private final RowDataProjection projection;

    RemoveBaseFileIterator(MergeOnReadTableState tableState, ClosableIterator<RowData> iterator) {
      this.nested = iterator;
      this.projection = RowDataProjection.instance(tableState.getRequiredRowType(), tableState.getRequiredPositions());
```

### BoundedWildcard
Can generalize to `? super HoodieCDCFileSplit`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/cdc/CdcInputFormat.java`
#### Snippet
```java
        CdcInputSplit inputSplit,
        ImageManager imageManager,
        Function<HoodieCDCFileSplit, ClosableIterator<RowData>> recordIteratorFunc) {
      this.fileSplitIterator = Arrays.asList(inputSplit.getChanges()).iterator();
      this.imageManager = imageManager;
```

### BoundedWildcard
Can generalize to `? extends ClosableIterator`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/cdc/CdcInputFormat.java`
#### Snippet
```java
        CdcInputSplit inputSplit,
        ImageManager imageManager,
        Function<HoodieCDCFileSplit, ClosableIterator<RowData>> recordIteratorFunc) {
      this.fileSplitIterator = Arrays.asList(inputSplit.getChanges()).iterator();
      this.imageManager = imageManager;
```

### BoundedWildcard
Can generalize to `? extends RowData`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/cdc/CdcInputFormat.java`
#### Snippet
```java
    private RowData currentRecord;

    AddBaseFileIterator(ClosableIterator<RowData> nested) {
      this.nested = nested;
    }
```

### BoundedWildcard
Can generalize to `? super MergeOnReadInputSplit`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/cdc/CdcInputFormat.java`
#### Snippet
```java
        Configuration flinkConf,
        RowType rowType,
        Function<MergeOnReadInputSplit, ClosableIterator<RowData>> splitIteratorFunc) {
      this.serializer = new RowDataSerializer(rowType);
      this.splitIteratorFunc = splitIteratorFunc;
```

### BoundedWildcard
Can generalize to `? extends ClosableIterator`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/cdc/CdcInputFormat.java`
#### Snippet
```java
        Configuration flinkConf,
        RowType rowType,
        Function<MergeOnReadInputSplit, ClosableIterator<RowData>> splitIteratorFunc) {
      this.serializer = new RowDataSerializer(rowType);
      this.splitIteratorFunc = splitIteratorFunc;
```

### BoundedWildcard
Can generalize to `? extends FieldSchema`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/catalog/HiveSchemaUtils.java`
#### Snippet
```java
   */
  public static Pair<List<FieldSchema>, List<FieldSchema>> splitSchemaByPartitionKeys(
      List<FieldSchema> fieldSchemas,
      List<String> partitionKeys) {
    List<FieldSchema> regularColumns = new ArrayList<>();
```

### BoundedWildcard
Can generalize to `? extends FieldSchema`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/catalog/HiveSchemaUtils.java`
#### Snippet
```java
   * Get field names from field schemas.
   */
  public static List<String> getFieldNames(List<FieldSchema> fieldSchemas) {
    return fieldSchemas.stream().map(FieldSchema::getName).collect(Collectors.toList());
  }
```

### BoundedWildcard
Can generalize to `? super MergeOnReadInputSplit`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/source/StreamReadMonitoringFunction.java`
#### Snippet
```java

  @VisibleForTesting
  public void monitorDirAndForwardSplits(SourceContext<MergeOnReadInputSplit> context) {
    HoodieTableMetaClient metaClient = getOrCreateMetaClient();
    if (metaClient == null) {
```

### BoundedWildcard
Can generalize to `? extends RowDataProjection`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/mor/MergeOnReadInputFormat.java`
#### Snippet
```java
        Schema tableSchema,
        InternalSchema querySchema,
        Option<RowDataProjection> projection,
        Option<Function<IndexedRecord, GenericRecord>> avroProjection,
        boolean emitDelete,
```

### BoundedWildcard
Can generalize to `? extends Function`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/mor/MergeOnReadInputFormat.java`
#### Snippet
```java
        InternalSchema querySchema,
        Option<RowDataProjection> projection,
        Option<Function<IndexedRecord, GenericRecord>> avroProjection,
        boolean emitDelete,
        int operationPos,
```

### BoundedWildcard
Can generalize to `? extends RowData`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/mor/MergeOnReadInputFormat.java`
#### Snippet
```java
        boolean emitDelete,
        int operationPos,
        ClosableIterator<RowData> nested) { // the iterator should be with full schema
      this.tableSchema = tableSchema;
      this.nested = nested;
```

### BoundedWildcard
Can generalize to `? extends RowData`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/mor/MergeOnReadInputFormat.java`
#### Snippet
```java
    private final ClosableIterator<RowData> iterator;

    public LogFileOnlyIterator(ClosableIterator<RowData> iterator) {
      this.iterator = iterator;
    }
```

### BoundedWildcard
Can generalize to `? extends RowData`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/mor/MergeOnReadInputFormat.java`
#### Snippet
```java
        InstantRange instantRange,
        RowType requiredRowType,
        ClosableIterator<RowData> nested) {
      this.nested = nested;
      this.instantRange = instantRange;
```

### BoundedWildcard
Can generalize to `? extends RowData`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/mor/MergeOnReadInputFormat.java`
#### Snippet
```java
    private RowData currentRecord;

    SkipMergeIterator(ClosableIterator<RowData> nested, ClosableIterator<RowData> iterator) {
      this.nested = nested;
      this.iterator = iterator;
```

### BoundedWildcard
Can generalize to `? extends RowData`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/mor/MergeOnReadInputFormat.java`
#### Snippet
```java
    private RowData currentRecord;

    SkipMergeIterator(ClosableIterator<RowData> nested, ClosableIterator<RowData> iterator) {
      this.nested = nested;
      this.iterator = iterator;
```

### BoundedWildcard
Can generalize to `? extends DataType`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/mor/MergeOnReadInputFormat.java`
#### Snippet
```java
      Configuration conf,
      MergeOnReadTableState tableState,
      List<DataType> fieldTypes,
      String defaultPartName,
      long limit,
```

### BoundedWildcard
Can generalize to `? extends ResolvedExpression`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/source/stats/ExpressionEvaluator.java`
#### Snippet
```java
   * @return true if the index row should be considered as a candidate
   */
  public static boolean filterExprs(List<ResolvedExpression> filters, RowData indexRow, RowType.RowField[] queryFields) {
    for (ResolvedExpression filter : filters) {
      if (!Evaluator.bindCall((CallExpression) filter, indexRow, queryFields).eval()) {
```

### BoundedWildcard
Can generalize to `? extends ResolvedExpression`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/source/FileIndex.java`
#### Snippet
```java
   * Sets up pushed down filters.
   */
  public void setFilters(List<ResolvedExpression> filters) {
    if (filters.size() > 0) {
      this.filters = new ArrayList<>(filters);
```

### BoundedWildcard
Can generalize to `? extends ColumnReader`
in `hudi-flink-datasource/hudi-flink1.13.x/src/main/java/org/apache/hudi/table/format/cow/vector/reader/RowColumnReader.java`
#### Snippet
```java
  private final List<ColumnReader> fieldReaders;

  public RowColumnReader(List<ColumnReader> fieldReaders) {
    this.fieldReaders = fieldReaders;
  }
```

### BoundedWildcard
Can generalize to `? super LogicalType`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/source/stats/ColumnStatsIndices.java`
#### Snippet
```java
      Object rawVal,
      LogicalType logicalType,
      Map<LogicalType, AvroToRowDataConverters.AvroToRowDataConverter> converters) {
    AvroToRowDataConverters.AvroToRowDataConverter converter =
        converters.computeIfAbsent(logicalType, k -> AvroToRowDataConverters.createConverter(logicalType));
```

### BoundedWildcard
Can generalize to `? extends List`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/source/stats/ColumnStatsIndices.java`
#### Snippet
```java
  private static List<RowData> foldRowsByFiles(
      TreeSet<String> sortedTargetColumns,
      Map<StringData, List<RowData>> fileNameToRows) {
    return fileNameToRows.values().stream().parallel().map(rows -> {
      // Rows seq is always non-empty (otherwise it won't be grouped into)
```

### BoundedWildcard
Can generalize to `? extends RowData`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/source/stats/ColumnStatsIndices.java`
#### Snippet
```java
   * @return reshaped table according to the format outlined above
   */
  public static Pair<List<RowData>, String[]> transposeColumnStatsIndex(List<RowData> colStats, String[] queryColumns, RowType tableSchema) {

    Map<String, LogicalType> tableFieldTypeMap = tableSchema.getFields().stream()
```

### BoundedWildcard
Can generalize to `? extends T`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/source/IncrementalInputSplits.java`
#### Snippet
```java
  }

  private static <T> List<T> mergeList(List<T> list1, List<T> list2) {
    List<T> merged = new ArrayList<>(list1);
    merged.addAll(list2);
```

### BoundedWildcard
Can generalize to `? extends T`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/source/IncrementalInputSplits.java`
#### Snippet
```java
  }

  private static <T> List<T> mergeList(List<T> list1, List<T> list2) {
    List<T> merged = new ArrayList<>(list1);
    merged.addAll(list2);
```

### BoundedWildcard
Can generalize to `? extends ColumnReader`
in `hudi-flink-datasource/hudi-flink1.14.x/src/main/java/org/apache/hudi/table/format/cow/vector/reader/RowColumnReader.java`
#### Snippet
```java
  private final List<ColumnReader> fieldReaders;

  public RowColumnReader(List<ColumnReader> fieldReaders) {
    this.fieldReaders = fieldReaders;
  }
```

### BoundedWildcard
Can generalize to `? extends ColumnReader`
in `hudi-flink-datasource/hudi-flink1.15.x/src/main/java/org/apache/hudi/table/format/cow/vector/reader/RowColumnReader.java`
#### Snippet
```java
  private final List<ColumnReader> fieldReaders;

  public RowColumnReader(List<ColumnReader> fieldReaders) {
    this.fieldReaders = fieldReaders;
  }
```

### BoundedWildcard
Can generalize to `? extends ColumnDescriptor`
in `hudi-flink-datasource/hudi-flink1.13.x/src/main/java/org/apache/hudi/table/format/cow/ParquetSplitReaderUtil.java`
#### Snippet
```java
  }

  private static List<ColumnDescriptor> filterDescriptors(int depth, Type type, List<ColumnDescriptor> columns) throws ParquetRuntimeException {
    List<ColumnDescriptor> filtered = new ArrayList<>();
    for (ColumnDescriptor descriptor : columns) {
```

### BoundedWildcard
Can generalize to `? extends ColumnReader`
in `hudi-flink-datasource/hudi-flink1.16.x/src/main/java/org/apache/hudi/table/format/cow/vector/reader/RowColumnReader.java`
#### Snippet
```java
  private final List<ColumnReader> fieldReaders;

  public RowColumnReader(List<ColumnReader> fieldReaders) {
    this.fieldReaders = fieldReaders;
  }
```

### BoundedWildcard
Can generalize to `? extends ColumnDescriptor`
in `hudi-flink-datasource/hudi-flink1.14.x/src/main/java/org/apache/hudi/table/format/cow/ParquetSplitReaderUtil.java`
#### Snippet
```java
  }

  private static List<ColumnDescriptor> filterDescriptors(int depth, Type type, List<ColumnDescriptor> columns) throws ParquetRuntimeException {
    List<ColumnDescriptor> filtered = new ArrayList<>();
    for (ColumnDescriptor descriptor : columns) {
```

### BoundedWildcard
Can generalize to `? extends ColumnDescriptor`
in `hudi-flink-datasource/hudi-flink1.15.x/src/main/java/org/apache/hudi/table/format/cow/ParquetSplitReaderUtil.java`
#### Snippet
```java
  }

  private static List<ColumnDescriptor> filterDescriptors(int depth, Type type, List<ColumnDescriptor> columns) throws ParquetRuntimeException {
    List<ColumnDescriptor> filtered = new ArrayList<>();
    for (ColumnDescriptor descriptor : columns) {
```

### BoundedWildcard
Can generalize to `? extends WriteStatus`
in `hudi-spark-datasource/hudi-spark/src/main/java/org/apache/hudi/cli/HDFSParquetImporterUtils.java`
#### Snippet
```java
  }

  public static int handleErrors(JavaSparkContext jsc, String instantTime, JavaRDD<WriteStatus> writeResponse) {
    LongAccumulator errors = jsc.sc().longAccumulator();
    writeResponse.foreach(writeStatus -> {
```

### BoundedWildcard
Can generalize to `? extends Row`
in `hudi-spark-datasource/hudi-spark/src/main/java/org/apache/hudi/QuickstartUtils.java`
#### Snippet
```java
     * @return list of hoodie records to delete
     */
    public List<String> generateDeletes(List<Row> rows) {
      // if row.length() == 2, then the record contains "uuid" and "partitionpath" fields, otherwise,
      // another field "ts" is available
```

### BoundedWildcard
Can generalize to `? super Integer`
in `hudi-spark-datasource/hudi-spark/src/main/java/org/apache/hudi/QuickstartUtils.java`
#### Snippet
```java
    }

    private DataGenerator(String[] partitionPaths, Map<Integer, HoodieKey> keyPartitionMap) {
      this.partitionPaths = Arrays.copyOf(partitionPaths, partitionPaths.length);
      this.existingKeys = keyPartitionMap;
```

### BoundedWildcard
Can generalize to `? extends HoodieRecord`
in `hudi-spark-datasource/hudi-spark/src/main/java/org/apache/hudi/QuickstartUtils.java`
#### Snippet
```java
  }

  public static List<String> convertToStringList(List<HoodieRecord> records) {
    return records.stream().map(hr -> convertToString(hr)).filter(os -> os.isPresent()).map(os -> os.get())
        .collect(Collectors.toList());
```

### BoundedWildcard
Can generalize to `? extends ColumnDescriptor`
in `hudi-flink-datasource/hudi-flink1.16.x/src/main/java/org/apache/hudi/table/format/cow/ParquetSplitReaderUtil.java`
#### Snippet
```java
  }

  private static List<ColumnDescriptor> filterDescriptors(int depth, Type type, List<ColumnDescriptor> columns) throws ParquetRuntimeException {
    List<ColumnDescriptor> filtered = new ArrayList<>();
    for (ColumnDescriptor descriptor : columns) {
```

### BoundedWildcard
Can generalize to `? extends BatchedMarkerCreationContext`
in `hudi-timeline-service/src/main/java/org/apache/hudi/timeline/service/handlers/marker/BatchedMarkerCreationRunnable.java`
#### Snippet
```java
  private final List<BatchedMarkerCreationContext> requestContextList;

  public BatchedMarkerCreationRunnable(List<BatchedMarkerCreationContext> requestContextList) {
    this.requestContextList = requestContextList;
  }
```

### BoundedWildcard
Can generalize to `? extends MarkerCreationFuture`
in `hudi-timeline-service/src/main/java/org/apache/hudi/timeline/service/handlers/marker/MarkerDirState.java`
#### Snippet
```java
   */
  public void processMarkerCreationRequests(
      final List<MarkerCreationFuture> pendingMarkerCreationFutures, int fileIndex) {
    if (pendingMarkerCreationFutures.isEmpty()) {
      markFileAsAvailable(fileIndex);
```

### BoundedWildcard
Can generalize to `? extends TimelineServerBasedDetectionStrategy`
in `hudi-timeline-service/src/main/java/org/apache/hudi/timeline/service/handlers/marker/MarkerDirState.java`
#### Snippet
```java

  public MarkerDirState(String markerDirPath, int markerBatchNumThreads,
                        Option<TimelineServerBasedDetectionStrategy> conflictDetectionStrategy,
                        FileSystem fileSystem, Registry metricsRegistry,
                        HoodieEngineContext hoodieEngineContext, int parallelism) {
```

### BoundedWildcard
Can generalize to `? extends HoodieInstant`
in `hudi-common/src/main/java/org/apache/hudi/common/table/TableSchemaResolver.java`
#### Snippet
```java
   * @deprecated please use {@link #getTableAvroSchema(HoodieInstant, boolean)} instead
   */
  public MessageType readSchemaFromLastCompaction(Option<HoodieInstant> lastCompactionCommitOpt) throws Exception {
    HoodieActiveTimeline activeTimeline = metaClient.getActiveTimeline();

```

### BoundedWildcard
Can generalize to `? extends HoodieInstant`
in `hudi-common/src/main/java/org/apache/hudi/common/table/TableSchemaResolver.java`
#### Snippet
```java
  }

  private Schema getTableAvroSchemaInternal(boolean includeMetadataFields, Option<HoodieInstant> instantOpt) {
    Schema schema =
        (instantOpt.isPresent()
```

### BoundedWildcard
Can generalize to `? extends GenericRecord`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/keygen/CustomKeyGenerator.java`
#### Snippet
```java
  }

  private String getPartitionPath(Option<GenericRecord> record, Option<Row> row, Option<Pair<InternalRow, StructType>> internalRowStructTypePair) {
    if (getPartitionPathFields() == null) {
      throw new HoodieKeyException("Unable to find field names for partition path in cfg");
```

### BoundedWildcard
Can generalize to `? extends Row`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/keygen/CustomKeyGenerator.java`
#### Snippet
```java
  }

  private String getPartitionPath(Option<GenericRecord> record, Option<Row> row, Option<Pair<InternalRow, StructType>> internalRowStructTypePair) {
    if (getPartitionPathFields() == null) {
      throw new HoodieKeyException("Unable to find field names for partition path in cfg");
```

### BoundedWildcard
Can generalize to `? extends Pair`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/keygen/CustomKeyGenerator.java`
#### Snippet
```java
  }

  private String getPartitionPath(Option<GenericRecord> record, Option<Row> row, Option<Pair<InternalRow, StructType>> internalRowStructTypePair) {
    if (getPartitionPathFields() == null) {
      throw new HoodieKeyException("Unable to find field names for partition path in cfg");
```

## RuleId[ruleID=MissortedModifiers]
### MissortedModifiers
Missorted modifiers `public static @Nullable`
in `hudi-common/src/main/java/org/apache/hudi/common/util/StringUtils.java`
#### Snippet
```java
   * @return {@code string} itself if it is nonempty; {@code null} if it is empty or null
   */
  public static @Nullable String emptyToNull(@Nullable String string) {
    return stringIsNullOrEmpty(string) ? null : string;
  }
```

### MissortedModifiers
Missorted modifiers `protected @Nullable`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/util/RowDataProjection.java`
#### Snippet
```java
  }

  protected @Nullable Object getVal(int pos, @Nullable Object val) {
    return val;
  }
```

### MissortedModifiers
Missorted modifiers `protected @Nullable`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/util/RowDataCastProjection.java`
#### Snippet
```java

  @Override
  protected @Nullable Object getVal(int pos, @Nullable Object val) {
    if (val == null) {
      return null;
```

### MissortedModifiers
Missorted modifiers `private @Nullable`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/CastMap.java`
#### Snippet
```java
  }

  private @Nullable Function<Object, Object> getConversion(LogicalType fromType, LogicalType toType) {
    LogicalTypeRoot from = fromType.getTypeRoot();
    LogicalTypeRoot to = toType.getTypeRoot();
```

### MissortedModifiers
Missorted modifiers `private @Nullable`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/catalog/HoodieCatalog.java`
#### Snippet
```java
  }

  private @Nullable Schema getLatestTableSchema(String path) {
    if (path != null && StreamerUtil.tableExists(path, hadoopConf)) {
      try {
```

## RuleId[ruleID=AnonymousHasLambdaAlternative]
### AnonymousHasLambdaAlternative
Anonymous new Thread() can be replaced with new Thread(() -\> {...})
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/HoodieLogFormatWriter.java`
#### Snippet
```java
   */
  private void addShutDownHook() {
    shutdownThread = new Thread() {
      public void run() {
        try {
```

## RuleId[ruleID=NegativeIntConstantInLongContext]
### NegativeIntConstantInLongContext
Negative int hexadecimal constant in long context
in `hudi-common/src/main/java/org/apache/hudi/common/util/hash/HashID.java`
#### Snippet
```java
      case BITS_64:
        XXHash64 hash64 = factory.hash64();
        return Bytes.toBytes(hash64.hash(message, 0, message.length, HASH_SEED));
      default:
        throw new HoodieIOException("XX" + bits + " hash is unsupported!");
```

## RuleId[ruleID=MalformedFormatString]
### MalformedFormatString
Too many arguments for format string (found: 12, expected: 8)
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/SchedulerConfGenerator.java`
#### Snippet
```java
  private static String generateConfig(Integer deltaSyncWeight, Integer compactionWeight, Integer deltaSyncMinShare,
      Integer compactionMinShare, Integer clusteringWeight, Integer clusteringMinShare) {
    return String.format(SPARK_SCHEDULING_PATTERN, DELTASYNC_POOL_NAME, SPARK_SCHEDULER_FAIR_MODE,
        deltaSyncWeight.toString(), deltaSyncMinShare.toString(), COMPACT_POOL_NAME, SPARK_SCHEDULER_FAIR_MODE,
        compactionWeight.toString(), compactionMinShare.toString(), CLUSTERING_POOL_NAME, SPARK_SCHEDULER_FAIR_MODE,
```

## RuleId[ruleID=DefaultAnnotationParam]
### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDataTableValidator.java`
#### Snippet
```java
    public String sparkMaster = null;

    @Parameter(names = {"--spark-memory", "-sm"}, description = "spark memory to use", required = false)
    public String sparkMemory = "1g";

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDataTableValidator.java`
#### Snippet
```java
    public int parallelism = 200;

    @Parameter(names = {"--ignore-failed", "-ig"}, description = "Ignore data table validate failure and continue.", required = false)
    public boolean ignoreFailed = false;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDataTableValidator.java`
#### Snippet
```java

    @Parameter(names = {"--assume-date-partitioning"}, description = "Should HoodieWriteClient assume the data is partitioned by dates, i.e three levels from base path."
        + "This is a stop-gap to support tables created by versions < 0.3.1. Will be removed eventually", required = false)
    public Boolean assumeDatePartitioning = false;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDataTableValidator.java`
#### Snippet
```java

    @Parameter(names = {"--continuous"}, description = "Running MetadataTableValidator in continuous. "
        + "Can use --min-validate-interval-seconds to control validation frequency", required = false)
    public boolean continuous = false;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDataTableValidator.java`
#### Snippet
```java
    public Boolean assumeDatePartitioning = false;

    @Parameter(names = {"--spark-master", "-ms"}, description = "Spark master", required = false)
    public String sparkMaster = null;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDataTableValidator.java`
#### Snippet
```java
    public Integer minValidateIntervalSeconds = 10 * 60;

    @Parameter(names = {"--parallelism", "-pl"}, description = "Parallelism for validation", required = false)
    public int parallelism = 200;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieCompactor.java`
#### Snippet
```java
    @Parameter(names = {"--spark-memory", "-sm"}, description = "spark memory to use", required = true)
    public String sparkMemory = null;
    @Parameter(names = {"--retry", "-rt"}, description = "number of retries", required = false)
    public int retry = 0;
    @Parameter(names = {"--schedule", "-sc"}, description = "Schedule compaction", required = false)
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieCompactor.java`
#### Snippet
```java
    @Parameter(names = {"--schema-file", "-sf"}, description = "path for Avro schema file", required = false)
    public String schemaFile = null;
    @Parameter(names = {"--spark-master", "-ms"}, description = "Spark master", required = false)
    public String sparkMaster = null;
    @Parameter(names = {"--spark-memory", "-sm"}, description = "spark memory to use", required = true)
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieCompactor.java`
#### Snippet
```java
    @Parameter(names = {"--table-name", "-tn"}, description = "Table name", required = true)
    public String tableName = null;
    @Parameter(names = {"--instant-time", "-it"}, description = "Compaction Instant time", required = false)
    public String compactionInstantTime = null;
    @Parameter(names = {"--parallelism", "-pl"}, description = "Parallelism for hoodie insert", required = false)
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieCompactor.java`
#### Snippet
```java
    @Parameter(names = {"--mode", "-m"}, description = "Set job mode: Set \"schedule\" means make a compact plan; "
        + "Set \"execute\" means execute a compact plan at given instant which means --instant-time is needed here; "
        + "Set \"scheduleAndExecute\" means make a compact plan first and execute that plan immediately", required = false)
    public String runningMode = null;
    @Parameter(names = {"--strategy", "-st"}, description = "Strategy Class", required = false)
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieCompactor.java`
#### Snippet
```java
    @Parameter(names = {"--parallelism", "-pl"}, description = "Parallelism for hoodie insert", required = false)
    public int parallelism = 200;
    @Parameter(names = {"--schema-file", "-sf"}, description = "path for Avro schema file", required = false)
    public String schemaFile = null;
    @Parameter(names = {"--spark-master", "-ms"}, description = "Spark master", required = false)
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieCompactor.java`
#### Snippet
```java
        + "Set \"scheduleAndExecute\" means make a compact plan first and execute that plan immediately", required = false)
    public String runningMode = null;
    @Parameter(names = {"--strategy", "-st"}, description = "Strategy Class", required = false)
    public String strategyClassName = LogFileSizeBasedCompactionStrategy.class.getName();
    @Parameter(names = {"--help", "-h"}, help = true)
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieCompactor.java`
#### Snippet
```java
    @Parameter(names = {"--retry", "-rt"}, description = "number of retries", required = false)
    public int retry = 0;
    @Parameter(names = {"--schedule", "-sc"}, description = "Schedule compaction", required = false)
    public Boolean runSchedule = false;
    @Parameter(names = {"--mode", "-m"}, description = "Set job mode: Set \"schedule\" means make a compact plan; "
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieCompactor.java`
#### Snippet
```java
    @Parameter(names = {"--instant-time", "-it"}, description = "Compaction Instant time", required = false)
    public String compactionInstantTime = null;
    @Parameter(names = {"--parallelism", "-pl"}, description = "Parallelism for hoodie insert", required = false)
    public int parallelism = 200;
    @Parameter(names = {"--schema-file", "-sf"}, description = "path for Avro schema file", required = false)
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieRepairTool.java`
#### Snippet
```java
    public String startingInstantTime = null;
    @Parameter(names = {"--end-instant-time", "-ei"}, description = "Ending Instant time "
        + "for repair (inclusive)", required = false)
    public String endingInstantTime = null;
    @Parameter(names = {"--backup-path", "-bp"}, description = "Backup path for storing dangling data "
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieRepairTool.java`
#### Snippet
```java
    public String runningMode = null;
    @Parameter(names = {"--start-instant-time", "-si"}, description = "Starting Instant time "
        + "for repair (inclusive)", required = false)
    public String startingInstantTime = null;
    @Parameter(names = {"--end-instant-time", "-ei"}, description = "Ending Instant time "
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieRepairTool.java`
#### Snippet
```java
    public String sparkMemory = "1g";
    @Parameter(names = {"--assume-date-partitioning", "-dp"}, description = "whether the partition path "
        + "is date with three levels", required = false)
    public Boolean assumeDatePartitioning = false;
    @Parameter(names = {"--help", "-h"}, help = true)
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieRepairTool.java`
#### Snippet
```java
    @Parameter(names = {"--parallelism", "-pl"}, description = "Parallelism for repair", required = false)
    public int parallelism = 2;
    @Parameter(names = {"--spark-master", "-ms"}, description = "Spark master", required = false)
    public String sparkMaster = null;
    @Parameter(names = {"--spark-memory", "-sm"}, description = "spark memory to use", required = false)
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieRepairTool.java`
#### Snippet
```java
    @Parameter(names = {"--spark-master", "-ms"}, description = "Spark master", required = false)
    public String sparkMaster = null;
    @Parameter(names = {"--spark-memory", "-sm"}, description = "spark memory to use", required = false)
    public String sparkMemory = "1g";
    @Parameter(names = {"--assume-date-partitioning", "-dp"}, description = "whether the partition path "
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieRepairTool.java`
#### Snippet
```java
        + "and log files from the table", required = false)
    public String backupPath = null;
    @Parameter(names = {"--parallelism", "-pl"}, description = "Parallelism for repair", required = false)
    public int parallelism = 2;
    @Parameter(names = {"--spark-master", "-ms"}, description = "Spark master", required = false)
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieRepairTool.java`
#### Snippet
```java
    public String endingInstantTime = null;
    @Parameter(names = {"--backup-path", "-bp"}, description = "Backup path for storing dangling data "
        + "and log files from the table", required = false)
    public String backupPath = null;
    @Parameter(names = {"--parallelism", "-pl"}, description = "Parallelism for repair", required = false)
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieCompactionAdminTool.java`
#### Snippet
```java
    @Parameter(names = {"--output-path", "-ot"}, description = "Output Path", required = false)
    public String outputPath = null;
    @Parameter(names = {"--print-output", "-pt"}, description = "Print Output", required = false)
    public boolean printOutput = true;
    @Parameter(names = {"--help", "-h"}, help = true)
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieCompactionAdminTool.java`
#### Snippet
```java
    @Parameter(names = {"--skip-validation", "-sv"}, description = "Skip Validation", required = false)
    public boolean skipValidation = false;
    @Parameter(names = {"--output-path", "-ot"}, description = "Output Path", required = false)
    public String outputPath = null;
    @Parameter(names = {"--print-output", "-pt"}, description = "Print Output", required = false)
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieCompactionAdminTool.java`
#### Snippet
```java
    @Parameter(names = {"--spark-memory", "-sm"}, description = "spark memory to use", required = true)
    public String sparkMemory = null;
    @Parameter(names = {"--dry-run", "-dr"}, description = "Dry Run Mode", required = false)
    public boolean dryRun = false;
    @Parameter(names = {"--skip-validation", "-sv"}, description = "Skip Validation", required = false)
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieCompactionAdminTool.java`
#### Snippet
```java
    @Parameter(names = {"--file-id", "-id"}, description = "File Id", required = false)
    public String fileId = null;
    @Parameter(names = {"--parallelism", "-pl"}, description = "Parallelism for hoodie insert", required = false)
    public int parallelism = 3;
    @Parameter(names = {"--spark-master", "-ms"}, description = "Spark master", required = true)
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieCompactionAdminTool.java`
#### Snippet
```java
    @Parameter(names = {"--dry-run", "-dr"}, description = "Dry Run Mode", required = false)
    public boolean dryRun = false;
    @Parameter(names = {"--skip-validation", "-sv"}, description = "Skip Validation", required = false)
    public boolean skipValidation = false;
    @Parameter(names = {"--output-path", "-ot"}, description = "Output Path", required = false)
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieCompactionAdminTool.java`
#### Snippet
```java
    @Parameter(names = {"--partition-path", "-pp"}, description = "Partition Path", required = false)
    public String partitionPath = null;
    @Parameter(names = {"--file-id", "-id"}, description = "File Id", required = false)
    public String fileId = null;
    @Parameter(names = {"--parallelism", "-pl"}, description = "Parallelism for hoodie insert", required = false)
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieCompactionAdminTool.java`
#### Snippet
```java
    @Parameter(names = {"--base-path", "-bp"}, description = "Base path for the table", required = true)
    public String basePath = null;
    @Parameter(names = {"--instant-time", "-in"}, description = "Compaction Instant time", required = false)
    public String compactionInstantTime = null;
    @Parameter(names = {"--partition-path", "-pp"}, description = "Partition Path", required = false)
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieCompactionAdminTool.java`
#### Snippet
```java
    @Parameter(names = {"--instant-time", "-in"}, description = "Compaction Instant time", required = false)
    public String compactionInstantTime = null;
    @Parameter(names = {"--partition-path", "-pp"}, description = "Partition Path", required = false)
    public String partitionPath = null;
    @Parameter(names = {"--file-id", "-id"}, description = "File Id", required = false)
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDropPartitionsTool.java`
#### Snippet
```java
    @Parameter(names = {"--hive-metastore-uris"}, description = "hive meta store uris to use.", required = false)
    public String hiveHMSUris = null;
    @Parameter(names = {"--hive-sync-mode"}, description = "Mode to choose for Hive ops. Valid values are hms, jdbc and hiveql.", required = false)
    public String hiveSyncMode = "hms";
    @Parameter(names = {"--hive-sync-ignore-exception"}, description = "Ignore hive sync exception.", required = false)
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDropPartitionsTool.java`
#### Snippet
```java
        + " default 'SlashEncodedDayPartitionValueExtractor'.", required = false)
    public String partitionValueExtractorClass = "org.apache.hudi.hive.SlashEncodedDayPartitionValueExtractor";
    @Parameter(names = {"--spark-master", "-ms"}, description = "Spark master", required = false)
    public String sparkMaster = null;
    @Parameter(names = {"--spark-memory", "-sm"}, description = "spark memory to use", required = false)
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDropPartitionsTool.java`
#### Snippet
```java
    @Parameter(names = {"--hive-jdbc-url", "-jdbc"}, description = "hive url to use.", required = false)
    public String hiveURL = "jdbc:hive2://localhost:10000";
    @Parameter(names = {"--hive-partition-field"}, description = "Comma separated list of field in the hive table to use for determining hive partition columns.", required = false)
    public String hivePartitionsField = "";
    @Parameter(names = {"--hive-sync-use-jdbc"}, description = "Use JDBC when hive synchronization.", required = false)
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDropPartitionsTool.java`
#### Snippet
```java
    @Parameter(names = {"--spark-master", "-ms"}, description = "Spark master", required = false)
    public String sparkMaster = null;
    @Parameter(names = {"--spark-memory", "-sm"}, description = "spark memory to use", required = false)
    public String sparkMemory = "1g";
    @Parameter(names = {"--props"}, description = "path to properties file on localfs or dfs, with configurations for "
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDropPartitionsTool.java`
#### Snippet
```java
    @Parameter(names = {"--hive-database", "-db"}, description = "Database to sync to.", required = false)
    public String hiveDataBase = null;
    @Parameter(names = {"--hive-table-name"}, description = "Table to sync to.", required = false)
    public String hiveTableName = null;
    @Parameter(names = {"--hive-user-name", "-user"}, description = "hive user name to use.", required = false)
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDropPartitionsTool.java`
#### Snippet
```java
    @Parameter(names = {"--hive-user-name", "-user"}, description = "hive user name to use.", required = false)
    public String hiveUserName = "hive";
    @Parameter(names = {"--hive-pass-word", "-pass"}, description = "hive password to use.", required = false)
    public String hivePassWord = "hive";
    @Parameter(names = {"--hive-jdbc-url", "-jdbc"}, description = "hive url to use.", required = false)
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDropPartitionsTool.java`
#### Snippet
```java
    @Parameter(names = {"--hive-pass-word", "-pass"}, description = "hive password to use.", required = false)
    public String hivePassWord = "hive";
    @Parameter(names = {"--hive-jdbc-url", "-jdbc"}, description = "hive url to use.", required = false)
    public String hiveURL = "jdbc:hive2://localhost:10000";
    @Parameter(names = {"--hive-partition-field"}, description = "Comma separated list of field in the hive table to use for determining hive partition columns.", required = false)
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDropPartitionsTool.java`
#### Snippet
```java
    @Parameter(names = {"--instant-time", "-it"}, description = "instant time for delete table partitions operation.", required = false)
    public String instantTime = null;
    @Parameter(names = {"--sync-hive-meta", "-sync"}, description = "Sync information to HMS.", required = false)
    public boolean syncToHive = false;
    @Parameter(names = {"--hive-database", "-db"}, description = "Database to sync to.", required = false)
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDropPartitionsTool.java`
#### Snippet
```java
    public boolean hiveSyncIgnoreException = false;
    @Parameter(names = {"--hive-partition-value-extractor-class"}, description = "Class which implements PartitionValueExtractor to extract the partition values,"
        + " default 'SlashEncodedDayPartitionValueExtractor'.", required = false)
    public String partitionValueExtractorClass = "org.apache.hudi.hive.SlashEncodedDayPartitionValueExtractor";
    @Parameter(names = {"--spark-master", "-ms"}, description = "Spark master", required = false)
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDropPartitionsTool.java`
#### Snippet
```java
    @Parameter(names = {"--partitions", "-p"}, description = "Comma separated list of partitions to delete.", required = true)
    public String partitions = null;
    @Parameter(names = {"--parallelism", "-pl"}, description = "Parallelism for hoodie insert/upsert/delete", required = false)
    public int parallelism = 1500;
    @Parameter(names = {"--instant-time", "-it"}, description = "instant time for delete table partitions operation.", required = false)
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDropPartitionsTool.java`
#### Snippet
```java
    @Parameter(names = {"--hive-sync-mode"}, description = "Mode to choose for Hive ops. Valid values are hms, jdbc and hiveql.", required = false)
    public String hiveSyncMode = "hms";
    @Parameter(names = {"--hive-sync-ignore-exception"}, description = "Ignore hive sync exception.", required = false)
    public boolean hiveSyncIgnoreException = false;
    @Parameter(names = {"--hive-partition-value-extractor-class"}, description = "Class which implements PartitionValueExtractor to extract the partition values,"
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDropPartitionsTool.java`
#### Snippet
```java
    @Parameter(names = {"--hive-partition-field"}, description = "Comma separated list of field in the hive table to use for determining hive partition columns.", required = false)
    public String hivePartitionsField = "";
    @Parameter(names = {"--hive-sync-use-jdbc"}, description = "Use JDBC when hive synchronization.", required = false)
    public boolean hiveUseJdbc = true;
    @Parameter(names = {"--hive-metastore-uris"}, description = "hive meta store uris to use.", required = false)
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDropPartitionsTool.java`
#### Snippet
```java
    @Parameter(names = {"--parallelism", "-pl"}, description = "Parallelism for hoodie insert/upsert/delete", required = false)
    public int parallelism = 1500;
    @Parameter(names = {"--instant-time", "-it"}, description = "instant time for delete table partitions operation.", required = false)
    public String instantTime = null;
    @Parameter(names = {"--sync-hive-meta", "-sync"}, description = "Sync information to HMS.", required = false)
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDropPartitionsTool.java`
#### Snippet
```java
    @Parameter(names = {"--hive-sync-use-jdbc"}, description = "Use JDBC when hive synchronization.", required = false)
    public boolean hiveUseJdbc = true;
    @Parameter(names = {"--hive-metastore-uris"}, description = "hive meta store uris to use.", required = false)
    public String hiveHMSUris = null;
    @Parameter(names = {"--hive-sync-mode"}, description = "Mode to choose for Hive ops. Valid values are hms, jdbc and hiveql.", required = false)
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDropPartitionsTool.java`
#### Snippet
```java
    @Parameter(names = {"--sync-hive-meta", "-sync"}, description = "Sync information to HMS.", required = false)
    public boolean syncToHive = false;
    @Parameter(names = {"--hive-database", "-db"}, description = "Database to sync to.", required = false)
    public String hiveDataBase = null;
    @Parameter(names = {"--hive-table-name"}, description = "Table to sync to.", required = false)
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDropPartitionsTool.java`
#### Snippet
```java
    @Parameter(names = {"--hive-table-name"}, description = "Table to sync to.", required = false)
    public String hiveTableName = null;
    @Parameter(names = {"--hive-user-name", "-user"}, description = "hive user name to use.", required = false)
    public String hiveUserName = "hive";
    @Parameter(names = {"--hive-pass-word", "-pass"}, description = "hive password to use.", required = false)
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieMetadataTableValidator.java`
#### Snippet
```java
    public boolean validateLatestFileSlices = false;

    @Parameter(names = {"--validate-latest-base-files"}, description = "Validate latest base files for all partitions.", required = false)
    public boolean validateLatestBaseFiles = false;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieMetadataTableValidator.java`
#### Snippet
```java
    public String sparkMaster = null;

    @Parameter(names = {"--spark-memory", "-sm"}, description = "spark memory to use", required = false)
    public String sparkMemory = "1g";

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieMetadataTableValidator.java`
#### Snippet
```java
    public boolean continuous = false;

    @Parameter(names = {"--skip-data-files-for-cleaning"}, description = "Skip to compare the data files which are under deletion by cleaner", required = false)
    public boolean skipDataFilesForCleaning = false;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieMetadataTableValidator.java`
#### Snippet
```java
    public int parallelism = 200;

    @Parameter(names = {"--ignore-failed", "-ig"}, description = "Ignore metadata validate failure and continue.", required = false)
    public boolean ignoreFailed = false;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieMetadataTableValidator.java`
#### Snippet
```java

    @Parameter(names = {"--continuous"}, description = "Running MetadataTableValidator in continuous. "
        + "Can use --min-validate-interval-seconds to control validation frequency", required = false)
    public boolean continuous = false;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieMetadataTableValidator.java`
#### Snippet
```java
    public Integer minValidateIntervalSeconds = 10 * 60;

    @Parameter(names = {"--parallelism", "-pl"}, description = "Parallelism for valuation", required = false)
    public int parallelism = 200;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieMetadataTableValidator.java`
#### Snippet
```java
    public boolean ignoreFailed = false;

    @Parameter(names = {"--spark-master", "-ms"}, description = "Spark master", required = false)
    public String sparkMaster = null;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieMetadataTableValidator.java`
#### Snippet
```java
    public boolean validateAllColumnStats = false;

    @Parameter(names = {"--validate-bloom-filters"}, description = "Validate bloom filters of base files", required = false)
    public boolean validateBloomFilters = false;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieMetadataTableValidator.java`
#### Snippet
```java
    public boolean validateLatestBaseFiles = false;

    @Parameter(names = {"--validate-all-file-groups"}, description = "Validate all file groups, and all file slices within file groups.", required = false)
    public boolean validateAllFileGroups = false;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieMetadataTableValidator.java`
#### Snippet
```java
    public boolean skipDataFilesForCleaning = false;

    @Parameter(names = {"--validate-latest-file-slices"}, description = "Validate latest file slices for all partitions.", required = false)
    public boolean validateLatestFileSlices = false;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieMetadataTableValidator.java`
#### Snippet
```java
    public boolean validateAllFileGroups = false;

    @Parameter(names = {"--validate-all-column-stats"}, description = "Validate column stats for all columns in the schema", required = false)
    public boolean validateAllColumnStats = false;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieMetadataTableValidator.java`
#### Snippet
```java

    @Parameter(names = {"--assume-date-partitioning"}, description = "Should HoodieWriteClient assume the data is partitioned by dates, i.e three levels from base path."
        + "This is a stop-gap to support tables created by versions < 0.3.1. Will be removed eventually", required = false)
    public Boolean assumeDatePartitioning = false;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/HoodieDeltaStreamer.java`
#### Snippet
```java
    public String tableType;

    @Parameter(names = {"--base-file-format"}, description = "File format for the base files. PARQUET (or) HFILE", required = false)
    public String baseFileFormat = "PARQUET";

```

## RuleId[ruleID=RedundantStreamOptionalCall]
### RedundantStreamOptionalCall
Redundant 'sequential()' call: the stream was created via 'stream()', so it's already sequential
in `hudi-common/src/main/java/org/apache/hudi/common/util/CollectionUtils.java`
#### Snippet
```java
  public static <T, U> U reduce(Collection<T> c, U identity, BiFunction<U, T, U> reducer) {
    return c.stream()
        .sequential()
        .reduce(identity, reducer, (a, b) -> {
          throw new UnsupportedOperationException();
```

### RedundantStreamOptionalCall
Redundant 'sequential()' call: the stream was created via 'stream()', so it's already sequential
in `hudi-common/src/main/java/org/apache/hudi/common/util/ParquetUtils.java`
#### Snippet
```java
    // Collect stats from all individual Parquet blocks
    Map<String, List<HoodieColumnRangeMetadata<Comparable>>> columnToStatsListMap =
        (Map<String, List<HoodieColumnRangeMetadata<Comparable>>>) metadata.getBlocks().stream().sequential()
          .flatMap(blockMetaData ->
              blockMetaData.getColumns().stream()
```

### RedundantStreamOptionalCall
Redundant 'sequential()' call: the stream was created via 'stream()', so it's already sequential
in `hudi-common/src/main/java/org/apache/hudi/common/util/ParquetUtils.java`
#### Snippet
```java
    // there are multiple blocks. Compute min(block_mins) and max(block_maxs)
    return blockRanges.stream()
        .sequential()
        .reduce(this::combineRanges).get();
  }
```

### RedundantStreamOptionalCall
Redundant 'sequential()' call: the stream was created via 'stream()', so it's already sequential
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/BitCaskDiskMap.java`
#### Snippet
```java
  public Stream<R> valueStream() {
    final BufferedRandomAccessFile file = getRandomAccessFile();
    return valueMetadataMap.values().stream().sorted().sequential().map(valueMetaData -> (R) get(valueMetaData, file, isCompressionEnabled));
  }

```

### RedundantStreamOptionalCall
Redundant 'sequential()' call: the stream was created via 'stream()', so it's already sequential
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/PulsarSource.java`
#### Snippet
```java
    //       fetching all Pulsar client threads and interrupting them forcibly (to make them
    //       shutdown)
    collectActiveThreads().stream().sequential()
        .filter(t -> t.getName().startsWith("pulsar-client-io"))
        .forEach(Thread::interrupt);
```

## RuleId[ruleID=ThrowFromFinallyBlock]
### ThrowFromFinallyBlock
`throw` inside 'finally' block
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/rollback/BaseRollbackHelper.java`
#### Snippet
```java
            }
          } catch (IOException io) {
            throw new HoodieIOException("Error appending rollback block", io);
          }
        }
```

### ThrowFromFinallyBlock
`throw` inside 'finally' block
in `hudi-common/src/main/java/org/apache/hudi/common/fs/HoodieWrapperFileSystem.java`
#### Snippet
```java
      } catch (IOException e) {
        String errorMsg = "Failed to close file" + (needTempFile ? tmpPath : fullPath);
        throw new HoodieIOException(errorMsg, e);
      }

```

### ThrowFromFinallyBlock
`throw` inside 'finally' block
in `hudi-common/src/main/java/org/apache/hudi/common/fs/HoodieWrapperFileSystem.java`
#### Snippet
```java
        }
      } catch (IOException e) {
        throw new HoodieIOException("Failed to rename " + tmpPath + " to the target " + fullPath, e);
      }
    }
```

## RuleId[ruleID=UnnecessarySuperQualifier]
### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/table/action/commit/JavaUpsertPreppedCommitActionExecutor.java`
#### Snippet
```java
  @Override
  public HoodieWriteMetadata<List<WriteStatus>> execute() {
    return super.execute(preppedRecords);
  }
}
```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/table/action/commit/JavaInsertPreppedCommitActionExecutor.java`
#### Snippet
```java
  @Override
  public HoodieWriteMetadata<List<WriteStatus>> execute() {
    return super.execute(preppedRecords);
  }
}
```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/io/storage/row/HoodieRowDataParquetWriter.java`
#### Snippet
```java
  @Override
  public void writeRow(String key, RowData row) throws IOException {
    super.write(row);
    writeSupport.add(key);
  }
```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/io/storage/row/HoodieRowDataParquetWriter.java`
#### Snippet
```java
  @Override
  public void writeRow(RowData row) throws IOException {
    super.write(row);
  }

```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/table/action/commit/FlinkInsertPreppedCommitActionExecutor.java`
#### Snippet
```java
  @Override
  public HoodieWriteMetadata<List<WriteStatus>> execute() {
    return super.execute(preppedRecords);
  }
}
```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/table/action/commit/FlinkUpsertPreppedCommitActionExecutor.java`
#### Snippet
```java
  @Override
  public HoodieWriteMetadata<List<WriteStatus>> execute() {
    return super.execute(preppedRecords);
  }
}
```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/table/action/commit/delta/FlinkUpsertPreppedDeltaCommitActionExecutor.java`
#### Snippet
```java
  @Override
  public HoodieWriteMetadata<List<WriteStatus>> execute() {
    return super.execute(preppedRecords);
  }
}
```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/io/storage/HoodieSparkParquetWriter.java`
#### Snippet
```java
      updateRecordMetadata(row, recordKey, key.getPartitionPath(), getWrittenRecordCount());

      super.write(row);
      writeSupport.add(recordKey);
    } else {
```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/io/storage/HoodieSparkParquetWriter.java`
#### Snippet
```java
      writeSupport.add(recordKey);
    } else {
      super.write(row);
    }
  }
```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/io/storage/HoodieSparkParquetWriter.java`
#### Snippet
```java
  @Override
  public void writeRow(String recordKey, InternalRow row) throws IOException {
    super.write(row);
    if (populateMetaFields) {
      writeSupport.add(UTF8String.fromString(recordKey));
```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/io/storage/row/HoodieInternalRowParquetWriter.java`
#### Snippet
```java
  @Override
  public void writeRow(UTF8String key, InternalRow row) throws IOException {
    super.write(row);
    writeSupport.add(key);
  }
```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/io/storage/row/HoodieInternalRowParquetWriter.java`
#### Snippet
```java
  @Override
  public void writeRow(InternalRow row) throws IOException {
    super.write(row);
  }
}
```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/table/action/commit/SparkUpsertPreppedCommitActionExecutor.java`
#### Snippet
```java
  @Override
  public HoodieWriteMetadata<HoodieData<WriteStatus>> execute() {
    return super.execute(preppedRecords);
  }
}
```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/table/action/commit/SparkInsertPreppedCommitActionExecutor.java`
#### Snippet
```java
  @Override
  public HoodieWriteMetadata<HoodieData<WriteStatus>> execute() {
    return super.execute(preppedRecords);
  }
}
```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/table/action/deltacommit/SparkInsertPreppedDeltaCommitActionExecutor.java`
#### Snippet
```java
  @Override
  public HoodieWriteMetadata<HoodieData<WriteStatus>> execute() {
    return super.execute(preppedRecords);
  }
}
```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/table/action/deltacommit/SparkUpsertPreppedDeltaCommitActionExecutor.java`
#### Snippet
```java
  @Override
  public HoodieWriteMetadata<HoodieData<WriteStatus>> execute() {
    return super.execute(preppedRecords);
  }
}
```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/keygen/parser/HoodieDateTimeParser.java`
#### Snippet
```java
        null,
        Arrays.stream(
          this.configInputDateFormatList.split(super.configInputDateFormatDelimiter))
          .map(String::trim)
          .map(DateTimeFormat::forPattern)
```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `hudi-common/src/main/java/org/apache/hudi/io/storage/HoodieAvroParquetWriter.java`
#### Snippet
```java
  @Override
  public void writeAvro(String key, IndexedRecord object) throws IOException {
    super.write(object);
    if (populateMetaFields) {
      writeSupport.add(key);
```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `hudi-common/src/main/java/org/apache/hudi/io/storage/HoodieAvroParquetWriter.java`
#### Snippet
```java
      prepRecordWithMetadata(key, avroRecord, instantTime,
          taskContextSupplier.getPartitionIdSupplier().get(), getWrittenRecordCount(), fileName);
      super.write(avroRecord);
      writeSupport.add(key.getRecordKey());
    } else {
```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `hudi-common/src/main/java/org/apache/hudi/io/storage/HoodieAvroParquetWriter.java`
#### Snippet
```java
      writeSupport.add(key.getRecordKey());
    } else {
      super.write(avroRecord);
    }
  }
```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieArchivedLogFile.java`
#### Snippet
```java
  @Override
  public String toString() {
    return "HoodieArchivedLogFile {" + super.getPath() + '}';
  }
}
```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/HoodieLogFormatVersion.java`
#### Snippet
```java
  @Override
  public boolean hasFooter() {
    switch (super.getVersion()) {
      case DEFAULT_VERSION:
        return false;
```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/HoodieLogFormatVersion.java`
#### Snippet
```java
  @Override
  public boolean hasOrdinal() {
    switch (super.getVersion()) {
      case DEFAULT_VERSION:
        return true;
```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/HoodieLogFormatVersion.java`
#### Snippet
```java
  @Override
  public boolean hasLogBlockLength() {
    switch (super.getVersion()) {
      case DEFAULT_VERSION:
        return false;
```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/HoodieLogFormatVersion.java`
#### Snippet
```java
  @Override
  public boolean hasContentLength() {
    switch (super.getVersion()) {
      case DEFAULT_VERSION:
        return true;
```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/HoodieLogFormatVersion.java`
#### Snippet
```java
  @Override
  public boolean hasMagicHeader() {
    switch (super.getVersion()) {
      case DEFAULT_VERSION:
        return true;
```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/HoodieLogFormatVersion.java`
#### Snippet
```java
  @Override
  public boolean hasContent() {
    switch (super.getVersion()) {
      case DEFAULT_VERSION:
        return true;
```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/HoodieLogFormatVersion.java`
#### Snippet
```java
  @Override
  public boolean hasHeader() {
    switch (super.getVersion()) {
      case DEFAULT_VERSION:
        return false;
```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/block/HoodieAvroDataBlockVersion.java`
#### Snippet
```java

  public boolean hasRecordCount() {
    switch (super.getVersion()) {
      case DEFAULT_VERSION:
        return true;
```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/block/HoodieParquetDataBlock.java`
#### Snippet
```java
    }

    Schema writerSchema = new Schema.Parser().parse(super.getLogBlockHeader().get(HeaderMetadataType.SCHEMA));
    ByteArrayOutputStream baos = new ByteArrayOutputStream();
    try (FSDataOutputStream outputStream = new FSDataOutputStream(baos, null)) {
```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/block/HoodieAvroDataBlock.java`
#### Snippet
```java
  @Override
  protected byte[] serializeRecords(List<HoodieRecord> records) throws IOException {
    Schema schema = new Schema.Parser().parse(super.getLogBlockHeader().get(HeaderMetadataType.SCHEMA));
    GenericDatumWriter<IndexedRecord> writer = new GenericDatumWriter<>(schema);
    ByteArrayOutputStream baos = new ByteArrayOutputStream();
```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/block/HoodieDataBlock.java`
#### Snippet
```java
    this.keyFieldName = keyFieldName;
    // If no reader-schema has been provided assume writer-schema as one
    this.readerSchema = readerSchema.orElseGet(() -> getWriterSchema(super.getLogBlockHeader()));
    this.enablePointLookups = enablePointLookups;
  }
```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/block/HoodieDataBlock.java`
#### Snippet
```java
    this.keyFieldName = keyFieldName;
    // If no reader-schema has been provided assume writer-schema as one
    this.readerSchema = getWriterSchema(super.getLogBlockHeader());
    this.enablePointLookups = false;
  }
```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/block/HoodieHFileDataBlock.java`
#### Snippet
```java

    // Get schema from the header
    Schema writerSchema = new Schema.Parser().parse(super.getLogBlockHeader().get(HeaderMetadataType.SCHEMA));

    // Read the content
```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/block/HoodieHFileDataBlock.java`
#### Snippet
```java
    Map<String, byte[]> sortedRecordsMap = new TreeMap<>();
    // Get writer schema
    Schema writerSchema = new Schema.Parser().parse(super.getLogBlockHeader().get(HeaderMetadataType.SCHEMA));

    Iterator<HoodieRecord> itr = records.iterator();
```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `hudi-common/src/main/java/org/apache/hudi/common/config/TypedProperties.java`
#### Snippet
```java
  @Override
  public String getProperty(String key) {
    Object oval = super.get(key);
    String sval = (oval != null) ? String.valueOf(oval) : null;
    return ((sval == null) && (defaults != null)) ? defaults.getProperty(key) : sval;
```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/hive/HoodieCombineHiveInputFormat.java`
#### Snippet
```java
      long maxSize = job.getLong(org.apache.hadoop.mapreduce.lib.input.FileInputFormat.SPLIT_MAXSIZE, minSize);
      if (job.getLong("mapreduce.input.fileinputformat.split.minsize.per.node", 0L) == 0L) {
        super.setMinSplitSizeNode(minSize);
      }

```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/hive/HoodieCombineHiveInputFormat.java`
#### Snippet
```java

      if (job.getLong("mapreduce.input.fileinputformat.split.minsize.per.rack", 0L) == 0L) {
        super.setMinSplitSizeRack(minSize);
      }

```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/hive/HoodieCombineHiveInputFormat.java`
#### Snippet
```java

      if (job.getLong(org.apache.hadoop.mapreduce.lib.input.FileInputFormat.SPLIT_MAXSIZE, 0L) == 0L) {
        super.setMaxSplitSize(minSize);
      }
      LOG.info("mapreduce.input.fileinputformat.split.minsize=" + minSize
```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/cow/CopyOnWriteInputFormat.java`
#### Snippet
```java
      boolean utcTimestamp,
      InternalSchemaManager internalSchemaManager) {
    super.setFilePaths(paths);
    this.limit = limit;
    this.partDefaultName = partDefaultName;
```

### UnnecessarySuperQualifier
Qualifier `super` is unnecessary in this context
in `hudi-flink-datasource/hudi-flink1.13.x/src/main/java/org/apache/hudi/adapter/AbstractStreamOperatorAdapter.java`
#### Snippet
```java
  @Override
  public void close() throws Exception {
    super.dispose();
  }

```

## RuleId[ruleID=InfiniteLoopStatement]
### InfiniteLoopStatement
`while` statement cannot complete without throwing an exception
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDataTableValidator.java`
#### Snippet
```java
    protected Pair<CompletableFuture, ExecutorService> startService() {
      return Pair.of(CompletableFuture.supplyAsync(() -> {
        while (true) {
          try {
            long start = System.currentTimeMillis();
```

### InfiniteLoopStatement
`while` statement cannot complete without throwing an exception
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/perf/TimelineServerPerf.java`
#### Snippet
```java
    if (!useExternalTimelineServer && cfg.waitForManualQueries) {
      System.out.println("Timeline Server Host Address=" + hostAddr + ", port=" + timelineServer.getServerPort());
      while (true) {
        try {
          Thread.sleep(60000);
```

### InfiniteLoopStatement
`while` statement cannot complete without throwing an exception
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieMetadataTableValidator.java`
#### Snippet
```java
    protected Pair<CompletableFuture, ExecutorService> startService() {
      return Pair.of(CompletableFuture.supplyAsync(() -> {
        while (true) {
          try {
            long start = System.currentTimeMillis();
```

### InfiniteLoopStatement
`while` statement cannot complete without throwing an exception
in `hudi-kafka-connect/src/main/java/org/apache/hudi/connect/kafka/KafkaConnectControlAgent.java`
#### Snippet
```java

    executorService.submit(() -> {
      while (true) {
        ConsumerRecords<String, byte[]> records;
        records = consumer.poll(Duration.ofMillis(KAFKA_POLL_TIMEOUT_MS));
```

### InfiniteLoopStatement
`while` statement cannot complete without throwing an exception
in `hudi-kafka-connect/src/main/java/org/apache/hudi/connect/transaction/ConnectTransactionCoordinator.java`
#### Snippet
```java
  @Override
  public void run() {
    while (true) {
      try {
        CoordinatorEvent event = events.poll(COORDINATOR_EVENT_LOOP_TIMEOUT_MS, TimeUnit.MILLISECONDS);
```

## RuleId[ruleID=CodeBlock2Expr]
### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `hudi-cli/src/main/java/org/apache/hudi/cli/Table.java`
#### Snippet
```java
  private List<List<Comparable>> orderRows() {
    return orderingFieldNameOptional.map(orderingColumnName -> {
      return rawRows.stream().sorted((row1, row2) -> {
        Comparable fieldForRow1 = row1.get(rowHeader.indexOf(orderingColumnName));
        Comparable fieldForRow2 = row2.get(rowHeader.indexOf(orderingColumnName));
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/TableCommand.java`
#### Snippet
```java
    rows.add(new Comparable[] {"metaPath", client.getMetaPath()});
    rows.add(new Comparable[] {"fileSystem", client.getFs().getScheme()});
    client.getTableConfig().propsMap().entrySet().forEach(e -> {
      rows.add(new Comparable[] {e.getKey(), e.getValue()});
    });
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/TimelineCommand.java`
#### Snippet
```java
          HoodieRollbackMetadata metadata = TimelineMetadataUtils
              .deserializeAvroMetadata(timeline.getInstantDetails(rollbackInstant).get(), HoodieRollbackMetadata.class);
          metadata.getCommitsRollback().forEach(instant -> {
            rollbackInfoMap.computeIfAbsent(instant, k -> new ArrayList<>())
                .add(rollbackInstant.getTimestamp());
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/TimelineCommand.java`
#### Snippet
```java
          return HoodieActiveTimeline.VALID_EXTENSIONS_IN_ACTIVE_TIMELINE.contains(extension);
        })).map(HoodieInstantWithModTime::new);
    instantStream.forEach(instant -> {
      instantMap.computeIfAbsent(instant.getTimestamp(), t -> new HashMap<>())
          .put(instant.getState(), instant);
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/bootstrap/BootstrapUtils.java`
#### Snippet
```java
  private static PathFilter getFilePathFilter(String baseFileExtension) {
    return (path) -> {
      return path.getName().endsWith(baseFileExtension);
    };
  }
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metrics/datadog/DatadogReporter.java`
#### Snippet
```java

    PayloadBuilder withTags(List<String> tags) {
      series.forEach(seriesItem -> {
        ((ObjectNode) seriesItem)
            .putArray("tags")
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metrics/datadog/DatadogReporter.java`
#### Snippet
```java

    builder.withMetricType(MetricType.gauge);
    gauges.forEach((metricName, metric) -> {
      builder.addGauge(prefix(metricName), now, (long) metric.getValue());
    });
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `hudi-common/src/main/java/org/apache/hudi/common/fs/HoodieWrapperFileSystem.java`
#### Snippet
```java
  public RemoteIterator<LocatedFileStatus> listFiles(Path f, boolean recursive) throws IOException {
    return executeFuncWithTimeMetrics(MetricName.listFiles.name(), f, () -> {
      return fileSystem.listFiles(convertToDefaultPath(f), recursive);
    });
  }
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `hudi-common/src/main/java/org/apache/hudi/common/fs/HoodieWrapperFileSystem.java`
#### Snippet
```java
  public FileStatus[] listStatus(Path[] files) throws IOException {
    return executeFuncWithTimeMetrics(MetricName.listStatus.name(), files.length > 0 ? files[0] : null, () -> {
      return fileSystem.listStatus(convertDefaults(files));
    });
  }
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `hudi-common/src/main/java/org/apache/hudi/common/fs/HoodieWrapperFileSystem.java`
#### Snippet
```java
  public FSDataOutputStream create(Path f, short replication) throws IOException {
    return executeFuncWithTimeMetrics(MetricName.create.name(), f, () -> {
      return wrapOutputStream(f, fileSystem.create(convertToDefaultPath(f), replication));
    });
  }
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `hudi-common/src/main/java/org/apache/hudi/common/fs/HoodieWrapperFileSystem.java`
#### Snippet
```java
  public FileStatus[] globStatus(Path pathPattern) throws IOException {
    return executeFuncWithTimeMetrics(MetricName.globStatus.name(), pathPattern, () -> {
      return fileSystem.globStatus(convertToDefaultPath(pathPattern));
    });
  }
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `hudi-common/src/main/java/org/apache/hudi/common/fs/HoodieWrapperFileSystem.java`
#### Snippet
```java
  public FileStatus[] listStatus(Path f) throws IOException {
    return executeFuncWithTimeMetrics(MetricName.listStatus.name(), f, () -> {
      return fileSystem.listStatus(convertToDefaultPath(f));
    });
  }
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `hudi-common/src/main/java/org/apache/hudi/common/fs/HoodieWrapperFileSystem.java`
#### Snippet
```java
                                   Progressable progress) throws IOException {
    return executeFuncWithTimeMetrics(MetricName.create.name(), f, () -> {
      return wrapOutputStream(f,
          fileSystem.create(convertToDefaultPath(f), overwrite, bufferSize, replication, blockSize, progress));
    });
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `hudi-common/src/main/java/org/apache/hudi/common/fs/HoodieWrapperFileSystem.java`
#### Snippet
```java
      throws IOException {
    return executeFuncWithTimeMetrics(MetricName.create.name(), f, () -> {
      return wrapOutputStream(f,
          fileSystem.create(convertToDefaultPath(f), overwrite, bufferSize, replication, blockSize));
    });
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `hudi-common/src/main/java/org/apache/hudi/common/fs/HoodieWrapperFileSystem.java`
#### Snippet
```java
  public FSDataOutputStream create(Path f, short replication, Progressable progress) throws IOException {
    return executeFuncWithTimeMetrics(MetricName.create.name(), f, () -> {
      return wrapOutputStream(f, fileSystem.create(convertToDefaultPath(f), replication, progress));
    });
  }
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `hudi-common/src/main/java/org/apache/hudi/common/fs/HoodieWrapperFileSystem.java`
#### Snippet
```java
  public FileStatus[] listStatus(Path f, PathFilter filter) throws IOException {
    return executeFuncWithTimeMetrics(MetricName.listStatus.name(), f, () -> {
      return fileSystem.listStatus(convertToDefaultPath(f), filter);
    });
  }
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `hudi-common/src/main/java/org/apache/hudi/common/fs/HoodieWrapperFileSystem.java`
#### Snippet
```java
  public FileStatus[] listStatus(Path[] files, PathFilter filter) throws IOException {
    return executeFuncWithTimeMetrics(MetricName.listStatus.name(), files.length > 0 ? files[0] : null, () -> {
      return fileSystem.listStatus(convertDefaults(files), filter);
    });
  }
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `hudi-common/src/main/java/org/apache/hudi/common/fs/HoodieWrapperFileSystem.java`
#### Snippet
```java
                                   short replication, long blockSize, Progressable progress) throws IOException {
    return executeFuncWithTimeMetrics(MetricName.create.name(), f, () -> {
      return wrapOutputStream(f,
          fileSystem.create(convertToDefaultPath(f), permission, flags, bufferSize, replication, blockSize, progress));
    });
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `hudi-common/src/main/java/org/apache/hudi/common/fs/HoodieWrapperFileSystem.java`
#### Snippet
```java
  public FSDataOutputStream create(Path f) throws IOException {
    return executeFuncWithTimeMetrics(MetricName.create.name(), f, () -> {
      return wrapOutputStream(f, fileSystem.create(convertToDefaultPath(f)));
    });
  }
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `hudi-common/src/main/java/org/apache/hudi/common/fs/HoodieWrapperFileSystem.java`
#### Snippet
```java
  public FSDataOutputStream create(Path f, boolean overwrite) throws IOException {
    return executeFuncWithTimeMetrics(MetricName.create.name(), f, () -> {
      return wrapOutputStream(f, fileSystem.create(convertToDefaultPath(f), overwrite));
    });
  }
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `hudi-common/src/main/java/org/apache/hudi/common/fs/HoodieWrapperFileSystem.java`
#### Snippet
```java
  public FileStatus[] globStatus(Path pathPattern, PathFilter filter) throws IOException {
    return executeFuncWithTimeMetrics(MetricName.globStatus.name(), pathPattern, () -> {
      return fileSystem.globStatus(convertToDefaultPath(pathPattern), filter);
    });
  }
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `hudi-common/src/main/java/org/apache/hudi/common/fs/HoodieWrapperFileSystem.java`
#### Snippet
```java
      throws IOException {
    return executeFuncWithTimeMetrics(MetricName.create.name(), f, () -> {
      return wrapOutputStream(f, fileSystem.create(convertToDefaultPath(f), overwrite, bufferSize, progress));
    });
  }
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `hudi-common/src/main/java/org/apache/hudi/common/fs/HoodieWrapperFileSystem.java`
#### Snippet
```java
  public boolean delete(Path f) throws IOException {
    return executeFuncWithTimeMetrics(MetricName.delete.name(), f, () -> {
      return delete(f, true);
    });
  }
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `hudi-common/src/main/java/org/apache/hudi/common/fs/HoodieWrapperFileSystem.java`
#### Snippet
```java
  public FSDataOutputStream create(Path f, boolean overwrite, int bufferSize) throws IOException {
    return executeFuncWithTimeMetrics(MetricName.create.name(), f, () -> {
      return wrapOutputStream(f, fileSystem.create(convertToDefaultPath(f), overwrite, bufferSize));
    });
  }
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `hudi-common/src/main/java/org/apache/hudi/common/fs/HoodieWrapperFileSystem.java`
#### Snippet
```java
  public FSDataOutputStream create(Path f, Progressable progress) throws IOException {
    return executeFuncWithTimeMetrics(MetricName.create.name(), f, () -> {
      return wrapOutputStream(f, fileSystem.create(convertToDefaultPath(f), progress));
    });
  }
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `hudi-common/src/main/java/org/apache/hudi/common/fs/HoodieWrapperFileSystem.java`
#### Snippet
```java
                                   short replication, long blockSize, Progressable progress, Options.ChecksumOpt checksumOpt) throws IOException {
    return executeFuncWithTimeMetrics(MetricName.create.name(), f, () -> {
      return wrapOutputStream(f, fileSystem.create(convertToDefaultPath(f), permission, flags, bufferSize, replication,
          blockSize, progress, checksumOpt));
    });
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `hudi-common/src/main/java/org/apache/hudi/common/model/CompactionOperation.java`
#### Snippet
```java
    Path dirPath = FSUtils.getPartitionPath(basePath, partitionPath);
    return dataFileName.map(df -> {
      return externalBaseFile.map(ext -> new HoodieBaseFile(new Path(dirPath, df).toString(), ext))
          .orElseGet(() -> new HoodieBaseFile(new Path(dirPath, df).toString()));
    });
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/IncrementalTimelineSyncFileSystemView.java`
#### Snippet
```java
        TimelineMetadataUtils.deserializeAvroMetadata(timeline.getInstantDetails(instant).get(), HoodieRollbackMetadata.class);

    metadata.getPartitionMetadata().entrySet().stream().forEach(e -> {
      removeFileSlicesForPartition(timeline, instant, e.getKey(), e.getValue().getSuccessDeleteFiles());
    });
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/IncrementalTimelineSyncFileSystemView.java`
#### Snippet
```java
    Map<String, List<Pair<String, String>>> partitionFiles =
        metadata.getHoodieRestoreMetadata().entrySet().stream().flatMap(entry -> {
          return entry.getValue().stream().flatMap(e -> e.getPartitionMetadata().entrySet().stream().flatMap(e2 -> {
            return e2.getValue().getSuccessDeleteFiles().stream().map(x -> Pair.of(e2.getKey(), x));
          }));
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/IncrementalTimelineSyncFileSystemView.java`
#### Snippet
```java
        metadata.getHoodieRestoreMetadata().entrySet().stream().flatMap(entry -> {
          return entry.getValue().stream().flatMap(e -> e.getPartitionMetadata().entrySet().stream().flatMap(e2 -> {
            return e2.getValue().getSuccessDeleteFiles().stream().map(x -> Pair.of(e2.getKey(), x));
          }));
        }).collect(Collectors.groupingBy(Pair::getKey));
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/IncrementalTimelineSyncFileSystemView.java`
#### Snippet
```java
          }));
        }).collect(Collectors.groupingBy(Pair::getKey));
    partitionFiles.entrySet().stream().forEach(e -> {
      removeFileSlicesForPartition(timeline, instant, e.getKey(),
          e.getValue().stream().map(x -> x.getValue()).collect(Collectors.toList()));
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/RocksDbBasedFileSystemView.java`
#### Snippet
```java
      // Now add them
      rocksDB.writeBatch(batch ->
          replacedFileGroupsInPartition.stream().forEach(fgToReplacedInstant -> {
            rocksDB.putInBatch(batch, schemaHelper.getColFamilyForReplacedFileGroups(),
                schemaHelper.getKeyForReplacedFileGroup(fgToReplacedInstant.getKey()), fgToReplacedInstant.getValue());
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/RocksDbBasedFileSystemView.java`
#### Snippet
```java
  void resetBootstrapBaseFileMapping(Stream<BootstrapBaseFileMapping> bootstrapBaseFileStream) {
    rocksDB.writeBatch(batch -> {
      bootstrapBaseFileStream.forEach(externalBaseFile -> {
        rocksDB.putInBatch(batch, schemaHelper.getColFamilyForBootstrapBaseFile(),
            schemaHelper.getKeyForBootstrapBaseFile(externalBaseFile.getFileGroupId()), externalBaseFile);
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/RocksDbBasedFileSystemView.java`
#### Snippet
```java
  @Override
  void removeBootstrapBaseFileMapping(Stream<BootstrapBaseFileMapping> bootstrapBaseFileStream) {
    rocksDB.writeBatch(batch -> {
      bootstrapBaseFileStream.forEach(externalBaseFile -> {
        ValidationUtils.checkArgument(
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/RocksDbBasedFileSystemView.java`
#### Snippet
```java
  @Override
  void addBootstrapBaseFileMapping(Stream<BootstrapBaseFileMapping> bootstrapBaseFileStream) {
    rocksDB.writeBatch(batch -> {
      bootstrapBaseFileStream.forEach(externalBaseFile -> {
        ValidationUtils.checkArgument(!isBootstrapBaseFilePresentForFileId(externalBaseFile.getFileGroupId()),
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/utils/AvroSchemaEvolutionUtils.java`
#### Snippet
```java
    InternalSchema internalSchemaAfterAddColumns = SchemaChangeUtils.applyTableChanges2Schema(oldTableSchema, addChange);
    TableChanges.ColumnUpdateChange typeChange = TableChanges.ColumnUpdateChange.get(internalSchemaAfterAddColumns);
    typeChangeColumns.stream().filter(f -> !inComingInternalSchema.findType(f).isNestedType()).forEach(col -> {
      typeChange.updateColumnType(col, inComingInternalSchema.findType(col));
    });
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/convert/AvroInternalSchemaConverter.java`
#### Snippet
```java
        }
        nextId.set(nextAssignId + fields.size());
        fields.stream().forEach(field -> {
          fieldTypes.add(visitAvroSchemaToBuildType(field.schema(), visited, false, nextId));
        });
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/convert/AvroInternalSchemaConverter.java`
#### Snippet
```java
      case UNION:
        List<Type> fTypes = new ArrayList<>();
        schema.getTypes().stream().forEach(t -> {
          fTypes.add(visitAvroSchemaToBuildType(t, visited, false, nextId));
        });
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieBackedTableMetadata.java`
#### Snippet
```java
    datasetTimeline.getRollbackAndRestoreTimeline().filterCompletedInstants().getInstantsAsStream()
        .filter(instant -> HoodieTimeline.compareTimestamps(instant.getTimestamp(), HoodieTimeline.GREATER_THAN, earliestInstantTime))
        .forEach(instant -> {
          validInstantTimestamps.addAll(getRollbackedCommits(instant, datasetTimeline));
        });
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieBackedTableMetadata.java`
#### Snippet
```java
        HoodieRestoreMetadata restoreMetadata = TimelineMetadataUtils.deserializeHoodieRestoreMetadata(
            timeline.getInstantDetails(instant).get());
        restoreMetadata.getHoodieRestoreMetadata().values().forEach(rms -> {
          rms.forEach(rm -> rollbackedCommits.addAll(rm.getCommitsRollback()));
        });
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieMetadataPayload.java`
#### Snippet
```java
  private static void validatePayload(int type, Map<String, HoodieMetadataFileInfo> filesystemMetadata) {
    if (type == METADATA_TYPE_FILE_LIST) {
      filesystemMetadata.forEach((fileName, fileInfo) -> {
        checkState(fileInfo.getIsDeleted() || fileInfo.getSize() > 0, "Existing files should have size > 0");
      });
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieMetadataPayload.java`
#### Snippet
```java
      validatePayload(type, filesystemMetadata);

      filesystemMetadata.forEach((key, fileInfo) -> {
        combinedFileInfo.merge(key, fileInfo,
            // Combine previous record w/ the new one, new records taking precedence over
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieTableMetadataUtil.java`
#### Snippet
```java

        // Extract appended file name from the absolute paths saved in getAppendFiles()
        pm.getRollbackLogFiles().forEach((path, size) -> {
          partitionToAppendedFiles.get(partition).merge(new Path(path).getName(), size, fileMergeFn);
        });
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieMetadataTableValidator.java`
#### Snippet
```java
    return sortedBaseFileList.stream()
        .filter(baseFile -> {
          return !baseDataFilesForCleaning.contains(baseFile.getFileName());
        }).collect(Collectors.toList());
  }
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/helpers/KafkaOffsetGen.java`
#### Snippet
```java
              // We need to pass some properties to kafka client so that KafkaAvroSchemaDeserializer can use it
              || prop.toString().startsWith(AvroKafkaSource.KAFKA_AVRO_VALUE_DESERIALIZER_PROPERTY_PREFIX);
    }).forEach(prop -> {
      kafkaParams.put(prop.toString(), props.get(prop.toString()));
    });
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `hudi-kafka-connect/src/main/java/org/apache/hudi/connect/utils/KafkaConnectUtils.java`
#### Snippet
```java
      // configuration items before passing to hadoop/hive configs
      return !prop.toString().startsWith(HOODIE_CONF_PREFIX);
    }).forEach(prop -> {
      hadoopConf.set(prop.toString(), connectConfigs.getProps().get(prop.toString()).toString());
    });
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/bootstrap/BootstrapOperator.java`
#### Snippet
```java
          }
          try (ClosableIterator<HoodieKey> iterator = fileUtils.getHoodieKeyIterator(this.hadoopConf, new Path(baseFile.getPath()))) {
            iterator.forEachRemaining(hoodieKey -> {
              output.collect(new StreamRecord(new IndexRecord(generateHoodieRecord(hoodieKey, fileSlice))));
            });
```

### CodeBlock2Expr
Statement lambda can be replaced with expression lambda
in `hudi-timeline-service/src/main/java/org/apache/hudi/timeline/service/handlers/marker/MarkerBasedEarlyConflictDetectionRunnable.java`
#### Snippet
```java
          MarkerUtils.markerDirToInstantTime(markerDir), maxAllowableHeartbeatIntervalInMs, fs, basePath);
      Set<String> tableMarkers = candidate.stream().flatMap(instant -> {
        return MarkerUtils.readTimelineServerBasedMarkersFromFileSystem(instant, fs, new HoodieLocalEngineContext(new Configuration()), 100)
            .values().stream().flatMap(Collection::stream);
      }).collect(Collectors.toSet());
```

## RuleId[ruleID=UseOfPropertiesAsHashtable]
### UseOfPropertiesAsHashtable
Call to `Hashtable.putIfAbsent()` on properties object
in `hudi-aws/src/main/java/org/apache/hudi/aws/transaction/lock/DynamoDBBasedLockProvider.java`
#### Snippet
```java
    ValidationUtils.checkArgument(config.getConfig().getString(DynamoDbBasedLockConfig.DYNAMODB_LOCK_REGION.key()) != null);
    ValidationUtils.checkArgument(config.getConfig().getString(DynamoDbBasedLockConfig.DYNAMODB_LOCK_PARTITION_KEY.key()) != null);
    config.getConfig().putIfAbsent(DynamoDbBasedLockConfig.DYNAMODB_LOCK_BILLING_MODE.key(), BillingMode.PAY_PER_REQUEST.name());
    config.getConfig().putIfAbsent(DynamoDbBasedLockConfig.DYNAMODB_LOCK_READ_CAPACITY.key(), "20");
    config.getConfig().putIfAbsent(DynamoDbBasedLockConfig.DYNAMODB_LOCK_WRITE_CAPACITY.key(), "10");
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.putIfAbsent()` on properties object
in `hudi-aws/src/main/java/org/apache/hudi/aws/transaction/lock/DynamoDBBasedLockProvider.java`
#### Snippet
```java
    ValidationUtils.checkArgument(config.getConfig().getString(DynamoDbBasedLockConfig.DYNAMODB_LOCK_PARTITION_KEY.key()) != null);
    config.getConfig().putIfAbsent(DynamoDbBasedLockConfig.DYNAMODB_LOCK_BILLING_MODE.key(), BillingMode.PAY_PER_REQUEST.name());
    config.getConfig().putIfAbsent(DynamoDbBasedLockConfig.DYNAMODB_LOCK_READ_CAPACITY.key(), "20");
    config.getConfig().putIfAbsent(DynamoDbBasedLockConfig.DYNAMODB_LOCK_WRITE_CAPACITY.key(), "10");
    config.getConfig().putIfAbsent(DynamoDbBasedLockConfig.DYNAMODB_LOCK_TABLE_CREATION_TIMEOUT.key(), "600000");
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.putIfAbsent()` on properties object
in `hudi-aws/src/main/java/org/apache/hudi/aws/transaction/lock/DynamoDBBasedLockProvider.java`
#### Snippet
```java
    config.getConfig().putIfAbsent(DynamoDbBasedLockConfig.DYNAMODB_LOCK_BILLING_MODE.key(), BillingMode.PAY_PER_REQUEST.name());
    config.getConfig().putIfAbsent(DynamoDbBasedLockConfig.DYNAMODB_LOCK_READ_CAPACITY.key(), "20");
    config.getConfig().putIfAbsent(DynamoDbBasedLockConfig.DYNAMODB_LOCK_WRITE_CAPACITY.key(), "10");
    config.getConfig().putIfAbsent(DynamoDbBasedLockConfig.DYNAMODB_LOCK_TABLE_CREATION_TIMEOUT.key(), "600000");
  }
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.putIfAbsent()` on properties object
in `hudi-aws/src/main/java/org/apache/hudi/aws/transaction/lock/DynamoDBBasedLockProvider.java`
#### Snippet
```java
    config.getConfig().putIfAbsent(DynamoDbBasedLockConfig.DYNAMODB_LOCK_READ_CAPACITY.key(), "20");
    config.getConfig().putIfAbsent(DynamoDbBasedLockConfig.DYNAMODB_LOCK_WRITE_CAPACITY.key(), "10");
    config.getConfig().putIfAbsent(DynamoDbBasedLockConfig.DYNAMODB_LOCK_TABLE_CREATION_TIMEOUT.key(), "600000");
  }

```

### UseOfPropertiesAsHashtable
Call to `Hashtable.putAll()` on properties object
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/replication/HiveSyncGlobalCommitParams.java`
#### Snippet
```java
  Properties mkGlobalHiveSyncProps(boolean forRemote) {
    TypedProperties props = new TypedProperties(loadedProps);
    props.putAll(globalHiveSyncConfigParams.toProps());
    String basePath = forRemote ? loadedProps.getProperty(REMOTE_BASE_PATH)
            : loadedProps.getProperty(LOCAL_BASE_PATH, loadedProps.getProperty(META_SYNC_BASE_PATH.key()));
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.putAll()` on properties object
in `hudi-sync/hudi-sync-common/src/main/java/org/apache/hudi/sync/common/util/SyncUtilHelpers.java`
#### Snippet
```java
                                                String baseFileFormat) {
    TypedProperties properties = new TypedProperties();
    properties.putAll(props);
    properties.put(HoodieSyncConfig.META_SYNC_BASE_PATH.key(), targetBasePath);
    properties.put(HoodieSyncConfig.META_SYNC_BASE_FILE_FORMAT.key(), baseFileFormat);
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-sync/hudi-sync-common/src/main/java/org/apache/hudi/sync/common/util/SyncUtilHelpers.java`
#### Snippet
```java
    TypedProperties properties = new TypedProperties();
    properties.putAll(props);
    properties.put(HoodieSyncConfig.META_SYNC_BASE_PATH.key(), targetBasePath);
    properties.put(HoodieSyncConfig.META_SYNC_BASE_FILE_FORMAT.key(), baseFileFormat);
    if (properties.containsKey(HoodieSyncConfig.META_SYNC_TABLE_NAME.key())) {
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-sync/hudi-sync-common/src/main/java/org/apache/hudi/sync/common/util/SyncUtilHelpers.java`
#### Snippet
```java
    properties.putAll(props);
    properties.put(HoodieSyncConfig.META_SYNC_BASE_PATH.key(), targetBasePath);
    properties.put(HoodieSyncConfig.META_SYNC_BASE_FILE_FORMAT.key(), baseFileFormat);
    if (properties.containsKey(HoodieSyncConfig.META_SYNC_TABLE_NAME.key())) {
      String tableName = properties.getString(HoodieSyncConfig.META_SYNC_TABLE_NAME.key());
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.get()` on properties object
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/table/action/commit/BulkInsertDataInternalWriterHelper.java`
#### Snippet
```java
    TypedProperties typedProperties = new TypedProperties();
    typedProperties.putAll(properties);
    if (Option.ofNullable(properties.get(HoodieWriteConfig.KEYGENERATOR_CLASS_NAME.key()))
        .map(v -> v.equals(NonpartitionedKeyGenerator.class.getName())).orElse(false)) {
      return Option.empty(); // Do not instantiate NonPartitionKeyGen
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/clustering/run/strategy/SparkConsistentBucketClusteringExecutionStrategy.java`
#### Snippet
```java
    Properties props = getWriteConfig().getProps();
    // We are calling another action executor - disable auto commit. Strategy is only expected to write data in new files.
    props.put(HoodieWriteConfig.AUTO_COMMIT_ENABLE.key(), Boolean.FALSE.toString());
    HoodieWriteConfig newConfig = HoodieWriteConfig.newBuilder().withProps(props).build();

```

### UseOfPropertiesAsHashtable
Call to `Hashtable.putAll()` on properties object
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/table/action/bootstrap/SparkBootstrapCommitActionExecutor.java`
#### Snippet
```java

    TypedProperties properties = new TypedProperties();
    properties.putAll(config.getProps());

    KeyGeneratorInterface keyGenerator;
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.putAll()` on properties object
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/table/action/bootstrap/SparkBootstrapCommitActionExecutor.java`
#### Snippet
```java
    }
    TypedProperties properties = new TypedProperties();
    properties.putAll(config.getProps());
    FullRecordBootstrapDataProvider inputProvider =
        (FullRecordBootstrapDataProvider) ReflectionUtils.loadClass(config.getFullBootstrapInputProvider(),
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.putAll()` on properties object
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/io/HoodieAppendHandle.java`
#### Snippet
```java
    this.sizeEstimator = new DefaultSizeEstimator();
    this.statuses = new ArrayList<>();
    this.recordProperties.putAll(config.getProps());
  }

```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/io/HoodieAppendHandle.java`
#### Snippet
```java
      // If the format can not record the operation field, nullify the DELETE payload manually.
      boolean nullifyPayload = HoodieOperation.isDelete(hoodieRecord.getOperation()) && !config.allowOperationMetadataField();
      recordProperties.put(HoodiePayloadProps.PAYLOAD_IS_UPDATE_RECORD_FOR_MOR, String.valueOf(isUpdateRecord));

      Option<HoodieRecord> finalRecordOpt = nullifyPayload ? Option.empty() : Option.of(hoodieRecord);
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.putAll()` on properties object
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/config/HoodieIndexConfig.java`
#### Snippet
```java

    public Builder withHBaseIndexConfig(HoodieHBaseIndexConfig hBaseIndexConfig) {
      hoodieIndexConfig.getProps().putAll(hBaseIndexConfig.getProps());
      return this;
    }
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.putAll()` on properties object
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java`
#### Snippet
```java

    public Builder withLockConfig(HoodieLockConfig lockConfig) {
      writeConfig.getProps().putAll(lockConfig.getProps());
      isLockConfigSet = true;
      return this;
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.putAll()` on properties object
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java`
#### Snippet
```java

    public Builder withMetricsGraphiteConfig(HoodieMetricsGraphiteConfig mericsGraphiteConfig) {
      writeConfig.getProps().putAll(mericsGraphiteConfig.getProps());
      isMetricsGraphiteConfigSet = true;
      return this;
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.putAll()` on properties object
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java`
#### Snippet
```java

    public Builder withCleanConfig(HoodieCleanConfig cleanConfig) {
      writeConfig.getProps().putAll(cleanConfig.getProps());
      isCleanConfigSet = true;
      return this;
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.putAll()` on properties object
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java`
#### Snippet
```java

    public Builder withMetadataConfig(HoodieMetadataConfig metadataConfig) {
      writeConfig.getProps().putAll(metadataConfig.getProps());
      isMetadataConfigSet = true;
      return this;
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.putAll()` on properties object
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java`
#### Snippet
```java

    public Builder withBootstrapConfig(HoodieBootstrapConfig bootstrapConfig) {
      writeConfig.getProps().putAll(bootstrapConfig.getProps());
      isBootstrapConfigSet = true;
      return this;
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.putAll()` on properties object
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java`
#### Snippet
```java

    public Builder withMetricsConfig(HoodieMetricsConfig metricsConfig) {
      writeConfig.getProps().putAll(metricsConfig.getProps());
      isMetricsConfigSet = true;
      return this;
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.putAll()` on properties object
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java`
#### Snippet
```java

    public Builder withPayloadConfig(HoodiePayloadConfig payloadConfig) {
      writeConfig.getProps().putAll(payloadConfig.getProps());
      isPayloadConfigSet = true;
      return this;
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.putAll()` on properties object
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java`
#### Snippet
```java

    public Builder withArchivalConfig(HoodieArchivalConfig cleanConfig) {
      writeConfig.getProps().putAll(cleanConfig.getProps());
      isArchivalConfigSet = true;
      return this;
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.putAll()` on properties object
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java`
#### Snippet
```java

    public Builder withIndexConfig(HoodieIndexConfig indexConfig) {
      writeConfig.getProps().putAll(indexConfig.getProps());
      isIndexConfigSet = true;
      return this;
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.putAll()` on properties object
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java`
#### Snippet
```java

    public Builder withConsistencyGuardConfig(ConsistencyGuardConfig consistencyGuardConfig) {
      writeConfig.getProps().putAll(consistencyGuardConfig.getProps());
      isConsistencyGuardSet = true;
      return this;
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.putAll()` on properties object
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java`
#### Snippet
```java

    public Builder withLayoutConfig(HoodieLayoutConfig layoutConfig) {
      writeConfig.getProps().putAll(layoutConfig.getProps());
      isLayoutConfigSet = true;
      return this;
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.putAll()` on properties object
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java`
#### Snippet
```java

    public Builder withPreCommitValidatorConfig(HoodiePreCommitValidatorConfig validatorConfig) {
      writeConfig.getProps().putAll(validatorConfig.getProps());
      isPreCommitValidationConfigSet = true;
      return this;
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.putAll()` on properties object
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java`
#### Snippet
```java

    public Builder withClusteringConfig(HoodieClusteringConfig clusteringConfig) {
      writeConfig.getProps().putAll(clusteringConfig.getProps());
      isClusteringConfigSet = true;
      return this;
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.putAll()` on properties object
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java`
#### Snippet
```java

    public Builder withCallbackConfig(HoodieWriteCommitCallbackConfig callbackConfig) {
      writeConfig.getProps().putAll(callbackConfig.getProps());
      isCallbackConfigSet = true;
      return this;
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.putAll()` on properties object
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java`
#### Snippet
```java

    public Builder withStorageConfig(HoodieStorageConfig storageConfig) {
      writeConfig.getProps().putAll(storageConfig.getProps());
      isStorageConfigSet = true;
      return this;
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.putAll()` on properties object
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java`
#### Snippet
```java

    public Builder withMetricsJmxConfig(HoodieMetricsJmxConfig metricsJmxConfig) {
      writeConfig.getProps().putAll(metricsJmxConfig.getProps());
      isMetricsJmxConfigSet = true;
      return this;
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.putAll()` on properties object
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java`
#### Snippet
```java

    public Builder withFileSystemViewConfig(FileSystemViewStorageConfig viewStorageConfig) {
      writeConfig.getProps().putAll(viewStorageConfig.getProps());
      isViewConfigSet = true;
      return this;
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.putAll()` on properties object
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java`
#### Snippet
```java

    public Builder withCompactionConfig(HoodieCompactionConfig compactionConfig) {
      writeConfig.getProps().putAll(compactionConfig.getProps());
      isCompactionConfigSet = true;
      return this;
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.putAll()` on properties object
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java`
#### Snippet
```java

    public Builder withMemoryConfig(HoodieMemoryConfig memoryConfig) {
      writeConfig.getProps().putAll(memoryConfig.getProps());
      isMemoryConfigSet = true;
      return this;
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.putAll()` on properties object
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java`
#### Snippet
```java

    public Builder withProps(Map kvprops) {
      writeConfig.getProps().putAll(kvprops);
      return this;
    }
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metadata/HoodieBackedTableMetadataWriter.java`
#### Snippet
```java
    // RecordKey properties are needed for the metadata table records
    final Properties properties = new Properties();
    properties.put(HoodieTableConfig.RECORDKEY_FIELDS.key(), RECORD_KEY_FIELD_NAME);
    properties.put("hoodie.datasource.write.recordkey.field", RECORD_KEY_FIELD_NAME);
    builder.withProperties(properties);
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metadata/HoodieBackedTableMetadataWriter.java`
#### Snippet
```java
    final Properties properties = new Properties();
    properties.put(HoodieTableConfig.RECORDKEY_FIELDS.key(), RECORD_KEY_FIELD_NAME);
    properties.put("hoodie.datasource.write.recordkey.field", RECORD_KEY_FIELD_NAME);
    builder.withProperties(properties);

```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metadata/HoodieBackedTableMetadataWriter.java`
#### Snippet
```java
      // Table Name is needed for metric reporters prefix
      Properties commonProperties = new Properties();
      commonProperties.put(HoodieWriteConfig.TBL_NAME.key(), tableName);

      builder.withMetricsConfig(HoodieMetricsConfig.newBuilder()
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-common/src/main/java/org/apache/hudi/common/table/HoodieTableConfig.java`
#### Snippet
```java
  private static Properties getOrderedPropertiesWithTableChecksum(Properties props) {
    Properties orderedProps = new OrderedProperties(props);
    orderedProps.put(TABLE_CHECKSUM.key(), String.valueOf(generateChecksum(props)));
    return orderedProps;
  }
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-common/src/main/java/org/apache/hudi/common/table/HoodieTableMetaClient.java`
#### Snippet
```java
    private void set(String key, Object value) {
      if (HoodieTableConfig.PERSISTED_CONFIG_LIST.contains(key)) {
        this.others.put(key, value);
      }
    }
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-common/src/main/java/org/apache/hudi/common/config/OrderedProperties.java`
#### Snippet
```java
    keys.remove(key);
    keys.add(key);
    return super.put(key, value);
  }

```

### UseOfPropertiesAsHashtable
Call to `Hashtable.putIfAbsent()` on properties object
in `hudi-common/src/main/java/org/apache/hudi/common/config/OrderedProperties.java`
#### Snippet
```java
      keys.add(key);
    }
    return super.putIfAbsent(key, value);
  }

```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-common/src/main/java/org/apache/hudi/common/config/OrderedProperties.java`
#### Snippet
```java
        keys.add(e.getKey());
      }
      super.put(e.getKey(), e.getValue());
    }
  }
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.get()` on properties object
in `hudi-common/src/main/java/org/apache/hudi/common/config/TypedProperties.java`
#### Snippet
```java
  @Override
  public String getProperty(String key) {
    Object oval = super.get(key);
    String sval = (oval != null) ? String.valueOf(oval) : null;
    return ((sval == null) && (defaults != null)) ? defaults.getProperty(key) : sval;
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.get()` on properties object
in `hudi-common/src/main/java/org/apache/hudi/common/config/TypedProperties.java`
#### Snippet
```java
      for (Enumeration<?> e = defaults.propertyNames(); e.hasMoreElements(); ) {
        Object k = e.nextElement();
        Object v = defaults.get(k);
        if (v != null) {
          put(k, v);
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.putAll()` on properties object
in `hudi-common/src/main/java/org/apache/hudi/common/config/DFSPropertiesConfiguration.java`
#### Snippet
```java
  public static TypedProperties getGlobalProps() {
    final TypedProperties globalProps = new TypedProperties();
    globalProps.putAll(GLOBAL_PROPS);
    return globalProps;
  }
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-common/src/main/java/org/apache/hudi/common/config/DFSPropertiesConfiguration.java`
#### Snippet
```java
  // test only
  public static TypedProperties addToGlobalProps(String key, String value) {
    GLOBAL_PROPS.put(key, value);
    return GLOBAL_PROPS;
  }
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.get()` on properties object
in `hudi-common/src/main/java/org/apache/hudi/common/config/HoodieConfig.java`
#### Snippet
```java
  private <T> Option<Object> getRawValue(ConfigProperty<T> configProperty) {
    if (props.containsKey(configProperty.key())) {
      return Option.ofNullable(props.get(configProperty.key()));
    }
    for (String alternative : configProperty.getAlternatives()) {
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.get()` on properties object
in `hudi-common/src/main/java/org/apache/hudi/common/config/HoodieConfig.java`
#### Snippet
```java
                + "and may be removed in the future. Please use the new key '%s' instead.",
            alternative, configProperty.key()));
        return Option.ofNullable(props.get(alternative));
      }
    }
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.putAll()` on properties object
in `hudi-common/src/main/java/org/apache/hudi/common/config/HoodieConfig.java`
#### Snippet
```java
    if (includeGlobalProps) {
      TypedProperties mergedProps = DFSPropertiesConfiguration.getGlobalProps();
      mergedProps.putAll(props);
      return mergedProps;
    } else {
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.putAll()` on properties object
in `hudi-common/src/main/java/org/apache/hudi/common/config/HoodieConfig.java`
#### Snippet
```java

  public void setDefault(HoodieConfig config) {
    props.putAll(config.getProps());
  }

```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-common/src/main/java/org/apache/hudi/secondary/index/SecondaryIndexManager.java`
#### Snippet
```java
    // Persistence secondary indexes' metadata to hoodie.properties file
    Properties updatedProps = new Properties();
    updatedProps.put(HoodieTableConfig.SECONDARY_INDEXES_METADATA.key(),
        SecondaryIndexUtils.toJsonString(newSecondaryIndexes));
    HoodieTableConfig.update(metaClient.getFs(), new Path(metaClient.getMetaPath()), updatedProps);
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-common/src/main/java/org/apache/hudi/secondary/index/SecondaryIndexManager.java`
#### Snippet
```java
    if (CollectionUtils.nonEmpty(secondaryIndexesToKeep)) {
      Properties updatedProps = new Properties();
      updatedProps.put(HoodieTableConfig.SECONDARY_INDEXES_METADATA.key(),
          SecondaryIndexUtils.toJsonString(secondaryIndexesToKeep));
      HoodieTableConfig.update(metaClient.getFs(), new Path(metaClient.getMetaPath()), updatedProps);
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDropPartitionsTool.java`
#### Snippet
```java
    verifyHiveConfigs();
    TypedProperties props = new TypedProperties();
    props.put(DataSourceWriteOptions.HIVE_DATABASE().key(), cfg.hiveDataBase);
    props.put(DataSourceWriteOptions.HIVE_TABLE().key(), cfg.hiveTableName);
    props.put(DataSourceWriteOptions.HIVE_USER().key(), cfg.hiveUserName);
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDropPartitionsTool.java`
#### Snippet
```java
    TypedProperties props = new TypedProperties();
    props.put(DataSourceWriteOptions.HIVE_DATABASE().key(), cfg.hiveDataBase);
    props.put(DataSourceWriteOptions.HIVE_TABLE().key(), cfg.hiveTableName);
    props.put(DataSourceWriteOptions.HIVE_USER().key(), cfg.hiveUserName);
    props.put(DataSourceWriteOptions.HIVE_PASS().key(), cfg.hivePassWord);
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDropPartitionsTool.java`
#### Snippet
```java
    props.put(DataSourceWriteOptions.HIVE_DATABASE().key(), cfg.hiveDataBase);
    props.put(DataSourceWriteOptions.HIVE_TABLE().key(), cfg.hiveTableName);
    props.put(DataSourceWriteOptions.HIVE_USER().key(), cfg.hiveUserName);
    props.put(DataSourceWriteOptions.HIVE_PASS().key(), cfg.hivePassWord);
    props.put(DataSourceWriteOptions.HIVE_URL().key(), cfg.hiveURL);
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDropPartitionsTool.java`
#### Snippet
```java
    props.put(DataSourceWriteOptions.HIVE_TABLE().key(), cfg.hiveTableName);
    props.put(DataSourceWriteOptions.HIVE_USER().key(), cfg.hiveUserName);
    props.put(DataSourceWriteOptions.HIVE_PASS().key(), cfg.hivePassWord);
    props.put(DataSourceWriteOptions.HIVE_URL().key(), cfg.hiveURL);
    props.put(DataSourceWriteOptions.HIVE_PARTITION_FIELDS().key(), cfg.hivePartitionsField);
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDropPartitionsTool.java`
#### Snippet
```java
    props.put(DataSourceWriteOptions.HIVE_USER().key(), cfg.hiveUserName);
    props.put(DataSourceWriteOptions.HIVE_PASS().key(), cfg.hivePassWord);
    props.put(DataSourceWriteOptions.HIVE_URL().key(), cfg.hiveURL);
    props.put(DataSourceWriteOptions.HIVE_PARTITION_FIELDS().key(), cfg.hivePartitionsField);
    props.put(DataSourceWriteOptions.HIVE_USE_JDBC().key(), cfg.hiveUseJdbc);
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDropPartitionsTool.java`
#### Snippet
```java
    props.put(DataSourceWriteOptions.HIVE_PASS().key(), cfg.hivePassWord);
    props.put(DataSourceWriteOptions.HIVE_URL().key(), cfg.hiveURL);
    props.put(DataSourceWriteOptions.HIVE_PARTITION_FIELDS().key(), cfg.hivePartitionsField);
    props.put(DataSourceWriteOptions.HIVE_USE_JDBC().key(), cfg.hiveUseJdbc);
    props.put(DataSourceWriteOptions.HIVE_SYNC_MODE().key(), cfg.hiveSyncMode);
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDropPartitionsTool.java`
#### Snippet
```java
    props.put(DataSourceWriteOptions.HIVE_URL().key(), cfg.hiveURL);
    props.put(DataSourceWriteOptions.HIVE_PARTITION_FIELDS().key(), cfg.hivePartitionsField);
    props.put(DataSourceWriteOptions.HIVE_USE_JDBC().key(), cfg.hiveUseJdbc);
    props.put(DataSourceWriteOptions.HIVE_SYNC_MODE().key(), cfg.hiveSyncMode);
    props.put(DataSourceWriteOptions.HIVE_IGNORE_EXCEPTIONS().key(), cfg.hiveSyncIgnoreException);
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDropPartitionsTool.java`
#### Snippet
```java
    props.put(DataSourceWriteOptions.HIVE_PARTITION_FIELDS().key(), cfg.hivePartitionsField);
    props.put(DataSourceWriteOptions.HIVE_USE_JDBC().key(), cfg.hiveUseJdbc);
    props.put(DataSourceWriteOptions.HIVE_SYNC_MODE().key(), cfg.hiveSyncMode);
    props.put(DataSourceWriteOptions.HIVE_IGNORE_EXCEPTIONS().key(), cfg.hiveSyncIgnoreException);
    props.put(DataSourceWriteOptions.HIVE_PASS().key(), cfg.hivePassWord);
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDropPartitionsTool.java`
#### Snippet
```java
    props.put(DataSourceWriteOptions.HIVE_USE_JDBC().key(), cfg.hiveUseJdbc);
    props.put(DataSourceWriteOptions.HIVE_SYNC_MODE().key(), cfg.hiveSyncMode);
    props.put(DataSourceWriteOptions.HIVE_IGNORE_EXCEPTIONS().key(), cfg.hiveSyncIgnoreException);
    props.put(DataSourceWriteOptions.HIVE_PASS().key(), cfg.hivePassWord);
    props.put(HiveSyncConfig.META_SYNC_BASE_PATH, cfg.basePath);
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDropPartitionsTool.java`
#### Snippet
```java
    props.put(DataSourceWriteOptions.HIVE_SYNC_MODE().key(), cfg.hiveSyncMode);
    props.put(DataSourceWriteOptions.HIVE_IGNORE_EXCEPTIONS().key(), cfg.hiveSyncIgnoreException);
    props.put(DataSourceWriteOptions.HIVE_PASS().key(), cfg.hivePassWord);
    props.put(HiveSyncConfig.META_SYNC_BASE_PATH, cfg.basePath);
    props.put(HiveSyncConfig.META_SYNC_BASE_FILE_FORMAT, "PARQUET");
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDropPartitionsTool.java`
#### Snippet
```java
    props.put(DataSourceWriteOptions.HIVE_IGNORE_EXCEPTIONS().key(), cfg.hiveSyncIgnoreException);
    props.put(DataSourceWriteOptions.HIVE_PASS().key(), cfg.hivePassWord);
    props.put(HiveSyncConfig.META_SYNC_BASE_PATH, cfg.basePath);
    props.put(HiveSyncConfig.META_SYNC_BASE_FILE_FORMAT, "PARQUET");
    props.put(DataSourceWriteOptions.PARTITIONS_TO_DELETE().key(), cfg.partitions);
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDropPartitionsTool.java`
#### Snippet
```java
    props.put(DataSourceWriteOptions.HIVE_PASS().key(), cfg.hivePassWord);
    props.put(HiveSyncConfig.META_SYNC_BASE_PATH, cfg.basePath);
    props.put(HiveSyncConfig.META_SYNC_BASE_FILE_FORMAT, "PARQUET");
    props.put(DataSourceWriteOptions.PARTITIONS_TO_DELETE().key(), cfg.partitions);
    props.put(DataSourceWriteOptions.HIVE_PARTITION_EXTRACTOR_CLASS().key(), cfg.partitionValueExtractorClass);
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDropPartitionsTool.java`
#### Snippet
```java
    props.put(HiveSyncConfig.META_SYNC_BASE_PATH, cfg.basePath);
    props.put(HiveSyncConfig.META_SYNC_BASE_FILE_FORMAT, "PARQUET");
    props.put(DataSourceWriteOptions.PARTITIONS_TO_DELETE().key(), cfg.partitions);
    props.put(DataSourceWriteOptions.HIVE_PARTITION_EXTRACTOR_CLASS().key(), cfg.partitionValueExtractorClass);
    props.put(KeyGeneratorOptions.PARTITIONPATH_FIELD_NAME.key(), cfg.hivePartitionsField);
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDropPartitionsTool.java`
#### Snippet
```java
    props.put(HiveSyncConfig.META_SYNC_BASE_FILE_FORMAT, "PARQUET");
    props.put(DataSourceWriteOptions.PARTITIONS_TO_DELETE().key(), cfg.partitions);
    props.put(DataSourceWriteOptions.HIVE_PARTITION_EXTRACTOR_CLASS().key(), cfg.partitionValueExtractorClass);
    props.put(KeyGeneratorOptions.PARTITIONPATH_FIELD_NAME.key(), cfg.hivePartitionsField);

```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDropPartitionsTool.java`
#### Snippet
```java
    props.put(DataSourceWriteOptions.PARTITIONS_TO_DELETE().key(), cfg.partitions);
    props.put(DataSourceWriteOptions.HIVE_PARTITION_EXTRACTOR_CLASS().key(), cfg.partitionValueExtractorClass);
    props.put(KeyGeneratorOptions.PARTITIONPATH_FIELD_NAME.key(), cfg.hivePartitionsField);

    return new HiveSyncConfig(props, new Configuration());
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDropPartitionsTool.java`
#### Snippet
```java

    // need to do commit in SparkDeletePartitionCommitActionExecutor#execute
    this.props.put(HoodieWriteConfig.AUTO_COMMIT_ENABLE.key(), "true");
    try (SparkRDDWriteClient<HoodieRecordPayload> client =  UtilHelpers.createHoodieClient(jsc, cfg.basePath, "", cfg.parallelism, Option.empty(), props)) {
      List<String> partitionsToDelete = Arrays.asList(cfg.partitions.split(","));
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/deser/KafkaAvroSchemaDeserializer.java`
#### Snippet
```java
    TypedProperties typedProperties = new TypedProperties();
    for (Entry<String, ?> entry : configs.entrySet()) {
      typedProperties.put(entry.getKey(), entry.getValue());
    }
    return typedProperties;
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/ProtoKafkaSource.java`
#### Snippet
```java
    DataSourceUtils.checkRequiredProperties(props, Collections.singletonList(
        ProtoClassBasedSchemaProvider.Config.PROTO_SCHEMA_CLASS_NAME.key()));
    props.put(NATIVE_KAFKA_KEY_DESERIALIZER_PROP, StringDeserializer.class);
    props.put(NATIVE_KAFKA_VALUE_DESERIALIZER_PROP, ByteArrayDeserializer.class);
    className = props.getString(ProtoClassBasedSchemaProvider.Config.PROTO_SCHEMA_CLASS_NAME.key());
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/ProtoKafkaSource.java`
#### Snippet
```java
        ProtoClassBasedSchemaProvider.Config.PROTO_SCHEMA_CLASS_NAME.key()));
    props.put(NATIVE_KAFKA_KEY_DESERIALIZER_PROP, StringDeserializer.class);
    props.put(NATIVE_KAFKA_VALUE_DESERIALIZER_PROP, ByteArrayDeserializer.class);
    className = props.getString(ProtoClassBasedSchemaProvider.Config.PROTO_SCHEMA_CLASS_NAME.key());
    this.offsetGen = new KafkaOffsetGen(props);
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/AvroKafkaSource.java`
#### Snippet
```java
    super(props, sparkContext, sparkSession, schemaProvider, SourceType.AVRO, metrics);

    props.put(NATIVE_KAFKA_KEY_DESERIALIZER_PROP, StringDeserializer.class.getName());
    deserializerClassName = props.getString(DataSourceWriteOptions.KAFKA_AVRO_VALUE_DESERIALIZER_CLASS().key(),
            DataSourceWriteOptions.KAFKA_AVRO_VALUE_DESERIALIZER_CLASS().defaultValue());
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/AvroKafkaSource.java`
#### Snippet
```java

    try {
      props.put(NATIVE_KAFKA_VALUE_DESERIALIZER_PROP, Class.forName(deserializerClassName).getName());
      if (deserializerClassName.equals(KafkaAvroSchemaDeserializer.class.getName())) {
        if (schemaProvider == null) {
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/AvroKafkaSource.java`
#### Snippet
```java
          throw new HoodieIOException("SchemaProvider has to be set to use KafkaAvroSchemaDeserializer");
        }
        props.put(KAFKA_AVRO_VALUE_DESERIALIZER_SCHEMA, schemaProvider.getSourceSchema().toString());
      }
    } catch (ClassNotFoundException e) {
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/JsonKafkaSource.java`
#### Snippet
```java
                         SchemaProvider schemaProvider, HoodieDeltaStreamerMetrics metrics) {
    super(properties, sparkContext, sparkSession, schemaProvider, SourceType.JSON, metrics);
    properties.put("key.deserializer", StringDeserializer.class.getName());
    properties.put("value.deserializer", StringDeserializer.class.getName());
    this.offsetGen = new KafkaOffsetGen(props);
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/JsonKafkaSource.java`
#### Snippet
```java
    super(properties, sparkContext, sparkSession, schemaProvider, SourceType.JSON, metrics);
    properties.put("key.deserializer", StringDeserializer.class.getName());
    properties.put("value.deserializer", StringDeserializer.class.getName());
    this.offsetGen = new KafkaOffsetGen(props);
  }
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.get()` on properties object
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/helpers/KafkaOffsetGen.java`
#### Snippet
```java
              || prop.toString().startsWith(AvroKafkaSource.KAFKA_AVRO_VALUE_DESERIALIZER_PROPERTY_PREFIX);
    }).forEach(prop -> {
      kafkaParams.put(prop.toString(), props.get(prop.toString()));
    });
    return kafkaParams;
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.putIfAbsent()` on properties object
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/BootstrapExecutor.java`
#### Snippet
```java

    // Add more defaults if full bootstrap requested
    this.props.putIfAbsent(DataSourceWriteOptions.PAYLOAD_CLASS_NAME().key(),
        DataSourceWriteOptions.PAYLOAD_CLASS_NAME().defaultValue());
    this.schemaProvider = UtilHelpers.createSchemaProvider(cfg.schemaProviderClassName, props, jssc);
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.putAll()` on properties object
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/BootstrapExecutor.java`
#### Snippet
```java
    if (cfg.enableHiveSync || cfg.enableMetaSync) {
      TypedProperties metaProps = new TypedProperties();
      metaProps.putAll(props);
      metaProps.put(META_SYNC_BASE_PATH.key(), cfg.targetBasePath);
      metaProps.put(META_SYNC_BASE_FILE_FORMAT.key(), cfg.baseFileFormat);
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/BootstrapExecutor.java`
#### Snippet
```java
      TypedProperties metaProps = new TypedProperties();
      metaProps.putAll(props);
      metaProps.put(META_SYNC_BASE_PATH.key(), cfg.targetBasePath);
      metaProps.put(META_SYNC_BASE_FILE_FORMAT.key(), cfg.baseFileFormat);
      if (props.getBoolean(HIVE_SYNC_BUCKET_SYNC.key(), HIVE_SYNC_BUCKET_SYNC.defaultValue())) {
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/BootstrapExecutor.java`
#### Snippet
```java
      metaProps.putAll(props);
      metaProps.put(META_SYNC_BASE_PATH.key(), cfg.targetBasePath);
      metaProps.put(META_SYNC_BASE_FILE_FORMAT.key(), cfg.baseFileFormat);
      if (props.getBoolean(HIVE_SYNC_BUCKET_SYNC.key(), HIVE_SYNC_BUCKET_SYNC.defaultValue())) {
        metaProps.put(HIVE_SYNC_BUCKET_SYNC_SPEC.key(), HiveSyncConfig.getBucketSpec(props.getString(HoodieIndexConfig.BUCKET_INDEX_HASH_FIELD.key()),
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/BootstrapExecutor.java`
#### Snippet
```java
      metaProps.put(META_SYNC_BASE_FILE_FORMAT.key(), cfg.baseFileFormat);
      if (props.getBoolean(HIVE_SYNC_BUCKET_SYNC.key(), HIVE_SYNC_BUCKET_SYNC.defaultValue())) {
        metaProps.put(HIVE_SYNC_BUCKET_SYNC_SPEC.key(), HiveSyncConfig.getBucketSpec(props.getString(HoodieIndexConfig.BUCKET_INDEX_HASH_FIELD.key()),
            props.getInteger(HoodieIndexConfig.BUCKET_INDEX_NUM_BUCKETS.key())));
      }
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.get()` on properties object
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/HoodieMultiTableDeltaStreamer.java`
#### Snippet
```java
      TypedProperties tableProperties = UtilHelpers.readConfig(fs.getConf(), new Path(configFilePath), new ArrayList<String>()).getProps();
      properties.forEach((k, v) -> {
        if (tableProperties.get(k) == null) {
          tableProperties.setProperty(k.toString(), v.toString());
        }
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-kafka-connect/src/main/java/org/apache/hudi/connect/kafka/KafkaControlProducer.java`
#### Snippet
```java
  private void start() {
    Properties props = new Properties();
    props.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, bootstrapServers);
    props.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, StringSerializer.class);
    props.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, ByteArraySerializer.class);
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-kafka-connect/src/main/java/org/apache/hudi/connect/kafka/KafkaControlProducer.java`
#### Snippet
```java
    Properties props = new Properties();
    props.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, bootstrapServers);
    props.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, StringSerializer.class);
    props.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, ByteArraySerializer.class);

```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-kafka-connect/src/main/java/org/apache/hudi/connect/kafka/KafkaControlProducer.java`
#### Snippet
```java
    props.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, bootstrapServers);
    props.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, StringSerializer.class);
    props.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, ByteArraySerializer.class);

    producer = new KafkaProducer<>(
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-kafka-connect/src/main/java/org/apache/hudi/connect/kafka/KafkaConnectControlAgent.java`
#### Snippet
```java
  private void start() {
    Properties props = new Properties();
    props.put(ConsumerConfig.BOOTSTRAP_SERVERS_CONFIG, bootstrapServers);
    // Todo fetch the worker id or name instead of a uuid.
    props.put(ConsumerConfig.GROUP_ID_CONFIG, "hudi-control-group" + UUID.randomUUID().toString());
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-kafka-connect/src/main/java/org/apache/hudi/connect/kafka/KafkaConnectControlAgent.java`
#### Snippet
```java
    props.put(ConsumerConfig.BOOTSTRAP_SERVERS_CONFIG, bootstrapServers);
    // Todo fetch the worker id or name instead of a uuid.
    props.put(ConsumerConfig.GROUP_ID_CONFIG, "hudi-control-group" + UUID.randomUUID().toString());
    props.put(ConsumerConfig.KEY_DESERIALIZER_CLASS_CONFIG, StringDeserializer.class);
    props.put(ConsumerConfig.VALUE_DESERIALIZER_CLASS_CONFIG, ByteArrayDeserializer.class);
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-kafka-connect/src/main/java/org/apache/hudi/connect/kafka/KafkaConnectControlAgent.java`
#### Snippet
```java
    // Todo fetch the worker id or name instead of a uuid.
    props.put(ConsumerConfig.GROUP_ID_CONFIG, "hudi-control-group" + UUID.randomUUID().toString());
    props.put(ConsumerConfig.KEY_DESERIALIZER_CLASS_CONFIG, StringDeserializer.class);
    props.put(ConsumerConfig.VALUE_DESERIALIZER_CLASS_CONFIG, ByteArrayDeserializer.class);

```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-kafka-connect/src/main/java/org/apache/hudi/connect/kafka/KafkaConnectControlAgent.java`
#### Snippet
```java
    props.put(ConsumerConfig.GROUP_ID_CONFIG, "hudi-control-group" + UUID.randomUUID().toString());
    props.put(ConsumerConfig.KEY_DESERIALIZER_CLASS_CONFIG, StringDeserializer.class);
    props.put(ConsumerConfig.VALUE_DESERIALIZER_CLASS_CONFIG, ByteArrayDeserializer.class);

    // Since we are using Kafka Control Topic as a RPC like interface,
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-kafka-connect/src/main/java/org/apache/hudi/connect/kafka/KafkaConnectControlAgent.java`
#### Snippet
```java
    // Since we are using Kafka Control Topic as a RPC like interface,
    // we want consumers to only process messages that are sent after they come online
    props.put(ConsumerConfig.AUTO_OFFSET_RESET_CONFIG, "latest");

    consumer = new KafkaConsumer<>(props, new StringDeserializer(), new ByteArrayDeserializer());
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.putAll()` on properties object
in `hudi-kafka-connect/src/main/java/org/apache/hudi/connect/writers/KafkaConnectConfigs.java`
#### Snippet
```java
    // Kafka connect task are passed with props with type Map<>
    public Builder withProperties(Map<?, ?> properties) {
      connectConfigs.getProps().putAll(properties);
      return this;
    }
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-kafka-connect/src/main/java/org/apache/hudi/connect/utils/KafkaConnectUtils.java`
#### Snippet
```java
  public static int getLatestNumPartitions(String bootstrapServers, String topicName) {
    Properties props = new Properties();
    props.put("bootstrap.servers", bootstrapServers);
    try {
      AdminClient client = AdminClient.create(props);
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.get()` on properties object
in `hudi-kafka-connect/src/main/java/org/apache/hudi/connect/utils/KafkaConnectUtils.java`
#### Snippet
```java
      return !prop.toString().startsWith(HOODIE_CONF_PREFIX);
    }).forEach(prop -> {
      hadoopConf.set(prop.toString(), connectConfigs.getProps().get(prop.toString()).toString());
    });
    return hadoopConf;
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/debezium/DebeziumSource.java`
#### Snippet
```java
    super(props, sparkContext, sparkSession, schemaProvider);

    props.put(NATIVE_KAFKA_KEY_DESERIALIZER_PROP, StringDeserializer.class.getName());
    deserializerClassName = props.getString(DataSourceWriteOptions.KAFKA_AVRO_VALUE_DESERIALIZER_CLASS().key(),
        DataSourceWriteOptions.KAFKA_AVRO_VALUE_DESERIALIZER_CLASS().defaultValue());
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/debezium/DebeziumSource.java`
#### Snippet
```java

    try {
      props.put(NATIVE_KAFKA_VALUE_DESERIALIZER_PROP, Class.forName(deserializerClassName).getName());
    } catch (ClassNotFoundException e) {
      String error = "Could not load custom avro kafka deserializer: " + deserializerClassName;
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.get()` on properties object
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/HoodieDeltaStreamer.java`
#### Snippet
```java
    StringBuilder propsLog = new StringBuilder("Creating delta streamer with configs:\n");
    for (String key : allKeys) {
      String value = Option.ofNullable(props.get(key)).orElse("").toString();
      // Truncate too long values.
      if (value.length() > 255 && !LOG.isDebugEnabled()) {
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.putAll()` on properties object
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/DeltaSync.java`
#### Snippet
```java

      TypedProperties metaProps = new TypedProperties();
      metaProps.putAll(props);
      metaProps.putAll(writeClient.getConfig().getProps());
      if (props.getBoolean(HIVE_SYNC_BUCKET_SYNC.key(), HIVE_SYNC_BUCKET_SYNC.defaultValue())) {
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.putAll()` on properties object
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/DeltaSync.java`
#### Snippet
```java
      TypedProperties metaProps = new TypedProperties();
      metaProps.putAll(props);
      metaProps.putAll(writeClient.getConfig().getProps());
      if (props.getBoolean(HIVE_SYNC_BUCKET_SYNC.key(), HIVE_SYNC_BUCKET_SYNC.defaultValue())) {
        metaProps.put(HIVE_SYNC_BUCKET_SYNC_SPEC.key(), HiveSyncConfig.getBucketSpec(props.getString(HoodieIndexConfig.BUCKET_INDEX_HASH_FIELD.key()),
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/DeltaSync.java`
#### Snippet
```java
      metaProps.putAll(writeClient.getConfig().getProps());
      if (props.getBoolean(HIVE_SYNC_BUCKET_SYNC.key(), HIVE_SYNC_BUCKET_SYNC.defaultValue())) {
        metaProps.put(HIVE_SYNC_BUCKET_SYNC_SPEC.key(), HiveSyncConfig.getBucketSpec(props.getString(HoodieIndexConfig.BUCKET_INDEX_HASH_FIELD.key()),
            props.getInteger(HoodieIndexConfig.BUCKET_INDEX_NUM_BUCKETS.key())));
      }
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/util/StreamerUtil.java`
#### Snippet
```java
  public static TypedProperties appendKafkaProps(FlinkStreamerConfig config) {
    TypedProperties properties = getProps(config);
    properties.put(ConsumerConfig.BOOTSTRAP_SERVERS_CONFIG, config.kafkaBootstrapServers);
    properties.put(ConsumerConfig.GROUP_ID_CONFIG, config.kafkaGroupId);
    return properties;
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/util/StreamerUtil.java`
#### Snippet
```java
    TypedProperties properties = getProps(config);
    properties.put(ConsumerConfig.BOOTSTRAP_SERVERS_CONFIG, config.kafkaBootstrapServers);
    properties.put(ConsumerConfig.GROUP_ID_CONFIG, config.kafkaGroupId);
    return properties;
  }
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/util/StreamerUtil.java`
#### Snippet
```java
    for (ConfigOption<?> option : FlinkOptions.optionalOptions()) {
      if (!flatConf.contains(option) && option.hasDefaultValue()) {
        properties.put(option.key(), option.defaultValue());
      }
    }
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.putAll()` on properties object
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/streamer/HoodieFlinkStreamer.java`
#### Snippet
```java

    TypedProperties kafkaProps = DFSPropertiesConfiguration.getGlobalProps();
    kafkaProps.putAll(StreamerUtil.appendKafkaProps(cfg));

    Configuration conf = FlinkStreamerConfig.toFlinkConfig(cfg);
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/source/FileIndex.java`
#### Snippet
```java

    // set up metadata.enabled=true in table DDL to enable metadata listing
    properties.put(HoodieMetadataConfig.ENABLE.key(), conf.getBoolean(FlinkOptions.METADATA_ENABLED));

    return HoodieMetadataConfig.newBuilder().fromProperties(properties).build();
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.putAll()` on properties object
in `hudi-spark-datasource/hudi-spark/src/main/java/org/apache/hudi/cli/BootstrapExecutorUtils.java`
#### Snippet
```java
    if (cfg.enableHiveSync) {
      TypedProperties metaProps = new TypedProperties();
      metaProps.putAll(props);
      metaProps.put(META_SYNC_BASE_PATH.key(), cfg.basePath);
      metaProps.put(META_SYNC_BASE_FILE_FORMAT.key(), cfg.baseFileFormat);
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-spark-datasource/hudi-spark/src/main/java/org/apache/hudi/cli/BootstrapExecutorUtils.java`
#### Snippet
```java
      TypedProperties metaProps = new TypedProperties();
      metaProps.putAll(props);
      metaProps.put(META_SYNC_BASE_PATH.key(), cfg.basePath);
      metaProps.put(META_SYNC_BASE_FILE_FORMAT.key(), cfg.baseFileFormat);
      if (props.getBoolean(HIVE_SYNC_BUCKET_SYNC.key(), HIVE_SYNC_BUCKET_SYNC.defaultValue())) {
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-spark-datasource/hudi-spark/src/main/java/org/apache/hudi/cli/BootstrapExecutorUtils.java`
#### Snippet
```java
      metaProps.putAll(props);
      metaProps.put(META_SYNC_BASE_PATH.key(), cfg.basePath);
      metaProps.put(META_SYNC_BASE_FILE_FORMAT.key(), cfg.baseFileFormat);
      if (props.getBoolean(HIVE_SYNC_BUCKET_SYNC.key(), HIVE_SYNC_BUCKET_SYNC.defaultValue())) {
        metaProps.put(HIVE_SYNC_BUCKET_SYNC_SPEC.key(), HiveSyncConfig.getBucketSpec(props.getString(BUCKET_INDEX_HASH_FIELD.key()),
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-spark-datasource/hudi-spark/src/main/java/org/apache/hudi/cli/BootstrapExecutorUtils.java`
#### Snippet
```java
      metaProps.put(META_SYNC_BASE_FILE_FORMAT.key(), cfg.baseFileFormat);
      if (props.getBoolean(HIVE_SYNC_BUCKET_SYNC.key(), HIVE_SYNC_BUCKET_SYNC.defaultValue())) {
        metaProps.put(HIVE_SYNC_BUCKET_SYNC_SPEC.key(), HiveSyncConfig.getBucketSpec(props.getString(BUCKET_INDEX_HASH_FIELD.key()),
            props.getInteger(BUCKET_INDEX_NUM_BUCKETS.key())));
      }
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.putIfAbsent()` on properties object
in `hudi-spark-datasource/hudi-spark/src/main/java/org/apache/hudi/cli/BootstrapExecutorUtils.java`
#### Snippet
```java

    // Add more defaults if full bootstrap requested
    this.props.putIfAbsent(DataSourceWriteOptions.PAYLOAD_CLASS_NAME().key(),
        DataSourceWriteOptions.PAYLOAD_CLASS_NAME().defaultValue());
    /*
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-spark-datasource/hudi-spark/src/main/java/org/apache/hudi/cli/BootstrapExecutorUtils.java`
#### Snippet
```java
      keyGenClass = props.getString(HoodieBootstrapConfig.KEYGEN_CLASS_NAME.key());
    } else if (StringUtils.nonEmpty(props.getString(HoodieBootstrapConfig.KEYGEN_TYPE.key(), null))) {
      props.put(HoodieWriteConfig.KEYGENERATOR_TYPE.key(), props.getString(HoodieBootstrapConfig.KEYGEN_TYPE.key()));
      keyGenClass = HoodieSparkKeyGeneratorFactory.getKeyGeneratorClassName(props);
    } else {
```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-spark-datasource/hudi-spark/src/main/java/org/apache/hudi/cli/BootstrapExecutorUtils.java`
#### Snippet
```java
      keyGenClass = props.getString(HoodieTableConfig.KEY_GENERATOR_CLASS_NAME.key(), SimpleKeyGenerator.class.getName());
    }
    props.put(HoodieWriteConfig.KEYGENERATOR_CLASS_NAME.key(), keyGenClass);
    String partitionColumns = SparkKeyGenUtils.getPartitionColumns(props);

```

### UseOfPropertiesAsHashtable
Call to `Hashtable.put()` on properties object
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/keygen/CustomKeyGenerator.java`
#### Snippet
```java
    //         - Expected to bear this config
    //         - Can't be stubbed out w/ null
    filtered.put(KeyGeneratorOptions.PARTITIONPATH_FIELD_NAME.key(), "");
    return filtered;
  }
```

## RuleId[ruleID=EmptyMethod]
### EmptyMethod
The method and all its derivables are empty
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/utils/LazyIterableIterator.java`
#### Snippet
```java
   * Called once, before any elements are processed.
   */
  protected void start() {}

  /**
```

### EmptyMethod
The method and all its derivables are empty
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/utils/LazyIterableIterator.java`
#### Snippet
```java
   * Called once, after all elements are processed.
   */
  protected void end() {}

  //////////////////
```

### EmptyMethod
All implementations of this method are empty
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/io/storage/row/HoodieRowDataFileWriter.java`
#### Snippet
```java
   * Closes the {@link HoodieRowDataFileWriter} and may not take in any more writes.
   */
  void close() throws IOException;
}

```

### EmptyMethod
Method only calls its super
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/io/storage/HoodieSparkParquetWriter.java`
#### Snippet
```java

  @Override
  public void close() throws IOException {
    super.close();
  }
```

### EmptyMethod
The method is empty
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/table/action/commit/BulkInsertDataInternalWriterHelper.java`
#### Snippet
```java
  }

  public void abort() {}

  public void close() throws IOException {
```

### EmptyMethod
All implementations of this method are empty
in `hudi-common/src/main/java/org/apache/hudi/BaseHoodieTableFileIndex.java`
#### Snippet
```java
    Option<FileStatus[]> get(Path path);

    void put(Path path, FileStatus[] leafFiles);

    void invalidate();
```

### EmptyMethod
All implementations of this method are empty
in `hudi-common/src/main/java/org/apache/hudi/BaseHoodieTableFileIndex.java`
#### Snippet
```java
    void put(Path path, FileStatus[] leafFiles);

    void invalidate();
  }
}
```

### EmptyMethod
Method only calls its super
in `hudi-common/src/main/java/org/apache/hudi/common/fs/HoodieWrapperFileSystem.java`
#### Snippet
```java

  @Override
  public void close() throws IOException {
    // Don't close the wrapped `fileSystem` object. This will end up closing it for every thread since it
    // could be cached across jvm. We don't own that object anyway.
```

### EmptyMethod
Method only calls its super
in `hudi-common/src/main/java/org/apache/hudi/io/storage/HoodieAvroParquetWriter.java`
#### Snippet
```java

  @Override
  public void close() throws IOException {
    super.close();
  }
```

### EmptyMethod
The method is empty
in `hudi-common/src/main/java/org/apache/hudi/secondary/index/SecondaryIndexManager.java`
#### Snippet
```java
   * @param indexName  The target secondary index name
   */
  public void refresh(HoodieTableMetaClient metaClient, String indexName) {
    // TODO
  }
```

### EmptyMethod
The method is empty
in `hudi-flink-datasource/hudi-flink1.13.x/src/main/java/org/apache/hudi/table/format/cow/vector/reader/AbstractColumnReader.java`
#### Snippet
```java
   * After read a page, we may need some initialization.
   */
  protected void afterReadPage() {
  }

```

### EmptyMethod
The method is empty
in `hudi-flink-datasource/hudi-flink1.14.x/src/main/java/org/apache/hudi/table/format/cow/vector/reader/AbstractColumnReader.java`
#### Snippet
```java
   * After read a page, we may need some initialization.
   */
  protected void afterReadPage() {
  }

```

### EmptyMethod
The method is empty
in `hudi-flink-datasource/hudi-flink1.15.x/src/main/java/org/apache/hudi/table/format/cow/vector/reader/AbstractColumnReader.java`
#### Snippet
```java
   * After read a page, we may need some initialization.
   */
  protected void afterReadPage() {
  }

```

### EmptyMethod
The method is empty
in `hudi-flink-datasource/hudi-flink1.16.x/src/main/java/org/apache/hudi/table/format/cow/vector/reader/AbstractColumnReader.java`
#### Snippet
```java
   * After read a page, we may need some initialization.
   */
  protected void afterReadPage() {
  }

```

## RuleId[ruleID=RedundantFieldInitialization]
### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-cli/src/main/java/org/apache/hudi/cli/Table.java`
#### Snippet
```java
  private final List<List<Comparable>> rawRows;
  // Flag to determine if all the rows have been added
  private boolean finishedAdding = false;
  // Headers ready for rendering
  private TableHeader renderHeaders;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/replication/HiveSyncGlobalCommitParams.java`
#### Snippet
```java
  public Properties loadedProps = new Properties();

  private boolean finalize = false;

  public void load() throws IOException {
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/transaction/lock/HiveMetastoreBasedLockProvider.java`
#### Snippet
```java
  private final String hiveMetastoreUris;
  private IMetaStoreClient hiveClient;
  private volatile LockResponse lock = null;
  protected LockConfiguration lockConfiguration;
  ExecutorService executor = Executors.newSingleThreadExecutor();
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-sync/hudi-sync-common/src/main/java/org/apache/hudi/sync/common/HoodieSyncConfig.java`
#### Snippet
```java

    @Parameter(names = {"--help", "-h"}, help = true)
    public boolean help = false;

    public boolean isHelp() {
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/table/action/commit/JavaUpsertPartitioner.java`
#### Snippet
```java
   * Total number of RDD partitions, is determined by total buckets we want to pack the incoming workload into.
   */
  private int totalBuckets = 0;
  /**
   * Stat for the input and output workload. Describe the workload before and after being assigned buckets.
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/io/FlinkAppendHandle.java`
#### Snippet
```java
  private static final Logger LOG = LoggerFactory.getLogger(FlinkAppendHandle.class);

  private boolean isClosed = false;
  private final WriteMarkers writeMarkers;

```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/io/FlinkMergeHandle.java`
#### Snippet
```java
  private static final Logger LOG = LogManager.getLogger(FlinkMergeHandle.class);

  private boolean isClosed = false;

  /**
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/io/FlinkMergeAndReplaceHandle.java`
#### Snippet
```java
  private static final Logger LOG = LogManager.getLogger(FlinkMergeAndReplaceHandle.class);

  private boolean isClosed = false;

  /**
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/io/FlinkCreateHandle.java`
#### Snippet
```java
  private static final Logger LOG = LogManager.getLogger(FlinkCreateHandle.class);

  private boolean isClosed = false;

  public FlinkCreateHandle(HoodieWriteConfig config, String instantTime, HoodieTable<T, I, K, O> hoodieTable,
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/table/HoodieSparkTable.java`
#### Snippet
```java
    extends HoodieTable<T, HoodieData<HoodieRecord<T>>, HoodieData<HoodieKey>, HoodieData<WriteStatus>> {

  private volatile boolean isMetadataTableExists = false;

  protected HoodieSparkTable(HoodieWriteConfig config, HoodieEngineContext context, HoodieTableMetaClient metaClient) {
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/table/action/commit/BulkInsertDataInternalWriterHelper.java`
#### Snippet
```java
  private UTF8String lastKnownPartitionPath = null;
  private HoodieRowCreateHandle handle;
  private int numFilesWritten = 0;

  public BulkInsertDataInternalWriterHelper(HoodieTable hoodieTable, HoodieWriteConfig writeConfig,
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/table/action/commit/BulkInsertDataInternalWriterHelper.java`
#### Snippet
```java
   *       conversion (deserialization) b/w {@link UTF8String} and {@link String}
   */
  private UTF8String lastKnownPartitionPath = null;
  private HoodieRowCreateHandle handle;
  private int numFilesWritten = 0;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/table/action/commit/UpsertPartitioner.java`
#### Snippet
```java
   * Total number of RDD partitions, is determined by total buckets we want to pack the incoming workload into.
   */
  private int totalBuckets = 0;
  /**
   * Helps decide which bucket an incoming update should go to.
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/index/hbase/SparkHoodieHBaseIndex.java`
#### Snippet
```java

  private static final Logger LOG = LogManager.getLogger(SparkHoodieHBaseIndex.class);
  private static Connection hbaseConnection = null;
  private HBaseIndexQPSResourceAllocator hBaseIndexQPSResourceAllocator = null;
  private int maxQpsPerRegionServer;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/index/hbase/SparkHoodieHBaseIndex.java`
#### Snippet
```java
  private static final Logger LOG = LogManager.getLogger(SparkHoodieHBaseIndex.class);
  private static Connection hbaseConnection = null;
  private HBaseIndexQPSResourceAllocator hBaseIndexQPSResourceAllocator = null;
  private int maxQpsPerRegionServer;
  private long totalNumInserts;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/table/action/bootstrap/SparkBootstrapCommitActionExecutor.java`
#### Snippet
```java

  private static final Logger LOG = LogManager.getLogger(SparkBootstrapCommitActionExecutor.class);
  protected String bootstrapSchema = null;
  private transient FileSystem bootstrapSourceFileSystem;

```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/io/CreateHandleFactory.java`
#### Snippet
```java
public class CreateHandleFactory<T, I, K, O> extends WriteHandleFactory<T, I, K, O> implements Serializable {

  private boolean preserveMetadata = false;

  public CreateHandleFactory() {
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/io/HoodieCDCLogger.java`
#### Snippet
```java

  // Average cdc record size. This size is updated at the end of every log block flushed to disk
  private long averageCDCRecordSize = 0;

  // Number of records that must be written to meet the max block size for a log block
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/io/WriteHandleFactory.java`
#### Snippet
```java

public abstract class WriteHandleFactory<T, I, K, O> implements Serializable {
  private int numFilesWritten = 0;

  public abstract HoodieWriteHandle<T, I, K, O> create(HoodieWriteConfig config, String commitTime, HoodieTable<T, I, K, O> hoodieTable,
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/index/bloom/KeyRangeNode.java`
#### Snippet
```java
  private String rightSubTreeMax = null;
  private String leftSubTreeMax = null;
  private String rightSubTreeMin = null;
  private String leftSubTreeMin = null;
  private KeyRangeNode left = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/index/bloom/KeyRangeNode.java`
#### Snippet
```java
  private String rightSubTreeMin = null;
  private String leftSubTreeMin = null;
  private KeyRangeNode left = null;
  private KeyRangeNode right = null;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/index/bloom/KeyRangeNode.java`
#### Snippet
```java
  private final String minRecordKey;
  private final String maxRecordKey;
  private String rightSubTreeMax = null;
  private String leftSubTreeMax = null;
  private String rightSubTreeMin = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/index/bloom/KeyRangeNode.java`
#### Snippet
```java
  private String leftSubTreeMin = null;
  private KeyRangeNode left = null;
  private KeyRangeNode right = null;

  /**
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/index/bloom/KeyRangeNode.java`
#### Snippet
```java
  private String leftSubTreeMax = null;
  private String rightSubTreeMin = null;
  private String leftSubTreeMin = null;
  private KeyRangeNode left = null;
  private KeyRangeNode right = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/index/bloom/KeyRangeNode.java`
#### Snippet
```java
  private final String maxRecordKey;
  private String rightSubTreeMax = null;
  private String leftSubTreeMax = null;
  private String rightSubTreeMin = null;
  private String leftSubTreeMin = null;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/io/HoodieAppendHandle.java`
#### Snippet
```java
  protected long updatedRecordsWritten = 0;
  // Total number of new records inserted into the delta file
  protected long insertRecordsWritten = 0;

  // Average record size for a HoodieRecord. This size is updated at the end of every log block flushed to disk
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/io/HoodieAppendHandle.java`
#### Snippet
```java
  protected long recordsDeleted = 0;
  // Total number of records updated during an append
  protected long updatedRecordsWritten = 0;
  // Total number of new records inserted into the delta file
  protected long insertRecordsWritten = 0;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/io/HoodieAppendHandle.java`
#### Snippet
```java
  private boolean isLogCompaction = false;
  // use writer schema for log compaction.
  private boolean useWriterSchema = false;

  private Properties recordProperties = new Properties();
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/io/HoodieAppendHandle.java`
#### Snippet
```java
  protected final List<WriteStatus> statuses;
  // Total number of records written during an append
  protected long recordsWritten = 0;
  // Total number of records deleted during an append
  protected long recordsDeleted = 0;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/io/HoodieAppendHandle.java`
#### Snippet
```java
  protected long recordsWritten = 0;
  // Total number of records deleted during an append
  protected long recordsDeleted = 0;
  // Total number of records updated during an append
  protected long updatedRecordsWritten = 0;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/io/HoodieAppendHandle.java`
#### Snippet
```java
  protected long estimatedNumberOfBytesWritten;
  // Number of records that must be written to meet the max block size for a log block
  private int numberOfRecords = 0;
  // Max block size to limit to for a log block
  private final int maxBlockSize = config.getLogFileDataBlockMaxSize();
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/io/HoodieAppendHandle.java`
#### Snippet
```java

  // Average record size for a HoodieRecord. This size is updated at the end of every log block flushed to disk
  private long averageRecordSize = 0;
  // Flag used to initialize some metadata
  private boolean doInit = true;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/io/HoodieAppendHandle.java`
#### Snippet
```java
  private String baseInstantTime;
  // This is used to distinguish between normal append and logcompaction's append operation.
  private boolean isLogCompaction = false;
  // use writer schema for log compaction.
  private boolean useWriterSchema = false;
```

### RedundantFieldInitialization
Field initialization to `0L` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/WorkloadStat.java`
#### Snippet
```java
  private long numInserts = 0L;

  private long numUpdates = 0L;

  private HashMap<String, Pair<String, Long>> insertLocationToCount;
```

### RedundantFieldInitialization
Field initialization to `0L` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/WorkloadStat.java`
#### Snippet
```java
public class WorkloadStat implements Serializable {

  private long numInserts = 0L;

  private long numUpdates = 0L;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/io/HoodieMergeHandle.java`
#### Snippet
```java
  protected long recordsWritten = 0;
  protected long recordsDeleted = 0;
  protected long updatedRecordsWritten = 0;
  protected long insertRecordsWritten = 0;
  protected boolean useWriterSchemaForCompaction;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/io/HoodieMergeHandle.java`
#### Snippet
```java
  protected Path oldFilePath;
  protected long recordsWritten = 0;
  protected long recordsDeleted = 0;
  protected long updatedRecordsWritten = 0;
  protected long insertRecordsWritten = 0;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/io/HoodieMergeHandle.java`
#### Snippet
```java
  protected Set<String> writtenRecordKeys;
  protected HoodieFileWriter fileWriter;
  private boolean preserveMetadata = false;

  protected Path newFilePath;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/io/HoodieMergeHandle.java`
#### Snippet
```java
  protected long recordsDeleted = 0;
  protected long updatedRecordsWritten = 0;
  protected long insertRecordsWritten = 0;
  protected boolean useWriterSchemaForCompaction;
  protected Option<BaseKeyGenerator> keyGeneratorOpt;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/io/HoodieMergeHandle.java`
#### Snippet
```java
  protected Path newFilePath;
  protected Path oldFilePath;
  protected long recordsWritten = 0;
  protected long recordsDeleted = 0;
  protected long updatedRecordsWritten = 0;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/io/HoodieCreateHandle.java`
#### Snippet
```java
  protected long recordsDeleted = 0;
  private Map<String, HoodieRecord<T>> recordMap;
  private boolean useWriterSchema = false;
  private final boolean preserveMetadata;

```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/io/HoodieCreateHandle.java`
#### Snippet
```java
  protected long recordsWritten = 0;
  protected long insertRecordsWritten = 0;
  protected long recordsDeleted = 0;
  private Map<String, HoodieRecord<T>> recordMap;
  private boolean useWriterSchema = false;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/io/HoodieCreateHandle.java`
#### Snippet
```java
  protected HoodieFileWriter fileWriter;
  protected final Path path;
  protected long recordsWritten = 0;
  protected long insertRecordsWritten = 0;
  protected long recordsDeleted = 0;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/io/HoodieCreateHandle.java`
#### Snippet
```java
  protected final Path path;
  protected long recordsWritten = 0;
  protected long insertRecordsWritten = 0;
  protected long recordsDeleted = 0;
  private Map<String, HoodieRecord<T>> recordMap;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/HoodieInternalWriteStatus.java`
#### Snippet
```java
  private HoodieWriteStat stat;

  private long totalRecords = 0;
  private long totalErrorRecords = 0;
  private Throwable globalError = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/HoodieInternalWriteStatus.java`
#### Snippet
```java
  private long totalRecords = 0;
  private long totalErrorRecords = 0;
  private Throwable globalError = null;

  private final double failureFraction;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/HoodieInternalWriteStatus.java`
#### Snippet
```java

  private long totalRecords = 0;
  private long totalErrorRecords = 0;
  private Throwable globalError = null;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/WriteStatus.java`
#### Snippet
```java
  private Throwable globalError = null;

  private String fileId = null;

  private String partitionPath = null;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/WriteStatus.java`
#### Snippet
```java

  private long totalRecords = 0;
  private long totalErrorRecords = 0;

  private final double failureFraction;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/WriteStatus.java`
#### Snippet
```java
  private String fileId = null;

  private String partitionPath = null;

  private HoodieWriteStat stat = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/WriteStatus.java`
#### Snippet
```java
  private String partitionPath = null;

  private HoodieWriteStat stat = null;

  private long totalRecords = 0;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/WriteStatus.java`
#### Snippet
```java
  private final List<HoodieRecord> failedRecords = new ArrayList<>();

  private Throwable globalError = null;

  private String fileId = null;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/WriteStatus.java`
#### Snippet
```java
  private HoodieWriteStat stat = null;

  private long totalRecords = 0;
  private long totalErrorRecords = 0;

```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/utils/LazyIterableIterator.java`
#### Snippet
```java

  protected Iterator<I> inputItr;
  private boolean consumed = false;
  private boolean startCalled = false;
  private boolean endCalled = false;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/utils/LazyIterableIterator.java`
#### Snippet
```java
  private boolean consumed = false;
  private boolean startCalled = false;
  private boolean endCalled = false;

  public LazyIterableIterator(Iterator<I> in) {
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/utils/LazyIterableIterator.java`
#### Snippet
```java
  protected Iterator<I> inputItr;
  private boolean consumed = false;
  private boolean startCalled = false;
  private boolean endCalled = false;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/transaction/lock/ZookeeperBasedLockProvider.java`
#### Snippet
```java

  private final transient CuratorFramework curatorFrameworkClient;
  private volatile InterProcessMutex lock = null;
  protected LockConfiguration lockConfiguration;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metrics/Metrics.java`
#### Snippet
```java

  private static volatile boolean initialized = false;
  private static Metrics instance = null;

  private final MetricRegistry registry;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metrics/Metrics.java`
#### Snippet
```java
  private static final Logger LOG = LogManager.getLogger(Metrics.class);

  private static volatile boolean initialized = false;
  private static Metrics instance = null;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metrics/HoodieMetrics.java`
#### Snippet
```java
  private Timer deltaCommitTimer = null;
  private Timer finalizeTimer = null;
  private Timer compactionTimer = null;
  private Timer logCompactionTimer = null;
  private Timer clusteringTimer = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metrics/HoodieMetrics.java`
#### Snippet
```java
  private HoodieWriteConfig config;
  private String tableName;
  private Timer rollbackTimer = null;
  private Timer cleanTimer = null;
  private Timer commitTimer = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metrics/HoodieMetrics.java`
#### Snippet
```java
  public String compactionTimerName = null;
  public String indexTimerName = null;
  private String conflictResolutionTimerName = null;
  private String conflictResolutionSuccessCounterName = null;
  private String conflictResolutionFailureCounterName = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metrics/HoodieMetrics.java`
#### Snippet
```java
  private Timer clusteringTimer = null;
  private Timer indexTimer = null;
  private Timer conflictResolutionTimer = null;
  private Counter conflictResolutionSuccessCounter = null;
  private Counter conflictResolutionFailureCounter = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metrics/HoodieMetrics.java`
#### Snippet
```java
  public String cleanTimerName = null;
  public String commitTimerName = null;
  public String logCompactionTimerName = null;
  public String deltaCommitTimerName = null;
  public String replaceCommitTimerName = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metrics/HoodieMetrics.java`
#### Snippet
```java
  public String deltaCommitTimerName = null;
  public String replaceCommitTimerName = null;
  public String finalizeTimerName = null;
  public String compactionTimerName = null;
  public String indexTimerName = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metrics/HoodieMetrics.java`
#### Snippet
```java
  public String logCompactionTimerName = null;
  public String deltaCommitTimerName = null;
  public String replaceCommitTimerName = null;
  public String finalizeTimerName = null;
  public String compactionTimerName = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metrics/HoodieMetrics.java`
#### Snippet
```java
  private static final Logger LOG = LogManager.getLogger(HoodieMetrics.class);
  // Some timers
  public String rollbackTimerName = null;
  public String cleanTimerName = null;
  public String commitTimerName = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metrics/HoodieMetrics.java`
#### Snippet
```java
  public String rollbackTimerName = null;
  public String cleanTimerName = null;
  public String commitTimerName = null;
  public String logCompactionTimerName = null;
  public String deltaCommitTimerName = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metrics/HoodieMetrics.java`
#### Snippet
```java
  public String replaceCommitTimerName = null;
  public String finalizeTimerName = null;
  public String compactionTimerName = null;
  public String indexTimerName = null;
  private String conflictResolutionTimerName = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metrics/HoodieMetrics.java`
#### Snippet
```java
  public String finalizeTimerName = null;
  public String compactionTimerName = null;
  public String indexTimerName = null;
  private String conflictResolutionTimerName = null;
  private String conflictResolutionSuccessCounterName = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metrics/HoodieMetrics.java`
#### Snippet
```java
  private String conflictResolutionTimerName = null;
  private String conflictResolutionSuccessCounterName = null;
  private String conflictResolutionFailureCounterName = null;
  private HoodieWriteConfig config;
  private String tableName;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metrics/HoodieMetrics.java`
#### Snippet
```java
  private Timer logCompactionTimer = null;
  private Timer clusteringTimer = null;
  private Timer indexTimer = null;
  private Timer conflictResolutionTimer = null;
  private Counter conflictResolutionSuccessCounter = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metrics/HoodieMetrics.java`
#### Snippet
```java
  private Timer finalizeTimer = null;
  private Timer compactionTimer = null;
  private Timer logCompactionTimer = null;
  private Timer clusteringTimer = null;
  private Timer indexTimer = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metrics/HoodieMetrics.java`
#### Snippet
```java
  // Some timers
  public String rollbackTimerName = null;
  public String cleanTimerName = null;
  public String commitTimerName = null;
  public String logCompactionTimerName = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metrics/HoodieMetrics.java`
#### Snippet
```java
  private Timer cleanTimer = null;
  private Timer commitTimer = null;
  private Timer deltaCommitTimer = null;
  private Timer finalizeTimer = null;
  private Timer compactionTimer = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metrics/HoodieMetrics.java`
#### Snippet
```java
  private Timer rollbackTimer = null;
  private Timer cleanTimer = null;
  private Timer commitTimer = null;
  private Timer deltaCommitTimer = null;
  private Timer finalizeTimer = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metrics/HoodieMetrics.java`
#### Snippet
```java
  private Timer conflictResolutionTimer = null;
  private Counter conflictResolutionSuccessCounter = null;
  private Counter conflictResolutionFailureCounter = null;

  public HoodieMetrics(HoodieWriteConfig config) {
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metrics/HoodieMetrics.java`
#### Snippet
```java
  private Timer commitTimer = null;
  private Timer deltaCommitTimer = null;
  private Timer finalizeTimer = null;
  private Timer compactionTimer = null;
  private Timer logCompactionTimer = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metrics/HoodieMetrics.java`
#### Snippet
```java
  private String tableName;
  private Timer rollbackTimer = null;
  private Timer cleanTimer = null;
  private Timer commitTimer = null;
  private Timer deltaCommitTimer = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metrics/HoodieMetrics.java`
#### Snippet
```java
  private Timer indexTimer = null;
  private Timer conflictResolutionTimer = null;
  private Counter conflictResolutionSuccessCounter = null;
  private Counter conflictResolutionFailureCounter = null;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metrics/HoodieMetrics.java`
#### Snippet
```java
  private Timer compactionTimer = null;
  private Timer logCompactionTimer = null;
  private Timer clusteringTimer = null;
  private Timer indexTimer = null;
  private Timer conflictResolutionTimer = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metrics/HoodieMetrics.java`
#### Snippet
```java
  public String commitTimerName = null;
  public String logCompactionTimerName = null;
  public String deltaCommitTimerName = null;
  public String replaceCommitTimerName = null;
  public String finalizeTimerName = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metrics/HoodieMetrics.java`
#### Snippet
```java
  public String indexTimerName = null;
  private String conflictResolutionTimerName = null;
  private String conflictResolutionSuccessCounterName = null;
  private String conflictResolutionFailureCounterName = null;
  private HoodieWriteConfig config;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java`
#### Snippet
```java
    private boolean isOptimizeConfigSet = false;
    private boolean isMetricsConfigSet = false;
    private boolean isBootstrapConfigSet = false;
    private boolean isMemoryConfigSet = false;
    private boolean isViewConfigSet = false;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java`
#### Snippet
```java
    private boolean isConsistencyGuardSet = false;
    private boolean isCallbackConfigSet = false;
    private boolean isPayloadConfigSet = false;
    private boolean isMetadataConfigSet = false;
    private boolean isLockConfigSet = false;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java`
#### Snippet
```java
    private boolean isIndexConfigSet = false;
    private boolean isStorageConfigSet = false;
    private boolean isCompactionConfigSet = false;
    private boolean isCleanConfigSet = false;
    private boolean isArchivalConfigSet = false;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java`
#### Snippet
```java
    private boolean isMetricsJmxConfigSet = false;
    private boolean isMetricsGraphiteConfigSet = false;
    private boolean isLayoutConfigSet = false;

    public Builder withEngineType(EngineType engineType) {
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java`
#### Snippet
```java
    private boolean isPayloadConfigSet = false;
    private boolean isMetadataConfigSet = false;
    private boolean isLockConfigSet = false;
    private boolean isPreCommitValidationConfigSet = false;
    private boolean isMetricsJmxConfigSet = false;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java`
#### Snippet
```java
    private boolean isClusteringConfigSet = false;
    private boolean isOptimizeConfigSet = false;
    private boolean isMetricsConfigSet = false;
    private boolean isBootstrapConfigSet = false;
    private boolean isMemoryConfigSet = false;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java`
#### Snippet
```java
    private boolean isCleanConfigSet = false;
    private boolean isArchivalConfigSet = false;
    private boolean isClusteringConfigSet = false;
    private boolean isOptimizeConfigSet = false;
    private boolean isMetricsConfigSet = false;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java`
#### Snippet
```java
    private boolean isBootstrapConfigSet = false;
    private boolean isMemoryConfigSet = false;
    private boolean isViewConfigSet = false;
    private boolean isConsistencyGuardSet = false;
    private boolean isCallbackConfigSet = false;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java`
#### Snippet
```java
    private boolean isCallbackConfigSet = false;
    private boolean isPayloadConfigSet = false;
    private boolean isMetadataConfigSet = false;
    private boolean isLockConfigSet = false;
    private boolean isPreCommitValidationConfigSet = false;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java`
#### Snippet
```java
    private boolean isMetricsConfigSet = false;
    private boolean isBootstrapConfigSet = false;
    private boolean isMemoryConfigSet = false;
    private boolean isViewConfigSet = false;
    private boolean isConsistencyGuardSet = false;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java`
#### Snippet
```java
    private boolean isMetadataConfigSet = false;
    private boolean isLockConfigSet = false;
    private boolean isPreCommitValidationConfigSet = false;
    private boolean isMetricsJmxConfigSet = false;
    private boolean isMetricsGraphiteConfigSet = false;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java`
#### Snippet
```java
    private boolean isPreCommitValidationConfigSet = false;
    private boolean isMetricsJmxConfigSet = false;
    private boolean isMetricsGraphiteConfigSet = false;
    private boolean isLayoutConfigSet = false;

```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java`
#### Snippet
```java
    protected EngineType engineType = EngineType.SPARK;
    private boolean isIndexConfigSet = false;
    private boolean isStorageConfigSet = false;
    private boolean isCompactionConfigSet = false;
    private boolean isCleanConfigSet = false;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java`
#### Snippet
```java
    protected final HoodieWriteConfig writeConfig = new HoodieWriteConfig();
    protected EngineType engineType = EngineType.SPARK;
    private boolean isIndexConfigSet = false;
    private boolean isStorageConfigSet = false;
    private boolean isCompactionConfigSet = false;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java`
#### Snippet
```java
    private boolean isLockConfigSet = false;
    private boolean isPreCommitValidationConfigSet = false;
    private boolean isMetricsJmxConfigSet = false;
    private boolean isMetricsGraphiteConfigSet = false;
    private boolean isLayoutConfigSet = false;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java`
#### Snippet
```java
    private boolean isMemoryConfigSet = false;
    private boolean isViewConfigSet = false;
    private boolean isConsistencyGuardSet = false;
    private boolean isCallbackConfigSet = false;
    private boolean isPayloadConfigSet = false;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java`
#### Snippet
```java
    private boolean isStorageConfigSet = false;
    private boolean isCompactionConfigSet = false;
    private boolean isCleanConfigSet = false;
    private boolean isArchivalConfigSet = false;
    private boolean isClusteringConfigSet = false;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java`
#### Snippet
```java
    private boolean isViewConfigSet = false;
    private boolean isConsistencyGuardSet = false;
    private boolean isCallbackConfigSet = false;
    private boolean isPayloadConfigSet = false;
    private boolean isMetadataConfigSet = false;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java`
#### Snippet
```java
    private boolean isArchivalConfigSet = false;
    private boolean isClusteringConfigSet = false;
    private boolean isOptimizeConfigSet = false;
    private boolean isMetricsConfigSet = false;
    private boolean isBootstrapConfigSet = false;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/config/HoodieWriteConfig.java`
#### Snippet
```java
    private boolean isCompactionConfigSet = false;
    private boolean isCleanConfigSet = false;
    private boolean isArchivalConfigSet = false;
    private boolean isClusteringConfigSet = false;
    private boolean isOptimizeConfigSet = false;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-common/src/main/java/org/apache/hudi/BaseHoodieTableFileIndex.java`
#### Snippet
```java
  private transient volatile List<PartitionPath> cachedAllPartitionPaths = null;

  private transient HoodieTableMetadata tableMetadata = null;

  /**
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-common/src/main/java/org/apache/hudi/BaseHoodieTableFileIndex.java`
#### Snippet
```java

  // NOTE: It always contains either all partition paths, or null if it is not initialized yet
  private transient volatile List<PartitionPath> cachedAllPartitionPaths = null;

  private transient HoodieTableMetadata tableMetadata = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-common/src/main/java/org/apache/hudi/io/storage/HoodieAvroHFileReader.java`
#### Snippet
```java
    private final Schema writerSchema;

    private IndexedRecord next = null;

    RecordByKeyIterator(HFileScanner scanner, List<String> keys, Schema writerSchema, Schema readerSchema) throws IOException {
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-common/src/main/java/org/apache/hudi/io/storage/HoodieAvroHFileReader.java`
#### Snippet
```java

    class KeyPrefixIterator implements Iterator<IndexedRecord> {
      private IndexedRecord next = null;
      private boolean eof = false;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-common/src/main/java/org/apache/hudi/io/storage/HoodieAvroHFileReader.java`
#### Snippet
```java
    private final Schema readerSchema;

    private IndexedRecord next = null;

    RecordByKeyPrefixIterator(HFileScanner scanner, List<String> keyPrefixes, Schema writerSchema, Schema readerSchema) throws IOException {
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-common/src/main/java/org/apache/hudi/io/storage/HoodieAvroHFileReader.java`
#### Snippet
```java
    private final Schema readerSchema;

    private IndexedRecord next = null;

    RecordIterator(HFileScanner scanner, Schema writerSchema, Schema readerSchema) {
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-common/src/main/java/org/apache/hudi/io/storage/HoodieAvroHFileReader.java`
#### Snippet
```java
    class KeyPrefixIterator implements Iterator<IndexedRecord> {
      private IndexedRecord next = null;
      private boolean eof = false;

      @Override
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metadata/HoodieBackedTableMetadataWriter.java`
#### Snippet
```java
    private final List<Path> subDirectories = new ArrayList<>();
    // Is this a hoodie partition
    private boolean isHoodiePartition = false;

    public DirectoryInfo(String relativePath, FileStatus[] fileStatus) {
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/fs/inline/InMemoryFileSystem.java`
#### Snippet
```java
  // TODO: this needs to be per path to support num_cores > 1, and we should release the buffer once done
  private ByteArrayOutputStream bos;
  private Configuration conf = null;
  public static final String SCHEME = "inmemfs";
  private URI uri;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/fs/inline/InLineFileSystem.java`
#### Snippet
```java

  public static final String SCHEME = "inlinefs";
  private Configuration conf = null;

  @Override
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/BaseHoodieWriteClient.java`
#### Snippet
```java
  private transient HoodieWriteCommitCallback commitCallback;

  protected transient Timer.Context writeTimer = null;

  protected Option<Pair<HoodieInstant, Map<String, String>>> lastCompletedTxnAndMetadata = Option.empty();
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/util/BufferedRandomAccessFile.java`
#### Snippet
```java
  private long diskPosition = 0L;
  private boolean isDirty = false;
  private boolean isClosed = false;
  private boolean isEOF = false;

```

### RedundantFieldInitialization
Field initialization to `0L` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/util/BufferedRandomAccessFile.java`
#### Snippet
```java
  private int capacity;
  private ByteBuffer dataBuffer;
  private long startPosition = 0L;
  private long currentPosition = 0L;
  private long validLastPosition = 0L;
```

### RedundantFieldInitialization
Field initialization to `0L` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/util/BufferedRandomAccessFile.java`
#### Snippet
```java
  private long currentPosition = 0L;
  private long validLastPosition = 0L;
  private long diskPosition = 0L;
  private boolean isDirty = false;
  private boolean isClosed = false;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/util/BufferedRandomAccessFile.java`
#### Snippet
```java
  private boolean isDirty = false;
  private boolean isClosed = false;
  private boolean isEOF = false;

  /**
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/util/BufferedRandomAccessFile.java`
#### Snippet
```java
  private long validLastPosition = 0L;
  private long diskPosition = 0L;
  private boolean isDirty = false;
  private boolean isClosed = false;
  private boolean isEOF = false;
```

### RedundantFieldInitialization
Field initialization to `0L` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/util/BufferedRandomAccessFile.java`
#### Snippet
```java
  private long startPosition = 0L;
  private long currentPosition = 0L;
  private long validLastPosition = 0L;
  private long diskPosition = 0L;
  private boolean isDirty = false;
```

### RedundantFieldInitialization
Field initialization to `0L` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/util/BufferedRandomAccessFile.java`
#### Snippet
```java
  private ByteBuffer dataBuffer;
  private long startPosition = 0L;
  private long currentPosition = 0L;
  private long validLastPosition = 0L;
  private long diskPosition = 0L;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/util/queue/BoundedInMemoryQueue.java`
#### Snippet
```java

  /** Indicates avg record size in bytes. It is updated whenever a new record is sampled. **/
  public long avgRecordSizeInBytes = 0;

  /** Indicates number of samples collected so far. **/
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/util/queue/BoundedInMemoryQueue.java`
#### Snippet
```java

  /** Indicates number of samples collected so far. **/
  private long numSamples = 0;

  /**
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/util/queue/DisruptorMessageQueue.java`
#### Snippet
```java

  private boolean isShutdown = false;
  private boolean isStarted = false;

  private static final long TIMEOUT_WAITING_SECS = 10L;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/util/queue/DisruptorMessageQueue.java`
#### Snippet
```java
  private final RingBuffer<HoodieDisruptorEvent> ringBuffer;

  private boolean isShutdown = false;
  private boolean isStarted = false;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/DiskMap.java`
#### Snippet
```java
  private static final String SUBFOLDER_PREFIX = "hudi";
  private final File diskMapPathFile;
  private transient Thread shutdownThread = null;

  // Base path for the write file
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/RocksDBDAO.java`
#### Snippet
```java
  private transient ConcurrentHashMap<String, ColumnFamilyDescriptor> managedDescriptorMap;
  private transient RocksDB rocksDB;
  private boolean closed = false;
  private final String rocksDBBasePath;
  private long totalBytesWritten;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/LazyFileIterable.java`
#### Snippet
```java
  private final boolean isCompressionEnabled;

  private transient Thread shutdownThread = null;

  public LazyFileIterable(String filePath, Map<T, BitCaskDiskMap.ValueMetadata> map) {
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/bloom/InternalDynamicBloomFilter.java`
#### Snippet
```java
  private int currentNbRecord;
  private int maxNr;
  private boolean reachedMax = false;
  private int curMatrixIndex = 0;

```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/bloom/InternalDynamicBloomFilter.java`
#### Snippet
```java
  private int maxNr;
  private boolean reachedMax = false;
  private int curMatrixIndex = 0;

  /**
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/ExternalSpillableMap.java`
#### Snippet
```java
  private Long currentInMemoryMapSize;
  // An estimate of the size of each payload written to this map
  private volatile long estimatedPayloadSize = 0;
  // Base File Path
  private final String baseFilePath;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/model/MetadataValues.java`
#### Snippet
```java
  private String operation;

  private boolean set = false;

  public MetadataValues() {}
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieMetadataWrapper.java`
#### Snippet
```java
  private HoodieArchivedMetaEntry avroMetadataFromTimeline;
  private HoodieCommitMetadata commitMetadata;
  private boolean isAvroMetadata = false;

  public HoodieMetadataWrapper(HoodieArchivedMetaEntry avroMetadataFromTimeline) {
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/InstantRange.java`
#### Snippet
```java
    private String endInstant;
    private RangeType rangeType;
    private boolean nullableBoundary = false;

    private Builder() {
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/HoodieLogFileReader.java`
#### Snippet
```java
  private final boolean enableRecordLookups;
  private boolean closed = false;
  private transient Thread shutdownThread = null;

  public HoodieLogFileReader(FileSystem fs, HoodieLogFile logFile, Schema readerSchema, int bufferSize,
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/HoodieLogFileReader.java`
#### Snippet
```java
  private final boolean reverseReader;
  private final boolean enableRecordLookups;
  private boolean closed = false;
  private transient Thread shutdownThread = null;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/HoodieLogFormatWriter.java`
#### Snippet
```java
  private final String rolloverLogWriteToken;
  private boolean closed = false;
  private transient Thread shutdownThread = null;

  private static final String APPEND_UNAVAILABLE_EXCEPTION_MESSAGE = "not sufficiently replicated yet";
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/HoodieLogFormatWriter.java`
#### Snippet
```java
  private final Short replication;
  private final String rolloverLogWriteToken;
  private boolean closed = false;
  private transient Thread shutdownThread = null;

```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/HoodieMergedLogRecordScanner.java`
#### Snippet
```java
    private String partitionName;
    // operation field default false
    private boolean withOperationField = false;
    private String keyFieldOverride;
    // By default, we're doing a full-scan
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/HoodieMergedLogRecordScanner.java`
#### Snippet
```java
    private boolean forceFullScan = true;
    // Use scanV2 method.
    private boolean enableOptimizedLogBlocksScan = false;
    private HoodieRecordMerger recordMerger;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/table/HoodieTableMetaClient.java`
#### Snippet
```java
    private boolean loadActiveTimelineOnLoad = false;
    private String payloadClassName = null;
    private String recordMergerStrategy = null;
    private ConsistencyGuardConfig consistencyGuardConfig = ConsistencyGuardConfig.newBuilder().build();
    private FileSystemRetryConfig fileSystemRetryConfig = FileSystemRetryConfig.newBuilder().build();
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/table/HoodieTableMetaClient.java`
#### Snippet
```java
    private String basePath;
    private boolean loadActiveTimelineOnLoad = false;
    private String payloadClassName = null;
    private String recordMergerStrategy = null;
    private ConsistencyGuardConfig consistencyGuardConfig = ConsistencyGuardConfig.newBuilder().build();
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/table/HoodieTableMetaClient.java`
#### Snippet
```java
    private Configuration conf;
    private String basePath;
    private boolean loadActiveTimelineOnLoad = false;
    private String payloadClassName = null;
    private String recordMergerStrategy = null;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/block/HoodieAvroDataBlock.java`
#### Snippet
```java
    private final ThreadLocal<BinaryDecoder> decoderCache = new ThreadLocal<>();

    private int totalRecords = 0;
    private int readRecords = 0;

```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/block/HoodieAvroDataBlock.java`
#### Snippet
```java

    private int totalRecords = 0;
    private int readRecords = 0;

    private RecordIterator(Schema readerSchema, Schema writerSchema, byte[] content) throws IOException {
```

### RedundantFieldInitialization
Field initialization to `0.0f` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/AbstractHoodieLogRecordReader.java`
#### Snippet
```java
  protected final boolean forceFullScan;
  // Progress
  private float progress = 0.0f;
  // Populate meta fields for the records
  private final boolean populateMetaFields;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/HoodieTableFileSystemView.java`
#### Snippet
```java
   * Flag to determine if closed.
   */
  private boolean closed = false;

  HoodieTableFileSystemView(boolean enableIncrementalTimelineSync) {
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/RemoteHoodieTableFileSystemView.java`
#### Snippet
```java
  private final int timeoutMs;

  private boolean closed = false;

  private RetryHelper<Response, IOException> retryHelper;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/RocksDbBasedFileSystemView.java`
#### Snippet
```java
  private RocksDBDAO rocksDB;

  private boolean closed = false;

  public RocksDbBasedFileSystemView(HoodieTableMetaClient metaClient, HoodieTimeline visibleActiveTimeline,
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/InternalSchema.java`
#### Snippet
```java

  private transient Map<Integer, Field> idToField = null;
  private transient Map<String, Integer> nameToId = null;
  private transient Map<Integer, String> idToName = null;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/InternalSchema.java`
#### Snippet
```java
  private long versionId;

  private transient Map<Integer, Field> idToField = null;
  private transient Map<String, Integer> nameToId = null;
  private transient Map<Integer, String> idToName = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/InternalSchema.java`
#### Snippet
```java
  private transient Map<Integer, Field> idToField = null;
  private transient Map<String, Integer> nameToId = null;
  private transient Map<Integer, String> idToName = null;

  public static InternalSchema getEmptyInternalSchema() {
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/bootstrap/index/HFileBootstrapIndex.java`
#### Snippet
```java

    private boolean closed = false;
    private int numPartitionKeysAdded = 0;
    private int numFileIdKeysAdded = 0;

```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/bootstrap/index/HFileBootstrapIndex.java`
#### Snippet
```java
    private HFile.Writer indexByFileIdWriter;

    private boolean closed = false;
    private int numPartitionKeysAdded = 0;
    private int numFileIdKeysAdded = 0;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/bootstrap/index/HFileBootstrapIndex.java`
#### Snippet
```java
    private boolean closed = false;
    private int numPartitionKeysAdded = 0;
    private int numFileIdKeysAdded = 0;

    private final Map<String, List<BootstrapFileMapping>> sourceFileMappings = new HashMap<>();
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/Types.java`
#### Snippet
```java
    private final Field[] fields;

    private transient Map<String, Field> nameToFields = null;
    private transient Map<Integer, Field> idToFields = null;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/Types.java`
#### Snippet
```java

    private transient Map<String, Field> nameToFields = null;
    private transient Map<Integer, Field> idToFields = null;

    private RecordType(List<Field> fields, String name) {
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/Types.java`
#### Snippet
```java
    private final Field keyField;
    private final Field valueField;
    private transient List<Field> fields = null;

    private MapType(Field keyField, Field valueField) {
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-common/src/main/java/org/apache/parquet/avro/HoodieAvroParquetReaderBuilder.java`
#### Snippet
```java
public class HoodieAvroParquetReaderBuilder<T> extends ParquetReader.Builder<T> {

  private GenericData model = null;
  private boolean enableCompatibility = true;
  private boolean isReflect = true;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-common/src/main/java/org/apache/hudi/metadata/BaseTableMetadata.java`
#### Snippet
```java

  protected boolean isMetadataTableEnabled;
  protected boolean isBloomFilterIndexEnabled = false;
  protected boolean isColumnStatsIndexEnabled = false;

```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-common/src/main/java/org/apache/hudi/metadata/BaseTableMetadata.java`
#### Snippet
```java
  protected boolean isMetadataTableEnabled;
  protected boolean isBloomFilterIndexEnabled = false;
  protected boolean isColumnStatsIndexEnabled = false;

  protected BaseTableMetadata(HoodieEngineContext engineContext, HoodieMetadataConfig metadataConfig,
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-examples/hudi-examples-flink/src/main/java/org/apache/hudi/examples/quickstart/HoodieFlinkQuickstart.java`
#### Snippet
```java
public final class HoodieFlinkQuickstart {
  private EnvironmentSettings settings = null;
  private TableEnvironment streamTableEnv = null;

  private String tableName;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-examples/hudi-examples-flink/src/main/java/org/apache/hudi/examples/quickstart/HoodieFlinkQuickstart.java`
#### Snippet
```java

public final class HoodieFlinkQuickstart {
  private EnvironmentSettings settings = null;
  private TableEnvironment streamTableEnv = null;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieMetadataPayload.java`
#### Snippet
```java
  private static final Lazy<DateWrapper.Builder> DATE_WRAPPER_BUILDER_STUB = Lazy.lazily(DateWrapper::newBuilder);

  private String key = null;
  private int type = 0;
  private Map<String, HoodieMetadataFileInfo> filesystemMetadata = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieMetadataPayload.java`
#### Snippet
```java
  private Map<String, HoodieMetadataFileInfo> filesystemMetadata = null;
  private HoodieMetadataBloomFilter bloomFilterMetadata = null;
  private HoodieMetadataColumnStats columnStatMetadata = null;

  public HoodieMetadataPayload(GenericRecord record, Comparable<?> orderingVal) {
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieMetadataPayload.java`
#### Snippet
```java
  private String key = null;
  private int type = 0;
  private Map<String, HoodieMetadataFileInfo> filesystemMetadata = null;
  private HoodieMetadataBloomFilter bloomFilterMetadata = null;
  private HoodieMetadataColumnStats columnStatMetadata = null;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieMetadataPayload.java`
#### Snippet
```java

  private String key = null;
  private int type = 0;
  private Map<String, HoodieMetadataFileInfo> filesystemMetadata = null;
  private HoodieMetadataBloomFilter bloomFilterMetadata = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieMetadataPayload.java`
#### Snippet
```java
  private int type = 0;
  private Map<String, HoodieMetadataFileInfo> filesystemMetadata = null;
  private HoodieMetadataBloomFilter bloomFilterMetadata = null;
  private HoodieMetadataColumnStats columnStatMetadata = null;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/RecordReaderValueIterator.java`
#### Snippet
```java

  private final RecordReader<K, V> reader;
  private V nextVal = null;

  /**
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/HoodieHFileRecordReader.java`
#### Snippet
```java
public class HoodieHFileRecordReader implements RecordReader<NullWritable, ArrayWritable> {

  private long count = 0;
  private ArrayWritable valueObj;
  private HoodieAvroHFileReader reader;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/realtime/HoodieRealtimeFileSplit.java`
#### Snippet
```java
   * Marks whether this path produced as part of Incremental Query
   */
  private boolean belongsToIncrementalQuery = false;
  /**
   * Virtual key configuration of the table this split belongs to
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/realtime/HoodieRealtimeBootstrapBaseFileSplit.java`
#### Snippet
```java
   * Marks whether this path produced as part of Incremental Query
   */
  private boolean belongsToIncrementalQuery = false;
  /**
   * List of delta log-files holding updated records for this base-file
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieSnapshotExporter.java`
#### Snippet
```java

    @Parameter(names = {"--output-partition-field"}, description = "A field to be used by Spark repartitioning")
    public String outputPartitionField = null;

    @Parameter(names = {"--output-partitioner"}, description = "A class to facilitate custom repartitioning")
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieSnapshotExporter.java`
#### Snippet
```java

    @Parameter(names = {"--output-partitioner"}, description = "A class to facilitate custom repartitioning")
    public String outputPartitioner = null;

    @Parameter(names = {"--parallelism", "-pl"}, description = "Parallelism for file listing")
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieSnapshotExporter.java`
#### Snippet
```java

    @Parameter(names = {"--parallelism", "-pl"}, description = "Parallelism for file listing")
    public int parallelism = 0;
  }

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieCleaner.java`
#### Snippet
```java
    @Parameter(names = {"--props"}, description = "path to properties file on localfs or dfs, with configurations for "
        + "hoodie client for cleaning")
    public String propsFilePath = null;

    @Parameter(names = {"--hoodie-conf"}, description = "Any configuration that can be set in the properties file "
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDataTableValidator.java`
#### Snippet
```java
  public static class Config implements Serializable {
    @Parameter(names = {"--base-path", "-sp"}, description = "Base path for the table", required = true)
    public String basePath = null;

    @Parameter(names = {"--continuous"}, description = "Running MetadataTableValidator in continuous. "
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDataTableValidator.java`
#### Snippet
```java

    @Parameter(names = {"--ignore-failed", "-ig"}, description = "Ignore data table validate failure and continue.", required = false)
    public boolean ignoreFailed = false;

    @Parameter(names = {"--assume-date-partitioning"}, description = "Should HoodieWriteClient assume the data is partitioned by dates, i.e three levels from base path."
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDataTableValidator.java`
#### Snippet
```java
    @Parameter(names = {"--continuous"}, description = "Running MetadataTableValidator in continuous. "
        + "Can use --min-validate-interval-seconds to control validation frequency", required = false)
    public boolean continuous = false;

    @Parameter(names = {"--min-validate-interval-seconds"},
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDataTableValidator.java`
#### Snippet
```java

    @Parameter(names = {"--spark-master", "-ms"}, description = "Spark master", required = false)
    public String sparkMaster = null;

    @Parameter(names = {"--spark-memory", "-sm"}, description = "spark memory to use", required = false)
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDataTableValidator.java`
#### Snippet
```java
    @Parameter(names = {"--props"}, description = "path to properties file on localfs or dfs, with configurations for "
        + "hoodie client")
    public String propsFilePath = null;

    @Parameter(names = {"--hoodie-conf"}, description = "Any configuration that can be set in the properties file "
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieCompactor.java`
#### Snippet
```java
    public String sparkMemory = null;
    @Parameter(names = {"--retry", "-rt"}, description = "number of retries", required = false)
    public int retry = 0;
    @Parameter(names = {"--schedule", "-sc"}, description = "Schedule compaction", required = false)
    public Boolean runSchedule = false;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieCompactor.java`
#### Snippet
```java
    public String sparkMaster = null;
    @Parameter(names = {"--spark-memory", "-sm"}, description = "spark memory to use", required = true)
    public String sparkMemory = null;
    @Parameter(names = {"--retry", "-rt"}, description = "number of retries", required = false)
    public int retry = 0;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieCompactor.java`
#### Snippet
```java
    public String schemaFile = null;
    @Parameter(names = {"--spark-master", "-ms"}, description = "Spark master", required = false)
    public String sparkMaster = null;
    @Parameter(names = {"--spark-memory", "-sm"}, description = "spark memory to use", required = true)
    public String sparkMemory = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieCompactor.java`
#### Snippet
```java
    @Parameter(names = {"--props"}, description = "path to properties file on localfs or dfs, with configurations for "
        + "hoodie client for compacting")
    public String propsFilePath = null;

    @Parameter(names = {"--hoodie-conf"}, description = "Any configuration that can be set in the properties file "
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieCompactor.java`
#### Snippet
```java
    public String tableName = null;
    @Parameter(names = {"--instant-time", "-it"}, description = "Compaction Instant time", required = false)
    public String compactionInstantTime = null;
    @Parameter(names = {"--parallelism", "-pl"}, description = "Parallelism for hoodie insert", required = false)
    public int parallelism = 200;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieCompactor.java`
#### Snippet
```java
        + "Set \"execute\" means execute a compact plan at given instant which means --instant-time is needed here; "
        + "Set \"scheduleAndExecute\" means make a compact plan first and execute that plan immediately", required = false)
    public String runningMode = null;
    @Parameter(names = {"--strategy", "-st"}, description = "Strategy Class", required = false)
    public String strategyClassName = LogFileSizeBasedCompactionStrategy.class.getName();
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieCompactor.java`
#### Snippet
```java
    public int parallelism = 200;
    @Parameter(names = {"--schema-file", "-sf"}, description = "path for Avro schema file", required = false)
    public String schemaFile = null;
    @Parameter(names = {"--spark-master", "-ms"}, description = "Spark master", required = false)
    public String sparkMaster = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieCompactor.java`
#### Snippet
```java
  public static class Config implements Serializable {
    @Parameter(names = {"--base-path", "-sp"}, description = "Base path for the table", required = true)
    public String basePath = null;
    @Parameter(names = {"--table-name", "-tn"}, description = "Table name", required = true)
    public String tableName = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieCompactor.java`
#### Snippet
```java
    public String basePath = null;
    @Parameter(names = {"--table-name", "-tn"}, description = "Table name", required = true)
    public String tableName = null;
    @Parameter(names = {"--instant-time", "-it"}, description = "Compaction Instant time", required = false)
    public String compactionInstantTime = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieWithTimelineServer.java`
#### Snippet
```java

    @Parameter(names = {"--spark-master", "-ms"}, description = "Spark master")
    public String sparkMaster = null;
    @Parameter(names = {"--spark-memory", "-sm"}, description = "spark memory to use", required = true)
    public String sparkMemory = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieWithTimelineServer.java`
#### Snippet
```java
    public String sparkMaster = null;
    @Parameter(names = {"--spark-memory", "-sm"}, description = "spark memory to use", required = true)
    public String sparkMemory = null;
    @Parameter(names = {"--num-partitions", "-n"}, description = "Num Partitions")
    public Integer numPartitions = 100;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/hive/HoodieCombineHiveInputFormat.java`
#### Snippet
```java

    private boolean hoodieFilter = false;
    private boolean isRealTime = false;

    protected HoodieParquetInputFormat createParquetInputFormat() {
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/hive/HoodieCombineHiveInputFormat.java`
#### Snippet
```java
      implements org.apache.hadoop.hive.shims.HadoopShims.CombineFileInputFormatShim<K, V> {

    private boolean hoodieFilter = false;
    private boolean isRealTime = false;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieClusteringJob.java`
#### Snippet
```java
    public String sparkMaster = null;
    @Parameter(names = {"--spark-memory", "-sm"}, description = "spark memory to use", required = true)
    public String sparkMemory = null;
    @Parameter(names = {"--retry", "-rt"}, description = "number of retries")
    public int retry = 0;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieClusteringJob.java`
#### Snippet
```java
    public String sparkMemory = null;
    @Parameter(names = {"--retry", "-rt"}, description = "number of retries")
    public int retry = 0;

    @Parameter(names = {"--schedule", "-sc"}, description = "Schedule clustering @desperate soon please use \"--mode schedule\" instead")
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieClusteringJob.java`
#### Snippet
```java
        + "Set \"execute\" means execute a cluster plan at given instant which means --instant-time is needed here; "
        + "Set \"scheduleAndExecute\" means make a cluster plan first and execute that plan immediately")
    public String runningMode = null;

    @Parameter(names = {"--help", "-h"}, help = true)
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieClusteringJob.java`
#### Snippet
```java
    public int parallelism = 1;
    @Parameter(names = {"--spark-master", "-ms"}, description = "Spark master")
    public String sparkMaster = null;
    @Parameter(names = {"--spark-memory", "-sm"}, description = "spark memory to use", required = true)
    public String sparkMemory = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieClusteringJob.java`
#### Snippet
```java
    @Parameter(names = {"--props"}, description = "path to properties file on localfs or dfs, with configurations for "
        + "hoodie client for clustering")
    public String propsFilePath = null;

    @Parameter(names = {"--hoodie-conf"}, description = "Any configuration that can be set in the properties file "
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieClusteringJob.java`
#### Snippet
```java
        + "the earliest scheduled clustering instant time is used by default. "
        + "When set \"--mode scheduleAndExecute\" this instant-time will be ignored.")
    public String clusteringInstantTime = null;
    @Parameter(names = {"--parallelism", "-pl"}, description = "Parallelism for hoodie insert")
    public int parallelism = 1;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieClusteringJob.java`
#### Snippet
```java
    public String basePath = null;
    @Parameter(names = {"--table-name", "-tn"}, description = "Table name", required = true)
    public String tableName = null;
    @Parameter(names = {"--instant-time", "-it"}, description = "Clustering Instant time, only used when set --mode execute. "
        + "If the instant time is not provided with --mode execute, "
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieClusteringJob.java`
#### Snippet
```java
  public static class Config implements Serializable {
    @Parameter(names = {"--base-path", "-sp"}, description = "Base path for the table", required = true)
    public String basePath = null;
    @Parameter(names = {"--table-name", "-tn"}, description = "Table name", required = true)
    public String tableName = null;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieClusteringJob.java`
#### Snippet
```java
    @Parameter(names = {"--job-max-processing-time-ms", "-jt"}, description = "Take effect when using --mode/-m scheduleAndExecute and --retry-last-failed-clustering-job/-rc true. "
        + "If maxProcessingTimeMs passed but clustering job is still unfinished, hoodie would consider this job as failed and relaunch.")
    public long maxProcessingTimeMs = 0;

    @Parameter(names = {"--props"}, description = "path to properties file on localfs or dfs, with configurations for "
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieRepairTool.java`
#### Snippet
```java
    @Parameter(names = {"--end-instant-time", "-ei"}, description = "Ending Instant time "
        + "for repair (inclusive)", required = false)
    public String endingInstantTime = null;
    @Parameter(names = {"--backup-path", "-bp"}, description = "Backup path for storing dangling data "
        + "and log files from the table", required = false)
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieRepairTool.java`
#### Snippet
```java
  public static class Config implements Serializable {
    @Parameter(names = {"--base-path", "-sp"}, description = "Base path for the table", required = true)
    public String basePath = null;
    @Parameter(names = {"--mode", "-m"}, description = "Set job mode: Set \"repair\" means repairing the table "
        + "by removing dangling data and log files not belonging to any commit; "
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieRepairTool.java`
#### Snippet
```java
    @Parameter(names = {"--props"}, description = "path to properties file on localfs or dfs, with configurations for "
        + "hoodie client for table repair")
    public String propsFilePath = null;

    @Parameter(names = {"--hoodie-conf"}, description = "Any configuration that can be set in the properties file "
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieRepairTool.java`
#### Snippet
```java
    @Parameter(names = {"--start-instant-time", "-si"}, description = "Starting Instant time "
        + "for repair (inclusive)", required = false)
    public String startingInstantTime = null;
    @Parameter(names = {"--end-instant-time", "-ei"}, description = "Ending Instant time "
        + "for repair (inclusive)", required = false)
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieRepairTool.java`
#### Snippet
```java
        + "Set \"dry_run\" means only looking for dangling data and log files; "
        + "Set \"undo\" means undoing the repair by copying back the files from backup directory", required = true)
    public String runningMode = null;
    @Parameter(names = {"--start-instant-time", "-si"}, description = "Starting Instant time "
        + "for repair (inclusive)", required = false)
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieRepairTool.java`
#### Snippet
```java
    public int parallelism = 2;
    @Parameter(names = {"--spark-master", "-ms"}, description = "Spark master", required = false)
    public String sparkMaster = null;
    @Parameter(names = {"--spark-memory", "-sm"}, description = "spark memory to use", required = false)
    public String sparkMemory = "1g";
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieRepairTool.java`
#### Snippet
```java
    @Parameter(names = {"--backup-path", "-bp"}, description = "Backup path for storing dangling data "
        + "and log files from the table", required = false)
    public String backupPath = null;
    @Parameter(names = {"--parallelism", "-pl"}, description = "Parallelism for repair", required = false)
    public int parallelism = 2;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieSnapshotCopier.java`
#### Snippet
```java

    @Parameter(names = {"--output-path", "-op"}, description = "The snapshot output path", required = true)
    String outputPath = null;

    @Parameter(names = {"--date-partitioned", "-dp"}, description = "Can we assume date partitioning?")
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieSnapshotCopier.java`
#### Snippet
```java

    @Parameter(names = {"--date-partitioned", "-dp"}, description = "Can we assume date partitioning?")
    boolean shouldAssumeDatePartitioning = false;

    @Parameter(names = {"--use-file-listing-from-metadata"}, description = "Fetch file listing from Hudi's metadata")
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieSnapshotCopier.java`
#### Snippet
```java

    @Parameter(names = {"--base-path", "-bp"}, description = "Hoodie table base path", required = true)
    String basePath = null;

    @Parameter(names = {"--output-path", "-op"}, description = "The snapshot output path", required = true)
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieCompactionAdminTool.java`
#### Snippet
```java
    public boolean skipValidation = false;
    @Parameter(names = {"--output-path", "-ot"}, description = "Output Path", required = false)
    public String outputPath = null;
    @Parameter(names = {"--print-output", "-pt"}, description = "Print Output", required = false)
    public boolean printOutput = true;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieCompactionAdminTool.java`
#### Snippet
```java
    public String sparkMemory = null;
    @Parameter(names = {"--dry-run", "-dr"}, description = "Dry Run Mode", required = false)
    public boolean dryRun = false;
    @Parameter(names = {"--skip-validation", "-sv"}, description = "Skip Validation", required = false)
    public boolean skipValidation = false;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieCompactionAdminTool.java`
#### Snippet
```java
    public Operation operation = Operation.VALIDATE;
    @Parameter(names = {"--base-path", "-bp"}, description = "Base path for the table", required = true)
    public String basePath = null;
    @Parameter(names = {"--instant-time", "-in"}, description = "Compaction Instant time", required = false)
    public String compactionInstantTime = null;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieCompactionAdminTool.java`
#### Snippet
```java
    public boolean dryRun = false;
    @Parameter(names = {"--skip-validation", "-sv"}, description = "Skip Validation", required = false)
    public boolean skipValidation = false;
    @Parameter(names = {"--output-path", "-ot"}, description = "Output Path", required = false)
    public String outputPath = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieCompactionAdminTool.java`
#### Snippet
```java
    public String partitionPath = null;
    @Parameter(names = {"--file-id", "-id"}, description = "File Id", required = false)
    public String fileId = null;
    @Parameter(names = {"--parallelism", "-pl"}, description = "Parallelism for hoodie insert", required = false)
    public int parallelism = 3;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieCompactionAdminTool.java`
#### Snippet
```java
    public String sparkMaster = null;
    @Parameter(names = {"--spark-memory", "-sm"}, description = "spark memory to use", required = true)
    public String sparkMemory = null;
    @Parameter(names = {"--dry-run", "-dr"}, description = "Dry Run Mode", required = false)
    public boolean dryRun = false;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieCompactionAdminTool.java`
#### Snippet
```java
    public String basePath = null;
    @Parameter(names = {"--instant-time", "-in"}, description = "Compaction Instant time", required = false)
    public String compactionInstantTime = null;
    @Parameter(names = {"--partition-path", "-pp"}, description = "Partition Path", required = false)
    public String partitionPath = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieCompactionAdminTool.java`
#### Snippet
```java
    public int parallelism = 3;
    @Parameter(names = {"--spark-master", "-ms"}, description = "Spark master", required = true)
    public String sparkMaster = null;
    @Parameter(names = {"--spark-memory", "-sm"}, description = "spark memory to use", required = true)
    public String sparkMemory = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieCompactionAdminTool.java`
#### Snippet
```java
    public String compactionInstantTime = null;
    @Parameter(names = {"--partition-path", "-pp"}, description = "Partition Path", required = false)
    public String partitionPath = null;
    @Parameter(names = {"--file-id", "-id"}, description = "File Id", required = false)
    public String fileId = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDropPartitionsTool.java`
#### Snippet
```java
    public String runningMode = null;
    @Parameter(names = {"--table-name", "-tn"}, description = "Table name", required = true)
    public String tableName = null;
    @Parameter(names = {"--partitions", "-p"}, description = "Comma separated list of partitions to delete.", required = true)
    public String partitions = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDropPartitionsTool.java`
#### Snippet
```java
    public String partitionValueExtractorClass = "org.apache.hudi.hive.SlashEncodedDayPartitionValueExtractor";
    @Parameter(names = {"--spark-master", "-ms"}, description = "Spark master", required = false)
    public String sparkMaster = null;
    @Parameter(names = {"--spark-memory", "-sm"}, description = "spark memory to use", required = false)
    public String sparkMemory = "1g";
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDropPartitionsTool.java`
#### Snippet
```java
  public static class Config implements Serializable {
    @Parameter(names = {"--base-path", "-sp"}, description = "Base path for the table", required = true)
    public String basePath = null;
    @Parameter(names = {"--mode", "-m"}, description = "Set job mode: "
        + "Set \"delete\" means mask/tombstone these partitions and corresponding data files table partitions and let cleaner delete these files later;"
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDropPartitionsTool.java`
#### Snippet
```java
    public String tableName = null;
    @Parameter(names = {"--partitions", "-p"}, description = "Comma separated list of partitions to delete.", required = true)
    public String partitions = null;
    @Parameter(names = {"--parallelism", "-pl"}, description = "Parallelism for hoodie insert/upsert/delete", required = false)
    public int parallelism = 1500;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDropPartitionsTool.java`
#### Snippet
```java
    public String hiveDataBase = null;
    @Parameter(names = {"--hive-table-name"}, description = "Table to sync to.", required = false)
    public String hiveTableName = null;
    @Parameter(names = {"--hive-user-name", "-user"}, description = "hive user name to use.", required = false)
    public String hiveUserName = "hive";
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDropPartitionsTool.java`
#### Snippet
```java
    public int parallelism = 1500;
    @Parameter(names = {"--instant-time", "-it"}, description = "instant time for delete table partitions operation.", required = false)
    public String instantTime = null;
    @Parameter(names = {"--sync-hive-meta", "-sync"}, description = "Sync information to HMS.", required = false)
    public boolean syncToHive = false;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDropPartitionsTool.java`
#### Snippet
```java
    public boolean hiveUseJdbc = true;
    @Parameter(names = {"--hive-metastore-uris"}, description = "hive meta store uris to use.", required = false)
    public String hiveHMSUris = null;
    @Parameter(names = {"--hive-sync-mode"}, description = "Mode to choose for Hive ops. Valid values are hms, jdbc and hiveql.", required = false)
    public String hiveSyncMode = "hms";
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDropPartitionsTool.java`
#### Snippet
```java
    public String instantTime = null;
    @Parameter(names = {"--sync-hive-meta", "-sync"}, description = "Sync information to HMS.", required = false)
    public boolean syncToHive = false;
    @Parameter(names = {"--hive-database", "-db"}, description = "Database to sync to.", required = false)
    public String hiveDataBase = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDropPartitionsTool.java`
#### Snippet
```java
        + "Set \"delete\" means mask/tombstone these partitions and corresponding data files table partitions and let cleaner delete these files later;"
        + "Set \"dry_run\" means only looking for the table partitions will be deleted and corresponding data files.", required = true)
    public String runningMode = null;
    @Parameter(names = {"--table-name", "-tn"}, description = "Table name", required = true)
    public String tableName = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDropPartitionsTool.java`
#### Snippet
```java
    public boolean syncToHive = false;
    @Parameter(names = {"--hive-database", "-db"}, description = "Database to sync to.", required = false)
    public String hiveDataBase = null;
    @Parameter(names = {"--hive-table-name"}, description = "Table to sync to.", required = false)
    public String hiveTableName = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDropPartitionsTool.java`
#### Snippet
```java
    @Parameter(names = {"--props"}, description = "path to properties file on localfs or dfs, with configurations for "
        + "hoodie client for deleting table partitions")
    public String propsFilePath = null;
    @Parameter(names = {"--hoodie-conf"}, description = "Any configuration that can be set in the properties file "
        + "(using the CLI parameter \"--props\") can also be passed command line using this parameter. This can be repeated",
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDropPartitionsTool.java`
#### Snippet
```java
    public String hiveSyncMode = "hms";
    @Parameter(names = {"--hive-sync-ignore-exception"}, description = "Ignore hive sync exception.", required = false)
    public boolean hiveSyncIgnoreException = false;
    @Parameter(names = {"--hive-partition-value-extractor-class"}, description = "Class which implements PartitionValueExtractor to extract the partition values,"
        + " default 'SlashEncodedDayPartitionValueExtractor'.", required = false)
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieIndexer.java`
#### Snippet
```java
    public int retry = 0;
    @Parameter(names = {"--index-types", "-ixt"}, description = "Comma-separated index types to be built, e.g. BLOOM_FILTERS,COLUMN_STATS", required = true)
    public String indexTypes = null;
    @Parameter(names = {"--mode", "-m"}, description = "Set job mode: Set \"schedule\" to generate an indexing plan; "
        + "Set \"execute\" to execute the indexing plan at the given instant, which means --instant-time is required here; "
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieIndexer.java`
#### Snippet
```java
    public String sparkMemory = null;
    @Parameter(names = {"--retry", "-rt"}, description = "number of retries")
    public int retry = 0;
    @Parameter(names = {"--index-types", "-ixt"}, description = "Comma-separated index types to be built, e.g. BLOOM_FILTERS,COLUMN_STATS", required = true)
    public String indexTypes = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieIndexer.java`
#### Snippet
```java
  public static class Config implements Serializable {
    @Parameter(names = {"--base-path", "-sp"}, description = "Base path for the table", required = true)
    public String basePath = null;
    @Parameter(names = {"--table-name", "-tn"}, description = "Table name", required = true)
    public String tableName = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieIndexer.java`
#### Snippet
```java
    public String sparkMaster = null;
    @Parameter(names = {"--spark-memory", "-sm"}, description = "spark memory to use", required = true)
    public String sparkMemory = null;
    @Parameter(names = {"--retry", "-rt"}, description = "number of retries")
    public int retry = 0;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieIndexer.java`
#### Snippet
```java
        + "Set \"scheduleAndExecute\" to generate an indexing plan first and execute that plan immediately;"
        + "Set \"dropIndex\" to drop the index types specified in --index-types;")
    public String runningMode = null;
    @Parameter(names = {"--help", "-h"}, help = true)
    public Boolean help = false;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieIndexer.java`
#### Snippet
```java
    public String tableName = null;
    @Parameter(names = {"--instant-time", "-it"}, description = "Indexing Instant time")
    public String indexInstantTime = null;
    @Parameter(names = {"--parallelism", "-pl"}, description = "Parallelism for hoodie insert", required = true)
    public int parallelism = 1;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieIndexer.java`
#### Snippet
```java

    @Parameter(names = {"--props"}, description = "path to properties file on localfs or dfs, with configurations for hoodie client for indexing")
    public String propsFilePath = null;

    @Parameter(names = {"--hoodie-conf"}, description = "Any configuration that can be set in the properties file "
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieIndexer.java`
#### Snippet
```java
    public String basePath = null;
    @Parameter(names = {"--table-name", "-tn"}, description = "Table name", required = true)
    public String tableName = null;
    @Parameter(names = {"--instant-time", "-it"}, description = "Indexing Instant time")
    public String indexInstantTime = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieIndexer.java`
#### Snippet
```java
    public int parallelism = 1;
    @Parameter(names = {"--spark-master", "-ms"}, description = "Spark master")
    public String sparkMaster = null;
    @Parameter(names = {"--spark-memory", "-sm"}, description = "spark memory to use", required = true)
    public String sparkMemory = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/perf/TimelineServerPerf.java`
#### Snippet
```java
    @Parameter(names = {"--server-host", "-sh"},
        description = " Server Host (Set it for externally managed timeline service")
    public String serverHost = null;

    @Parameter(names = {"--view-storage", "-st"}, description = "View Storage Type. Default - SPILLABLE_DISK")
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieMetadataTableValidator.java`
#### Snippet
```java

    @Parameter(names = {"--validate-latest-base-files"}, description = "Validate latest base files for all partitions.", required = false)
    public boolean validateLatestBaseFiles = false;

    @Parameter(names = {"--validate-all-file-groups"}, description = "Validate all file groups, and all file slices within file groups.", required = false)
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieMetadataTableValidator.java`
#### Snippet
```java
  public static class Config implements Serializable {
    @Parameter(names = {"--base-path", "-sp"}, description = "Base path for the table", required = true)
    public String basePath = null;

    @Parameter(names = {"--continuous"}, description = "Running MetadataTableValidator in continuous. "
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieMetadataTableValidator.java`
#### Snippet
```java
    @Parameter(names = {"--props"}, description = "path to properties file on localfs or dfs, with configurations for "
        + "hoodie client")
    public String propsFilePath = null;

    @Parameter(names = {"--hoodie-conf"}, description = "Any configuration that can be set in the properties file "
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieMetadataTableValidator.java`
#### Snippet
```java

    @Parameter(names = {"--skip-data-files-for-cleaning"}, description = "Skip to compare the data files which are under deletion by cleaner", required = false)
    public boolean skipDataFilesForCleaning = false;

    @Parameter(names = {"--validate-latest-file-slices"}, description = "Validate latest file slices for all partitions.", required = false)
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieMetadataTableValidator.java`
#### Snippet
```java

    @Parameter(names = {"--ignore-failed", "-ig"}, description = "Ignore metadata validate failure and continue.", required = false)
    public boolean ignoreFailed = false;

    @Parameter(names = {"--spark-master", "-ms"}, description = "Spark master", required = false)
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieMetadataTableValidator.java`
#### Snippet
```java
    @Parameter(names = {"--continuous"}, description = "Running MetadataTableValidator in continuous. "
        + "Can use --min-validate-interval-seconds to control validation frequency", required = false)
    public boolean continuous = false;

    @Parameter(names = {"--skip-data-files-for-cleaning"}, description = "Skip to compare the data files which are under deletion by cleaner", required = false)
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieMetadataTableValidator.java`
#### Snippet
```java

    @Parameter(names = {"--spark-master", "-ms"}, description = "Spark master", required = false)
    public String sparkMaster = null;

    @Parameter(names = {"--spark-memory", "-sm"}, description = "spark memory to use", required = false)
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieMetadataTableValidator.java`
#### Snippet
```java

    @Parameter(names = {"--validate-bloom-filters"}, description = "Validate bloom filters of base files", required = false)
    public boolean validateBloomFilters = false;

    @Parameter(names = {"--min-validate-interval-seconds"},
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieMetadataTableValidator.java`
#### Snippet
```java

    @Parameter(names = {"--validate-all-file-groups"}, description = "Validate all file groups, and all file slices within file groups.", required = false)
    public boolean validateAllFileGroups = false;

    @Parameter(names = {"--validate-all-column-stats"}, description = "Validate column stats for all columns in the schema", required = false)
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieMetadataTableValidator.java`
#### Snippet
```java

    @Parameter(names = {"--validate-latest-file-slices"}, description = "Validate latest file slices for all partitions.", required = false)
    public boolean validateLatestFileSlices = false;

    @Parameter(names = {"--validate-latest-base-files"}, description = "Validate latest base files for all partitions.", required = false)
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieMetadataTableValidator.java`
#### Snippet
```java

    @Parameter(names = {"--validate-all-column-stats"}, description = "Validate column stats for all columns in the schema", required = false)
    public boolean validateAllColumnStats = false;

    @Parameter(names = {"--validate-bloom-filters"}, description = "Validate bloom filters of base files", required = false)
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/NoNewDataTerminationStrategy.java`
#### Snippet
```java

  private final int numTimesNoNewDataToShutdown;
  private int numTimesNoNewData = 0;

  public NoNewDataTerminationStrategy(TypedProperties properties) {
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/HoodieDeltaStreamerMetrics.java`
#### Snippet
```java
  public String hiveSyncTimerName = null;
  public String metaSyncTimerName = null;
  private transient Timer overallTimer = null;
  public transient Timer hiveSyncTimer = null;
  public transient Timer metaSyncTimer = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/HoodieDeltaStreamerMetrics.java`
#### Snippet
```java
  private transient Timer overallTimer = null;
  public transient Timer hiveSyncTimer = null;
  public transient Timer metaSyncTimer = null;

  public HoodieDeltaStreamerMetrics(HoodieWriteConfig config) {
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/HoodieDeltaStreamerMetrics.java`
#### Snippet
```java

  public String overallTimerName = null;
  public String hiveSyncTimerName = null;
  public String metaSyncTimerName = null;
  private transient Timer overallTimer = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/HoodieDeltaStreamerMetrics.java`
#### Snippet
```java
  public String metaSyncTimerName = null;
  private transient Timer overallTimer = null;
  public transient Timer hiveSyncTimer = null;
  public transient Timer metaSyncTimer = null;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/HoodieDeltaStreamerMetrics.java`
#### Snippet
```java
  public String overallTimerName = null;
  public String hiveSyncTimerName = null;
  public String metaSyncTimerName = null;
  private transient Timer overallTimer = null;
  public transient Timer hiveSyncTimer = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/HoodieDeltaStreamerMetrics.java`
#### Snippet
```java
  private String tableName;

  public String overallTimerName = null;
  public String hiveSyncTimerName = null;
  public String metaSyncTimerName = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/HoodieMultiTableDeltaStreamer.java`
#### Snippet
```java
        + " For Sources that return Dataset<Row>, the schema is obtained implicitly. "
        + "However, this CLI option allows overriding the schemaprovider returned by Source.")
    public String schemaProviderClassName = null;

    @Parameter(names = {"--transformer-class"},
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/HoodieMultiTableDeltaStreamer.java`
#### Snippet
```java
     */
    @Parameter(names = {"--checkpoint"}, description = "Resume Delta Streamer from this checkpoint.")
    public String checkpoint = null;

    @Parameter(names = {"--cluster-scheduling-weight"}, description = "Scheduling weight for clustering as defined in "
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/HoodieMultiTableDeltaStreamer.java`
#### Snippet
```java
        + "allows a SQL query templated to be passed as a transformation function). "
        + "Pass a comma-separated list of subclass names to chain the transformations.")
    public List<String> transformerClassNames = null;

    @Parameter(names = {"--source-limit"}, description = "Maximum amount of data to read from source. "
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/HoodieDeltaStreamer.java`
#### Snippet
```java
     */
    @Parameter(names = {"--checkpoint"}, description = "Resume Delta Streamer from this checkpoint.")
    public String checkpoint = null;

    @Parameter(names = {"--initial-checkpoint-provider"}, description = "subclass of "
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/HoodieDeltaStreamer.java`
#### Snippet
```java
        + "for the first run. This field will override the checkpoint of last commit using the checkpoint field. "
        + "Use this field only when switching source, for example, from DFS source to Kafka Source.")
    public String initialCheckpointProvider = null;

    @Parameter(names = {"--run-bootstrap"}, description = "Run bootstrap if bootstrap index is not found")
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/HoodieDeltaStreamer.java`
#### Snippet
```java
            + "allows a SQL query templated to be passed as a transformation function). "
            + "Pass a comma-separated list of subclass names to chain the transformations.")
    public List<String> transformerClassNames = null;

    @Parameter(names = {"--source-limit"}, description = "Maximum amount of data to read from source. "
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/HoodieDeltaStreamer.java`
#### Snippet
```java
        + " For Sources that return Dataset<Row>, the schema is obtained implicitly. "
        + "However, this CLI option allows overriding the schemaprovider returned by Source.")
    public String schemaProviderClassName = null;

    @Parameter(names = {"--transformer-class"},
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/bulk/BulkInsertWriterHelper.java`
#### Snippet
```java
  private final List<HoodieInternalWriteStatus> writeStatusList = new ArrayList<>();
  protected HoodieRowDataCreateHandle handle;
  private String lastKnownPartitionPath = null;
  private final String fileIdPrefix;
  private int numFilesWritten = 0;
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/bulk/BulkInsertWriterHelper.java`
#### Snippet
```java
  private String lastKnownPartitionPath = null;
  private final String fileIdPrefix;
  private int numFilesWritten = 0;
  protected final Map<String, HoodieRowDataCreateHandle> handles = new HashMap<>();
  @Nullable protected final RowDataKeyGen keyGen;
```

### RedundantFieldInitialization
Field initialization to `0L` is redundant
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/StreamWriteFunction.java`
#### Snippet
```java
   */
  private static class TotalSizeTracer {
    private long bufferSize = 0L;
    private final double maxBufferSize;

```

### RedundantFieldInitialization
Field initialization to `0L` is redundant
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/StreamWriteFunction.java`
#### Snippet
```java

    private long lastRecordSize = -1L;
    private long totalSize = 0L;

    BufferSizeDetector(double batchSizeMb) {
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/bulk/RowDataKeyGen.java`
#### Snippet
```java
  private RowData.FieldGetter recordKeyFieldGetter;

  private boolean simplePartitionPath = false;
  private RowData.FieldGetter partitionPathFieldGetter;

```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/bulk/RowDataKeyGen.java`
#### Snippet
```java

  // efficient code path
  private boolean simpleRecordKey = false;
  private RowData.FieldGetter recordKeyFieldGetter;

```

### RedundantFieldInitialization
Field initialization to `0L` is redundant
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/utils/TimeWait.java`
#### Snippet
```java
  private final String action;   // action to report error message

  private long waitingTime = 0L;

  private TimeWait(long timeout, long interval, String action) {
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/event/WriteMetadataEvent.java`
#### Snippet
```java
    private Integer taskID;
    private String instantTime;
    private boolean lastBatch = false;
    private boolean endInput = false;
    private boolean bootstrap = false;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/event/WriteMetadataEvent.java`
#### Snippet
```java
    private String instantTime;
    private boolean lastBatch = false;
    private boolean endInput = false;
    private boolean bootstrap = false;

```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/event/WriteMetadataEvent.java`
#### Snippet
```java
    private boolean lastBatch = false;
    private boolean endInput = false;
    private boolean bootstrap = false;

    public WriteMetadataEvent build() {
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/utils/NonThrownExecutor.java`
#### Snippet
```java
    private final Logger logger;
    private ExceptionHook exceptionHook;
    private boolean waitForTasksFinish = false;

    private Builder(Logger logger) {
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/common/AbstractStreamWriteFunction.java`
#### Snippet
```java
   * time changed(the last instant committed successfully).
   */
  protected volatile boolean confirming = false;

  /**
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/clustering/FlinkClusteringConfig.java`
#### Snippet
```java

  @Parameter(names = {"--instant-time", "-it"}, description = "Clustering Instant time")
  public String clusteringInstantTime = null;

  @Parameter(names = {"--clean-async-enabled"}, description = "Whether to cleanup the old commits immediately on new commits, disabled by default")
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/partitioner/BucketAssigner.java`
#### Snippet
```java
  private static class SmallFileAssign {
    final SmallFileAssignState[] states;
    int assignIdx = 0;
    boolean noSpace = false;

```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/partitioner/BucketAssigner.java`
#### Snippet
```java
   * Num of accumulated successful checkpoints, used for cleaning the new file assign state.
   */
  private int accCkp = 0;

  public BucketAssigner(
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/partitioner/BucketAssigner.java`
#### Snippet
```java
    final SmallFileAssignState[] states;
    int assignIdx = 0;
    boolean noSpace = false;

    SmallFileAssign(SmallFileAssignState[] states) {
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/HoodieTableSink.java`
#### Snippet
```java
  private final Configuration conf;
  private final ResolvedSchema schema;
  private boolean overwrite = false;

  public HoodieTableSink(Configuration conf, ResolvedSchema schema) {
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/mor/MergeOnReadInputFormat.java`
#### Snippet
```java
    // method #reachedEnd() returns false after it returns true.
    // refactor it out once FLINK-22370 is resolved.
    private boolean readLogs = false;

    private RowData currentRecord;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/mor/MergeOnReadInputFormat.java`
#### Snippet
```java
    protected String defaultPartName;
    protected long limit = -1;
    protected boolean emitDelete = false;
    protected InternalSchemaManager internalSchemaManager = InternalSchemaManager.DISABLED;

```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/mor/MergeOnReadInputFormat.java`
#### Snippet
```java
   * Recording the current read count for limit check.
   */
  private long currentReadCount = 0;

  /**
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/mor/MergeOnReadInputFormat.java`
#### Snippet
```java
    // method #reachedEnd() returns false after it returns true.
    // refactor it out once FLINK-22370 is resolved.
    private boolean readLogs = false;

    private final Set<String> keyToSkip = new HashSet<>();
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/source/stats/ExpressionEvaluator.java`
#### Snippet
```java
    protected Object minVal;
    protected Object maxVal;
    protected long nullCnt = 0;

    // referenced field type
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/streamer/FlinkStreamerConfig.java`
#### Snippet
```java
          + ". Allows transforming raw source DataStream to a target DataStream (conforming to target schema) before "
          + "writing. Default : Not set. Pass a comma-separated list of subclass names to chain the transformations.")
  public List<String> transformerClassNames = null;

  @Parameter(names = {"--metadata-enabled"}, description = "Enable the internal metadata table which serves table metadata like level file listings, default false.")
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `hudi-flink-datasource/hudi-flink1.13.x/src/main/java/org/apache/hudi/table/format/cow/vector/reader/RunLengthDecoder.java`
#### Snippet
```java
  // Buffer of decoded values if the values are PACKED.
  int[] currentBuffer = new int[16];
  int currentBufferIdx = 0;

  RunLengthDecoder() {
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-flink-datasource/hudi-flink1.13.x/src/main/java/org/apache/hudi/table/format/cow/vector/reader/ArrayColumnReader.java`
#### Snippet
```java

  // flag to indicate if there is no data in parquet data page
  private boolean eof = false;

  // flag to indicate if it's the first time to read parquet data page with this instance
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/source/IncrementalInputSplits.java`
#### Snippet
```java
    private Set<String> requiredPartitions;
    // skip compaction
    private boolean skipCompaction = false;
    // skip clustering
    private boolean skipClustering = false;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/source/IncrementalInputSplits.java`
#### Snippet
```java
    private boolean skipCompaction = false;
    // skip clustering
    private boolean skipClustering = false;

    public Builder() {
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `hudi-flink-datasource/hudi-flink1.14.x/src/main/java/org/apache/hudi/table/format/cow/vector/reader/RunLengthDecoder.java`
#### Snippet
```java
  // Buffer of decoded values if the values are PACKED.
  int[] currentBuffer = new int[16];
  int currentBufferIdx = 0;

  RunLengthDecoder() {
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-flink-datasource/hudi-flink1.14.x/src/main/java/org/apache/hudi/table/format/cow/vector/reader/ArrayColumnReader.java`
#### Snippet
```java

  // flag to indicate if there is no data in parquet data page
  private boolean eof = false;

  // flag to indicate if it's the first time to read parquet data page with this instance
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `hudi-flink-datasource/hudi-flink1.15.x/src/main/java/org/apache/hudi/table/format/cow/vector/reader/RunLengthDecoder.java`
#### Snippet
```java
  // Buffer of decoded values if the values are PACKED.
  int[] currentBuffer = new int[16];
  int currentBufferIdx = 0;

  RunLengthDecoder() {
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-flink-datasource/hudi-flink1.15.x/src/main/java/org/apache/hudi/table/format/cow/vector/reader/ArrayColumnReader.java`
#### Snippet
```java

  // flag to indicate if there is no data in parquet data page
  private boolean eof = false;

  // flag to indicate if it's the first time to read parquet data page with this instance
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `hudi-flink-datasource/hudi-flink1.16.x/src/main/java/org/apache/hudi/table/format/cow/vector/reader/RunLengthDecoder.java`
#### Snippet
```java
  // Buffer of decoded values if the values are PACKED.
  int[] currentBuffer = new int[16];
  int currentBufferIdx = 0;

  RunLengthDecoder() {
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-flink-datasource/hudi-flink1.16.x/src/main/java/org/apache/hudi/table/format/cow/vector/reader/ArrayColumnReader.java`
#### Snippet
```java

  // flag to indicate if there is no data in parquet data page
  private boolean eof = false;

  // flag to indicate if it's the first time to read parquet data page with this instance
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-spark-datasource/hudi-spark/src/main/java/org/apache/hudi/cli/BootstrapExecutorUtils.java`
#### Snippet
```java
    private Boolean bootstrapOverwrite;

    public static String checkpoint = null;

    public void setTableName(String tableName) {
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `hudi-spark-datasource/hudi-spark2/src/main/java/org/apache/spark/sql/execution/datasources/parquet/Spark24HoodieVectorizedParquetRecordReader.java`
#### Snippet
```java
   * batch is used up (batchIdx == numBatched), we populated the batch.
   */
  private int batchIdx = 0;
  private int numBatched = 0;

```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `hudi-spark-datasource/hudi-spark2/src/main/java/org/apache/spark/sql/execution/datasources/parquet/Spark24HoodieVectorizedParquetRecordReader.java`
#### Snippet
```java
   */
  private int batchIdx = 0;
  private int numBatched = 0;

  public Spark24HoodieVectorizedParquetRecordReader(
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-spark-datasource/hudi-spark-common/src/main/java/org/apache/hudi/internal/BaseDefaultSource.java`
#### Snippet
```java
public class BaseDefaultSource {

  protected SparkSession sparkSession = null;
  protected Configuration configuration = null;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-spark-datasource/hudi-spark-common/src/main/java/org/apache/hudi/internal/BaseDefaultSource.java`
#### Snippet
```java

  protected SparkSession sparkSession = null;
  protected Configuration configuration = null;

  protected SparkSession getSparkSession() {
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-timeline-service/src/main/java/org/apache/hudi/timeline/service/handlers/MarkerHandler.java`
#### Snippet
```java
  private ScheduledFuture<?> dispatchingThreadFuture;
  private boolean firstCreationRequestSeen;
  private String currentMarkerDir = null;
  private TimelineServerBasedDetectionStrategy earlyConflictDetectionStrategy;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-timeline-service/src/main/java/org/apache/hudi/timeline/service/TimelineService.java`
#### Snippet
```java
  private transient HoodieEngineContext context;
  private transient FileSystem fs;
  private transient Javalin app = null;
  private transient FileSystemViewManager fsViewsManager;
  private transient RequestHandler requestHandler;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-timeline-service/src/main/java/org/apache/hudi/timeline/service/TimelineService.java`
#### Snippet
```java
      private boolean async = false;
      private boolean compress = true;
      private boolean enableMarkerRequests = false;
      private int markerBatchNumThreads = 20;
      private long markerBatchIntervalMs = 50L;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-timeline-service/src/main/java/org/apache/hudi/timeline/service/TimelineService.java`
#### Snippet
```java

    @Parameter(names = {"--async"}, description = "Use asyncronous request processing")
    public boolean async = false;

    @Parameter(names = {"--compress"}, description = "Compress output using gzip")
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-timeline-service/src/main/java/org/apache/hudi/timeline/service/TimelineService.java`
#### Snippet
```java
      private String rocksDBPath = FileSystemViewStorageConfig.ROCKSDB_BASE_PATH.defaultValue();
      private int numThreads = DEFAULT_NUM_THREADS;
      private boolean async = false;
      private boolean compress = true;
      private boolean enableMarkerRequests = false;
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-timeline-service/src/main/java/org/apache/hudi/timeline/service/TimelineService.java`
#### Snippet
```java

    @Parameter(names = {"--enable-marker-requests", "-em"}, description = "Enable handling of marker-related requests")
    public boolean enableMarkerRequests = false;

    @Parameter(names = {"--marker-batch-threads", "-mbt"}, description = "Number of threads to use for batch processing marker creation requests")
```

### RedundantFieldInitialization
Field initialization to `false` is redundant
in `hudi-timeline-service/src/main/java/org/apache/hudi/timeline/service/handlers/marker/MarkerDirState.java`
#### Snippet
```java
  // in a round-robin fashion
  private int lastFileIndexUsed = -1;
  private boolean isMarkerTypeWritten = false;

  public MarkerDirState(String markerDirPath, int markerBatchNumThreads,
```

### RedundantFieldInitialization
Field initialization to `0` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HDFSParquetImporter.java`
#### Snippet
```java
    public String sparkMemory = null;
    @Parameter(names = {"--retry", "-rt"}, description = "number of retries")
    public int retry = 0;
    @Parameter(names = {"--props"}, description = "path to properties file on localfs or dfs, with configurations for "
        + "hoodie client for importing")
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HDFSParquetImporter.java`
#### Snippet
```java
    @Parameter(names = {"--props"}, description = "path to properties file on localfs or dfs, with configurations for "
        + "hoodie client for importing")
    public String propsFilePath = null;
    @Parameter(names = {"--hoodie-conf"}, description = "Any configuration that can be set in the properties file "
        + "(using the CLI parameter \"--props\") can also be passed command line using this parameter. This can be repeated",
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HDFSParquetImporter.java`
#### Snippet
```java
    public String tableType = null;
    @Parameter(names = {"--row-key-field", "-rk"}, description = "Row key field name", required = true)
    public String rowKey = null;
    @Parameter(names = {"--partition-key-field", "-pk"}, description = "Partition key field name", required = true)
    public String partitionKey = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HDFSParquetImporter.java`
#### Snippet
```java
    public String command = "INSERT";
    @Parameter(names = {"--src-path", "-sp"}, description = "Base path for the input table", required = true)
    public String srcPath = null;
    @Parameter(names = {"--target-path", "-tp"}, description = "Base path for the target hoodie table",
        required = true)
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HDFSParquetImporter.java`
#### Snippet
```java
    public String format = null;
    @Parameter(names = {"--spark-master", "-ms"}, description = "Spark master")
    public String sparkMaster = null;
    @Parameter(names = {"--spark-memory", "-sm"}, description = "spark memory to use", required = true)
    public String sparkMemory = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HDFSParquetImporter.java`
#### Snippet
```java
    public int parallelism = 1;
    @Parameter(names = {"--schema-file", "-sf"}, description = "path for Avro schema file", required = true)
    public String schemaFile = null;
    @Parameter(names = {"--format", "-f"}, description = "Format for the input data.", validateValueWith = FormatValidator.class)
    public String format = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HDFSParquetImporter.java`
#### Snippet
```java
    public String tableName = null;
    @Parameter(names = {"--table-type", "-tt"}, description = "Table type", required = true)
    public String tableType = null;
    @Parameter(names = {"--row-key-field", "-rk"}, description = "Row key field name", required = true)
    public String rowKey = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HDFSParquetImporter.java`
#### Snippet
```java
    public String rowKey = null;
    @Parameter(names = {"--partition-key-field", "-pk"}, description = "Partition key field name", required = true)
    public String partitionKey = null;
    @Parameter(names = {"--parallelism", "-pl"}, description = "Parallelism for hoodie insert(default)/upsert/bulkinsert", required = true)
    public int parallelism = 1;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HDFSParquetImporter.java`
#### Snippet
```java
    public String schemaFile = null;
    @Parameter(names = {"--format", "-f"}, description = "Format for the input data.", validateValueWith = FormatValidator.class)
    public String format = null;
    @Parameter(names = {"--spark-master", "-ms"}, description = "Spark master")
    public String sparkMaster = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HDFSParquetImporter.java`
#### Snippet
```java
    @Parameter(names = {"--target-path", "-tp"}, description = "Base path for the target hoodie table",
        required = true)
    public String targetPath = null;
    @Parameter(names = {"--table-name", "-tn"}, description = "Table name", required = true)
    public String tableName = null;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/table/TableSchemaResolver.java`
#### Snippet
```java
  private final Lazy<ConcurrentHashMap<HoodieInstant, HoodieCommitMetadata>> commitMetadataCache;

  private volatile HoodieInstant latestCommitWithValidSchema = null;
  private volatile HoodieInstant latestCommitWithValidData = null;

```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-common/src/main/java/org/apache/hudi/common/table/TableSchemaResolver.java`
#### Snippet
```java

  private volatile HoodieInstant latestCommitWithValidSchema = null;
  private volatile HoodieInstant latestCommitWithValidData = null;

  public TableSchemaResolver(HoodieTableMetaClient metaClient) {
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HDFSParquetImporter.java`
#### Snippet
```java
    public String sparkMaster = null;
    @Parameter(names = {"--spark-memory", "-sm"}, description = "spark memory to use", required = true)
    public String sparkMemory = null;
    @Parameter(names = {"--retry", "-rt"}, description = "number of retries")
    public int retry = 0;
```

### RedundantFieldInitialization
Field initialization to `null` is redundant
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HDFSParquetImporter.java`
#### Snippet
```java
    public String targetPath = null;
    @Parameter(names = {"--table-name", "-tn"}, description = "Table name", required = true)
    public String tableName = null;
    @Parameter(names = {"--table-type", "-tt"}, description = "Table type", required = true)
    public String tableType = null;
```

## RuleId[ruleID=RedundantImplements]
### RedundantImplements
Redundant interface declaration `Serializable`
in `hudi-gcp/src/main/java/org/apache/hudi/gcp/bigquery/BigQuerySyncConfig.java`
#### Snippet
```java
    groupName = ConfigGroups.Names.META_SYNC,
    description = "Configurations used by the Hudi to sync metadata to Google BigQuery.")
public class BigQuerySyncConfig extends HoodieSyncConfig implements Serializable {

  public static final ConfigProperty<String> BIGQUERY_SYNC_PROJECT_ID = ConfigProperty
```

### RedundantImplements
Redundant interface declaration `AutoCloseable`
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/HiveSyncTool.java`
#### Snippet
```java
 */
@SuppressWarnings("WeakerAccess")
public class HiveSyncTool extends HoodieSyncTool implements AutoCloseable {

  private static final Logger LOG = LogManager.getLogger(HiveSyncTool.class);
```

### RedundantImplements
Redundant interface declaration `HoodieCompactionHandler`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/table/HoodieSparkMergeOnReadTable.java`
#### Snippet
```java
 * </p>
 */
public class HoodieSparkMergeOnReadTable<T> extends HoodieSparkCopyOnWriteTable<T> implements HoodieCompactionHandler<T> {

  HoodieSparkMergeOnReadTable(HoodieWriteConfig config, HoodieEngineContext context, HoodieTableMetaClient metaClient) {
```

### RedundantImplements
Redundant interface declaration `Serializable`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/SparkTaskContextSupplier.java`
#### Snippet
```java
 * Spark task context supplier.
 */
public class SparkTaskContextSupplier extends TaskContextSupplier implements Serializable {

  @Override
```

### RedundantImplements
Redundant interface declaration `Serializable`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/metrics/DistributedRegistry.java`
#### Snippet
```java
 */
public class DistributedRegistry extends AccumulatorV2<Map<String, Long>, Map<String, Long>>
    implements Registry, Serializable {
  private String name;
  ConcurrentHashMap<String, Long> counters = new ConcurrentHashMap<>();
```

### RedundantImplements
Redundant interface declaration `Serializable`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/execution/bulkinsert/PartitionPathRDDPartitioner.java`
#### Snippet
```java
 * based on the table partition path, generating targeted number of Spark partitions.
 */
public class PartitionPathRDDPartitioner extends Partitioner implements Serializable {
  private final SerializableFunctionUnchecked<Object, String> partitionPathExtractor;
  private final int numPartitions;
```

### RedundantImplements
Redundant interface declaration `KryoSerializable`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/common/model/HoodieSparkRecord.java`
#### Snippet
```java
 *
 */
public class HoodieSparkRecord extends HoodieRecord<InternalRow> implements KryoSerializable {

  /**
```

### RedundantImplements
Redundant interface declaration `Serializable`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/io/CreateHandleFactory.java`
#### Snippet
```java
import java.io.Serializable;

public class CreateHandleFactory<T, I, K, O> extends WriteHandleFactory<T, I, K, O> implements Serializable {

  private boolean preserveMetadata = false;
```

### RedundantImplements
Redundant interface declaration `Serializable`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/io/SingleFileHandleCreateFactory.java`
#### Snippet
```java
 * Please use this with caution. This can end up creating very large files if not used correctly.
 */
public class SingleFileHandleCreateFactory<T, I, K, O> extends CreateHandleFactory<T, I, K, O> implements Serializable {

  private final AtomicBoolean isHandleCreated = new AtomicBoolean(false);
```

### RedundantImplements
Redundant interface declaration `Serializable`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/keygen/TimestampBasedAvroKeyGenerator.java`
#### Snippet
```java
 */
public class TimestampBasedAvroKeyGenerator extends SimpleAvroKeyGenerator {
  public enum TimestampType implements Serializable {
    UNIX_TIMESTAMP, DATE_STRING, MIXED, EPOCHMILLISECONDS, SCALAR
  }
```

### RedundantImplements
Redundant interface declaration `Serializable`
in `hudi-common/src/main/java/org/apache/hudi/common/config/TypedProperties.java`
#### Snippet
```java
 * Type-aware extension of {@link java.util.Properties}.
 */
public class TypedProperties extends Properties implements Serializable {

  public TypedProperties() {
```

### RedundantImplements
Redundant interface declaration `Serializable`
in `hudi-common/src/main/java/org/apache/hudi/exception/HoodieHeartbeatException.java`
#### Snippet
```java
 * </p>
 */
public class HoodieHeartbeatException extends RuntimeException implements Serializable {

  public HoodieHeartbeatException() {
```

### RedundantImplements
Redundant interface declaration `Configurable`
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/realtime/HoodieMergeOnReadTableInputFormat.java`
#### Snippet
```java
 * NOTE: This class is invariant of the underlying file-format of the files being read
 */
public class HoodieMergeOnReadTableInputFormat extends HoodieCopyOnWriteTableInputFormat implements Configurable {

  @Override
```

### RedundantImplements
Redundant interface declaration `BoundedOneInput`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/bulk/BulkInsertWriteOperator.java`
#### Snippet
```java
public class BulkInsertWriteOperator<I>
    extends AbstractWriteOperator<I>
    implements BoundedOneInput {

  public BulkInsertWriteOperator(Configuration conf, RowType rowType) {
```

### RedundantImplements
Redundant interface declaration `WritableColumnVector`
in `hudi-flink-datasource/hudi-flink1.13.x/src/main/java/org/apache/hudi/table/format/cow/vector/HeapArrayVector.java`
#### Snippet
```java
 */
public class HeapArrayVector extends AbstractHeapVector
    implements WritableColumnVector, ArrayColumnVector {

  public long[] offsets;
```

### RedundantImplements
Redundant interface declaration `WritableColumnVector`
in `hudi-flink-datasource/hudi-flink1.13.x/src/main/java/org/apache/hudi/table/format/cow/vector/HeapRowColumnVector.java`
#### Snippet
```java
 */
public class HeapRowColumnVector extends AbstractHeapVector
    implements WritableColumnVector, RowColumnVector {

  public WritableColumnVector[] vectors;
```

### RedundantImplements
Redundant interface declaration `WritableColumnVector`
in `hudi-flink-datasource/hudi-flink1.13.x/src/main/java/org/apache/hudi/table/format/cow/vector/HeapMapColumnVector.java`
#### Snippet
```java
 */
public class HeapMapColumnVector extends AbstractHeapVector
    implements WritableColumnVector, MapColumnVector {

  private long[] offsets;
```

### RedundantImplements
Redundant interface declaration `WritableColumnVector`
in `hudi-flink-datasource/hudi-flink1.14.x/src/main/java/org/apache/hudi/table/format/cow/vector/HeapArrayVector.java`
#### Snippet
```java
 */
public class HeapArrayVector extends AbstractHeapVector
    implements WritableColumnVector, ArrayColumnVector {

  public long[] offsets;
```

### RedundantImplements
Redundant interface declaration `WritableColumnVector`
in `hudi-flink-datasource/hudi-flink1.14.x/src/main/java/org/apache/hudi/table/format/cow/vector/HeapRowColumnVector.java`
#### Snippet
```java
 */
public class HeapRowColumnVector extends AbstractHeapVector
    implements WritableColumnVector, RowColumnVector {

  public WritableColumnVector[] vectors;
```

### RedundantImplements
Redundant interface declaration `WritableColumnVector`
in `hudi-flink-datasource/hudi-flink1.14.x/src/main/java/org/apache/hudi/table/format/cow/vector/HeapMapColumnVector.java`
#### Snippet
```java
 */
public class HeapMapColumnVector extends AbstractHeapVector
    implements WritableColumnVector, MapColumnVector {

  private long[] offsets;
```

### RedundantImplements
Redundant interface declaration `WritableColumnVector`
in `hudi-flink-datasource/hudi-flink1.15.x/src/main/java/org/apache/hudi/table/format/cow/vector/HeapArrayVector.java`
#### Snippet
```java
 */
public class HeapArrayVector extends AbstractHeapVector
    implements WritableColumnVector, ArrayColumnVector {

  public long[] offsets;
```

### RedundantImplements
Redundant interface declaration `WritableColumnVector`
in `hudi-flink-datasource/hudi-flink1.15.x/src/main/java/org/apache/hudi/table/format/cow/vector/HeapMapColumnVector.java`
#### Snippet
```java
 */
public class HeapMapColumnVector extends AbstractHeapVector
    implements WritableColumnVector, MapColumnVector {

  private long[] offsets;
```

### RedundantImplements
Redundant interface declaration `WritableColumnVector`
in `hudi-flink-datasource/hudi-flink1.15.x/src/main/java/org/apache/hudi/table/format/cow/vector/HeapRowColumnVector.java`
#### Snippet
```java
 */
public class HeapRowColumnVector extends AbstractHeapVector
    implements WritableColumnVector, RowColumnVector {

  public WritableColumnVector[] vectors;
```

### RedundantImplements
Redundant interface declaration `WritableColumnVector`
in `hudi-flink-datasource/hudi-flink1.16.x/src/main/java/org/apache/hudi/table/format/cow/vector/HeapArrayVector.java`
#### Snippet
```java
 */
public class HeapArrayVector extends AbstractHeapVector
    implements WritableColumnVector, ArrayColumnVector {

  public long[] offsets;
```

### RedundantImplements
Redundant interface declaration `WritableColumnVector`
in `hudi-flink-datasource/hudi-flink1.16.x/src/main/java/org/apache/hudi/table/format/cow/vector/HeapRowColumnVector.java`
#### Snippet
```java
 */
public class HeapRowColumnVector extends AbstractHeapVector
    implements WritableColumnVector, RowColumnVector {

  public WritableColumnVector[] vectors;
```

### RedundantImplements
Redundant interface declaration `WritableColumnVector`
in `hudi-flink-datasource/hudi-flink1.16.x/src/main/java/org/apache/hudi/table/format/cow/vector/HeapMapColumnVector.java`
#### Snippet
```java
 */
public class HeapMapColumnVector extends AbstractHeapVector
    implements WritableColumnVector, MapColumnVector {

  private long[] offsets;
```

### RedundantImplements
Redundant interface declaration `DataSourceV2`
in `hudi-spark-datasource/hudi-spark2/src/main/java/org/apache/hudi/internal/DefaultSource.java`
#### Snippet
```java
 * DataSource V2 implementation for managing internal write logic. Only called internally.
 */
public class DefaultSource extends BaseDefaultSource implements DataSourceV2,
    ReadSupport, WriteSupport, DataSourceRegister {

```

## RuleId[ruleID=InstanceofCatchParameter]
### InstanceofCatchParameter
'instanceof' on 'catch' parameter `e`
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/table/action/commit/JavaBulkInsertPreppedCommitActionExecutor.java`
#### Snippet
```java
          this, false, userDefinedBulkInsertPartitioner);
    } catch (Throwable e) {
      if (e instanceof HoodieInsertException) {
        throw e;
      }
```

### InstanceofCatchParameter
'instanceof' on 'catch' parameter `e`
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/table/action/deltacommit/JavaUpsertPreppedDeltaCommitActionExecutor.java`
#### Snippet
```java
      }
    } catch (Throwable e) {
      if (e instanceof HoodieUpsertException) {
        throw e;
      }
```

### InstanceofCatchParameter
'instanceof' on 'catch' parameter `e`
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/table/action/commit/JavaDeleteHelper.java`
#### Snippet
```java
      return result;
    } catch (Throwable e) {
      if (e instanceof HoodieUpsertException) {
        throw (HoodieUpsertException) e;
      }
```

### InstanceofCatchParameter
'instanceof' on 'catch' parameter `e`
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/table/action/commit/FlinkWriteHelper.java`
#### Snippet
```java
      return result;
    } catch (Throwable e) {
      if (e instanceof HoodieUpsertException) {
        throw (HoodieUpsertException) e;
      }
```

### InstanceofCatchParameter
'instanceof' on 'catch' parameter `e`
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/table/action/commit/FlinkDeleteHelper.java`
#### Snippet
```java
      return result;
    } catch (Throwable e) {
      if (e instanceof HoodieUpsertException) {
        throw (HoodieUpsertException) e;
      }
```

### InstanceofCatchParameter
'instanceof' on 'catch' parameter `e`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/table/action/commit/SparkBulkInsertPreppedCommitActionExecutor.java`
#### Snippet
```java
          this, false, userDefinedBulkInsertPartitioner);
    } catch (Throwable e) {
      if (e instanceof HoodieInsertException) {
        throw e;
      }
```

### InstanceofCatchParameter
'instanceof' on 'catch' parameter `e`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/table/action/deltacommit/SparkBulkInsertPreppedDeltaCommitActionExecutor.java`
#### Snippet
```java
          this, false, bulkInsertPartitioner);
    } catch (Throwable e) {
      if (e instanceof HoodieInsertException) {
        throw e;
      }
```

### InstanceofCatchParameter
'instanceof' on 'catch' parameter `e`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/index/bloom/HoodieBloomIndexCheckFunction.java`
#### Snippet
```java
        }
      } catch (Throwable e) {
        if (e instanceof HoodieException) {
          throw (HoodieException) e;
        }
```

### InstanceofCatchParameter
'instanceof' on 'catch' parameter `e`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/commit/BaseWriteHelper.java`
#### Snippet
```java
      return result;
    } catch (Throwable e) {
      if (e instanceof HoodieUpsertException) {
        throw (HoodieUpsertException) e;
      }
```

### InstanceofCatchParameter
'instanceof' on 'catch' parameter `e`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/commit/HoodieDeleteHelper.java`
#### Snippet
```java
      return result;
    } catch (Throwable e) {
      if (e instanceof HoodieUpsertException) {
        throw (HoodieUpsertException) e;
      }
```

### InstanceofCatchParameter
'instanceof' on 'catch' parameter `e`
in `hudi-common/src/main/java/org/apache/hudi/common/util/ClusteringUtils.java`
#### Snippet
```java
      resultMap = resultStream.collect(Collectors.toMap(Map.Entry::getKey, Map.Entry::getValue));
    } catch (Exception e) {
      if (e instanceof IllegalStateException && e.getMessage().contains("Duplicate key")) {
        throw new HoodieException("Found duplicate file groups pending clustering. If you're running deltastreamer in continuous mode, consider adding delay using --min-sync-interval-seconds. "
            + "Or consider setting write concurrency mode to optimistic_concurrency_control.", e);
```

### InstanceofCatchParameter
'instanceof' on 'catch' parameter `e`
in `hudi-common/src/main/java/org/apache/hudi/common/util/queue/BaseHoodieQueueBasedExecutor.java`
#### Snippet
```java
          .get();
    } catch (Exception e) {
      if (e instanceof InterruptedException) {
        // In case {@code InterruptedException} was thrown, resetting the interrupted flag
        // of the thread, we reset it (to true) again to permit subsequent handlers
```

### InstanceofCatchParameter
'instanceof' on 'catch' parameter `re`
in `hudi-timeline-service/src/main/java/org/apache/hudi/timeline/service/RequestHandler.java`
#### Snippet
```java
      } catch (RuntimeException re) {
        success = false;
        if (re instanceof BadRequestResponse) {
          LOG.warn("Bad request response due to client view behind server view. " + re.getMessage());
        } else {
```

## RuleId[ruleID=ArrayEquality]
### ArrayEquality
Array objects are compared using `==`, not 'Arrays.equals()'
in `hudi-common/src/main/java/org/apache/hudi/common/util/BinaryUtil.java`
#### Snippet
```java
                              byte[] buffer2, int offset2, int length2) {
    // Short circuit equal case
    if (buffer1 == buffer2
        && offset1 == offset2
        && length1 == length2) {
```

## RuleId[ruleID=StringBufferReplaceableByStringBuilder]
### StringBufferReplaceableByStringBuilder
`StringBuffer sb` may be declared as 'StringBuilder'
in `hudi-common/src/main/java/org/apache/hudi/hadoop/CachingPath.java`
#### Snippet
```java
  //       are already normalized
  private static String resolveRelativePath(String basePath, String relativePath) {
    StringBuffer sb = new StringBuffer(basePath);
    if (basePath.endsWith("/")) {
      if (relativePath.startsWith("/")) {
```

### StringBufferReplaceableByStringBuilder
`StringBuffer stringBuffer` may be declared as 'StringBuilder'
in `hudi-spark-datasource/hudi-spark/src/main/java/org/apache/hudi/QuickstartUtils.java`
#### Snippet
```java

  private static Option<String> convertToString(String uuid, String partitionPath, Long ts) {
    StringBuffer stringBuffer = new StringBuffer();
    stringBuffer.append("{");
    stringBuffer.append("\"ts\": \"" + (ts == null ? "0.0" : ts) + "\",");
```

## RuleId[ruleID=RedundantStringFormatCall]
### RedundantStringFormatCall
Redundant call to `format()`
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/action/InternalSchemaChangeApplier.java`
#### Snippet
```java
      }
    } else {
      throw new IllegalArgumentException(String.format("positionType should be specified"));
    }
    return SchemaChangeUtils.applyTableChanges2Schema(latestSchema, add);
```

## RuleId[ruleID=FuseStreamOperations]
### FuseStreamOperations
Stream may be extended replacing 'toArray'
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/InternalSchema.java`
#### Snippet
```java
        StringUtils.join(record.fields().stream()
            .map(f -> " " + f)
            .collect(Collectors.toList()).toArray(new String[0]), "\n"));
  }

```

### FuseStreamOperations
Stream may be extended replacing 'toArray'
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/BootstrapColumnStichingRecordReader.java`
#### Snippet
```java
      values = new ArrayWritable(rightW.getValueClass(), new Writable[numColumns]);
    } else {
      String[] vals = IntStream.range(0, numColumns).mapToObj(idx -> "").collect(Collectors.toList())
          .toArray(new String[0]);
      values = new ArrayWritable(vals);
```

## RuleId[ruleID=ZeroLengthArrayInitialization]
### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/FileSystemViewCommand.java`
#### Snippet
```java
    HoodieTimeline filteredTimeline = new HoodieDefaultTimeline(instantsStream,
        (Function<HoodieInstant, Option<byte[]>> & Serializable) metaClient.getActiveTimeline()::getInstantDetails);
    return new HoodieTableFileSystemView(metaClient, filteredTimeline, statuses.toArray(new FileStatus[0]));
  }
}
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/ArchivedCommitsCommand.java`
#### Snippet
```java
              row.add(hoodieWriteStat.getTotalWriteErrors());
              return row;
            })).map(rowList -> rowList.toArray(new Comparable[0]));
          }).collect(Collectors.toList());
      allStats.addAll(readCommits);
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/ArchivedCommitsCommand.java`
#### Snippet
```java
          return commitDetail(record, "hoodieCompactionMetadata", skipMetadata);
        default: {
          return new Comparable[] {};
        }
      }
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/ArchivedCommitsCommand.java`
#### Snippet
```java
    } catch (Exception e) {
      e.printStackTrace();
      return new Comparable[] {};
    }
  }
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-cli/src/main/java/org/apache/hudi/cli/HoodiePrintHelper.java`
#### Snippet
```java
    String[] head = new String[header.getFieldNames().size()];
    header.getFieldNames().toArray(head);
    return printTextTable(head, new String[][] {});
  }

```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/util/PartitionFilterGenerator.java`
#### Snippet
```java
            values.add(partitions.get(j).getValues().get(i));
          }
          return Pair.of(partitionFields.get(i), values.toArray(new String[0]));
        })
        .collect(Collectors.toList());
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/io/storage/row/parquet/ParquetSchemaConverter.java`
#### Snippet
```java

    return new RowTypeInfo(
        types.toArray(new TypeInformation<?>[0]), names.toArray(new String[0]));
  }

```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/io/storage/row/parquet/ParquetSchemaConverter.java`
#### Snippet
```java

    return new RowTypeInfo(
        types.toArray(new TypeInformation<?>[0]), names.toArray(new String[0]));
  }

```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/io/storage/row/parquet/ParquetRowDataWriter.java`
#### Snippet
```java

    this.filedWriters = new FieldWriter[rowType.getFieldCount()];
    this.fieldNames = rowType.getFieldNames().toArray(new String[0]);
    for (int i = 0; i < rowType.getFieldCount(); i++) {
      this.filedWriters[i] = createWriter(rowType.getTypeAt(i));
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/io/HoodieAppendHandle.java`
#### Snippet
```java

      if (appendDeleteBlocks && recordsToDelete.size() > 0) {
        blocks.add(new HoodieDeleteBlock(recordsToDelete.toArray(new DeleteRecord[0]), header));
      }

```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-common/src/main/java/org/apache/hudi/BaseHoodieTableFileIndex.java`
#### Snippet
```java
                                  boolean shouldListLazily) {
    this.partitionColumns = metaClient.getTableConfig().getPartitionFields()
        .orElse(new String[0]);

    this.metadataConfig = HoodieMetadataConfig.newBuilder()
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metadata/HoodieBackedTableMetadataWriter.java`
#### Snippet
```java
    // It is assumed that as of time Tx of base instant (/compaction time) in metadata table,
    // all commits in data table is in sync with metadata table. So, we always start with log file for any fileGroup.
    final HoodieDeleteBlock block = new HoodieDeleteBlock(new DeleteRecord[0], blockHeader);

    LOG.info(String.format("Creating %d file groups for partition %s with base fileId %s at instant time %s",
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-common/src/main/java/org/apache/hudi/common/fs/FSUtils.java`
#### Snippet
```java
      // return empty FileStatus if partition does not exist already
      if (!fs.exists(partitionPath)) {
        return new FileStatus[0];
      } else {
        throw e;
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-common/src/main/java/org/apache/hudi/common/util/FutureUtils.java`
#### Snippet
```java
   */
  public static <T> CompletableFuture<List<T>> allOf(@Nonnull List<CompletableFuture<T>> futures) {
    return CompletableFuture.allOf(futures.toArray(new CompletableFuture[0]))
        .thenApply(aVoid ->
            futures.stream()
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-common/src/main/java/org/apache/hudi/common/util/StringUtils.java`
#### Snippet
```java
      return null;
    }
    return org.apache.hadoop.util.StringUtils.join(separator, list.toArray(new String[0]));
  }

```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-common/src/main/java/org/apache/hudi/common/util/HoodieRecordUtils.java`
#### Snippet
```java
          if (null == recordMerger) {
            recordMerger = (HoodieRecordMerger) ReflectionUtils.loadClass(mergerClass,
                new Object[]{});
            INSTANCE_CACHE.put(mergerClass, recordMerger);
          }
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieAvroPayload.java`
#### Snippet
```java

  public HoodieAvroPayload(Option<GenericRecord> record) {
    this.recordBytes = record.isPresent() ? HoodieAvroUtils.avroToBytes(record.get()) : new byte[0];
    this.orderingVal = 0;
  }
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieAvroPayload.java`
#### Snippet
```java

  public HoodieAvroPayload(GenericRecord record, Comparable<?> orderingVal) {
    this.recordBytes = record == null ? new byte[0] : HoodieAvroUtils.avroToBytes(record);
    this.orderingVal = orderingVal;
  }
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-common/src/main/java/org/apache/hudi/common/model/BaseAvroPayload.java`
#### Snippet
```java
   */
  public BaseAvroPayload(GenericRecord record, Comparable orderingVal) {
    this.recordBytes = record != null ? HoodieAvroUtils.avroToBytes(record) : new byte[0];
    this.orderingVal = orderingVal;
    this.isDeletedRecord = record == null || isDeleteRecord(record);
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-common/src/main/java/org/apache/hudi/common/table/cdc/HoodieCDCExtractor.java`
#### Snippet
```java
          metaClient,
          metaClient.getCommitsTimeline().filterCompletedInstants(),
          touchedFiles.toArray(new FileStatus[0])
      );
    } catch (Exception e) {
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-common/src/main/java/org/apache/hudi/common/table/HoodieTableConfig.java`
#### Snippet
```java
    String keyFieldsValue = getStringOrDefault(RECORDKEY_FIELDS, HoodieRecord.RECORD_KEY_METADATA_FIELD);
    return Option.of(Arrays.stream(keyFieldsValue.split(","))
        .filter(p -> p.length() > 0).collect(Collectors.toList()).toArray(new String[] {}));
  }

```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-common/src/main/java/org/apache/hudi/common/table/HoodieTableConfig.java`
#### Snippet
```java
    if (contains(PARTITION_FIELDS)) {
      return Option.of(Arrays.stream(getString(PARTITION_FIELDS).split(","))
          .filter(p -> p.length() > 0).collect(Collectors.toList()).toArray(new String[] {}));
    }
    return Option.empty();
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/block/HoodieCommandBlock.java`
#### Snippet
```java
  @Override
  public byte[] getContentBytes() {
    return new byte[0];
  }
}
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/block/HoodieParquetDataBlock.java`
#### Snippet
```java
  protected byte[] serializeRecords(List<HoodieRecord> records) throws IOException {
    if (records.size() == 0) {
      return new byte[0];
    }

```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/RemoteHoodieTableFileSystemView.java`
#### Snippet
```java
  public Stream<FileSlice> getLatestFileSliceInRange(List<String> commitsToReturn) {
    Map<String, String> paramsMap =
        getParams(INSTANTS_PARAM, StringUtils.join(commitsToReturn.toArray(new String[0]), ","));
    try {
      List<FileSliceDTO> dataFiles = executeRequest(LATEST_SLICES_RANGE_INSTANT_URL, paramsMap,
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/RemoteHoodieTableFileSystemView.java`
#### Snippet
```java
  public Stream<HoodieBaseFile> getLatestBaseFilesInRange(List<String> commitsToReturn) {
    Map<String, String> paramsMap =
        getParams(INSTANTS_PARAM, StringUtils.join(commitsToReturn.toArray(new String[0]), ","));
    return getLatestBaseFilesFromParams(paramsMap, LATEST_DATA_FILES_RANGE_INSTANT_URL);
  }
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/AbstractTableFileSystemView.java`
#### Snippet
```java
        if (!metaClient.getFs().exists(absolutePartitionPath)) {
          metaClient.getFs().mkdirs(absolutePartitionPath);
          fileStatusMap.put(partitionPair, new FileStatus[0]);
        } else {
          // in case the partition path was created by another caller
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/AbstractTableFileSystemView.java`
#### Snippet
```java
      if (!metaClient.getFs().exists(partitionPath)) {
        metaClient.getFs().mkdirs(partitionPath);
        return new FileStatus[0];
      } else {
        // in case the partition path was created by another caller
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/InternalSchema.java`
#### Snippet
```java
        StringUtils.join(record.fields().stream()
            .map(f -> " " + f)
            .collect(Collectors.toList()).toArray(new String[0]), "\n"));
  }

```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-common/src/main/java/org/apache/hudi/common/bootstrap/index/HFileBootstrapIndex.java`
#### Snippet
```java
        srcFilePartitionInfo.setBootstrapPartitionPath(mapping.getBootstrapPartitionPath());
        srcFilePartitionInfo.setBootstrapFileStatus(mapping.getBootstrapFileStatus());
        KeyValue kv = new KeyValue(getFileGroupKey(mapping.getFileGroupId()).getBytes(), new byte[0], new byte[0],
            HConstants.LATEST_TIMESTAMP, KeyValue.Type.Put,
            TimelineMetadataUtils.serializeAvroMetadata(srcFilePartitionInfo,
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-common/src/main/java/org/apache/hudi/common/bootstrap/index/HFileBootstrapIndex.java`
#### Snippet
```java
        srcFilePartitionInfo.setBootstrapPartitionPath(mapping.getBootstrapPartitionPath());
        srcFilePartitionInfo.setBootstrapFileStatus(mapping.getBootstrapFileStatus());
        KeyValue kv = new KeyValue(getFileGroupKey(mapping.getFileGroupId()).getBytes(), new byte[0], new byte[0],
            HConstants.LATEST_TIMESTAMP, KeyValue.Type.Put,
            TimelineMetadataUtils.serializeAvroMetadata(srcFilePartitionInfo,
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-common/src/main/java/org/apache/hudi/common/bootstrap/index/HFileBootstrapIndex.java`
#### Snippet
```java
      try {
        HFileScanner scanner = partitionIndexReader().getScanner(true, false);
        KeyValue keyValue = new KeyValue(Bytes.toBytes(getPartitionKey(partition)), new byte[0], new byte[0],
            HConstants.LATEST_TIMESTAMP, KeyValue.Type.Put, new byte[0]);
        if (scanner.seekTo(keyValue) == 0) {
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-common/src/main/java/org/apache/hudi/common/bootstrap/index/HFileBootstrapIndex.java`
#### Snippet
```java
      try {
        HFileScanner scanner = partitionIndexReader().getScanner(true, false);
        KeyValue keyValue = new KeyValue(Bytes.toBytes(getPartitionKey(partition)), new byte[0], new byte[0],
            HConstants.LATEST_TIMESTAMP, KeyValue.Type.Put, new byte[0]);
        if (scanner.seekTo(keyValue) == 0) {
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-common/src/main/java/org/apache/hudi/common/bootstrap/index/HFileBootstrapIndex.java`
#### Snippet
```java
        HFileScanner scanner = partitionIndexReader().getScanner(true, false);
        KeyValue keyValue = new KeyValue(Bytes.toBytes(getPartitionKey(partition)), new byte[0], new byte[0],
            HConstants.LATEST_TIMESTAMP, KeyValue.Type.Put, new byte[0]);
        if (scanner.seekTo(keyValue) == 0) {
          ByteBuffer readValue = scanner.getValue();
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-common/src/main/java/org/apache/hudi/common/bootstrap/index/HFileBootstrapIndex.java`
#### Snippet
```java
        HFileScanner scanner = fileIdIndexReader().getScanner(true, false);
        for (HoodieFileGroupId fileGroupId : fileGroupIds) {
          KeyValue keyValue = new KeyValue(Bytes.toBytes(getFileGroupKey(fileGroupId)), new byte[0], new byte[0],
              HConstants.LATEST_TIMESTAMP, KeyValue.Type.Put, new byte[0]);
          if (scanner.seekTo(keyValue) == 0) {
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-common/src/main/java/org/apache/hudi/common/bootstrap/index/HFileBootstrapIndex.java`
#### Snippet
```java
        HFileScanner scanner = fileIdIndexReader().getScanner(true, false);
        for (HoodieFileGroupId fileGroupId : fileGroupIds) {
          KeyValue keyValue = new KeyValue(Bytes.toBytes(getFileGroupKey(fileGroupId)), new byte[0], new byte[0],
              HConstants.LATEST_TIMESTAMP, KeyValue.Type.Put, new byte[0]);
          if (scanner.seekTo(keyValue) == 0) {
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-common/src/main/java/org/apache/hudi/common/bootstrap/index/HFileBootstrapIndex.java`
#### Snippet
```java
        for (HoodieFileGroupId fileGroupId : fileGroupIds) {
          KeyValue keyValue = new KeyValue(Bytes.toBytes(getFileGroupKey(fileGroupId)), new byte[0], new byte[0],
              HConstants.LATEST_TIMESTAMP, KeyValue.Type.Put, new byte[0]);
          if (scanner.seekTo(keyValue) == 0) {
            ByteBuffer readValue = scanner.getValue();
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-common/src/main/java/org/apache/hudi/common/bootstrap/index/HFileBootstrapIndex.java`
#### Snippet
```java
        if (bytes.isPresent()) {
          indexByPartitionWriter
              .append(new KeyValue(Bytes.toBytes(getPartitionKey(partitionPath)), new byte[0], new byte[0],
                  HConstants.LATEST_TIMESTAMP, KeyValue.Type.Put, bytes.get()));
          numPartitionKeysAdded++;
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-common/src/main/java/org/apache/hudi/common/bootstrap/index/HFileBootstrapIndex.java`
#### Snippet
```java
        if (bytes.isPresent()) {
          indexByPartitionWriter
              .append(new KeyValue(Bytes.toBytes(getPartitionKey(partitionPath)), new byte[0], new byte[0],
                  HConstants.LATEST_TIMESTAMP, KeyValue.Type.Put, bytes.get()));
          numPartitionKeysAdded++;
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/Types.java`
#### Snippet
```java
    private RecordType(List<Field> fields, String name) {
      this.name = name;
      this.fields = fields.toArray(new Field[0]);
    }

```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-common/src/main/java/org/apache/hudi/metadata/BaseTableMetadata.java`
#### Snippet
```java
      }
    })
        .orElse(new FileStatus[0]);

    LOG.info("Listed file in partition from metadata: partition=" + relativePartitionPath + ", #files=" + statuses.length);
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/BootstrapColumnStichingRecordReader.java`
#### Snippet
```java
    } else {
      String[] vals = IntStream.range(0, numColumns).mapToObj(idx -> "").collect(Collectors.toList())
          .toArray(new String[0]);
      values = new ArrayWritable(vals);
    }
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/HoodieColumnProjectionUtils.java`
#### Snippet
```java
      return colNames.split(",");
    }
    return new String[] {};
  }

```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/HiveHoodieTableFileIndex.java`
#### Snippet
```java
    //       since Hive does partition pruning in a different way (based on the input-path being
    //       fetched by the query engine)
    return new Object[0];
  }

```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/HoodieCopyOnWriteTableInputFormat.java`
#### Snippet
```java
      FileStatus externalFileStatus = file.getBootstrapFileStatus();
      FileSplit externalFileSplit = makeSplit(externalFileStatus.getPath(), 0, externalFileStatus.getLen(),
          new String[0], new String[0]);
      return new BootstrapBaseFileSplit(split, externalFileSplit);
    } catch (IOException e) {
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/HoodieCopyOnWriteTableInputFormat.java`
#### Snippet
```java
      FileStatus externalFileStatus = file.getBootstrapFileStatus();
      FileSplit externalFileSplit = makeSplit(externalFileStatus.getPath(), 0, externalFileStatus.getLen(),
          new String[0], new String[0]);
      return new BootstrapBaseFileSplit(split, externalFileSplit);
    } catch (IOException e) {
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/HoodieCopyOnWriteTableInputFormat.java`
#### Snippet
```java
      returns.addAll(listStatusForSnapshotMode(job, tableMetaClientMap, snapshotPaths));
    }
    return returns.toArray(new FileStatus[0]);
  }

```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/utils/HoodieRealtimeRecordReaderUtils.java`
#### Snippet
```java
    // Field Names -> {@link https://github.com/apache/hive/blob/f37c5de6c32b9395d1b34fa3c02ed06d1bfbf6eb/serde/src/java
    // /org/apache/hadoop/hive/serde2/ColumnProjectionUtils.java#L229}
    String[] fieldOrdersWithDups = fieldOrderCsv.isEmpty() ? new String[0] : fieldOrderCsv.split(",");
    Set<String> fieldOrdersSet = new LinkedHashSet<>(Arrays.asList(fieldOrdersWithDups));
    String[] fieldOrders = fieldOrdersSet.toArray(new String[0]);
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/utils/HoodieRealtimeRecordReaderUtils.java`
#### Snippet
```java
    String[] fieldOrdersWithDups = fieldOrderCsv.isEmpty() ? new String[0] : fieldOrderCsv.split(",");
    Set<String> fieldOrdersSet = new LinkedHashSet<>(Arrays.asList(fieldOrdersWithDups));
    String[] fieldOrders = fieldOrdersSet.toArray(new String[0]);
    List<String> fieldNames = fieldNameCsv.isEmpty() ? new ArrayList<>() : Arrays.stream(fieldNameCsv.split(","))
        .filter(fn -> !partitioningFields.contains(fn)).collect(Collectors.toList());
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/utils/HoodieRealtimeRecordReaderUtils.java`
#### Snippet
```java
    }
    TreeMap<Integer, String> orderedFieldMap = new TreeMap<>();
    String[] fieldNamesArray = fieldNamesSet.toArray(new String[0]);
    for (int ox = 0; ox < fieldOrders.length; ox++) {
      orderedFieldMap.put(Integer.parseInt(fieldOrders[ox]), fieldNamesArray[ox]);
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/utils/HoodieInputFormatUtils.java`
#### Snippet
```java
      fullPathToFileStatus.putAll(metadata.getFullPathToFileStatus(hadoopConf, basePath.toString()));
    }
    return fullPathToFileStatus.values().toArray(new FileStatus[0]);
  }

```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/hive/HoodieCombineHiveInputFormat.java`
#### Snippet
```java
          combine.createPool(job, new CombineFilter(filterPath));
        }
        processPaths(job, combine, iss, inpFiles.toArray(new Path[0]));
      }
    }
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/hive/HoodieCombineHiveInputFormat.java`
#### Snippet
```java
    // Process the normal splits
    if (nonCombinablePaths.size() > 0) {
      FileInputFormat.setInputPaths(job, nonCombinablePaths.toArray(new Path[0]));
      InputSplit[] splits = super.getSplits(job, numSplits);
      Collections.addAll(result, splits);
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/hive/HoodieCombineHiveInputFormat.java`
#### Snippet
```java
    // Process the combine splits
    if (combinablePaths.size() > 0) {
      FileInputFormat.setInputPaths(job, combinablePaths.toArray(new Path[0]));
      Map<Path, PartitionDesc> pathToPartitionInfo = this.pathToPartitionInfo != null ? this.pathToPartitionInfo
          : Utilities.getMapWork(job).getPathToPartitionInfo();
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/realtime/HoodieMergeOnReadTableInputFormat.java`
#### Snippet
```java

    return (containsIncrementalQuerySplits(fileSplits) ? filterIncrementalQueryFileSplits(fileSplits) : fileSplits)
        .toArray(new FileSplit[0]);
  }

```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/realtime/HoodieMergeOnReadTableInputFormat.java`
#### Snippet
```java
    try {
      String[] hosts = split.getLocationInfo() != null ? Arrays.stream(split.getLocationInfo())
          .filter(x -> !x.isInMemory()).toArray(String[]::new) : new String[0];
      String[] inMemoryHosts = split.getLocationInfo() != null ? Arrays.stream(split.getLocationInfo())
          .filter(SplitLocationInfo::isInMemory).toArray(String[]::new) : new String[0];
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/realtime/HoodieMergeOnReadTableInputFormat.java`
#### Snippet
```java
          .filter(x -> !x.isInMemory()).toArray(String[]::new) : new String[0];
      String[] inMemoryHosts = split.getLocationInfo() != null ? Arrays.stream(split.getLocationInfo())
          .filter(SplitLocationInfo::isInMemory).toArray(String[]::new) : new String[0];
      FileSplit baseSplit = new FileSplit(split.getPath(), split.getStart(), split.getLength(),
          hosts, inMemoryHosts);
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/realtime/HoodieMergeOnReadTableInputFormat.java`
#### Snippet
```java
        .listAffectedFilesForCommits(job, new Path(tableMetaClient.getBasePath()), metadataList));
    // step3
    HoodieTableFileSystemView fsView = new HoodieTableFileSystemView(tableMetaClient, commitsTimelineToReturn, affectedFileStatus.toArray(new FileStatus[0]));
    // build fileGroup from fsView
    Path basePath = new Path(tableMetaClient.getBasePath());
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/S3EventsHoodieIncrSource.java`
#### Snippet
```java
    if (!cloudFiles.isEmpty()) {
      DataFrameReader dataFrameReader = getDataFrameReader(fileFormat);
      dataset = Option.of(dataFrameReader.load(cloudFiles.toArray(new String[0])));
    }
    LOG.debug("Extracted distinct files " + cloudFiles.size()
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/helpers/IncrSourceCloudStorageHelper.java`
#### Snippet
```java

    DataFrameReader dfReader = getDataFrameReader(spark, props, fileFormat);
    Dataset<Row> fileDataDs = dfReader.load(filepaths.toArray(new String[0]));
    return Option.of(fileDataDs);
  }
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/StreamWriteOperatorCoordinator.java`
#### Snippet
```java
        () -> {
          try {
            result.complete(new byte[0]);
          } catch (Throwable throwable) {
            // when a checkpoint fails, throws directly.
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/util/RowDataProjection.java`
#### Snippet
```java

  public static RowDataProjection instance(RowType rowType, int[] positions) {
    final LogicalType[] types = rowType.getChildren().toArray(new LogicalType[0]);
    return new RowDataProjection(types, positions);
  }
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/partitioner/profile/WriteProfiles.java`
#### Snippet
```java
    metadataList.forEach(metadata ->
        uniqueIdToFileStatus.putAll(getFilesToReadOfInstant(basePath, metadata, fs, tableType)));
    return uniqueIdToFileStatus.values().toArray(new FileStatus[0]);
  }

```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/partitioner/profile/WriteProfiles.java`
#### Snippet
```java
    metadataList.forEach(metadata ->
        uniqueIdToFileStatus.putAll(getFilesToReadOfInstant(basePath, metadata, hadoopConf, tableType)));
    return uniqueIdToFileStatus.values().toArray(new FileStatus[0]);
  }

```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/utils/Pipelines.java`
#### Snippet
```java
          ArrayList<String> sortList = new ArrayList<>(Arrays.asList(partitionFields));
          Collections.addAll(sortList, recordKeyFields);
          sortFields = sortList.toArray(new String[0]);
          operatorName = "sorter:(partition_key, record_key)";
        }
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/cow/CopyOnWriteInputFormat.java`
#### Snippet
```java
        }
        FileInputSplit fis = new FileInputSplit(splitNum++, new Path(file.getPath().toUri()), 0, len,
            hosts.toArray(new String[0]));
        inputSplits.add(fis);
      }
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/cow/CopyOnWriteInputFormat.java`
#### Snippet
```java
        inputSplits.add(fis);
      }
      return inputSplits.toArray(new FileInputSplit[0]);
    }

```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/cow/CopyOnWriteInputFormat.java`
#### Snippet
```java
          hosts = blocks[0].getHosts();
        } else {
          hosts = new String[0];
        }
        final FileInputSplit fis = new FileInputSplit(splitNum++, new Path(file.getPath().toUri()), 0, 0, hosts);
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/cow/CopyOnWriteInputFormat.java`
#### Snippet
```java
    }

    return inputSplits.toArray(new FileInputSplit[0]);
  }

```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/FilePathUtils.java`
#### Snippet
```java
              path,
              hivePartition,
              partitionKeys.toArray(new String[0]))
          .stream()
          .map(tuple2 -> tuple2.f0)
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/FilePathUtils.java`
#### Snippet
```java
      listStatusRecursively(fs, fileStatus, 0, expectLevel, result);
    } catch (IOException ignore) {
      return new FileStatus[0];
    }

```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/FilePathUtils.java`
#### Snippet
```java
    }

    return result.toArray(new FileStatus[0]);
  }

```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/FilePathUtils.java`
#### Snippet
```java
  public static String[] extractPartitionKeys(org.apache.flink.configuration.Configuration conf) {
    if (FlinkOptions.isDefaultValueDefined(conf, FlinkOptions.PARTITION_PATH_FIELD)) {
      return new String[0];
    }
    return conf.getString(FlinkOptions.PARTITION_PATH_FIELD).split(",");
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/HoodieTableSource.java`
#### Snippet
```java

  private String getSourceOperatorName(String operatorName) {
    String[] schemaFieldNames = this.schema.getColumnNames().toArray(new String[0]);
    List<String> fields = Arrays.stream(this.requiredPos)
        .mapToObj(i -> schemaFieldNames[i])
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/HoodieTableSource.java`
#### Snippet
```java

  private DataType getProducedDataType() {
    String[] schemaFieldNames = this.schema.getColumnNames().toArray(new String[0]);
    DataType[] schemaTypes = this.schema.getColumnDataTypes().toArray(new DataType[0]);

```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/HoodieTableSource.java`
#### Snippet
```java
  private DataType getProducedDataType() {
    String[] schemaFieldNames = this.schema.getColumnNames().toArray(new String[0]);
    DataType[] schemaTypes = this.schema.getColumnDataTypes().toArray(new DataType[0]);

    return DataTypes.ROW(Arrays.stream(this.requiredPos)
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/HoodieTableSource.java`
#### Snippet
```java
    List<String> relPartitionPaths = fileIndex.getOrBuildPartitionPaths();
    if (relPartitionPaths.size() == 0) {
      return new FileStatus[0];
    }
    return fileIndex.getFilesInPartitions();
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/HoodieTableSource.java`
#### Snippet
```java
    return new CopyOnWriteInputFormat(
        FilePathUtils.toFlinkPaths(paths),
        this.schema.getColumnNames().toArray(new String[0]),
        this.schema.getColumnDataTypes().toArray(new DataType[0]),
        this.requiredPos,
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/HoodieTableSource.java`
#### Snippet
```java
        FilePathUtils.toFlinkPaths(paths),
        this.schema.getColumnNames().toArray(new String[0]),
        this.schema.getColumnDataTypes().toArray(new DataType[0]),
        this.requiredPos,
        this.conf.getString(FlinkOptions.PARTITION_DEFAULT_NAME),
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/catalog/HiveSchemaUtils.java`
#### Snippet
```java
    final DataType dataType = schema.toPersistedRowDataType();
    final RowType rowType = (RowType) dataType.getLogicalType();
    final String[] fieldNames = rowType.getFieldNames().toArray(new String[0]);
    final DataType[] fieldTypes = dataType.getChildren().toArray(new DataType[0]);

```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/catalog/HiveSchemaUtils.java`
#### Snippet
```java
    final RowType rowType = (RowType) dataType.getLogicalType();
    final String[] fieldNames = rowType.getFieldNames().toArray(new String[0]);
    final DataType[] fieldTypes = dataType.getChildren().toArray(new DataType[0]);

    List<FieldSchema> columns = new ArrayList<>(fieldNames.length);
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/mor/MergeOnReadInputFormat.java`
#### Snippet
```java
        true,
        HadoopConfigurations.getParquetConf(this.conf, hadoopConf),
        fieldNames.toArray(new String[0]),
        fieldTypes.toArray(new DataType[0]),
        partObjects,
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/mor/MergeOnReadInputFormat.java`
#### Snippet
```java
        HadoopConfigurations.getParquetConf(this.conf, hadoopConf),
        fieldNames.toArray(new String[0]),
        fieldTypes.toArray(new DataType[0]),
        partObjects,
        requiredPos,
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/mor/MergeOnReadInputFormat.java`
#### Snippet
```java
  @Override
  public MergeOnReadInputSplit[] createInputSplits(int minNumSplits) {
    return this.tableState.getInputSplits().toArray(new MergeOnReadInputSplit[0]);
  }

```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/source/FileIndex.java`
#### Snippet
```java
  public FileStatus[] getFilesInPartitions() {
    if (!tableExists) {
      return new FileStatus[0];
    }
    String[] partitions = getOrBuildPartitionPaths().stream().map(p -> fullPartitionPath(path, p)).toArray(String[]::new);
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/source/stats/ColumnStatsIndices.java`
#### Snippet
```java
        }).collect(Collectors.groupingBy(rowData -> rowData.getString(ORD_FILE_NAME)));

    return Pair.of(foldRowsByFiles(sortedTargetColumns, fileNameToRows), sortedTargetColumns.toArray(new String[0]));
  }

```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-flink-datasource/hudi-flink1.13.x/src/main/java/org/apache/hudi/table/format/cow/ParquetSplitReaderUtil.java`
#### Snippet
```java
            .mapToObj(i -> fullFieldTypes[i].getLogicalType())
            .toArray(LogicalType[]::new),
        selNonPartNames.toArray(new String[0]),
        gen,
        batchSize,
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-flink-datasource/hudi-flink1.14.x/src/main/java/org/apache/hudi/table/format/cow/ParquetSplitReaderUtil.java`
#### Snippet
```java
            .mapToObj(i -> fullFieldTypes[i].getLogicalType())
            .toArray(LogicalType[]::new),
        selNonPartNames.toArray(new String[0]),
        gen,
        batchSize,
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-flink-datasource/hudi-flink1.15.x/src/main/java/org/apache/hudi/table/format/cow/ParquetSplitReaderUtil.java`
#### Snippet
```java
            .mapToObj(i -> fullFieldTypes[i].getLogicalType())
            .toArray(LogicalType[]::new),
        selNonPartNames.toArray(new String[0]),
        gen,
        batchSize,
```

### ZeroLengthArrayInitialization
Allocation of zero length array
in `hudi-flink-datasource/hudi-flink1.16.x/src/main/java/org/apache/hudi/table/format/cow/ParquetSplitReaderUtil.java`
#### Snippet
```java
            .mapToObj(i -> fullFieldTypes[i].getLogicalType())
            .toArray(LogicalType[]::new),
        selNonPartNames.toArray(new String[0]),
        gen,
        batchSize,
```

## RuleId[ruleID=NonFinalFieldOfException]
### NonFinalFieldOfException
Non-final field `schema` of exception class
in `hudi-common/src/main/java/org/apache/hudi/avro/MercifulJsonConverter.java`
#### Snippet
```java
    private Object value;
    private String fieldName;
    private Schema schema;

    public HoodieJsonToAvroConversionException(Object value, String fieldName, Schema schema) {
```

### NonFinalFieldOfException
Non-final field `value` of exception class
in `hudi-common/src/main/java/org/apache/hudi/avro/MercifulJsonConverter.java`
#### Snippet
```java
  public static class HoodieJsonToAvroConversionException extends HoodieException {

    private Object value;
    private String fieldName;
    private Schema schema;
```

### NonFinalFieldOfException
Non-final field `fieldName` of exception class
in `hudi-common/src/main/java/org/apache/hudi/avro/MercifulJsonConverter.java`
#### Snippet
```java

    private Object value;
    private String fieldName;
    private Schema schema;

```

### NonFinalFieldOfException
Non-final field `ioException` of exception class
in `hudi-common/src/main/java/org/apache/hudi/exception/HoodieSerializationException.java`
#### Snippet
```java
public class HoodieSerializationException extends HoodieException {

  private IOException ioException;

  public HoodieSerializationException(String msg, IOException t) {
```

### NonFinalFieldOfException
Non-final field `ioException` of exception class
in `hudi-common/src/main/java/org/apache/hudi/exception/HoodieIOException.java`
#### Snippet
```java
public class HoodieIOException extends HoodieException {

  private IOException ioException;

  public HoodieIOException(String msg, IOException t) {
```

## RuleId[ruleID=RedundantUnmodifiable]
### RedundantUnmodifiable
Redundant usage of the 'unmodifiableMap' wrapper
in `hudi-common/src/main/java/org/apache/hudi/common/util/CollectionUtils.java`
#### Snippet
```java

  public static <K,V> Map<K, V> createImmutableMap(final K key, final V value) {
    return Collections.unmodifiableMap(Collections.singletonMap(key, value));
  }

```

## RuleId[ruleID=NullArgumentToVariableArgMethod]
### NullArgumentToVariableArgMethod
Confusing argument `row.toArray(new Comparable[row.size()])`, unclear if a varargs or non-varargs call is desired
in `hudi-cli/src/main/java/org/apache/hudi/cli/utils/SparkTempViewProvider.java`
#### Snippet
```java
        structType = structType.add(DataTypes.createStructField(headersNoSpaces.get(i), headerDataType, true));
      }
      List<Row> records = rows.stream().map(row -> RowFactory.create(row.toArray(new Comparable[row.size()])))
              .collect(Collectors.toList());
      Dataset<Row> dataset = this.sqlContext.createDataFrame(records, structType);
```

## RuleId[ruleID=OptionalGetWithoutIsPresent]
### OptionalGetWithoutIsPresent
`Optional.get()` without 'isPresent()' check
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/client/common/HoodieJavaEngineContext.java`
#### Snippet
```java
    return data.stream().parallel().map(throwingMapToPairWrapper(mapToPairFunc))
        .collect(Collectors.groupingBy(p -> p.getKey())).values().stream()
        .map(list -> list.stream().map(e -> e.getValue()).reduce(throwingReduceWrapper(reduceFunc)).get())
        .collect(Collectors.toList());
  }
```

### OptionalGetWithoutIsPresent
`Optional.get()` without 'isPresent()' check
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/client/HoodieFlinkWriteClient.java`
#### Snippet
```java
        .collect(Collectors.groupingBy(writeStat -> writeStat.getPartitionPath() + writeStat.getPath()))
        .values().stream()
        .map(duplicates -> duplicates.stream().reduce(WriteStatMerger::merge).get())
        .collect(Collectors.toList());
    return commitStats(instantTime, merged, extraMetadata, commitActionType, partitionToReplacedFileIds, extraPreCommitFunc);
```

### OptionalGetWithoutIsPresent
`Optional.get()` without 'isPresent()' check
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/table/action/deltacommit/SparkUpsertDeltaCommitPartitioner.java`
#### Snippet
```java
        smallFileLocations.add(sf);
      } else {
        HoodieLogFile logFile = smallFileSlice.getLogFiles().findFirst().get();
        sf.location = new HoodieRecordLocation(FSUtils.getBaseCommitTimeFromLogPath(logFile.getPath()),
            FSUtils.getFileIdFromLogPath(logFile.getPath()));
```

### OptionalGetWithoutIsPresent
`Optional.get()` without 'isPresent()' check
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/CompactionAdminClient.java`
#### Snippet
```java
    FileSlice merged =
        fileSystemView.getLatestMergedFileSlicesBeforeOrOn(op.getPartitionPath(), lastInstant.getTimestamp())
            .filter(fs -> fs.getFileId().equals(op.getFileId())).findFirst().get();
    final int maxVersion = op.getDeltaFileNames().stream().map(lf -> FSUtils.getFileVersionFromLog(new Path(lf)))
        .reduce((x, y) -> x > y ? x : y).orElse(0);
```

### OptionalGetWithoutIsPresent
`Optional.get()` without 'isPresent()' check
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/CompactionAdminClient.java`
#### Snippet
```java
    FileSlice merged =
        fileSystemView.getLatestMergedFileSlicesBeforeOrOn(operation.getPartitionPath(), lastInstant.getTimestamp())
            .filter(fs -> fs.getFileId().equals(operation.getFileId())).findFirst().get();
    List<HoodieLogFile> logFilesToRepair =
        merged.getLogFiles().filter(lf -> lf.getBaseCommitTime().equals(compactionInstant))
```

### OptionalGetWithoutIsPresent
`Optional.get()` without 'isPresent()' check
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/CompactionAdminClient.java`
#### Snippet
```java
    FileSlice fileSliceForCompaction =
        fileSystemView.getLatestFileSlicesBeforeOrOn(operation.getPartitionPath(), operation.getBaseInstantTime(), true)
            .filter(fs -> fs.getFileId().equals(operation.getFileId())).findFirst().get();
    int maxUsedVersion = fileSliceForCompaction.getLogFiles().findFirst().map(HoodieLogFile::getLogVersion)
        .orElse(HoodieLogFile.LOGFILE_BASE_VERSION - 1);
```

### OptionalGetWithoutIsPresent
`Optional.get()` without 'isPresent()' check
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/CompactionAdminClient.java`
#### Snippet
```java
        .orElse(HoodieLogFile.DELTA_EXTENSION);
    String parentPath = fileSliceForCompaction.getBaseFile().map(df -> new Path(df.getPath()).getParent().toString())
        .orElse(fileSliceForCompaction.getLogFiles().findFirst().map(lf -> lf.getPath().getParent().toString()).get());
    for (HoodieLogFile toRepair : logFilesToRepair) {
      int version = maxUsedVersion + 1;
```

### OptionalGetWithoutIsPresent
`Optional.get()` without 'isPresent()' check
in `hudi-common/src/main/java/org/apache/hudi/common/util/InternalSchemaCache.java`
#### Snippet
```java
        HISTORICAL_SCHEMA_CACHE.put(tablePath, historicalSchemas);
      } else {
        long maxVersionId = historicalSchemas.keySet().stream().max(Long::compareTo).get();
        if (versionID > maxVersionId) {
          historicalSchemas = getHistoricalSchemas(metaClient);
```

### OptionalGetWithoutIsPresent
`Optional.get()` without 'isPresent()' check
in `hudi-common/src/main/java/org/apache/hudi/common/util/ParquetUtils.java`
#### Snippet
```java
    return blockRanges.stream()
        .sequential()
        .reduce(this::combineRanges).get();
  }

```

### OptionalGetWithoutIsPresent
`Optional.get()` without 'isPresent()' check
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/IncrementalTimelineSyncFileSystemView.java`
#### Snippet
```java
    }

    HoodieTimeline timeline = deltaFileGroups.stream().map(df -> df.getTimeline()).findAny().get();
    List<HoodieFileGroup> fgs =
        buildFileGroups(viewDataFiles.values().stream(), viewLogFiles.values().stream(), timeline, true);
```

### OptionalGetWithoutIsPresent
`Optional.get()` without 'isPresent()' check
in `hudi-common/src/main/java/org/apache/hudi/common/table/timeline/versioning/MetadataMigrator.java`
#### Snippet
```java
    migrators = migratorList.stream().map(m -> Pair.of(m.getManagedVersion(), m))
        .collect(Collectors.toMap(Pair::getKey, Pair::getValue));
    latestVersion = migrators.keySet().stream().reduce((x, y) -> x > y ? x : y).get();
    oldestVersion = migrators.keySet().stream().reduce((x, y) -> x < y ? x : y).get();
  }
```

### OptionalGetWithoutIsPresent
`Optional.get()` without 'isPresent()' check
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/AbstractTableFileSystemView.java`
#### Snippet
```java

  private boolean isFileGroupReplacedBeforeAny(HoodieFileGroupId fileGroupId, List<String> instants) {
    return isFileGroupReplacedBeforeOrOn(fileGroupId, instants.stream().max(Comparator.naturalOrder()).get());
  }

```

### OptionalGetWithoutIsPresent
`Optional.get()` without 'isPresent()' check
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/action/TableChangesHelper.java`
#### Snippet
```java
    if (pchanges != null && !pchanges.isEmpty()) {
      for (TableChange.ColumnPositionChange pchange : pchanges) {
        Types.Field srcField = result.stream().filter(f -> f.fieldId() == pchange.getSrcId()).findFirst().get();
        Types.Field dsrField = result.stream().filter(f -> f.fieldId() == pchange.getDsrId()).findFirst().orElse(null);
        // we remove srcField first
```

### OptionalGetWithoutIsPresent
`Optional.get()` without 'isPresent()' check
in `hudi-common/src/main/java/org/apache/hudi/common/engine/HoodieLocalEngineContext.java`
#### Snippet
```java
    return data.stream().parallel().map(throwingMapToPairWrapper(mapToPairFunc))
        .collect(Collectors.groupingBy(p -> p.getKey())).values().stream()
        .map(list -> list.stream().map(e -> e.getValue()).reduce(throwingReduceWrapper(reduceFunc)).get())
        .collect(Collectors.toList());
  }
```

### OptionalGetWithoutIsPresent
`Optional.get()` without 'isPresent()' check
in `hudi-examples/hudi-examples-flink/src/main/java/org/apache/hudi/examples/quickstart/HoodieFlinkQuickstart.java`
#### Snippet
```java
    // wait to finish
    try {
      tableResult.getJobClient().get().getJobExecutionResult().get();
    } catch (InterruptedException | ExecutionException ex) {
      // ignored
```

### OptionalGetWithoutIsPresent
`Optional.get()` without 'isPresent()' check
in `hudi-examples/hudi-examples-flink/src/main/java/org/apache/hudi/examples/quickstart/HoodieFlinkQuickstart.java`
#### Snippet
```java
      // use the source table schema as the sink schema if the source table was specified, .
      ObjectPath objectPath = new ObjectPath(tEnv.getCurrentDatabase(), sourceTable);
      TableSchema schema = tEnv.getCatalog(tEnv.getCurrentCatalog()).get().getTable(objectPath).getSchema();
      sinkDDL = QuickstartConfigurations.getCollectSinkDDL("sink", schema);
    } else {
```

### OptionalGetWithoutIsPresent
`Optional.get()` without 'isPresent()' check
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/checkpointing/InitialCheckpointFromAnotherHoodieTimelineProvider.java`
#### Snippet
```java
            return null;
          }
        }).filter(Objects::nonNull).findFirst().get();
  }
}
```

### OptionalGetWithoutIsPresent
`Optional.get()` without 'isPresent()' check
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/meta/CkpMetadata.java`
#### Snippet
```java
          }
          return y;
        }).get())
        .sorted().collect(Collectors.toList());
  }
```

### OptionalGetWithoutIsPresent
`Optional.get()` without 'isPresent()' check
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/util/HoodiePipeline.java`
#### Snippet
```java
      String defaultDatabase = null;
      try {
        Catalog catalog = tableEnv.getCatalog(currentCatalog).get();
        defaultDatabase = catalog.getDefaultDatabase();
        catalogTable = (ResolvedCatalogTable) catalog.getTable(new ObjectPath(defaultDatabase, this.tableName));
```

### OptionalGetWithoutIsPresent
`Optional.get()` without 'isPresent()' check
in `hudi-spark-datasource/hudi-spark2/src/main/java/org/apache/hudi/internal/DefaultSource.java`
#### Snippet
```java
  public Optional<DataSourceWriter> createWriter(String writeUUID, StructType schema, SaveMode mode,
      DataSourceOptions options) {
    String instantTime = options.get(DataSourceInternalWriterHelper.INSTANT_TIME_OPT_KEY).get();
    String path = options.get("path").get();
    String tblName = options.get(HoodieWriteConfig.TBL_NAME.key()).get();
```

### OptionalGetWithoutIsPresent
`Optional.get()` without 'isPresent()' check
in `hudi-spark-datasource/hudi-spark2/src/main/java/org/apache/hudi/internal/DefaultSource.java`
#### Snippet
```java
      DataSourceOptions options) {
    String instantTime = options.get(DataSourceInternalWriterHelper.INSTANT_TIME_OPT_KEY).get();
    String path = options.get("path").get();
    String tblName = options.get(HoodieWriteConfig.TBL_NAME.key()).get();
    boolean populateMetaFields = options.getBoolean(HoodieTableConfig.POPULATE_META_FIELDS.key(),
```

### OptionalGetWithoutIsPresent
`Optional.get()` without 'isPresent()' check
in `hudi-spark-datasource/hudi-spark2/src/main/java/org/apache/hudi/internal/DefaultSource.java`
#### Snippet
```java
    String instantTime = options.get(DataSourceInternalWriterHelper.INSTANT_TIME_OPT_KEY).get();
    String path = options.get("path").get();
    String tblName = options.get(HoodieWriteConfig.TBL_NAME.key()).get();
    boolean populateMetaFields = options.getBoolean(HoodieTableConfig.POPULATE_META_FIELDS.key(),
        HoodieTableConfig.POPULATE_META_FIELDS.defaultValue());
```

### OptionalGetWithoutIsPresent
`Optional.get()` without 'isPresent()' check
in `hudi-spark-datasource/hudi-spark2/src/main/java/org/apache/hudi/internal/DefaultSource.java`
#### Snippet
```java
    tryOverrideParquetWriteLegacyFormatProperty(properties, schema);
    // 1st arg to createHoodieConfig is not really required to be set. but passing it anyways.
    HoodieWriteConfig config = DataSourceUtils.createHoodieConfig(options.get(HoodieWriteConfig.AVRO_SCHEMA_STRING.key()).get(), path, tblName, properties);
    boolean arePartitionRecordsSorted = HoodieInternalConfig.getBulkInsertIsPartitionRecordsSorted(
        options.get(HoodieInternalConfig.BULKINSERT_ARE_PARTITIONER_RECORDS_SORTED).isPresent()
```

## RuleId[ruleID=ConstantValue]
### ConstantValue
Value `instantTime` is always 'null'
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/HoodieLogFileCommand.java`
#### Snippet
```java
            instantTime = n.getLogBlockHeader().get(HeaderMetadataType.INSTANT_TIME);
            if (instantTime == null) {
              throw new Exception("Invalid instant time " + instantTime);
            }
          } catch (Exception e) {
```

### ConstantValue
Condition `rolloverPaths == null` is always `true`
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/io/FlinkMergeHandle.java`
#### Snippet
```java
                          TaskContextSupplier taskContextSupplier) {
    super(config, instantTime, hoodieTable, recordItr, partitionPath, fileId, taskContextSupplier, Option.empty());
    if (rolloverPaths == null) {
      // #makeOldAndNewFilePaths may already initialize it already
      rolloverPaths = new ArrayList<>();
```

### ConstantValue
Value `legacyMode` is always 'true'
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/io/storage/row/parquet/ParquetSchemaConverter.java`
#### Snippet
```java
                        basicArrayType.getComponentInfo(),
                        Type.Repetition.REQUIRED,
                        legacyMode))
                .named(LIST_GROUP_NAME);

```

### ConstantValue
Value `legacyMode` is always 'false'
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/io/storage/row/parquet/ParquetSchemaConverter.java`
#### Snippet
```java
                basicArrayType.getComponentInfo(),
                Type.Repetition.REQUIRED,
                legacyMode)
                .asPrimitiveType();
        fieldType =
```

### ConstantValue
Condition `enableBloomFilter` is always `false`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/io/storage/HoodieSparkFileWriterFactory.java`
#### Snippet
```java
      FSDataOutputStream outputStream, Configuration conf, HoodieConfig config, Schema schema) throws IOException {
    boolean enableBloomFilter = false;
    Option<BloomFilter> filter = enableBloomFilter ? Option.of(createBloomFilter(config)) : Option.empty();
    HoodieRowParquetWriteSupport writeSupport = new HoodieRowParquetWriteSupport(conf,
        HoodieInternalRowUtils.getCachedSchema(schema), filter,
```

### ConstantValue
Result of `keys.size()` is always '0'
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/index/hbase/SparkHoodieHBaseIndex.java`
#### Snippet
```java
      return hTable.get(keys);
    }
    return new Result[keys.size()];
  }

```

### ConstantValue
Condition `oldV != null` is always `true`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/utils/SparkInternalSchemaConverter.java`
#### Snippet
```java
    DataType oldType = oldV.dataType();  // old colType eg: floatType
    DataType newType = newV.dataType();  // new colType eg: doubleType
    if (oldV != null && newType != null) {
      if (oldType instanceof BooleanType) {
        return false;
```

### ConstantValue
Condition `newType instanceof DecimalType` is always `true`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/utils/SparkInternalSchemaConverter.java`
#### Snippet
```java
        } else if (newType instanceof StringType) {
          newV.putByteArray(i, ((isInt ? oldV.getInt(i) : oldV.getLong(i)) + "").getBytes(StandardCharsets.UTF_8));
        } else if (newType instanceof DecimalType) {
          Decimal oldDecimal = Decimal.apply(isInt ? oldV.getInt(i) : oldV.getLong(i));
          oldDecimal.changePrecision(((DecimalType) newType).precision(), ((DecimalType) newType).scale());
```

### ConstantValue
Condition `newType instanceof DecimalType` is always `true`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/utils/SparkInternalSchemaConverter.java`
#### Snippet
```java
          int days = org.apache.spark.sql.catalyst.util.DateTimeUtils.fromJavaDate(Date.valueOf(oldV.getUTF8String(i).toString()));
          newV.putInt(i, days);
        } else if (newType instanceof DecimalType) {
          DecimalType decimalType = (DecimalType) newType;
          java.math.BigDecimal bigDecimal = new java.math.BigDecimal(oldV.getUTF8String(i).toString().trim());
```

### ConstantValue
Condition `newType instanceof DecimalType` is always `true`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/utils/SparkInternalSchemaConverter.java`
#### Snippet
```java
        } else if (newType instanceof StringType) {
          newV.putByteArray(i, (oldV.getFloat(i) + "").getBytes(StandardCharsets.UTF_8));
        } else if (newType instanceof DecimalType) {
          Decimal oldDecimal = Decimal.apply(oldV.getFloat(i));
          oldDecimal.changePrecision(((DecimalType) newType).precision(), ((DecimalType) newType).scale());
```

### ConstantValue
Condition `newType instanceof StringType` is always `true`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/utils/SparkInternalSchemaConverter.java`
#### Snippet
```java
          oldDecimal.changePrecision(((DecimalType) newType).precision(), ((DecimalType) newType).scale());
          newV.putDecimal(i, oldDecimal, ((DecimalType) newType).precision());
        } else if (newType instanceof StringType) {
          newV.putByteArray(i, oldDecimal.toString().getBytes(StandardCharsets.UTF_8));
        }
```

### ConstantValue
Condition `newType instanceof StringType` is always `true`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/utils/SparkInternalSchemaConverter.java`
#### Snippet
```java
          oldDecimal.changePrecision(((DecimalType) newType).precision(), ((DecimalType) newType).scale());
          newV.putDecimal(i, oldDecimal, ((DecimalType) newType).precision());
        } else if (newType instanceof StringType) {
          newV.putByteArray(i, (oldV.getDouble(i) + "").getBytes(StandardCharsets.UTF_8));
        }
```

### ConstantValue
Condition `enableBloomFilter` is always `false`
in `hudi-common/src/main/java/org/apache/hudi/io/storage/HoodieAvroFileWriterFactory.java`
#### Snippet
```java
      FSDataOutputStream outputStream, Configuration conf, HoodieConfig config, Schema schema) throws IOException {
    boolean enableBloomFilter = false;
    Option<BloomFilter> filter = enableBloomFilter ? Option.of(createBloomFilter(config)) : Option.empty();
    HoodieAvroWriteSupport writeSupport = new HoodieAvroWriteSupport(new AvroSchemaConverter(conf).convert(schema), schema, filter);
    HoodieParquetConfig<HoodieAvroWriteSupport> parquetConfig = new HoodieParquetConfig<>(writeSupport,
```

### ConstantValue
Condition `actionMetadata.get() instanceof HoodieRestoreMetadata` is always `false`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metadata/HoodieBackedTableMetadataWriter.java`
#### Snippet
```java
    final String INSTANT_ACTION = (actionMetadata.get() instanceof HoodieRollbackMetadata
        ? HoodieTimeline.ROLLBACK_ACTION
        : (actionMetadata.get() instanceof HoodieRestoreMetadata ? HoodieTimeline.RESTORE_ACTION : EMPTY_STRING));

    List<String> affectedInstantTimestamps;
```

### ConstantValue
Result of `actionMetadata.get()` is always 'null'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metadata/HoodieBackedTableMetadataWriter.java`
#### Snippet
```java
    final String INSTANT_ACTION = (actionMetadata.get() instanceof HoodieRollbackMetadata
        ? HoodieTimeline.ROLLBACK_ACTION
        : (actionMetadata.get() instanceof HoodieRestoreMetadata ? HoodieTimeline.RESTORE_ACTION : EMPTY_STRING));

    List<String> affectedInstantTimestamps;
```

### ConstantValue
Condition `c >= 0` is always `true`
in `hudi-common/src/main/java/org/apache/hudi/common/util/PartitionPathEncodeUtils.java`
#### Snippet
```java

  static boolean needsEscaping(char c) {
    return c >= 0 && c < charToEscape.size() && charToEscape.get(c);
  }

```

### ConstantValue
Condition `value == null` is always `false`
in `hudi-common/src/main/java/org/apache/hudi/common/util/AvroOrcUtils.java`
#### Snippet
```java
          throw new IllegalStateException(String.format(
              "Failed to add value %s to union with type %s",
              value == null ? "null" : value.toString(),
              type.toString()
          ));
```

### ConstantValue
Condition `stringType == null || !stringType.equals(StringType.String)` is always `true`
in `hudi-common/src/main/java/org/apache/hudi/common/util/AvroOrcUtils.java`
#### Snippet
```java
      case STRING:
        String stringType = avroSchema.getProp(GenericData.STRING_PROP);
        if (stringType == null || !stringType.equals(StringType.String)) {
          int stringLength = ((BytesColumnVector) colVector).length[vectorPos];
          int stringOffset = ((BytesColumnVector) colVector).start[vectorPos];
```

### ConstantValue
Condition `!stringType.equals(StringType.String)` is always `true` when reached
in `hudi-common/src/main/java/org/apache/hudi/common/util/AvroOrcUtils.java`
#### Snippet
```java
      case STRING:
        String stringType = avroSchema.getProp(GenericData.STRING_PROP);
        if (stringType == null || !stringType.equals(StringType.String)) {
          int stringLength = ((BytesColumnVector) colVector).length[vectorPos];
          int stringOffset = ((BytesColumnVector) colVector).start[vectorPos];
```

### ConstantValue
Result of `stringType.equals(StringType.String)` is always 'false'
in `hudi-common/src/main/java/org/apache/hudi/common/util/AvroOrcUtils.java`
#### Snippet
```java
      case STRING:
        String stringType = avroSchema.getProp(GenericData.STRING_PROP);
        if (stringType == null || !stringType.equals(StringType.String)) {
          int stringLength = ((BytesColumnVector) colVector).length[vectorPos];
          int stringOffset = ((BytesColumnVector) colVector).start[vectorPos];
```

### ConstantValue
Condition `value == null && matchValue != null` is always `false`
in `hudi-common/src/main/java/org/apache/hudi/common/util/AvroOrcUtils.java`
#### Snippet
```java
    }

    if (value == null && matchValue != null) {
      value = matchValue;
    }
```

### ConstantValue
Condition `matchValue != null` is always `false` when reached
in `hudi-common/src/main/java/org/apache/hudi/common/util/AvroOrcUtils.java`
#### Snippet
```java
    }

    if (value == null && matchValue != null) {
      value = matchValue;
    }
```

### ConstantValue
Condition `statValueWrapper instanceof DecimalWrapper` is always `false`
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieMetadataPayload.java`
#### Snippet
```java
    } else if (statValueWrapper instanceof DateWrapper) {
      return LocalDate.ofEpochDay(((DateWrapper) statValueWrapper).getValue());
    } else if (statValueWrapper instanceof DecimalWrapper) {
      Schema valueSchema = DecimalWrapper.SCHEMA$.getField("value").schema();
      return AVRO_DECIMAL_CONVERSION.fromBytes(((DecimalWrapper) statValueWrapper).getValue(), valueSchema, valueSchema.getLogicalType());
```

### ConstantValue
Condition `statValueWrapper instanceof TimestampMicrosWrapper` is always `false`
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieMetadataPayload.java`
#### Snippet
```java
      Schema valueSchema = DecimalWrapper.SCHEMA$.getField("value").schema();
      return AVRO_DECIMAL_CONVERSION.fromBytes(((DecimalWrapper) statValueWrapper).getValue(), valueSchema, valueSchema.getLogicalType());
    } else if (statValueWrapper instanceof TimestampMicrosWrapper) {
      return microsToInstant(((TimestampMicrosWrapper) statValueWrapper).getValue());
    } else if (statValueWrapper instanceof BooleanWrapper) {
```

### ConstantValue
Condition `statValueWrapper instanceof BooleanWrapper` is always `false`
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieMetadataPayload.java`
#### Snippet
```java
    } else if (statValueWrapper instanceof TimestampMicrosWrapper) {
      return microsToInstant(((TimestampMicrosWrapper) statValueWrapper).getValue());
    } else if (statValueWrapper instanceof BooleanWrapper) {
      return ((BooleanWrapper) statValueWrapper).getValue();
    } else if (statValueWrapper instanceof IntWrapper) {
```

### ConstantValue
Condition `statValueWrapper instanceof IntWrapper` is always `false`
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieMetadataPayload.java`
#### Snippet
```java
    } else if (statValueWrapper instanceof BooleanWrapper) {
      return ((BooleanWrapper) statValueWrapper).getValue();
    } else if (statValueWrapper instanceof IntWrapper) {
      return ((IntWrapper) statValueWrapper).getValue();
    } else if (statValueWrapper instanceof LongWrapper) {
```

### ConstantValue
Condition `statValueWrapper instanceof LongWrapper` is always `false`
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieMetadataPayload.java`
#### Snippet
```java
    } else if (statValueWrapper instanceof IntWrapper) {
      return ((IntWrapper) statValueWrapper).getValue();
    } else if (statValueWrapper instanceof LongWrapper) {
      return ((LongWrapper) statValueWrapper).getValue();
    } else if (statValueWrapper instanceof FloatWrapper) {
```

### ConstantValue
Condition `statValueWrapper instanceof FloatWrapper` is always `false`
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieMetadataPayload.java`
#### Snippet
```java
    } else if (statValueWrapper instanceof LongWrapper) {
      return ((LongWrapper) statValueWrapper).getValue();
    } else if (statValueWrapper instanceof FloatWrapper) {
      return ((FloatWrapper) statValueWrapper).getValue();
    } else if (statValueWrapper instanceof DoubleWrapper) {
```

### ConstantValue
Condition `statValueWrapper instanceof DoubleWrapper` is always `false`
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieMetadataPayload.java`
#### Snippet
```java
    } else if (statValueWrapper instanceof FloatWrapper) {
      return ((FloatWrapper) statValueWrapper).getValue();
    } else if (statValueWrapper instanceof DoubleWrapper) {
      return ((DoubleWrapper) statValueWrapper).getValue();
    } else if (statValueWrapper instanceof BytesWrapper) {
```

### ConstantValue
Condition `statValueWrapper instanceof BytesWrapper` is always `false`
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieMetadataPayload.java`
#### Snippet
```java
    } else if (statValueWrapper instanceof DoubleWrapper) {
      return ((DoubleWrapper) statValueWrapper).getValue();
    } else if (statValueWrapper instanceof BytesWrapper) {
      return ((BytesWrapper) statValueWrapper).getValue();
    } else if (statValueWrapper instanceof StringWrapper) {
```

### ConstantValue
Condition `statValueWrapper instanceof StringWrapper` is always `false`
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieMetadataPayload.java`
#### Snippet
```java
    } else if (statValueWrapper instanceof BytesWrapper) {
      return ((BytesWrapper) statValueWrapper).getValue();
    } else if (statValueWrapper instanceof StringWrapper) {
      return ((StringWrapper) statValueWrapper).getValue();
    } else if (statValueWrapper instanceof GenericRecord) {
```

### ConstantValue
Condition `statValueWrapper instanceof GenericRecord` is always `false`
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieMetadataPayload.java`
#### Snippet
```java
    } else if (statValueWrapper instanceof StringWrapper) {
      return ((StringWrapper) statValueWrapper).getValue();
    } else if (statValueWrapper instanceof GenericRecord) {
      // NOTE: This branch could be hit b/c Avro records could be reconstructed
      //       as {@code GenericRecord)
```

### ConstantValue
Condition `result == null` is always `false`
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/utils/HoodieHiveUtils.java`
#### Snippet
```java
      return null;
    }).filter(Objects::nonNull).collect(Collectors.toList());
    if (result == null) {
      // Returns an empty list instead of null.
      result = new ArrayList<>();
```

### ConstantValue
Value `realtime` is always 'true'
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/utils/HoodieInputFormatUtils.java`
#### Snippet
```java
    // now we support read log file, try to find log file
    if (FSUtils.isLogFile(new Path(path)) && realtime) {
      return getInputFormat(HoodieFileFormat.PARQUET, realtime, conf);
    }
    throw new HoodieIOException("Hoodie InputFormat not implemented for base file of type " + extension);
```

### ConstantValue
Condition `danglingFilePaths.size() > 0` is always `true` when reached
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDataTableValidator.java`
#### Snippet
```java
        }).collect(Collectors.toList());

        if (!danglingFilePaths.isEmpty() && danglingFilePaths.size() > 0) {
          LOG.error("Data table validation failed due to dangling files count " + danglingFilePaths.size() + ", found before active timeline");
          danglingFilePaths.forEach(entry -> LOG.error("Dangling file: " + entry.toString()));
```

### ConstantValue
Condition `hasErrors` is always `true`
in `hudi-kafka-connect/src/main/java/org/apache/hudi/connect/transaction/ConnectTransactionCoordinator.java`
#### Snippet
```java
            LOG.error("Commit " + currentCommitTime + " failed!");
          }
        } else if (hasErrors) {
          LOG.error("Coordinator found errors when writing. Errors/Total=" + totalErrorRecords + "/" + totalRecords);
          LOG.error("Printing out the top 100 errors");
```

## RuleId[ruleID=MethodOverridesStaticMethod]
### MethodOverridesStaticMethod
Method `main()` tries to override a static method of a superclass
in `hudi-aws/src/main/java/org/apache/hudi/aws/sync/AwsGlueCatalogSyncTool.java`
#### Snippet
```java
  }

  public static void main(String[] args) {
    final HiveSyncConfig.HiveSyncConfigParams params = new HiveSyncConfig.HiveSyncConfigParams();
    JCommander cmd = JCommander.newBuilder().addObject(params).build();
```

### MethodOverridesStaticMethod
Method `of()` tries to override a static method of a superclass
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/ImmutablePair.java`
#### Snippet
```java
   * @return a pair formed from the two parameters, not null
   */
  public static <L, R> ImmutablePair<L, R> of(final L left, final R right) {
    return new ImmutablePair<L, R>(left, right);
  }
```

### MethodOverridesStaticMethod
Method `of()` tries to override a static method of a superclass
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/ImmutableTriple.java`
#### Snippet
```java
   * @return a triple formed from the three parameters, not null
   */
  public static <L, M, R> ImmutableTriple<L, M, R> of(final L left, final M middle, final R right) {
    return new ImmutableTriple<L, M, R>(left, middle, right);
  }
```

### MethodOverridesStaticMethod
Method `fromBytes()` tries to override a static method of a superclass
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieReplaceCommitMetadata.java`
#### Snippet
```java
  }

  public static <T> T fromBytes(byte[] bytes, Class<T> clazz) throws IOException {
    try {
      return fromJsonString(new String(bytes, StandardCharsets.UTF_8), clazz);
```

### MethodOverridesStaticMethod
Method `fromJsonString()` tries to override a static method of a superclass
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieReplaceCommitMetadata.java`
#### Snippet
```java
  }

  public static <T> T fromJsonString(String jsonStr, Class<T> clazz) throws Exception {
    if (jsonStr == null || jsonStr.isEmpty()) {
      // For empty commit file (no data or somethings bad happen).
```

### MethodOverridesStaticMethod
Method `getPathWithoutSchemeAndAuthority()` tries to override a static method of a superclass
in `hudi-common/src/main/java/org/apache/hudi/hadoop/CachingPath.java`
#### Snippet
```java
   * {@link CachingPath}
   */
  public static Path getPathWithoutSchemeAndAuthority(Path path) {
    // This code depends on Path.toString() to remove the leading slash before
    // the drive specification on Windows.
```

### MethodOverridesStaticMethod
Method `builder()` tries to override a static method of a superclass
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/cdc/CdcInputFormat.java`
#### Snippet
```java
   * Returns the builder for {@link MergeOnReadInputFormat}.
   */
  public static Builder builder() {
    return new Builder();
  }
```

## RuleId[ruleID=StringConcatenationInsideStringBufferAppend]
### StringConcatenationInsideStringBufferAppend
String concatenation as argument to `StringBuilder.append()` call
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/util/HiveSchemaUtil.java`
#### Snippet
```java
    }
    if (config.getString(HIVE_SYNC_BUCKET_SYNC_SPEC) != null) {
      sb.append(' ' + config.getString(HIVE_SYNC_BUCKET_SYNC_SPEC) + ' ');
    }
    sb.append(" ROW FORMAT SERDE '").append(serdeClass).append("'");
```

### StringConcatenationInsideStringBufferAppend
String concatenation as argument to `StringBuilder.append()` call
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/index/bloom/BucketizedBloomCheckPartitioner.java`
#### Snippet
```java
      StringBuilder str = new StringBuilder();
      for (int i = 0; i < bucketsFilled.length; i++) {
        str.append("p" + i + " : " + bucketsFilled[i] + ",");
      }
      LOG.debug("Num buckets assigned per file group :" + str);
```

### StringConcatenationInsideStringBufferAppend
String concatenation as argument to `StringBuilder.append()` call
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/keygen/KeyGenUtils.java`
#### Snippet
```java
      String recordKeyValue = HoodieAvroUtils.getNestedFieldValAsString(record, recordKeyField, true, consistentLogicalTimestampEnabled);
      if (recordKeyValue == null) {
        recordKey.append(recordKeyField + DEFAULT_COMPOSITE_KEY_FILED_VALUE + NULL_RECORDKEY_PLACEHOLDER + DEFAULT_RECORD_KEY_PARTS_SEPARATOR);
      } else if (recordKeyValue.isEmpty()) {
        recordKey.append(recordKeyField + DEFAULT_COMPOSITE_KEY_FILED_VALUE + EMPTY_RECORDKEY_PLACEHOLDER + DEFAULT_RECORD_KEY_PARTS_SEPARATOR);
```

### StringConcatenationInsideStringBufferAppend
String concatenation as argument to `StringBuilder.append()` call
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/keygen/KeyGenUtils.java`
#### Snippet
```java
        recordKey.append(recordKeyField + DEFAULT_COMPOSITE_KEY_FILED_VALUE + NULL_RECORDKEY_PLACEHOLDER + DEFAULT_RECORD_KEY_PARTS_SEPARATOR);
      } else if (recordKeyValue.isEmpty()) {
        recordKey.append(recordKeyField + DEFAULT_COMPOSITE_KEY_FILED_VALUE + EMPTY_RECORDKEY_PLACEHOLDER + DEFAULT_RECORD_KEY_PARTS_SEPARATOR);
      } else {
        recordKey.append(recordKeyField + DEFAULT_COMPOSITE_KEY_FILED_VALUE + recordKeyValue + DEFAULT_RECORD_KEY_PARTS_SEPARATOR);
```

### StringConcatenationInsideStringBufferAppend
String concatenation as argument to `StringBuilder.append()` call
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/keygen/KeyGenUtils.java`
#### Snippet
```java
        recordKey.append(recordKeyField + DEFAULT_COMPOSITE_KEY_FILED_VALUE + EMPTY_RECORDKEY_PLACEHOLDER + DEFAULT_RECORD_KEY_PARTS_SEPARATOR);
      } else {
        recordKey.append(recordKeyField + DEFAULT_COMPOSITE_KEY_FILED_VALUE + recordKeyValue + DEFAULT_RECORD_KEY_PARTS_SEPARATOR);
        keyIsNullEmpty = false;
      }
```

### StringConcatenationInsideStringBufferAppend
String concatenation as argument to `StringBuilder.append()` call
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/utils/HoodieRealtimeRecordReaderUtils.java`
#### Snippet
```java
    StringBuilder builder = new StringBuilder();
    Writable[] values = writable.get();
    builder.append("\"values_" + random.nextDouble() + "_" + values.length + "\": {");
    int i = 0;
    for (Writable w : values) {
```

### StringConcatenationInsideStringBufferAppend
String concatenation as argument to `StringBuilder.append()` call
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/utils/HoodieRealtimeRecordReaderUtils.java`
#### Snippet
```java
        builder.append(arrayWritableToString((ArrayWritable) w)).append(",");
      } else {
        builder.append("\"value" + i + "\":\"" + w + "\"").append(",");
        if (w == null) {
          builder.append("\"type" + i + "\":\"unknown\"").append(",");
```

### StringConcatenationInsideStringBufferAppend
String concatenation as argument to `StringBuilder.append()` call
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/utils/HoodieRealtimeRecordReaderUtils.java`
#### Snippet
```java
        builder.append("\"value" + i + "\":\"" + w + "\"").append(",");
        if (w == null) {
          builder.append("\"type" + i + "\":\"unknown\"").append(",");
        } else {
          builder.append("\"type" + i + "\":\"" + w.getClass().getSimpleName() + "\"").append(",");
```

### StringConcatenationInsideStringBufferAppend
String concatenation as argument to `StringBuilder.append()` call
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/utils/HoodieRealtimeRecordReaderUtils.java`
#### Snippet
```java
          builder.append("\"type" + i + "\":\"unknown\"").append(",");
        } else {
          builder.append("\"type" + i + "\":\"" + w.getClass().getSimpleName() + "\"").append(",");
        }
      }
```

### StringConcatenationInsideStringBufferAppend
String concatenation as argument to `StringBuilder.append()` call
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/hive/HoodieCombineHiveInputFormat.java`
#### Snippet
```java
      s.append("PathFilter: ");
      for (String pString : pStrings) {
        s.append(pString + " ");
      }
      return s.toString();
```

### StringConcatenationInsideStringBufferAppend
String concatenation as argument to `StringBuilder.append()` call
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/hive/HoodieCombineHiveInputFormat.java`
#### Snippet
```java
      StringBuilder sb = new StringBuilder();
      sb.append(inputSplitShim.toString());
      sb.append("InputFormatClass: " + inputFormatClassName);
      sb.append("\n");
      return sb.toString();
```

### StringConcatenationInsideStringBufferAppend
String concatenation as argument to `StringBuilder.append()` call
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/helpers/gcs/FilePathsFetcher.java`
#### Snippet
```java
    StringBuilder filter = new StringBuilder("size > 0");

    getPropVal(SELECT_RELATIVE_PATH_PREFIX).ifPresent(val -> filter.append(" and name like '" + val + "%'"));
    getPropVal(IGNORE_RELATIVE_PATH_PREFIX).ifPresent(val -> filter.append(" and name not like '" + val + "%'"));
    getPropVal(IGNORE_RELATIVE_PATH_SUBSTR).ifPresent(val -> filter.append(" and name not like '%" + val + "%'"));
```

### StringConcatenationInsideStringBufferAppend
String concatenation as argument to `StringBuilder.append()` call
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/helpers/gcs/FilePathsFetcher.java`
#### Snippet
```java

    getPropVal(SELECT_RELATIVE_PATH_PREFIX).ifPresent(val -> filter.append(" and name like '" + val + "%'"));
    getPropVal(IGNORE_RELATIVE_PATH_PREFIX).ifPresent(val -> filter.append(" and name not like '" + val + "%'"));
    getPropVal(IGNORE_RELATIVE_PATH_SUBSTR).ifPresent(val -> filter.append(" and name not like '%" + val + "%'"));

```

### StringConcatenationInsideStringBufferAppend
String concatenation as argument to `StringBuilder.append()` call
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/helpers/gcs/FilePathsFetcher.java`
#### Snippet
```java
    getPropVal(SELECT_RELATIVE_PATH_PREFIX).ifPresent(val -> filter.append(" and name like '" + val + "%'"));
    getPropVal(IGNORE_RELATIVE_PATH_PREFIX).ifPresent(val -> filter.append(" and name not like '" + val + "%'"));
    getPropVal(IGNORE_RELATIVE_PATH_SUBSTR).ifPresent(val -> filter.append(" and name not like '%" + val + "%'"));

    // Match files with a given extension, or use the fileFormat as the default.
```

### StringConcatenationInsideStringBufferAppend
String concatenation as argument to `StringBuilder.append()` call
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/helpers/gcs/FilePathsFetcher.java`
#### Snippet
```java
    // Match files with a given extension, or use the fileFormat as the default.
    getPropVal(CLOUD_DATAFILE_EXTENSION).or(() -> Option.of(fileFormat))
            .map(val -> filter.append(" and name like '%" + val + "'"));

    return filter.toString();
```

### StringConcatenationInsideStringBufferAppend
String concatenation as argument to `StringBuilder.append()` call
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/helpers/KafkaOffsetGen.java`
#### Snippet
```java

    StringBuilder sb = new StringBuilder();
    sb.append(topicName + ",");
    for (Map.Entry<TopicPartition, OffsetAndTimestamp> map : offsetAndTimestamp.entrySet()) {
      if (map.getValue() != null) {
```

### StringConcatenationInsideStringBufferAppend
String concatenation as argument to `StringBuilder.append()` call
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/helpers/KafkaOffsetGen.java`
#### Snippet
```java
      StringBuilder sb = new StringBuilder();
      // at least 1 partition will be present.
      sb.append(ranges[0].topic() + ",");
      sb.append(Arrays.stream(ranges).map(r -> String.format("%s:%d", r.partition(), r.untilOffset()))
              .collect(Collectors.joining(",")));
```

### StringConcatenationInsideStringBufferAppend
String concatenation as argument to `StringBuffer.append()` call
in `hudi-spark-datasource/hudi-spark/src/main/java/org/apache/hudi/QuickstartUtils.java`
#### Snippet
```java
    StringBuffer stringBuffer = new StringBuffer();
    stringBuffer.append("{");
    stringBuffer.append("\"ts\": \"" + (ts == null ? "0.0" : ts) + "\",");
    stringBuffer.append("\"uuid\": \"" + uuid + "\",");
    stringBuffer.append("\"partitionpath\": \"" + partitionPath + "\"");
```

### StringConcatenationInsideStringBufferAppend
String concatenation as argument to `StringBuffer.append()` call
in `hudi-spark-datasource/hudi-spark/src/main/java/org/apache/hudi/QuickstartUtils.java`
#### Snippet
```java
    stringBuffer.append("{");
    stringBuffer.append("\"ts\": \"" + (ts == null ? "0.0" : ts) + "\",");
    stringBuffer.append("\"uuid\": \"" + uuid + "\",");
    stringBuffer.append("\"partitionpath\": \"" + partitionPath + "\"");
    stringBuffer.append("}");
```

### StringConcatenationInsideStringBufferAppend
String concatenation as argument to `StringBuffer.append()` call
in `hudi-spark-datasource/hudi-spark/src/main/java/org/apache/hudi/QuickstartUtils.java`
#### Snippet
```java
    stringBuffer.append("\"ts\": \"" + (ts == null ? "0.0" : ts) + "\",");
    stringBuffer.append("\"uuid\": \"" + uuid + "\",");
    stringBuffer.append("\"partitionpath\": \"" + partitionPath + "\"");
    stringBuffer.append("}");
    return Option.of(stringBuffer.toString());
```

## RuleId[ruleID=IOResource]
### IOResource
'BufferedReader' should be opened in front of a 'try' block and closed in the corresponding 'finally' block
in `hudi-cli/src/main/java/org/apache/hudi/cli/utils/InputStreamConsumer.java`
#### Snippet
```java
    try {
      InputStreamReader isr = new InputStreamReader(is);
      BufferedReader br = new BufferedReader(isr);
      br.lines().forEach(LOG::info);
    } catch (Exception e) {
```

### IOResource
'FSDataOutputStream' should be opened in front of a 'try' block and closed in the corresponding 'finally' block
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/HoodieLogFormatWriter.java`
#### Snippet
```java
    long sizeWritten = 0;
    // HUDI-2655. here we wrap originalOutputStream to ensure huge blocks can be correctly written
    FSDataOutputStream outputStream = new FSDataOutputStream(originalOutputStream, new FileSystem.Statistics(fs.getScheme()), startPos);
    for (HoodieLogBlock block: blocks) {
      long startSize = outputStream.size();
```

### IOResource
'DataOutputStream' should be opened in front of a 'try' block and closed in the corresponding 'finally' block
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/block/HoodieLogBlock.java`
#### Snippet
```java
  public static byte[] getLogMetadataBytes(Map<HeaderMetadataType, String> metadata) throws IOException {
    ByteArrayOutputStream baos = new ByteArrayOutputStream();
    DataOutputStream output = new DataOutputStream(baos);
    output.writeInt(metadata.size());
    for (Map.Entry<HeaderMetadataType, String> entry : metadata.entrySet()) {
```

### IOResource
'InflaterInputStream' should be opened in front of a 'try' block and closed in the corresponding 'finally' block
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/block/HoodieAvroDataBlock.java`
#### Snippet
```java

  private static String decompress(byte[] bytes) {
    InputStream in = new InflaterInputStream(new ByteArrayInputStream(bytes));
    ByteArrayOutputStream baos = new ByteArrayOutputStream();
    try {
```

### IOResource
'DataOutputStream' should be opened in front of a 'try' block and closed in the corresponding 'finally' block
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/block/HoodieDeleteBlock.java`
#### Snippet
```java

    ByteArrayOutputStream baos = new ByteArrayOutputStream();
    DataOutputStream output = new DataOutputStream(baos);
    // TODO(HUDI-5760) avoid using Kryo for serialization here
    byte[] bytesToWrite = SerializationUtils.serialize(getRecordsToDelete());
```

### IOResource
'DataFileWriter' should be opened in front of a 'try' block and closed in the corresponding 'finally' block
in `hudi-common/src/main/java/org/apache/hudi/common/table/timeline/TimelineMetadataUtils.java`
#### Snippet
```java
      throws IOException {
    DatumWriter<T> datumWriter = new SpecificDatumWriter<>(clazz);
    DataFileWriter<T> fileWriter = new DataFileWriter<>(datumWriter);
    ByteArrayOutputStream baos = new ByteArrayOutputStream();
    fileWriter.create(metadata.getSchema(), baos);
```

### IOResource
'Scanner' should be opened in front of a 'try' block and closed in the corresponding 'finally' block
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HiveIncrementalPuller.java`
#### Snippet
```java

    incrementalPullSQLTemplate.add("storedAsClause", storedAsClause);
    String incrementalSQL = new Scanner(new File(config.incrementalSQLFile)).useDelimiter("\\Z").next();
    if (!incrementalSQL.contains(config.sourceDb + "." + config.sourceTable)) {
      LOG.error("Incremental SQL does not have " + config.sourceDb + "." + config.sourceTable
```

## RuleId[ruleID=RedundantOperationOnEmptyContainer]
### RedundantOperationOnEmptyContainer
Collection `newRecordKeysSorted` is always empty
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/io/HoodieSortedMergeHandle.java`
#### Snippet
```java
    }

    newRecordKeysSorted.clear();

    return super.close();
```

## RuleId[ruleID=FieldMayBeStatic]
### FieldMayBeStatic
Field `keepLastNtimes` may be 'static'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/transaction/lock/metrics/HoodieLockMetrics.java`
#### Snippet
```java
  private final HoodieWriteConfig writeConfig;
  private final boolean isMetricsEnabled;
  private final int keepLastNtimes = 100;
  private final transient HoodieTimer lockDurationTimer = HoodieTimer.create();
  private final transient HoodieTimer lockApiRequestDurationTimer = HoodieTimer.create();
```

### FieldMayBeStatic
Field `sizingFactorForInMemoryMap` may be 'static'
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/ExternalSpillableMap.java`
#### Snippet
```java
  // TODO(na) : a dynamic sizing factor to ensure we have space for other objects in memory and
  // incorrect payload estimation
  private final Double sizingFactorForInMemoryMap = 0.8;
  // Size Estimator for key type
  private final SizeEstimator<T> keySizeEstimator;
```

### FieldMayBeStatic
Field `generateUniqueSeqUdfFn` may be 'static'
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/debezium/MysqlDebeziumSource.java`
#### Snippet
```java

  private final SQLContext sqlContext;
  private final String generateUniqueSeqUdfFn = "mysql_generate_order_key";

  public MysqlDebeziumSource(TypedProperties props, JavaSparkContext sparkContext,
```

## RuleId[ruleID=Java8MapForEach]
### Java8MapForEach
Can be replaced with 'Map.forEach()'
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/TableCommand.java`
#### Snippet
```java
    rows.add(new Comparable[] {"metaPath", client.getMetaPath()});
    rows.add(new Comparable[] {"fileSystem", client.getFs().getScheme()});
    client.getTableConfig().propsMap().entrySet().forEach(e -> {
      rows.add(new Comparable[] {e.getKey(), e.getValue()});
    });
```

### Java8MapForEach
Can be replaced with 'Map.forEach()'
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/IncrementalTimelineSyncFileSystemView.java`
#### Snippet
```java
      return Pair.of(compactionInstantTime, fileGroup);
    }).collect(Collectors.groupingBy(x -> x.getValue().getPartitionPath()));
    partitionToFileGroups.entrySet().forEach(entry -> {
      if (isPartitionAvailableInStore(entry.getKey())) {
        applyDeltaFileSlicesToPartitionView(entry.getKey(),
```

### Java8MapForEach
Can be replaced with 'Map.forEach()'
in `hudi-spark-datasource/hudi-spark-common/src/main/java/org/apache/hudi/DataSourceUtils.java`
#### Snippet
```java
    Map<String, String> extraMetadataMap = new HashMap<>();
    if (properties.containsKey(DataSourceWriteOptions.COMMIT_METADATA_KEYPREFIX().key())) {
      properties.entrySet().forEach(entry -> {
        if (entry.getKey().startsWith(properties.get(DataSourceWriteOptions.COMMIT_METADATA_KEYPREFIX().key()))) {
          extraMetadataMap.put(entry.getKey(), entry.getValue());
```

## RuleId[ruleID=UtilityClassWithoutPrivateConstructor]
### UtilityClassWithoutPrivateConstructor
Class `S3Utils` has only 'static' members, and lacks a 'private' constructor
in `hudi-aws/src/main/java/org/apache/hudi/aws/utils/S3Utils.java`
#### Snippet
```java
package org.apache.hudi.aws.utils;

public final class S3Utils {

  public static String s3aToS3(String s3aUrl) {
```

### UtilityClassWithoutPrivateConstructor
Class `HoodieAWSCredentialsProviderFactory` has only 'static' members, and lacks a 'private' constructor
in `hudi-aws/src/main/java/org/apache/hudi/aws/credentials/HoodieAWSCredentialsProviderFactory.java`
#### Snippet
```java
 * Factory class for Hoodie AWSCredentialsProvider.
 */
public class HoodieAWSCredentialsProviderFactory {
  public static AWSCredentialsProvider getAwsCredentialsProvider(Properties props) {
    return getAwsCredentialsProviderChain(props);
```

### UtilityClassWithoutPrivateConstructor
Class `HoodieCliSparkConfig` has only 'static' members, and lacks a 'private' constructor
in `hudi-cli/src/main/java/org/apache/hudi/cli/HoodieCliSparkConfig.java`
#### Snippet
```java
 * Class storing configs for init spark.
 */
public class HoodieCliSparkConfig {
  /**
   * Configs to start spark application.
```

### UtilityClassWithoutPrivateConstructor
Class `Main` has only 'static' members, and lacks a 'private' constructor
in `hudi-cli/src/main/java/org/apache/hudi/cli/Main.java`
#### Snippet
```java
 */
@SpringBootApplication(exclude = {org.springframework.boot.autoconfigure.gson.GsonAutoConfiguration.class})
public class Main {

  public static void main(String[] args) throws IOException {
```

### UtilityClassWithoutPrivateConstructor
Class `HoodieTableHeaderFields` has only 'static' members, and lacks a 'private' constructor
in `hudi-cli/src/main/java/org/apache/hudi/cli/HoodieTableHeaderFields.java`
#### Snippet
```java
 * Fields of print table header.
 */
public class HoodieTableHeaderFields {
  public static final String HEADER_ROW_NO = "No.";
  public static final String HEADER_PARTITION = "Partition";
```

### UtilityClassWithoutPrivateConstructor
Class `HoodieCLI` has only 'static' members, and lacks a 'private' constructor
in `hudi-cli/src/main/java/org/apache/hudi/cli/HoodieCLI.java`
#### Snippet
```java
 * This class is responsible to load table metadata and hoodie related configs.
 */
public class HoodieCLI {

  public static Configuration conf;
```

### UtilityClassWithoutPrivateConstructor
Class `HiveUtil` has only 'static' members, and lacks a 'private' constructor
in `hudi-cli/src/main/java/org/apache/hudi/cli/utils/HiveUtil.java`
#### Snippet
```java
 * Hive connection related utilities.
 */
public class HiveUtil {

  private static final String DRIVER_NAME = "org.apache.hive.jdbc.HiveDriver";
```

### UtilityClassWithoutPrivateConstructor
Class `CommitUtil` has only 'static' members, and lacks a 'private' constructor
in `hudi-cli/src/main/java/org/apache/hudi/cli/utils/CommitUtil.java`
#### Snippet
```java
 * Utilities related to commit operation.
 */
public class CommitUtil {

  public static long countNewRecords(HoodieTableMetaClient metaClient, List<String> commitsToCatchup) throws IOException {
```

### UtilityClassWithoutPrivateConstructor
Class `SparkUtil` has only 'static' members, and lacks a 'private' constructor
in `hudi-cli/src/main/java/org/apache/hudi/cli/utils/SparkUtil.java`
#### Snippet
```java
 * Utility functions dealing with Spark.
 */
public class SparkUtil {

  public static final String DEFAULT_SPARK_MASTER = "yarn";
```

### UtilityClassWithoutPrivateConstructor
Class `HoodiePrintHelper` has only 'static' members, and lacks a 'private' constructor
in `hudi-cli/src/main/java/org/apache/hudi/cli/HoodiePrintHelper.java`
#### Snippet
```java
 * Helper class to render table for hoodie-cli.
 */
public class HoodiePrintHelper {

  /**
```

### UtilityClassWithoutPrivateConstructor
Class `HiveSyncConfigHolder` has only 'static' members, and lacks a 'private' constructor
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/HiveSyncConfigHolder.java`
#### Snippet
```java
import org.apache.hudi.common.model.HoodieSyncTableStrategy;

public class HiveSyncConfigHolder {
  /*
   * NOTE: below are HIVE SYNC SPECIFIC CONFIGS which should be under HiveSyncConfig.java
```

### UtilityClassWithoutPrivateConstructor
Class `ColumnNameXLator` has only 'static' members, and lacks a 'private' constructor
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/util/ColumnNameXLator.java`
#### Snippet
```java
import java.util.Map;

public class ColumnNameXLator {

  private static Map<String, String> xformMap = new HashMap<>();
```

### UtilityClassWithoutPrivateConstructor
Class `HivePartitionUtil` has only 'static' members, and lacks a 'private' constructor
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/util/HivePartitionUtil.java`
#### Snippet
```java
import static org.apache.hudi.sync.common.HoodieSyncConfig.META_SYNC_PARTITION_FIELDS;

public class HivePartitionUtil {
  private static final Logger LOG = LogManager.getLogger(HivePartitionUtil.class);

```

### UtilityClassWithoutPrivateConstructor
Class `SparkMain` has only 'static' members, and lacks a 'private' constructor
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/SparkMain.java`
#### Snippet
```java
 * This class deals with initializing spark context based on command entered to hudi-cli.
 */
public class SparkMain {

  private static final Logger LOG = LogManager.getLogger(SparkMain.class);
```

### UtilityClassWithoutPrivateConstructor
Class `SyncUtilHelpers` has only 'static' members, and lacks a 'private' constructor
in `hudi-sync/hudi-sync-common/src/main/java/org/apache/hudi/sync/common/util/SyncUtilHelpers.java`
#### Snippet
```java
 * Helper class for syncing Hudi commit data with external metastores.
 */
public class SyncUtilHelpers {
  private static final Logger LOG = LogManager.getLogger(SyncUtilHelpers.class);
  /**
```

### UtilityClassWithoutPrivateConstructor
Class `TableUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-sync/hudi-sync-common/src/main/java/org/apache/hudi/sync/common/util/TableUtils.java`
#### Snippet
```java
package org.apache.hudi.sync.common.util;

public final class TableUtils {

  public static String tableId(String database, String table) {
```

### UtilityClassWithoutPrivateConstructor
Class `PartitionFilterGenerator` has only 'static' members, and lacks a 'private' constructor
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/util/PartitionFilterGenerator.java`
#### Snippet
```java
import static org.apache.hudi.sync.common.HoodieSyncConfig.META_SYNC_PARTITION_EXTRACTOR_CLASS;

public class PartitionFilterGenerator {

  private static final Set<String> SUPPORT_TYPES = new HashSet<String>() {
```

### UtilityClassWithoutPrivateConstructor
Class `Parquet2SparkSchemaUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-sync/hudi-sync-common/src/main/java/org/apache/hudi/sync/common/util/Parquet2SparkSchemaUtils.java`
#### Snippet
```java
 * in spark project.
 */
public class Parquet2SparkSchemaUtils {

  public static String convertToSparkSchemaJson(GroupType parquetSchema) {
```

### UtilityClassWithoutPrivateConstructor
Class `ConfigUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-sync/hudi-sync-common/src/main/java/org/apache/hudi/sync/common/util/ConfigUtils.java`
#### Snippet
```java
import java.util.Properties;

public class ConfigUtils {
  /**
   * Config stored in hive serde properties to tell query engine (spark/flink) to
```

### UtilityClassWithoutPrivateConstructor
Class `SparkDataSourceTableUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-sync/hudi-sync-common/src/main/java/org/apache/hudi/sync/common/util/SparkDataSourceTableUtils.java`
#### Snippet
```java
import static org.apache.parquet.schema.PrimitiveType.PrimitiveTypeName.BINARY;

public class SparkDataSourceTableUtils {
  /**
   * Get Spark Sql related table properties. This is used for spark datasource table.
```

### UtilityClassWithoutPrivateConstructor
Class `Main` has only 'static' members, and lacks a 'private' constructor
in `packaging/hudi-aws-bundle/src/main/java/org/apache/hudi/aws/bundle/Main.java`
#### Snippet
```java
import org.apache.hudi.common.util.ReflectionUtils;

public class Main {

  public static void main(String[] args) {
```

### UtilityClassWithoutPrivateConstructor
Class `Main` has only 'static' members, and lacks a 'private' constructor
in `packaging/hudi-cli-bundle/src/main/java/org/apache/hudi/cli/bundle/Main.java`
#### Snippet
```java
 * This class does not have anything to do with Hudi but is there to keep mvn javadocs/source plugin happy.
 */
public class Main {
  public static void main(String[] args) {
    ReflectionUtils.getTopLevelClassesInClasspath(Main.class).forEach(System.out::println);
```

### UtilityClassWithoutPrivateConstructor
Class `Main` has only 'static' members, and lacks a 'private' constructor
in `packaging/hudi-gcp-bundle/src/main/java/org/apache/hudi/gcp/bigquery/bundle/Main.java`
#### Snippet
```java
 * This class does not have anything to do with Hudi but is there to keep mvn javadocs/source plugin happy.
 */
public class Main {

  public static void main(String[] args) {
```

### UtilityClassWithoutPrivateConstructor
Class `Main` has only 'static' members, and lacks a 'private' constructor
in `packaging/hudi-flink-bundle/src/main/java/org/apache/hudi/flink/bundle/Main.java`
#### Snippet
```java
 * This class does not have anything to do with Hudi but is there to keep mvn javadocs/source plugin happy.
 */
public class Main {

  public static void main(String[] args) {
```

### UtilityClassWithoutPrivateConstructor
Class `Main` has only 'static' members, and lacks a 'private' constructor
in `packaging/hudi-spark-bundle/src/main/java/org/apache/hudi/spark/bundle/Main.java`
#### Snippet
```java
 * This class does not have anything to do with Hudi but is there to keep mvn javadocs/source plugin happy.
 */
public class Main {

  public static void main(String[] args) {
```

### UtilityClassWithoutPrivateConstructor
Class `Main` has only 'static' members, and lacks a 'private' constructor
in `packaging/hudi-presto-bundle/src/main/java/org/apache/hudi/presto/bundle/Main.java`
#### Snippet
```java
 * This class does not have anything to do with Hudi but is there to keep mvn javadocs/source plugin happy.
 */
public class Main {

  public static void main(String[] args) {
```

### UtilityClassWithoutPrivateConstructor
Class `Main` has only 'static' members, and lacks a 'private' constructor
in `packaging/hudi-trino-bundle/src/main/java/org/apache/hudi/trino/bundle/Main.java`
#### Snippet
```java
 * This class does not have anything to do with Hudi but is there to keep mvn javadocs/source plugin happy.
 */
public class Main {

  public static void main(String[] args) {
```

### UtilityClassWithoutPrivateConstructor
Class `Main` has only 'static' members, and lacks a 'private' constructor
in `packaging/hudi-hadoop-mr-bundle/src/main/java/org/apache/hudi/hadoop/bundle/Main.java`
#### Snippet
```java
 * This class does not have anything to do with Hudi but is there to keep mvn javadocs/source plugin happy.
 */
public class Main {

  public static void main(String[] args) {
```

### UtilityClassWithoutPrivateConstructor
Class `Main` has only 'static' members, and lacks a 'private' constructor
in `packaging/hudi-utilities-bundle/src/main/java/org/apache/hudi/utilities/bundle/Main.java`
#### Snippet
```java
 * This class does not have anything to do with Hudi but is there to keep mvn javadocs/source plugin happy.
 */
public class Main {

  public static void main(String[] args) {
```

### UtilityClassWithoutPrivateConstructor
Class `Main` has only 'static' members, and lacks a 'private' constructor
in `packaging/hudi-hive-sync-bundle/src/main/java/org/apache/hudi/hive/bundle/Main.java`
#### Snippet
```java
 * This class does not have anything to do with Hudi but is there to keep mvn javadocs/source plugin happy.
 */
public class Main {

  public static void main(String[] args) {
```

### UtilityClassWithoutPrivateConstructor
Class `Main` has only 'static' members, and lacks a 'private' constructor
in `packaging/hudi-kafka-connect-bundle/src/main/java/org/apache/hudi/kafka/connect/bundle/Main.java`
#### Snippet
```java
 * This class does not have anything to do with Hudi but is there to keep mvn javadocs/source plugin happy.
 */
public class Main {

  public static void main(String[] args) {
```

### UtilityClassWithoutPrivateConstructor
Class `Main` has only 'static' members, and lacks a 'private' constructor
in `packaging/hudi-utilities-slim-bundle/src/main/java/org/apache/hudi/utilities/bundle/Main.java`
#### Snippet
```java
 * This class does not have anything to do with Hudi but is there to keep mvn javadocs/source plugin happy.
 */
public class Main {

  public static void main(String[] args) {
```

### UtilityClassWithoutPrivateConstructor
Class `Main` has only 'static' members, and lacks a 'private' constructor
in `packaging/hudi-datahub-sync-bundle/src/main/java/org/apache/hudi/datahub/bundle/Main.java`
#### Snippet
```java
 * This class does not have anything to do with Hudi but is there to keep mvn javadocs/source plugin happy.
 */
public class Main {

  public static void main(String[] args) {
```

### UtilityClassWithoutPrivateConstructor
Class `Main` has only 'static' members, and lacks a 'private' constructor
in `packaging/hudi-timeline-server-bundle/src/main/java/org/apache/hudi/timeline/server/bundle/Main.java`
#### Snippet
```java
 * This class does not have anything to do with Hudi but is there to keep mvn javadocs/source plugin happy.
 */
public class Main {

  public static void main(String[] args) {
```

### UtilityClassWithoutPrivateConstructor
Class `JavaHoodieIndexFactory` has only 'static' members, and lacks a 'private' constructor
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/index/JavaHoodieIndexFactory.java`
#### Snippet
```java
 * A factory to generate Java {@link HoodieIndex}.
 */
public final class JavaHoodieIndexFactory {

  public static HoodieIndex createIndex(HoodieWriteConfig config) {
```

### UtilityClassWithoutPrivateConstructor
Class `HiveSchemaUtil` has only 'static' members, and lacks a 'private' constructor
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/util/HiveSchemaUtil.java`
#### Snippet
```java
 * Schema Utilities.
 */
public class HiveSchemaUtil {

  private static final Logger LOG = LogManager.getLogger(HiveSchemaUtil.class);
```

### UtilityClassWithoutPrivateConstructor
Class `HoodieRowDataFileWriterFactory` has only 'static' members, and lacks a 'private' constructor
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/io/storage/row/HoodieRowDataFileWriterFactory.java`
#### Snippet
```java
 * Factory to assist in instantiating a new {@link HoodieRowDataFileWriter}.
 */
public class HoodieRowDataFileWriterFactory {

  /**
```

### UtilityClassWithoutPrivateConstructor
Class `FlinkClientUtil` has only 'static' members, and lacks a 'private' constructor
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/util/FlinkClientUtil.java`
#### Snippet
```java
 * Utilities for Hoodie Flink client.
 */
public class FlinkClientUtil {

  /**
```

### UtilityClassWithoutPrivateConstructor
Class `WriteStatMerger` has only 'static' members, and lacks a 'private' constructor
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/util/WriteStatMerger.java`
#### Snippet
```java
 * <p>CAUTION: The merge can be buggy, we need to maintain the new variables for the write stat.
 */
public class WriteStatMerger {
  public static HoodieWriteStat merge(HoodieWriteStat stat1, HoodieWriteStat stat2) {
    if (stat1 instanceof HoodieDeltaWriteStat) {
```

### UtilityClassWithoutPrivateConstructor
Class `FlinkHoodieIndexFactory` has only 'static' members, and lacks a 'private' constructor
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/index/FlinkHoodieIndexFactory.java`
#### Snippet
```java
 * A factory to generate Flink {@link HoodieIndex}.
 */
public final class FlinkHoodieIndexFactory {
  public static HoodieIndex createIndex(HoodieFlinkEngineContext context, HoodieWriteConfig config) {
    // first use index class config to create index.
```

### UtilityClassWithoutPrivateConstructor
Class `ParquetSchemaConverter` has only 'static' members, and lacks a 'private' constructor
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/io/storage/row/parquet/ParquetSchemaConverter.java`
#### Snippet
```java
 * <p>Reference org.apache.flink.formats.parquet.utils.ParquetSchemaConverter to support timestamp of INT64 8 bytes.
 */
public class ParquetSchemaConverter {
  private static final Logger LOGGER = LoggerFactory.getLogger(ParquetSchemaConverter.class);
  public static final String MAP_VALUE = "value";
```

### UtilityClassWithoutPrivateConstructor
Class `FlinkWriteHandleFactory` has only 'static' members, and lacks a 'private' constructor
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/io/FlinkWriteHandleFactory.java`
#### Snippet
```java
 * Factory clazz for flink write handles.
 */
public class FlinkWriteHandleFactory {

  /**
```

### UtilityClassWithoutPrivateConstructor
Class `HoodieInternalRowFileWriterFactory` has only 'static' members, and lacks a 'private' constructor
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/io/storage/row/HoodieInternalRowFileWriterFactory.java`
#### Snippet
```java
 * Factory to assist in instantiating a new {@link HoodieInternalRowFileWriter}.
 */
public class HoodieInternalRowFileWriterFactory {

  /**
```

### UtilityClassWithoutPrivateConstructor
Class `SparkHoodieIndexFactory` has only 'static' members, and lacks a 'private' constructor
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/index/SparkHoodieIndexFactory.java`
#### Snippet
```java
 * A factory to generate Spark {@link HoodieIndex}.
 */
public final class SparkHoodieIndexFactory {
  public static HoodieIndex createIndex(HoodieWriteConfig config) {
    // first use index class config to create index.
```

### UtilityClassWithoutPrivateConstructor
Class `SpaceCurveSortingHelper` has only 'static' members, and lacks a 'private' constructor
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/sort/SpaceCurveSortingHelper.java`
#### Snippet
```java
import java.util.stream.Collectors;

public class SpaceCurveSortingHelper {

  private static final Logger LOG = LogManager.getLogger(SpaceCurveSortingHelper.class);
```

### UtilityClassWithoutPrivateConstructor
Class `MetadataBootstrapHandlerFactory` has only 'static' members, and lacks a 'private' constructor
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/table/action/bootstrap/MetadataBootstrapHandlerFactory.java`
#### Snippet
```java
import static org.apache.hudi.common.model.HoodieFileFormat.PARQUET;

public class MetadataBootstrapHandlerFactory {

  public static BootstrapMetadataHandler getMetadataHandler(HoodieWriteConfig config, HoodieTable table, HoodieFileStatus srcFileStatus) {
```

### UtilityClassWithoutPrivateConstructor
Class `SparkMemoryUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/utils/SparkMemoryUtils.java`
#### Snippet
```java
 * Spark config utils.
 */
public class SparkMemoryUtils {
  public static StorageLevel getWriteStatusStorageLevel(Properties properties) {
    return StorageLevel.fromString(new HoodieConfig(properties).getString(WRITE_STATUS_STORAGE_LEVEL_VALUE));
```

### UtilityClassWithoutPrivateConstructor
Class `SparkValidatorUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/utils/SparkValidatorUtils.java`
#### Snippet
```java
 * Spark validator utils to verify and run any pre-commit validators configured.
 */
public class SparkValidatorUtils {
  private static final Logger LOG = LogManager.getLogger(BaseSparkCommitActionExecutor.class);

```

### UtilityClassWithoutPrivateConstructor
Class `ExecutionStrategyUtil` has only 'static' members, and lacks a 'private' constructor
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/clustering/run/strategy/ExecutionStrategyUtil.java`
#### Snippet
```java
import java.io.IOException;

public class ExecutionStrategyUtil {

  /**
```

### UtilityClassWithoutPrivateConstructor
Class `HoodieSparkKeyGeneratorFactory` has only 'static' members, and lacks a 'private' constructor
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/keygen/factory/HoodieSparkKeyGeneratorFactory.java`
#### Snippet
```java
 * will not be overwritten by {@link KeyGeneratorType}
 */
public class HoodieSparkKeyGeneratorFactory {

  private static final Logger LOG = LoggerFactory.getLogger(HoodieSparkKeyGeneratorFactory.class);
```

### UtilityClassWithoutPrivateConstructor
Class `HoodieMergeHandleFactory` has only 'static' members, and lacks a 'private' constructor
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/io/HoodieMergeHandleFactory.java`
#### Snippet
```java
 * Factory class for hoodie merge handle.
 */
public class HoodieMergeHandleFactory {
  /**
   * Creates a merge handle for normal write path.
```

### UtilityClassWithoutPrivateConstructor
Class `IOUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/io/IOUtils.java`
#### Snippet
```java
import static org.apache.hudi.config.HoodieMemoryConfig.MAX_MEMORY_FRACTION_FOR_MERGE;

public class IOUtils {
  /**
   * Dynamic calculation of max memory to use for spillable map. There is always more than one task
```

### UtilityClassWithoutPrivateConstructor
Class `ExecutorFactory` has only 'static' members, and lacks a 'private' constructor
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/util/ExecutorFactory.java`
#### Snippet
```java
import java.util.function.Function;

public class ExecutorFactory {

  public static <I, O, E> HoodieExecutor<E> create(HoodieWriteConfig config,
```

### UtilityClassWithoutPrivateConstructor
Class `HoodieIndexUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/index/HoodieIndexUtils.java`
#### Snippet
```java
 * Hoodie Index Utilities.
 */
public class HoodieIndexUtils {

  private static final Logger LOG = LogManager.getLogger(HoodieIndexUtils.class);
```

### UtilityClassWithoutPrivateConstructor
Class `ClusteringPlanPartitionFilter` has only 'static' members, and lacks a 'private' constructor
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/cluster/ClusteringPlanPartitionFilter.java`
#### Snippet
```java
 *
 */
public class ClusteringPlanPartitionFilter {

  public static List<String> filter(List<String> partitions, HoodieWriteConfig config) {
```

### UtilityClassWithoutPrivateConstructor
Class `RestoreUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/restore/RestoreUtils.java`
#### Snippet
```java
import java.io.IOException;

public class RestoreUtils {

  /**
```

### UtilityClassWithoutPrivateConstructor
Class `RollbackUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/rollback/RollbackUtils.java`
#### Snippet
```java
import static org.apache.hudi.common.util.ValidationUtils.checkArgument;

public class RollbackUtils {

  private static final Logger LOG = LogManager.getLogger(RollbackUtils.class);
```

### UtilityClassWithoutPrivateConstructor
Class `BootstrapUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/bootstrap/BootstrapUtils.java`
#### Snippet
```java
import java.util.stream.Collectors;

public class BootstrapUtils {

  /**
```

### UtilityClassWithoutPrivateConstructor
Class `SavepointHelpers` has only 'static' members, and lacks a 'private' constructor
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/savepoint/SavepointHelpers.java`
#### Snippet
```java
import org.apache.log4j.Logger;

public class SavepointHelpers {

  private static final Logger LOG = LogManager.getLogger(SavepointHelpers.class);
```

### UtilityClassWithoutPrivateConstructor
Class `WriteMarkersFactory` has only 'static' members, and lacks a 'private' constructor
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/marker/WriteMarkersFactory.java`
#### Snippet
```java
 * A factory to generate {@code WriteMarkers} instance based on the {@code MarkerType}.
 */
public class WriteMarkersFactory {
  private static final Logger LOG = LogManager.getLogger(WriteMarkersFactory.class);

```

### UtilityClassWithoutPrivateConstructor
Class `ConflictDetectionUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/marker/ConflictDetectionUtils.java`
#### Snippet
```java
 * Utils for early conflict detection.
 */
public class ConflictDetectionUtils {
  /**
   * @param markerType Marker type.
```

### UtilityClassWithoutPrivateConstructor
Class `MarkerBasedRollbackUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/marker/MarkerBasedRollbackUtils.java`
#### Snippet
```java
 * A utility class for marker-based rollback.
 */
public class MarkerBasedRollbackUtils {

  private static final Logger LOG = LogManager.getLogger(MarkerBasedRollbackUtils.class);
```

### UtilityClassWithoutPrivateConstructor
Class `HoodieLayoutFactory` has only 'static' members, and lacks a 'private' constructor
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/storage/HoodieLayoutFactory.java`
#### Snippet
```java
 * A factory to generate layout.
 */
public final class HoodieLayoutFactory {
  public static HoodieStorageLayout createLayout(HoodieWriteConfig config) {
    switch (config.getLayoutType()) {
```

### UtilityClassWithoutPrivateConstructor
Class `RepairUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/repair/RepairUtils.java`
#### Snippet
```java
 * Utils for table repair tool.
 */
public final class RepairUtils {
  /**
   * Tags the instant time of each base or log file from the input file paths.
```

### UtilityClassWithoutPrivateConstructor
Class `DeletePartitionUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/utils/DeletePartitionUtils.java`
#### Snippet
```java
 * A utility class for helper functions when performing a delete partition operation.
 */
public class DeletePartitionUtils {

  /**
```

### UtilityClassWithoutPrivateConstructor
Class `TransactionUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/utils/TransactionUtils.java`
#### Snippet
```java
import java.util.stream.Stream;

public class TransactionUtils {

  private static final Logger LOG = LogManager.getLogger(TransactionUtils.class);
```

### UtilityClassWithoutPrivateConstructor
Class `FileSliceMetricUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/utils/FileSliceMetricUtils.java`
#### Snippet
```java
 * A utility class for calculating metrics related to FileSlice.
 */
public class FileSliceMetricUtils {

  public static final String TOTAL_IO_READ_MB = "TOTAL_IO_READ_MB";
```

### UtilityClassWithoutPrivateConstructor
Class `EmbeddedTimelineServerHelper` has only 'static' members, and lacks a 'private' constructor
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/embedded/EmbeddedTimelineServerHelper.java`
#### Snippet
```java
 * Helper class to instantiate embedded timeline service.
 */
public class EmbeddedTimelineServerHelper {

  private static final Logger LOG = LogManager.getLogger(EmbeddedTimelineService.class);
```

### UtilityClassWithoutPrivateConstructor
Class `MetadataConversionUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/utils/MetadataConversionUtils.java`
#### Snippet
```java
 * Helper class to convert between different action related payloads and {@link HoodieArchivedMetaEntry}.
 */
public class MetadataConversionUtils {

  public static HoodieArchivedMetaEntry createMetaWrapper(HoodieInstant hoodieInstant, HoodieTableMetaClient metaClient) throws IOException {
```

### UtilityClassWithoutPrivateConstructor
Class `HeartbeatUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/heartbeat/HeartbeatUtils.java`
#### Snippet
```java
 * Helper class to delete heartbeat for completed or failed instants with expired heartbeats.
 */
public class HeartbeatUtils {

  private static final Logger LOG = LogManager.getLogger(HeartbeatUtils.class);
```

### UtilityClassWithoutPrivateConstructor
Class `HoodieAvroKeyGeneratorFactory` has only 'static' members, and lacks a 'private' constructor
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/keygen/factory/HoodieAvroKeyGeneratorFactory.java`
#### Snippet
```java
 * will not be overwritten by {@link KeyGeneratorType}
 */
public class HoodieAvroKeyGeneratorFactory {

  private static final Logger LOG = LoggerFactory.getLogger(HoodieAvroKeyGeneratorFactory.class);
```

### UtilityClassWithoutPrivateConstructor
Class `KeyGenUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/keygen/KeyGenUtils.java`
#### Snippet
```java
import java.util.List;

public class KeyGenUtils {

  protected static final String NULL_RECORDKEY_PLACEHOLDER = "__null__";
```

### UtilityClassWithoutPrivateConstructor
Class `MetricsReporterFactory` has only 'static' members, and lacks a 'private' constructor
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metrics/MetricsReporterFactory.java`
#### Snippet
```java
 * Factory class for creating MetricsReporter.
 */
public class MetricsReporterFactory {

  private static final Logger LOG = LogManager.getLogger(MetricsReporterFactory.class);
```

### UtilityClassWithoutPrivateConstructor
Class `HoodieWriteCommitCallbackUtil` has only 'static' members, and lacks a 'private' constructor
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/callback/util/HoodieWriteCommitCallbackUtil.java`
#### Snippet
```java
 * Util helps to prepare callback message.
 */
public class HoodieWriteCommitCallbackUtil {

  private static ObjectMapper mapper = new ObjectMapper();
```

### UtilityClassWithoutPrivateConstructor
Class `HoodieCommitCallbackFactory` has only 'static' members, and lacks a 'private' constructor
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/callback/util/HoodieCommitCallbackFactory.java`
#### Snippet
```java
 * Factory help to create {@link HoodieWriteCommitCallback}.
 */
public class HoodieCommitCallbackFactory {
  public static HoodieWriteCommitCallback create(HoodieWriteConfig config) {
    String callbackClass = config.getCallbackClass();
```

### UtilityClassWithoutPrivateConstructor
Class `HilbertCurveUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/optimize/HilbertCurveUtils.java`
#### Snippet
```java
 * Utils for Hilbert Curve.
 */
public class HilbertCurveUtils {
  public static byte[] indexBytes(HilbertCurve hilbertCurve, long[] points, int paddingNum) {
    BigInteger index = hilbertCurve.index(points);
```

### UtilityClassWithoutPrivateConstructor
Class `HoodieHFileUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/io/storage/HoodieHFileUtils.java`
#### Snippet
```java
 * Util class for HFile reading and writing in Hudi
 */
public class HoodieHFileUtils {
  // Based on HBase 2.4.9, the primaryReplicaReader is mainly used for constructing
  // block cache key, so if we do not use block cache then it is OK to set it as any
```

### UtilityClassWithoutPrivateConstructor
Class `InLineFSUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/common/fs/inline/InLineFSUtils.java`
#### Snippet
```java
 * Eg: "inlinefs://<path_to_outer_file>/s3a/?start_offset=20&length=40"
 */
public class InLineFSUtils {
  private static final String START_OFFSET_STR = "start_offset";
  private static final String LENGTH_STR = "length";
```

### UtilityClassWithoutPrivateConstructor
Class `MapUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/common/util/MapUtils.java`
#### Snippet
```java
 * Utils for Java Map.
 */
public class MapUtils {

  public static boolean isNullOrEmpty(Map<?, ?> m) {
```

### UtilityClassWithoutPrivateConstructor
Class `BinaryUtil` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/common/util/BinaryUtil.java`
#### Snippet
```java
 * Utils for Java byte array.
 */
public class BinaryUtil {

  /**
```

### UtilityClassWithoutPrivateConstructor
Class `SerializationUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/common/util/SerializationUtils.java`
#### Snippet
```java
 * {@link SerializationUtils} class internally uses {@link Kryo} serializer for serializing / deserializing objects.
 */
public class SerializationUtils {

  // Caching kryo serializer to avoid creating kryo instance for every serde operation
```

### UtilityClassWithoutPrivateConstructor
Class `TablePathUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/common/util/TablePathUtils.java`
#### Snippet
```java
 * Utils for table path.
 */
public class TablePathUtils {

  private static final Logger LOG = LogManager.getLogger(TablePathUtils.class);
```

### UtilityClassWithoutPrivateConstructor
Class `PartitionPathEncodeUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/common/util/PartitionPathEncodeUtils.java`
#### Snippet
```java
 * This code is mainly copy from Hive (org.apache.hadoop.hive.common.FileUtils).
 */
public class PartitionPathEncodeUtils {

  public static final String DEPRECATED_DEFAULT_PARTITION_PATH = "default";
```

### UtilityClassWithoutPrivateConstructor
Class `SpillableMapUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/common/util/SpillableMapUtils.java`
#### Snippet
```java
 * A utility class supports spillable map.
 */
public class SpillableMapUtils {

  /**
```

### UtilityClassWithoutPrivateConstructor
Class `ValidationUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/common/util/ValidationUtils.java`
#### Snippet
```java
 * Simple utility to test validation conditions (to replace Guava's PreConditions)
 */
public class ValidationUtils {

  /**
```

### UtilityClassWithoutPrivateConstructor
Class `FileIOUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/common/util/FileIOUtils.java`
#### Snippet
```java
 * Bunch of utility methods for working with files and byte streams.
 */
public class FileIOUtils {
  public static final Logger LOG = LogManager.getLogger(FileIOUtils.class);
  public static final long KB = 1024;
```

### UtilityClassWithoutPrivateConstructor
Class `Base64CodecUtil` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/common/util/Base64CodecUtil.java`
#### Snippet
```java
 * Utils for Base64 encoding and decoding.
 */
public final class Base64CodecUtil {

  /**
```

### UtilityClassWithoutPrivateConstructor
Class `FSUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/common/fs/FSUtils.java`
#### Snippet
```java
 * Utility functions related to accessing the file storage.
 */
public class FSUtils {

  private static final Logger LOG = LogManager.getLogger(FSUtils.class);
```

### UtilityClassWithoutPrivateConstructor
Class `HoodieAvroUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/avro/HoodieAvroUtils.java`
#### Snippet
```java
 * Helper class to do common stuff across Avro.
 */
public class HoodieAvroUtils {

  public static final String AVRO_VERSION = Schema.class.getPackage().getImplementationVersion();
```

### UtilityClassWithoutPrivateConstructor
Class `ObjectSizeCalculator` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/common/util/ObjectSizeCalculator.java`
#### Snippet
```java
 * @author Attila Szegedi
 */
public class ObjectSizeCalculator {
  /**
   * Given an object, returns the total allocated size, in bytes, of the object and all other objects reachable from it.
```

### UtilityClassWithoutPrivateConstructor
Class `FutureUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/common/util/FutureUtils.java`
#### Snippet
```java
 * A utility class for future operation.
 */
public class FutureUtils {

  /**
```

### UtilityClassWithoutPrivateConstructor
Class `NetworkUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/common/util/NetworkUtils.java`
#### Snippet
```java
 * A utility class for network.
 */
public class NetworkUtils {

  public static synchronized String getHostname() {
```

### UtilityClassWithoutPrivateConstructor
Class `StringUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/common/util/StringUtils.java`
#### Snippet
```java
 * Simple utility for operations on strings.
 */
public class StringUtils {

  public static final String EMPTY_STRING = "";
```

### UtilityClassWithoutPrivateConstructor
Class `HoodieRecordUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/common/util/HoodieRecordUtils.java`
#### Snippet
```java
 * A utility class for HoodieRecord.
 */
public class HoodieRecordUtils {

  private static final Map<String, Object> INSTANCE_CACHE = new HashMap<>();
```

### UtilityClassWithoutPrivateConstructor
Class `ConfigUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/common/util/ConfigUtils.java`
#### Snippet
```java
import java.util.stream.Collectors;

public class ConfigUtils {

  /**
```

### UtilityClassWithoutPrivateConstructor
Class `ReflectionUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/common/util/ReflectionUtils.java`
#### Snippet
```java
 * A utility class for reflection.
 */
public class ReflectionUtils {

  private static final Logger LOG = LogManager.getLogger(ReflectionUtils.class);
```

### UtilityClassWithoutPrivateConstructor
Class `AvroOrcUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/common/util/AvroOrcUtils.java`
#### Snippet
```java
 * 2. Use getLogicalType(), constants from LogicalTypes instead of getJsonProp() to handle Avro logical types.
 */
public class AvroOrcUtils {

  private static final int MICROS_PER_MILLI = 1000;
```

### UtilityClassWithoutPrivateConstructor
Class `CommitUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/common/util/CommitUtils.java`
#### Snippet
```java
 * Helper class to generate commit metadata.
 */
public class CommitUtils {

  private static final Logger LOG = LogManager.getLogger(CommitUtils.class);
```

### UtilityClassWithoutPrivateConstructor
Class `NumericUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/common/util/NumericUtils.java`
#### Snippet
```java
 * A utility class for numeric.
 */
public class NumericUtils {

  public static String humanReadableByteCount(double bytes) {
```

### UtilityClassWithoutPrivateConstructor
Class `ClusteringUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/common/util/ClusteringUtils.java`
#### Snippet
```java
 * Helper class to generate clustering plan from metadata.
 */
public class ClusteringUtils {

  private static final Logger LOG = LogManager.getLogger(ClusteringUtils.class);
```

### UtilityClassWithoutPrivateConstructor
Class `CleanerUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/common/util/CleanerUtils.java`
#### Snippet
```java
 * Utils for clean action.
 */
public class CleanerUtils {

  private static final Logger LOG = LogManager.getLogger(CleanerUtils.class);
```

### UtilityClassWithoutPrivateConstructor
Class `DateTimeUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/common/util/DateTimeUtils.java`
#### Snippet
```java
 * Utils for Hudi instant time.
 */
public class DateTimeUtils {
  private static final Map<String, ChronoUnit> LABEL_TO_UNIT_MAP =
      Collections.unmodifiableMap(initMap());
```

### UtilityClassWithoutPrivateConstructor
Class `ThreadUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/common/util/ThreadUtils.java`
#### Snippet
```java
 * Utils for Java threading.
 */
public class ThreadUtils {

  /**
```

### UtilityClassWithoutPrivateConstructor
Class `JsonUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/common/util/JsonUtils.java`
#### Snippet
```java
 * Utils for JSON serialization and deserialization.
 */
public class JsonUtils {

  private static final ObjectMapper MAPPER = new ObjectMapper();
```

### UtilityClassWithoutPrivateConstructor
Class `InternalSchemaCache` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/common/util/InternalSchemaCache.java`
#### Snippet
```java
 * A map of (tablePath, HistorySchemas) is maintained.
 */
public class InternalSchemaCache {
  private static final Logger LOG = LogManager.getLogger(InternalSchemaCache.class);
  // Use segment lock to reduce competition.
```

### UtilityClassWithoutPrivateConstructor
Class `MarkerUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/common/util/MarkerUtils.java`
#### Snippet
```java
 * A utility class for marker related operations.
 */
public class MarkerUtils {
  public static final String MARKERS_FILENAME_PREFIX = "MARKERS";
  public static final String MARKER_TYPE_FILENAME = MARKERS_FILENAME_PREFIX + ".type";
```

### UtilityClassWithoutPrivateConstructor
Class `CompactionUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/common/util/CompactionUtils.java`
#### Snippet
```java
 * Helper class to generate compaction plan from FileGroup/FileSlice abstraction.
 */
public class CompactionUtils {

  public static final Integer COMPACTION_METADATA_VERSION_1 = CompactionV1MigrationHandler.VERSION;
```

### UtilityClassWithoutPrivateConstructor
Class `WaitStrategyFactory` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/common/util/queue/WaitStrategyFactory.java`
#### Snippet
```java
 * Factory for creating wait strategy for a queue.
 */
public class WaitStrategyFactory {

  public static final String DEFAULT_STRATEGY = BLOCKING_WAIT.name();
```

### UtilityClassWithoutPrivateConstructor
Class `CollectionUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/common/util/CollectionUtils.java`
#### Snippet
```java
 * Utils for Java Collection.
 */
public class CollectionUtils {

  private static final Properties EMPTY_PROPERTIES = new Properties();
```

### UtilityClassWithoutPrivateConstructor
Class `ArrayUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/ArrayUtils.java`
#### Snippet
```java
 * NOTE : Adapted from org.apache.commons.lang3.ArrayUtils
 */
public class ArrayUtils {

  /**
```

### UtilityClassWithoutPrivateConstructor
Class `BloomFilterUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/common/bloom/BloomFilterUtils.java`
#### Snippet
```java
 * Bloom filter utils.
 */
class BloomFilterUtils {

  /**
```

### UtilityClassWithoutPrivateConstructor
Class `BloomFilterFactory` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/common/bloom/BloomFilterFactory.java`
#### Snippet
```java
 * A Factory class to generate different versions of {@link BloomFilter}.
 */
public class BloomFilterFactory {

  /**
```

### UtilityClassWithoutPrivateConstructor
Class `HoodiePayloadProps` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodiePayloadProps.java`
#### Snippet
```java
 * Since both payload classes and HoodiePayloadConfig needs to access these props, storing it here in hudi-common.
 */
public class HoodiePayloadProps {

  /**
```

### UtilityClassWithoutPrivateConstructor
Class `Config` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieAvroRecordMerger.java`
#### Snippet
```java
  }

  public static class Config {

    public enum LegacyOperationMode {
```

### UtilityClassWithoutPrivateConstructor
Class `DebeziumConstants` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/common/model/debezium/DebeziumConstants.java`
#### Snippet
```java
 * Constants used by {@link DebeziumSource} and {@link DebeziumAvroPayload}.
 */
public class DebeziumConstants {

  // INPUT COLUMNS
```

### UtilityClassWithoutPrivateConstructor
Class `HoodieCDCUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/common/table/cdc/HoodieCDCUtils.java`
#### Snippet
```java
 * Utilities for change log capture.
 */
public class HoodieCDCUtils {

  public static final String CDC_LOGFILE_SUFFIX = ".cdc";
```

### UtilityClassWithoutPrivateConstructor
Class `LogReaderUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/LogReaderUtils.java`
#### Snippet
```java
 * Utils class for performing various log file reading operations.
 */
public class LogReaderUtils {

  private static Schema readSchemaFromLogFileInReverse(FileSystem fs, HoodieActiveTimeline activeTimeline, HoodieLogFile hoodieLogFile)
```

### UtilityClassWithoutPrivateConstructor
Class `TimelineDiffHelper` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/common/table/timeline/TimelineDiffHelper.java`
#### Snippet
```java
 * A helper class used to diff timeline.
 */
public class TimelineDiffHelper {

  private static final Logger LOG = LogManager.getLogger(TimelineDiffHelper.class);
```

### UtilityClassWithoutPrivateConstructor
Class `TimelineMetadataUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/common/table/timeline/TimelineMetadataUtils.java`
#### Snippet
```java
 * Utils for Hudi timeline metadata.
 */
public class TimelineMetadataUtils {

  private static final Integer DEFAULT_VERSION = 1;
```

### UtilityClassWithoutPrivateConstructor
Class `HoodieInstantTimeGenerator` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/common/table/timeline/HoodieInstantTimeGenerator.java`
#### Snippet
```java
 * Utility class to generate and parse timestamps used in Instants.
 */
public class HoodieInstantTimeGenerator {
  // Format of the timestamp used for an Instant
  public static final String SECS_INSTANT_TIMESTAMP_FORMAT = "yyyyMMddHHmmss";
```

### UtilityClassWithoutPrivateConstructor
Class `TimelineUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/common/table/timeline/TimelineUtils.java`
#### Snippet
```java
 * 2) Incremental reads - InputFormats can use this API to query
 */
public class TimelineUtils {
  private static final Logger LOG = LogManager.getLogger(TimelineUtils.class);

```

### UtilityClassWithoutPrivateConstructor
Class `ConfigGroups` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/common/config/ConfigGroups.java`
#### Snippet
```java
 * This class maintains the human readable name and description of each config group.
 */
public class ConfigGroups {
  /**
   * Config group names.
```

### UtilityClassWithoutPrivateConstructor
Class `FunctionWrapper` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/common/function/FunctionWrapper.java`
#### Snippet
```java
 * with no exception thrown.
 */
public class FunctionWrapper {

  public static <I, O> Function<I, O> throwingMapWrapper(SerializableFunction<I, O> throwingMapFunction) {
```

### UtilityClassWithoutPrivateConstructor
Class `FileStatusUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/common/bootstrap/FileStatusUtils.java`
#### Snippet
```java
 * Helper functions around FileStatus and HoodieFileStatus.
 */
public class FileStatusUtils {

  public static Path toPath(HoodiePath path) {
```

### UtilityClassWithoutPrivateConstructor
Class `HoodieHeartbeatUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/common/heartbeat/HoodieHeartbeatUtils.java`
#### Snippet
```java
 * Common utils for Hudi heartbeat
 */
public class HoodieHeartbeatUtils {
  private static final Logger LOG = LogManager.getLogger(HoodieHeartbeatUtils.class);

```

### UtilityClassWithoutPrivateConstructor
Class `Config` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/keygen/constant/KeyGeneratorOptions.java`
#### Snippet
```java
   * Supported configs.
   */
  public static class Config {

    // One value from TimestampType above
```

### UtilityClassWithoutPrivateConstructor
Class `AvroSchemaEvolutionUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/utils/AvroSchemaEvolutionUtils.java`
#### Snippet
```java
 * Utility methods to support evolve old avro schema based on a given schema.
 */
public class AvroSchemaEvolutionUtils {

  /**
```

### UtilityClassWithoutPrivateConstructor
Class `TableChangesHelper` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/action/TableChangesHelper.java`
#### Snippet
```java
 * Helper class to support Table schema changes.
 */
public class TableChangesHelper {
  /**
   * Apply add operation and column position change operation.
```

### UtilityClassWithoutPrivateConstructor
Class `AvroInternalSchemaConverter` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/convert/AvroInternalSchemaConverter.java`
#### Snippet
```java
 * Converts an avro schema into InternalSchema, or convert InternalSchema to an avro schema
 */
public class AvroInternalSchemaConverter {

  // NOTE: We're using dot as field's name delimiter for nested fields
```

### UtilityClassWithoutPrivateConstructor
Class `SecondaryIndexUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/secondary/index/SecondaryIndexUtils.java`
#### Snippet
```java
 * Utils for secondary index.
 */
public class SecondaryIndexUtils {

  /**
```

### UtilityClassWithoutPrivateConstructor
Class `HoodieJavaWriteClientExample` has only 'static' members, and lacks a 'private' constructor
in `hudi-examples/hudi-examples-java/src/main/java/org/apache/hudi/examples/java/HoodieJavaWriteClientExample.java`
#### Snippet
```java
 * for example, `HoodieJavaWriteClientExample file:///tmp/hoodie/sample-table hoodie_rt`
 */
public class HoodieJavaWriteClientExample {

  private static final Logger LOG = LogManager.getLogger(HoodieJavaWriteClientExample.class);
```

### UtilityClassWithoutPrivateConstructor
Class `HoodieSparkBootstrapExample` has only 'static' members, and lacks a 'private' constructor
in `hudi-examples/hudi-examples-spark/src/main/java/org/apache/hudi/examples/spark/HoodieSparkBootstrapExample.java`
#### Snippet
```java
import org.apache.spark.sql.Dataset;

public class HoodieSparkBootstrapExample {

  private static String tableType = HoodieTableType.MERGE_ON_READ.name();
```

### UtilityClassWithoutPrivateConstructor
Class `HoodieWriteClientExample` has only 'static' members, and lacks a 'private' constructor
in `hudi-examples/hudi-examples-spark/src/main/java/org/apache/hudi/examples/spark/HoodieWriteClientExample.java`
#### Snippet
```java
 * for example, `HoodieWriteClientExample file:///tmp/hoodie/sample-table hoodie_rt`
 */
public class HoodieWriteClientExample {

  private static final Logger LOG = LogManager.getLogger(HoodieWriteClientExample.class);
```

### UtilityClassWithoutPrivateConstructor
Class `HoodieExampleSparkUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-examples/hudi-examples-spark/src/main/java/org/apache/hudi/examples/common/HoodieExampleSparkUtils.java`
#### Snippet
```java
 * Bunch of util methods.
 */
public class HoodieExampleSparkUtils {

  private static Map<String, String> defaultConf() {
```

### UtilityClassWithoutPrivateConstructor
Class `InputSplitUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/InputSplitUtils.java`
#### Snippet
```java
import java.nio.charset.StandardCharsets;

public class InputSplitUtils {

  public static void writeString(String str, DataOutput out) throws IOException {
```

### UtilityClassWithoutPrivateConstructor
Class `HoodieColumnProjectionUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/HoodieColumnProjectionUtils.java`
#### Snippet
```java
 * Some of these methods are not available across hive versions.
 */
public class HoodieColumnProjectionUtils {
  public static final Logger LOG = LoggerFactory.getLogger(ColumnProjectionUtils.class);

```

### UtilityClassWithoutPrivateConstructor
Class `HoodieRealtimeConfig` has only 'static' members, and lacks a 'private' constructor
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/config/HoodieRealtimeConfig.java`
#### Snippet
```java
 * Class to hold props related to Hoodie RealtimeInputFormat and RealtimeRecordReader.
 */
public final class HoodieRealtimeConfig {

  // Fraction of mapper/reducer task memory used for compaction of log files
```

### UtilityClassWithoutPrivateConstructor
Class `HoodieHiveUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/utils/HoodieHiveUtils.java`
#### Snippet
```java
import java.util.stream.Collectors;

public class HoodieHiveUtils {

  public static final Logger LOG = LogManager.getLogger(HoodieHiveUtils.class);
```

### UtilityClassWithoutPrivateConstructor
Class `HoodieRealtimeRecordReaderUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/utils/HoodieRealtimeRecordReaderUtils.java`
#### Snippet
```java
import static org.apache.hudi.avro.AvroSchemaUtils.createNullableSchema;

public class HoodieRealtimeRecordReaderUtils {
  private static final Logger LOG = LogManager.getLogger(HoodieRealtimeRecordReaderUtils.class);

```

### UtilityClassWithoutPrivateConstructor
Class `HoodieTableMetadataUtil` has only 'static' members, and lacks a 'private' constructor
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieTableMetadataUtil.java`
#### Snippet
```java
 * A utility to convert timeline information to metadata table records.
 */
public class HoodieTableMetadataUtil {

  private static final Logger LOG = LogManager.getLogger(HoodieTableMetadataUtil.class);
```

### UtilityClassWithoutPrivateConstructor
Class `HoodieDataTableUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDataTableUtils.java`
#### Snippet
```java
import java.util.stream.Collectors;

public class HoodieDataTableUtils {

  /**
```

### UtilityClassWithoutPrivateConstructor
Class `Config` has only 'static' members, and lacks a 'private' constructor
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/schema/SchemaPostProcessor.java`
#### Snippet
```java

  /** Configs supported. */
  public static class Config {
    public static final String SCHEMA_POST_PROCESSOR_PROP =
        "hoodie.deltastreamer.schemaprovider.schema_post_processor";
```

### UtilityClassWithoutPrivateConstructor
Class `Config` has only 'static' members, and lacks a 'private' constructor
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/schema/ProtoClassBasedSchemaProvider.java`
#### Snippet
```java
   * Configs supported.
   */
  public static class Config {
    private static final String PROTO_SCHEMA_PROVIDER_PREFIX = "hoodie.deltastreamer.schemaprovider.proto";
    public static final ConfigProperty<String> PROTO_SCHEMA_CLASS_NAME = ConfigProperty.key(PROTO_SCHEMA_PROVIDER_PREFIX + ".class.name")
```

### UtilityClassWithoutPrivateConstructor
Class `Config` has only 'static' members, and lacks a 'private' constructor
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/schema/SparkAvroPostProcessor.java`
#### Snippet
```java
public class SparkAvroPostProcessor extends SchemaPostProcessor {

  public static class Config {
    public static final String SPARK_AVRO_POST_PROCESSOR_PROP_ENABLE =
            "hoodie.deltastreamer.schemaprovider.spark_avro_post_processor.enable";
```

### UtilityClassWithoutPrivateConstructor
Class `Config` has only 'static' members, and lacks a 'private' constructor
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/schema/postprocessor/DropColumnSchemaPostProcessor.java`
#### Snippet
```java
  }

  public static class Config {
    public static final String DELETE_COLUMN_POST_PROCESSOR_COLUMN_PROP =
        "hoodie.deltastreamer.schemaprovider.schema_post_processor.delete.columns";
```

### UtilityClassWithoutPrivateConstructor
Class `BaseSchemaPostProcessorConfig` has only 'static' members, and lacks a 'private' constructor
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/schema/postprocessor/add/BaseSchemaPostProcessorConfig.java`
#### Snippet
```java
 * Base configs to describe a primitive type column.
 */
public class BaseSchemaPostProcessorConfig {

  public static final ConfigProperty<String> SCHEMA_POST_PROCESSOR_ADD_COLUMN_NAME_PROP = ConfigProperty
```

### UtilityClassWithoutPrivateConstructor
Class `Config` has only 'static' members, and lacks a 'private' constructor
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/schema/SchemaRegistryProvider.java`
#### Snippet
```java
   * Configs supported.
   */
  public static class Config {

    public static final String SRC_SCHEMA_REGISTRY_URL_PROP = "hoodie.deltastreamer.schemaprovider.registry.url";
```

### UtilityClassWithoutPrivateConstructor
Class `UtilHelpers` has only 'static' members, and lacks a 'private' constructor
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/UtilHelpers.java`
#### Snippet
```java
 * Bunch of helper methods.
 */
public class UtilHelpers {

  public static final String EXECUTE = "execute";
```

### UtilityClassWithoutPrivateConstructor
Class `Config` has only 'static' members, and lacks a 'private' constructor
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/PulsarSource.java`
#### Snippet
```java
  }

  public static class Config {
    private static final ConfigProperty<String> PULSAR_SOURCE_TOPIC_NAME = ConfigProperty
        .key("hoodie.deltastreamer.source.pulsar.topic")
```

### UtilityClassWithoutPrivateConstructor
Class `Config` has only 'static' members, and lacks a 'private' constructor
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/HoodieIncrSource.java`
#### Snippet
```java
  private static final Logger LOG = LogManager.getLogger(HoodieIncrSource.class);

  public static class Config {

    /**
```

### UtilityClassWithoutPrivateConstructor
Class `Config` has only 'static' members, and lacks a 'private' constructor
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/S3EventsHoodieIncrSource.java`
#### Snippet
```java
  private static final Logger LOG = LogManager.getLogger(S3EventsHoodieIncrSource.class);

  static class Config {
    // control whether we do existence check for files before consuming them
    static final String ENABLE_EXISTS_CHECK = "hoodie.deltastreamer.source.s3incr.check.file.exists";
```

### UtilityClassWithoutPrivateConstructor
Class `Config` has only 'static' members, and lacks a 'private' constructor
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/helpers/CloudObjectsSelector.java`
#### Snippet
```java
   * Configs supported.
   */
  public static class Config {
    private static final String HOODIE_DELTASTREAMER_S3_SOURCE = "hoodie.deltastreamer.s3.source";
    /**
```

### UtilityClassWithoutPrivateConstructor
Class `CloudStoreIngestionConfig` has only 'static' members, and lacks a 'private' constructor
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/helpers/CloudStoreIngestionConfig.java`
#### Snippet
```java
 * Configs that are common during ingestion across different cloud stores
 */
public class CloudStoreIngestionConfig {

  /**
```

### UtilityClassWithoutPrivateConstructor
Class `IncrSourceCloudStorageHelper` has only 'static' members, and lacks a 'private' constructor
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/helpers/IncrSourceCloudStorageHelper.java`
#### Snippet
```java
 * Helper methods for when the incremental source is fetching from Cloud Storage, like AWS S3 buckets or GCS.
 */
public class IncrSourceCloudStorageHelper {

  private static final Logger LOG = LogManager.getLogger(IncrSourceCloudStorageHelper.class);
```

### UtilityClassWithoutPrivateConstructor
Class `Config` has only 'static' members, and lacks a 'private' constructor
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/helpers/DFSPathSelector.java`
#### Snippet
```java
   * Configs supported.
   */
  public static class Config {

    public static final String ROOT_INPUT_PATH_PROP = "hoodie.deltastreamer.source.dfs.root";
```

### UtilityClassWithoutPrivateConstructor
Class `CloudObjectsSelectorCommon` has only 'static' members, and lacks a 'private' constructor
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/helpers/CloudObjectsSelectorCommon.java`
#### Snippet
```java
 * GcsEventsSource etc...so you can't assume the classes for your specific implementation will be available here.
 */
public class CloudObjectsSelectorCommon {

  private static final Logger LOG = LogManager.getLogger(CloudObjectsSelectorCommon.class);
```

### UtilityClassWithoutPrivateConstructor
Class `IncrSourceHelper` has only 'static' members, and lacks a 'private' constructor
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/helpers/IncrSourceHelper.java`
#### Snippet
```java
import static org.apache.hudi.utilities.sources.HoodieIncrSource.Config.READ_LATEST_INSTANT_ON_MISSING_CKPT;

public class IncrSourceHelper {

  private static final String DEFAULT_BEGIN_TIMESTAMP = "000";
```

### UtilityClassWithoutPrivateConstructor
Class `Config` has only 'static' members, and lacks a 'private' constructor
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/helpers/DatePartitionPathSelector.java`
#### Snippet
```java

  /** Configs supported. */
  public static class Config {
    public static final String DATE_FORMAT = "hoodie.deltastreamer.source.dfs.datepartitioned.date.format";
    public static final String DEFAULT_DATE_FORMAT = "yyyy-MM-dd";
```

### UtilityClassWithoutPrivateConstructor
Class `GcsIngestionConfig` has only 'static' members, and lacks a 'private' constructor
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/helpers/gcs/GcsIngestionConfig.java`
#### Snippet
```java
 * Config keys and defaults for GCS Ingestion
 */
public class GcsIngestionConfig {

  /**
```

### UtilityClassWithoutPrivateConstructor
Class `ProtoConversionUtil` has only 'static' members, and lacks a 'private' constructor
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/helpers/ProtoConversionUtil.java`
#### Snippet
```java
 * A utility class to help translate from Proto to Avro.
 */
public class ProtoConversionUtil {

  /**
```

### UtilityClassWithoutPrivateConstructor
Class `Config` has only 'static' members, and lacks a 'private' constructor
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/processor/maxwell/MaxwellJsonKafkaSourcePostProcessor.java`
#### Snippet
```java
   * Configs to be passed for this processor.
   */
  public static class Config {
    public static final ConfigProperty<String> DATABASE_NAME_REGEX_PROP = ConfigProperty
        .key("hoodie.deltastreamer.source.json.kafka.post.processor.maxwell.database.regex")
```

### UtilityClassWithoutPrivateConstructor
Class `CheckpointUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/helpers/KafkaOffsetGen.java`
#### Snippet
```java
  private final Pattern pattern = Pattern.compile(".*,.*:.*");

  public static class CheckpointUtils {

    /**
```

### UtilityClassWithoutPrivateConstructor
Class `Config` has only 'static' members, and lacks a 'private' constructor
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/helpers/KafkaOffsetGen.java`
#### Snippet
```java
   * Configs to be passed for this source. All standard Kafka consumer configs are also respected
   */
  public static class Config {

    private static final ConfigProperty<String> KAFKA_TOPIC_NAME = ConfigProperty
```

### UtilityClassWithoutPrivateConstructor
Class `TerminationStrategyUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/TerminationStrategyUtils.java`
#### Snippet
```java
import org.apache.hudi.exception.HoodieException;

public class TerminationStrategyUtils {

  /**
```

### UtilityClassWithoutPrivateConstructor
Class `Helpers` has only 'static' members, and lacks a 'private' constructor
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/HoodieMultiTableDeltaStreamer.java`
#### Snippet
```java
  }

  public static class Helpers {

    static String getDefaultConfigFilePath(String configFolder, String database, String currentTable) {
```

### UtilityClassWithoutPrivateConstructor
Class `Constants` has only 'static' members, and lacks a 'private' constructor
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/HoodieMultiTableDeltaStreamer.java`
#### Snippet
```java
  }

  public static class Constants {
    public static final String KAFKA_TOPIC_PROP = "hoodie.deltastreamer.source.kafka.topic";
    public static final String HIVE_SYNC_TABLE_PROP = "hoodie.datasource.hive_sync.table";
```

### UtilityClassWithoutPrivateConstructor
Class `SchedulerConfGenerator` has only 'static' members, and lacks a 'private' constructor
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/SchedulerConfGenerator.java`
#### Snippet
```java
 * spark.scheduler.mode=FAIR at spark-submit time
 */
public class SchedulerConfGenerator {

  private static final Logger LOG = LogManager.getLogger(SchedulerConfGenerator.class);
```

### UtilityClassWithoutPrivateConstructor
Class `KafkaConnectUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-kafka-connect/src/main/java/org/apache/hudi/connect/utils/KafkaConnectUtils.java`
#### Snippet
```java
 * Helper methods for Kafka.
 */
public class KafkaConnectUtils {

  private static final Logger LOG = LogManager.getLogger(KafkaConnectUtils.class);
```

### UtilityClassWithoutPrivateConstructor
Class `WriterHelpers` has only 'static' members, and lacks a 'private' constructor
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/bulk/WriterHelpers.java`
#### Snippet
```java
 * Factory clazz to generate bulk insert writer helpers.
 */
public class WriterHelpers {
  public static BulkInsertWriterHelper getWriterHelper(Configuration conf, HoodieTable<?, ?, ?, ?> hoodieTable, HoodieWriteConfig writeConfig,
                                                       String instantTime, int taskPartitionId, long taskId, long taskEpochId, RowType rowType) {
```

### UtilityClassWithoutPrivateConstructor
Class `Pipelines` has only 'static' members, and lacks a 'private' constructor
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/utils/Pipelines.java`
#### Snippet
```java
 * Utilities to generate all kinds of sub-pipelines.
 */
public class Pipelines {

  /**
```

### UtilityClassWithoutPrivateConstructor
Class `CompactionUtil` has only 'static' members, and lacks a 'private' constructor
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/util/CompactionUtil.java`
#### Snippet
```java
 * Utilities for flink hudi compaction.
 */
public class CompactionUtil {

  private static final Logger LOG = LoggerFactory.getLogger(CompactionUtil.class);
```

### UtilityClassWithoutPrivateConstructor
Class `ExpressionUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/util/ExpressionUtils.java`
#### Snippet
```java
 * Utilities for expression resolving.
 */
public class ExpressionUtils {

  /**
```

### UtilityClassWithoutPrivateConstructor
Class `AvroToRowDataConverters` has only 'static' members, and lacks a 'private' constructor
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/util/AvroToRowDataConverters.java`
#### Snippet
```java
 */
@Internal
public class AvroToRowDataConverters {

  /**
```

### UtilityClassWithoutPrivateConstructor
Class `ViewStorageProperties` has only 'static' members, and lacks a 'private' constructor
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/util/ViewStorageProperties.java`
#### Snippet
```java
 * Helper class to read/write {@link FileSystemViewStorageConfig}.
 */
public class ViewStorageProperties {
  private static final Logger LOG = LoggerFactory.getLogger(ViewStorageProperties.class);

```

### UtilityClassWithoutPrivateConstructor
Class `ClusteringUtil` has only 'static' members, and lacks a 'private' constructor
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/util/ClusteringUtil.java`
#### Snippet
```java
 * Utilities for flink hudi clustering.
 */
public class ClusteringUtil {

  private static final Logger LOG = LoggerFactory.getLogger(ClusteringUtil.class);
```

### UtilityClassWithoutPrivateConstructor
Class `InputFormats` has only 'static' members, and lacks a 'private' constructor
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/util/InputFormats.java`
#### Snippet
```java
 * Utilities for all kinds of {@link org.apache.flink.api.common.io.InputFormat}s.
 */
public class InputFormats {
  public static final InputFormat<RowData, ?> EMPTY_INPUT_FORMAT =
      new CollectionInputFormat<>(Collections.emptyList(), null);
```

### UtilityClassWithoutPrivateConstructor
Class `FlinkWriteClients` has only 'static' members, and lacks a 'private' constructor
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/util/FlinkWriteClients.java`
#### Snippet
```java
 * Utilities for {@link org.apache.hudi.client.HoodieFlinkWriteClient}.
 */
public class FlinkWriteClients {

  /**
```

### UtilityClassWithoutPrivateConstructor
Class `RowDataToAvroConverters` has only 'static' members, and lacks a 'private' constructor
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/util/RowDataToAvroConverters.java`
#### Snippet
```java
 */
@Internal
public class RowDataToAvroConverters {

  private static Conversions.DecimalConversion decimalConversion = new Conversions.DecimalConversion();
```

### UtilityClassWithoutPrivateConstructor
Class `HoodiePipeline` has only 'static' members, and lacks a 'private' constructor
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/util/HoodiePipeline.java`
#### Snippet
```java
 *  </pre>
 */
public class HoodiePipeline {

  private static final Logger LOG = LogManager.getLogger(HoodiePipeline.class);
```

### UtilityClassWithoutPrivateConstructor
Class `StreamerUtil` has only 'static' members, and lacks a 'private' constructor
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/util/StreamerUtil.java`
#### Snippet
```java
 * Utilities for Flink stream read and write.
 */
public class StreamerUtil {

  private static final Logger LOG = LoggerFactory.getLogger(StreamerUtil.class);
```

### UtilityClassWithoutPrivateConstructor
Class `DataTypeUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/util/DataTypeUtils.java`
#### Snippet
```java
 * Utilities for {@link org.apache.flink.table.types.DataType}.
 */
public class DataTypeUtils {
  /**
   * Returns whether the given type is TIMESTAMP type.
```

### UtilityClassWithoutPrivateConstructor
Class `AvroSchemaConverter` has only 'static' members, and lacks a 'private' constructor
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/util/AvroSchemaConverter.java`
#### Snippet
```java
 * <p>NOTE: reference from Flink release 1.12.0, should remove when Flink version upgrade to that.
 */
public class AvroSchemaConverter {

  /**
```

### UtilityClassWithoutPrivateConstructor
Class `FilePathUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/FilePathUtils.java`
#### Snippet
```java
 * but supports simple partition path besides the Hive style.
 */
public class FilePathUtils {

  private static final Pattern HIVE_PARTITION_NAME_PATTERN = Pattern.compile("([^/]+)=([^/]+)");
```

### UtilityClassWithoutPrivateConstructor
Class `CatalogOptions` has only 'static' members, and lacks a 'private' constructor
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/catalog/CatalogOptions.java`
#### Snippet
```java
 * Hoodie catalog options.
 */
public class CatalogOptions {
  public static final String HIVE_SITE_FILE = "hive-site.xml";
  public static final String DEFAULT_DB = "default";
```

### UtilityClassWithoutPrivateConstructor
Class `HoodieCatalogUtil` has only 'static' members, and lacks a 'private' constructor
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/catalog/HoodieCatalogUtil.java`
#### Snippet
```java
 * Utilities for Hoodie Catalog.
 */
public class HoodieCatalogUtil {
  private static final Logger LOG = LoggerFactory.getLogger(HoodieCatalogUtil.class);

```

### UtilityClassWithoutPrivateConstructor
Class `HiveSchemaUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/catalog/HiveSchemaUtils.java`
#### Snippet
```java
 * Utilities for Hive field schema.
 */
public class HiveSchemaUtils {
  /**
   * Get field names from field schemas.
```

### UtilityClassWithoutPrivateConstructor
Class `TableOptionProperties` has only 'static' members, and lacks a 'private' constructor
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/catalog/TableOptionProperties.java`
#### Snippet
```java
 * Helper class to read/write flink table options as a map.
 */
public class TableOptionProperties {
  private static final Logger LOG = LoggerFactory.getLogger(TableOptionProperties.class);

```

### UtilityClassWithoutPrivateConstructor
Class `HoodieFlinkStreamer` has only 'static' members, and lacks a 'private' constructor
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/streamer/HoodieFlinkStreamer.java`
#### Snippet
```java
 * and the format is bind to JSON.
 */
public class HoodieFlinkStreamer {
  public static void main(String[] args) throws Exception {
    StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();
```

### UtilityClassWithoutPrivateConstructor
Class `ExpressionEvaluator` has only 'static' members, and lacks a 'private' constructor
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/source/stats/ExpressionEvaluator.java`
#### Snippet
```java
 * Tool to evaluate the {@link org.apache.flink.table.expressions.ResolvedExpression}s.
 */
public class ExpressionEvaluator {
  private static final int IN_PREDICATE_LIMIT = 200;

```

### UtilityClassWithoutPrivateConstructor
Class `OptionsInference` has only 'static' members, and lacks a 'private' constructor
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/configuration/OptionsInference.java`
#### Snippet
```java
 * Tool helping to infer the flink options {@link FlinkOptions}.
 */
public class OptionsInference {

  /**
```

### UtilityClassWithoutPrivateConstructor
Class `HadoopConfigurations` has only 'static' members, and lacks a 'private' constructor
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/configuration/HadoopConfigurations.java`
#### Snippet
```java
 * Utilities for fetching hadoop configurations.
 */
public class HadoopConfigurations {
  private static final String HADOOP_PREFIX = "hadoop.";
  private static final String PARQUET_PREFIX = "parquet.";
```

### UtilityClassWithoutPrivateConstructor
Class `OptionsResolver` has only 'static' members, and lacks a 'private' constructor
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/configuration/OptionsResolver.java`
#### Snippet
```java
 * Tool helping to resolve the flink options {@link FlinkOptions}.
 */
public class OptionsResolver {
  /**
   * Returns whether insert clustering is allowed with given configuration {@code conf}.
```

### UtilityClassWithoutPrivateConstructor
Class `Utils` has only 'static' members, and lacks a 'private' constructor
in `hudi-flink-datasource/hudi-flink1.13.x/src/main/java/org/apache/hudi/adapter/Utils.java`
#### Snippet
```java
 * Adapter utils.
 */
public class Utils {
  public static <O> SourceFunction.SourceContext<O> getSourceContext(
      TimeCharacteristic timeCharacteristic,
```

### UtilityClassWithoutPrivateConstructor
Class `Utils` has only 'static' members, and lacks a 'private' constructor
in `hudi-flink-datasource/hudi-flink1.14.x/src/main/java/org/apache/hudi/adapter/Utils.java`
#### Snippet
```java
 * Adapter utils.
 */
public class Utils {
  public static <O> SourceFunction.SourceContext<O> getSourceContext(
      TimeCharacteristic timeCharacteristic,
```

### UtilityClassWithoutPrivateConstructor
Class `ParquetSplitReaderUtil` has only 'static' members, and lacks a 'private' constructor
in `hudi-flink-datasource/hudi-flink1.13.x/src/main/java/org/apache/hudi/table/format/cow/ParquetSplitReaderUtil.java`
#### Snippet
```java
 * based TIMESTAMP_MILLIS as ConvertedType, should remove when Flink supports that.
 */
public class ParquetSplitReaderUtil {

  /**
```

### UtilityClassWithoutPrivateConstructor
Class `Utils` has only 'static' members, and lacks a 'private' constructor
in `hudi-flink-datasource/hudi-flink1.15.x/src/main/java/org/apache/hudi/adapter/Utils.java`
#### Snippet
```java
 * Adapter utils.
 */
public class Utils {
  public static <O> SourceFunction.SourceContext<O> getSourceContext(
      TimeCharacteristic timeCharacteristic,
```

### UtilityClassWithoutPrivateConstructor
Class `ParquetSplitReaderUtil` has only 'static' members, and lacks a 'private' constructor
in `hudi-flink-datasource/hudi-flink1.14.x/src/main/java/org/apache/hudi/table/format/cow/ParquetSplitReaderUtil.java`
#### Snippet
```java
 * based TIMESTAMP_MILLIS as ConvertedType, should remove when Flink supports that.
 */
public class ParquetSplitReaderUtil {

  /**
```

### UtilityClassWithoutPrivateConstructor
Class `Utils` has only 'static' members, and lacks a 'private' constructor
in `hudi-flink-datasource/hudi-flink1.16.x/src/main/java/org/apache/hudi/adapter/Utils.java`
#### Snippet
```java
 * Adapter utils.
 */
public class Utils {
  public static <O> SourceFunction.SourceContext<O> getSourceContext(
      TimeCharacteristic timeCharacteristic,
```

### UtilityClassWithoutPrivateConstructor
Class `HoodieDataSourceHelpers` has only 'static' members, and lacks a 'private' constructor
in `hudi-spark-datasource/hudi-spark/src/main/java/org/apache/hudi/HoodieDataSourceHelpers.java`
#### Snippet
```java
 */
@PublicAPIClass(maturity = ApiMaturityLevel.STABLE)
public class HoodieDataSourceHelpers {

  /**
```

### UtilityClassWithoutPrivateConstructor
Class `ParquetSplitReaderUtil` has only 'static' members, and lacks a 'private' constructor
in `hudi-flink-datasource/hudi-flink1.15.x/src/main/java/org/apache/hudi/table/format/cow/ParquetSplitReaderUtil.java`
#### Snippet
```java
 * based TIMESTAMP_MILLIS as ConvertedType, should remove when Flink supports that.
 */
public class ParquetSplitReaderUtil {

  /**
```

### UtilityClassWithoutPrivateConstructor
Class `QuickstartUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-spark-datasource/hudi-spark/src/main/java/org/apache/hudi/QuickstartUtils.java`
#### Snippet
```java
 * trips, data model.
 */
public class QuickstartUtils {

  public static class DataGenerator {
```

### UtilityClassWithoutPrivateConstructor
Class `ParquetSplitReaderUtil` has only 'static' members, and lacks a 'private' constructor
in `hudi-flink-datasource/hudi-flink1.16.x/src/main/java/org/apache/hudi/table/format/cow/ParquetSplitReaderUtil.java`
#### Snippet
```java
 * based TIMESTAMP_MILLIS as ConvertedType, should remove when Flink supports that.
 */
public class ParquetSplitReaderUtil {

  /**
```

### UtilityClassWithoutPrivateConstructor
Class `DataSourceUtils` has only 'static' members, and lacks a 'private' constructor
in `hudi-spark-datasource/hudi-spark-common/src/main/java/org/apache/hudi/DataSourceUtils.java`
#### Snippet
```java
 * Utilities used throughout the data source.
 */
public class DataSourceUtils {

  private static final Logger LOG = LogManager.getLogger(DataSourceUtils.class);
```

## RuleId[ruleID=DataFlowIssue]
### DataFlowIssue
Argument `libDirectory.list()` might be null
in `hudi-cli/src/main/java/org/apache/hudi/cli/utils/SparkUtil.java`
#### Snippet
```java
      // When directly using hudi-cli module, the jars under the lib directory
      // generated by the compilation is required
      Arrays.stream(libDirectory.list()).forEach(library ->
          sparkLauncher.addJar(new File(libDirectory, library).getAbsolutePath()));
    } else {
```

### DataFlowIssue
Method invocation `close` may produce `NullPointerException`
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/TableCommand.java`
#### Snippet
```java
      os.write(data.getBytes(), 0, data.length());
    } finally {
      os.close();
    }
  }
```

### DataFlowIssue
Variable is already assigned to this value
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/SparkMain.java`
#### Snippet
```java
          assert (args.length == 7);
          doCompactValidate(jsc, args[3], args[4], args[5], Integer.parseInt(args[6]));
          returnCode = 0;
          break;
        case COMPACT_REPAIR:
```

### DataFlowIssue
Variable is already assigned to this value
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/SparkMain.java`
#### Snippet
```java
          doCompactRepair(jsc, args[3], args[4], args[5], Integer.parseInt(args[6]),
              Boolean.parseBoolean(args[7]));
          returnCode = 0;
          break;
        case COMPACT_UNSCHEDULE_FILE:
```

### DataFlowIssue
Variable is already assigned to this value
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/SparkMain.java`
#### Snippet
```java
          doCompactUnscheduleFile(jsc, args[3], args[4], args[5], args[6], Integer.parseInt(args[7]),
              Boolean.parseBoolean(args[8]), Boolean.parseBoolean(args[9]));
          returnCode = 0;
          break;
        case COMPACT_UNSCHEDULE_PLAN:
```

### DataFlowIssue
Variable is already assigned to this value
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/SparkMain.java`
#### Snippet
```java
          doCompactUnschedule(jsc, args[3], args[4], args[5], Integer.parseInt(args[6]),
              Boolean.parseBoolean(args[7]), Boolean.parseBoolean(args[8]));
          returnCode = 0;
          break;
        case CLUSTERING_RUN:
```

### DataFlowIssue
Method invocation `replaceAll` may produce `NullPointerException`
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/util/HiveSchemaUtil.java`
#### Snippet
```java

        String expectedType = getExpectedType(newTableSchema, tickSurroundedFieldName);
        expectedType = expectedType.replaceAll("\\s+", "");
        expectedType = expectedType.replaceAll("`", "");

```

### DataFlowIssue
Argument `workloadProfile` might be null
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/table/action/commit/BaseJavaCommitActionExecutor.java`
#### Snippet
```java
    final Partitioner partitioner = getPartitioner(workloadProfile);
    try {
      saveWorkloadProfileMetadataToInflight(workloadProfile, instantTime);
    } catch (Exception e) {
      HoodieTableMetaClient metaClient = table.getMetaClient();
```

### DataFlowIssue
Stream might have already been linked or consumed
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/client/common/HoodieJavaEngineContext.java`
#### Snippet
```java
  public <I, K, V> Stream<ImmutablePair<K, V>> mapPartitionsToPairAndReduceByKey(Stream<I> data, SerializablePairFlatMapFunction<Iterator<I>, K, V> flatMapToPairFunc,
                                                                                 SerializableBiFunction<V, V, V> reduceFunc, int parallelism) {
    return throwingFlatMapToPairWrapper(flatMapToPairFunc).apply(data.parallel().iterator())
        .collect(Collectors.groupingBy(Pair::getKey)).entrySet().stream()
        .map(entry -> new ImmutablePair<>(entry.getKey(), entry.getValue().stream().map(
```

### DataFlowIssue
Stream might have already been linked or consumed
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/client/common/HoodieFlinkEngineContext.java`
#### Snippet
```java
      Stream<I> data, SerializablePairFlatMapFunction<Iterator<I>, K, V> flatMapToPairFunc,
      SerializableBiFunction<V, V, V> reduceFunc, int parallelism) {
    return throwingFlatMapToPairWrapper(flatMapToPairFunc).apply(data.parallel().iterator())
        .collect(Collectors.groupingBy(Pair::getKey)).entrySet().stream()
        .map(entry -> new ImmutablePair<>(entry.getKey(), entry.getValue().stream().map(
```

### DataFlowIssue
Method invocation `schema` may produce `NullPointerException`
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/SparkRDDReadClient.java`
#### Snippet
```java
      originalDF = sqlContextOpt.get().read().orc(uniquePaths.toArray(new String[uniquePaths.size()]));
    }
    StructType schema = originalDF.schema();
    JavaPairRDD<HoodieKey, Row> keyRowRDD = originalDF.javaRDD().mapToPair(row -> {
      HoodieKey key = new HoodieKey(row.getAs(HoodieRecord.RECORD_KEY_METADATA_FIELD),
```

### DataFlowIssue
Argument `workloadProfile` might be null
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/table/action/commit/BaseSparkCommitActionExecutor.java`
#### Snippet
```java
    final Partitioner partitioner = getPartitioner(workloadProfile);
    if (isWorkloadProfileNeeded()) {
      saveWorkloadProfileMetadataToInflight(workloadProfile, instantTime);
    }

```

### DataFlowIssue
The call to 'handleNullRecordKey' always fails, according to its method contracts
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/keygen/SimpleKeyGenerator.java`
#### Snippet
```java
    //       record-key field
    if (recordKeys[0] == null) {
      return handleNullRecordKey(null);
    } else {
      return requireNonNullNonEmptyKey(recordKeys[0].toString());
```

### DataFlowIssue
The call to 'handleNullRecordKey' always fails, according to its method contracts
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/keygen/SimpleKeyGenerator.java`
#### Snippet
```java
    //       record-key field
    if (recordKeyValues[0] == null) {
      return handleNullRecordKey(null);
    } else if (recordKeyValues[0] instanceof UTF8String) {
      return requireNonNullNonEmptyKey((UTF8String) recordKeyValues[0]);
```

### DataFlowIssue
Variable is already assigned to this value
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/io/HoodieMergeHandle.java`
#### Snippet
```java
        if (combinedRecord.isPresent() && combinedRecord.get().shouldIgnore(combineRecordSchema, props)) {
          // If it is an IGNORE_RECORD, just copy the old record, and do not update the new record.
          copyOldRecord = true;
        } else if (writeUpdateRecord(newRecord, oldRecord, combinedRecord, combineRecordSchema)) {
          /*
```

### DataFlowIssue
Unboxing of `deletedFileResult` may produce `NullPointerException`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/clean/CleanActionExecutor.java`
#### Snippet
```java
        // For Bootstrap Base file deletions, store the full file path.
        partitionCleanStat.addDeleteFilePatterns(deletePath.toString(), true);
        partitionCleanStat.addDeletedFileResult(deletePath.toString(), deletedFileResult, true);
      } else {
        partitionCleanStat.addDeleteFilePatterns(deletePath.getName(), false);
```

### DataFlowIssue
Unboxing of `deletedFileResult` may produce `NullPointerException`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/clean/CleanActionExecutor.java`
#### Snippet
```java
      } else {
        partitionCleanStat.addDeleteFilePatterns(deletePath.getName(), false);
        partitionCleanStat.addDeletedFileResult(deletePath.getName(), deletedFileResult, false);
      }
    });
```

### DataFlowIssue
Method invocation `getTotalCreateTime` may produce `NullPointerException`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/io/HoodieCreateHandle.java`
#### Snippet
```java
      LOG.info(String.format("CreateHandle for partitionPath %s fileID %s, took %d ms.",
          writeStatus.getStat().getPartitionPath(), writeStatus.getStat().getFileId(),
          writeStatus.getStat().getRuntimeStats().getTotalCreateTime()));

      return Collections.singletonList(writeStatus);
```

### DataFlowIssue
Variable is already assigned to this value
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/rollback/BaseRollbackHelper.java`
#### Snippet
```java
          } catch (FileNotFoundException e) {
            // if first rollback attempt failed and retried again, chances that some files are already deleted.
            isDeleted = true;
          }
        }
```

### DataFlowIssue
Method invocation `next` may produce `NullPointerException`
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/utils/ConcatenatingIterator.java`
#### Snippet
```java
  public T next() {
    ValidationUtils.checkArgument(hasNext(), "No more elements left");
    return allIterators.peek().next();
  }
}
```

### DataFlowIssue
Condition `actionMetadata.get() instanceof HoodieRollbackMetadata` is redundant and can be replaced with a null check
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metadata/HoodieBackedTableMetadataWriter.java`
#### Snippet
```java
    }

    final String INSTANT_ACTION = (actionMetadata.get() instanceof HoodieRollbackMetadata
        ? HoodieTimeline.ROLLBACK_ACTION
        : (actionMetadata.get() instanceof HoodieRestoreMetadata ? HoodieTimeline.RESTORE_ACTION : EMPTY_STRING));
```

### DataFlowIssue
Switch label `HoodieTimeline.RESTORE_ACTION` is unreachable
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metadata/HoodieBackedTableMetadataWriter.java`
#### Snippet
```java
        }
        break;
      case HoodieTimeline.RESTORE_ACTION:
        List<HoodieInstantInfo> restoredInstants =
            ((HoodieRestoreMetadata) actionMetadata.get()).getRestoreInstantInfo();
```

### DataFlowIssue
Variable is already assigned to this value
in `hudi-common/src/main/java/org/apache/hudi/common/util/PartitionPathEncodeUtils.java`
#### Snippet
```java
          code = Integer.parseInt(path.substring(i + 1, i + 3), 16);
        } catch (Exception e) {
          code = -1;
        }
        if (code >= 0) {
```

### DataFlowIssue
Method invocation `getElementType` may produce `NullPointerException`
in `hudi-common/src/main/java/org/apache/hudi/common/util/AvroOrcUtils.java`
#### Snippet
```java
        TypeDescription listType = type.getChildren().get(0);
        for (Object listItem : list) {
          addToVector(listType, listColVec.child, avroSchema.getElementType(), listItem, listColVec.childCount++);
        }
        break;
```

### DataFlowIssue
Method invocation `getValueType` may produce `NullPointerException`
in `hudi-common/src/main/java/org/apache/hudi/common/util/AvroOrcUtils.java`
#### Snippet
```java
              type.getChildren().get(1),
              mapColumnVector.values,
              avroSchema.getValueType(),
              entry.getValue(),
              mapColumnVector.childCount
```

### DataFlowIssue
Method invocation `getFields` may produce `NullPointerException`
in `hudi-common/src/main/java/org/apache/hudi/common/util/AvroOrcUtils.java`
#### Snippet
```java
          Object fieldValue = record.get(fieldName);
          TypeDescription fieldType = type.getChildren().get(i);
          addToVector(fieldType, structColVec.fields[i], avroSchema.getFields().get(i).schema(), fieldValue, vectorPos);
        }

```

### DataFlowIssue
Method invocation `getProp` may produce `NullPointerException`
in `hudi-common/src/main/java/org/apache/hudi/common/util/AvroOrcUtils.java`
#### Snippet
```java
        }
      case STRING:
        String stringType = avroSchema.getProp(GenericData.STRING_PROP);
        if (stringType == null || !stringType.equals(StringType.String)) {
          int stringLength = ((BytesColumnVector) colVector).length[vectorPos];
```

### DataFlowIssue
Method invocation `getScale` may produce `NullPointerException`
in `hudi-common/src/main/java/org/apache/hudi/common/util/AvroOrcUtils.java`
#### Snippet
```java
        BigDecimal bigDecimal = ((DecimalColumnVector) colVector).vector[vectorPos]
            .getHiveDecimal().bigDecimalValue()
            .setScale(((LogicalTypes.Decimal) logicalType).getScale());
        Schema.Type baseType = avroSchema.getType();
        if (baseType.equals(Schema.Type.FIXED)) {
```

### DataFlowIssue
Method invocation `getType` may produce `NullPointerException`
in `hudi-common/src/main/java/org/apache/hudi/common/util/AvroOrcUtils.java`
#### Snippet
```java
            .getHiveDecimal().bigDecimalValue()
            .setScale(((LogicalTypes.Decimal) logicalType).getScale());
        Schema.Type baseType = avroSchema.getType();
        if (baseType.equals(Schema.Type.FIXED)) {
          return new Conversions.DecimalConversion().toFixed(bigDecimal, avroSchema, logicalType);
```

### DataFlowIssue
Method invocation `getElementType` may produce `NullPointerException`
in `hudi-common/src/main/java/org/apache/hudi/common/util/AvroOrcUtils.java`
#### Snippet
```java
        TypeDescription childType = type.getChildren().get(0);
        for (int i = 0; i < listLength; i++) {
          list.add(readFromVector(childType, listVector.child, avroSchema.getElementType(), listOffset + i));
        }
        return list;
```

### DataFlowIssue
Method invocation `toString` may produce `NullPointerException`
in `hudi-common/src/main/java/org/apache/hudi/common/util/AvroOrcUtils.java`
#### Snippet
```java
        for (int i = 0; i < mapLength; i++) {
          map.put(
              readFromVector(type.getChildren().get(0), mapVector.keys, keySchema, i + mapOffset).toString(),
              readFromVector(type.getChildren().get(1), mapVector.values,
                  avroSchema.getValueType(), i + mapOffset));
```

### DataFlowIssue
Method invocation `getValueType` may produce `NullPointerException`
in `hudi-common/src/main/java/org/apache/hudi/common/util/AvroOrcUtils.java`
#### Snippet
```java
              readFromVector(type.getChildren().get(0), mapVector.keys, keySchema, i + mapOffset).toString(),
              readFromVector(type.getChildren().get(1), mapVector.values,
                  avroSchema.getValueType(), i + mapOffset));
        }
        return map;
```

### DataFlowIssue
Argument `avroSchema` might be null
in `hudi-common/src/main/java/org/apache/hudi/common/util/AvroOrcUtils.java`
#### Snippet
```java
        StructColumnVector structVector = (StructColumnVector) colVector;
        List<TypeDescription> children = type.getChildren();
        GenericData.Record record = new GenericData.Record(avroSchema);
        for (int i = 0; i < children.size(); i++) {
          record.put(i, readFromVector(children.get(i), structVector.fields[i],
```

### DataFlowIssue
Method invocation `getTypes` may produce `NullPointerException`
in `hudi-common/src/main/java/org/apache/hudi/common/util/AvroOrcUtils.java`
#### Snippet
```java
        int tag = unionVector.tags[vectorPos];
        ColumnVector fieldVector = unionVector.fields[tag];
        return readFromVector(type.getChildren().get(tag), fieldVector, avroSchema.getTypes().get(tag), vectorPos);
      default:
        throw new HoodieIOException("Unrecognized TypeDescription " + type.toString());
```

### DataFlowIssue
`null` is returned by the method declared as @Nonnull
in `hudi-common/src/main/java/org/apache/hudi/common/util/ParquetUtils.java`
#### Snippet
```java
    int scale = decimalMetadata.getScale();
    if (val == null) {
      return null;
    } else if (val instanceof Integer) {
      return BigDecimal.valueOf((Integer) val, scale);
```

### DataFlowIssue
Argument `incomingOrderingVal` might be null
in `hudi-common/src/main/java/org/apache/hudi/common/model/DefaultHoodieRecordPayload.java`
#### Snippet
```java
        orderField,
        true, consistentLogicalTimestampEnabled);
    return persistedOrderingVal == null || ((Comparable) persistedOrderingVal).compareTo(incomingOrderingVal) <= 0;
  }

```

### DataFlowIssue
Method invocation `keySet` may produce `NullPointerException`
in `hudi-common/src/main/java/org/apache/hudi/common/table/cdc/HoodieCDCExtractor.java`
#### Snippet
```java
      // this is a cdc log
      if (supplementalLoggingMode == data_before_after) {
        cdcFileSplit = new HoodieCDCFileSplit(instantTs, AS_IS, writeStat.getCdcStats().keySet());
      } else {
        try {
```

### DataFlowIssue
Method invocation `keySet` may produce `NullPointerException`
in `hudi-common/src/main/java/org/apache/hudi/common/table/cdc/HoodieCDCExtractor.java`
#### Snippet
```java
            beforeFileSlice = new FileSlice(fileGroupId, writeStat.getPrevCommit(), beforeBaseFile, new ArrayList<>());
          }
          cdcFileSplit = new HoodieCDCFileSplit(instantTs, AS_IS, writeStat.getCdcStats().keySet(),
              Option.ofNullable(beforeFileSlice), Option.ofNullable(currentFileSlice));
        } catch (Exception e) {
```

### DataFlowIssue
Method invocation `getLogBlockHeader` may produce `NullPointerException`
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/AbstractHoodieLogRecordReader.java`
#### Snippet
```java
                    numBlocksRolledBack++;
                  } else if (!targetInstantForCommandBlock
                      .contentEquals(currentInstantLogBlocks.peek().getLogBlockHeader().get(INSTANT_TIME))) {
                    // invalid or extra rollback block
                    LOG.warn("TargetInstantTime " + targetInstantForCommandBlock
```

### DataFlowIssue
Method invocation `getLogBlockHeader` may produce `NullPointerException`
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/AbstractHoodieLogRecordReader.java`
#### Snippet
```java
    return currentInstantLogBlocks.size() > 0 && currentInstantLogBlocks.peek().getBlockType() != CORRUPT_BLOCK
        && !logBlock.getLogBlockHeader().get(INSTANT_TIME)
        .contentEquals(currentInstantLogBlocks.peek().getLogBlockHeader().get(INSTANT_TIME));
  }

```

### DataFlowIssue
Method invocation `getBlockType` may produce `NullPointerException`
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/AbstractHoodieLogRecordReader.java`
#### Snippet
```java
      // poll the element at the bottom of the stack since that's the order it was inserted
      HoodieLogBlock lastBlock = logBlocks.pollLast();
      switch (lastBlock.getBlockType()) {
        case AVRO_DATA_BLOCK:
        case HFILE_DATA_BLOCK:
```

### DataFlowIssue
Stream might have already been linked or consumed
in `hudi-common/src/main/java/org/apache/hudi/common/table/timeline/TimelineLayout.java`
#### Snippet
```java
    @Override
    public Stream<HoodieInstant> filterHoodieInstants(Stream<HoodieInstant> instantStream) {
      return instantStream.collect(Collectors.groupingBy(instant -> Pair.of(instant.getTimestamp(),
          HoodieInstant.getComparableAction(instant.getAction())))).values().stream()
          .map(hoodieInstants -> hoodieInstants.stream().reduce((x, y) -> {
```

### DataFlowIssue
Stream might have already been linked or consumed
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/RocksDbBasedFileSystemView.java`
#### Snippet
```java

  private Stream<HoodieFileGroup> getFileGroups(Stream<FileSlice> sliceStream) {
    return sliceStream.map(s -> Pair.of(Pair.of(s.getPartitionPath(), s.getFileId()), s))
        .collect(Collectors.groupingBy(Pair::getKey)).entrySet().stream().map(slicePair -> {
          HoodieFileGroup fg = new HoodieFileGroup(slicePair.getKey().getKey(), slicePair.getKey().getValue(),
```

### DataFlowIssue
Method invocation `field` may produce `NullPointerException`
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/utils/InternalSchemaUtils.java`
#### Snippet
```java
    if (topParentFieldIds != null && !topParentFieldIds.isEmpty()) {
      for (int id : topParentFieldIds) {
        Types.Field f = recordType.field(id);
        if (f != null) {
          newFields.add(f);
```

### DataFlowIssue
Stream might have already been linked or consumed
in `hudi-common/src/main/java/org/apache/hudi/common/engine/HoodieLocalEngineContext.java`
#### Snippet
```java
      Stream<I> data, SerializablePairFlatMapFunction<Iterator<I>, K, V> flatMapToPairFunc,
      SerializableBiFunction<V, V, V> reduceFunc, int parallelism) {
    return throwingFlatMapToPairWrapper(flatMapToPairFunc).apply(data.parallel().iterator())
        .collect(Collectors.groupingBy(Pair::getKey)).entrySet().stream()
        .map(entry -> new ImmutablePair<>(entry.getKey(), entry.getValue().stream().map(
```

### DataFlowIssue
Method invocation `contains` may produce `NullPointerException`
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/utils/HoodieRealtimeInputFormatUtils.java`
#### Snippet
```java
    }

    if (!readColNames.contains(fieldName)) {
      // If not already in the list - then add it
      conf.set(ColumnProjectionUtils.READ_COLUMN_NAMES_CONF_STR, readColNamesPrefix + fieldName);
```

### DataFlowIssue
Method invocation `getChildren` may produce `NullPointerException`
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/SchemaEvolutionContext.java`
#### Snippet
```java
            ((ExprNodeColumnDesc)expr).setColumn(newColumn);
          }
          List<ExprNodeDesc> children = expr.getChildren();
          if (children != null) {
            exprNodes.addAll(children);
```

### DataFlowIssue
Casting `o` to `HoodieMetadataTableValidator.Config` will produce `ClassCastException` for any non-null value
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDataTableValidator.java`
#### Snippet
```java
        return false;
      }
      HoodieMetadataTableValidator.Config config = (HoodieMetadataTableValidator.Config) o;
      return basePath.equals(config.basePath)
          && Objects.equals(continuous, config.continuous)
```

### DataFlowIssue
Method invocation `process` may produce `NullPointerException`
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/JsonKafkaSource.java`
#### Snippet
```java
    }

    return processor.process(jsonStringRDD);
  }
}
```

### DataFlowIssue
Method invocation `getSourceSchema` may produce `NullPointerException`
in `hudi-kafka-connect/src/main/java/org/apache/hudi/connect/writers/KafkaConnectWriterProvider.java`
#### Snippet
```java
              KafkaConnectFileIdPrefixProvider.KAFKA_CONNECT_PARTITION_ID,
              String.valueOf(partition)))
          .withSchema(schemaProvider.getSourceSchema().toString())
          .withAutoCommit(false)
          .withIndexConfig(HoodieIndexConfig.newBuilder().withIndexType(HoodieIndex.IndexType.INMEMORY).build())
```

### DataFlowIssue
Method invocation `getRecordKey` may produce `NullPointerException`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/bulk/BulkInsertWriterHelper.java`
#### Snippet
```java
      String recordKey = preserveHoodieMetadata
          ? record.getString(HoodieRecord.RECORD_KEY_META_FIELD_ORD).toString()
          : keyGen.getRecordKey(record);
      String partitionPath = preserveHoodieMetadata
          ? record.getString(HoodieRecord.PARTITION_PATH_META_FIELD_ORD).toString()
```

### DataFlowIssue
Method invocation `getRecordKey` may produce `NullPointerException`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/bucket/BucketBulkInsertWriterHelper.java`
#### Snippet
```java
    try {
      RowData record = tuple.getRow(1, this.recordArity);
      String recordKey = keyGen.getRecordKey(record);
      String partitionPath = keyGen.getPartitionPath(record);
      String fileId = tuple.getString(0).toString();
```

### DataFlowIssue
Variable is already assigned to this value
in `hudi-spark-datasource/hudi-spark/src/test/java/HoodieJavaGenerateApp.java`
#### Snippet
```java
    if (enableHiveSync) {
      LOG.info("Enabling Hive sync to " + hiveJdbcUrl);
      writer = writer.option(META_SYNC_TABLE_NAME.key(), hiveTable)
          .option(META_SYNC_DATABASE_NAME.key(), hiveDB)
          .option(HIVE_URL.key(), hiveJdbcUrl)
```

### DataFlowIssue
Variable is already assigned to this value
in `hudi-spark-datasource/hudi-spark/src/test/java/HoodieJavaGenerateApp.java`
#### Snippet
```java
            .option(DataSourceWriteOptions.PARTITIONPATH_FIELD().key(), "");
      } else if (useMultiPartitionKeys) {
        writer = writer.option(HiveSyncConfig.META_SYNC_PARTITION_FIELDS.key(), "year,month,day").option(
            HiveSyncConfig.META_SYNC_PARTITION_EXTRACTOR_CLASS.key(),
            MultiPartKeysValueExtractor.class.getCanonicalName());
```

### DataFlowIssue
Variable is already assigned to this value
in `hudi-spark-datasource/hudi-spark/src/test/java/HoodieJavaGenerateApp.java`
#### Snippet
```java
            MultiPartKeysValueExtractor.class.getCanonicalName());
      } else {
        writer = writer.option(HiveSyncConfig.META_SYNC_PARTITION_FIELDS.key(), "dateStr").option(
            HiveSyncConfig.META_SYNC_PARTITION_EXTRACTOR_CLASS.key(),
            SlashEncodedDayPartitionValueExtractor.class.getCanonicalName());
```

### DataFlowIssue
Variable is already assigned to this value
in `hudi-spark-datasource/hudi-spark/src/test/java/HoodieJavaApp.java`
#### Snippet
```java
    if (enableHiveSync) {
      LOG.info("Enabling Hive sync to " + hiveJdbcUrl);
      writer = writer.option(META_SYNC_TABLE_NAME.key(), hiveTable)
          .option(META_SYNC_DATABASE_NAME.key(), hiveDB)
          .option(HIVE_URL.key(), hiveJdbcUrl)
```

### DataFlowIssue
Variable is already assigned to this value
in `hudi-spark-datasource/hudi-spark/src/test/java/HoodieJavaApp.java`
#### Snippet
```java
            .option(DataSourceWriteOptions.PARTITIONPATH_FIELD().key(), "");
      } else if (useMultiPartitionKeys) {
        writer = writer.option(HiveSyncConfig.META_SYNC_PARTITION_FIELDS.key(), "year,month,day").option(
            HiveSyncConfig.META_SYNC_PARTITION_EXTRACTOR_CLASS.key(),
            MultiPartKeysValueExtractor.class.getCanonicalName());
```

### DataFlowIssue
Variable is already assigned to this value
in `hudi-spark-datasource/hudi-spark/src/test/java/HoodieJavaApp.java`
#### Snippet
```java
            MultiPartKeysValueExtractor.class.getCanonicalName());
      } else {
        writer = writer.option(HiveSyncConfig.META_SYNC_PARTITION_FIELDS.key(), "dateStr").option(
            HiveSyncConfig.META_SYNC_PARTITION_EXTRACTOR_CLASS.key(),
            SlashEncodedDayPartitionValueExtractor.class.getCanonicalName());
```

### DataFlowIssue
Variable is already assigned to this value
in `hudi-spark-datasource/hudi-spark/src/test/java/HoodieJavaStreamingApp.java`
#### Snippet
```java
    if (enableHiveSync) {
      LOG.info("Enabling Hive sync to " + hiveJdbcUrl);
      writer = writer.option(META_SYNC_TABLE_NAME.key(), hiveTable)
          .option(META_SYNC_DATABASE_NAME.key(), hiveDB)
          .option(HIVE_URL.key(), hiveJdbcUrl)
```

### DataFlowIssue
Variable is already assigned to this value
in `hudi-spark-datasource/hudi-spark/src/test/java/HoodieJavaStreamingApp.java`
#### Snippet
```java
          .option(HIVE_SYNC_ENABLED.key(), "true");
      if (useMultiPartitionKeys) {
        writer = writer.option(HiveSyncConfig.META_SYNC_PARTITION_FIELDS.key(), "year,month,day").option(
            HiveSyncConfig.META_SYNC_PARTITION_EXTRACTOR_CLASS.key(),
            MultiPartKeysValueExtractor.class.getCanonicalName());
```

### DataFlowIssue
Variable is already assigned to this value
in `hudi-spark-datasource/hudi-spark/src/test/java/HoodieJavaStreamingApp.java`
#### Snippet
```java
            MultiPartKeysValueExtractor.class.getCanonicalName());
      } else {
        writer = writer.option(HiveSyncConfig.META_SYNC_PARTITION_FIELDS.key(), "dateStr").option(
            HiveSyncConfig.META_SYNC_PARTITION_EXTRACTOR_CLASS.key(),
            SlashEncodedDayPartitionValueExtractor.class.getCanonicalName());
```

## RuleId[ruleID=DeprecatedIsStillUsed]
### DeprecatedIsStillUsed
Deprecated member 'useJdbc' is still used
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/HiveSyncConfig.java`
#### Snippet
```java
    @Deprecated
    @Parameter(names = {"--use-jdbc"}, description = "Hive jdbc connect url")
    public Boolean useJdbc;
    @Parameter(names = {"--metastore-uris"}, description = "Hive metastore uris")
    public String metastoreUris;
```

### DeprecatedIsStillUsed
Deprecated member 'updateLocation' is still used
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/index/JavaHoodieIndex.java`
#### Snippet
```java
  @Deprecated
  @PublicAPIMethod(maturity = ApiMaturityLevel.DEPRECATED)
  public abstract List<WriteStatus> updateLocation(List<WriteStatus> writeStatuses,
                                                   HoodieEngineContext context,
                                                   HoodieTable hoodieTable) throws HoodieIndexException;
```

### DeprecatedIsStillUsed
Deprecated member 'tagLocation' is still used
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/index/JavaHoodieIndex.java`
#### Snippet
```java
  @Deprecated
  @PublicAPIMethod(maturity = ApiMaturityLevel.DEPRECATED)
  public abstract List<HoodieRecord<T>> tagLocation(List<HoodieRecord<T>> records,
                                                    HoodieEngineContext context,
                                                    HoodieTable hoodieTable) throws HoodieIndexException;
```

### DeprecatedIsStillUsed
Deprecated member 'updateLocation' is still used
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/index/FlinkHoodieIndex.java`
#### Snippet
```java
  @Deprecated
  @PublicAPIMethod(maturity = ApiMaturityLevel.DEPRECATED)
  public abstract List<WriteStatus> updateLocation(List<WriteStatus> writeStatuses,
                                                   HoodieEngineContext context,
                                                   HoodieTable hoodieTable) throws HoodieIndexException;
```

### DeprecatedIsStillUsed
Deprecated member 'tagLocation' is still used
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/index/FlinkHoodieIndex.java`
#### Snippet
```java
  @Deprecated
  @PublicAPIMethod(maturity = ApiMaturityLevel.DEPRECATED)
  public abstract List<HoodieRecord<T>> tagLocation(List<HoodieRecord<T>> records,
                                                    HoodieEngineContext context,
                                                    HoodieTable hoodieTable) throws HoodieIndexException;
```

### DeprecatedIsStillUsed
Deprecated member 'updateLocation' is still used
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/index/SparkHoodieIndex.java`
#### Snippet
```java
  @Deprecated
  @PublicAPIMethod(maturity = ApiMaturityLevel.DEPRECATED)
  public abstract JavaRDD<WriteStatus> updateLocation(JavaRDD<WriteStatus> writeStatusRDD,
                                                      HoodieEngineContext context,
                                                      HoodieTable hoodieTable) throws HoodieIndexException;
```

### DeprecatedIsStillUsed
Deprecated member 'HoodieReadClient' is still used
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/HoodieReadClient.java`
#### Snippet
```java
 */
@Deprecated
public class HoodieReadClient<T> extends SparkRDDReadClient<T> {

  public HoodieReadClient(HoodieSparkEngineContext context, String basePath) {
```

### DeprecatedIsStillUsed
Deprecated member 'LOCK_PROVIDER_CLASS_PROP' is still used
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/config/HoodieLockConfig.java`
#### Snippet
```java
  /** @deprecated Use {@link #LOCK_PROVIDER_CLASS_NAME} and its methods instead */
  @Deprecated
  public static final String LOCK_PROVIDER_CLASS_PROP = LOCK_PROVIDER_CLASS_NAME.key();
  /** @deprecated Use {@link #LOCK_PROVIDER_CLASS_NAME} and its methods instead */
  @Deprecated
```

### DeprecatedIsStillUsed
Deprecated member 'getBlock' is still used
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/block/HoodieAvroDataBlock.java`
#### Snippet
```java
   */
  @Deprecated
  public static HoodieAvroDataBlock getBlock(byte[] content, Schema readerSchema, InternalSchema internalSchema) throws IOException {

    SizeAwareDataInputStream dis = new SizeAwareDataInputStream(new DataInputStream(new ByteArrayInputStream(content)));
```

### DeprecatedIsStillUsed
Deprecated member 'DEFAULT_ACQUIRE_LOCK_WAIT_TIMEOUT_MS' is still used
in `hudi-common/src/main/java/org/apache/hudi/common/config/LockConfiguration.java`
#### Snippet
```java
  public static final String LOCK_ACQUIRE_WAIT_TIMEOUT_MS_PROP = LOCK_ACQUIRE_WAIT_TIMEOUT_MS_PROP_KEY;
  @Deprecated
  public static final int DEFAULT_ACQUIRE_LOCK_WAIT_TIMEOUT_MS = 60 * 1000;
  /** @deprecated Use {@link #HIVE_DATABASE_NAME_PROP_KEY} */
  @Deprecated
```

### DeprecatedIsStillUsed
Deprecated member 'MetadataRecordsGenerationParams' is still used
in `hudi-common/src/main/java/org/apache/hudi/metadata/MetadataRecordsGenerationParams.java`
#### Snippet
```java
 */
@Deprecated
public class MetadataRecordsGenerationParams implements Serializable {

  private final HoodieTableMetaClient dataMetaClient;
```

### DeprecatedIsStillUsed
Deprecated member 'HoodieAvroParquetReaderBuilder' is still used
in `hudi-common/src/main/java/org/apache/parquet/avro/HoodieAvroParquetReaderBuilder.java`
#### Snippet
```java

  @Deprecated
  public HoodieAvroParquetReaderBuilder(Path path) {
    super(path);
  }
```

### DeprecatedIsStillUsed
Deprecated member 'HoodieSnapshotCopier' is still used
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieSnapshotCopier.java`
#### Snippet
```java
 * @deprecated Use {@link HoodieSnapshotExporter} instead.
 */
public class HoodieSnapshotCopier implements Serializable {

  private static final Logger LOG = LogManager.getLogger(HoodieSnapshotCopier.class);
```

### DeprecatedIsStillUsed
Deprecated member 'READ_LATEST_INSTANT_ON_MISSING_CKPT' is still used
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/HoodieIncrSource.java`
#### Snippet
```java
     */
    @Deprecated
    public static final String READ_LATEST_INSTANT_ON_MISSING_CKPT =
        "hoodie.deltastreamer.source.hoodieincr.read_latest_on_missing_ckpt";
    public static final Boolean DEFAULT_READ_LATEST_INSTANT_ON_MISSING_CKPT = false;
```

### DeprecatedIsStillUsed
Deprecated member 'getNextFilePathsAndMaxModificationTime' is still used
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/helpers/DFSPathSelector.java`
#### Snippet
```java
   */
  @Deprecated
  public Pair<Option<String>, String> getNextFilePathsAndMaxModificationTime(Option<String> lastCheckpointStr,
                                                                             long sourceLimit) {
    try {
```

### DeprecatedIsStillUsed
Deprecated member 'targetTableName' is still used
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/HoodieMultiTableDeltaStreamer.java`
#### Snippet
```java
    @Deprecated
    @Parameter(names = {"--target-table"}, description = "name of the target table")
    public String targetTableName;

    @Parameter(names = {"--table-type"}, description = "Type of table. COPY_ON_WRITE (or) MERGE_ON_READ", required = true)
```

### DeprecatedIsStillUsed
Deprecated member 'HDFSParquetImporter' is still used
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HDFSParquetImporter.java`
#### Snippet
```java
 * @see HoodieDeltaStreamer
 */
public class HDFSParquetImporter implements Serializable {

  private static final long serialVersionUID = 1L;
```

### DeprecatedIsStillUsed
Deprecated member 'getTableAvroSchemaWithoutMetadataFields' is still used
in `hudi-common/src/main/java/org/apache/hudi/common/table/TableSchemaResolver.java`
#### Snippet
```java
   */
  @Deprecated
  public Schema getTableAvroSchemaWithoutMetadataFields() throws Exception {
    return getTableAvroSchema(false);
  }
```

### DeprecatedIsStillUsed
Deprecated member 'CustomKeyGenerator' is still used
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/keygen/CustomKeyGenerator.java`
#### Snippet
```java
 */
@Deprecated
public class CustomKeyGenerator extends BuiltinKeyGenerator {

  private final CustomAvroKeyGenerator customAvroKeyGenerator;
```

## RuleId[ruleID=Convert2MethodRef]
### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-cli/src/main/java/org/apache/hudi/cli/HoodiePrintHelper.java`
#### Snippet
```java
    if (!StringUtils.isNullOrEmpty(tempTableName)) {
      HoodieCLI.getTempViewProvider().createOrReplace(tempTableName, rowHeader.getFieldNames(),
          rows.stream().map(columns -> Arrays.asList(columns)).collect(Collectors.toList()));
    }

```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/ddl/JDBCExecutor.java`
#### Snippet
```java
    LOG.info("Adding partitions " + partitionsToDrop.size() + " to table " + tableName);
    List<String> sqls = constructDropPartitions(tableName, partitionsToDrop);
    sqls.stream().forEach(sql -> runSQL(sql));
  }

```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/ddl/QueryBasedDDLExecutor.java`
#### Snippet
```java
    LOG.info("Adding partitions " + partitionsToAdd.size() + " to table " + tableName);
    List<String> sqls = constructAddPartitions(tableName, partitionsToAdd);
    sqls.stream().forEach(sql -> runSQL(sql));
  }

```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/table/action/commit/JavaInsertOverwriteTableCommitActionExecutor.java`
#### Snippet
```java
  protected List<String> getAllExistingFileIds(String partitionPath) {
    return table.getSliceView().getLatestFileSlices(partitionPath)
        .map(fg -> fg.getFileId()).distinct().collect(Collectors.toList());
  }

```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/table/action/commit/JavaInsertOverwriteCommitActionExecutor.java`
#### Snippet
```java
  private List<String> getAllExistingFileIds(String partitionPath) {
    // because new commit is not complete. it is safe to mark all existing file Ids as old files
    return table.getSliceView().getLatestFileSlices(partitionPath).map(fg -> fg.getFileId()).distinct().collect(Collectors.toList());
  }
}
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/table/action/commit/BaseJavaCommitActionExecutor.java`
#### Snippet
```java
        .collect(Collectors.groupingBy(x -> partitioner.getPartition(x.getLeft())));
    Map<Integer, List<HoodieRecord<T>>> results = new LinkedHashMap<>();
    partitionedMidRecords.forEach((key, value) -> results.put(key, value.stream().map(x -> x.getRight()).collect(Collectors.toList())));
    return results;
  }
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/client/common/HoodieJavaEngineContext.java`
#### Snippet
```java
      List<Pair<K, V>> data, SerializableBiFunction<V, V, V> reduceFunc, int parallelism) {
    return data.stream().parallel()
        .collect(Collectors.groupingBy(p -> p.getKey())).values().stream()
        .map(list -> list.stream().map(e -> e.getValue()).reduce(throwingReduceWrapper(reduceFunc)).orElse(null))
        .filter(Objects::nonNull)
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/client/common/HoodieJavaEngineContext.java`
#### Snippet
```java
    return data.stream().parallel()
        .collect(Collectors.groupingBy(p -> p.getKey())).values().stream()
        .map(list -> list.stream().map(e -> e.getValue()).reduce(throwingReduceWrapper(reduceFunc)).orElse(null))
        .filter(Objects::nonNull)
        .collect(Collectors.toList());
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/client/common/HoodieJavaEngineContext.java`
#### Snippet
```java
  public <I, K, V> List<V> mapToPairAndReduceByKey(List<I> data, SerializablePairFunction<I, K, V> mapToPairFunc, SerializableBiFunction<V, V, V> reduceFunc, int parallelism) {
    return data.stream().parallel().map(throwingMapToPairWrapper(mapToPairFunc))
        .collect(Collectors.groupingBy(p -> p.getKey())).values().stream()
        .map(list -> list.stream().map(e -> e.getValue()).reduce(throwingReduceWrapper(reduceFunc)).get())
        .collect(Collectors.toList());
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/client/common/HoodieJavaEngineContext.java`
#### Snippet
```java
    return data.stream().parallel().map(throwingMapToPairWrapper(mapToPairFunc))
        .collect(Collectors.groupingBy(p -> p.getKey())).values().stream()
        .map(list -> list.stream().map(e -> e.getValue()).reduce(throwingReduceWrapper(reduceFunc)).get())
        .collect(Collectors.toList());
  }
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/data/HoodieJavaRDD.java`
#### Snippet
```java
    // NOTE: Unrolling this lambda into a method reference results in [[ClassCastException]]
    //       due to weird interop b/w Scala and Java
    return HoodieJavaRDD.of(rddData.flatMap(e -> func.apply(e)));
  }

```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/client/common/HoodieFlinkEngineContext.java`
#### Snippet
```java
  public <I, K, V> List<V> mapToPairAndReduceByKey(List<I> data, SerializablePairFunction<I, K, V> mapToPairFunc, SerializableBiFunction<V, V, V> reduceFunc, int parallelism) {
    return data.stream().parallel().map(throwingMapToPairWrapper(mapToPairFunc))
        .collect(Collectors.groupingBy(p -> p.getKey())).values().stream()
        .map(list -> list.stream().map(e -> e.getValue()).reduce(throwingReduceWrapper(reduceFunc)).orElse(null))
        .filter(Objects::nonNull)
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/client/common/HoodieFlinkEngineContext.java`
#### Snippet
```java
    return data.stream().parallel().map(throwingMapToPairWrapper(mapToPairFunc))
        .collect(Collectors.groupingBy(p -> p.getKey())).values().stream()
        .map(list -> list.stream().map(e -> e.getValue()).reduce(throwingReduceWrapper(reduceFunc)).orElse(null))
        .filter(Objects::nonNull)
        .collect(Collectors.toList());
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/client/common/HoodieFlinkEngineContext.java`
#### Snippet
```java
      List<Pair<K, V>> data, SerializableBiFunction<V, V, V> reduceFunc, int parallelism) {
    return data.stream().parallel()
        .collect(Collectors.groupingBy(p -> p.getKey())).values().stream()
        .map(list -> list.stream().map(e -> e.getValue()).reduce(throwingReduceWrapper(reduceFunc)).orElse(null))
        .filter(Objects::nonNull)
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/client/common/HoodieFlinkEngineContext.java`
#### Snippet
```java
    return data.stream().parallel()
        .collect(Collectors.groupingBy(p -> p.getKey())).values().stream()
        .map(list -> list.stream().map(e -> e.getValue()).reduce(throwingReduceWrapper(reduceFunc)).orElse(null))
        .filter(Objects::nonNull)
        .collect(Collectors.toList());
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/utils/SparkInternalSchemaConverter.java`
#### Snippet
```java
        .entrySet()
        .stream()
        .collect(Collectors.toMap(e -> e.getKey(), e -> Pair.of(constructSparkSchemaFromType(e.getValue().getLeft()), constructSparkSchemaFromType(e.getValue().getRight()))));
  }

```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/execution/bulkinsert/RDDConsistentBucketPartitioner.java`
#### Snippet
```java
  private Map<String, ConsistentBucketIdentifier> initializeBucketIdentifier(JavaRDD<HoodieRecord<T>> records) {
    return records.map(HoodieRecord::getPartitionPath).distinct().collect().stream()
        .collect(Collectors.toMap(p -> p, p -> getBucketIdentifier(p)));
  }

```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/clean/CleanActionExecutor.java`
#### Snippet
```java
      try {
        FileBasedInternalSchemaStorageManager fss = new FileBasedInternalSchemaStorageManager(table.getMetaClient());
        fss.cleanOldFiles(pendingCleanInstants.stream().map(is -> is.getTimestamp()).collect(Collectors.toList()));
      } catch (Exception e) {
        // we should not affect original clean logic. Swallow exception and log warn.
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/cluster/strategy/ClusteringPlanStrategy.java`
#### Snippet
```java
        .setDataFilePath(slice.getBaseFile().map(BaseFile::getPath).orElse(StringUtils.EMPTY_STRING))
        .setDeltaFilePaths(slice.getLogFiles().map(f -> f.getPath().toString()).collect(Collectors.toList()))
        .setBootstrapFilePath(slice.getBaseFile().map(bf -> bf.getBootstrapBaseFile().map(bbf -> bbf.getPath()).orElse(StringUtils.EMPTY_STRING)).orElse(StringUtils.EMPTY_STRING))
        .build()).collect(Collectors.toList());
  }
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/HoodieTimelineArchiver.java`
#### Snippet
```java
      context.foreach(
          pendingInstants,
          instant -> activeTimeline.deleteInstantFileIfExists(instant),
          Math.min(pendingInstants.size(), config.getArchiveDeleteParallelism())
      );
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/HoodieTimelineArchiver.java`
#### Snippet
```java
      context.foreach(
          completedInstants,
          instant -> activeTimeline.deleteInstantFileIfExists(instant),
          Math.min(completedInstants.size(), config.getArchiveDeleteParallelism())
      );
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/BaseHoodieTableServiceClient.java`
#### Snippet
```java
    final Timer.Context timerContext = metrics.getCleanCtx();
    CleanerUtils.rollbackFailedWrites(config.getFailedWritesCleanPolicy(),
        HoodieTimeline.CLEAN_ACTION, () -> rollbackFailedWrites());

    HoodieTable table = createTable(config, hadoopConf);
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-common/src/main/java/org/apache/hudi/common/fs/FSUtils.java`
#### Snippet
```java
          levelPaths)
          .values().stream()
          .flatMap(list -> list.stream()).collect(Collectors.toList());
      if (i < expectLevel) {
        levelPaths = result.stream()
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-common/src/main/java/org/apache/hudi/common/util/CommitUtils.java`
#### Snippet
```java

    LOG.info("Creating  metadata for " + operationType + " numWriteStats:" + writeStats.size()
        + " numReplaceFileIds:" + partitionToReplaceFileIds.values().stream().mapToInt(e -> e.size()).sum());
    return commitMetadata;
  }
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-common/src/main/java/org/apache/hudi/common/model/ClusteringGroupInfo.java`
#### Snippet
```java
  
  private String getFilePathsInGroup() {
    return getOperations().stream().map(op -> op.getDataFilePath()).collect(Collectors.joining(","));
  }
}
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/IncrementalTimelineSyncFileSystemView.java`
#### Snippet
```java
    partitionFiles.entrySet().stream().forEach(e -> {
      removeFileSlicesForPartition(timeline, instant, e.getKey(),
          e.getValue().stream().map(x -> x.getValue()).collect(Collectors.toList()));
    });

```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/IncrementalTimelineSyncFileSystemView.java`
#### Snippet
```java
        break;
      case REMOVE:
        deltaDataFiles.keySet().stream().forEach(p -> viewDataFiles.remove(p));
        deltaLogFiles.keySet().stream().forEach(p -> viewLogFiles.remove(p));
        break;
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/IncrementalTimelineSyncFileSystemView.java`
#### Snippet
```java
      case REMOVE:
        deltaDataFiles.keySet().stream().forEach(p -> viewDataFiles.remove(p));
        deltaLogFiles.keySet().stream().forEach(p -> viewLogFiles.remove(p));
        break;
      default:
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/IncrementalTimelineSyncFileSystemView.java`
#### Snippet
```java
    }

    HoodieTimeline timeline = deltaFileGroups.stream().map(df -> df.getTimeline()).findAny().get();
    List<HoodieFileGroup> fgs =
        buildFileGroups(viewDataFiles.values().stream(), viewLogFiles.values().stream(), timeline, true);
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-common/src/main/java/org/apache/hudi/common/table/timeline/dto/FileGroupDTO.java`
#### Snippet
```java
    HoodieFileGroup fileGroup =
        new HoodieFileGroup(dto.partition, dto.id, TimelineDTO.toTimeline(dto.timeline, metaClient));
    dto.slices.stream().map(FileSliceDTO::toFileSlice).forEach(fileSlice -> fileGroup.addFileSlice(fileSlice));
    return fileGroup;
  }
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/Types.java`
#### Snippet
```java
    @Override
    public String toString() {
      return String.format("Record<%s>", Arrays.stream(fields).map(f -> f.toString()).collect(Collectors.joining("-")));
    }

```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/io/FileBasedInternalSchemaStorageManager.java`
#### Snippet
```java
      FileSystem fs = baseSchemaPath.getFileSystem(conf);
      if (fs.exists(baseSchemaPath)) {
        List<String> candidateSchemaFiles = Arrays.stream(fs.listStatus(baseSchemaPath)).filter(f -> f.isFile())
            .map(file -> file.getPath().getName()).collect(Collectors.toList());
        List<String> residualSchemaFiles = candidateSchemaFiles.stream().filter(f -> !validateCommits.contains(f.split("\\.")[0])).collect(Collectors.toList());
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/io/FileBasedInternalSchemaStorageManager.java`
#### Snippet
```java
  private List<String> getValidInstants() {
    return getMetaClient().getCommitsTimeline()
        .filterCompletedInstants().getInstantsAsStream().map(f -> f.getTimestamp()).collect(Collectors.toList());
  }

```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/io/FileBasedInternalSchemaStorageManager.java`
#### Snippet
```java
      FileSystem fs = baseSchemaPath.getFileSystem(conf);
      if (fs.exists(baseSchemaPath)) {
        List<String> candidateSchemaFiles = Arrays.stream(fs.listStatus(baseSchemaPath)).filter(f -> f.isFile())
            .map(file -> file.getPath().getName()).collect(Collectors.toList());
        List<String> validateSchemaFiles = candidateSchemaFiles.stream().filter(f -> validateCommits.contains(f.split("\\.")[0])).collect(Collectors.toList());
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/action/InternalSchemaChangeApplier.java`
#### Snippet
```java
  public InternalSchema applyDeleteChange(String... colNames) {
    TableChanges.ColumnDeleteChange delete = TableChanges.ColumnDeleteChange.get(latestSchema);
    Arrays.stream(colNames).forEach(colName -> delete.deleteColumn(colName));
    return SchemaChangeUtils.applyTableChanges2Schema(latestSchema, delete);
  }
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/utils/InternalSchemaUtils.java`
#### Snippet
```java
    Set<Integer> otherIds = oldSchema.getAllIds();
    Map<Integer, Pair<Type, Type>> result = new HashMap<>();
    ids.stream().filter(f -> otherIds.contains(f)).forEach(f -> {
      if (!schema.findType(f).equals(oldSchema.findType(f))) {
        String[] fieldNameParts = schema.findfullName(f).split("\\.");
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/utils/InternalSchemaUtils.java`
#### Snippet
```java
        if (fieldNameParts.length == otherFieldNameParts.length && schema.findIdByName(parentName) == oldSchema.findIdByName(otherParentName)) {
          int index = schema.findIdByName(parentName);
          int position = schema.getRecord().fields().stream().map(s -> s.fieldId()).collect(Collectors.toList()).indexOf(index);
          if (!result.containsKey(position)) {
            result.put(position, Pair.of(schema.findType(parentName), oldSchema.findType(otherParentName)));
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-common/src/main/java/org/apache/hudi/common/engine/HoodieLocalEngineContext.java`
#### Snippet
```java
      List<I> data, SerializablePairFunction<I, K, V> mapToPairFunc, SerializableBiFunction<V, V, V> reduceFunc, int parallelism) {
    return data.stream().parallel().map(throwingMapToPairWrapper(mapToPairFunc))
        .collect(Collectors.groupingBy(p -> p.getKey())).values().stream()
        .map(list -> list.stream().map(e -> e.getValue()).reduce(throwingReduceWrapper(reduceFunc)).get())
        .collect(Collectors.toList());
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-common/src/main/java/org/apache/hudi/common/engine/HoodieLocalEngineContext.java`
#### Snippet
```java
    return data.stream().parallel().map(throwingMapToPairWrapper(mapToPairFunc))
        .collect(Collectors.groupingBy(p -> p.getKey())).values().stream()
        .map(list -> list.stream().map(e -> e.getValue()).reduce(throwingReduceWrapper(reduceFunc)).get())
        .collect(Collectors.toList());
  }
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-common/src/main/java/org/apache/hudi/common/engine/HoodieLocalEngineContext.java`
#### Snippet
```java
      List<Pair<K, V>> data, SerializableBiFunction<V, V, V> reduceFunc, int parallelism) {
    return data.stream().parallel()
        .collect(Collectors.groupingBy(p -> p.getKey())).values().stream()
        .map(list -> list.stream().map(e -> e.getValue()).reduce(throwingReduceWrapper(reduceFunc)).orElse(null))
        .filter(Objects::nonNull)
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-common/src/main/java/org/apache/hudi/common/engine/HoodieLocalEngineContext.java`
#### Snippet
```java
    return data.stream().parallel()
        .collect(Collectors.groupingBy(p -> p.getKey())).values().stream()
        .map(list -> list.stream().map(e -> e.getValue()).reduce(throwingReduceWrapper(reduceFunc)).orElse(null))
        .filter(Objects::nonNull)
        .collect(Collectors.toList());
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-examples/hudi-examples-java/src/main/java/org/apache/hudi/examples/java/HoodieJavaWriteClientExample.java`
#### Snippet
```java
    List<HoodieRecord<HoodieAvroPayload>> recordsSoFar = new ArrayList<>(records);
    List<HoodieRecord<HoodieAvroPayload>> writeRecords =
        recordsSoFar.stream().map(r -> new HoodieAvroRecord<HoodieAvroPayload>(r)).collect(Collectors.toList());
    client.insert(writeRecords, newCommitTime);

```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-examples/hudi-examples-java/src/main/java/org/apache/hudi/examples/java/HoodieJavaWriteClientExample.java`
#### Snippet
```java
    recordsSoFar.addAll(toBeUpdated);
    writeRecords =
        recordsSoFar.stream().map(r -> new HoodieAvroRecord<HoodieAvroPayload>(r)).collect(Collectors.toList());
    client.upsert(writeRecords, newCommitTime);

```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-examples/hudi-examples-spark/src/main/java/org/apache/hudi/examples/spark/HoodieWriteClientExample.java`
#### Snippet
```java
      LOG.info("Starting commit " + newCommitTime);
      // The partition where the data needs to be deleted
      List<String> partitionList = toBeDeleted.stream().map(s -> s.getPartitionPath()).distinct().collect(Collectors.toList());
      List<String> deleteList = recordsSoFar.stream().filter(f -> !partitionList.contains(f.getPartitionPath()))
          .map(m -> m.getKey().getPartitionPath()).distinct().collect(Collectors.toList());
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/HoodieColumnProjectionUtils.java`
#### Snippet
```java
    if (colTypes != null && !colTypes.isEmpty()) {
      return TypeInfoUtils.getTypeInfosFromTypeString(colTypes).stream()
          .map(t -> t.getTypeName()).collect(Collectors.toList());
    }
    return new ArrayList<>();
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/HoodieCopyOnWriteTableInputFormat.java`
#### Snippet
```java
              .stream()
              .flatMap(Collection::stream)
              .filter(fileSlice -> checkIfValidFileSlice(fileSlice))
              .map(fileSlice -> createFileStatusUnchecked(fileSlice, fileIndex, tableMetaClient))
              .collect(Collectors.toList())
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/hive/HoodieCombineRealtimeFileSplit.java`
#### Snippet
```java
  /** Returns all the Paths in the split. */
  public Path[] getPaths() {
    return realtimeFileSplits.stream().map(x -> x.getPath()).toArray(Path[]::new);
  }

```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/utils/HiveAvroSerializer.java`
#### Snippet
```java
      } catch (Exception e) {
        LOG.error(String.format("current columnNames: %s", columnNames.stream().collect(Collectors.joining(","))));
        LOG.error(String.format("current type: %s", columnTypes.stream().map(f -> f.getTypeName()).collect(Collectors.joining(","))));
        LOG.error(String.format("current value: %s", HoodieRealtimeRecordReaderUtils.arrayWritableToString((ArrayWritable) o)));
        throw e;
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieTableMetadataUtil.java`
#### Snippet
```java

    Collector<HoodieColumnRangeMetadata<Comparable>, ?, Map<String, HoodieColumnRangeMetadata<Comparable>>> collector =
        Collectors.toMap(colRangeMetadata -> colRangeMetadata.getColumnName(), Function.identity());

    return (Map<String, HoodieColumnRangeMetadata<Comparable>>) targetFields.stream()
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieTableMetadataUtil.java`
#### Snippet
```java
      String instantTime, MetadataRecordsGenerationParams recordsGenerationParams) {
    final List<HoodieWriteStat> allWriteStats = commitMetadata.getPartitionToWriteStats().values().stream()
        .flatMap(entry -> entry.stream()).collect(Collectors.toList());
    if (allWriteStats.isEmpty()) {
      return context.emptyHoodieData();
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDataTableUtils.java`
#### Snippet
```java
    return tableMetadata.getAllFilesInPartitions(allPartitionPaths).values().stream()
        .map(fileStatuses ->
            Arrays.stream(fileStatuses).map(fileStatus -> fileStatus.getPath()).collect(Collectors.toList()))
        .flatMap(list -> list.stream())
        .collect(Collectors.toList());
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDataTableUtils.java`
#### Snippet
```java
        .map(fileStatuses ->
            Arrays.stream(fileStatuses).map(fileStatus -> fileStatus.getPath()).collect(Collectors.toList()))
        .flatMap(list -> list.stream())
        .collect(Collectors.toList());
  }
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/realtime/HoodieMergeOnReadTableInputFormat.java`
#### Snippet
```java
        // add file group which has only logs.
        if (f.getLatestFileSlice().isPresent() && baseFiles.isEmpty()) {
          List<FileStatus> logFileStatus = f.getLatestFileSlice().get().getLogFiles().map(logFile -> logFile.getFileStatus()).collect(Collectors.toList());
          if (logFileStatus.size() > 0) {
            List<HoodieLogFile> deltaLogFiles = logFileStatus.stream().map(l -> new HoodieLogFile(l.getPath(), l.getLen())).collect(Collectors.toList());
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/realtime/HoodieMergeOnReadTableInputFormat.java`
#### Snippet
```java
    }
    List<HoodieFileGroup> fileGroups = affectedPartition.stream()
        .flatMap(partitionPath -> fsView.getAllFileGroups(partitionPath)).collect(Collectors.toList());
    // step4
    setInputPaths(job, affectedPartition.stream()
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDropPartitionsTool.java`
#### Snippet
```java
      List<String> parts = Arrays.asList(cfg.partitions.split(","));
      Map<String, List<String>> partitionToReplaceFileIds = jsc.parallelize(parts, parts.size()).distinct()
          .mapToPair(partitionPath -> new Tuple2<>(partitionPath, table.getSliceView().getLatestFileSlices(partitionPath).map(fg -> fg.getFileId()).distinct().collect(Collectors.toList())))
          .collectAsMap();
      printDeleteFilesInfo(partitionToReplaceFileIds);
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/DeltaSync.java`
#### Snippet
```java
        break;
      case DELETE_PARTITION:
        List<String> partitions = records.map(record -> record.getPartitionPath()).distinct().collect();
        writeStatusRDD = writeClient.deletePartitions(partitions, instantTime).getWriteStatuses();
        break;
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-spark-datasource/hudi-spark/src/main/java/org/apache/hudi/QuickstartUtils.java`
#### Snippet
```java
              ? convertToString(row.getAs("uuid"), row.getAs("partitionpath"), null) :
              convertToString(row.getAs("uuid"), row.getAs("partitionpath"), row.getAs("ts"))
          ).filter(os -> os.isPresent()).map(os -> os.get())
          .collect(Collectors.toList());
    }
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-spark-datasource/hudi-spark/src/main/java/org/apache/hudi/QuickstartUtils.java`
#### Snippet
```java
              ? convertToString(row.getAs("uuid"), row.getAs("partitionpath"), null) :
              convertToString(row.getAs("uuid"), row.getAs("partitionpath"), row.getAs("ts"))
          ).filter(os -> os.isPresent()).map(os -> os.get())
          .collect(Collectors.toList());
    }
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-spark-datasource/hudi-spark/src/main/java/org/apache/hudi/QuickstartUtils.java`
#### Snippet
```java

  public static List<String> convertToStringList(List<HoodieRecord> records) {
    return records.stream().map(hr -> convertToString(hr)).filter(os -> os.isPresent()).map(os -> os.get())
        .collect(Collectors.toList());
  }
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-spark-datasource/hudi-spark/src/main/java/org/apache/hudi/QuickstartUtils.java`
#### Snippet
```java

  public static List<String> convertToStringList(List<HoodieRecord> records) {
    return records.stream().map(hr -> convertToString(hr)).filter(os -> os.isPresent()).map(os -> os.get())
        .collect(Collectors.toList());
  }
```

### Convert2MethodRef
Lambda can be replaced with method reference
in `hudi-spark-datasource/hudi-spark/src/main/java/org/apache/hudi/QuickstartUtils.java`
#### Snippet
```java

  public static List<String> convertToStringList(List<HoodieRecord> records) {
    return records.stream().map(hr -> convertToString(hr)).filter(os -> os.isPresent()).map(os -> os.get())
        .collect(Collectors.toList());
  }
```

## RuleId[ruleID=ComparatorCombinators]
### ComparatorCombinators
Can be replaced with 'Comparator.comparing'
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/execution/bulkinsert/RDDPartitionSortPartitioner.java`
#### Snippet
```java
            recordList.add(partition.next());
          }
          Collections.sort(recordList, (o1, o2) -> o1._1.compareTo(o2._1));
          return recordList.stream().map(e -> e._2).iterator();
        });
```

### ComparatorCombinators
Can be replaced with 'Comparator.comparing'
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/LazyFileIterable.java`
#### Snippet
```java
      // sort the map in increasing order of offset of value so disk seek is only in one(forward) direction
      this.metadataIterator = map.entrySet().stream()
          .sorted((Map.Entry<T, BitCaskDiskMap.ValueMetadata> o1, Map.Entry<T, BitCaskDiskMap.ValueMetadata> o2) -> o1
              .getValue().getOffsetOfValue().compareTo(o2.getValue().getOffsetOfValue()))
          .collect(Collectors.toList()).iterator();
      this.addShutdownHook();
```

### ComparatorCombinators
Can be replaced with 'Comparator.comparingInt'
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/utils/AvroSchemaEvolutionUtils.java`
#### Snippet
```java
                  && c.startsWith(parentName)
                  && inComingInternalSchema.findIdByName(c) >  inComingInternalSchema.findIdByName(name)
                  && oldTableSchema.findIdByName(c) > 0).sorted((s1, s2) -> oldTableSchema.findIdByName(s1) - oldTableSchema.findIdByName(s2)).findFirst();
      addChange.addColumns(parentName, rawName, inComingInternalSchema.findType(name), null);
      inferPosition.map(i -> addChange.addPositionChange(name, i, "before"));
```

## RuleId[ruleID=AbstractMethodCallInConstructor]
### AbstractMethodCallInConstructor
Call to 'abstract' method `getFileSystem()` during object construction
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/io/HoodieIOHandle.java`
#### Snippet
```java
    this.config = config;
    this.hoodieTable = hoodieTable;
    this.fs = getFileSystem();
  }

```

### AbstractMethodCallInConstructor
Call to 'abstract' method `createCompactor()` during object construction
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/async/AsyncCompactService.java`
#### Snippet
```java
    super(client.getConfig(), runInDaemonMode);
    this.context = context;
    this.compactor = createCompactor(client);
    this.maxConcurrentCompaction = 1;
  }
```

### AbstractMethodCallInConstructor
Call to 'abstract' method `createClusteringClient()` during object construction
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/async/AsyncClusteringService.java`
#### Snippet
```java
  public AsyncClusteringService(HoodieEngineContext context, BaseHoodieWriteClient writeClient, boolean runInDaemonMode) {
    super(writeClient.getConfig(), runInDaemonMode);
    this.clusteringClient = createClusteringClient(writeClient);
    this.maxConcurrentClustering = 1;
    this.context = context;
```

### AbstractMethodCallInConstructor
Call to 'abstract' method `getIndex()` during object construction
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/HoodieTable.java`
#### Snippet
```java
    this.viewManager = FileSystemViewManager.createViewManager(context, config.getMetadataConfig(), config.getViewStorageConfig(), config.getCommonConfig(), () -> metadata);
    this.metaClient = metaClient;
    this.index = getIndex(config, context);
    this.storageLayout = getStorageLayout(config);
    this.taskContextSupplier = context.getTaskContextSupplier();
```

### AbstractMethodCallInConstructor
Call to 'abstract' method `initRegistry()` during object construction
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metadata/HoodieBackedTableMetadataWriter.java`
#### Snippet
```java
          HoodieTableMetaClient.builder().setConf(hadoopConf).setBasePath(dataWriteConfig.getBasePath()).build();
      enablePartitions();
      initRegistry();
      initialize(engineContext, actionMetadata, inflightInstantTimestamp);
      initTableMetadata();
```

### AbstractMethodCallInConstructor
Call to 'abstract' method `initialize()` during object construction
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metadata/HoodieBackedTableMetadataWriter.java`
#### Snippet
```java
      enablePartitions();
      initRegistry();
      initialize(engineContext, actionMetadata, inflightInstantTimestamp);
      initTableMetadata();
    } else {
```

### AbstractMethodCallInConstructor
Call to 'abstract' method `createIndex()` during object construction
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/BaseHoodieWriteClient.java`
#### Snippet
```java
                               SupportsUpgradeDowngrade upgradeDowngradeHelper) {
    super(context, writeConfig, timelineService);
    this.index = createIndex(writeConfig);
    this.upgradeDowngradeHelper = upgradeDowngradeHelper;
  }
```

## RuleId[ruleID=NonSerializableFieldInSerializableClass]
### NonSerializableFieldInSerializableClass
Non-serializable field 'hadoopConf' in a Serializable class
in `hudi-sync/hudi-sync-common/src/main/java/org/apache/hudi/sync/common/HoodieSyncConfig.java`
#### Snippet
```java
      .withDocumentation("The spark version used when syncing with a metastore.");

  private Configuration hadoopConf;

  public HoodieSyncConfig(Properties props) {
```

### NonSerializableFieldInSerializableClass
Non-serializable field 'datasetIdentifier' in a Serializable class
in `hudi-sync/hudi-datahub-sync/src/main/java/org/apache/hudi/sync/datahub/config/DataHubSyncConfig.java`
#### Snippet
```java
      .withDocumentation("Environment to use when pushing entities to Datahub");

  public final HoodieDataHubDatasetIdentifier datasetIdentifier;

  public DataHubSyncConfig(Properties props) {
```

### NonSerializableFieldInSerializableClass
Non-serializable field 'currTimer' in a Serializable class
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/io/storage/row/HoodieRowDataCreateHandle.java`
#### Snippet
```java
  private final FileSystem fs;
  protected final HoodieInternalWriteStatus writeStatus;
  private final HoodieTimer currTimer;

  public HoodieRowDataCreateHandle(HoodieTable table, HoodieWriteConfig writeConfig, String partitionPath, String fileId,
```

### NonSerializableFieldInSerializableClass
Non-serializable field 'path' in a Serializable class
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/io/storage/row/HoodieRowDataCreateHandle.java`
#### Snippet
```java
  protected final HoodieRowDataFileWriter fileWriter;
  private final String partitionPath;
  private final Path path;
  private final String fileId;
  private final boolean preserveHoodieMetadata;
```

### NonSerializableFieldInSerializableClass
Non-serializable field 'path' in a Serializable class
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/io/storage/row/HoodieRowCreateHandle.java`
#### Snippet
```java

  private final String partitionPath;
  private final Path path;
  private final String fileId;

```

### NonSerializableFieldInSerializableClass
Non-serializable field 'currTimer' in a Serializable class
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/io/storage/row/HoodieRowCreateHandle.java`
#### Snippet
```java
  private final boolean shouldPreserveHoodieMetadata;

  private final HoodieTimer currTimer;

  protected final HoodieInternalRowFileWriter fileWriter;
```

### NonSerializableFieldInSerializableClass
Non-serializable field 'dateFormat' in a Serializable class
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/compact/strategy/BoundedPartitionAwareCompactionStrategy.java`
#### Snippet
```java
  // NOTE: {@code SimpleDataFormat} is NOT thread-safe
  // TODO replace w/ DateTimeFormatter
  private final ThreadLocal<SimpleDateFormat> dateFormat =
      ThreadLocal.withInitial(() -> new SimpleDateFormat(DayBasedCompactionStrategy.DATE_PARTITION_FORMAT));

```

### NonSerializableFieldInSerializableClass
Non-serializable field 'lock' in a Serializable class
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/transaction/lock/ZookeeperBasedLockProvider.java`
#### Snippet
```java

  private final transient CuratorFramework curatorFrameworkClient;
  private volatile InterProcessMutex lock = null;
  protected LockConfiguration lockConfiguration;

```

### NonSerializableFieldInSerializableClass
Non-serializable field 'lockInfo' in a Serializable class
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/transaction/lock/FileSystemBasedLockProvider.java`
#### Snippet
```java
  protected LockConfiguration lockConfiguration;
  private SimpleDateFormat sdf;
  private LockInfo lockInfo;
  private String currentOwnerLockInfo;

```

### NonSerializableFieldInSerializableClass
Non-serializable field 'value' in a Serializable class
in `hudi-common/src/main/java/org/apache/hudi/avro/MercifulJsonConverter.java`
#### Snippet
```java
  public static class HoodieJsonToAvroConversionException extends HoodieException {

    private Object value;
    private String fieldName;
    private Schema schema;
```

### NonSerializableFieldInSerializableClass
Non-serializable field 'kryo' in a Serializable class
in `hudi-common/src/main/java/org/apache/hudi/common/util/SerializationUtils.java`
#### Snippet
```java
  private static class KryoSerializerInstance implements Serializable {
    public static final int KRYO_SERIALIZER_INITIAL_BUFFER_SIZE = 1048576;
    private final Kryo kryo;
    // Caching ByteArrayOutputStream to avoid recreating it for every operation
    private final ByteArrayOutputStream baos;
```

### NonSerializableFieldInSerializableClass
Non-serializable field 'baos' in a Serializable class
in `hudi-common/src/main/java/org/apache/hudi/common/util/SerializationUtils.java`
#### Snippet
```java
    private final Kryo kryo;
    // Caching ByteArrayOutputStream to avoid recreating it for every operation
    private final ByteArrayOutputStream baos;

    KryoSerializerInstance() {
```

### NonSerializableFieldInSerializableClass
Non-serializable field 'compressBaos' in a Serializable class
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/BitCaskDiskMap.java`
#### Snippet
```java

    // Caching ByteArrayOutputStreams to avoid recreating it for every operation
    private final ByteArrayOutputStream compressBaos;
    private final ByteArrayOutputStream decompressBaos;
    private final byte[] decompressIntermediateBuffer;
```

### NonSerializableFieldInSerializableClass
Non-serializable field 'decompressBaos' in a Serializable class
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/BitCaskDiskMap.java`
#### Snippet
```java
    // Caching ByteArrayOutputStreams to avoid recreating it for every operation
    private final ByteArrayOutputStream compressBaos;
    private final ByteArrayOutputStream decompressBaos;
    private final byte[] decompressIntermediateBuffer;

```

### NonSerializableFieldInSerializableClass
Non-serializable field 'rocksDB' in a Serializable class
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/RocksDbBasedFileSystemView.java`
#### Snippet
```java
  private final RocksDBSchemaHelper schemaHelper;

  private RocksDBDAO rocksDB;

  private boolean closed = false;
```

### NonSerializableFieldInSerializableClass
Non-serializable field 'schemaHelper' in a Serializable class
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/RocksDbBasedFileSystemView.java`
#### Snippet
```java
  private final FileSystemViewStorageConfig config;

  private final RocksDBSchemaHelper schemaHelper;

  private RocksDBDAO rocksDB;
```

### NonSerializableFieldInSerializableClass
Non-serializable field 'defaultValue' in a Serializable class
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/Types.java`
#### Snippet
```java
    private final String doc;
    // Experimental properties
    private final Object defaultValue;

    private Field(boolean isOptional, int id, String name, Type type, String doc, Object defaultValue) {
```

### NonSerializableFieldInSerializableClass
Non-serializable field 'dataGen' in a Serializable class
in `hudi-examples/hudi-examples-spark/src/main/java/org/apache/hudi/examples/common/RandomJsonSource.java`
#### Snippet
```java

public class RandomJsonSource extends JsonSource {
  private HoodieExampleDataGenerator<HoodieAvroPayload> dataGen;

  public RandomJsonSource(TypedProperties props, JavaSparkContext sparkContext, SparkSession sparkSession, SchemaProvider schemaProvider) {
```

### NonSerializableFieldInSerializableClass
Non-serializable field 'jssc' in a Serializable class
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/schema/SchemaProvider.java`
#### Snippet
```java
  protected TypedProperties config;

  protected JavaSparkContext jssc;

  public SchemaProvider(TypedProperties props) {
```

### NonSerializableFieldInSerializableClass
Non-serializable field 'jssc' in a Serializable class
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/schema/SchemaPostProcessor.java`
#### Snippet
```java
  protected TypedProperties config;

  protected JavaSparkContext jssc;

  protected SchemaPostProcessor(TypedProperties props, JavaSparkContext jssc) {
```

### NonSerializableFieldInSerializableClass
Non-serializable field 'outputStream' in a Serializable class
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/perf/TimelineServerPerf.java`
#### Snippet
```java
    private final Path dumpPath;
    private final FileSystem fileSystem;
    private FSDataOutputStream outputStream;

    public Dumper(FileSystem fs, Path dumpPath) {
```

### NonSerializableFieldInSerializableClass
Non-serializable field 'dumpPath' in a Serializable class
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/perf/TimelineServerPerf.java`
#### Snippet
```java
  private static class Dumper implements Serializable {

    private final Path dumpPath;
    private final FileSystem fileSystem;
    private FSDataOutputStream outputStream;
```

### NonSerializableFieldInSerializableClass
Non-serializable field 'pubsubMessagesFetcher' in a Serializable class
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/GcsEventsSource.java`
#### Snippet
```java
public class GcsEventsSource extends RowSource {

  private final PubsubMessagesFetcher pubsubMessagesFetcher;
  private final boolean ackMessages;

```

### NonSerializableFieldInSerializableClass
Non-serializable field 'offsetGen' in a Serializable class
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/KafkaSource.java`
#### Snippet
```java
  protected final HoodieDeltaStreamerMetrics metrics;
  protected final SchemaProvider schemaProvider;
  protected KafkaOffsetGen offsetGen;

  protected KafkaSource(TypedProperties props, JavaSparkContext sparkContext, SparkSession sparkSession,
```

### NonSerializableFieldInSerializableClass
Non-serializable field 'pathSelector' in a Serializable class
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/S3EventsSource.java`
#### Snippet
```java
public class S3EventsSource extends RowSource implements Closeable {

  private final S3EventsMetaSelector pathSelector;
  private final List<Message> processedMessages = new ArrayList<>();
  AmazonSQS sqs;
```

### NonSerializableFieldInSerializableClass
Non-serializable field 'pulsarConsumer' in a Serializable class
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/PulsarSource.java`
#### Snippet
```java
  // NOTE: We're keeping the client so that we can shut it down properly
  private final Lazy<PulsarClient> pulsarClient;
  private final Lazy<Consumer<byte[]>> pulsarConsumer;

  public PulsarSource(TypedProperties props,
```

### NonSerializableFieldInSerializableClass
Non-serializable field 'pulsarClient' in a Serializable class
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/PulsarSource.java`
#### Snippet
```java

  // NOTE: We're keeping the client so that we can shut it down properly
  private final Lazy<PulsarClient> pulsarClient;
  private final Lazy<Consumer<byte[]>> pulsarConsumer;

```

### NonSerializableFieldInSerializableClass
Non-serializable field 'configuration' in a Serializable class
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/BootstrapExecutor.java`
#### Snippet
```java
   * Hadoop Configuration.
   */
  private final Configuration configuration;

  /**
```

### NonSerializableFieldInSerializableClass
Non-serializable field 'offsetGen' in a Serializable class
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/debezium/DebeziumSource.java`
#### Snippet
```java
  private static final String DATE_CONNECT_NAME = "custom.debezium.DateString";

  private final KafkaOffsetGen offsetGen;
  private final HoodieDeltaStreamerMetrics metrics;
  private final SchemaRegistryProvider schemaRegistryProvider;
```

### NonSerializableFieldInSerializableClass
Non-serializable field 'executor' in a Serializable class
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/CleanFunction.java`
#### Snippet
```java
  protected HoodieFlinkWriteClient writeClient;

  private NonThrownExecutor executor;

  private volatile boolean isCleaning;
```

### NonSerializableFieldInSerializableClass
Non-serializable field 'path' in a Serializable class
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/meta/CkpMetadata.java`
#### Snippet
```java

  private final FileSystem fs;
  protected final Path path;

  private List<CkpMessage> messages;
```

### NonSerializableFieldInSerializableClass
Non-serializable field 'constructor' in a Serializable class
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/utils/PayloadCreation.java`
#### Snippet
```java

  private final boolean shouldCombine;
  private final Constructor<?> constructor;
  private final String preCombineField;

```

### NonSerializableFieldInSerializableClass
Non-serializable field 'bucketAssigner' in a Serializable class
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/partitioner/BucketAssignFunction.java`
#### Snippet
```java
   * Bucket assigner to assign new bucket IDs or reuse existing ones.
   */
  private BucketAssigner bucketAssigner;

  private final Configuration conf;
```

### NonSerializableFieldInSerializableClass
Non-serializable field 'executor' in a Serializable class
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/source/StreamReadOperator.java`
#### Snippet
```java
  // splits for subsequent reading, so that a new checkpoint could be triggered without blocking a long time
  // for exhausting all scheduled split reading tasks.
  private final MailboxExecutorAdapter executor;

  private MergeOnReadInputFormat format;
```

### NonSerializableFieldInSerializableClass
Non-serializable field 'jssc' in a Serializable class
in `hudi-spark-datasource/hudi-spark/src/main/java/org/apache/hudi/cli/SchemaProvider.java`
#### Snippet
```java
  protected TypedProperties config;

  protected JavaSparkContext jssc;

  public SchemaProvider(TypedProperties props) {
```

### NonSerializableFieldInSerializableClass
Non-serializable field 'configuration' in a Serializable class
in `hudi-spark-datasource/hudi-spark/src/main/java/org/apache/hudi/cli/BootstrapExecutorUtils.java`
#### Snippet
```java
   * Hadoop Configuration.
   */
  private final Configuration configuration;

  /**
```

### NonSerializableFieldInSerializableClass
Non-serializable field 'cfg' in a Serializable class
in `hudi-spark-datasource/hudi-spark/src/main/java/org/apache/hudi/cli/BootstrapExecutorUtils.java`
#### Snippet
```java
   * Config.
   */
  private final Config cfg;

  /**
```

### NonSerializableFieldInSerializableClass
Non-serializable field 'markerCreationProcessingLock' in a Serializable class
in `hudi-timeline-service/src/main/java/org/apache/hudi/timeline/service/handlers/marker/MarkerDirState.java`
#### Snippet
```java
  private final List<MarkerCreationFuture> markerCreationFutures = new ArrayList<>();
  private final int parallelism;
  private final Object markerCreationProcessingLock = new Object();
  // Early conflict detection strategy if enabled
  private final Option<TimelineServerBasedDetectionStrategy> conflictDetectionStrategy;
```

## RuleId[ruleID=MismatchedJavadocCode]
### MismatchedJavadocCode
Method is specified to return map but the return type is list
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metadata/HoodieBackedTableMetadataWriter.java`
#### Snippet
```java
   *
   * @param datasetMetaClient data set meta client instance.
   * @return Map of partition names to a list of FileStatus for all the files in the partition
   */
  private List<DirectoryInfo> listAllPartitions(HoodieTableMetaClient datasetMetaClient) {
```

### MismatchedJavadocCode
Method is specified to return list but the return type is set
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/source/FileIndex.java`
#### Snippet
```java
   * <p>The {@code filters} must all be simple.
   *
   * @return list of pruned (data-skipped) candidate base-files' names
   */
  @Nullable
```

## RuleId[ruleID=AssignmentToForLoopParameter]
### AssignmentToForLoopParameter
Assignment to for-loop parameter `i`
in `hudi-common/src/main/java/org/apache/hudi/common/util/PartitionPathEncodeUtils.java`
#### Snippet
```java
        if (code >= 0) {
          sb.append((char) code);
          i += 2;
          continue;
        }
```

### AssignmentToForLoopParameter
Assignment to for-loop parameter `i`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/FilePathUtils.java`
#### Snippet
```java
        if (code >= 0) {
          sb.append((char) code);
          i += 2;
          continue;
        }
```

## RuleId[ruleID=UnnecessaryToStringCall]
### UnnecessaryToStringCall
Unnecessary `toString()` call
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/CompactionCommand.java`
#### Snippet
```java

  private static String getTmpSerializerFile() {
    return TMP_DIR + UUID.randomUUID().toString() + ".ser";
  }

```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/MetadataCommand.java`
#### Snippet
```java
    } catch (FileNotFoundException e) {
      // Metadata directory does not exist
      throw new RuntimeException("Metadata directory (" + metadataPath.toString() + ") does not exist.");
    }

```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/MetadataCommand.java`
#### Snippet
```java
      FileStatus[] statuses = HoodieCLI.fs.listStatus(metadataPath);
      if (statuses.length > 0) {
        throw new RuntimeException("Metadata directory (" + metadataPath.toString() + ") not empty.");
      }
    } catch (FileNotFoundException e) {
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/io/storage/row/parquet/ParquetSchemaConverter.java`
#### Snippet
```java
      } else {
        throw new UnsupportedOperationException(
            "Unsupported SqlTimeTypeInfo " + typeInfo.toString());
      }

```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/io/storage/row/parquet/ParquetSchemaConverter.java`
#### Snippet
```java
                        String.format(
                            "List field [%s] in List [%s] has to be required. ",
                            type.toString(), fieldType.getName()));
                  }
                }
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/io/storage/row/parquet/ParquetSchemaConverter.java`
#### Snippet
```java
                            "Unrecgonized List schema [%s] according to Parquet"
                                + " standard",
                            parquetGroupType.toString()));
                  }
                }
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/index/bucket/HoodieSparkConsistentBucketIndex.java`
#### Snippet
```java

      LOG.error("Consistent hashing node has no file group, partition: " + partitionPath + ", meta: "
          + partitionToIdentifier.get(partitionPath).getMetadata().getFilename() + ", record_key: " + key.toString());
      throw new HoodieIndexException("Failed to getBucket as hashing node has no file group");
    }
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/marker/DirectWriteMarkers.java`
#### Snippet
```java
      throw new HoodieException("Failed to create marker file " + markerPath, e);
    }
    LOG.info("[direct] Created marker file " + markerPath.toString()
        + " in " + timer.endTimer() + " ms");
    return Option.of(markerPath);
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/marker/TimelineServerBasedWriteMarkers.java`
#### Snippet
```java
          MARKERS_DIR_EXISTS_URL, paramsMap, new TypeReference<Boolean>() {}, RequestMethod.GET);
    } catch (IOException e) {
      throw new HoodieRemoteException("Failed to check marker directory " + markerDirPath.toString(), e);
    }
  }
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/marker/TimelineServerBasedWriteMarkers.java`
#### Snippet
```java
          DELETE_MARKER_DIR_URL, paramsMap, new TypeReference<Boolean>() {}, RequestMethod.POST);
    } catch (IOException e) {
      throw new HoodieRemoteException("Failed to delete marker directory " + markerDirPath.toString(), e);
    }
  }
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/marker/TimelineServerBasedWriteMarkers.java`
#### Snippet
```java
          ALL_MARKERS_URL, paramsMap, new TypeReference<Set<String>>() {}, RequestMethod.GET);
    } catch (IOException e) {
      throw new HoodieRemoteException("Failed to get all markers in " + markerDirPath.toString(), e);
    }
  }
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/marker/TimelineServerBasedWriteMarkers.java`
#### Snippet
```java
    } catch (IOException e) {
      throw new HoodieRemoteException("Failed to get CREATE and MERGE data file paths in "
          + markerDirPath.toString(), e);
    }
  }
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/keygen/KeyGenUtils.java`
#### Snippet
```java
    if (keyIsNullEmpty) {
      throw new HoodieKeyException("recordKey values: \"" + recordKey + "\" for fields: "
          + recordKeyFields.toString() + " cannot be entirely null or empty.");
    }
    return recordKey.toString();
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `hudi-common/src/main/java/org/apache/hudi/avro/MercifulJsonConverter.java`
#### Snippet
```java
          return Pair.of(true, new GenericData.EnumSymbol(schema, value.toString()));
        }
        throw new HoodieJsonToAvroConversionException(String.format("Symbol %s not in enum", value.toString()),
            schema.getFullName(), schema);
      }
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `hudi-common/src/main/java/org/apache/hudi/common/HoodieJsonPayload.java`
#### Snippet
```java
    JsonNode node = new ObjectMapper().readTree(getJsonData());
    if (!node.has(field)) {
      throw new HoodieException("Field :" + field + " not found in payload => " + node.toString());
    }
    return node.get(field).textValue();
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `hudi-common/src/main/java/org/apache/hudi/common/fs/HoodieWrapperFileSystem.java`
#### Snippet
```java
    // When the file is first written, we do not have a track of it
    throw new IllegalArgumentException(
        file.toString() + " does not have a open stream. Cannot get the bytes written on the stream");
  }

```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `hudi-common/src/main/java/org/apache/hudi/common/util/AvroOrcUtils.java`
#### Snippet
```java
              type.getCategory().getName(),
              value.getClass().getName(),
              value.toString()
          ));
        }
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `hudi-common/src/main/java/org/apache/hudi/common/util/AvroOrcUtils.java`
#### Snippet
```java
              "Unrecognized type for Avro DATE field value, which has type %s, value %s",
              value.getClass().getName(),
              value.toString()
          ));
        }
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `hudi-common/src/main/java/org/apache/hudi/common/util/AvroOrcUtils.java`
#### Snippet
```java
              "Unrecognized type for Avro TIMESTAMP field value, which has type %s, value %s",
              value.getClass().getName(),
              value.toString()
          ));
        }
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `hudi-common/src/main/java/org/apache/hudi/common/util/AvroOrcUtils.java`
#### Snippet
```java
              "Unrecognized type for Avro BINARY field value, which has type %s, value %s",
              value.getClass().getName(),
              value.toString()
          ));
        }
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `hudi-common/src/main/java/org/apache/hudi/common/util/AvroOrcUtils.java`
#### Snippet
```java
              "Failed to add value %s to union with type %s",
              value == null ? "null" : value.toString(),
              type.toString()
          ));
        }
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `hudi-common/src/main/java/org/apache/hudi/common/util/AvroOrcUtils.java`
#### Snippet
```java
        break;
      default:
        throw new IllegalArgumentException("Invalid TypeDescription " + type.toString() + ".");
    }
  }
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `hudi-common/src/main/java/org/apache/hudi/common/util/AvroOrcUtils.java`
#### Snippet
```java
        return readFromVector(type.getChildren().get(tag), fieldVector, avroSchema.getTypes().get(tag), vectorPos);
      default:
        throw new HoodieIOException("Unrecognized TypeDescription " + type.toString());
    }
  }
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `hudi-common/src/main/java/org/apache/hudi/common/util/InternalSchemaCache.java`
#### Snippet
```java
      } catch (Exception e1) {
        // swallow this exception.
        LOG.warn(String.format("Cannot find internal schema from commit file %s. Falling back to parsing historical internal schema", candidateCommitFile.toString()));
      }
    }
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `hudi-common/src/main/java/org/apache/hudi/common/util/MarkerUtils.java`
#### Snippet
```java
      bufferedWriter.write(markerType.toString());
    } catch (IOException e) {
      throw new HoodieException("Failed to create marker type file " + markerTypeFilePath.toString()
          + "; " + e.getMessage(), e);
    } finally {
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `hudi-common/src/main/java/org/apache/hudi/common/util/MarkerUtils.java`
#### Snippet
```java
      content = Option.of(MarkerType.valueOf(FileIOUtils.readAsUTFString(fsDataInputStream)));
    } catch (IOException e) {
      throw new HoodieIOException("Cannot read marker type file " + markerTypeFilePath.toString()
          + "; " + e.getMessage(), e);
    } finally {
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `hudi-common/src/main/java/org/apache/hudi/common/util/MarkerUtils.java`
#### Snippet
```java
      fileSystem.delete(markerTypeFilePath, false);
    } catch (IOException e) {
      throw new HoodieIOException("Cannot delete marker type file " + markerTypeFilePath.toString()
          + "; " + e.getMessage(), e);
    }
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/DiskMap.java`
#### Snippet
```java
  public DiskMap(String basePath, String prefix) throws IOException {
    this.diskMapPath =
        String.format("%s/%s-%s-%s", basePath, SUBFOLDER_PREFIX, prefix, UUID.randomUUID().toString());
    diskMapPathFile = new File(diskMapPath);
    FileIOUtils.deleteDirectory(diskMapPathFile);
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/RocksDBDAO.java`
#### Snippet
```java
  public RocksDBDAO(String basePath, String rocksDBBasePath) {
    this.rocksDBBasePath =
        String.format("%s/%s/%s", rocksDBBasePath, basePath.replace("/", "_"), UUID.randomUUID().toString());
    init();
    totalBytesWritten = 0L;
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `hudi-common/src/main/java/org/apache/hudi/common/table/timeline/HoodieActiveTimeline.java`
#### Snippet
```java
  public HoodieInstant transitionRestoreRequestedToInflight(HoodieInstant requestedInstant) {
    ValidationUtils.checkArgument(requestedInstant.getAction().equals(HoodieTimeline.RESTORE_ACTION), "Transition to inflight requested for a restore instant with diff action "
        + requestedInstant.toString());
    ValidationUtils.checkArgument(requestedInstant.isRequested(), "Transition to inflight requested for an instant not in requested state " + requestedInstant.toString());
    HoodieInstant inflight = new HoodieInstant(State.INFLIGHT, RESTORE_ACTION, requestedInstant.getTimestamp());
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `hudi-common/src/main/java/org/apache/hudi/common/table/timeline/HoodieActiveTimeline.java`
#### Snippet
```java
    ValidationUtils.checkArgument(requestedInstant.getAction().equals(HoodieTimeline.RESTORE_ACTION), "Transition to inflight requested for a restore instant with diff action "
        + requestedInstant.toString());
    ValidationUtils.checkArgument(requestedInstant.isRequested(), "Transition to inflight requested for an instant not in requested state " + requestedInstant.toString());
    HoodieInstant inflight = new HoodieInstant(State.INFLIGHT, RESTORE_ACTION, requestedInstant.getTimestamp());
    transitionState(requestedInstant, inflight, Option.empty());
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/utils/InternalSchemaUtils.java`
#### Snippet
```java
          newFields.add(f);
        } else {
          throw new HoodieSchemaException(String.format("cannot find pruned id %s in currentSchema %s", id, schema.toString()));
        }
      }
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieBackedTableMetadata.java`
#### Snippet
```java
                  instant.getTimestamp())).get(), HoodieRollbackPlan.class);
          commitsToRollback = Collections.singletonList(rollbackPlan.getInstantToRollback().getCommitTime());
          LOG.warn("Had to fetch rollback info from requested instant since completed file is empty " + instant.toString());
        }
        return commitsToRollback;
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/HoodieROTablePathFilter.java`
#### Snippet
```java
            hoodiePathCache.put(folder.toString(), new HashSet<>());
          }
          LOG.info("Based on hoodie metadata from base path: " + baseDir.toString() + ", caching " + latestFiles.size()
              + " files under " + folder);
          for (HoodieBaseFile lfile : latestFiles) {
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/HoodieROTablePathFilter.java`
#### Snippet
```java
          // Non-hoodie path, accept it.
          if (LOG.isDebugEnabled()) {
            LOG.debug(String.format("(1) Caching non-hoodie path under %s with basePath %s \n", folder.toString(), baseDir.toString()));
          }
          nonHoodiePathCache.add(folder.toString());
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/HoodieROTablePathFilter.java`
#### Snippet
```java
          // Non-hoodie path, accept it.
          if (LOG.isDebugEnabled()) {
            LOG.debug(String.format("(1) Caching non-hoodie path under %s with basePath %s \n", folder.toString(), baseDir.toString()));
          }
          nonHoodiePathCache.add(folder.toString());
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/HoodieROTablePathFilter.java`
#### Snippet
```java
        // files is at < 3 level depth in FS tree, can't be hoodie dataset
        if (LOG.isDebugEnabled()) {
          LOG.debug(String.format("(2) Caching non-hoodie path under %s \n", folder.toString()));
        }
        nonHoodiePathCache.add(folder.toString());
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDropPartitionsTool.java`
#### Snippet
```java
      tool.run();
    } catch (Throwable throwable) {
      LOG.error("Fail to run deleting table partitions for " + cfg.toString(), throwable);
    } finally {
      jsc.stop();
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDropPartitionsTool.java`
#### Snippet
```java
        + hiveSyncConfig.getStringOrDefault(HiveSyncConfigHolder.HIVE_URL)
        + ", basePath :" + cfg.basePath);
    LOG.info("Hive Sync Conf => " + hiveSyncConfig.toString());
    FileSystem fs = FSUtils.getFs(cfg.basePath, jsc.hadoopConfiguration());
    HiveConf hiveConf = new HiveConf();
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `hudi-kafka-connect/src/main/java/org/apache/hudi/connect/kafka/KafkaConnectControlAgent.java`
#### Snippet
```java
    props.put(ConsumerConfig.BOOTSTRAP_SERVERS_CONFIG, bootstrapServers);
    // Todo fetch the worker id or name instead of a uuid.
    props.put(ConsumerConfig.GROUP_ID_CONFIG, "hudi-control-group" + UUID.randomUUID().toString());
    props.put(ConsumerConfig.KEY_DESERIALIZER_CLASS_CONFIG, StringDeserializer.class);
    props.put(ConsumerConfig.VALUE_DESERIALIZER_CLASS_CONFIG, ByteArrayDeserializer.class);
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/debezium/DebeziumSource.java`
#### Snippet
```java
          }).map(Field::name).collect(Collectors.toList());

      LOG.info("Date fields: " + dateFields.toString());

      for (String dateCol : dateFields) {
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `hudi-timeline-service/src/main/java/org/apache/hudi/timeline/service/handlers/marker/MarkerDirState.java`
#### Snippet
```java
      closeQuietly(fsDataOutputStream);
    }
    LOG.debug(markersFilePath.toString() + " written in " + timer.endTimer() + " ms");
  }
}
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `hudi-spark-datasource/hudi-spark-common/src/main/java/org/apache/hudi/DataSourceUtils.java`
#### Snippet
```java
        return client.insertOverwriteTable(hoodieRecords, instantTime);
      default:
        throw new HoodieException("Not a valid operation type for doWriteOperation: " + operation.toString());
    }
  }
```

## RuleId[ruleID=InnerClassMayBeStatic]
### InnerClassMayBeStatic
Inner class `Heartbeat` may be 'static'
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/client/heartbeat/HoodieHeartbeatClient.java`
#### Snippet
```java
  }

  class Heartbeat {

    private String instantTime;
```

### InnerClassMayBeStatic
Inner class `IteratorWrapper` may be 'static'
in `hudi-common/src/main/java/org/apache/hudi/common/util/collection/ExternalSpillableMap.java`
#### Snippet
```java
   * in-memory map 2) diskLazyFileIterator - Iterates over all the data spilled to disk.
   */
  private class IteratorWrapper<R> implements Iterator<R> {

    private final Iterator<R> inMemoryIterator;
```

## RuleId[ruleID=SuspiciousMethodCalls]
### SuspiciousMethodCalls
'Map' may not contain keys of type ''
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/clean/CleanActionExecutor.java`
#### Snippet
```java
    // Return PartitionCleanStat for each partition passed.
    return cleanerPlan.getFilePathsToBeDeletedPerPartition().keySet().stream().map(partitionPath -> {
      PartitionCleanStat partitionCleanStat = partitionCleanStatsMap.containsKey(partitionPath)
          ? partitionCleanStatsMap.get(partitionPath)
          : new PartitionCleanStat(partitionPath);
```

### SuspiciousMethodCalls
'Map' may not contain keys of type ''
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/clean/CleanActionExecutor.java`
#### Snippet
```java
    return cleanerPlan.getFilePathsToBeDeletedPerPartition().keySet().stream().map(partitionPath -> {
      PartitionCleanStat partitionCleanStat = partitionCleanStatsMap.containsKey(partitionPath)
          ? partitionCleanStatsMap.get(partitionPath)
          : new PartitionCleanStat(partitionPath);
      HoodieActionInstant actionInstant = cleanerPlan.getEarliestInstantToRetain();
```

### SuspiciousMethodCalls
'List' may not contain objects of type ''
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/clean/CleanActionExecutor.java`
#### Snippet
```java
          .withSuccessfulDeleteBootstrapBaseFiles(partitionCleanStat.getSuccessfulDeleteBootstrapBaseFiles())
          .withFailedDeleteBootstrapBaseFiles(partitionCleanStat.getFailedDeleteBootstrapBaseFiles())
          .isPartitionDeleted(partitionsToBeDeleted.contains(partitionPath))
          .build();
    }).collect(Collectors.toList());
```

## RuleId[ruleID=StringEqualsEmptyString]
### StringEqualsEmptyString
`equals("")` can be replaced with 'isEmpty()'
in `hudi-common/src/main/java/org/apache/hudi/common/config/DFSPropertiesConfiguration.java`
#### Snippet
```java
  private boolean isValidLine(String line) {
    ValidationUtils.checkArgument(line != null, "passed line is null");
    if (line.startsWith("#") || line.equals("")) {
      return false;
    }
```

### StringEqualsEmptyString
`equals("")` can be replaced with 'isEmpty()'
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/bulk/RowDataKeyGen.java`
#### Snippet
```java
    if (this.partitionPathFields.length == 1) {
      // efficient code path
      if (this.partitionPathFields[0].equals("")) {
        this.nonPartitioned = true;
      } else {
```

## RuleId[ruleID=UnnecessaryBoxing]
### UnnecessaryBoxing
Redundant boxing, `Double.parseDouble()` call can be used instead
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/utils/SparkInternalSchemaConverter.java`
#### Snippet
```java
        // float -> double/string/decimal
        if (newType instanceof DoubleType) {
          newV.putDouble(i, Double.valueOf(oldV.getFloat(i) + ""));
        } else if (newType instanceof StringType) {
          newV.putByteArray(i, (oldV.getFloat(i) + "").getBytes(StandardCharsets.UTF_8));
```

### UnnecessaryBoxing
Redundant boxing, `Long.parseLong()` call can be used instead
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/io/FileBasedInternalSchemaStorageManager.java`
#### Snippet
```java
    } else {
      treeMap = SerDeHelper.parseSchemas(historySchemaStr);
      InternalSchema result = InternalSchemaUtils.searchSchema(Long.valueOf(versionId), treeMap);
      if (result == null) {
        return Option.empty();
```

### UnnecessaryBoxing
Redundant boxing, `Boolean.parseBoolean()` call can be used instead
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/hive/HoodieCombineHiveInputFormat.java`
#### Snippet
```java
    public RecordReader getRecordReader(JobConf job, CombineFileSplit split, Reporter reporter,
        Class<RecordReader<K, V>> rrClass) throws IOException {
      isRealTime = Boolean.valueOf(job.get("hudi.hive.realtime", "false"));
      if (isRealTime) {
        List<RecordReader> recordReaders = new LinkedList<>();
```

## RuleId[ruleID=SynchronizeOnNonFinalField]
### SynchronizeOnNonFinalField
Synchronization on a non-final field `checkpointLock`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/source/StreamReadMonitoringFunction.java`
#### Snippet
```java

    if (checkpointLock != null) {
      synchronized (checkpointLock) {
        issuedInstant = null;
        isRunning = false;
```

### SynchronizeOnNonFinalField
Synchronization on a non-final field `checkpointLock`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/source/StreamReadMonitoringFunction.java`
#### Snippet
```java
    if (checkpointLock != null) {
      // this is to cover the case where cancel() is called before the run()
      synchronized (checkpointLock) {
        issuedInstant = null;
        isRunning = false;
```

### SynchronizeOnNonFinalField
Synchronization on a non-final field `checkpointLock`
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/source/StreamReadMonitoringFunction.java`
#### Snippet
```java
    checkpointLock = context.getCheckpointLock();
    while (isRunning) {
      synchronized (checkpointLock) {
        monitorDirAndForwardSplits(context);
      }
```

## RuleId[ruleID=ConditionCoveredByFurtherCondition]
### ConditionCoveredByFurtherCondition
Condition 'schemaProvider == null' covered by subsequent condition '!(schemaProvider instanceof SchemaRegistryProvider)'
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/debezium/DebeziumSource.java`
#### Snippet
```java

    // Currently, debezium source requires Confluent/Kafka schema-registry to fetch the latest schema.
    if (schemaProvider == null || !(schemaProvider instanceof SchemaRegistryProvider)) {
      schemaRegistryProvider = new SchemaRegistryProvider(props, sparkContext);
    } else {
```

## RuleId[ruleID=MissingDeprecatedAnnotation]
### MissingDeprecatedAnnotation
Missing '@Deprecated' annotation
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/HDFSParquetImportCommand.java`
#### Snippet
```java
 */
@ShellComponent
public class HDFSParquetImportCommand {

  @ShellMethod(key = "hdfsparquetimport", value = "Imports Parquet table to a hoodie table")
```

### MissingDeprecatedAnnotation
Missing '@Deprecated' annotation
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/config/HoodieClusteringConfig.java`
#### Snippet
```java
   * {@link #LAYOUT_OPTIMIZE_STRATEGY} config to enable advanced record layout optimization strategies
   */
  public static final ConfigProperty LAYOUT_OPTIMIZE_ENABLE = ConfigProperty
      .key(LAYOUT_OPTIMIZE_PARAM_PREFIX + "enable")
      .defaultValue(false)
```

### MissingDeprecatedAnnotation
Missing '@Deprecated' annotation
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/config/HoodieClusteringConfig.java`
#### Snippet
```java
   * @deprecated this setting has no effect
   */
  public static final ConfigProperty LAYOUT_OPTIMIZE_DATA_SKIPPING_ENABLE = ConfigProperty
      .key(LAYOUT_OPTIMIZE_PARAM_PREFIX + "data.skipping.enable")
      .defaultValue(true)
```

### MissingDeprecatedAnnotation
Missing '@Deprecated' annotation
in `hudi-common/src/main/java/org/apache/hudi/common/table/HoodieTableMetaClient.java`
#### Snippet
```java
   * @deprecated
   */
  public HoodieTableMetaClient() {
  }

```

### MissingDeprecatedAnnotation
Missing '@Deprecated' annotation
in `hudi-common/src/main/java/org/apache/hudi/common/table/HoodieTableMetaClient.java`
#### Snippet
```java
   * @deprecated
   */
  private void readObject(java.io.ObjectInputStream in) throws IOException, ClassNotFoundException {
    in.defaultReadObject();

```

### MissingDeprecatedAnnotation
Missing '@Deprecated' annotation
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/HoodieTableFileSystemView.java`
#### Snippet
```java
   * @deprecated
   */
  private void readObject(java.io.ObjectInputStream in) throws IOException, ClassNotFoundException {
    in.defaultReadObject();
  }
```

### MissingDeprecatedAnnotation
Missing '@Deprecated' annotation
in `hudi-common/src/main/java/org/apache/hudi/common/table/timeline/HoodieDefaultTimeline.java`
#### Snippet
```java
   * @deprecated
   */
  public HoodieDefaultTimeline() {
  }

```

### MissingDeprecatedAnnotation
Missing '@Deprecated' annotation
in `hudi-common/src/main/java/org/apache/hudi/common/table/timeline/HoodieArchivedTimeline.java`
#### Snippet
```java
   * @deprecated
   */
  public HoodieArchivedTimeline() {
  }

```

### MissingDeprecatedAnnotation
Missing '@Deprecated' annotation
in `hudi-common/src/main/java/org/apache/hudi/common/table/timeline/HoodieArchivedTimeline.java`
#### Snippet
```java
   * @deprecated
   */
  private void readObject(java.io.ObjectInputStream in) throws IOException, ClassNotFoundException {
    in.defaultReadObject();
  }
```

### MissingDeprecatedAnnotation
Missing '@Deprecated' annotation
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieSnapshotCopier.java`
#### Snippet
```java
 * @deprecated Use {@link HoodieSnapshotExporter} instead.
 */
public class HoodieSnapshotCopier implements Serializable {

  private static final Logger LOG = LogManager.getLogger(HoodieSnapshotCopier.class);
```

### MissingDeprecatedAnnotation
Missing '@Deprecated' annotation
in `hudi-common/src/main/java/org/apache/hudi/common/table/TableSchemaResolver.java`
#### Snippet
```java
   * @deprecated please use {@link #getTableAvroSchema(HoodieInstant, boolean)} instead
   */
  public MessageType readSchemaFromLastCompaction(Option<HoodieInstant> lastCompactionCommitOpt) throws Exception {
    HoodieActiveTimeline activeTimeline = metaClient.getActiveTimeline();

```

### MissingDeprecatedAnnotation
Missing '@Deprecated' annotation
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HDFSParquetImporter.java`
#### Snippet
```java
 * @see HoodieDeltaStreamer
 */
public class HDFSParquetImporter implements Serializable {

  private static final long serialVersionUID = 1L;
```

## RuleId[ruleID=UnnecessaryFullyQualifiedName]
### UnnecessaryFullyQualifiedName
Qualifier `org.springframework.boot.autoconfigure.gson` is unnecessary, and can be replaced with an import
in `hudi-cli/src/main/java/org/apache/hudi/cli/Main.java`
#### Snippet
```java
 * Main class that delegates to Spring Shell's Bootstrap class in order to simplify debugging inside an IDE.
 */
@SpringBootApplication(exclude = {org.springframework.boot.autoconfigure.gson.GsonAutoConfiguration.class})
public class Main {

```

### UnnecessaryFullyQualifiedName
Qualifier `scala.collection` is unnecessary, and can be replaced with an import
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/CompactionCommand.java`
#### Snippet
```java
    try {
      String sparkPropertiesPath = Utils
          .getDefaultPropertiesFile(scala.collection.JavaConversions.propertiesAsScalaMap(System.getProperties()));
      SparkLauncher sparkLauncher = SparkUtil.initLauncher(sparkPropertiesPath);
      sparkLauncher.addAppArgs(SparkCommand.COMPACT_UNSCHEDULE_PLAN.toString(), master, sparkMemory, client.getBasePath(),
```

### UnnecessaryFullyQualifiedName
Qualifier `scala.collection` is unnecessary, and can be replaced with an import
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/CompactionCommand.java`
#### Snippet
```java

    String sparkPropertiesPath =
        Utils.getDefaultPropertiesFile(scala.collection.JavaConversions.propertiesAsScalaMap(System.getProperties()));
    SparkLauncher sparkLauncher = SparkUtil.initLauncher(sparkPropertiesPath);
    String cmd = SparkCommand.COMPACT_SCHEDULE.toString();
```

### UnnecessaryFullyQualifiedName
Qualifier `scala.collection` is unnecessary, and can be replaced with an import
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/CompactionCommand.java`
#### Snippet
```java
    }
    String sparkPropertiesPath =
        Utils.getDefaultPropertiesFile(scala.collection.JavaConversions.propertiesAsScalaMap(System.getProperties()));
    SparkLauncher sparkLauncher = SparkUtil.initLauncher(sparkPropertiesPath);
    sparkLauncher.addAppArgs(SparkCommand.COMPACT_RUN.toString(), master, sparkMemory, client.getBasePath(),
```

### UnnecessaryFullyQualifiedName
Qualifier `scala.collection` is unnecessary, and can be replaced with an import
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/CompactionCommand.java`
#### Snippet
```java
    try {
      String sparkPropertiesPath = Utils
          .getDefaultPropertiesFile(scala.collection.JavaConversions.propertiesAsScalaMap(System.getProperties()));
      SparkLauncher sparkLauncher = SparkUtil.initLauncher(sparkPropertiesPath);
      sparkLauncher.addAppArgs(SparkCommand.COMPACT_UNSCHEDULE_FILE.toString(), master, sparkMemory, client.getBasePath(),
```

### UnnecessaryFullyQualifiedName
Qualifier `scala.collection` is unnecessary, and can be replaced with an import
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/CompactionCommand.java`
#### Snippet
```java
    try {
      String sparkPropertiesPath = Utils
          .getDefaultPropertiesFile(scala.collection.JavaConversions.propertiesAsScalaMap(System.getProperties()));
      SparkLauncher sparkLauncher = SparkUtil.initLauncher(sparkPropertiesPath);
      sparkLauncher.addAppArgs(SparkCommand.COMPACT_REPAIR.toString(), master, sparkMemory, client.getBasePath(),
```

### UnnecessaryFullyQualifiedName
Qualifier `scala.collection` is unnecessary, and can be replaced with an import
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/CompactionCommand.java`
#### Snippet
```java
    try {
      String sparkPropertiesPath = Utils
          .getDefaultPropertiesFile(scala.collection.JavaConversions.propertiesAsScalaMap(System.getProperties()));
      SparkLauncher sparkLauncher = SparkUtil.initLauncher(sparkPropertiesPath);
      sparkLauncher.addAppArgs(SparkCommand.COMPACT_VALIDATE.toString(), master, sparkMemory, client.getBasePath(),
```

### UnnecessaryFullyQualifiedName
Qualifier `scala.collection` is unnecessary, and can be replaced with an import
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/CompactionCommand.java`
#### Snippet
```java
    HoodieCLI.initFS(initialized);
    String sparkPropertiesPath =
        Utils.getDefaultPropertiesFile(scala.collection.JavaConversions.propertiesAsScalaMap(System.getProperties()));
    SparkLauncher sparkLauncher = SparkUtil.initLauncher(sparkPropertiesPath);
    sparkLauncher.addAppArgs(SparkCommand.COMPACT_SCHEDULE_AND_EXECUTE.toString(), master, sparkMemory, client.getBasePath(),
```

### UnnecessaryFullyQualifiedName
Qualifier `scala.collection` is unnecessary, and can be replaced with an import
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/ArchivedCommitsCommand.java`
#### Snippet
```java
      @ShellOption(value = "--sparkMaster", defaultValue = "local", help = "Spark Master") String master) throws Exception {
    String sparkPropertiesPath =
        Utils.getDefaultPropertiesFile(scala.collection.JavaConversions.propertiesAsScalaMap(System.getProperties()));
    SparkLauncher sparkLauncher = SparkUtil.initLauncher(sparkPropertiesPath);
    String cmd = SparkCommand.ARCHIVE.toString();
```

### UnnecessaryFullyQualifiedName
Qualifier `com.uber.hoodie.hadoop.realtime` is unnecessary, and can be replaced with an import
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/HiveSyncTool.java`
#### Snippet
```java
        // Parquet input format had an InputFormat class visible under the old naming scheme.
        inputFormatClassName = useRealTimeInputFormat
            ? com.uber.hoodie.hadoop.realtime.HoodieRealtimeInputFormat.class.getName()
            : com.uber.hoodie.hadoop.HoodieInputFormat.class.getName();
      }
```

### UnnecessaryFullyQualifiedName
Qualifier `com.uber.hoodie.hadoop` is unnecessary, and can be replaced with an import
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/HiveSyncTool.java`
#### Snippet
```java
        inputFormatClassName = useRealTimeInputFormat
            ? com.uber.hoodie.hadoop.realtime.HoodieRealtimeInputFormat.class.getName()
            : com.uber.hoodie.hadoop.HoodieInputFormat.class.getName();
      }

```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.hadoop.hive.ql` is unnecessary and can be removed
in `hudi-sync/hudi-hive-sync/src/main/java/org/apache/hudi/hive/ddl/HiveQueryDDLExecutor.java`
#### Snippet
```java
      SessionState.start(this.sessionState);
      this.sessionState.setCurrentDatabase(databaseName);
      this.hiveDriver = new org.apache.hadoop.hive.ql.Driver(config.getHiveConf());
    } catch (Exception e) {
      if (sessionState != null) {
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.hudi.io` is unnecessary and can be removed
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/table/ExplicitWriteHandleTable.java`
#### Snippet
```java
/**
 * HoodieTable that need to pass in the
 * {@link org.apache.hudi.io.HoodieWriteHandle} explicitly.
 */
public interface ExplicitWriteHandleTable<T> {
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.hadoop.conf` is unnecessary, and can be replaced with an import
in `hudi-client/hudi-flink-client/src/main/java/org/apache/hudi/client/common/HoodieFlinkEngineContext.java`
#### Snippet
```java
  }

  public HoodieFlinkEngineContext(org.apache.hadoop.conf.Configuration hadoopConf) {
    this(new SerializableConfiguration(hadoopConf), new DefaultTaskContextSupplier());
  }
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.spark.sql.catalyst.expressions` is unnecessary and can be removed
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/model/HoodieInternalRow.java`
#### Snippet
```java
 *   <li>When meta-fields need to be prepended to the source {@link InternalRow}</li>
 *   <li>When meta-fields need to be updated w/in the source {@link InternalRow}
 *   ({@link org.apache.spark.sql.catalyst.expressions.UnsafeRow} currently does not
 *   allow in-place updates due to its memory layout)</li>
 * </ul>
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.spark.sql.catalyst.util` is unnecessary, and can be replaced with an import
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/utils/SparkInternalSchemaConverter.java`
#### Snippet
```java
        // to do support rebaseDate
        if (newType instanceof DateType) {
          int days = org.apache.spark.sql.catalyst.util.DateTimeUtils.fromJavaDate(Date.valueOf(oldV.getUTF8String(i).toString()));
          newV.putInt(i, days);
        } else if (newType instanceof DecimalType) {
```

### UnnecessaryFullyQualifiedName
Qualifier `java.math` is unnecessary, and can be replaced with an import
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/utils/SparkInternalSchemaConverter.java`
#### Snippet
```java
        } else if (newType instanceof DecimalType) {
          DecimalType decimalType = (DecimalType) newType;
          java.math.BigDecimal bigDecimal = new java.math.BigDecimal(oldV.getUTF8String(i).toString().trim());
          Decimal sparkDecimal = Decimal.apply(bigDecimal);
          sparkDecimal.changePrecision(decimalType.precision(), decimalType.scale());
```

### UnnecessaryFullyQualifiedName
Qualifier `java.math` is unnecessary, and can be replaced with an import
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/utils/SparkInternalSchemaConverter.java`
#### Snippet
```java
        } else if (newType instanceof DecimalType) {
          DecimalType decimalType = (DecimalType) newType;
          java.math.BigDecimal bigDecimal = new java.math.BigDecimal(oldV.getUTF8String(i).toString().trim());
          Decimal sparkDecimal = Decimal.apply(bigDecimal);
          sparkDecimal.changePrecision(decimalType.precision(), decimalType.scale());
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.spark.sql.catalyst.util` is unnecessary, and can be replaced with an import
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/client/utils/SparkInternalSchemaConverter.java`
#### Snippet
```java
        }
        // to do support rebaseDate
        String res = org.apache.spark.sql.catalyst.util.DateTimeUtils.toJavaDate(oldV.getInt(i)).toString();
        newV.putByteArray(i, res.getBytes(StandardCharsets.UTF_8));
      }
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.hudi.keygen` is unnecessary and can be removed
in `hudi-client/hudi-spark-client/src/main/java/org/apache/hudi/keygen/factory/HoodieSparkKeyGeneratorFactory.java`
#### Snippet
```java

/**
 * Factory help to create {@link org.apache.hudi.keygen.KeyGenerator}.
 * <p>
 * This factory will try {@link HoodieWriteConfig#KEYGENERATOR_CLASS_NAME} firstly, this ensures the class prop
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.avro` is unnecessary and can be removed
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/commit/HoodieMergeHelper.java`
#### Snippet
```java
      Schema writeSchemaFromFile = AvroInternalSchemaConverter.convert(writeInternalSchema, newWriterSchema.getFullName());
      boolean needToReWriteRecord = sameCols.size() != colNamesFromWriteSchema.size()
          || SchemaCompatibility.checkReaderWriterCompatibility(newWriterSchema, writeSchemaFromFile).getType() == org.apache.avro.SchemaCompatibility.SchemaCompatibilityType.COMPATIBLE;
      if (needToReWriteRecord) {
        Map<String, String> renameCols = InternalSchemaUtils.collectRenameCols(writeInternalSchema, querySchema);
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.hudi.common.model` is unnecessary and can be removed
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/compact/CompactHelpers.java`
#### Snippet
```java
      metadata.addWriteStat(stat.getPartitionPath(), stat);
    }
    metadata.addMetadata(org.apache.hudi.common.model.HoodieCommitMetadata.SCHEMA_KEY, schema);
    if (compactionPlan.getExtraMetadata() != null) {
      compactionPlan.getExtraMetadata().forEach(metadata::addMetadata);
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.hudi.keygen` is unnecessary and can be removed
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/keygen/factory/HoodieAvroKeyGeneratorFactory.java`
#### Snippet
```java

/**
 * Factory help to create {@link org.apache.hudi.keygen.KeyGenerator}.
 * <p>
 * This factory will try {@link HoodieWriteConfig#KEYGENERATOR_CLASS_NAME} firstly, this ensures the class prop
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.hudi.keygen` is unnecessary and can be removed
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/keygen/KeyGenUtils.java`
#### Snippet
```java
   *
   * @see SimpleAvroKeyGenerator
   * @see org.apache.hudi.keygen.ComplexAvroKeyGenerator
   */
  public static String[] extractRecordKeys(String recordKey) {
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.log4j` is unnecessary, and can be replaced with an import
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metrics/JmxMetricsReporter.java`
#### Snippet
```java
public class JmxMetricsReporter extends MetricsReporter {

  private static final org.apache.log4j.Logger LOG = LogManager.getLogger(JmxMetricsReporter.class);

  private final MetricRegistry registry;
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.hudi.common.fs` is unnecessary and can be removed
in `hudi-common/src/main/java/org/apache/hudi/common/fs/FailSafeConsistencyGuard.java`
#### Snippet
```java

  /**
   * Helper to check for file visibility based on {@link org.apache.hudi.common.fs.ConsistencyGuard.FileVisibility} event.
   *
   * @param retryNum retry attempt count.
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.hudi.common.fs` is unnecessary and can be removed
in `hudi-common/src/main/java/org/apache/hudi/common/fs/FailSafeConsistencyGuard.java`
#### Snippet
```java
   * @param dir directory of interest in which list of files are checked for visibility
   * @param files List of files to check for visibility
   * @param event {@link org.apache.hudi.common.fs.ConsistencyGuard.FileVisibility} event of interest.
   * @return {@code true} if condition succeeded. else {@code false}.
   */
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.hudi.common.fs` is unnecessary and can be removed
in `hudi-common/src/main/java/org/apache/hudi/common/fs/FailSafeConsistencyGuard.java`
#### Snippet
```java
   * @param dir directory of interest in which list of files are checked for visibility
   * @param files List of files to check for visibility
   * @param event {@link org.apache.hudi.common.fs.ConsistencyGuard.FileVisibility} event of interest.
   * @throws TimeoutException when retries are exhausted
   */
```

### UnnecessaryFullyQualifiedName
Qualifier `java.sql` is unnecessary and can be removed
in `hudi-common/src/main/java/org/apache/hudi/avro/HoodieAvroUtils.java`
#### Snippet
```java
   * @VisibleForTesting
   */
  public static java.sql.Date toJavaDate(int days) {
    LocalDate date = LocalDate.ofEpochDay(days);
    ZoneId defaultZoneId = ZoneId.systemDefault();
```

### UnnecessaryFullyQualifiedName
Qualifier `java.sql` is unnecessary and can be removed
in `hudi-common/src/main/java/org/apache/hudi/avro/HoodieAvroUtils.java`
#### Snippet
```java
    ZoneId defaultZoneId = ZoneId.systemDefault();
    ZonedDateTime zonedDateTime = date.atStartOfDay(defaultZoneId);
    return new java.sql.Date(zonedDateTime.toInstant().toEpochMilli());
  }

```

### UnnecessaryFullyQualifiedName
Qualifier `java.sql` is unnecessary and can be removed
in `hudi-common/src/main/java/org/apache/hudi/avro/HoodieAvroUtils.java`
#### Snippet
```java
      case INT:
        if (newSchema.getLogicalType() == LogicalTypes.date() && oldSchema.getType() == Schema.Type.STRING) {
          return fromJavaDate(java.sql.Date.valueOf(oldValue.toString()));
        }
        break;
```

### UnnecessaryFullyQualifiedName
Qualifier `java.math` is unnecessary and can be removed
in `hudi-common/src/main/java/org/apache/hudi/avro/HoodieAvroUtils.java`
#### Snippet
```java
            BigDecimal bigDecimal = null;
            if (oldSchema.getType() == Schema.Type.STRING) {
              bigDecimal = new java.math.BigDecimal(oldValue.toString())
                      .setScale(decimal.getScale());
            } else {
```

### UnnecessaryFullyQualifiedName
Qualifier `java.math` is unnecessary and can be removed
in `hudi-common/src/main/java/org/apache/hudi/avro/HoodieAvroUtils.java`
#### Snippet
```java
            } else {
              // Due to Java, there will be precision problems in direct conversion, we should use string instead of use double
              bigDecimal = new java.math.BigDecimal(oldValue.toString())
                      .setScale(decimal.getScale());
            }
```

### UnnecessaryFullyQualifiedName
Qualifier `java.lang` is unnecessary and can be removed
in `hudi-common/src/main/java/org/apache/hudi/common/util/ObjectSizeCalculator.java`
#### Snippet
```java
   * Attempts to detect the current JVM memory layout, but may fail with {@link UnsupportedOperationException};
   *
   * @param obj the object; can be null. Passing in a {@link java.lang.Class} object doesn't do anything special, it
   *        measures the size of all objects reachable through it (which will include its class loader, and by
   *        extension, all other Class objects loaded by the same loader, and all the parent class loaders). It doesn't
```

### UnnecessaryFullyQualifiedName
Qualifier `java.lang` is unnecessary and can be removed
in `hudi-common/src/main/java/org/apache/hudi/common/util/StringUtils.java`
#### Snippet
```java

  /**
   * Wrapper of {@link java.lang.String#join(CharSequence, Iterable)}.
   *
   * Allow return {@code null} when {@code Iterable} is {@code null}.
```

### UnnecessaryFullyQualifiedName
Qualifier `java.time` is unnecessary and can be removed
in `hudi-common/src/main/java/org/apache/hudi/common/util/DateTimeUtils.java`
#### Snippet
```java

  /**
   * Parse input String to a {@link java.time.Instant}.
   *
   * @param s Input String should be Epoch time in millisecond or ISO-8601 format.
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.hudi.common.util.queue` is unnecessary and can be removed
in `hudi-common/src/main/java/org/apache/hudi/common/util/queue/ExecutorType.java`
#### Snippet
```java

/**
 * Types of {@link org.apache.hudi.common.util.queue.HoodieExecutor}.
 */
public enum ExecutorType {
```

### UnnecessaryFullyQualifiedName
Qualifier `java.sql` is unnecessary, and can be replaced with an import
in `hudi-common/src/main/java/org/apache/hudi/common/util/ParquetUtils.java`
#### Snippet
```java
        // Date logical type is implemented as a signed INT32
        // REF: https://github.com/apache/parquet-format/blob/master/LogicalTypes.md
        return java.sql.Date.valueOf(
            primitiveType.stringifier().stringify((Integer) val)
        );
```

### UnnecessaryFullyQualifiedName
Qualifier `java.util` is unnecessary, and can be replaced with an import
in `hudi-common/src/main/java/org/apache/hudi/common/data/HoodieListPairData.java`
#### Snippet
```java
  @Override
  public HoodiePairData<K, V> reduceByKey(SerializableBiFunction<V, V, V> combiner, int parallelism) {
    Map<K, java.util.Optional<V>> reducedMap = asStream().collect(
        Collectors.groupingBy(
            Pair::getKey,
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.hudi.common.model` is unnecessary and can be removed
in `hudi-common/src/main/java/org/apache/hudi/common/model/HoodieRecordGlobalLocation.java`
#### Snippet
```java

/**
 * Similar with {@link org.apache.hudi.common.model.HoodieRecordLocation} but with partition path.
 */
public final class HoodieRecordGlobalLocation extends HoodieRecordLocation {
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.hudi.common.table.log` is unnecessary and can be removed
in `hudi-common/src/main/java/org/apache/hudi/common/table/log/AppendResult.java`
#### Snippet
```java

/**
 * Pojo holding information on the result of a {@link org.apache.hudi.common.table.log.HoodieLogFormat.Writer#appendBlock(HoodieLogBlock)}.
 */
public class AppendResult {
```

### UnnecessaryFullyQualifiedName
Qualifier `java.io` is unnecessary, and can be replaced with an import
in `hudi-common/src/main/java/org/apache/hudi/common/table/HoodieTableMetaClient.java`
#### Snippet
```java
   * @deprecated
   */
  private void readObject(java.io.ObjectInputStream in) throws IOException, ClassNotFoundException {
    in.defaultReadObject();

```

### UnnecessaryFullyQualifiedName
Qualifier `java.io` is unnecessary, and can be replaced with an import
in `hudi-common/src/main/java/org/apache/hudi/common/table/HoodieTableMetaClient.java`
#### Snippet
```java
  }

  private void writeObject(java.io.ObjectOutputStream out) throws IOException {
    out.defaultWriteObject();
  }
```

### UnnecessaryFullyQualifiedName
Qualifier `java.io` is unnecessary, and can be replaced with an import
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/HoodieTableFileSystemView.java`
#### Snippet
```java
  }

  private void writeObject(java.io.ObjectOutputStream out) throws IOException {
    out.defaultWriteObject();
  }
```

### UnnecessaryFullyQualifiedName
Qualifier `java.io` is unnecessary, and can be replaced with an import
in `hudi-common/src/main/java/org/apache/hudi/common/table/view/HoodieTableFileSystemView.java`
#### Snippet
```java
   * @deprecated
   */
  private void readObject(java.io.ObjectInputStream in) throws IOException, ClassNotFoundException {
    in.defaultReadObject();
  }
```

### UnnecessaryFullyQualifiedName
Qualifier `java.util` is unnecessary and can be removed
in `hudi-common/src/main/java/org/apache/hudi/common/config/OrderedProperties.java`
#### Snippet
```java

/**
 * An extension of {@link java.util.Properties} that maintains the order.
 * The implementation is not thread-safe.
 */
```

### UnnecessaryFullyQualifiedName
Qualifier `java.util` is unnecessary and can be removed
in `hudi-common/src/main/java/org/apache/hudi/common/config/TypedProperties.java`
#### Snippet
```java

/**
 * Type-aware extension of {@link java.util.Properties}.
 */
public class TypedProperties extends Properties implements Serializable {
```

### UnnecessaryFullyQualifiedName
Qualifier `java.io` is unnecessary, and can be replaced with an import
in `hudi-common/src/main/java/org/apache/hudi/common/table/timeline/HoodieArchivedTimeline.java`
#### Snippet
```java
   * @deprecated
   */
  private void readObject(java.io.ObjectInputStream in) throws IOException, ClassNotFoundException {
    in.defaultReadObject();
  }
```

### UnnecessaryFullyQualifiedName
Qualifier `java.util` is unnecessary, and can be replaced with an import
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/utils/AvroSchemaEvolutionUtils.java`
#### Snippet
```java
      String rawName = splitPoint > 0 ? name.substring(splitPoint + 1) : name;
      // try to infer add position.
      java.util.Optional<String> inferPosition =
          colNamesFromIncoming.stream().filter(c ->
              c.lastIndexOf(".") == splitPoint
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.hudi.common.table.timeline` is unnecessary and can be removed
in `hudi-common/src/main/java/org/apache/hudi/common/table/timeline/HoodieActiveTimeline.java`
#### Snippet
```java
   * If the given timestamp is invalid, returns {@code Option.empty}.
   * Or a corresponding Date value if these timestamp strings are provided
   *  {@link org.apache.hudi.common.table.timeline.HoodieTimeline#INIT_INSTANT_TS},
   *  {@link org.apache.hudi.common.table.timeline.HoodieTimeline#METADATA_BOOTSTRAP_INSTANT_TS},
   *  {@link org.apache.hudi.common.table.timeline.HoodieTimeline#FULL_BOOTSTRAP_INSTANT_TS}.
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.hudi.common.table.timeline` is unnecessary and can be removed
in `hudi-common/src/main/java/org/apache/hudi/common/table/timeline/HoodieActiveTimeline.java`
#### Snippet
```java
   * Or a corresponding Date value if these timestamp strings are provided
   *  {@link org.apache.hudi.common.table.timeline.HoodieTimeline#INIT_INSTANT_TS},
   *  {@link org.apache.hudi.common.table.timeline.HoodieTimeline#METADATA_BOOTSTRAP_INSTANT_TS},
   *  {@link org.apache.hudi.common.table.timeline.HoodieTimeline#FULL_BOOTSTRAP_INSTANT_TS}.
   * This method is useful when parsing timestamp for metrics
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.hudi.common.table.timeline` is unnecessary and can be removed
in `hudi-common/src/main/java/org/apache/hudi/common/table/timeline/HoodieActiveTimeline.java`
#### Snippet
```java
   *  {@link org.apache.hudi.common.table.timeline.HoodieTimeline#INIT_INSTANT_TS},
   *  {@link org.apache.hudi.common.table.timeline.HoodieTimeline#METADATA_BOOTSTRAP_INSTANT_TS},
   *  {@link org.apache.hudi.common.table.timeline.HoodieTimeline#FULL_BOOTSTRAP_INSTANT_TS}.
   * This method is useful when parsing timestamp for metrics
   *
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.hudi.common.table.timeline` is unnecessary and can be removed
in `hudi-common/src/main/java/org/apache/hudi/common/table/timeline/HoodieActiveTimeline.java`
#### Snippet
```java
   *
   * @param timestamp a timestamp String which follow pattern as
   *  {@link org.apache.hudi.common.table.timeline.HoodieInstantTimeGenerator#SECS_INSTANT_TIMESTAMP_FORMAT}.
   * @return {@code Option<Date>} of instant timestamp, {@code Option.empty} if invalid timestamp
   */
```

### UnnecessaryFullyQualifiedName
Qualifier `java.io` is unnecessary, and can be replaced with an import
in `hudi-common/src/main/java/org/apache/hudi/common/table/timeline/HoodieActiveTimeline.java`
#### Snippet
```java
   */
  @Deprecated
  private void readObject(java.io.ObjectInputStream in) throws IOException, ClassNotFoundException {
    in.defaultReadObject();
  }
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.hudi.common.table.timeline` is unnecessary and can be removed
in `hudi-common/src/main/java/org/apache/hudi/common/table/timeline/HoodieActiveTimeline.java`
#### Snippet
```java
   * Parse the timestamp of an Instant and return a {@code Date}.
   * Throw ParseException if timestamp is not valid format as
   *  {@link org.apache.hudi.common.table.timeline.HoodieInstantTimeGenerator#SECS_INSTANT_TIMESTAMP_FORMAT}.
   *
   * @param timestamp a timestamp String which follow pattern as
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.hudi.common.table.timeline` is unnecessary and can be removed
in `hudi-common/src/main/java/org/apache/hudi/common/table/timeline/HoodieActiveTimeline.java`
#### Snippet
```java
   *
   * @param timestamp a timestamp String which follow pattern as
   *  {@link org.apache.hudi.common.table.timeline.HoodieInstantTimeGenerator#SECS_INSTANT_TIMESTAMP_FORMAT}.
   * @return Date of instant timestamp
   */
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.hudi.internal.schema` is unnecessary and can be removed
in `hudi-common/src/main/java/org/apache/hudi/internal/schema/convert/AvroInternalSchemaConverter.java`
#### Snippet
```java
   * @param cache use to cache intermediate convert result to save cost.
   * @param recordName auto-generated record name used as a fallback, in case
   * {@link org.apache.hudi.internal.schema.Types.RecordType} doesn't bear original record-name
   * @return a Avro schema match this type
   */
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.avro` is unnecessary and can be removed
in `hudi-common/src/main/java/org/apache/hudi/metadata/HoodieTableMetadataUtil.java`
#### Snippet
```java
  /**
   * Does an upcast for {@link BigDecimal} instance to align it with scale/precision expected by
   * the {@link org.apache.avro.LogicalTypes.Decimal} Avro logical type
   */
  public static BigDecimal tryUpcastDecimal(BigDecimal value, final LogicalTypes.Decimal decimal) {
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.hadoop.hive.shims` is unnecessary, and can be replaced with an import
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/hive/HoodieCombineHiveInputFormat.java`
#### Snippet
```java
   */
  public static class HoodieCombineFileInputFormatShim<K, V> extends CombineFileInputFormat<K, V>
      implements org.apache.hadoop.hive.shims.HadoopShims.CombineFileInputFormatShim<K, V> {

    private boolean hoodieFilter = false;
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.hudi.common.config` is unnecessary and can be removed
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieIndexer.java`
#### Snippet
```java
 * A tool to run metadata indexing asynchronously.
 * <p>
 * Example command (assuming indexer.properties contains related index configs, see {@link org.apache.hudi.common.config.HoodieMetadataConfig} for configs):
 * <p>
 * spark-submit \
```

### UnnecessaryFullyQualifiedName
Qualifier `scala` is unnecessary, and can be replaced with an import
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/schema/HiveSchemaProvider.java`
#### Snippet
```java
    // source schema
    try {
      TableIdentifier sourceSchemaTable = new TableIdentifier(sourceSchemaTableName, scala.Option.apply(sourceSchemaDatabaseName));
      StructType sourceSchema = spark.sessionState().catalog().getTableMetadata(sourceSchemaTable).schema();
      this.sourceSchema = AvroConversionUtils.convertStructTypeToAvroSchema(
```

### UnnecessaryFullyQualifiedName
Qualifier `scala` is unnecessary, and can be replaced with an import
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/schema/HiveSchemaProvider.java`
#### Snippet
```java
      String targetSchemaTableName = props.getString(Config.TARGET_SCHEMA_TABLE_PROP);
      try {
        TableIdentifier targetSchemaTable = new TableIdentifier(targetSchemaTableName, scala.Option.apply(targetSchemaDatabaseName));
        StructType targetSchema = spark.sessionState().catalog().getTableMetadata(targetSchemaTable).schema();
        this.targetSchema = AvroConversionUtils.convertStructTypeToAvroSchema(
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.kafka.common.errors` is unnecessary, and can be replaced with an import
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/KafkaSource.java`
#### Snippet
```java
      JavaRDD<T> newDataRDD = toRDD(offsetRanges);
      return new InputBatch<>(Option.of(newDataRDD), KafkaOffsetGen.CheckpointUtils.offsetsToStr(offsetRanges));
    } catch (org.apache.kafka.common.errors.TimeoutException e) {
      throw new HoodieSourceTimeoutException("Kafka Source timed out " + e.getMessage());
    }
```

### UnnecessaryFullyQualifiedName
Qualifier `com.google.cloud.pubsub.v1.stub` is unnecessary and can be removed
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/sources/helpers/gcs/PubsubMessagesFetcher.java`
#### Snippet
```java
    try {
      /** For details of timeout and retry configs,
       * see {@link com.google.cloud.pubsub.v1.stub.SubscriberStubSettings#initDefaults()},
       * and the static code block in SubscriberStubSettings */
      subscriberStubSettings =
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.hudi.common.util` is unnecessary and can be removed
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/deltastreamer/SourceFormatAdapter.java`
#### Snippet
```java
                  // to avoid nullability mismatch between Avro schema and Row schema
                  ? HoodieSparkUtils.createRdd(rdd, HOODIE_RECORD_STRUCT_NAME, HOODIE_RECORD_NAMESPACE, true,
                  org.apache.hudi.common.util.Option.ofNullable(r.getSchemaProvider().getSourceSchema())
              ).toJavaRDD() : HoodieSparkUtils.createRdd(rdd,
                  HOODIE_RECORD_STRUCT_NAME, HOODIE_RECORD_NAMESPACE, false, Option.empty()).toJavaRDD();
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.flink.configuration` is unnecessary and can be removed
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/compact/FlinkCompactionConfig.java`
#### Snippet
```java
   * (set by `--hoodie-conf` option).
   */
  public static org.apache.flink.configuration.Configuration toFlinkConfig(FlinkCompactionConfig config) {
    org.apache.flink.configuration.Configuration conf = new Configuration();

```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.flink.configuration` is unnecessary and can be removed
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/compact/FlinkCompactionConfig.java`
#### Snippet
```java
   */
  public static org.apache.flink.configuration.Configuration toFlinkConfig(FlinkCompactionConfig config) {
    org.apache.flink.configuration.Configuration conf = new Configuration();

    conf.setString(FlinkOptions.PATH, config.path);
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.flink.configuration` is unnecessary and can be removed
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/sink/clustering/FlinkClusteringConfig.java`
#### Snippet
```java
  public static Configuration toFlinkConfig(FlinkClusteringConfig config) {
    Map<String, String> propsMap = new HashMap<String, String>((Map) getProps(config));
    org.apache.flink.configuration.Configuration conf = fromMap(propsMap);

    conf.setString(FlinkOptions.PATH, config.path);
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.flink.table.connector` is unnecessary and can be removed
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/util/ChangelogModes.java`
#### Snippet
```java

/**
 * Utilities for all kinds of common {@link org.apache.flink.table.connector.ChangelogMode}s.
 */
public class ChangelogModes {
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.flink.api.common.io` is unnecessary and can be removed
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/util/InputFormats.java`
#### Snippet
```java

/**
 * Utilities for all kinds of {@link org.apache.flink.api.common.io.InputFormat}s.
 */
public class InputFormats {
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.hudi.client` is unnecessary and can be removed
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/util/FlinkWriteClients.java`
#### Snippet
```java

/**
 * Utilities for {@link org.apache.hudi.client.HoodieFlinkWriteClient}.
 */
public class FlinkWriteClients {
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.hudi.table` is unnecessary and can be removed
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/util/FlinkTables.java`
#### Snippet
```java

/**
 * Utilities for {@link org.apache.hudi.table.HoodieFlinkTable}.
 */
public class FlinkTables {
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.flink.configuration` is unnecessary and can be removed
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/util/StreamerUtil.java`
#### Snippet
```java
  }

  public static Schema getSourceSchema(org.apache.flink.configuration.Configuration conf) {
    if (conf.getOptional(FlinkOptions.SOURCE_AVRO_SCHEMA_PATH).isPresent()) {
      return new FilebasedSchemaProvider(conf).getSourceSchema();
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.flink.table.types` is unnecessary and can be removed
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/util/DataTypeUtils.java`
#### Snippet
```java

/**
 * Utilities for {@link org.apache.flink.table.types.DataType}.
 */
public class DataTypeUtils {
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.flink.table.api` is unnecessary, and can be replaced with an import
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/catalog/HiveSchemaUtils.java`
#### Snippet
```java
  }

  public static org.apache.flink.table.api.Schema convertTableSchema(Table hiveTable) {
    List<FieldSchema> allCols = hiveTable.getSd().getCols().stream()
        // filter out the metadata columns
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.flink.table.api` is unnecessary, and can be replaced with an import
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/catalog/HiveSchemaUtils.java`
#### Snippet
```java
    }

    org.apache.flink.table.api.Schema.Builder builder = org.apache.flink.table.api.Schema.newBuilder().fromFields(colNames, colTypes);
    if (!StringUtils.isNullOrEmpty(pkConstraintName)) {
      builder.primaryKeyNamed(pkConstraintName, pkColumns);
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.flink.table.api` is unnecessary, and can be replaced with an import
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/catalog/HiveSchemaUtils.java`
#### Snippet
```java
    }

    org.apache.flink.table.api.Schema.Builder builder = org.apache.flink.table.api.Schema.newBuilder().fromFields(colNames, colTypes);
    if (!StringUtils.isNullOrEmpty(pkConstraintName)) {
      builder.primaryKeyNamed(pkConstraintName, pkColumns);
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.hadoop.fs` is unnecessary, and can be replaced with an import
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/mor/MergeOnReadInputFormat.java`
#### Snippet
```java
    // generate partition specs.
    LinkedHashMap<String, String> partSpec = FilePathUtils.extractPartitionKeyValues(
        new org.apache.hadoop.fs.Path(path).getParent(),
        this.conf.getBoolean(FlinkOptions.HIVE_STYLE_PARTITIONING),
        FilePathUtils.extractPartitionKeys(this.conf));
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.flink.core.fs` is unnecessary, and can be replaced with an import
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/table/format/mor/MergeOnReadInputFormat.java`
#### Snippet
```java
        requiredPos,
        2048,
        new org.apache.flink.core.fs.Path(path),
        0,
        Long.MAX_VALUE); // read the whole file
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.flink.table.expressions` is unnecessary and can be removed
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/source/stats/ExpressionEvaluator.java`
#### Snippet
```java

/**
 * Tool to evaluate the {@link org.apache.flink.table.expressions.ResolvedExpression}s.
 */
public class ExpressionEvaluator {
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.flink.configuration` is unnecessary and can be removed
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/source/FileIndex.java`
#### Snippet
```java
  }

  private static HoodieMetadataConfig metadataConfig(org.apache.flink.configuration.Configuration conf) {
    Properties properties = new Properties();

```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.flink.configuration` is unnecessary and can be removed
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/streamer/FlinkStreamerConfig.java`
#### Snippet
```java
   */
  @SuppressWarnings("unchecked, rawtypes")
  public static org.apache.flink.configuration.Configuration toFlinkConfig(FlinkStreamerConfig config) {
    Map<String, String> propsMap = new HashMap<String, String>((Map) StreamerUtil.getProps(config));
    org.apache.flink.configuration.Configuration conf = fromMap(propsMap);
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.flink.configuration` is unnecessary and can be removed
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/streamer/FlinkStreamerConfig.java`
#### Snippet
```java
  public static org.apache.flink.configuration.Configuration toFlinkConfig(FlinkStreamerConfig config) {
    Map<String, String> propsMap = new HashMap<String, String>((Map) StreamerUtil.getProps(config));
    org.apache.flink.configuration.Configuration conf = fromMap(propsMap);

    conf.setString(FlinkOptions.PATH, config.targetBasePath);
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.flink.configuration` is unnecessary and can be removed
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/configuration/HadoopConfigurations.java`
#### Snippet
```java
   */
  public static org.apache.hadoop.conf.Configuration getParquetConf(
      org.apache.flink.configuration.Configuration options,
      org.apache.hadoop.conf.Configuration hadoopConf) {
    org.apache.hadoop.conf.Configuration copy = new org.apache.hadoop.conf.Configuration(hadoopConf);
```

### UnnecessaryFullyQualifiedName
Qualifier `java.lang.reflect` is unnecessary, and can be replaced with an import
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/configuration/OptionsResolver.java`
#### Snippet
```java
    List<ConfigOption<?>> options = new ArrayList<>();
    for (Field field : declaredFields) {
      if (java.lang.reflect.Modifier.isStatic(field.getModifiers())
          && field.getType().equals(ConfigOption.class)) {
        try {
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.parquet.column` is unnecessary, and can be replaced with an import
in `hudi-flink-datasource/hudi-flink1.13.x/src/main/java/org/apache/hudi/table/format/cow/vector/reader/Int64TimestampColumnReader.java`
#### Snippet
```java
  public static TimestampData decodeInt64ToTimestamp(
      boolean utcTimestamp,
      org.apache.parquet.column.Dictionary dictionary,
      int id,
      ChronoUnit unit) {
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.hudi.util` is unnecessary and can be removed
in `hudi-flink-datasource/hudi-flink/src/main/java/org/apache/hudi/source/stats/ColumnStatsIndices.java`
#### Snippet
```java
        metadataTable.getRecordsByKeyPrefixes(encodedTargetColumnNames, HoodieTableMetadataUtil.PARTITION_NAME_COLUMN_STATS, false);

    org.apache.hudi.util.AvroToRowDataConverters.AvroToRowDataConverter converter =
        AvroToRowDataConverters.createRowConverter((RowType) METADATA_DATA_TYPE.getLogicalType());
    return records.collectAsList().stream().parallel().map(record -> {
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.parquet.column` is unnecessary, and can be replaced with an import
in `hudi-flink-datasource/hudi-flink1.14.x/src/main/java/org/apache/hudi/table/format/cow/vector/reader/Int64TimestampColumnReader.java`
#### Snippet
```java
  public static TimestampData decodeInt64ToTimestamp(
      boolean utcTimestamp,
      org.apache.parquet.column.Dictionary dictionary,
      int id,
      ChronoUnit unit) {
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.parquet.column` is unnecessary, and can be replaced with an import
in `hudi-flink-datasource/hudi-flink1.15.x/src/main/java/org/apache/hudi/table/format/cow/vector/reader/Int64TimestampColumnReader.java`
#### Snippet
```java
  public static TimestampData decodeInt64ToTimestamp(
      boolean utcTimestamp,
      org.apache.parquet.column.Dictionary dictionary,
      int id,
      ChronoUnit unit) {
```

### UnnecessaryFullyQualifiedName
Qualifier `org.apache.parquet.column` is unnecessary, and can be replaced with an import
in `hudi-flink-datasource/hudi-flink1.16.x/src/main/java/org/apache/hudi/table/format/cow/vector/reader/Int64TimestampColumnReader.java`
#### Snippet
```java
  public static TimestampData decodeInt64ToTimestamp(
      boolean utcTimestamp,
      org.apache.parquet.column.Dictionary dictionary,
      int id,
      ChronoUnit unit) {
```

### UnnecessaryFullyQualifiedName
Qualifier `io.javalin.core.compression` is unnecessary, and can be replaced with an import
in `hudi-timeline-service/src/main/java/org/apache/hudi/timeline/service/TimelineService.java`
#### Snippet
```java
    app = Javalin.create(c -> {
      if (!timelineServerConf.compress) {
        c.compressionStrategy(io.javalin.core.compression.CompressionStrategy.NONE);
      }
      c.server(() -> server);
```

## RuleId[ruleID=ThrowablePrintStackTrace]
### ThrowablePrintStackTrace
Call to `printStackTrace()` should probably be replaced with more robust logging
in `hudi-cli/src/main/java/org/apache/hudi/cli/utils/InputStreamConsumer.java`
#### Snippet
```java
    } catch (Exception e) {
      LOG.fatal(e.toString());
      e.printStackTrace();
    }
  }
```

### ThrowablePrintStackTrace
Call to `printStackTrace()` should probably be replaced with more robust logging
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/RestoresCommand.java`
#### Snippet
```java
      }
    } catch (IOException e) {
      e.printStackTrace();
    }
  }
```

### ThrowablePrintStackTrace
Call to `printStackTrace()` should probably be replaced with more robust logging
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/RollbacksCommand.java`
#### Snippet
```java
        });
      } catch (IOException e) {
        e.printStackTrace();
      }
    });
```

### ThrowablePrintStackTrace
Call to `printStackTrace()` should probably be replaced with more robust logging
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/ArchivedCommitsCommand.java`
#### Snippet
```java
      }
    } catch (Exception e) {
      e.printStackTrace();
      return new Comparable[] {};
    }
```

### ThrowablePrintStackTrace
Call to `printStackTrace()` should probably be replaced with more robust logging
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/TimelineCommand.java`
#### Snippet
```java
          limit, sortByField, descending, headerOnly, true, showTimeSeconds, false);
    } catch (IOException e) {
      e.printStackTrace();
      return e.getMessage();
    }
```

### ThrowablePrintStackTrace
Call to `printStackTrace()` should probably be replaced with more robust logging
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/TimelineCommand.java`
#### Snippet
```java
          limit, sortByField, descending, headerOnly, true, showTimeSeconds, showRollbackInfo);
    } catch (IOException e) {
      e.printStackTrace();
      return e.getMessage();
    }
```

### ThrowablePrintStackTrace
Call to `printStackTrace()` should probably be replaced with more robust logging
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/TimelineCommand.java`
#### Snippet
```java
      } catch (IOException e) {
        LOG.error(String.format("Error reading rollback info of %s", rollbackInstant));
        e.printStackTrace();
      }
    });
```

### ThrowablePrintStackTrace
Call to `printStackTrace()` should probably be replaced with more robust logging
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/TimelineCommand.java`
#### Snippet
```java
    } catch (IOException e) {
      LOG.error(String.format("Error reading rollback info of %s", instant));
      e.printStackTrace();
      return "-";
    }
```

### ThrowablePrintStackTrace
Call to `printStackTrace()` should probably be replaced with more robust logging
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/TimelineCommand.java`
#### Snippet
```java
          limit, sortByField, descending, headerOnly, true, showTimeSeconds, false);
    } catch (IOException e) {
      e.printStackTrace();
      return e.getMessage();
    }
```

### ThrowablePrintStackTrace
Call to `printStackTrace()` should probably be replaced with more robust logging
in `hudi-cli/src/main/java/org/apache/hudi/cli/commands/TimelineCommand.java`
#### Snippet
```java
          limit, sortByField, descending, headerOnly, true, showTimeSeconds, showRollbackInfo);
    } catch (IOException e) {
      e.printStackTrace();
      return e.getMessage();
    }
```

### ThrowablePrintStackTrace
Call to `printStackTrace()` should probably be replaced with more robust logging
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/metrics/prometheus/PushGatewayReporter.java`
#### Snippet
```java
        pushGateway = new PushGateway(new URL("https://" + serverUrl));
      } catch (MalformedURLException e) {
        e.printStackTrace();
        throw new IllegalArgumentException("Malformed pushgateway host: " + serverHost);
      }
```

### ThrowablePrintStackTrace
Call to `printStackTrace()` should probably be replaced with more robust logging
in `hudi-common/src/main/java/org/apache/hudi/common/config/HoodieConfig.java`
#### Snippet
```java
            }
          } catch (IllegalAccessException e) {
            e.printStackTrace();
          }
        });
```

## RuleId[ruleID=Java8MapApi]
### Java8MapApi
Can be replaced with single 'Map.computeIfAbsent' method call
in `hudi-client/hudi-client-common/src/main/java/org/apache/hudi/table/action/bootstrap/BootstrapUtils.java`
#### Snippet
```java
        Integer level = val.getRight().getLeft();
        List<String> dirs = levelToPartitions.get(level);
        if (null == dirs) {
          dirs = new ArrayList<>();
          levelToPartitions.put(level, dirs);
```

### Java8MapApi
Can be replaced with single 'Map.getOrDefault' method call
in `hudi-utilities/src/main/java/org/apache/hudi/utilities/HoodieDataTableValidator.java`
#### Snippet
```java
          Option<Set<String>> filesFromTimeline = RepairUtils.getBaseAndLogFilePathsFromTimeline(
              activeTimeline, instant);
          List<String> baseAndLogFilesFromFs = instantToFilesMap.containsKey(instant.getTimestamp()) ? instantToFilesMap.get(instant.getTimestamp())
              : Collections.emptyList();
          if (!baseAndLogFilesFromFs.isEmpty()) {
```

## RuleId[ruleID=Convert2Lambda]
### Convert2Lambda
Anonymous new Comparator() can be replaced with lambda
in `hudi-client/hudi-java-client/src/main/java/org/apache/hudi/execution/bulkinsert/JavaGlobalSortPartitioner.java`
#### Snippet
```java
                                                  int outputPartitions) {
    // Now, sort the records and line them up nicely for loading.
    records.sort(new Comparator() {
      @Override
      public int compare(Object o1, Object o2) {
```

### Convert2Lambda
Anonymous new Runnable() can be replaced with lambda
in `hudi-common/src/main/java/org/apache/hudi/common/util/CustomizedThreadFactory.java`
#### Snippet
```java
  @Override
  public Thread newThread(@Nonnull Runnable r) {
    Thread runThread = preExecuteRunnable == null ? new Thread(r) : new Thread(new Runnable() {

      @Override
```

## RuleId[ruleID=EqualsWhichDoesntCheckParameterClass]
### EqualsWhichDoesntCheckParameterClass
`equals()` should check the class of its parameter
in `hudi-common/src/main/java/org/apache/hudi/common/fs/HoodieWrapperFileSystem.java`
#### Snippet
```java

  @Override
  public boolean equals(Object obj) {
    return fileSystem.equals(obj);
  }
```

## RuleId[ruleID=BigDecimalMethodWithoutRoundingCalled]
### BigDecimalMethodWithoutRoundingCalled
'BigDecimal.setScale()' called without a rounding mode argument
in `hudi-common/src/main/java/org/apache/hudi/avro/HoodieAvroUtils.java`
#### Snippet
```java
            if (oldSchema.getType() == Schema.Type.STRING) {
              bigDecimal = new java.math.BigDecimal(oldValue.toString())
                      .setScale(decimal.getScale());
            } else {
              // Due to Java, there will be precision problems in direct conversion, we should use string instead of use double
```

### BigDecimalMethodWithoutRoundingCalled
'BigDecimal.setScale()' called without a rounding mode argument
in `hudi-common/src/main/java/org/apache/hudi/avro/HoodieAvroUtils.java`
#### Snippet
```java
              // Due to Java, there will be precision problems in direct conversion, we should use string instead of use double
              bigDecimal = new java.math.BigDecimal(oldValue.toString())
                      .setScale(decimal.getScale());
            }
            return DECIMAL_CONVERSION.toFixed(bigDecimal, newSchema, newSchema.getLogicalType());
```

### BigDecimalMethodWithoutRoundingCalled
'BigDecimal.setScale()' called without a rounding mode argument
in `hudi-common/src/main/java/org/apache/hudi/avro/HoodieAvroUtils.java`
#### Snippet
```java
              bytes = ((GenericFixed) oldValue).bytes();
              Decimal decimal = (Decimal) oldSchema.getLogicalType();
              BigDecimal bd = new BigDecimal(new BigInteger(bytes), decimal.getScale()).setScale(((Decimal) newSchema.getLogicalType()).getScale());
              return DECIMAL_CONVERSION.toFixed(bd, newSchema, newSchema.getLogicalType());
            } else {
```

### BigDecimalMethodWithoutRoundingCalled
'BigDecimal.setScale()' called without a rounding mode argument
in `hudi-common/src/main/java/org/apache/hudi/common/util/AvroOrcUtils.java`
#### Snippet
```java
        BigDecimal bigDecimal = ((DecimalColumnVector) colVector).vector[vectorPos]
            .getHiveDecimal().bigDecimalValue()
            .setScale(((LogicalTypes.Decimal) logicalType).getScale());
        Schema.Type baseType = avroSchema.getType();
        if (baseType.equals(Schema.Type.FIXED)) {
```

### BigDecimalMethodWithoutRoundingCalled
'BigDecimal.setScale()' called without a rounding mode argument
in `hudi-hadoop-mr/src/main/java/org/apache/hudi/hadoop/utils/HiveAvroSerializer.java`
#### Snippet
```java
        HiveDecimal dec = (HiveDecimal)fieldOI.getPrimitiveJavaObject(structFieldData);
        LogicalTypes.Decimal decimal = (LogicalTypes.Decimal)schema.getLogicalType();
        BigDecimal bd = new BigDecimal(dec.toString()).setScale(decimal.getScale());
        return HoodieAvroUtils.DECIMAL_CONVERSION.toFixed(bd, schema, decimal);
      case CHAR:
```

