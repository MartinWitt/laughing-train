# pinot 
 
# Bad smells
I found 3616 bad smells with 167 repairable:
| ruleID | number | fixable |
| --- | --- | --- |
| JavadocDeclaration | 568 | false |
| FieldMayBeFinal | 313 | false |
| DefaultAnnotationParam | 298 | false |
| DuplicatedCode | 276 | false |
| Deprecation | 264 | false |
| DataFlowIssue | 166 | false |
| JavadocReference | 133 | false |
| FieldCanBeLocal | 132 | false |
| UNCHECKED_WARNING | 126 | false |
| UnstableApiUsage | 114 | false |
| ConstantValue | 82 | false |
| AutoCloseableResource | 80 | false |
| DeprecatedIsStillUsed | 74 | false |
| AccessStaticViaInstance | 72 | false |
| UnnecessaryLocalVariable | 65 | true |
| DanglingJavadoc | 58 | false |
| NullableProblems | 48 | false |
| UnnecessaryToStringCall | 46 | true |
| IgnoreResultOfCall | 45 | false |
| UnusedAssignment | 42 | false |
| CharsetObjectCanBeUsed | 32 | false |
| RedundantMethodOverride | 31 | false |
| SwitchStatementWithConfusingDeclaration | 30 | false |
| JavadocLinkAsPlainText | 29 | false |
| BusyWait | 27 | false |
| IntegerMultiplicationImplicitCastToLong | 26 | false |
| ToArrayCallWithZeroLengthArrayArgument | 21 | true |
| ArraysAsListWithZeroOrOneArgument | 21 | false |
| StringConcatenationInsideStringBufferAppend | 21 | false |
| RedundantCast | 17 | false |
| DuplicateBranchesInSwitch | 15 | false |
| NonAtomicOperationOnVolatileField | 15 | false |
| UnnecessarySemicolon | 14 | false |
| WrapperTypeMayBePrimitive | 13 | false |
| UnnecessaryModifier | 12 | true |
| MismatchedCollectionQueryUpdate | 12 | false |
| SimplifyStreamApiCallChains | 12 | false |
| StringBufferReplaceableByString | 12 | false |
| InnerClassMayBeStatic | 12 | true |
| CommentedOutCode | 11 | false |
| StringConcatenationInLoops | 10 | false |
| TrivialIf | 9 | false |
| SwitchStatementWithTooFewBranches | 9 | false |
| EqualsWhichDoesntCheckParameterClass | 9 | false |
| TrivialStringConcatenation | 8 | false |
| UnnecessaryCallToStringValueOf | 8 | false |
| ManualMinMaxCalculation | 8 | false |
| RegExpRedundantEscape | 7 | false |
| UseBulkOperation | 7 | false |
| ProtectedMemberInFinalClass | 6 | true |
| ConditionCoveredByFurtherCondition | 6 | false |
| RegExpSimplifiable | 5 | false |
| SimplifyOptionalCallChains | 5 | false |
| SlowAbstractSetRemoveAll | 5 | false |
| UnnecessaryContinue | 5 | false |
| MismatchedArrayReadWrite | 4 | false |
| PointlessArithmeticExpression | 4 | false |
| EmptyStatementBody | 4 | false |
| PointlessBitwiseExpression | 4 | false |
| CaughtExceptionImmediatelyRethrown | 4 | false |
| RedundantFileCreation | 4 | false |
| IntegerDivisionInFloatingPointContext | 4 | false |
| DuplicateExpressions | 4 | false |
| MismatchedJavadocCode | 4 | false |
| ThrowableNotThrown | 4 | false |
| FinalMethodInFinalClass | 3 | false |
| StringOperationCanBeSimplified | 3 | false |
| ImplicitArrayToString | 3 | false |
| RefusedBequest | 3 | false |
| RedundantArrayCreation | 3 | true |
| SimplifiableConditionalExpression | 3 | false |
| IfStatementWithIdenticalBranches | 3 | false |
| RedundantStringFormatCall | 3 | false |
| FuseStreamOperations | 3 | false |
| InfiniteRecursion | 3 | false |
| DoubleCheckedLocking | 2 | false |
| DuplicateCondition | 2 | false |
| ExcessiveLambdaUsage | 2 | false |
| ManualArrayToCollectionCopy | 2 | false |
| UnaryPlus | 2 | false |
| OptionalUsedAsFieldOrParameterType | 2 | false |
| ReplaceAllDot | 2 | false |
| ComparatorMethodParameterNotUsed | 2 | false |
| StringEquality | 2 | false |
| AssertWithSideEffects | 2 | false |
| UnnecessaryReturn | 2 | true |
| MalformedFormatString | 2 | false |
| SlowListContainsAll | 2 | false |
| InfiniteLoopStatement | 2 | false |
| RedundantCollectionOperation | 2 | false |
| CatchMayIgnoreException | 2 | false |
| CollectionAddAllCanBeReplacedWithConstructor | 2 | false |
| SuspiciousMethodCalls | 2 | false |
| CopyConstructorMissesField | 2 | false |
| FinalPrivateMethod | 1 | false |
| EqualsBetweenInconvertibleTypes | 1 | false |
| ReturnFromFinallyBlock | 1 | false |
| SuspiciousNameCombination | 1 | false |
| TypeParameterHidesVisibleType | 1 | false |
| FinallyBlockCannotCompleteNormally | 1 | false |
| SynchronizationOnLocalVariableOrMethodParameter | 1 | false |
| ConditionalBreakInInfiniteLoop | 1 | false |
| LoopStatementsThatDontLoop | 1 | false |
| ManualArrayCopy | 1 | false |
| PointlessNullCheck | 1 | false |
| TypeParameterExtendsObject | 1 | false |
| OptionalGetWithoutIsPresent | 1 | false |
| OptionalIsPresent | 1 | false |
| BigDecimalMethodWithoutRoundingCalled | 1 | false |
| CastCanBeRemovedNarrowingVariableType | 1 | false |
## RuleId[id=ToArrayCallWithZeroLengthArrayArgument]
### ToArrayCallWithZeroLengthArrayArgument
Call to `toArray()` with pre-sized array argument 'new String\[arguments.size()\]'
in `pinot-tools/src/main/java/org/apache/pinot/tools/RealtimeComplexTypeHandlingQuickStart.java`
#### Snippet
```java
    arguments.addAll(Arrays.asList("QuickStart", "-type", "REALTIME-COMPLEX-TYPE"));
    arguments.addAll(Arrays.asList(args));
    PinotAdministrator.main(arguments.toArray(new String[arguments.size()]));
  }

```

### ToArrayCallWithZeroLengthArrayArgument
Call to `toArray()` with pre-sized array argument 'new String\[arguments.size()\]'
in `pinot-tools/src/main/java/org/apache/pinot/tools/RealtimeQuickStart.java`
#### Snippet
```java
    arguments.addAll(Arrays.asList("QuickStart", "-type", "REALTIME"));
    arguments.addAll(Arrays.asList(args));
    PinotAdministrator.main(arguments.toArray(new String[arguments.size()]));
  }

```

### ToArrayCallWithZeroLengthArrayArgument
Call to `toArray()` with pre-sized array argument 'new String\[arguments.size()\]'
in `pinot-tools/src/main/java/org/apache/pinot/tools/OfflineComplexTypeHandlingQuickStart.java`
#### Snippet
```java
    arguments.addAll(Arrays.asList("QuickStart", "-type", "BATCH-COMPLEX-TYPE"));
    arguments.addAll(Arrays.asList(args));
    PinotAdministrator.main(arguments.toArray(new String[arguments.size()]));
  }
}
```

### ToArrayCallWithZeroLengthArrayArgument
Call to `toArray()` with pre-sized array argument 'new String\[arguments.size()\]'
in `pinot-tools/src/main/java/org/apache/pinot/tools/MultistageEngineQuickStart.java`
#### Snippet
```java
    arguments.addAll(Arrays.asList("QuickStart", "-type", "MULTI_STAGE"));
    arguments.addAll(Arrays.asList(args));
    PinotAdministrator.main(arguments.toArray(new String[arguments.size()]));
  }
}
```

### ToArrayCallWithZeroLengthArrayArgument
Call to `toArray()` with pre-sized array argument 'new String\[arguments.size()\]'
in `pinot-tools/src/main/java/org/apache/pinot/tools/EmptyQuickstart.java`
#### Snippet
```java
    arguments.addAll(Arrays.asList("QuickStart", "-type", "EMPTY"));
    arguments.addAll(Arrays.asList(args));
    PinotAdministrator.main(arguments.toArray(new String[arguments.size()]));
  }
}
```

### ToArrayCallWithZeroLengthArrayArgument
Call to `toArray()` with pre-sized array argument 'new String\[arguments.size()\]'
in `pinot-tools/src/main/java/org/apache/pinot/tools/JoinQuickStart.java`
#### Snippet
```java
    arguments.addAll(Arrays.asList("QuickStart", "-type", "JOIN"));
    arguments.addAll(Arrays.asList(args));
    PinotAdministrator.main(arguments.toArray(new String[arguments.size()]));
  }
}
```

### ToArrayCallWithZeroLengthArrayArgument
Call to `toArray()` with pre-sized array argument 'new String\[arguments.size()\]'
in `pinot-tools/src/main/java/org/apache/pinot/tools/RealtimeQuickStartWithMinion.java`
#### Snippet
```java
    arguments.addAll(Arrays.asList("QuickStart", "-type", "REALTIME-MINION"));
    arguments.addAll(Arrays.asList(args));
    PinotAdministrator.main(arguments.toArray(new String[arguments.size()]));
  }

```

### ToArrayCallWithZeroLengthArrayArgument
Call to `toArray()` with pre-sized array argument 'new String\[arguments.size()\]'
in `pinot-tools/src/main/java/org/apache/pinot/tools/JsonIndexQuickStart.java`
#### Snippet
```java
    arguments.addAll(Arrays.asList("QuickStart", "-type", "BATCH-JSON-INDEX"));
    arguments.addAll(Arrays.asList(args));
    PinotAdministrator.main(arguments.toArray(new String[arguments.size()]));
  }
}
```

### ToArrayCallWithZeroLengthArrayArgument
Call to `toArray()` with pre-sized array argument 'new String\[arguments.size()\]'
in `pinot-tools/src/main/java/org/apache/pinot/tools/RealtimeJsonIndexQuickStart.java`
#### Snippet
```java
    arguments.addAll(Arrays.asList("QuickStart", "-type", "REALTIME-JSON-INDEX"));
    arguments.addAll(Arrays.asList(args));
    PinotAdministrator.main(arguments.toArray(new String[arguments.size()]));
  }
}
```

### ToArrayCallWithZeroLengthArrayArgument
Call to `toArray()` with pre-sized array argument 'new String\[arguments.size()\]'
in `pinot-tools/src/main/java/org/apache/pinot/tools/TimestampIndexQuickstart.java`
#### Snippet
```java
    arguments.addAll(Arrays.asList("QuickStart", "-type", "TIMESTAMP"));
    arguments.addAll(Arrays.asList(args));
    PinotAdministrator.main(arguments.toArray(new String[arguments.size()]));
  }
}
```

### ToArrayCallWithZeroLengthArrayArgument
Call to `toArray()` with pre-sized array argument 'new String\[arguments.size()\]'
in `pinot-tools/src/main/java/org/apache/pinot/tools/HybridQuickstart.java`
#### Snippet
```java
    arguments.addAll(Arrays.asList("QuickStart", "-type", "HYBRID"));
    arguments.addAll(Arrays.asList(args));
    PinotAdministrator.main(arguments.toArray(new String[arguments.size()]));
  }

```

### ToArrayCallWithZeroLengthArrayArgument
Call to `toArray()` with pre-sized array argument 'new String\[arguments.size()\]'
in `pinot-tools/src/main/java/org/apache/pinot/tools/UpsertQuickStart.java`
#### Snippet
```java
    arguments.addAll(Arrays.asList("QuickStart", "-type", "UPSERT"));
    arguments.addAll(Arrays.asList(args));
    PinotAdministrator.main(arguments.toArray(new String[arguments.size()]));
  }

```

### ToArrayCallWithZeroLengthArrayArgument
Call to `toArray()` with pre-sized array argument 'new String\[arguments.size()\]'
in `pinot-tools/src/main/java/org/apache/pinot/tools/ColocatedJoinEngineQuickStart.java`
#### Snippet
```java
    arguments.addAll(Arrays.asList("QuickStart", "-type", QUICKSTART_IDENTIFIER));
    arguments.addAll(Arrays.asList(args));
    PinotAdministrator.main(arguments.toArray(new String[arguments.size()]));
  }
}
```

### ToArrayCallWithZeroLengthArrayArgument
Call to `toArray()` with pre-sized array argument 'new String\[arguments.size()\]'
in `pinot-tools/src/main/java/org/apache/pinot/tools/MultiDirQuickstart.java`
#### Snippet
```java
    arguments.addAll(Arrays.asList("QuickStart", "-type", "BATCH-MULTIDIR"));
    arguments.addAll(Arrays.asList(args));
    PinotAdministrator.main(arguments.toArray(new String[arguments.size()]));
  }
}
```

### ToArrayCallWithZeroLengthArrayArgument
Call to `toArray()` with pre-sized array argument 'new String\[arguments.size()\]'
in `pinot-tools/src/main/java/org/apache/pinot/tools/Quickstart.java`
#### Snippet
```java
    arguments.addAll(Arrays.asList("QuickStart", "-type", "BATCH"));
    arguments.addAll(Arrays.asList(args));
    PinotAdministrator.main(arguments.toArray(new String[arguments.size()]));
  }
}
```

### ToArrayCallWithZeroLengthArrayArgument
Call to `toArray()` with pre-sized array argument 'new String\[arguments.size()\]'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/PinotServiceManagerStarter.java`
#### Snippet
```java
    arguments.add("StartServiceManager");
    arguments.addAll(Arrays.asList(args));
    PinotAdministrator.main(arguments.toArray(new String[arguments.size()]));
  }
}
```

### ToArrayCallWithZeroLengthArrayArgument
Call to `toArray()` with pre-sized array argument 'new String\[arguments.size()\]'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/PinotController.java`
#### Snippet
```java
    arguments.add("StartController");
    arguments.addAll(Arrays.asList(args));
    PinotAdministrator.main(arguments.toArray(new String[arguments.size()]));
  }
}
```

### ToArrayCallWithZeroLengthArrayArgument
Call to `toArray()` with pre-sized array argument 'new String\[arguments.size()\]'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/PinotServer.java`
#### Snippet
```java
    arguments.add("StartServer");
    arguments.addAll(Arrays.asList(args));
    PinotAdministrator.main(arguments.toArray(new String[arguments.size()]));
  }
}
```

### ToArrayCallWithZeroLengthArrayArgument
Call to `toArray()` with pre-sized array argument 'new String\[arguments.size()\]'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/PinotBroker.java`
#### Snippet
```java
    arguments.add("StartBroker");
    arguments.addAll(Arrays.asList(args));
    PinotAdministrator.main(arguments.toArray(new String[arguments.size()]));
  }
}
```

### ToArrayCallWithZeroLengthArrayArgument
Call to `toArray()` with pre-sized array argument 'new String\[arguments.size()\]'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/PinotMinion.java`
#### Snippet
```java
    arguments.add("StartMinion");
    arguments.addAll(Arrays.asList(args));
    PinotAdministrator.main(arguments.toArray(new String[arguments.size()]));
  }
}
```

### ToArrayCallWithZeroLengthArrayArgument
Call to `toArray()` with pre-sized array argument 'new State\[ss.size()\]'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/automaton/MinimizationOperations.java`
#### Snippet
```java
    Set<State> ss = a.getStates();
    Transition[][] transitions = new Transition[ss.size()][];
    State[] states = ss.toArray(new State[ss.size()]);
    boolean[][] mark = new boolean[states.length][states.length];
    ArrayList<ArrayList<HashSet<IntPair>>> triggers = new ArrayList<ArrayList<HashSet<IntPair>>>();
```

## RuleId[id=WrapperTypeMayBePrimitive]
### WrapperTypeMayBePrimitive
Type may be primitive
in `pinot-spi/src/main/java/org/apache/pinot/spi/utils/TimeUtils.java`
#### Snippet
```java
   */
  public static Long convertPeriodToMillis(String timeStr) {
    Long millis = 0L;
    if (timeStr != null) {
      try {
```

### WrapperTypeMayBePrimitive
Type may be primitive
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/DistinctAvgMVAggregationFunction.java`
#### Snippet
```java
  @Override
  public Double extractFinalResult(Set intermediateResult) {
    Double distinctSum = 0.0;

    for (Object obj : intermediateResult) {
```

### WrapperTypeMayBePrimitive
Type may be primitive
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/DistinctSumMVAggregationFunction.java`
#### Snippet
```java
  @Override
  public Double extractFinalResult(Set intermediateResult) {
    Double distinctSum = 0.0;

    for (Object obj : intermediateResult) {
```

### WrapperTypeMayBePrimitive
Type may be primitive
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/DistinctSumAggregationFunction.java`
#### Snippet
```java
  @Override
  public Double extractFinalResult(Set intermediateResult) {
    Double distinctSum = 0.0;

    for (Object obj : intermediateResult) {
```

### WrapperTypeMayBePrimitive
Type may be primitive
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/DistinctAvgAggregationFunction.java`
#### Snippet
```java
  @Override
  public Double extractFinalResult(Set intermediateResult) {
    Double distinctSum = 0.0;

    for (Object obj : intermediateResult) {
```

### WrapperTypeMayBePrimitive
Type may be primitive
in `pinot-core/src/main/java/org/apache/pinot/core/transport/server/routing/stats/ServerRoutingStatsManager.java`
#### Snippet
```java
      Double numInFlightRequestsEMA = stats.getInFlightRequestsEMA();
      Double latencyEMA = stats.getLatencyEMA();
      Double score = stats.computeHybridScore();
      stats.getServerReadLock().unlock();

```

### WrapperTypeMayBePrimitive
Type may be primitive
in `pinot-clients/pinot-jdbc-client/src/main/java/org/apache/pinot/client/utils/DriverUtils.java`
#### Snippet
```java
      return Types.VARCHAR;
    }
    Integer columnsSQLDataType;
    switch (columnDataType) {
      case "STRING":
```

### WrapperTypeMayBePrimitive
Type may be primitive
in `pinot-broker/src/main/java/org/apache/pinot/broker/routing/adaptiveserverselector/HybridSelector.java`
#### Snippet
```java
  public String select(List<String> serverCandidates) {
    String selectedServer = null;
    Double minScore = Double.MAX_VALUE;

    // TODO: If two or more servers have the same score, break the tie intelligently.
```

### WrapperTypeMayBePrimitive
Type may be primitive
in `pinot-broker/src/main/java/org/apache/pinot/broker/routing/adaptiveserverselector/LatencySelector.java`
#### Snippet
```java
  public String select(List<String> serverCandidates) {
    String selectedServer = null;
    Double minLatency = Double.MAX_VALUE;

    // TODO: If two or more servers have same latency, break the tie intelligently.
```

### WrapperTypeMayBePrimitive
Type may be primitive
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/fst/PinotBufferIndexInput.java`
#### Snippet
```java
  public byte readByte()
      throws IOException {
    Byte b = _pinotDataBuffer.getByte(_readPointerOffset);
    _readPointerOffset += 1;
    return b;
```

### WrapperTypeMayBePrimitive
Type may be primitive
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/realtime/impl/invertedindex/NativeMutableTextIndex.java`
#### Snippet
```java
    try {
      for (String token : tokens) {
        Integer currentDictId = _termToDictIdMapping.computeIntIfAbsent(token, k -> {
          int localDictId = _nextDictId++;
          _mutableFST.addPath(token, localDictId);
```

### WrapperTypeMayBePrimitive
Type may be primitive
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/indexsegment/mutable/MutableSegmentImpl.java`
#### Snippet
```java
      DataType dataType = metricFieldSpec.getDataType();

      Double oldDoubleValue;
      Double newDoubleValue;
      Long oldLongValue;
```

### WrapperTypeMayBePrimitive
Type may be primitive
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/indexsegment/mutable/MutableSegmentImpl.java`
#### Snippet
```java
      Double oldDoubleValue;
      Double newDoubleValue;
      Long oldLongValue;
      Long newLongValue;
      ValueAggregator valueAggregator = indexContainer._valueAggregator;
```

## RuleId[id=MismatchedArrayReadWrite]
### MismatchedArrayReadWrite
Contents of array `FIXED_ZONE_OFFSET` are written to, but never read
in `pinot-common/src/main/java/org/apache/pinot/common/function/DateTimeUtils.java`
#### Snippet
```java
    private static final DateTimeZone[] DATE_TIME_ZONES;
    private static final ISOChronology[] CHRONOLOGIES;
    private static final int[] FIXED_ZONE_OFFSET;
    private static final int VARIABLE_ZONE = Integer.MAX_VALUE;

```

### MismatchedArrayReadWrite
Contents of array `TIME_ZONE_KEYS` are written to, but never read
in `pinot-common/src/main/java/org/apache/pinot/common/function/TimeZoneKey.java`
#### Snippet
```java
  private static final Set<TimeZoneKey> ZONE_KEYS;

  private static final TimeZoneKey[] TIME_ZONE_KEYS;

  private static final short OFFSET_TIME_ZONE_MIN = -14 * 60;
```

### MismatchedArrayReadWrite
Contents of array `OFFSET_TIME_ZONE_KEYS` are written to, but never read
in `pinot-common/src/main/java/org/apache/pinot/common/function/TimeZoneKey.java`
#### Snippet
```java
  private static final short OFFSET_TIME_ZONE_MIN = -14 * 60;
  private static final short OFFSET_TIME_ZONE_MAX = 14 * 60;
  private static final TimeZoneKey[] OFFSET_TIME_ZONE_KEYS =
      new TimeZoneKey[OFFSET_TIME_ZONE_MAX - OFFSET_TIME_ZONE_MIN + 1];

```

### MismatchedArrayReadWrite
Contents of array `_cumulativeColumnOffsetSizeInBytes` are written to, but never read
in `pinot-core/src/main/java/org/apache/pinot/core/common/datablock/DataBlockBuilder.java`
#### Snippet
```java
  private int[] _columnOffsets;
  private int _rowSizeInBytes;
  private int[] _cumulativeColumnOffsetSizeInBytes;
  private int[] _columnSizeInBytes;

```

## RuleId[id=UnnecessaryModifier]
### UnnecessaryModifier
Modifier `public` is redundant for interface members
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/MessageBatch.java`
#### Snippet
```java
   */
  @Nullable
  default public StreamMessageMetadata getLastMessageMetadata() {
    return null;
  }
```

### UnnecessaryModifier
Modifier `public` is redundant for interface members
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/access/Authenticate.java`
#### Snippet
```java
@Target(ElementType.METHOD)
public @interface Authenticate {
  public AccessType value();
}

```

### UnnecessaryModifier
Modifier `public` is redundant for interface members
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/data/generator/Generator.java`
#### Snippet
```java
  public void init();

  public Object next();
}

```

### UnnecessaryModifier
Modifier `public` is redundant for interface members
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/data/generator/Generator.java`
#### Snippet
```java
public interface Generator {

  public void init();

  public Object next();
```

### UnnecessaryModifier
Modifier `public` is redundant for interface members
in `pinot-tools/src/main/java/org/apache/pinot/tools/Command.java`
#### Snippet
```java
  public void printUsage();

  public String description();

  // Should return true if -help option is specified for the command, false otherwise.
```

### UnnecessaryModifier
Modifier `public` is redundant for interface members
in `pinot-tools/src/main/java/org/apache/pinot/tools/Command.java`
#### Snippet
```java
  // Should return true if -help option is specified for the command, false otherwise.
  // This is to facilitate PinotAdministrator to print help for individual commands.
  public boolean getHelp();
}

```

### UnnecessaryModifier
Modifier `public` is redundant for interface members
in `pinot-tools/src/main/java/org/apache/pinot/tools/Command.java`
#### Snippet
```java
      throws Exception;

  public void printUsage();

  public String description();
```

### UnnecessaryModifier
Modifier `public` is redundant for interface members
in `pinot-tools/src/main/java/org/apache/pinot/tools/Command.java`
#### Snippet
```java
  }

  public boolean execute()
      throws Exception;

```

### UnnecessaryModifier
Modifier `static` is redundant for inner enums
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/index/MergedColumnConfigDeserializer.java`
#### Snippet
```java
  }

  public static enum OnConflict {
    FAIL {
      @Override
```

### UnnecessaryModifier
Modifier `public` is redundant for interface members
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/index/IndexHandler.java`
#### Snippet
```java
    throws Exception;

  public static class NoOp implements IndexHandler {
    public static final NoOp INSTANCE = new NoOp();

```

### UnnecessaryModifier
Modifier `static` is redundant for inner classes of interfaces
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/index/IndexHandler.java`
#### Snippet
```java
    throws Exception;

  public static class NoOp implements IndexHandler {
    public static final NoOp INSTANCE = new NoOp();

```

### UnnecessaryModifier
Modifier `static` is redundant for inner interfaces
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/customobject/QuantileDigest.java`
#### Snippet
```java
  }

  private static interface Callback {
    /**
     * @param node the node to process
```

## RuleId[id=PointlessArithmeticExpression]
### PointlessArithmeticExpression
`i8 + 0` can be replaced with 'i8'
in `pinot-common/src/main/java/org/apache/pinot/common/utils/HashUtil.java`
#### Snippet
```java
      final int i8 = i * 8;
      long k =
          ((long) data[i8 + 0] & 0xff) + (((long) data[i8 + 1] & 0xff) << 8) + (((long) data[i8 + 2] & 0xff) << 16) + (
              ((long) data[i8 + 3] & 0xff) << 24) + (((long) data[i8 + 4] & 0xff) << 32) + (((long) data[i8 + 5] & 0xff)
              << 40) + (((long) data[i8 + 6] & 0xff) << 48) + (((long) data[i8 + 7] & 0xff) << 56);
```

### PointlessArithmeticExpression
`i4 + 0` can be replaced with 'i4'
in `pinot-common/src/main/java/org/apache/pinot/common/utils/HashUtil.java`
#### Snippet
```java
      final int i4 = i * 4;
      int k =
          (data[i4 + 0] & 0xff) + ((data[i4 + 1] & 0xff) << 8) + ((data[i4 + 2] & 0xff) << 16) + ((data[i4 + 3] & 0xff)
              << 24);
      k *= m;
```

### PointlessArithmeticExpression
`i4 + 0` can be replaced with 'i4'
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/partition/MurmurPartitionFunction.java`
#### Snippet
```java
      final int i4 = i * 4;
      int k =
          (data[i4 + 0] & 0xff) + ((data[i4 + 1] & 0xff) << 8) + ((data[i4 + 2] & 0xff) << 16) + ((data[i4 + 3] & 0xff)
              << 24);
      k *= m;
```

### PointlessArithmeticExpression
`computeMaxPathWeight(_root) * 1.0` can be replaced with 'computeMaxPathWeight(_root)'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/customobject/QuantileDigest.java`
#### Snippet
```java
   */
  public double getConfidenceFactor() {
    return computeMaxPathWeight(_root) * 1.0 / _weightedCount;
  }

```

## RuleId[id=DoubleCheckedLocking]
### DoubleCheckedLocking
Double-checked locking
in `pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/ConnectionFactory.java`
#### Snippet
```java

  private static PinotClientTransport getDefault(Properties connectionProperties) {
    if (_defaultTransport == null) {
      synchronized (ConnectionFactory.class) {
        if (_defaultTransport == null) {
```

### DoubleCheckedLocking
Double-checked locking
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/realtime/impl/invertedindex/RealtimeLuceneIndexRefreshState.java`
#### Snippet
```java

  public static RealtimeLuceneIndexRefreshState getInstance() {
    if (_singletonInstance == null) {
      synchronized (RealtimeLuceneIndexRefreshState.class) {
        if (_singletonInstance == null) {
```

## RuleId[id=EmptyStatementBody]
### EmptyStatementBody
`if` statement has empty body
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/logical/LogicalPlanner.java`
#### Snippet
```java
    RelTraitSet traitSet = super.emptyTraitSet();
    for (RelTraitDef traitDef : _traitDefs) {
      if (traitDef.multiple()) {
        // not supported
      }
```

### EmptyStatementBody
`else` statement has empty body
in `pinot-core/src/main/java/org/apache/pinot/core/query/optimizer/filter/NumericalFilterOptimizer.java`
#### Snippet
```java
        range.getFunctionCall().setOperator(FilterKind.LESS_THAN.name());
      }
    } else {
      // No need to rewrite range expression since conversion of literal value was lossless.
    }
```

### EmptyStatementBody
`else` statement has empty body
in `pinot-core/src/main/java/org/apache/pinot/core/query/optimizer/filter/NumericalFilterOptimizer.java`
#### Snippet
```java
              return getExpressionFromBoolean(
                  kind == FilterKind.GREATER_THAN || kind == FilterKind.GREATER_THAN_OR_EQUAL);
            } else {
              // Long literal value falls within the bounds of INT column, server will successfully convert the literal
              // value when needed.
```

### EmptyStatementBody
`if` statement has empty body
in `pinot-query-runtime/src/main/java/org/apache/pinot/query/runtime/operator/HashJoinOperator.java`
#### Snippet
```java
    }
    if (leftBlock.isNoOpBlock() || (leftBlock.isSuccessfulEndOfStreamBlock() && !needUnmatchedRightRows())) {
      if (!leftBlock.getResultMetadata().isEmpty()) {
      }

```

## RuleId[id=CommentedOutCode]
### CommentedOutCode
Commented out code (5 lines)
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/logical/ShuffleRewriteVisitor.java`
#### Snippet
```java
      // TODO: enable right key carrying. currently we only support left key carrying b/c of the partition key list
      // doesn't understand equivalent partition key column or group partition key columns, yet.
      /*
      if (rightPks.contains(rightIdx)) {
        // combined schema will have all the left fields before the right fields
```

### CommentedOutCode
Commented out code (9 lines)
in `pinot-spi/src/main/java/org/apache/pinot/spi/data/Schema.java`
#### Snippet
```java
    }
    // TODO: Switch to new format after releasing 0.11.0
//    if (split[0].equals(DateTimeFieldSpec.TimeFormat.EPOCH.name())) {
//      timeFormat = "EPOCH|" + outgoingTimeUnit.name();
//      if (outgoingTimeSize != 1) {
```

### CommentedOutCode
Commented out code (2 lines)
in `pinot-plugins/pinot-input-format/pinot-parquet/src/main/java/org/apache/pinot/plugin/inputformat/parquet/ParquetNativeRecordReader.java`
#### Snippet
```java
    }
    if (_pageReadStore.getRowCount() - _currentPageIdx >= 1) {
      // System.out.println("_pageReadStore.getRowCount() = " + _pageReadStore.getRowCount() + ", _currentPageIdx = "
      // + _currentPageIdx);
      return true;
```

### CommentedOutCode
Commented out code (2 lines)
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/ControllerAdminApiApplication.java`
#### Snippet
```java
    register(new CorsFilter());
    register(AuthenticationFilter.class);
    // property("jersey.config.server.tracing.type", "ALL");
    // property("jersey.config.server.tracing.threshold", "VERBOSE");
  }
```

### CommentedOutCode
Commented out code (7 lines)
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotQueryResource.java`
#### Snippet
```java
    HttpURLConnection conn = null;
    try {
      /*if (LOG.isInfoEnabled()){
        LOGGER.info("Sending a post request to the server - " + urlStr);
      }
```

### CommentedOutCode
Commented out code (3 lines)
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotQueryResource.java`
#### Snippet
```java
      final int responseCode = conn.getResponseCode();

      /*if (LOG.isInfoEnabled()){
        LOGGER.info("The http response code is " + responseCode);
      }*/
```

### CommentedOutCode
Commented out code (3 lines)
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotQueryResource.java`
#### Snippet
```java

      final String output = new String(bytes, StandardCharsets.UTF_8);
      /*if (LOG.isDebugEnabled()){
        LOGGER.debug("The response from the server is - " + output);
      }*/
```

### CommentedOutCode
Commented out code (4 lines)
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/rules/utils/FixedLenBitset.java`
#### Snippet
```java
  @Override
  public String toString() {
//    StringBuilder stringBuilder = new StringBuilder();
//    for (int i = _lenOfArray-1; i >=0 ; i--) {
//      stringBuilder.append(String.format("%16s", Long.toHexString(_bytes[i])).replace(" ", "0"));
```

### CommentedOutCode
Commented out code (7 lines)
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AnonymizeDataCommand.java`
#### Snippet
```java

      // TODO: Uncomment after re-implementing the SQL query generator
//      // generate queries from prebuilt global dictionaries
//      PinotDataAndQueryAnonymizer.QueryGenerator queryGenerator =
//          new PinotDataAndQueryAnonymizer.QueryGenerator(_outputDir, _queryDir, _originalQueryFile, _tableName,
```

### CommentedOutCode
Commented out code (7 lines)
in `pinot-tools/src/main/java/org/apache/pinot/tools/anonymizer/PinotDataAndQueryAnonymizer.java`
#### Snippet
```java
//    }
//  }
//
//  private static class PredicateValueNotFoundException extends Exception {
//    final Object _origValue;
```

### CommentedOutCode
Commented out code (7 lines)
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkOffHeapDictionaryMemory.java`
#### Snippet
```java
    _nBufs[div] += dictionary.getNumberOfHeapBuffersUsed();

    /*
    System.out.println("Cardinality:" + actualCardinality + ",initialCardinality:" + initialCardinality +
        ",OffHeapMem:" + dictionary.getTotalOffHeapMemUsed()/1024/1024 + "MB" +
```

## RuleId[id=RegExpRedundantEscape]
### RegExpRedundantEscape
Redundant character escape `\\)` in RegExp
in `pinot-query-planner/src/main/java/org/apache/pinot/query/parser/ParserUtils.java`
#### Snippet
```java
  // or
  //   `OPTION (<k1> = <v1>) OPTION (<k2> = <v2>) OPTION (<k3> = <v3>)`
  static final Pattern OPTIONS_REGEX_PATTEN = Pattern.compile("option\\s*\\(([^\\)]+)\\)", Pattern.CASE_INSENSITIVE);

  private ParserUtils() {
```

### RegExpRedundantEscape
Redundant character escape `\\]` in RegExp
in `pinot-query-planner/src/main/java/org/apache/pinot/query/QueryEnvironment.java`
#### Snippet
```java
      // Calcite encloses table and schema names in square brackets to properly quote and delimit them in SQL
      // statements, particularly to handle cases when they contain special characters or reserved keywords.
      String tableName = qualifiedTableName.replaceAll("^\\[(.*)\\]$", "$1");
      tableNames.add(tableName);
    }
```

### RegExpRedundantEscape
Redundant character escape `\\:` in RegExp
in `pinot-spi/src/main/java/org/apache/pinot/spi/plugin/PluginManager.java`
#### Snippet
```java
    String realClassName = className;
    if (className.indexOf(":") > -1) {
      String[] split = className.split("\\:");
      pluginName = split[0];
      realClassName = split[1];
```

### RegExpRedundantEscape
Redundant character escape `\\:` in RegExp
in `pinot-spi/src/main/java/org/apache/pinot/spi/plugin/PluginManager.java`
#### Snippet
```java
    String realClassName = className;
    if (className.indexOf(":") > -1) {
      String[] split = className.split("\\:");
      pluginName = split[0];
      realClassName = split[1];
```

### RegExpRedundantEscape
Redundant character escape `\\)` in RegExp
in `pinot-common/src/main/java/org/apache/pinot/sql/parsers/CalciteSqlParser.java`
#### Snippet
```java
  // `OPTION (<k1> = <v1>, <k2> = <v2>, <k3> = <v3>)`
  private static final Pattern OPTIONS_REGEX_PATTEN =
      Pattern.compile("\\s*option\\s*\\(([^\\)]+)\\)\\s*\\Z", Pattern.CASE_INSENSITIVE);

  /**
```

### RegExpRedundantEscape
Redundant character escape `\\*` in RegExp
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/creator/name/SegmentNameUtils.java`
#### Snippet
```java
 */
public class SegmentNameUtils {
  private static final Pattern INVALID_SEGMENT_NAME_REGEX = Pattern.compile(".*[\\\\/:\\*?\"<>|].*");

  private SegmentNameUtils() {
```

### RegExpRedundantEscape
Redundant character escape `\\.` in RegExp
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/creator/name/InputFileSegmentNameGenerator.java`
#### Snippet
```java
    inputFilePath = inputFilePath.replaceFirst("^[/]+", "");
    // Try to create a valid filename by removing any '/' or '.' chars with '_'
    return inputFilePath.replaceAll("[/\\.]", "_");
  }

```

## RuleId[id=FinalMethodInFinalClass]
### FinalMethodInFinalClass
Method declared `final` in 'final' class
in `pinot-core/src/main/java/org/apache/pinot/core/operator/filter/EmptyFilterOperator.java`
#### Snippet
```java

  @Override
  public final boolean isResultEmpty() {
    return true;
  }
```

### FinalMethodInFinalClass
Method declared `final` in 'final' class
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/MatchResult.java`
#### Snippet
```java
  }

  final void reset(int kind, int index, int node) {
    _kind = kind;
    _index = index;
```

### FinalMethodInFinalClass
Method declared `final` in 'final' class
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/ByteSequenceIterator.java`
#### Snippet
```java
   * Advances to the next available final state.
   */
  private final ByteBuffer advance() {
    if (_position == 0) {
      return null;
```

## RuleId[id=FinalPrivateMethod]
### FinalPrivateMethod
'private' method declared `final`
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/ByteSequenceIterator.java`
#### Snippet
```java
   * Advances to the next available final state.
   */
  private final ByteBuffer advance() {
    if (_position == 0) {
      return null;
```

## RuleId[id=Deprecation]
### Deprecation
'newInstance()' is deprecated
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/serde/ProtoSerializationUtils.java`
#### Snippet
```java
              objectField.getMemberVariablesOrDefault(ENUM_VALUE_KEY, null).getLiteralField().getStringField());
        } else {
          Object obj = clazz.newInstance();
          setObjectFieldToObject(obj, objectField);
          return obj;
```

### Deprecation
'setTransformFunction(java.lang.String)' is deprecated
in `pinot-spi/src/main/java/org/apache/pinot/spi/data/DateTimeFieldSpec.java`
#### Snippet
```java
    this(name, dataType, format, granularity, sampleValue);
    setDefaultNullValue(defaultNullValue);
    setTransformFunction(transformFunction);
  }

```

### Deprecation
'org.apache.pinot.spi.data.TimeFieldSpec' is deprecated
in `pinot-spi/src/main/java/org/apache/pinot/spi/data/FieldSpec.java`
#### Snippet
```java
 * The <code>FieldSpec</code> class contains all specs related to any field (column) in {@link Schema}.
 * <p>There are 3 types of <code>FieldSpec</code>:
 * {@link DimensionFieldSpec}, {@link MetricFieldSpec}, {@link TimeFieldSpec}
 * <p>Specs stored are as followings:
 * <p>- <code>Name</code>: name of the field.
```

### Deprecation
'org.apache.pinot.spi.data.TimeFieldSpec' is deprecated
in `pinot-spi/src/main/java/org/apache/pinot/spi/data/Schema.java`
#### Snippet
```java

  /**
   * Helper method that converts a {@link TimeFieldSpec} to {@link DateTimeFieldSpec}
   * 1) If timeFieldSpec contains only incoming granularity spec, directly convert it to a dateTimeFieldSpec
   * 2) If timeFieldSpec contains incoming aas well as outgoing granularity spec, use the outgoing spec to construct
```

### Deprecation
'org.apache.pinot.spi.data.TimeFieldSpec' is deprecated
in `pinot-spi/src/main/java/org/apache/pinot/spi/data/Schema.java`
#### Snippet
```java
   *    and configure a transform function for the conversion from incoming
   */
  public static DateTimeFieldSpec convertToDateTimeFieldSpec(TimeFieldSpec timeFieldSpec) {
    DateTimeFieldSpec dateTimeFieldSpec = new DateTimeFieldSpec();
    TimeGranularitySpec incomingGranularitySpec = timeFieldSpec.getIncomingGranularitySpec();
```

### Deprecation
'org.apache.pinot.spi.data.TimeGranularitySpec' is deprecated
in `pinot-spi/src/main/java/org/apache/pinot/spi/data/Schema.java`
#### Snippet
```java
  public static DateTimeFieldSpec convertToDateTimeFieldSpec(TimeFieldSpec timeFieldSpec) {
    DateTimeFieldSpec dateTimeFieldSpec = new DateTimeFieldSpec();
    TimeGranularitySpec incomingGranularitySpec = timeFieldSpec.getIncomingGranularitySpec();
    TimeGranularitySpec outgoingGranularitySpec = timeFieldSpec.getOutgoingGranularitySpec();

```

### Deprecation
'org.apache.pinot.spi.data.TimeGranularitySpec' is deprecated
in `pinot-spi/src/main/java/org/apache/pinot/spi/data/Schema.java`
#### Snippet
```java
    DateTimeFieldSpec dateTimeFieldSpec = new DateTimeFieldSpec();
    TimeGranularitySpec incomingGranularitySpec = timeFieldSpec.getIncomingGranularitySpec();
    TimeGranularitySpec outgoingGranularitySpec = timeFieldSpec.getOutgoingGranularitySpec();

    dateTimeFieldSpec.setName(outgoingGranularitySpec.getName());
```

### Deprecation
'getTransformFunction()' is deprecated
in `pinot-spi/src/main/java/org/apache/pinot/spi/data/Schema.java`
#### Snippet
```java
    dateTimeFieldSpec.setGranularity(outgoingTimeSize + ":" + outgoingTimeUnit.name());

    if (timeFieldSpec.getTransformFunction() != null) {
      dateTimeFieldSpec.setTransformFunction(timeFieldSpec.getTransformFunction());
    } else if (!incomingGranularitySpec.equals(outgoingGranularitySpec)) {
```

### Deprecation
'setTransformFunction(java.lang.String)' is deprecated
in `pinot-spi/src/main/java/org/apache/pinot/spi/data/Schema.java`
#### Snippet
```java

    if (timeFieldSpec.getTransformFunction() != null) {
      dateTimeFieldSpec.setTransformFunction(timeFieldSpec.getTransformFunction());
    } else if (!incomingGranularitySpec.equals(outgoingGranularitySpec)) {
      String incomingName = incomingGranularitySpec.getName();
```

### Deprecation
'getTransformFunction()' is deprecated
in `pinot-spi/src/main/java/org/apache/pinot/spi/data/Schema.java`
#### Snippet
```java

    if (timeFieldSpec.getTransformFunction() != null) {
      dateTimeFieldSpec.setTransformFunction(timeFieldSpec.getTransformFunction());
    } else if (!incomingGranularitySpec.equals(outgoingGranularitySpec)) {
      String incomingName = incomingGranularitySpec.getName();
```

### Deprecation
'setTransformFunction(java.lang.String)' is deprecated
in `pinot-spi/src/main/java/org/apache/pinot/spi/data/Schema.java`
#### Snippet
```java
          constructTransformFunctionString(incomingName, incomingTimeSize, incomingTimeUnit, outgoingTimeSize,
              outgoingTimeUnit);
      dateTimeFieldSpec.setTransformFunction(transformFunction);
    }

```

### Deprecation
'org.apache.pinot.spi.data.TimeFieldSpec' is deprecated
in `pinot-spi/src/main/java/org/apache/pinot/spi/data/Schema.java`
#### Snippet
```java
 * <p>Four field types are supported: DIMENSION, METRIC, TIME, DATE_TIME.
 * ({@link DimensionFieldSpec}, {@link MetricFieldSpec},
 * {@link TimeFieldSpec}, {@link DateTimeFieldSpec})
 * <p>For each field, a {@link FieldSpec} is defined to provide the details of the field.
 * <p>There could be multiple DIMENSION or METRIC or DATE_TIME fields, but at most 1 TIME field.
```

### Deprecation
'org.apache.pinot.spi.data.TimeFieldSpec' is deprecated
in `pinot-spi/src/main/java/org/apache/pinot/spi/data/Schema.java`
#### Snippet
```java
  }

  public TimeFieldSpec getTimeFieldSpec() {
    return _timeFieldSpec;
  }
```

### Deprecation
'org.apache.pinot.spi.data.TimeFieldSpec' is deprecated
in `pinot-spi/src/main/java/org/apache/pinot/spi/data/Schema.java`
#### Snippet
```java
      }
      if (fieldSpec.getFieldType() == FieldType.TIME) {
        return convertToDateTimeFieldSpec((TimeFieldSpec) fieldSpec);
      }
    }
```

### Deprecation
'org.apache.pinot.spi.data.TimeFieldSpec' is deprecated
in `pinot-spi/src/main/java/org/apache/pinot/spi/data/Schema.java`
#### Snippet
```java
  private final List<DimensionFieldSpec> _dimensionFieldSpecs = new ArrayList<>();
  private final List<MetricFieldSpec> _metricFieldSpecs = new ArrayList<>();
  private TimeFieldSpec _timeFieldSpec;
  private final List<DateTimeFieldSpec> _dateTimeFieldSpecs = new ArrayList<>();
  private final List<ComplexFieldSpec> _complexFieldSpecs = new ArrayList<>();
```

### Deprecation
'org.apache.pinot.spi.data.TimeFieldSpec' is deprecated
in `pinot-spi/src/main/java/org/apache/pinot/spi/data/Schema.java`
#### Snippet
```java
        break;
      case TIME:
        _timeFieldSpec = (TimeFieldSpec) fieldSpec;
        break;
      case DATE_TIME:
```

### Deprecation
'put(java.lang.String, com.fasterxml.jackson.databind.JsonNode)' is deprecated
in `pinot-spi/src/main/java/org/apache/pinot/spi/utils/Obfuscator.java`
#### Snippet
```java
          IntStream.range(0, node.size()).forEach(i -> ((ArrayNode) node).set(i, toJsonRecursive(node.get(i))));
        } else if (node.isObject()) {
          ((ObjectNode) node).put(field, toJsonRecursive(node.get(field)));
        }
      });
```

### Deprecation
'getSegmentPushFrequency()' is deprecated
in `pinot-spi/src/main/java/org/apache/pinot/spi/utils/IngestionConfigUtils.java`
#### Snippet
```java
    }
    if (segmentIngestionFrequency == null) {
      segmentIngestionFrequency = tableConfig.getValidationConfig().getSegmentPushFrequency();
    }
    return segmentIngestionFrequency;
```

### Deprecation
'getStreamConfigs()' is deprecated
in `pinot-spi/src/main/java/org/apache/pinot/spi/utils/IngestionConfigUtils.java`
#### Snippet
```java
    }
    if (streamConfigMap == null && tableConfig.getIndexingConfig() != null) {
      streamConfigMap = tableConfig.getIndexingConfig().getStreamConfigs();
    }
    if (streamConfigMap == null) {
```

### Deprecation
'getSegmentPushType()' is deprecated
in `pinot-spi/src/main/java/org/apache/pinot/spi/utils/IngestionConfigUtils.java`
#### Snippet
```java
    }
    if (segmentIngestionType == null) {
      segmentIngestionType = tableConfig.getValidationConfig().getSegmentPushType();
    }
    return segmentIngestionType;
```

### Deprecation
'DEPRECATED_SEGMENT_FLUSH_THRESHOLD_ROWS' is deprecated
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/PartitionLevelStreamConfig.java`
#### Snippet
```java
  protected int extractFlushThresholdRows(Map<String, String> streamConfigMap) {
    String flushThresholdRowsKey =
        StreamConfigProperties.DEPRECATED_SEGMENT_FLUSH_THRESHOLD_ROWS + StreamConfigProperties.LLC_SUFFIX;
    String flushThresholdRowsStr = streamConfigMap.get(flushThresholdRowsKey);
    if (flushThresholdRowsStr != null) {
```

### Deprecation
'DEPRECATED_SEGMENT_FLUSH_DESIRED_SIZE' is deprecated
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/StreamConfig.java`
#### Snippet
```java
    if (flushThresholdSegmentSizeStr == null) {
      // for backward compatibility with older property
      key = StreamConfigProperties.DEPRECATED_SEGMENT_FLUSH_DESIRED_SIZE;
      flushThresholdSegmentSizeStr = streamConfigMap.get(key);
    }
```

### Deprecation
'DEPRECATED_SEGMENT_FLUSH_THRESHOLD_ROWS' is deprecated
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/StreamConfig.java`
#### Snippet
```java
    if (flushThresholdRowsStr == null) {
      // for backward compatibility with older property
      key = StreamConfigProperties.DEPRECATED_SEGMENT_FLUSH_THRESHOLD_ROWS;
      flushThresholdRowsStr = streamConfigMap.get(key);
    }
```

### Deprecation
'newInstance()' is deprecated
in `pinot-spi/src/main/java/org/apache/pinot/spi/metrics/PinotMetricUtils.java`
#### Snippet
```java
          if (annotation.enabled()) {
            try {
              PinotMetricsFactory pinotMetricsFactory = (PinotMetricsFactory) clazz.newInstance();
              pinotMetricsFactory.init(metricsConfiguration);
              registerMetricsFactory(pinotMetricsFactory);
```

### Deprecation
'COLLECTOR_TYPE_KEY' is deprecated
in `pinot-plugins/pinot-minion-tasks/pinot-minion-builtin-tasks/src/main/java/org/apache/pinot/plugin/minion/tasks/realtimetoofflinesegments/RealtimeToOfflineSegmentsTaskExecutor.java`
#### Snippet
```java
    // Handle legacy key
    if (mergeType == null) {
      String legacyMergeTypeStr = configs.get(RealtimeToOfflineSegmentsTask.COLLECTOR_TYPE_KEY);
      if (legacyMergeTypeStr != null) {
        mergeType = MergeType.valueOf(legacyMergeTypeStr.toUpperCase());
```

### Deprecation
'COLLECTOR_TYPE_KEY' is deprecated
in `pinot-plugins/pinot-minion-tasks/pinot-minion-builtin-tasks/src/main/java/org/apache/pinot/plugin/minion/tasks/realtimetoofflinesegments/RealtimeToOfflineSegmentsTaskGenerator.java`
#### Snippet
```java
      String mergeType = taskConfigs.get(RealtimeToOfflineSegmentsTask.MERGE_TYPE_KEY);
      if (mergeType == null) {
        mergeType = taskConfigs.get(RealtimeToOfflineSegmentsTask.COLLECTOR_TYPE_KEY);
      }
      if (mergeType != null) {
```

### Deprecation
'COLLECTOR_TYPE_KEY' is deprecated
in `pinot-plugins/pinot-minion-tasks/pinot-minion-builtin-tasks/src/main/java/org/apache/pinot/plugin/minion/tasks/realtimetoofflinesegments/RealtimeToOfflineSegmentsTaskGenerator.java`
#### Snippet
```java
      if (mergeType != null) {
        configs.put(RealtimeToOfflineSegmentsTask.MERGE_TYPE_KEY, mergeType);
        configs.put(RealtimeToOfflineSegmentsTask.COLLECTOR_TYPE_KEY, mergeType);
      }
      for (Map.Entry<String, String> entry : taskConfigs.entrySet()) {
```

### Deprecation
'org.apache.pinot.client.Request' is deprecated
in `pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/JsonAsyncHttpPinotClientTransport.java`
#### Snippet
```java

  @Override
  public Future<BrokerResponse> executeQueryAsync(String brokerAddress, Request request)
      throws PinotClientException {
    return executeQueryAsync(brokerAddress, request.getQuery());
```

### Deprecation
'JdkSslContext(javax.net.ssl.SSLContext, boolean, io.netty.handler.ssl.ClientAuth)' is deprecated
in `pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/JsonAsyncHttpPinotClientTransport.java`
#### Snippet
```java
    Builder builder = Dsl.config();
    if (sslContext != null) {
      builder.setSslContext(new JdkSslContext(sslContext, true, ClientAuth.OPTIONAL));
    }

```

### Deprecation
'org.apache.pinot.client.Request' is deprecated
in `pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/JsonAsyncHttpPinotClientTransport.java`
#### Snippet
```java

  @Override
  public BrokerResponse executeQuery(String brokerAddress, Request request)
      throws PinotClientException {
    try {
```

### Deprecation
'JdkSslContext(javax.net.ssl.SSLContext, boolean, io.netty.handler.ssl.ClientAuth)' is deprecated
in `pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/BrokerCache.java`
#### Snippet
```java
    if (scheme.contentEquals(CommonConstants.HTTPS_PROTOCOL)) {
      SSLContext sslContext = ConnectionUtils.getSSLContextFromProperties(properties);
      builder.setSslContext(new JdkSslContext(sslContext, true, ClientAuth.OPTIONAL));
    }

```

### Deprecation
'addCallbackGaugeIfNeeded(java.lang.String, java.util.concurrent.Callable)' is deprecated
in `pinot-plugins/pinot-minion-tasks/pinot-minion-builtin-tasks/src/main/java/org/apache/pinot/plugin/minion/tasks/mergerollup/MergeRollupTaskGenerator.java`
#### Snippet
```java
                    : watermarkForTable.get(lowerMergeLevel),
                bufferTimeMs, bucketTimeMs));
        controllerMetrics.addCallbackGaugeIfNeeded(getMetricNameForTaskDelay(tableNameWithType, mergeLevel),
            (() -> getMergeRollupTaskDelayInNumTimeBuckets(watermarkForTable.getOrDefault(k, -1L),
                lowerMergeLevel == null ? _tableLowestLevelMaxValidBucketEndTimeMs.get(tableNameWithType)
```

### Deprecation
'addTime(org.apache.pinot.spi.data.TimeGranularitySpec, org.apache.pinot.spi.data.TimeGranularitySpec)' is deprecated
in `pinot-common/src/main/java/org/apache/pinot/common/utils/SchemaUtils.java`
#### Snippet
```java
    Schema schema = new Schema.SchemaBuilder().setSchemaName("testSchema")
        .addSingleValueDimension("dimension", FieldSpec.DataType.DOUBLE).addMetric("metric", FieldSpec.DataType.INT)
        .addTime(new TimeGranularitySpec(FieldSpec.DataType.INT, TimeUnit.DAYS, "time"), null).build();
    System.out.println(postSchema("localhost", 8100, schema));
    Schema fetchedSchema = getSchema("localhost", 8100, "testSchema");
```

### Deprecation
'org.apache.pinot.spi.data.TimeGranularitySpec' is deprecated
in `pinot-common/src/main/java/org/apache/pinot/common/utils/SchemaUtils.java`
#### Snippet
```java
    Schema schema = new Schema.SchemaBuilder().setSchemaName("testSchema")
        .addSingleValueDimension("dimension", FieldSpec.DataType.DOUBLE).addMetric("metric", FieldSpec.DataType.INT)
        .addTime(new TimeGranularitySpec(FieldSpec.DataType.INT, TimeUnit.DAYS, "time"), null).build();
    System.out.println(postSchema("localhost", 8100, schema));
    Schema fetchedSchema = getSchema("localhost", 8100, "testSchema");
```

### Deprecation
'newInstance()' is deprecated
in `pinot-common/src/main/java/org/apache/pinot/common/utils/fetcher/SegmentFetcherFactory.java`
#### Snippet
```java
      } else {
        LOGGER.info("Creating segment fetcher for protocol: {} with class: {}", protocol, segmentFetcherClassName);
        segmentFetcher = (SegmentFetcher) Class.forName(segmentFetcherClassName).newInstance();
      }

```

### Deprecation
'getSegmentPushType()' is deprecated
in `pinot-common/src/main/java/org/apache/pinot/common/utils/config/TableConfigUtils.java`
#### Snippet
```java

    SegmentsValidationAndRetentionConfig validationConfig = tableConfig.getValidationConfig();
    String segmentPushType = validationConfig.getSegmentPushType();
    String segmentPushFrequency = validationConfig.getSegmentPushFrequency();

```

### Deprecation
'getSegmentPushFrequency()' is deprecated
in `pinot-common/src/main/java/org/apache/pinot/common/utils/config/TableConfigUtils.java`
#### Snippet
```java
    SegmentsValidationAndRetentionConfig validationConfig = tableConfig.getValidationConfig();
    String segmentPushType = validationConfig.getSegmentPushType();
    String segmentPushFrequency = validationConfig.getSegmentPushFrequency();

    if (batchIngestionConfig == null) {
```

### Deprecation
'getStreamConfigs()' is deprecated
in `pinot-common/src/main/java/org/apache/pinot/common/utils/config/TableConfigUtils.java`
#### Snippet
```java
    if (streamIngestionConfig == null) {
      // Only set the new config if the deprecated one is set.
      Map<String, String> streamConfigs = indexingConfig.getStreamConfigs();
      if (MapUtils.isNotEmpty(streamConfigs)) {
        streamIngestionConfig = new StreamIngestionConfig(Collections.singletonList(streamConfigs));
```

### Deprecation
'GROUP_BY_MODE' is deprecated
in `pinot-common/src/main/java/org/apache/pinot/common/utils/request/RequestUtils.java`
#### Snippet
```java
    // TODO: Remove the SQL query options after releasing 0.11.0
    // The query engine will break if these 2 options are missing during version upgrade.
    queryOptions.put(CommonConstants.Broker.Request.QueryOptionKey.GROUP_BY_MODE, CommonConstants.Broker.Request.SQL);
    queryOptions.put(CommonConstants.Broker.Request.QueryOptionKey.RESPONSE_FORMAT, CommonConstants.Broker.Request.SQL);
    // Setting all query options back into SqlNodeAndOptions. The above ordering matters due to priority overwrite rule
```

### Deprecation
'RESPONSE_FORMAT' is deprecated
in `pinot-common/src/main/java/org/apache/pinot/common/utils/request/RequestUtils.java`
#### Snippet
```java
    // The query engine will break if these 2 options are missing during version upgrade.
    queryOptions.put(CommonConstants.Broker.Request.QueryOptionKey.GROUP_BY_MODE, CommonConstants.Broker.Request.SQL);
    queryOptions.put(CommonConstants.Broker.Request.QueryOptionKey.RESPONSE_FORMAT, CommonConstants.Broker.Request.SQL);
    // Setting all query options back into SqlNodeAndOptions. The above ordering matters due to priority overwrite rule
    sqlNodeAndOptions.setExtraOptions(queryOptions);
```

### Deprecation
'constructPropertyStorePathForMinionTaskMetadataDeprecated(java.lang.String, java.lang.String)' is deprecated
in `pinot-common/src/main/java/org/apache/pinot/common/minion/MinionTaskMetadataUtils.java`
#### Snippet
```java
        // is a table name), it does not harm to try to delete the non-existent constructed path.
        String oldPath =
            ZKMetadataProvider.constructPropertyStorePathForMinionTaskMetadataDeprecated(child, tableNameWithType);
        if (!propertyStore.remove(oldPath, AccessOption.PERSISTENT)) {
          throw new ZkException("Failed to delete task metadata: " + child + ", " + tableNameWithType);
```

### Deprecation
'constructPropertyStorePathForMinionTaskMetadataDeprecated(java.lang.String, java.lang.String)' is deprecated
in `pinot-common/src/main/java/org/apache/pinot/common/minion/MinionTaskMetadataUtils.java`
#### Snippet
```java
    } else {
      return fetchTaskMetadata(propertyStore,
          ZKMetadataProvider.constructPropertyStorePathForMinionTaskMetadataDeprecated(taskType, tableNameWithType));
    }
  }
```

### Deprecation
'constructPropertyStorePathForMinionTaskMetadataDeprecated(java.lang.String, java.lang.String)' is deprecated
in `pinot-common/src/main/java/org/apache/pinot/common/minion/MinionTaskMetadataUtils.java`
#### Snippet
```java
        ZKMetadataProvider.constructPropertyStorePathForMinionTaskMetadata(taskMetadata.getTableNameWithType(),
            taskType);
    String oldPath = ZKMetadataProvider.constructPropertyStorePathForMinionTaskMetadataDeprecated(taskType,
        taskMetadata.getTableNameWithType());
    if (propertyStore.exists(newPath, AccessOption.PERSISTENT) || !propertyStore.exists(oldPath,
```

### Deprecation
'constructPropertyStorePathForMinionTaskMetadataDeprecated(java.lang.String, java.lang.String)' is deprecated
in `pinot-common/src/main/java/org/apache/pinot/common/minion/MinionTaskMetadataUtils.java`
#### Snippet
```java
    String newPath = ZKMetadataProvider.constructPropertyStorePathForMinionTaskMetadata(tableNameWithType, taskType);
    String oldPath =
        ZKMetadataProvider.constructPropertyStorePathForMinionTaskMetadataDeprecated(taskType, tableNameWithType);
    boolean newPathDeleted = propertyStore.remove(newPath, AccessOption.PERSISTENT);
    boolean oldPathDeleted = propertyStore.remove(oldPath, AccessOption.PERSISTENT);
```

### Deprecation
'getSchemaName()' is deprecated
in `pinot-common/src/main/java/org/apache/pinot/common/config/provider/TableCache.java`
#### Snippet
```java
    _tableConfigInfoMap.put(tableNameWithType, new TableConfigInfo(tableConfig));

    String schemaName = tableConfig.getValidationConfig().getSchemaName();
    String rawTableName = TableNameBuilder.extractRawTableName(tableNameWithType);
    if (schemaName != null && !schemaName.equals(rawTableName)) {
```

### Deprecation
'shaHex(byte\[\])' is deprecated
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/HashFunctions.java`
#### Snippet
```java
  @ScalarFunction
  public static String sha(byte[] input) {
    return DigestUtils.shaHex(input);
  }

```

### Deprecation
'org.apache.pinot.spi.utils.CommonConstants.Segment.Offline' is deprecated
in `pinot-common/src/main/java/org/apache/pinot/common/metadata/segment/SegmentZKMetadata.java`
#### Snippet
```java
    // Handle legacy push time key
    if (pushTimeString == null) {
      pushTimeString = _simpleFields.get(Segment.Offline.PUSH_TIME);
    }
    // Return Long.MIN_VALUE if unavailable for backward compatibility
```

### Deprecation
'org.apache.pinot.spi.utils.CommonConstants.Segment.Offline' is deprecated
in `pinot-common/src/main/java/org/apache/pinot/common/metadata/segment/SegmentZKMetadata.java`
#### Snippet
```java
    // Handle legacy refresh time key
    if (refreshTimeString == null) {
      refreshTimeString = _simpleFields.get(Segment.Offline.REFRESH_TIME);
    }
    // Return Long.MIN_VALUE if unavailable for backward compatibility
```

### Deprecation
'org.apache.pinot.spi.utils.CommonConstants.Segment.Offline' is deprecated
in `pinot-common/src/main/java/org/apache/pinot/common/metadata/segment/SegmentZKMetadata.java`
#### Snippet
```java
    // Handle legacy download url keys
    if (downloadUrl == null) {
      downloadUrl = _simpleFields.get(Segment.Offline.DOWNLOAD_URL);
      if (downloadUrl == null) {
        downloadUrl = _simpleFields.get(Segment.Realtime.DOWNLOAD_URL);
```

### Deprecation
'DOWNLOAD_URL' is deprecated
in `pinot-common/src/main/java/org/apache/pinot/common/metadata/segment/SegmentZKMetadata.java`
#### Snippet
```java
      downloadUrl = _simpleFields.get(Segment.Offline.DOWNLOAD_URL);
      if (downloadUrl == null) {
        downloadUrl = _simpleFields.get(Segment.Realtime.DOWNLOAD_URL);
      }
    }
```

### Deprecation
'getSchemaName()' is deprecated
in `pinot-common/src/main/java/org/apache/pinot/common/metadata/ZKMetadataProvider.java`
#### Snippet
```java
      TableConfig realtimeTableConfig = getRealtimeTableConfig(propertyStore, tableName);
      if (realtimeTableConfig != null) {
        String realtimeSchemaNameFromValidationConfig = realtimeTableConfig.getValidationConfig().getSchemaName();
        if (realtimeSchemaNameFromValidationConfig != null) {
          schema = getSchema(propertyStore, realtimeSchemaNameFromValidationConfig);
```

### Deprecation
'getSchemaName()' is deprecated
in `pinot-common/src/main/java/org/apache/pinot/common/metadata/ZKMetadataProvider.java`
#### Snippet
```java
      TableConfig offlineTableConfig = getOfflineTableConfig(propertyStore, tableName);
      if (offlineTableConfig != null) {
        String offlineSchemaNameFromValidationConfig = offlineTableConfig.getValidationConfig().getSchemaName();
        if (offlineSchemaNameFromValidationConfig != null) {
          schema = getSchema(propertyStore, offlineSchemaNameFromValidationConfig);
```

### Deprecation
'getSchemaName()' is deprecated
in `pinot-common/src/main/java/org/apache/pinot/common/metadata/ZKMetadataProvider.java`
#### Snippet
```java
      return schema;
    }
    String schemaNameFromTableConfig = tableConfig.getValidationConfig().getSchemaName();
    if (schemaNameFromTableConfig != null) {
      schema = getSchema(propertyStore, schemaNameFromTableConfig);
```

### Deprecation
'addValueToTableGauge(java.lang.String, G, long)' is deprecated
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/BaseTableDataManager.java`
#### Snippet
```java
    String segmentName = segmentDataManager.getSegmentName();
    _logger.info("Closing segment: {} of table: {}", segmentName, _tableNameWithType);
    _serverMetrics.addValueToTableGauge(_tableNameWithType, ServerGauge.SEGMENT_COUNT, -1L);
    _serverMetrics.addMeteredTableValue(_tableNameWithType, ServerMeter.DELETED_SEGMENT_COUNT, 1L);
    _serverMetrics.addValueToTableGauge(_tableNameWithType, ServerGauge.DOCUMENT_COUNT,
```

### Deprecation
'addValueToTableGauge(java.lang.String, G, long)' is deprecated
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/BaseTableDataManager.java`
#### Snippet
```java
    _serverMetrics.addValueToTableGauge(_tableNameWithType, ServerGauge.SEGMENT_COUNT, -1L);
    _serverMetrics.addMeteredTableValue(_tableNameWithType, ServerMeter.DELETED_SEGMENT_COUNT, 1L);
    _serverMetrics.addValueToTableGauge(_tableNameWithType, ServerGauge.DOCUMENT_COUNT,
        -segmentDataManager.getSegment().getSegmentMetadata().getTotalDocs());
    segmentDataManager.destroy();
```

### Deprecation
'addValueToTableGauge(java.lang.String, G, long)' is deprecated
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/BaseTableDataManager.java`
#### Snippet
```java
    String segmentName = immutableSegment.getSegmentName();
    _logger.info("Adding immutable segment: {} to table: {}", segmentName, _tableNameWithType);
    _serverMetrics.addValueToTableGauge(_tableNameWithType, ServerGauge.DOCUMENT_COUNT,
        immutableSegment.getSegmentMetadata().getTotalDocs());
    _serverMetrics.addValueToTableGauge(_tableNameWithType, ServerGauge.SEGMENT_COUNT, 1L);
```

### Deprecation
'addValueToTableGauge(java.lang.String, G, long)' is deprecated
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/BaseTableDataManager.java`
#### Snippet
```java
    _serverMetrics.addValueToTableGauge(_tableNameWithType, ServerGauge.DOCUMENT_COUNT,
        immutableSegment.getSegmentMetadata().getTotalDocs());
    _serverMetrics.addValueToTableGauge(_tableNameWithType, ServerGauge.SEGMENT_COUNT, 1L);

    ImmutableSegmentDataManager newSegmentManager = new ImmutableSegmentDataManager(immutableSegment);
```

### Deprecation
'addValueToTableGauge(java.lang.String, G, long)' is deprecated
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/RealtimeTableDataManager.java`
#### Snippet
```java
    _logger.info("Initialized RealtimeSegmentDataManager - " + segmentName);
    registerSegment(segmentName, segmentDataManager);
    _serverMetrics.addValueToTableGauge(_tableNameWithType, ServerGauge.SEGMENT_COUNT, 1L);
  }

```

### Deprecation
'addValueToTableGauge(java.lang.String, G, long)' is deprecated
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/RealtimeTableDataManager.java`
#### Snippet
```java
        _tableUpsertMetadataManager.getOrCreatePartitionManager(partitionId);

    _serverMetrics.addValueToTableGauge(_tableNameWithType, ServerGauge.DOCUMENT_COUNT,
        immutableSegment.getSegmentMetadata().getTotalDocs());
    _serverMetrics.addValueToTableGauge(_tableNameWithType, ServerGauge.SEGMENT_COUNT, 1L);
```

### Deprecation
'addValueToTableGauge(java.lang.String, G, long)' is deprecated
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/RealtimeTableDataManager.java`
#### Snippet
```java
    _serverMetrics.addValueToTableGauge(_tableNameWithType, ServerGauge.DOCUMENT_COUNT,
        immutableSegment.getSegmentMetadata().getTotalDocs());
    _serverMetrics.addValueToTableGauge(_tableNameWithType, ServerGauge.SEGMENT_COUNT, 1L);
    ImmutableSegmentDataManager newSegmentManager = new ImmutableSegmentDataManager(immutableSegment);
    SegmentDataManager oldSegmentManager = registerSegment(segmentName, newSegmentManager);
```

### Deprecation
'addValueToTableGauge(java.lang.String, G, long)' is deprecated
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/HLRealtimeSegmentDataManager.java`
#### Snippet
```java
  private void updateCurrentDocumentCountMetrics() {
    int currentRawDocs = _realtimeSegment.getNumDocsIndexed();
    _serverMetrics.addValueToTableGauge(_tableNameWithType, ServerGauge.DOCUMENT_COUNT,
        (currentRawDocs - _lastUpdatedRawDocuments.get()));
    _lastUpdatedRawDocuments.set(currentRawDocs);
```

### Deprecation
'getMinTime()' is deprecated
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/HLRealtimeSegmentDataManager.java`
#### Snippet
```java

          FileUtils.deleteQuietly(tempSegmentFolder);
          long segStartTime = _realtimeSegment.getMinTime();
          long segEndTime = _realtimeSegment.getMaxTime();

```

### Deprecation
'getMaxTime()' is deprecated
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/HLRealtimeSegmentDataManager.java`
#### Snippet
```java
          FileUtils.deleteQuietly(tempSegmentFolder);
          long segStartTime = _realtimeSegment.getMinTime();
          long segEndTime = _realtimeSegment.getMaxTime();

          _segmentLogger.info("Committing {} offsets", _streamConfig.getType());
```

### Deprecation
'addValueToTableGauge(java.lang.String, G, long)' is deprecated
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/HLRealtimeSegmentDataManager.java`
#### Snippet
```java

    _indexingThread.start();
    serverMetrics.addValueToTableGauge(_tableNameWithType, ServerGauge.SEGMENT_COUNT, 1L);
    _segmentLogger.debug("scheduling keepIndexing timer check");
    // start a schedule timer to keep track of the segment
```

### Deprecation
'addValueToTableGauge(java.lang.String, G, long)' is deprecated
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/LLRealtimeSegmentDataManager.java`
#### Snippet
```java
    // Number of rows consumed should be used for consumption metric.
    long rowsIndexed = _numRowsIndexed - _lastUpdatedRowsIndexed.get();
    _serverMetrics.addValueToTableGauge(_tableNameWithType, ServerGauge.DOCUMENT_COUNT, rowsIndexed);
    _lastUpdatedRowsIndexed.set(_numRowsIndexed);
    final long now = now();
```

### Deprecation
'addValueToGlobalGauge(G, long)' is deprecated
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/LLRealtimeSegmentDataManager.java`
#### Snippet
```java
      }
      // Increment llc simultaneous segment builds.
      _serverMetrics.addValueToGlobalGauge(ServerGauge.LLC_SIMULTANEOUS_SEGMENT_BUILDS, 1L);

      final long lockAcquireTimeMillis = now();
```

### Deprecation
'addValueToGlobalGauge(G, long)' is deprecated
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/LLRealtimeSegmentDataManager.java`
#### Snippet
```java
      }
      // Decrement llc simultaneous segment builds.
      _serverMetrics.addValueToGlobalGauge(ServerGauge.LLC_SIMULTANEOUS_SEGMENT_BUILDS, -1L);
    }
  }
```

### Deprecation
'getOffset()' is deprecated
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/LLRealtimeSegmentDataManager.java`
#### Snippet
```java
    } else {
      // TODO Issue 5359 Remove this once the protocol is upgraded on server and controller
      return _streamPartitionMsgOffsetFactory.create(Long.toString(response.getOffset()));
    }
  }
```

### Deprecation
'addValueToTableGauge(java.lang.String, G, long)' is deprecated
in `pinot-core/src/main/java/org/apache/pinot/core/query/reduce/GroupByDataTableReducer.java`
#### Snippet
```java
    if (brokerMetrics != null) {
      brokerMetrics.addMeteredTableValue(rawTableName, BrokerMeter.NUM_RESIZES, indexedTable.getNumResizes());
      brokerMetrics.addValueToTableGauge(rawTableName, BrokerGauge.RESIZE_TIME_MS, indexedTable.getResizeTimeMs());
    }
    int numRecords = indexedTable.size();
```

### Deprecation
'addValueToTableGauge(java.lang.String, G, long)' is deprecated
in `pinot-core/src/main/java/org/apache/pinot/core/query/scheduler/QueryScheduler.java`
#### Snippet
```java
      }
      if (resizeTimeMs > 0) {
        _serverMetrics.addValueToTableGauge(tableNameWithType, ServerGauge.RESIZE_TIME_MS, resizeTimeMs);
      }
      if (threadCpuTimeNs > 0) {
```

### Deprecation
'org.apache.pinot.core.query.aggregation.function.FastHLLAggregationFunction' is deprecated
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/AggregationFunctionFactory.java`
#### Snippet
```java
            return new DistinctCountSmartHLLAggregationFunction(arguments);
          case FASTHLL:
            return new FastHLLAggregationFunction(firstArgument);
          case DISTINCTCOUNTTHETASKETCH:
            return new DistinctCountThetaSketchAggregationFunction(arguments);
```

### Deprecation
'PinotSegmentRecordReader(java.io.File)' is deprecated
in `pinot-core/src/main/java/org/apache/pinot/core/minion/SegmentPurger.java`
#### Snippet
```java
    PurgeRecordReader()
        throws Exception {
      _pinotSegmentRecordReader = new PinotSegmentRecordReader(_indexDir);
    }

```

### Deprecation
'newInstance()' is deprecated
in `pinot-core/src/main/java/org/apache/pinot/core/segment/processing/lifecycle/PinotSegmentLifecycleEventListenerManager.java`
#### Snippet
```java
        try {
          PinotSegmentLifecycleEventListener pinotSegmentLifecycleEventListener =
              (PinotSegmentLifecycleEventListener) clazz.newInstance();
          pinotSegmentLifecycleEventListener.init(helixZkManager);
          _eventTypeToListenersMap.compute(pinotSegmentLifecycleEventListener.getType(), (key, list) -> {
```

### Deprecation
'newInstance()' is deprecated
in `pinot-core/src/main/java/org/apache/pinot/core/metadata/MetadataExtractorFactory.java`
#### Snippet
```java
    try {
      LOGGER.info("Instantiating MetadataExtractor class {}", metadataExtractorClassName);
      MetadataExtractor metadataExtractor = (MetadataExtractor) Class.forName(metadataExtractorClassName).newInstance();
      return metadataExtractor;
    } catch (Exception e) {
```

### Deprecation
'HyperLogLog(int, com.clearspring.analytics.stream.cardinality.RegisterSet)' is deprecated
in `pinot-core/src/main/java/org/apache/pinot/core/common/ObjectSerDeUtils.java`
#### Snippet
```java
        int[] bits = new int[numBits];
        intBuffer.get(bits);
        return new HyperLogLog(log2m, new RegisterSet(1 << log2m, bits));
      } catch (RuntimeException e) {
        throw new RuntimeException("Caught exception while deserializing HyperLogLog", e);
```

### Deprecation
'toServerRoutingInstance(org.apache.pinot.spi.config.table.TableType, boolean)' is deprecated
in `pinot-core/src/main/java/org/apache/pinot/core/transport/QueryRouter.java`
#### Snippet
```java
      for (Map.Entry<ServerInstance, List<String>> entry : offlineRoutingTable.entrySet()) {
        ServerRoutingInstance serverRoutingInstance =
            entry.getKey().toServerRoutingInstance(TableType.OFFLINE, preferTls);
        InstanceRequest instanceRequest = getInstanceRequest(requestId, offlineBrokerRequest, entry.getValue());
        requestMap.put(serverRoutingInstance, instanceRequest);
```

### Deprecation
'toServerRoutingInstance(org.apache.pinot.spi.config.table.TableType, boolean)' is deprecated
in `pinot-core/src/main/java/org/apache/pinot/core/transport/QueryRouter.java`
#### Snippet
```java
      for (Map.Entry<ServerInstance, List<String>> entry : realtimeRoutingTable.entrySet()) {
        ServerRoutingInstance serverRoutingInstance =
            entry.getKey().toServerRoutingInstance(TableType.REALTIME, preferTls);
        InstanceRequest instanceRequest = getInstanceRequest(requestId, realtimeBrokerRequest, entry.getValue());
        requestMap.put(serverRoutingInstance, instanceRequest);
```

### Deprecation
'toServerRoutingInstance(org.apache.pinot.spi.config.table.TableType, boolean)' is deprecated
in `pinot-core/src/main/java/org/apache/pinot/core/transport/QueryRouter.java`
#### Snippet
```java
    try {
      if (_serverChannelsTls != null) {
        _serverChannelsTls.connect(serverInstance.toServerRoutingInstance(TableType.OFFLINE, true));
      } else {
        _serverChannels.connect(serverInstance.toServerRoutingInstance(TableType.OFFLINE, false));
```

### Deprecation
'toServerRoutingInstance(org.apache.pinot.spi.config.table.TableType, boolean)' is deprecated
in `pinot-core/src/main/java/org/apache/pinot/core/transport/QueryRouter.java`
#### Snippet
```java
        _serverChannelsTls.connect(serverInstance.toServerRoutingInstance(TableType.OFFLINE, true));
      } else {
        _serverChannels.connect(serverInstance.toServerRoutingInstance(TableType.OFFLINE, false));
      }
      return true;
```

### Deprecation
'CONFIG_OF_CONTROLLER_HTTPS_ENABLED' is deprecated
in `pinot-core/src/main/java/org/apache/pinot/server/realtime/ServerSegmentCompletionProtocolHandler.java`
#### Snippet
```java
    // NOTE: legacy https config for segment upload is deprecated. If you're relying on these settings, please consider
    // moving to server-wide TLS configs instead. Legacy support will be removed eventually.
    if (httpsConfig.getProperty(CONFIG_OF_CONTROLLER_HTTPS_ENABLED, false)) {
      _sslContext = new ClientSSLContextGenerator(httpsConfig.subset(CommonConstants.PREFIX_OF_SSL_SUBSET)).generate();
      _controllerHttpsPort = httpsConfig.getProperty(CONFIG_OF_CONTROLLER_HTTPS_PORT, Integer.class);
```

### Deprecation
'CONFIG_OF_CONTROLLER_HTTPS_PORT' is deprecated
in `pinot-core/src/main/java/org/apache/pinot/server/realtime/ServerSegmentCompletionProtocolHandler.java`
#### Snippet
```java
    if (httpsConfig.getProperty(CONFIG_OF_CONTROLLER_HTTPS_ENABLED, false)) {
      _sslContext = new ClientSSLContextGenerator(httpsConfig.subset(CommonConstants.PREFIX_OF_SSL_SUBSET)).generate();
      _controllerHttpsPort = httpsConfig.getProperty(CONFIG_OF_CONTROLLER_HTTPS_PORT, Integer.class);
    }

```

### Deprecation
'INSTANCE_ID_KEY' is deprecated
in `pinot-minion/src/main/java/org/apache/pinot/minion/MinionConf.java`
#### Snippet
```java
  public String getInstanceId() {
    String instanceId = getProperty(CommonConstants.Minion.CONFIG_OF_MINION_ID);
    return instanceId != null ? instanceId : getProperty(CommonConstants.Helix.Instance.INSTANCE_ID_KEY);
  }

```

### Deprecation
'DEPRECATED_CONFIG_OF_METRICS_PREFIX_KEY' is deprecated
in `pinot-minion/src/main/java/org/apache/pinot/minion/MinionConf.java`
#### Snippet
```java
  public String getMetricsPrefix() {
    return Optional.ofNullable(getProperty(CommonConstants.Minion.CONFIG_OF_METRICS_PREFIX_KEY))
        .orElseGet(() -> getProperty(CommonConstants.Minion.DEPRECATED_CONFIG_OF_METRICS_PREFIX_KEY,
            CommonConstants.Minion.CONFIG_OF_METRICS_PREFIX));
  }
```

### Deprecation
'DEPRECATED_PREFIX_OF_CONFIG_OF_PINOT_FS_FACTORY' is deprecated
in `pinot-minion/src/main/java/org/apache/pinot/minion/BaseMinionStarter.java`
#### Snippet
```java
    PinotConfiguration pinotFSConfig = _config.subset(CommonConstants.Minion.PREFIX_OF_CONFIG_OF_PINOT_FS_FACTORY);
    if (pinotFSConfig.isEmpty()) {
      pinotFSConfig = _config.subset(CommonConstants.Minion.DEPRECATED_PREFIX_OF_CONFIG_OF_PINOT_FS_FACTORY);
    }
    PinotFSFactory.init(pinotFSConfig);
```

### Deprecation
'DEPRECATED_PREFIX_OF_CONFIG_OF_SEGMENT_FETCHER_FACTORY' is deprecated
in `pinot-minion/src/main/java/org/apache/pinot/minion/BaseMinionStarter.java`
#### Snippet
```java
    if (segmentFetcherFactoryConfig.isEmpty()) {
      segmentFetcherFactoryConfig =
          _config.subset(CommonConstants.Minion.DEPRECATED_PREFIX_OF_CONFIG_OF_SEGMENT_FETCHER_FACTORY);
    }
    SegmentFetcherFactory.init(segmentFetcherFactoryConfig);
```

### Deprecation
'DEPRECATED_PREFIX_OF_CONFIG_OF_PINOT_CRYPTER' is deprecated
in `pinot-minion/src/main/java/org/apache/pinot/minion/BaseMinionStarter.java`
#### Snippet
```java
    PinotConfiguration pinotCrypterConfig = _config.subset(CommonConstants.Minion.PREFIX_OF_CONFIG_OF_PINOT_CRYPTER);
    if (pinotCrypterConfig.isEmpty()) {
      pinotCrypterConfig = _config.subset(CommonConstants.Minion.DEPRECATED_PREFIX_OF_CONFIG_OF_PINOT_CRYPTER);
    }
    PinotCrypterFactory.init(pinotCrypterConfig);
```

### Deprecation
'DEPRECATED_PREFIX_OF_CONFIG_OF_SEGMENT_UPLOADER' is deprecated
in `pinot-minion/src/main/java/org/apache/pinot/minion/BaseMinionStarter.java`
#### Snippet
```java
    if (segmentUploaderConfig.isEmpty()) {
      segmentUploaderConfig =
          _config.subset(CommonConstants.Minion.DEPRECATED_PREFIX_OF_CONFIG_OF_SEGMENT_UPLOADER);
    }
    PinotConfiguration httpsConfig = segmentUploaderConfig.subset(CommonConstants.HTTPS_PROTOCOL);
```

### Deprecation
'newInstance()' is deprecated
in `pinot-minion/src/main/java/org/apache/pinot/minion/event/EventObserverFactoryRegistry.java`
#### Snippet
```java
      if (annotation.enabled()) {
        try {
          MinionEventObserverFactory eventObserverFactory = (MinionEventObserverFactory) clazz.newInstance();
          eventObserverFactory.init(zkMetadataManager);
          registerEventObserverFactory(eventObserverFactory);
```

### Deprecation
'newInstance()' is deprecated
in `pinot-minion/src/main/java/org/apache/pinot/minion/executor/TaskExecutorFactoryRegistry.java`
#### Snippet
```java
      if (annotation.enabled()) {
        try {
          PinotTaskExecutorFactory taskExecutorFactory = (PinotTaskExecutorFactory) clazz.newInstance();
          taskExecutorFactory.init(zkMetadataManager, minionConf);
          registerTaskExecutorFactory(taskExecutorFactory);
```

### Deprecation
'addValueToGlobalGauge(G, long)' is deprecated
in `pinot-minion/src/main/java/org/apache/pinot/minion/taskfactory/TaskFactoryRegistry.java`
#### Snippet
```java
                PinotTaskConfig pinotTaskConfig = PinotTaskConfig.fromHelixTaskConfig(_taskConfig);
                tableName = pinotTaskConfig.getTableName();
                _minionMetrics.addValueToGlobalGauge(MinionGauge.NUMBER_OF_TASKS, 1L);
                _minionMetrics.addMeteredValue(taskType, MinionMeter.NUMBER_TASKS, 1L);
                if (tableName != null) {
```

### Deprecation
'addValueToTableGauge(java.lang.String, G, long)' is deprecated
in `pinot-minion/src/main/java/org/apache/pinot/minion/taskfactory/TaskFactoryRegistry.java`
#### Snippet
```java
                      .addTimedTableValue(tableName, taskType, MinionTimer.TASK_QUEUEING,
                          jobDequeueTimeMs - jobInQueueTimeMs, TimeUnit.MILLISECONDS);
                  _minionMetrics.addValueToTableGauge(tableName, MinionGauge.NUMBER_OF_TASKS, 1L);
                  _minionMetrics.addMeteredTableValue(tableName, taskType, MinionMeter.NUMBER_TASKS, 1L);
                }
```

### Deprecation
'addValueToGlobalGauge(G, long)' is deprecated
in `pinot-minion/src/main/java/org/apache/pinot/minion/taskfactory/TaskFactoryRegistry.java`
#### Snippet
```java
              } finally {
                MinionEventObservers.getInstance().removeMinionEventObserver(_taskConfig.getId());
                _minionMetrics.addValueToGlobalGauge(MinionGauge.NUMBER_OF_TASKS, -1L);
                _minionMetrics.addMeteredValue(taskType, MinionMeter.NUMBER_TASKS, -1L);
                long executionTimeMs = System.currentTimeMillis() - jobDequeueTimeMs;
```

### Deprecation
'addValueToTableGauge(java.lang.String, G, long)' is deprecated
in `pinot-minion/src/main/java/org/apache/pinot/minion/taskfactory/TaskFactoryRegistry.java`
#### Snippet
```java
                    .addTimedValue(taskType, MinionTimer.TASK_EXECUTION, executionTimeMs, TimeUnit.MILLISECONDS);
                if (tableName != null) {
                  _minionMetrics.addValueToTableGauge(tableName, MinionGauge.NUMBER_OF_TASKS, -1L);
                  _minionMetrics.addMeteredTableValue(tableName, taskType, MinionMeter.NUMBER_TASKS, -1L);
                  _minionMetrics
```

### Deprecation
'JdkSslContext(javax.net.ssl.SSLContext, boolean, io.netty.handler.ssl.ClientAuth)' is deprecated
in `pinot-clients/pinot-jdbc-client/src/main/java/org/apache/pinot/client/controller/PinotControllerTransport.java`
#### Snippet
```java
    DefaultAsyncHttpClientConfig.Builder builder = Dsl.config();
    if (sslContext != null) {
      builder.setSslContext(new JdkSslContext(sslContext, true, ClientAuth.OPTIONAL));
    }

```

### Deprecation
'getBigDecimal(int, int)' is deprecated
in `pinot-clients/pinot-jdbc-client/src/main/java/org/apache/pinot/client/base/AbstractBaseResultSet.java`
#### Snippet
```java
  public BigDecimal getBigDecimal(int columnIndex)
      throws SQLException {
    return getBigDecimal(columnIndex, 0);
  }

```

### Deprecation
'getBigDecimal(int, int)' is deprecated
in `pinot-clients/pinot-jdbc-client/src/main/java/org/apache/pinot/client/base/AbstractBaseResultSet.java`
#### Snippet
```java
  public BigDecimal getBigDecimal(String columnLabel, int scale)
      throws SQLException {
    return getBigDecimal(findColumn(columnLabel), scale);
  }

```

### Deprecation
'getUnicodeStream(int)' is deprecated
in `pinot-clients/pinot-jdbc-client/src/main/java/org/apache/pinot/client/base/AbstractBaseResultSet.java`
#### Snippet
```java
  public InputStream getUnicodeStream(String columnLabel)
      throws SQLException {
    return getUnicodeStream(findColumn(columnLabel));
  }

```

### Deprecation
Overrides deprecated method in 'org.apache.pinot.controller.api.access.AccessControl'
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/access/AllowAllAccessFactory.java`
#### Snippet
```java
  private static final AccessControl ALLOW_ALL_ACCESS = new AccessControl() {
    @Override
    public boolean hasDataAccess(HttpHeaders httpHeaders, String tableName) {
      return true;
    }
```

### Deprecation
Overrides deprecated method in 'org.apache.pinot.controller.api.access.AccessControl'
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/access/BasicAuthAccessControlFactory.java`
#### Snippet
```java

    @Override
    public boolean hasDataAccess(HttpHeaders httpHeaders, String tableName) {
      return getPrincipal(httpHeaders).filter(p -> p.hasTable(tableName)).isPresent();
    }
```

### Deprecation
'newInstance()' is deprecated
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/events/MetadataEventNotifierFactory.java`
#### Snippet
```java
      LOGGER.info("Instantiating metadata event notifier factory class {}", metadataEventNotifierClassName);
      metadataEventNotifierFactory =
          (MetadataEventNotifierFactory) Class.forName(metadataEventNotifierClassName).newInstance();
      metadataEventNotifierFactory.init(configuration, helixResourceManager);
      return metadataEventNotifierFactory;
```

### Deprecation
Overrides deprecated method in 'org.apache.pinot.controller.api.access.AccessControl'
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/access/ZkBasicAuthAccessControlFactory.java`
#### Snippet
```java

        @Override
        public boolean hasDataAccess(HttpHeaders httpHeaders, String tableName) {
            return getPrincipal(httpHeaders).filter(p -> p.hasTable(tableName)).isPresent();
        }
```

### Deprecation
'addCallbackGauge(java.lang.String, java.util.concurrent.Callable)' is deprecated
in `pinot-controller/src/main/java/org/apache/pinot/controller/BaseControllerStarter.java`
#### Snippet
```java

    // Emit helix controller metrics
    _controllerMetrics.addCallbackGauge(CommonConstants.Helix.INSTANCE_CONNECTED_METRIC_NAME,
        () -> _helixControllerManager.isConnected() ? 1L : 0L);
    // Deprecated, since getting the leadership of Helix does not mean Helix has been ready for pinot.
```

### Deprecation
'addCallbackGauge(java.lang.String, java.util.concurrent.Callable)' is deprecated
in `pinot-controller/src/main/java/org/apache/pinot/controller/BaseControllerStarter.java`
#### Snippet
```java
        () -> _helixControllerManager.isConnected() ? 1L : 0L);
    // Deprecated, since getting the leadership of Helix does not mean Helix has been ready for pinot.
    _controllerMetrics.addCallbackGauge("helix.leader", () -> _helixControllerManager.isLeader() ? 1L : 0L);
    _helixControllerManager.addPreConnectCallback(
        () -> _controllerMetrics.addMeteredGlobalValue(ControllerMeter.HELIX_ZOOKEEPER_RECONNECTS, 1L));
```

### Deprecation
'newInstance()' is deprecated
in `pinot-controller/src/main/java/org/apache/pinot/controller/BaseControllerStarter.java`
#### Snippet
```java
    final AccessControlFactory accessControlFactory;
    try {
      accessControlFactory = (AccessControlFactory) Class.forName(accessControlFactoryClass).newInstance();
      accessControlFactory.init(_config, _helixResourceManager);
    } catch (Exception e) {
```

### Deprecation
'addCallbackGauge(java.lang.String, java.util.concurrent.Callable)' is deprecated
in `pinot-controller/src/main/java/org/apache/pinot/controller/BaseControllerStarter.java`
#### Snippet
```java
    _adminApp.start(_listenerConfigs);

    _controllerMetrics.addCallbackGauge("dataDir.exists",
        () -> new File(_config.getDataDir()).exists() ? 1L : 0L);
    _controllerMetrics.addCallbackGauge("dataDir.fileOpLatencyMs", () -> {
```

### Deprecation
'addCallbackGauge(java.lang.String, java.util.concurrent.Callable)' is deprecated
in `pinot-controller/src/main/java/org/apache/pinot/controller/BaseControllerStarter.java`
#### Snippet
```java
    _controllerMetrics.addCallbackGauge("dataDir.exists",
        () -> new File(_config.getDataDir()).exists() ? 1L : 0L);
    _controllerMetrics.addCallbackGauge("dataDir.fileOpLatencyMs", () -> {
      File dataDir = new File(_config.getDataDir());
      if (dataDir.exists()) {
```

### Deprecation
'getSchemaName()' is deprecated
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotSchemaRestletResource.java`
#### Snippet
```java
      TableConfig tableConfig = _pinotHelixResourceManager.getTableConfig(realtimeTableName);
      if (tableConfig != null) {
        if (schemaName.equals(tableConfig.getValidationConfig().getSchemaName())) {
          throw new ControllerApplicationException(LOGGER,
              String.format("Cannot delete schema %s, as it is associated with table %s", schemaName,
```

### Deprecation
'getTableName()' is deprecated
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotSegmentUploadDownloadRestletResource.java`
#### Snippet
```java
      } else {
        // TODO: remove this when we completely deprecate the table name from segment metadata
        rawTableName = segmentMetadata.getTableName();
        LOGGER.warn("Table name is not provided as request query parameter when uploading segment: {} for table: {}",
            segmentName, rawTableName);
```

### Deprecation
'hasDataAccess(javax.ws.rs.core.HttpHeaders, java.lang.String)' is deprecated
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotSegmentUploadDownloadRestletResource.java`
#### Snippet
```java
    try {
      AccessControl accessControl = _accessControlFactory.create();
      hasDataAccess = accessControl.hasDataAccess(httpHeaders, tableName);
    } catch (Exception e) {
      throw new ControllerApplicationException(LOGGER,
```

### Deprecation
'addValueToGlobalGauge(G, long)' is deprecated
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/InflightRequestMetricsInterceptor.java`
#### Snippet
```java
      TrackedByGauge trackedByGauge = _resourceInfo.getResourceMethod().getAnnotation(TrackedByGauge.class);
      if (trackedByGauge != null) {
        _controllerMetrics.addValueToGlobalGauge(trackedByGauge.gauge(), -1L);
      }
    }
```

### Deprecation
'addValueToGlobalGauge(G, long)' is deprecated
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/InflightRequestMetricsInterceptor.java`
#### Snippet
```java
    TrackedByGauge trackedByGauge = _resourceInfo.getResourceMethod().getAnnotation(TrackedByGauge.class);
    if (trackedByGauge != null) {
      _controllerMetrics.addValueToGlobalGauge(trackedByGauge.gauge(), 1L);
    }
  }
```

### Deprecation
'put(java.lang.String, com.fasterxml.jackson.databind.JsonNode)' is deprecated
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotTenantRestletResource.java`
#### Snippet
```java
    for (String instance : allInstances) {
      if (enable) {
        instanceResult.put(instance, JsonUtils.objectToJsonNode(_pinotHelixResourceManager.enableInstance(instance)));
      } else {
        instanceResult.put(instance, JsonUtils.objectToJsonNode(_pinotHelixResourceManager.disableInstance(instance)));
```

### Deprecation
'put(java.lang.String, com.fasterxml.jackson.databind.JsonNode)' is deprecated
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotTenantRestletResource.java`
#### Snippet
```java
        instanceResult.put(instance, JsonUtils.objectToJsonNode(_pinotHelixResourceManager.enableInstance(instance)));
      } else {
        instanceResult.put(instance, JsonUtils.objectToJsonNode(_pinotHelixResourceManager.disableInstance(instance)));
      }
    }
```

### Deprecation
'put(java.lang.String, com.fasterxml.jackson.databind.JsonNode)' is deprecated
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotInstanceRestletResource.java`
#### Snippet
```java
      response.put(CommonConstants.Helix.QUERIES_DISABLED, "true");
    }
    response.put("systemResourceInfo", JsonUtils.objectToJsonNode(getSystemResourceInfo(instanceConfig)));
    return response.toString();
  }
```

### Deprecation
'hasDataAccess(javax.ws.rs.core.HttpHeaders, java.lang.String)' is deprecated
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotQueryResource.java`
#### Snippet
```java
    // Validate data access
    AccessControl accessControl = _accessControlFactory.create();
    if (!accessControl.hasDataAccess(httpHeaders, rawTableName)) {
      return QueryException.ACCESS_DENIED_ERROR.toString();
    }
```

### Deprecation
'getOffset()' is deprecated
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/LLCSegmentCompletionHandlers.java`
#### Snippet
```java
    response = segmentCompletionManager.segmentCommitEnd(requestParams, success, false, committingSegmentDescriptor);
    LOGGER.info("Response to segmentCommit: instance={}  segment={} status={} offset={}, streamMsgOffset={}",
        requestParams.getInstanceId(), requestParams.getSegmentName(), response.getStatus(), response.getOffset(),
        response.getStreamPartitionMsgOffset());

```

### Deprecation
'newInstance()' is deprecated
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/minion/generator/TaskGeneratorRegistry.java`
#### Snippet
```java
      if (annotation.enabled()) {
        try {
          PinotTaskGenerator taskGenerator = (PinotTaskGenerator) clazz.newInstance();
          taskGenerator.init(clusterInfoAccessor);
          registerTaskGenerator(taskGenerator);
```

### Deprecation
'addValueToGlobalGauge(G, long)' is deprecated
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/cleanup/StaleInstancesCleanupTask.java`
#### Snippet
```java
          PinotResourceManagerResponse response = _pinotHelixResourceManager.dropInstance(offlineInstance);
          if (response.isSuccessful()) {
            _controllerMetrics.addValueToGlobalGauge(ControllerGauge.DROPPED_MINION_INSTANCES, 1);
          }
        }
```

### Deprecation
'addValueToGlobalGauge(G, long)' is deprecated
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/cleanup/StaleInstancesCleanupTask.java`
#### Snippet
```java
          PinotResourceManagerResponse response = _pinotHelixResourceManager.dropInstance(offlineInstance);
          if (response.isSuccessful()) {
            _controllerMetrics.addValueToGlobalGauge(ControllerGauge.DROPPED_BROKER_INSTANCES, 1);
          }
        }
```

### Deprecation
'addValueToGlobalGauge(G, long)' is deprecated
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/cleanup/StaleInstancesCleanupTask.java`
#### Snippet
```java
          PinotResourceManagerResponse response = _pinotHelixResourceManager.dropInstance(offlineInstance);
          if (response.isSuccessful()) {
            _controllerMetrics.addValueToGlobalGauge(ControllerGauge.DROPPED_SERVER_INSTANCES, 1);
          }
        }
```

### Deprecation
'addValueToTableGauge(java.lang.String, G, long)' is deprecated
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/minion/PinotTaskManager.java`
#### Snippet
```java
        try {
          _scheduler.deleteJob(jobKey);
          _controllerMetrics.addValueToTableGauge(getCronJobName(tableWithType, jobKey.getGroup()),
              ControllerGauge.CRON_SCHEDULER_JOB_SCHEDULED, -1L);
        } catch (SchedulerException e) {
```

### Deprecation
'addValueToTableGauge(java.lang.String, G, long)' is deprecated
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/minion/PinotTaskManager.java`
#### Snippet
```java
      try {
        _scheduler.scheduleJob(jobDetail, trigger);
        _controllerMetrics.addValueToTableGauge(getCronJobName(tableWithType, taskType),
            ControllerGauge.CRON_SCHEDULER_JOB_SCHEDULED, 1L);
      } catch (Exception e) {
```

### Deprecation
'addValueToTableGauge(java.lang.String, G, long)' is deprecated
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/minion/PinotTaskManager.java`
#### Snippet
```java
          try {
            _scheduler.deleteJob(JobKey.jobKey(tableWithType, existingTaskType));
            _controllerMetrics.addValueToTableGauge(getCronJobName(tableWithType, existingTaskType),
                ControllerGauge.CRON_SCHEDULER_JOB_SCHEDULED, -1L);
          } catch (SchedulerException e) {
```

### Deprecation
'newInstance()' is deprecated
in `pinot-controller/src/main/java/org/apache/pinot/controller/tuner/TableConfigTunerRegistry.java`
#### Snippet
```java
          TableConfigTuner tuner;
          try {
            tuner = (TableConfigTuner) tunerClass.newInstance();
            CONFIG_TUNER_MAP.putIfAbsent(tunerName, tuner);
          } catch (Exception e) {
```

### Deprecation
'OFFLINE_TABLE_ESTIMATED_SIZE' is deprecated
in `pinot-controller/src/main/java/org/apache/pinot/controller/validation/StorageQuotaChecker.java`
#### Snippet
```java
    // Since tableNameWithType comes with the table type(OFFLINE), thus we guarantee that
    // tableSubtypeSize.estimatedSizeInBytes is the offline table size.
    _controllerMetrics.setValueOfTableGauge(tableNameWithType, ControllerGauge.OFFLINE_TABLE_ESTIMATED_SIZE,
        tableSubtypeSize._estimatedSizeInBytes);

```

### Deprecation
'org.apache.pinot.spi.data.TimeGranularitySpec' is deprecated
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/io/metadata/TimeGranularitySpecMetadata.java`
#### Snippet
```java


public class TimeGranularitySpecMetadata extends TimeGranularitySpec {
  private int _cardinality = DEFAULT_CARDINALITY;

```

### Deprecation
'getSchemaName()' is deprecated
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/PinotHelixResourceManager.java`
#### Snippet
```java
        if (schema == null) {
          // Fall back to getting schema-name from table config if schema-name != table-name
          String schemaName = tableConfig.getValidationConfig().getSchemaName();
          if (schemaName == null || ZKMetadataProvider.getSchema(_propertyStore, schemaName) == null) {
            throw new InvalidTableConfigException("No schema defined for realtime table: " + tableNameWithType);
```

### Deprecation
'DEPRECATED_ENABLE_CASE_INSENSITIVE_KEY' is deprecated
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/PinotHelixResourceManager.java`
#### Snippet
```java
        new HelixConfigScopeBuilder(HelixConfigScope.ConfigScopeProperty.CLUSTER).forCluster(_helixClusterName).build();
    Map<String, String> configs = _helixAdmin.getConfig(helixConfigScope,
        Arrays.asList(Helix.ENABLE_CASE_INSENSITIVE_KEY, Helix.DEPRECATED_ENABLE_CASE_INSENSITIVE_KEY));
    boolean caseInsensitive =
        Boolean.parseBoolean(configs.get(Helix.ENABLE_CASE_INSENSITIVE_KEY)) || Boolean.parseBoolean(
```

### Deprecation
'DEPRECATED_ENABLE_CASE_INSENSITIVE_KEY' is deprecated
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/PinotHelixResourceManager.java`
#### Snippet
```java
    boolean caseInsensitive =
        Boolean.parseBoolean(configs.get(Helix.ENABLE_CASE_INSENSITIVE_KEY)) || Boolean.parseBoolean(
            configs.get(Helix.DEPRECATED_ENABLE_CASE_INSENSITIVE_KEY));
    _tableCache = new TableCache(_propertyStore, caseInsensitive);
  }
```

### Deprecation
'getSchemaName()' is deprecated
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/PinotHelixResourceManager.java`
#### Snippet
```java
    Schema schema = getSchema(TableNameBuilder.extractRawTableName(tableConfig.getTableName()));
    if (schema == null) {
      String schemaName = tableConfig.getValidationConfig().getSchemaName();
      if (schemaName != null) {
        schema = getSchema(schemaName);
```

### Deprecation
'org.apache.pinot.spi.data.TimeFieldSpec' is deprecated
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/data/generator/DataGenerator.java`
#### Snippet
```java

      case TIME:
        spec = new TimeFieldSpec(new TimeGranularitySpec(dataType, genSpec.getTimeUnitMap().get(column), column));
        break;

```

### Deprecation
'org.apache.pinot.spi.data.TimeGranularitySpec' is deprecated
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/data/generator/DataGenerator.java`
#### Snippet
```java

      case TIME:
        spec = new TimeFieldSpec(new TimeGranularitySpec(dataType, genSpec.getTimeUnitMap().get(column), column));
        break;

```

### Deprecation
'description' is deprecated
in `pinot-server/src/main/java/org/apache/pinot/server/api/resources/MmapDebugResource.java`
#### Snippet
```java
 * Debug endpoint to check memory allocation.
 */
@Api(value = "debug", description = "Debug information", tags = "Debug",
    authorizations = {@Authorization(value = SWAGGER_AUTHORIZATION_KEY)})
@SwaggerDefinition(securityDefinition = @SecurityDefinition(apiKeyAuthDefinitions = @ApiKeyAuthDefinition(name =
```

### Deprecation
'addCallbackGauge(java.lang.String, java.util.concurrent.Callable)' is deprecated
in `pinot-server/src/main/java/org/apache/pinot/server/starter/ServerQueriesDisabledTracker.java`
#### Snippet
```java

  public void start() {
    _serverMetrics.addCallbackGauge(CommonConstants.Helix.QUERIES_DISABLED, () -> _queriesDisabled.get() ? 1L : 0L);
    LOGGER.info("Tracking server queries disabled.");
    _executorService.scheduleWithFixedDelay(() -> {
```

### Deprecation
'addProperty(java.lang.String, java.lang.Object)' is deprecated
in `pinot-server/src/main/java/org/apache/pinot/server/worker/WorkerQueryServer.java`
#### Snippet
```java
      hostname = instanceId.startsWith(CommonConstants.Helix.PREFIX_OF_SERVER_INSTANCE) ? instanceId.substring(
          CommonConstants.Helix.SERVER_INSTANCE_PREFIX_LENGTH) : instanceId;
      newConfig.addProperty(QueryConfig.KEY_OF_QUERY_RUNNER_HOSTNAME, hostname);
    }
    int runnerPort = newConfig.getProperty(QueryConfig.KEY_OF_QUERY_RUNNER_PORT, QueryConfig.DEFAULT_QUERY_RUNNER_PORT);
```

### Deprecation
'addProperty(java.lang.String, java.lang.Object)' is deprecated
in `pinot-server/src/main/java/org/apache/pinot/server/worker/WorkerQueryServer.java`
#### Snippet
```java
      runnerPort =
          newConfig.getProperty(CommonConstants.Server.CONFIG_OF_GRPC_PORT, CommonConstants.Server.DEFAULT_GRPC_PORT);
      newConfig.addProperty(QueryConfig.KEY_OF_QUERY_RUNNER_PORT, runnerPort);
    }
    int servicePort =
```

### Deprecation
'addProperty(java.lang.String, java.lang.Object)' is deprecated
in `pinot-server/src/main/java/org/apache/pinot/server/worker/WorkerQueryServer.java`
#### Snippet
```java
      servicePort = newConfig.getProperty(CommonConstants.Helix.KEY_OF_SERVER_NETTY_PORT,
          CommonConstants.Helix.DEFAULT_SERVER_NETTY_PORT);
      newConfig.addProperty(QueryConfig.KEY_OF_QUERY_SERVER_PORT, servicePort);
    }
    return newConfig;
```

### Deprecation
'PinotSegmentRecordReader(java.io.File)' is deprecated
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/realtime/provisioning/MemoryEstimator.java`
#### Snippet
```java
      long multiValuesSum = 0;
      try {
        PinotSegmentRecordReader segmentRecordReader = new PinotSegmentRecordReader(_sampleCompletedSegment);
        GenericRow row = new GenericRow();

```

### Deprecation
'PinotSegmentRecordReader(java.io.File)' is deprecated
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/realtime/provisioning/MemoryEstimator.java`
#### Snippet
```java

    // read all rows and index them
    try (PinotSegmentRecordReader segmentRecordReader = new PinotSegmentRecordReader(_sampleCompletedSegment)) {
      GenericRow row = new GenericRow();
      while (segmentRecordReader.hasNext()) {
```

### Deprecation
'addCallbackGauge(java.lang.String, java.util.concurrent.Callable)' is deprecated
in `pinot-server/src/main/java/org/apache/pinot/server/starter/helix/BaseServerStarter.java`
#### Snippet
```java
        .registerMessageHandlerFactory(Message.MessageType.USER_DEFINE_MSG.toString(), messageHandlerFactory);

    serverMetrics.addCallbackGauge(Helix.INSTANCE_CONNECTED_METRIC_NAME, () -> _helixManager.isConnected() ? 1L : 0L);
    _helixManager.addPreConnectCallback(
        () -> serverMetrics.addMeteredGlobalValue(ServerMeter.HELIX_ZOOKEEPER_RECONNECTS, 1L));
```

### Deprecation
'addCallbackGauge(java.lang.String, java.util.concurrent.Callable)' is deprecated
in `pinot-server/src/main/java/org/apache/pinot/server/starter/helix/BaseServerStarter.java`
#### Snippet
```java

    // Create metrics for mmap stuff
    serverMetrics.addCallbackGauge("memory.directBufferCount", PinotDataBuffer::getDirectBufferCount);
    serverMetrics.addCallbackGauge("memory.directBufferUsage", PinotDataBuffer::getDirectBufferUsage);
    serverMetrics.addCallbackGauge("memory.mmapBufferCount", PinotDataBuffer::getMmapBufferCount);
```

### Deprecation
'addCallbackGauge(java.lang.String, java.util.concurrent.Callable)' is deprecated
in `pinot-server/src/main/java/org/apache/pinot/server/starter/helix/BaseServerStarter.java`
#### Snippet
```java
    // Create metrics for mmap stuff
    serverMetrics.addCallbackGauge("memory.directBufferCount", PinotDataBuffer::getDirectBufferCount);
    serverMetrics.addCallbackGauge("memory.directBufferUsage", PinotDataBuffer::getDirectBufferUsage);
    serverMetrics.addCallbackGauge("memory.mmapBufferCount", PinotDataBuffer::getMmapBufferCount);
    serverMetrics.addCallbackGauge("memory.mmapBufferUsage", PinotDataBuffer::getMmapBufferUsage);
```

### Deprecation
'addCallbackGauge(java.lang.String, java.util.concurrent.Callable)' is deprecated
in `pinot-server/src/main/java/org/apache/pinot/server/starter/helix/BaseServerStarter.java`
#### Snippet
```java
    serverMetrics.addCallbackGauge("memory.directBufferCount", PinotDataBuffer::getDirectBufferCount);
    serverMetrics.addCallbackGauge("memory.directBufferUsage", PinotDataBuffer::getDirectBufferUsage);
    serverMetrics.addCallbackGauge("memory.mmapBufferCount", PinotDataBuffer::getMmapBufferCount);
    serverMetrics.addCallbackGauge("memory.mmapBufferUsage", PinotDataBuffer::getMmapBufferUsage);
    serverMetrics.addCallbackGauge("memory.allocationFailureCount", PinotDataBuffer::getAllocationFailureCount);
```

### Deprecation
'addCallbackGauge(java.lang.String, java.util.concurrent.Callable)' is deprecated
in `pinot-server/src/main/java/org/apache/pinot/server/starter/helix/BaseServerStarter.java`
#### Snippet
```java
    serverMetrics.addCallbackGauge("memory.directBufferUsage", PinotDataBuffer::getDirectBufferUsage);
    serverMetrics.addCallbackGauge("memory.mmapBufferCount", PinotDataBuffer::getMmapBufferCount);
    serverMetrics.addCallbackGauge("memory.mmapBufferUsage", PinotDataBuffer::getMmapBufferUsage);
    serverMetrics.addCallbackGauge("memory.allocationFailureCount", PinotDataBuffer::getAllocationFailureCount);

```

### Deprecation
'addCallbackGauge(java.lang.String, java.util.concurrent.Callable)' is deprecated
in `pinot-server/src/main/java/org/apache/pinot/server/starter/helix/BaseServerStarter.java`
#### Snippet
```java
    serverMetrics.addCallbackGauge("memory.mmapBufferCount", PinotDataBuffer::getMmapBufferCount);
    serverMetrics.addCallbackGauge("memory.mmapBufferUsage", PinotDataBuffer::getMmapBufferUsage);
    serverMetrics.addCallbackGauge("memory.allocationFailureCount", PinotDataBuffer::getAllocationFailureCount);

    // Track metric for queries disabled
```

### Deprecation
'addProperty(java.lang.String, java.lang.Object)' is deprecated
in `pinot-server/src/main/java/org/apache/pinot/server/starter/helix/BaseServerStarter.java`
#### Snippet
```java
      _instanceId = Helix.PREFIX_OF_SERVER_INSTANCE + _hostname + "_" + _port;
      // NOTE: Need to add the instance id to the config because it is required in HelixInstanceDataManagerConfig
      _serverConf.addProperty(Server.CONFIG_OF_INSTANCE_ID, _instanceId);
    }
    if (_serverConf.getProperty(QueryConfig.KEY_OF_QUERY_SERVER_PORT, QueryConfig.DEFAULT_QUERY_SERVER_PORT) == 0) {
```

### Deprecation
'readFileToString(java.io.File)' is deprecated
in `pinot-compatibility-verifier/src/main/java/org/apache/pinot/compat/TableOp.java`
#### Snippet
```java
      ControllerTest.sendPostRequestRaw(
          ControllerRequestURLBuilder.baseUrl(ClusterDescriptor.getInstance().getControllerUrl()).forTableCreate(),
          FileUtils.readFileToString(new File(getAbsoluteFileName(_tableConfigFileName))), Collections.emptyMap());
      return true;
    } catch (IOException e) {
```

### Deprecation
'readFileToString(java.io.File)' is deprecated
in `pinot-compatibility-verifier/src/main/java/org/apache/pinot/compat/TableOp.java`
#### Snippet
```java
      ControllerTest.sendPostRequestRaw(
          ControllerRequestURLBuilder.baseUrl(ClusterDescriptor.getInstance().getControllerUrl()).forSchemaCreate(),
          FileUtils.readFileToString(new File(getAbsoluteFileName(_schemaFileName))), headers);
      return true;
    } catch (IOException e) {
```

### Deprecation
'uploadSegment(java.net.URI, java.lang.String, java.io.File, java.lang.String)' is deprecated
in `pinot-compatibility-verifier/src/main/java/org/apache/pinot/compat/SegmentOp.java`
#### Snippet
```java
        FileUploadDownloadClient.getUploadSegmentURI(new URI(ClusterDescriptor.getInstance().getControllerUrl()));
    try (FileUploadDownloadClient fileUploadDownloadClient = new FileUploadDownloadClient()) {
      fileUploadDownloadClient.uploadSegment(controllerURI, segmentTarFile.getName(), segmentTarFile, _tableName);
    }
  }
```

### Deprecation
'PinotSegmentRecordReader(java.io.File)' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/SegmentDumpTool.java`
#### Snippet
```java
    File indexDir = new File(_segmentDir);
    Schema schema = new SegmentMetadataImpl(indexDir).getSchema();
    PinotSegmentRecordReader reader = new PinotSegmentRecordReader(indexDir);
    GenericRow reuse = new GenericRow();

```

### Deprecation
'help' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/BootstrapTableCommand.java`
#### Snippet
```java
  private String _authTokenUrl;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;
```

### Deprecation
'help' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ValidateConfigCommand.java`
#### Snippet
```java
  private String _schemaNames;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help;
```

### Deprecation
'help' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/DeleteTableCommand.java`
#### Snippet
```java
  private String _authTokenUrl;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true, description = "Print "
      + "this message.")
  private boolean _help = false;
```

### Deprecation
'help' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AddTableCommand.java`
#### Snippet
```java
  private String _authTokenUrl;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true, description = "Print "
      + "this message.")
  private boolean _help = false;
```

### Deprecation
'help' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ChangeTableState.java`
#### Snippet
```java
  private String _authTokenUrl;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;
```

### Deprecation
'help' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ImportDataCommand.java`
#### Snippet
```java

  @SuppressWarnings("FieldCanBeLocal")
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, help = true, description = "Print this message.")
  private boolean _help = false;

```

### Deprecation
'help' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/GitHubEventsQuickStartCommand.java`
#### Snippet
```java
  private String _sourceType;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, help = true, description = "Print this message.")
  private boolean _help = false;

```

### Deprecation
'help' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ChangeNumReplicasCommand.java`
#### Snippet
```java
  private boolean _exec;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;
```

### Deprecation
'help' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/DeleteSchemaCommand.java`
#### Snippet
```java
  private String _authTokenUrl;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true, description = "Print "
      + "this message.")
  private boolean _help = false;
```

### Deprecation
'help' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/VerifyClusterStateCommand.java`
#### Snippet
```java
  private long _timeoutSec = 300L;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;
```

### Deprecation
'help' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartServiceManagerCommand.java`
#### Snippet
```java
  private final List<Entry<ServiceRole, Map<String, Object>>> _bootstrapConfigurations = new ArrayList<>();

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help;
```

### Deprecation
'help' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/VerifySegmentState.java`
#### Snippet
```java
  String _tablePrefix = "";

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;
```

### Deprecation
'help' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/JsonToPinotSchema.java`
#### Snippet
```java

  @SuppressWarnings("FieldCanBeLocal")
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, help = true, description = "Print this message.")
  private boolean _help = false;

```

### Deprecation
'help' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/OfflineSegmentIntervalCheckerCommand.java`
#### Snippet
```java
  private String _tableNames;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, help = true, description = "Print this message.")
  private boolean _help = false;

```

### Deprecation
'help' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ShowClusterInfoCommand.java`
#### Snippet
```java
  private String _tags = "";

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;
```

### Deprecation
'readLines(java.io.InputStream)' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/QueryRunner.java`
#### Snippet
```java

    List<String> queries =
        makeQueries(IOUtils.readLines(new FileInputStream(_queryFile)), QueryMode.valueOf(_queryMode.toUpperCase()),
            _queryCount);

```

### Deprecation
'help' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/QueryRunner.java`
#### Snippet
```java
      + "false).")
  private boolean _verbose = false;
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true, description = "Print "
      + "this message.")
  private boolean _help;
```

### Deprecation
'help' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/SegmentProcessorFrameworkCommand.java`
#### Snippet
```java
  private String _segmentProcessorFrameworkSpec;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, help = true, description = "Print this message.")
  private boolean _help = false;

```

### Deprecation
'help' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartMinionCommand.java`
#### Snippet
```java
public class StartMinionCommand extends AbstractBaseAdminCommand implements Command {
  private static final Logger LOGGER = LoggerFactory.getLogger(StartMinionCommand.class);
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;
```

### Deprecation
'toString(java.io.InputStream)' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/RealtimeProvisioningHelperCommand.java`
#### Snippet
```java
    TableConfig tableConfig;
    try (FileInputStream fis = new FileInputStream(new File(_tableConfigFile))) {
      String tableConfigString = IOUtils.toString(fis);
      tableConfig = JsonUtils.stringToObject(tableConfigString, TableConfig.class);
    } catch (IOException e) {
```

### Deprecation
'help' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/LaunchSparkDataIngestionJobCommand.java`
#### Snippet
```java
  public static final String PINOT_MAIN_JAR_PREFIX = "pinot-all";

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true, description = "Print "
      + "this message.")
  private boolean _help = false;
```

### Deprecation
'help' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/PostQueryCommand.java`
#### Snippet
```java
  private String _authTokenUrl;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true, description = "Print "
      + "this message.")
  private boolean _help = false;
```

### Deprecation
'help' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/LaunchDataIngestionJobCommand.java`
#### Snippet
```java
public class LaunchDataIngestionJobCommand extends AbstractBaseAdminCommand implements Command {
  private static final Logger LOGGER = LoggerFactory.getLogger(LaunchDataIngestionJobCommand.class);
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;
```

### Deprecation
'help' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AnonymizeDataCommand.java`
#### Snippet
```java
  private boolean _mapBasedGlobalDictionaries = true;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, help = true, description = "Print this message")
  private boolean _help = false;

```

### Deprecation
'help' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/UploadSegmentCommand.java`
#### Snippet
```java
  private TableType _tableType = TableType.OFFLINE;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;
```

### Deprecation
'help' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartZookeeperCommand.java`
#### Snippet
```java
  private String _dataDir = PinotConfigUtils.TMP_DIR + "PinotAdmin/zkData";

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;
```

### Deprecation
'help' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartBrokerCommand.java`
#### Snippet
```java
public class StartBrokerCommand extends AbstractBaseAdminCommand implements Command {
  private static final Logger LOGGER = LoggerFactory.getLogger(StartBrokerCommand.class);
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;
```

### Deprecation
'help' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/CreateSegmentCommand.java`
#### Snippet
```java

  @SuppressWarnings("FieldCanBeLocal")
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, help = true, description = "Print this message.")
  private boolean _help = false;

```

### Deprecation
'help' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/DataImportDryRunCommand.java`
#### Snippet
```java

  @SuppressWarnings("FieldCanBeLocal")
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, help = true, description = "Print this message.")
  private boolean _help = false;

```

### Deprecation
'help' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AddSchemaCommand.java`
#### Snippet
```java
  private String _authTokenUrl;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;
```

### Deprecation
'help' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StreamAvroIntoKafkaCommand.java`
#### Snippet
```java
  private String _avroFile = null;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;
```

### Deprecation
'help' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AvroSchemaToPinotSchema.java`
#### Snippet
```java

  @SuppressWarnings("FieldCanBeLocal")
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, help = true, description = "Print this message.")
  private boolean _help = false;

```

### Deprecation
'help' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/OperateClusterConfigCommand.java`
#### Snippet
```java
  private String _operation;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;
```

### Deprecation
'org.apache.pinot.spi.data.TimeFieldSpec' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/GenerateDataCommand.java`
#### Snippet
```java
            range.put(col, new IntRange(1, 1000));
          }
          TimeFieldSpec tfs = (TimeFieldSpec) fs;
          timeUnits.put(col, tfs.getIncomingGranularitySpec().getTimeType());
          break;
```

### Deprecation
'org.apache.pinot.spi.data.TimeFieldSpec' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/GenerateDataCommand.java`
#### Snippet
```java
            range.put(col, new IntRange(1, 1000));
          }
          TimeFieldSpec tfs = (TimeFieldSpec) fs;
          timeUnits.put(col, tfs.getIncomingGranularitySpec().getTimeType());
          break;
```

### Deprecation
'addTime(org.apache.pinot.spi.data.TimeGranularitySpec, org.apache.pinot.spi.data.TimeGranularitySpec)' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/GenerateDataCommand.java`
#### Snippet
```java
    schemaBuilder.addSingleValueDimension("age", DataType.INT);
    schemaBuilder.addMetric("percent", DataType.FLOAT);
    schemaBuilder.addTime(new TimeGranularitySpec(DataType.LONG, TimeUnit.DAYS, "days"), null);

    Schema schema = schemaBuilder.build();
```

### Deprecation
'org.apache.pinot.spi.data.TimeGranularitySpec' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/GenerateDataCommand.java`
#### Snippet
```java
    schemaBuilder.addSingleValueDimension("age", DataType.INT);
    schemaBuilder.addMetric("percent", DataType.FLOAT);
    schemaBuilder.addTime(new TimeGranularitySpec(DataType.LONG, TimeUnit.DAYS, "days"), null);

    Schema schema = schemaBuilder.build();
```

### Deprecation
'help' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/GenerateDataCommand.java`
#### Snippet
```java
  private boolean _help = false;

  @CommandLine.Option(names = {"-format"}, required = false, help = true,
      description = "Output format ('AVRO' or 'CSV').")
  private String _format = FORMAT_AVRO;
```

### Deprecation
'help' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/GenerateDataCommand.java`
#### Snippet
```java
  boolean _overwrite;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;
```

### Deprecation
'help' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AddTenantCommand.java`
#### Snippet
```java
  private String _authTokenUrl;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;
```

### Deprecation
'help' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/DeleteClusterCommand.java`
#### Snippet
```java
  private String _zkAddress = DEFAULT_ZK_ADDRESS;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;
```

### Deprecation
'help' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartKafkaCommand.java`
#### Snippet
```java
  private int _port = KafkaStarterUtils.DEFAULT_KAFKA_PORT;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;
```

### Deprecation
'help' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StreamGitHubEventsCommand.java`
#### Snippet
```java
  private String _schemaFile;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, help = true, description = "Print this message.")
  private boolean _help = false;

```

### Deprecation
'help' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartServerCommand.java`
#### Snippet
```java
public class StartServerCommand extends AbstractBaseAdminCommand implements Command {
  private static final Logger LOGGER = LoggerFactory.getLogger(StartServerCommand.class);
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;
```

### Deprecation
'help' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StopProcessCommand.java`
#### Snippet
```java
  private boolean _kafka = false;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Stop the PinotServer.")
  private boolean _help = false;
```

### Deprecation
'help' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/RebalanceTableCommand.java`
#### Snippet
```java
      RebalanceConfigConstants.DEFAULT_EXTERNAL_VIEW_STABILIZATION_TIMEOUT_IN_MS;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, help = true, description = "Print this message")
  private boolean _help = false;

```

### Deprecation
'help' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/segment/converter/PinotSegmentConvertCommand.java`
#### Snippet
```java
  private boolean _overwrite;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help;
```

### Deprecation
'PinotSegmentRecordReader(java.io.File)' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/segment/converter/PinotSegmentToAvroConverter.java`
#### Snippet
```java
    File indexDir = new File(_segmentDir);
    Schema avroSchema = AvroUtils.getAvroSchemaFromPinotSchema(new SegmentMetadataImpl(indexDir).getSchema());
    try (PinotSegmentRecordReader pinotSegmentRecordReader = new PinotSegmentRecordReader(new File(_segmentDir))) {
      try (DataFileWriter<Record> recordWriter = new DataFileWriter<>(new GenericDatumWriter<>(avroSchema))) {
        recordWriter.create(avroSchema, new File(_outputFile));
```

### Deprecation
'PinotSegmentRecordReader(java.io.File)' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/segment/converter/PinotSegmentToJsonConverter.java`
#### Snippet
```java
  public void convert()
      throws Exception {
    try (PinotSegmentRecordReader recordReader = new PinotSegmentRecordReader(new File(_segmentDir));
        BufferedWriter recordWriter = new BufferedWriter(new FileWriter(_outputFile))) {
      GenericRow row = new GenericRow();
```

### Deprecation
'PinotSegmentRecordReader(java.io.File)' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/segment/converter/PinotSegmentToCsvConverter.java`
#### Snippet
```java
  public void convert()
      throws Exception {
    try (PinotSegmentRecordReader recordReader = new PinotSegmentRecordReader(new File(_segmentDir));
        BufferedWriter recordWriter = new BufferedWriter(new FileWriter(_outputFile))) {
      GenericRow row = new GenericRow();
```

### Deprecation
'help' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/segment/converter/DictionaryToRawIndexConverter.java`
#### Snippet
```java
  private String _compressionType = "Snappy";

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "print this message")
  private boolean _help = false;
```

### Deprecation
'DEPRECATED_RETENTION_MANAGER_FREQUENCY_IN_SECONDS' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/utils/PinotConfigUtils.java`
#### Snippet
```java
    properties.put(ControllerConf.CONTROLLER_VIP_HOST, controllerHost);
    properties.put(ControllerConf.CLUSTER_TENANT_ISOLATION_ENABLE, tenantIsolation);
    properties.put(ControllerPeriodicTasksConf.DEPRECATED_RETENTION_MANAGER_FREQUENCY_IN_SECONDS, 3600 * 6);
    properties.put(ControllerPeriodicTasksConf.DEPRECATED_OFFLINE_SEGMENT_INTERVAL_CHECKER_FREQUENCY_IN_SECONDS, 3600);
    properties.put(ControllerPeriodicTasksConf.DEPRECATED_REALTIME_SEGMENT_VALIDATION_FREQUENCY_IN_SECONDS, 3600);
```

### Deprecation
'DEPRECATED_OFFLINE_SEGMENT_INTERVAL_CHECKER_FREQUENCY_IN_SECONDS' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/utils/PinotConfigUtils.java`
#### Snippet
```java
    properties.put(ControllerConf.CLUSTER_TENANT_ISOLATION_ENABLE, tenantIsolation);
    properties.put(ControllerPeriodicTasksConf.DEPRECATED_RETENTION_MANAGER_FREQUENCY_IN_SECONDS, 3600 * 6);
    properties.put(ControllerPeriodicTasksConf.DEPRECATED_OFFLINE_SEGMENT_INTERVAL_CHECKER_FREQUENCY_IN_SECONDS, 3600);
    properties.put(ControllerPeriodicTasksConf.DEPRECATED_REALTIME_SEGMENT_VALIDATION_FREQUENCY_IN_SECONDS, 3600);
    properties.put(ControllerPeriodicTasksConf.DEPRECATED_BROKER_RESOURCE_VALIDATION_FREQUENCY_IN_SECONDS, 3600);
```

### Deprecation
'DEPRECATED_REALTIME_SEGMENT_VALIDATION_FREQUENCY_IN_SECONDS' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/utils/PinotConfigUtils.java`
#### Snippet
```java
    properties.put(ControllerPeriodicTasksConf.DEPRECATED_RETENTION_MANAGER_FREQUENCY_IN_SECONDS, 3600 * 6);
    properties.put(ControllerPeriodicTasksConf.DEPRECATED_OFFLINE_SEGMENT_INTERVAL_CHECKER_FREQUENCY_IN_SECONDS, 3600);
    properties.put(ControllerPeriodicTasksConf.DEPRECATED_REALTIME_SEGMENT_VALIDATION_FREQUENCY_IN_SECONDS, 3600);
    properties.put(ControllerPeriodicTasksConf.DEPRECATED_BROKER_RESOURCE_VALIDATION_FREQUENCY_IN_SECONDS, 3600);
    properties.put(ControllerConf.CONTROLLER_MODE, controllerMode.toString());
```

### Deprecation
'DEPRECATED_BROKER_RESOURCE_VALIDATION_FREQUENCY_IN_SECONDS' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/utils/PinotConfigUtils.java`
#### Snippet
```java
    properties.put(ControllerPeriodicTasksConf.DEPRECATED_OFFLINE_SEGMENT_INTERVAL_CHECKER_FREQUENCY_IN_SECONDS, 3600);
    properties.put(ControllerPeriodicTasksConf.DEPRECATED_REALTIME_SEGMENT_VALIDATION_FREQUENCY_IN_SECONDS, 3600);
    properties.put(ControllerPeriodicTasksConf.DEPRECATED_BROKER_RESOURCE_VALIDATION_FREQUENCY_IN_SECONDS, 3600);
    properties.put(ControllerConf.CONTROLLER_MODE, controllerMode.toString());

```

### Deprecation
'help' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/filesystem/PinotFSBenchmarkRunner.java`
#### Snippet
```java
  private Integer _numOps;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;
```

### Deprecation
'PinotSegmentRecordReader(java.io.File, org.apache.pinot.spi.data.Schema, java.util.List)' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/anonymizer/PinotDataAndQueryAnonymizer.java`
#### Snippet
```java
      String pathToSegment = _segmentDir + "/" + _segmentDirectories[file];
      File segmentIndexDir = new File(pathToSegment);
      try (PinotSegmentRecordReader recordReader = new PinotSegmentRecordReader(segmentIndexDir, _pinotSchema, null);
          DataFileWriter<GenericData.Record> avroRecordWriter = new DataFileWriter<>(
              new GenericDatumWriter<GenericData.Record>(_avroSchema))) {
```

### Deprecation
'org.apache.pinot.spi.data.TimeFieldSpec' is deprecated
in `pinot-tools/src/main/java/org/apache/pinot/tools/anonymizer/PinotDataAndQueryAnonymizer.java`
#### Snippet
```java
      } else if (fieldSpec instanceof MetricFieldSpec) {
        prefix = "METRIC";
      } else if (fieldSpec instanceof TimeFieldSpec) {
        prefix = "TIME";
      } else if (fieldSpec instanceof DateTimeFieldSpec) {
```

### Deprecation
'newInstance()' is deprecated
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/loader/SegmentDirectoryLoaderRegistry.java`
#### Snippet
```java
          SegmentDirectoryLoader segmentDirectoryLoader;
          try {
            segmentDirectoryLoader = (SegmentDirectoryLoader) loaderClass.newInstance();
            SEGMENT_DIRECTORY_LOADER_MAP.putIfAbsent(segmentLoaderName, segmentDirectoryLoader);
          } catch (Exception e) {
```

### Deprecation
'org.apache.pinot.spi.data.TimeFieldSpec' is deprecated
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/index/metadata/ColumnMetadataImpl.java`
#### Snippet
```java
      case TIME:
        TimeUnit timeUnit = TimeUnit.valueOf(config.getString(Segment.TIME_UNIT, "DAYS").toUpperCase());
        fieldSpec = new TimeFieldSpec(new TimeGranularitySpec(dataType, timeUnit, column));
        break;
      case DATE_TIME:
```

### Deprecation
'org.apache.pinot.spi.data.TimeGranularitySpec' is deprecated
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/index/metadata/ColumnMetadataImpl.java`
#### Snippet
```java
      case TIME:
        TimeUnit timeUnit = TimeUnit.valueOf(config.getString(Segment.TIME_UNIT, "DAYS").toUpperCase());
        fieldSpec = new TimeFieldSpec(new TimeGranularitySpec(dataType, timeUnit, column));
        break;
      case DATE_TIME:
```

### Deprecation
'newInstance()' is deprecated
in `pinot-broker/src/main/java/org/apache/pinot/broker/broker/AccessControlFactory.java`
#### Snippet
```java
    try {
      LOGGER.info("Instantiating Access control factory class {}", accessControlFactoryClassName);
      accessControlFactory = (AccessControlFactory) Class.forName(accessControlFactoryClassName).newInstance();
      LOGGER.info("Initializing Access control factory class {}", accessControlFactoryClassName);
      accessControlFactory.init(configuration, propertyStore);
```

### Deprecation
'DEPRECATED_ENABLE_CASE_INSENSITIVE_KEY' is deprecated
in `pinot-broker/src/main/java/org/apache/pinot/broker/broker/helix/BaseBrokerStarter.java`
#### Snippet
```java
    boolean caseInsensitive =
        _brokerConf.getProperty(Helix.ENABLE_CASE_INSENSITIVE_KEY, false) || _brokerConf.getProperty(
            Helix.DEPRECATED_ENABLE_CASE_INSENSITIVE_KEY, false);
    TableCache tableCache = new TableCache(_propertyStore, caseInsensitive);
    // Configure TLS for netty connection to server
```

### Deprecation
'addCallbackGauge(java.lang.String, java.util.concurrent.Callable)' is deprecated
in `pinot-broker/src/main/java/org/apache/pinot/broker/broker/helix/BaseBrokerStarter.java`
#### Snippet
```java
    _participantHelixManager.connect();
    updateInstanceConfigAndBrokerResourceIfNeeded();
    _brokerMetrics.addCallbackGauge(Helix.INSTANCE_CONNECTED_METRIC_NAME,
        () -> _participantHelixManager.isConnected() ? 1L : 0L);
    _participantHelixManager.addPreConnectCallback(
```

### Deprecation
'INSTANCE_ID_KEY' is deprecated
in `pinot-broker/src/main/java/org/apache/pinot/broker/broker/helix/BaseBrokerStarter.java`
#### Snippet
```java
    _instanceId = _brokerConf.getProperty(Broker.CONFIG_OF_BROKER_ID);
    if (_instanceId == null) {
      _instanceId = _brokerConf.getProperty(Helix.Instance.INSTANCE_ID_KEY);
    }
    if (_instanceId == null) {
```

### Deprecation
'addCallbackTableGaugeIfNeeded(java.lang.String, G, java.util.concurrent.Callable)' is deprecated
in `pinot-broker/src/main/java/org/apache/pinot/broker/queryquota/HelixExternalViewBasedQueryQuotaManager.java`
#### Snippet
```java
  private void addMaxBurstQPSCallbackTableGaugeIfNeeded(String tableNameWithType, QueryQuotaEntity queryQuotaEntity) {
    final QueryQuotaEntity finalQueryQuotaEntity = queryQuotaEntity;
    _brokerMetrics.addCallbackTableGaugeIfNeeded(tableNameWithType, BrokerGauge.MAX_BURST_QPS,
        () -> (long) finalQueryQuotaEntity.getMaxQpsTracker().getMaxCountPerBucket());
  }
```

### Deprecation
'init(java.util.Map)' is deprecated
in `pinot-perf/src/main/java/org/apache/pinot/perf/StringDictionaryPerfTest.java`
#### Snippet
```java

      GenericRow genericRow = new GenericRow();
      genericRow.init(map);
      rows.add(genericRow);
    }
```

### Deprecation
'putField(java.lang.String, java.lang.Object)' is deprecated
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNativeVsLuceneTextIndex.java`
#### Snippet
```java
      String domain = domainNames.get(i % domainNames.size());
      GenericRow row = new GenericRow();
      row.putField(DOMAIN_NAMES_COL, domain);
      row.putField(INT_COL, i);
      rows.add(row);
```

### Deprecation
'putField(java.lang.String, java.lang.Object)' is deprecated
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNativeVsLuceneTextIndex.java`
#### Snippet
```java
      GenericRow row = new GenericRow();
      row.putField(DOMAIN_NAMES_COL, domain);
      row.putField(INT_COL, i);
      rows.add(row);
    }
```

### Deprecation
'FieldConfig(java.lang.String, org.apache.pinot.spi.config.table.FieldConfig.EncodingType, org.apache.pinot.spi.config.table.FieldConfig.IndexType, org.apache.pinot.spi.config.table.FieldConfig.CompressionCodec, java.util.Map)' is deprecated
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNativeVsLuceneTextIndex.java`
#### Snippet
```java

    fieldConfigs.add(
        new FieldConfig(DOMAIN_NAMES_COL, FieldConfig.EncodingType.DICTIONARY, FieldConfig.IndexType.TEXT, null,
            propertiesMap));

```

### Deprecation
'Double(double)' is deprecated
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkFixedIntArrayOffHeapIdMap.java`
#### Snippet
```java
  private static final int COLUMN_CARDINALITY = 100;
  private static final int NUM_COLUMNS = 3;
  private static final int CARDINALITY = (new Double(Math.pow(COLUMN_CARDINALITY, NUM_COLUMNS))).intValue();

  private FixedIntArray[] _values;
```

### Deprecation
'addValueToTableGauge(java.lang.String, G, long)' is deprecated
in `pinot-broker/src/main/java/org/apache/pinot/broker/requesthandler/BaseBrokerRequestHandler.java`
#### Snippet
```java

      _brokerMetrics.addMeteredTableValue(rawTableName, BrokerMeter.QUERIES, 1);
      _brokerMetrics.addValueToTableGauge(rawTableName, BrokerGauge.REQUEST_SIZE, query.length());

      // Prepare OFFLINE and REALTIME requests
```

### Deprecation
'init(java.util.Map)' is deprecated
in `pinot-perf/src/main/java/org/apache/pinot/perf/RawIndexBenchmark.java`
#### Snippet
```java

      GenericRow genericRow = new GenericRow();
      genericRow.init(map);
      rows.add(genericRow);
      _numRows++;
```

### Deprecation
'FieldConfig(java.lang.String, org.apache.pinot.spi.config.table.FieldConfig.EncodingType, org.apache.pinot.spi.config.table.FieldConfig.IndexType, org.apache.pinot.spi.config.table.FieldConfig.CompressionCodec, java.util.Map)' is deprecated
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNativeAndLuceneBasedLike.java`
#### Snippet
```java
    List<FieldConfig> fieldConfigs = new ArrayList<>();
    fieldConfigs.add(
        new FieldConfig(DOMAIN_NAMES_COL, FieldConfig.EncodingType.DICTIONARY, FieldConfig.IndexType.FST, null, null));
    fieldConfigs
        .add(new FieldConfig(URL_COL, FieldConfig.EncodingType.DICTIONARY, FieldConfig.IndexType.FST, null, null));
```

### Deprecation
'FieldConfig(java.lang.String, org.apache.pinot.spi.config.table.FieldConfig.EncodingType, org.apache.pinot.spi.config.table.FieldConfig.IndexType, org.apache.pinot.spi.config.table.FieldConfig.CompressionCodec, java.util.Map)' is deprecated
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNativeAndLuceneBasedLike.java`
#### Snippet
```java
        new FieldConfig(DOMAIN_NAMES_COL, FieldConfig.EncodingType.DICTIONARY, FieldConfig.IndexType.FST, null, null));
    fieldConfigs
        .add(new FieldConfig(URL_COL, FieldConfig.EncodingType.DICTIONARY, FieldConfig.IndexType.FST, null, null));
    TableConfig tableConfig = new TableConfigBuilder(TableType.OFFLINE).setTableName(TABLE_NAME)
        .setInvertedIndexColumns(Collections.singletonList(DOMAIN_NAMES_COL)).setFieldConfigList(fieldConfigs).build();
```

### Deprecation
'putField(java.lang.String, java.lang.Object)' is deprecated
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNativeAndLuceneBasedLike.java`
#### Snippet
```java
      String url = domain + urlSuffixes[i % urlSuffixes.length];
      GenericRow row = new GenericRow();
      row.putField(INT_COL_NAME, _intBaseValue + i);
      row.putField(NO_INDEX_STRING_COL_NAME, noIndexData[i % noIndexData.length]);
      row.putField(DOMAIN_NAMES_COL, domain);
```

### Deprecation
'putField(java.lang.String, java.lang.Object)' is deprecated
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNativeAndLuceneBasedLike.java`
#### Snippet
```java
      GenericRow row = new GenericRow();
      row.putField(INT_COL_NAME, _intBaseValue + i);
      row.putField(NO_INDEX_STRING_COL_NAME, noIndexData[i % noIndexData.length]);
      row.putField(DOMAIN_NAMES_COL, domain);
      row.putField(URL_COL, url);
```

### Deprecation
'putField(java.lang.String, java.lang.Object)' is deprecated
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNativeAndLuceneBasedLike.java`
#### Snippet
```java
      row.putField(INT_COL_NAME, _intBaseValue + i);
      row.putField(NO_INDEX_STRING_COL_NAME, noIndexData[i % noIndexData.length]);
      row.putField(DOMAIN_NAMES_COL, domain);
      row.putField(URL_COL, url);
      rows.add(row);
```

### Deprecation
'putField(java.lang.String, java.lang.Object)' is deprecated
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNativeAndLuceneBasedLike.java`
#### Snippet
```java
      row.putField(NO_INDEX_STRING_COL_NAME, noIndexData[i % noIndexData.length]);
      row.putField(DOMAIN_NAMES_COL, domain);
      row.putField(URL_COL, url);
      rows.add(row);
    }
```

### Deprecation
'DEPRECATED_USE_LOCAL_DIRECTORY_SEQUENCE_ID' is deprecated
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-common/src/main/java/org/apache/pinot/plugin/ingestion/batch/common/SegmentGenerationJobUtils.java`
#### Snippet
```java
    if (useGlobalDirectorySequenceId == null) {
      String useLocalDirectorySequenceId =
          spec.getConfigs().get(SegmentGenerationTaskRunner.DEPRECATED_USE_LOCAL_DIRECTORY_SEQUENCE_ID);
      if (useLocalDirectorySequenceId != null) {
        return !Boolean.parseBoolean(useLocalDirectorySequenceId);
```

### Deprecation
'addValueToTableGauge(java.lang.String, G, long)' is deprecated
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/readerwriter/RealtimeIndexOffHeapMemoryManager.java`
#### Snippet
```java
    }
    if (_serverMetrics != null) {
      _serverMetrics.addValueToTableGauge(_rawTableName, ServerGauge.REALTIME_OFFHEAP_MEMORY_USED,
          -_totalAllocatedBytes);
    }
```

### Deprecation
'addValueToTableGauge(java.lang.String, G, long)' is deprecated
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/readerwriter/RealtimeIndexOffHeapMemoryManager.java`
#### Snippet
```java
    _buffers.add(buffer);
    if (_serverMetrics != null) {
      _serverMetrics.addValueToTableGauge(_rawTableName, ServerGauge.REALTIME_OFFHEAP_MEMORY_USED, size);
    }
    return buffer;
```

### Deprecation
'getTransformFunction()' is deprecated
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/SchemaUtils.java`
#### Snippet
```java
            "The column name \"%s\" should not contain blank space.", column);
        primaryKeyColumnCandidates.add(column);
        String transformFunction = fieldSpec.getTransformFunction();
        if (transformFunction != null) {
          try {
```

### Deprecation
'org.apache.pinot.spi.data.TimeFieldSpec' is deprecated
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/SchemaUtils.java`
#### Snippet
```java
        }
        if (fieldSpec.getFieldType().equals(FieldSpec.FieldType.TIME)) {
          validateTimeFieldSpec((TimeFieldSpec) fieldSpec);
        }
        if (fieldSpec.getFieldType().equals(FieldSpec.FieldType.DATE_TIME)) {
```

### Deprecation
'org.apache.pinot.spi.data.TimeFieldSpec' is deprecated
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/SchemaUtils.java`
#### Snippet
```java
   * Checks for valid incoming and outgoing granularity spec in the time field spec
   */
  private static void validateTimeFieldSpec(TimeFieldSpec timeFieldSpec) {
    TimeGranularitySpec incomingGranularitySpec = timeFieldSpec.getIncomingGranularitySpec();
    TimeGranularitySpec outgoingGranularitySpec = timeFieldSpec.getOutgoingGranularitySpec();
```

### Deprecation
'org.apache.pinot.spi.data.TimeGranularitySpec' is deprecated
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/SchemaUtils.java`
#### Snippet
```java
   */
  private static void validateTimeFieldSpec(TimeFieldSpec timeFieldSpec) {
    TimeGranularitySpec incomingGranularitySpec = timeFieldSpec.getIncomingGranularitySpec();
    TimeGranularitySpec outgoingGranularitySpec = timeFieldSpec.getOutgoingGranularitySpec();

```

### Deprecation
'org.apache.pinot.spi.data.TimeGranularitySpec' is deprecated
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/SchemaUtils.java`
#### Snippet
```java
  private static void validateTimeFieldSpec(TimeFieldSpec timeFieldSpec) {
    TimeGranularitySpec incomingGranularitySpec = timeFieldSpec.getIncomingGranularitySpec();
    TimeGranularitySpec outgoingGranularitySpec = timeFieldSpec.getOutgoingGranularitySpec();

    if (!incomingGranularitySpec.equals(outgoingGranularitySpec)) {
```

### Deprecation
'org.apache.pinot.spi.data.TimeGranularitySpec' is deprecated
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/SchemaUtils.java`
#### Snippet
```java

      Preconditions.checkState(
          incomingGranularitySpec.getTimeFormat().equals(TimeGranularitySpec.TimeFormat.EPOCH.toString())
              && outgoingGranularitySpec.getTimeFormat().equals(TimeGranularitySpec.TimeFormat.EPOCH.toString()),
          "Cannot perform time conversion for time format other than EPOCH. TimeFieldSpec: %s", timeFieldSpec);
```

### Deprecation
'org.apache.pinot.spi.data.TimeGranularitySpec.TimeFormat' is deprecated
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/SchemaUtils.java`
#### Snippet
```java

      Preconditions.checkState(
          incomingGranularitySpec.getTimeFormat().equals(TimeGranularitySpec.TimeFormat.EPOCH.toString())
              && outgoingGranularitySpec.getTimeFormat().equals(TimeGranularitySpec.TimeFormat.EPOCH.toString()),
          "Cannot perform time conversion for time format other than EPOCH. TimeFieldSpec: %s", timeFieldSpec);
```

### Deprecation
'org.apache.pinot.spi.data.TimeGranularitySpec' is deprecated
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/SchemaUtils.java`
#### Snippet
```java
      Preconditions.checkState(
          incomingGranularitySpec.getTimeFormat().equals(TimeGranularitySpec.TimeFormat.EPOCH.toString())
              && outgoingGranularitySpec.getTimeFormat().equals(TimeGranularitySpec.TimeFormat.EPOCH.toString()),
          "Cannot perform time conversion for time format other than EPOCH. TimeFieldSpec: %s", timeFieldSpec);
    }
```

### Deprecation
'org.apache.pinot.spi.data.TimeGranularitySpec.TimeFormat' is deprecated
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/SchemaUtils.java`
#### Snippet
```java
      Preconditions.checkState(
          incomingGranularitySpec.getTimeFormat().equals(TimeGranularitySpec.TimeFormat.EPOCH.toString())
              && outgoingGranularitySpec.getTimeFormat().equals(TimeGranularitySpec.TimeFormat.EPOCH.toString()),
          "Cannot perform time conversion for time format other than EPOCH. TimeFieldSpec: %s", timeFieldSpec);
    }
```

### Deprecation
'pop()' is deprecated
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/builder/FSTSerializerImpl.java`
#### Snippet
```java

    while (!nodes.isEmpty()) {
      final int node = nodes.pop();

      if (visited.get(node)) {
```

### Deprecation
'getStreamConfigs()' is deprecated
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/TableConfigUtils.java`
#### Snippet
```java
      if (ingestionConfig.getStreamIngestionConfig() != null) {
        IndexingConfig indexingConfig = tableConfig.getIndexingConfig();
        Preconditions.checkState(indexingConfig == null || MapUtils.isEmpty(indexingConfig.getStreamConfigs()),
            "Should not use indexingConfig#getStreamConfigs if ingestionConfig#StreamIngestionConfig is provided");
        List<Map<String, String>> streamConfigMaps = ingestionConfig.getStreamIngestionConfig().getStreamConfigMaps();
```

### Deprecation
'getStreamConfigs()' is deprecated
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/TableConfigUtils.java`
#### Snippet
```java
    IndexingConfig indexingConfig = tableConfig.getIndexingConfig();
    if (indexingConfig != null) {
      Map<String, String> streamConfig = indexingConfig.getStreamConfigs();
      if (streamConfig != null && KINESIS_STREAM_TYPE.equals(streamConfig.get(StreamConfigProperties.STREAM_TYPE))) {
        return true;
```

### Deprecation
'getIndexType()' is deprecated
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/loader/IndexLoadingConfig.java`
#### Snippet
```java
      for (FieldConfig fieldConfig : fieldConfigList) {
        String column = fieldConfig.getName();
        if (fieldConfig.getIndexType() == FieldConfig.IndexType.FST) {
          _fstIndexColumns.add(column);
        }
```

### Deprecation
'getIndexType()' is deprecated
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/loader/IndexLoadingConfig.java`
#### Snippet
```java
      for (FieldConfig fieldConfig : fieldConfigList) {
        String column = fieldConfig.getName();
        if (fieldConfig.getIndexType() == FieldConfig.IndexType.TEXT) {
          _textIndexColumns.add(column);
          Map<String, String> propertiesMap = fieldConfig.getProperties();
```

### Deprecation
'getIndexType()' is deprecated
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/loader/IndexLoadingConfig.java`
#### Snippet
```java
    if (fieldConfigList != null) {
      for (FieldConfig fieldConfig : fieldConfigList) {
        if (fieldConfig.getIndexType() == FieldConfig.IndexType.H3) {
          //noinspection ConstantConditions
          _h3IndexConfigs.put(fieldConfig.getName(), new H3IndexConfig(fieldConfig.getProperties()));
```

### Deprecation
'PinotSegmentRecordReader(java.io.File, org.apache.pinot.spi.data.Schema, java.util.List)' is deprecated
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/creator/impl/SegmentIndexCreationDriverImpl.java`
#### Snippet
```java
    // NOTE: PinotSegmentRecordReader does not support time conversion (field spec must match)
    if (fileFormat == FileFormat.PINOT) {
      return new PinotSegmentRecordReader(dataFile, schema, segmentGeneratorConfig.getColumnSortOrder());
    } else {
      return RecordReaderFactory
```

### Deprecation
'org.apache.pinot.spi.utils.TimeConverter' is deprecated
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/function/TimeSpecFunctionEvaluator.java`
#### Snippet
```java
  private final String _incomingTimeColumn;
  private final String _outgoingTimeColumn;
  private final TimeConverter _incomingTimeConverter;
  private final TimeConverter _outgoingTimeConverter;
  private boolean _isValidated = false;
```

### Deprecation
'org.apache.pinot.spi.data.TimeFieldSpec' is deprecated
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/function/TimeSpecFunctionEvaluator.java`
#### Snippet
```java

/**
 * An implementation of {@link FunctionEvaluator} for converting the time value based on the {@link TimeFieldSpec}.
 */
public class TimeSpecFunctionEvaluator implements FunctionEvaluator {
```

### Deprecation
'org.apache.pinot.spi.data.TimeGranularitySpec' is deprecated
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/function/TimeSpecFunctionEvaluator.java`
#### Snippet
```java
  private boolean _isValidated = false;

  public TimeSpecFunctionEvaluator(TimeGranularitySpec incomingGranularitySpec,
      TimeGranularitySpec outgoingGranularitySpec) {
    Preconditions.checkState(!incomingGranularitySpec.equals(outgoingGranularitySpec));
```

### Deprecation
'org.apache.pinot.spi.data.TimeGranularitySpec' is deprecated
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/function/TimeSpecFunctionEvaluator.java`
#### Snippet
```java

  public TimeSpecFunctionEvaluator(TimeGranularitySpec incomingGranularitySpec,
      TimeGranularitySpec outgoingGranularitySpec) {
    Preconditions.checkState(!incomingGranularitySpec.equals(outgoingGranularitySpec));
    _incomingTimeColumn = incomingGranularitySpec.getName();
```

### Deprecation
'org.apache.pinot.spi.utils.TimeConverter' is deprecated
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/function/TimeSpecFunctionEvaluator.java`
#### Snippet
```java
    _outgoingTimeColumn = outgoingGranularitySpec.getName();
    Preconditions.checkState(!_incomingTimeColumn.equals(_outgoingTimeColumn));
    _incomingTimeConverter = new TimeConverter(incomingGranularitySpec);
    _outgoingTimeConverter = new TimeConverter(outgoingGranularitySpec);
  }
```

### Deprecation
'org.apache.pinot.spi.utils.TimeConverter' is deprecated
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/function/TimeSpecFunctionEvaluator.java`
#### Snippet
```java
    Preconditions.checkState(!_incomingTimeColumn.equals(_outgoingTimeColumn));
    _incomingTimeConverter = new TimeConverter(incomingGranularitySpec);
    _outgoingTimeConverter = new TimeConverter(outgoingGranularitySpec);
  }

```

### Deprecation
'org.apache.pinot.spi.utils.TimeConverter' is deprecated
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/function/TimeSpecFunctionEvaluator.java`
#### Snippet
```java
  private final String _outgoingTimeColumn;
  private final TimeConverter _incomingTimeConverter;
  private final TimeConverter _outgoingTimeConverter;
  private boolean _isValidated = false;

```

### Deprecation
'getTransformFunction()' is deprecated
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/function/FunctionEvaluatorFactory.java`
#### Snippet
```java
/**
 * Factory class to create an {@link FunctionEvaluator} for the field spec based on the
 * {@link FieldSpec#getTransformFunction()}
 */
public class FunctionEvaluatorFactory {
```

### Deprecation
'getTransformFunction()' is deprecated
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/function/FunctionEvaluatorFactory.java`
#### Snippet
```java
    //  from schema in next
    //  release
    String transformExpression = fieldSpec.getTransformFunction();
    if (transformExpression != null && !transformExpression.isEmpty()) {

```

### Deprecation
'org.apache.pinot.spi.data.TimeFieldSpec' is deprecated
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/function/FunctionEvaluatorFactory.java`
#### Snippet
```java
      // Time conversions should be done using DateTimeFieldSpec and transformFunctions
      // But we need below lines for converting TimeFieldSpec's incoming to outgoing
      TimeFieldSpec timeFieldSpec = (TimeFieldSpec) fieldSpec;
      TimeGranularitySpec incomingGranularitySpec = timeFieldSpec.getIncomingGranularitySpec();
      TimeGranularitySpec outgoingGranularitySpec = timeFieldSpec.getOutgoingGranularitySpec();
```

### Deprecation
'org.apache.pinot.spi.data.TimeFieldSpec' is deprecated
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/function/FunctionEvaluatorFactory.java`
#### Snippet
```java
      // Time conversions should be done using DateTimeFieldSpec and transformFunctions
      // But we need below lines for converting TimeFieldSpec's incoming to outgoing
      TimeFieldSpec timeFieldSpec = (TimeFieldSpec) fieldSpec;
      TimeGranularitySpec incomingGranularitySpec = timeFieldSpec.getIncomingGranularitySpec();
      TimeGranularitySpec outgoingGranularitySpec = timeFieldSpec.getOutgoingGranularitySpec();
```

### Deprecation
'org.apache.pinot.spi.data.TimeGranularitySpec' is deprecated
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/function/FunctionEvaluatorFactory.java`
#### Snippet
```java
      // But we need below lines for converting TimeFieldSpec's incoming to outgoing
      TimeFieldSpec timeFieldSpec = (TimeFieldSpec) fieldSpec;
      TimeGranularitySpec incomingGranularitySpec = timeFieldSpec.getIncomingGranularitySpec();
      TimeGranularitySpec outgoingGranularitySpec = timeFieldSpec.getOutgoingGranularitySpec();
      if (!incomingGranularitySpec.equals(outgoingGranularitySpec)) {
```

### Deprecation
'org.apache.pinot.spi.data.TimeGranularitySpec' is deprecated
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/function/FunctionEvaluatorFactory.java`
#### Snippet
```java
      TimeFieldSpec timeFieldSpec = (TimeFieldSpec) fieldSpec;
      TimeGranularitySpec incomingGranularitySpec = timeFieldSpec.getIncomingGranularitySpec();
      TimeGranularitySpec outgoingGranularitySpec = timeFieldSpec.getOutgoingGranularitySpec();
      if (!incomingGranularitySpec.equals(outgoingGranularitySpec)) {
        if (!incomingGranularitySpec.getName().equals(outgoingGranularitySpec.getName())) {
```

### Deprecation
'addValueToTableGauge(java.lang.String, G, long)' is deprecated
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/realtime/converter/RealtimeSegmentConverter.java`
#### Snippet
```java
      for (String columnName : columnPartitionMap.keySet()) {
        int numPartitions = driver.getSegmentStats().getColumnProfileFor(columnName).getPartitions().size();
        serverMetrics.addValueToTableGauge(_tableName, ServerGauge.REALTIME_SEGMENT_NUM_PARTITIONS, numPartitions);
      }
    }
```

### Deprecation
'newInstance()' is deprecated
in `pinot-plugins/pinot-input-format/pinot-thrift/src/main/java/org/apache/pinot/plugin/inputformat/thrift/ThriftRecordReader.java`
#### Snippet
```java
    try {
      _thriftClass = this.getClass().getClassLoader().loadClass(recordReaderConfig.getThriftClass());
      tObject = (TBase) _thriftClass.newInstance();
    } catch (Exception e) {
      throw new RuntimeException(e);
```

### Deprecation
'newInstance()' is deprecated
in `pinot-plugins/pinot-input-format/pinot-thrift/src/main/java/org/apache/pinot/plugin/inputformat/thrift/ThriftRecordReader.java`
#### Snippet
```java
    TBase tObject;
    try {
      tObject = (TBase) _thriftClass.newInstance();
      tObject.read(_tProtocol);
    } catch (Exception e) {
```

## RuleId[id=TrivialStringConcatenation]
### TrivialStringConcatenation
Empty string used in concatenation
in `pinot-common/src/main/java/org/apache/pinot/common/function/TimeZoneKey.java`
#### Snippet
```java
    }

    return "" + signChar + hourTens + hourOnes + ":00";
  }

```

### TrivialStringConcatenation
Empty string used in concatenation
in `pinot-common/src/main/java/org/apache/pinot/common/metadata/instance/InstanceZKMetadata.java`
#### Snippet
```java

  private String buildIdFromInstanceConfig() {
    return StringUtil.join("_", _instanceType, _instanceName, _instancePort + "");
  }

```

### TrivialStringConcatenation
Empty string used in concatenation
in `pinot-common/src/main/java/org/apache/pinot/common/datatable/DataTableImplV3.java`
#### Snippet
```java
      }
      if (key.getValueType() == MetadataValueType.INT) {
        String value = "" + buffer.getInt();
        metadata.put(key.getName(), value);
      } else if (key.getValueType() == MetadataValueType.LONG) {
```

### TrivialStringConcatenation
Empty string used in concatenation
in `pinot-common/src/main/java/org/apache/pinot/common/datatable/DataTableImplV3.java`
#### Snippet
```java
        metadata.put(key.getName(), value);
      } else if (key.getValueType() == MetadataValueType.LONG) {
        String value = "" + buffer.getLong();
        metadata.put(key.getName(), value);
      } else {
```

### TrivialStringConcatenation
Empty string used in concatenation
in `pinot-common/src/main/java/org/apache/pinot/common/datatable/DataTableImplV4.java`
#### Snippet
```java
      }
      if (key.getValueType() == MetadataValueType.INT) {
        String value = "" + buffer.getInt();
        metadata.put(key.getName(), value);
      } else if (key.getValueType() == MetadataValueType.LONG) {
```

### TrivialStringConcatenation
Empty string used in concatenation
in `pinot-common/src/main/java/org/apache/pinot/common/datatable/DataTableImplV4.java`
#### Snippet
```java
        metadata.put(key.getName(), value);
      } else if (key.getValueType() == MetadataValueType.LONG) {
        String value = "" + buffer.getLong();
        metadata.put(key.getName(), value);
      } else {
```

### TrivialStringConcatenation
Empty string used in concatenation
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/PinotTableIdealStateBuilder.java`
#### Snippet
```java

  private static String getGroupIdFromRealtimeDataTable(String realtimeTableName, Map<String, String> streamConfigMap) {
    String groupId = StringUtil.join("_", realtimeTableName, System.currentTimeMillis() + "");
    StreamConfig streamConfig = new StreamConfig(realtimeTableName, streamConfigMap);
    String streamConfigGroupId = streamConfig.getGroupId();
```

### TrivialStringConcatenation
Empty string used in concatenation
in `pinot-tools/src/main/java/org/apache/pinot/tools/streams/RsvpSourceGenerator.java`
#### Snippet
```java

  public RSVP createMessage() {
    String eventId = Math.abs(ThreadLocalRandom.current().nextLong(100)) + "";
    ObjectNode json = JsonUtils.newObjectNode();
    ObjectNode eventJson = JsonUtils.newObjectNode();
```

## RuleId[id=NullableProblems]
### NullableProblems
Not annotated parameter overrides @NotNull parameter
in `pinot-spi/src/main/java/org/apache/pinot/spi/utils/ByteArray.java`
#### Snippet
```java

  @Override
  public int compareTo(ByteArray that) {
    if (this == that) {
      return 0;
```

### NullableProblems
The generated code will use '@org.jetbrains.annotations.NotNull' instead of '@javax.annotation.Nonnull'
in `pinot-spi/src/main/java/org/apache/pinot/spi/config/table/FieldConfig.java`
#### Snippet
```java

  public static class Builder {
    @Nonnull
    private String _name;
    private EncodingType _encodingType;
```

### NullableProblems
Primitive type members cannot be annotated
in `pinot-spi/src/main/java/org/apache/pinot/spi/config/table/ColumnStats.java`
#### Snippet
```java
  }

  @Nullable
  @JsonProperty(PRIMARY_KEY_SIZE)
  public int getPrimaryKeySize() {
```

### NullableProblems
Not annotated parameter overrides @NotNull parameter
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/LongMsgOffset.java`
#### Snippet
```java

  @Override
  public int compareTo(StreamPartitionMsgOffset other) {
    return Long.compare(_offset, ((LongMsgOffset) other)._offset);
  }
```

### NullableProblems
Not annotated parameter overrides @NotNull parameter
in `pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/JsonAsyncHttpPinotClientTransport.java`
#### Snippet
```java

    @Override
    public BrokerResponse get(long timeout, TimeUnit unit)
        throws ExecutionException {
      try {
```

### NullableProblems
Not annotated parameter overrides @NotNull parameter
in `pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/Connection.java`
#### Snippet
```java

    @Override
    public ResultSetGroup get(long timeout, TimeUnit unit)
        throws InterruptedException, ExecutionException, TimeoutException {
      BrokerResponse response = _responseFuture.get(timeout, unit);
```

### NullableProblems
Not annotated parameter overrides @NotNull parameter
in `pinot-common/src/main/java/org/apache/pinot/common/utils/NamedThreadFactory.java`
#### Snippet
```java
   * @see java.util.concurrent.ThreadFactory#newThread(java.lang.Runnable)
   */
  public Thread newThread(Runnable r) {
    final Thread t =
        new Thread(_group, r, String.format("%s-%d", _threadNamePrefix, _threadNumber.getAndIncrement()), 0);
```

### NullableProblems
Not annotated parameter overrides @NotNull parameter
in `pinot-common/src/main/java/org/apache/pinot/common/utils/LLCSegmentName.java`
#### Snippet
```java

  @Override
  public int compareTo(Object o) {
    LLCSegmentName other = (LLCSegmentName) o;
    if (!this.getTableName().equals(other.getTableName())) {
```

### NullableProblems
Not annotated parameter overrides @ParametersAreNonnullByDefault parameter
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/RealtimeConsumptionRateManager.java`
#### Snippet
```java
        .build(new CacheLoader<StreamConfig, Integer>() {
          @Override
          public Integer load(StreamConfig key)
              throws Exception {
            // this method is called the first time cache is used for the given streamConfig
```

### NullableProblems
Not annotated parameter overrides @ParametersAreNonnullByDefault parameter
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/RealtimeConsumptionRateManager.java`
#### Snippet
```java

          @Override
          public ListenableFuture<Integer> reload(StreamConfig key, Integer oldValue)
              throws Exception {
            // if partition count fetcher cannot fetch the value, old value is returned
```

### NullableProblems
Not annotated parameter overrides @ParametersAreNonnullByDefault parameter
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/RealtimeConsumptionRateManager.java`
#### Snippet
```java

          @Override
          public ListenableFuture<Integer> reload(StreamConfig key, Integer oldValue)
              throws Exception {
            // if partition count fetcher cannot fetch the value, old value is returned
```

### NullableProblems
Not annotated parameter overrides @NotNull parameter
in `pinot-core/src/main/java/org/apache/pinot/core/util/trace/TracedThreadFactory.java`
#### Snippet
```java

  @Override
  public Thread newThread(Runnable task) {
    Thread thread = new TracedThread(task);
    thread.setPriority(_priority);
```

### NullableProblems
Not annotated parameter overrides @NotNull parameter
in `pinot-core/src/main/java/org/apache/pinot/core/query/scheduler/fcfs/FCFSSchedulerGroup.java`
#### Snippet
```java
   */
  @Override
  public int compareTo(SchedulerGroupAccountant rhs) {
    return compare(this, ((SchedulerGroup) rhs));
  }
```

### NullableProblems
Not annotated parameter overrides @NotNull parameter
in `pinot-core/src/main/java/org/apache/pinot/core/query/scheduler/resources/UnboundedResourceManager.java`
#### Snippet
```java
    return new QueryExecutorService() {
      @Override
      public void execute(Runnable command) {
        _queryWorkers.submit(command);
      }
```

### NullableProblems
Not annotated parameter overrides @NotNull parameter
in `pinot-core/src/main/java/org/apache/pinot/core/query/scheduler/resources/QueryExecutorService.java`
#### Snippet
```java

  @Override
  public <T> Future<T> submit(Callable<T> task) {
    FutureTask futureTask = new FutureTask(task);
    execute(futureTask);
```

### NullableProblems
Not annotated parameter overrides @NotNull parameter
in `pinot-core/src/main/java/org/apache/pinot/core/query/scheduler/resources/QueryExecutorService.java`
#### Snippet
```java

  @Override
  public <T> T invokeAny(Collection<? extends Callable<T>> tasks, long timeout, TimeUnit unit)
      throws InterruptedException, ExecutionException, TimeoutException {
    throw new UnsupportedOperationException();
```

### NullableProblems
Not annotated parameter overrides @NotNull parameter
in `pinot-core/src/main/java/org/apache/pinot/core/query/scheduler/resources/QueryExecutorService.java`
#### Snippet
```java

  @Override
  public <T> T invokeAny(Collection<? extends Callable<T>> tasks, long timeout, TimeUnit unit)
      throws InterruptedException, ExecutionException, TimeoutException {
    throw new UnsupportedOperationException();
```

### NullableProblems
Not annotated parameter overrides @NotNull parameter
in `pinot-core/src/main/java/org/apache/pinot/core/query/scheduler/resources/QueryExecutorService.java`
#### Snippet
```java

  @Override
  public <T> List<Future<T>> invokeAll(Collection<? extends Callable<T>> tasks, long timeout, TimeUnit unit)
      throws InterruptedException {
    throw new UnsupportedOperationException();
```

### NullableProblems
Not annotated parameter overrides @NotNull parameter
in `pinot-core/src/main/java/org/apache/pinot/core/query/scheduler/resources/QueryExecutorService.java`
#### Snippet
```java

  @Override
  public <T> List<Future<T>> invokeAll(Collection<? extends Callable<T>> tasks, long timeout, TimeUnit unit)
      throws InterruptedException {
    throw new UnsupportedOperationException();
```

### NullableProblems
Not annotated parameter overrides @NotNull parameter
in `pinot-core/src/main/java/org/apache/pinot/core/query/scheduler/resources/QueryExecutorService.java`
#### Snippet
```java

  @Override
  public <T> T invokeAny(Collection<? extends Callable<T>> tasks)
      throws InterruptedException, ExecutionException {
    throw new UnsupportedOperationException();
```

### NullableProblems
Not annotated parameter overrides @NotNull parameter
in `pinot-core/src/main/java/org/apache/pinot/core/query/scheduler/resources/QueryExecutorService.java`
#### Snippet
```java

  @Override
  public <T> List<Future<T>> invokeAll(Collection<? extends Callable<T>> tasks)
      throws InterruptedException {
    throw new UnsupportedOperationException();
```

### NullableProblems
Not annotated parameter overrides @NotNull parameter
in `pinot-core/src/main/java/org/apache/pinot/core/query/scheduler/resources/QueryExecutorService.java`
#### Snippet
```java

  @Override
  public Future<?> submit(Runnable task) {
    return submit(Executors.callable(task));
  }
```

### NullableProblems
Not annotated parameter overrides @NotNull parameter
in `pinot-core/src/main/java/org/apache/pinot/core/query/scheduler/resources/QueryExecutorService.java`
#### Snippet
```java

  @Override
  public <T> Future<T> submit(Runnable task, T result) {
    return submit(Executors.callable(task, result));
  }
```

### NullableProblems
Not annotated parameter overrides @NotNull parameter
in `pinot-core/src/main/java/org/apache/pinot/core/query/scheduler/resources/QueryExecutorService.java`
#### Snippet
```java

  @Override
  public boolean awaitTermination(long timeout, TimeUnit unit)
      throws InterruptedException {
    throw new UnsupportedOperationException();
```

### NullableProblems
Not annotated parameter overrides @NotNull parameter
in `pinot-core/src/main/java/org/apache/pinot/core/query/scheduler/tokenbucket/TokenSchedulerGroup.java`
#### Snippet
```java
   */
  @Override
  public int compareTo(SchedulerGroupAccountant rhs) {
    if (rhs == null) {
      return 1;
```

### NullableProblems
Not annotated parameter overrides @NotNull parameter
in `pinot-core/src/main/java/org/apache/pinot/core/query/scheduler/resources/BoundedAccountingExecutor.java`
#### Snippet
```java

  @Override
  public void execute(Runnable command) {
    _delegateExecutor.execute(toAccountingRunnable(command));
  }
```

### NullableProblems
Not annotated parameter overrides @ParametersAreNonnullByDefault parameter
in `pinot-core/src/main/java/org/apache/pinot/core/transport/InstanceRequestHandler.java`
#### Snippet
```java

      @Override
      public void onFailure(Throwable t) {
        if (_queryFuturesById != null) {
          String queryId = queryRequest.getQueryId();
```

### NullableProblems
Not annotated parameter overrides @NotNull parameter
in `pinot-plugins/pinot-stream-ingestion/pinot-kinesis/src/main/java/org/apache/pinot/plugin/stream/kinesis/KinesisPartitionGroupOffset.java`
#### Snippet
```java

  @Override
  public int compareTo(StreamPartitionMsgOffset o) {
    Preconditions.checkNotNull(o);
    KinesisPartitionGroupOffset other = (KinesisPartitionGroupOffset) o;
```

### NullableProblems
Not annotated parameter overrides @NotNull parameter
in `pinot-plugins/pinot-stream-ingestion/pinot-pulsar/src/main/java/org/apache/pinot/plugin/stream/pulsar/MessageIdStreamOffset.java`
#### Snippet
```java

  @Override
  public int compareTo(StreamPartitionMsgOffset other) {
    MessageIdStreamOffset messageIdStreamOffset = (MessageIdStreamOffset) other;
    return _messageId.compareTo(messageIdStreamOffset.getMessageId());
```

### NullableProblems
Not annotated parameter overrides @NotNull parameter
in `pinot-clients/pinot-jdbc-client/src/main/java/org/apache/pinot/client/controller/response/ControllerResponseFuture.java`
#### Snippet
```java
  }

  abstract public T get(long timeout, TimeUnit unit)
      throws ExecutionException;

```

### NullableProblems
Not annotated parameter overrides @NotNull parameter
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/SegmentDeletionManager.java`
#### Snippet
```java
    _executorService = Executors.newSingleThreadScheduledExecutor(new ThreadFactory() {
      @Override
      public Thread newThread(Runnable runnable) {
        Thread thread = new Thread(runnable);
        thread.setName("PinotHelixResourceManagerExecutorService");
```

### NullableProblems
Not annotated parameter overrides @ParametersAreNonnullByDefault parameter
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/PinotHelixResourceManager.java`
#### Snippet
```java
            .build(new CacheLoader<String, String>() {
              @Override
              public String load(String instanceId) {
                InstanceConfig instanceConfig = getHelixInstanceConfig(instanceId);
                Preconditions.checkNotNull(instanceConfig, "Failed to find instance config for: %s", instanceId);
```

### NullableProblems
Not annotated parameter overrides @ParametersAreNonnullByDefault parameter
in `pinot-server/src/main/java/org/apache/pinot/server/starter/helix/HelixInstanceDataManager.java`
#### Snippet
```java
        .build(new CacheLoader<Pair<String, String>, SegmentErrorInfo>() {
          @Override
          public SegmentErrorInfo load(Pair<String, String> tableNameWithTypeSegmentNamePair) {
            // This cache is populated only via the put api.
            return null;
```

### NullableProblems
The generated code will use '@org.jetbrains.annotations.Nullable' instead of '@javax.annotation.Nullable'
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/index/ForwardIndexConfig.java`
#### Snippet
```java
  public static final ForwardIndexConfig DEFAULT = new Builder().build();

  @Nullable
  private final ChunkCompressionType _chunkCompressionType;
  private final boolean _deriveNumDocsPerChunk;
```

### NullableProblems
The generated code will use '@org.jetbrains.annotations.Nullable' instead of '@javax.annotation.Nullable'
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/index/ForwardIndexConfig.java`
#### Snippet
```java

  public static class Builder {
    @Nullable
    private ChunkCompressionType _chunkCompressionType;
    private boolean _deriveNumDocsPerChunk = false;
```

### NullableProblems
The generated code will use '@org.jetbrains.annotations.Nullable' instead of '@javax.annotation.Nullable'
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/index/TextIndexConfig.java`
#### Snippet
```java
      Collections.emptyList(), Collections.emptyList());
  private final FSTType _fstType;
  @Nullable
  private final Object _rawValueForTextIndex;
  private final boolean _enableQueryCache;
```

### NullableProblems
The generated code will use '@org.jetbrains.annotations.Nullable' instead of '@javax.annotation.Nullable'
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/index/TextIndexConfig.java`
#### Snippet
```java
    @Nullable
    private final FSTType _fstType;
    @Nullable
    protected Object _rawValueForTextIndex;
    protected boolean _enableQueryCache = false;
```

### NullableProblems
The generated code will use '@org.jetbrains.annotations.Nullable' instead of '@javax.annotation.Nullable'
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/index/TextIndexConfig.java`
#### Snippet
```java

  public static abstract class AbstractBuilder {
    @Nullable
    private final FSTType _fstType;
    @Nullable
```

### NullableProblems
Not annotated parameter overrides @NotNull parameter
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/index/startree/AggregationFunctionColumnPair.java`
#### Snippet
```java

  @Override
  public int compareTo(AggregationFunctionColumnPair other) {
    return Comparator.comparing((AggregationFunctionColumnPair o) -> o._column)
        .thenComparing((AggregationFunctionColumnPair o) -> o._functionType)
```

### NullableProblems
Not annotated parameter overrides @NotNull parameter
in `pinot-broker/src/main/java/org/apache/pinot/broker/routing/segmentpruner/interval/IntervalTree.java`
#### Snippet
```java

    @Override
    public int compareTo(Node o) {
      Preconditions.checkNotNull(o, "Compare to invalid node: null");
      return _interval.compareTo(o._interval);
```

### NullableProblems
The generated code will use '@org.jetbrains.annotations.Nullable' instead of '@javax.annotation.Nullable'
in `pinot-broker/src/main/java/org/apache/pinot/broker/querylog/QueryLogger.java`
#### Snippet
```java
    final BrokerResponse _response;
    final long _timeUsedMs;
    @Nullable
    final RequesterIdentity _requester;

```

### NullableProblems
Not annotated parameter overrides @NotNull parameter
in `pinot-broker/src/main/java/org/apache/pinot/broker/failuredetector/BaseExponentialBackoffRetryFailureDetector.java`
#### Snippet
```java

    @Override
    public int compareTo(Delayed o) {
      RetryInfo that = (RetryInfo) o;
      return Long.compare(_retryTimeNs, that._retryTimeNs);
```

### NullableProblems
Not annotated method overrides method annotated with @NotNull
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/FST.java`
#### Snippet
```java
   * </p>
   */
  public final Iterator<ByteBuffer> iterator() {
    return getSequences().iterator();
  }
```

### NullableProblems
The generated code will use '@org.jetbrains.annotations.Nullable' instead of '@javax.annotation.Nullable'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/loader/BaseIndexHandler.java`
#### Snippet
```java
  protected final SegmentDirectory _segmentDirectory;
  protected final Map<String, FieldIndexConfigs> _fieldIndexConfigs;
  @Nullable
  protected final TableConfig _tableConfig;

```

### NullableProblems
The generated code will use '@org.jetbrains.annotations.Nullable' instead of '@javax.annotation.Nullable'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/loader/IndexLoadingConfig.java`
#### Snippet
```java
  private Map<String, Map<String, String>> _columnProperties = new HashMap<>();

  @Nullable
  private TableConfig _tableConfig;
  private Schema _schema;
```

### NullableProblems
Not annotated parameter overrides @NotNull parameter
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/startree/v2/store/StarTreeIndexMapUtils.java`
#### Snippet
```java

    @Override
    public int compareTo(IndexKey other) {
      return Comparator
          .comparing((IndexKey i) -> i._column, Comparator.nullsLast(Comparator.naturalOrder()))
```

### NullableProblems
Not annotated parameter overrides @NotNull parameter
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/customobject/VarianceTuple.java`
#### Snippet
```java

  @Override
  public int compareTo(VarianceTuple varianceTuple) {
    if (_count == 0) {
      if (varianceTuple._count == 0) {
```

### NullableProblems
Not annotated parameter overrides @NotNull parameter
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/customobject/PinotFourthMoment.java`
#### Snippet
```java

  @Override
  public int compareTo(PinotFourthMoment o) {
    return COMPARATOR.compare(this, o);
  }
```

## RuleId[id=EqualsBetweenInconvertibleTypes]
### EqualsBetweenInconvertibleTypes
`equals` between objects of inconvertible types 'String' and 'Status'
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotTableRestletResource.java`
#### Snippet
```java
            TableRebalanceProgressStats.class);
    long timeSinceStartInSecs = 0L;
    if (!tableRebalanceProgressStats.getStatus().equals(RebalanceResult.Status.DONE)) {
      timeSinceStartInSecs =
          (System.currentTimeMillis() - tableRebalanceProgressStats.getStartTimeMs()) / 1000;
```

## RuleId[id=DuplicateCondition]
### DuplicateCondition
Duplicate condition `zoneId.equals("ut")`
in `pinot-common/src/main/java/org/apache/pinot/common/function/TimeZoneKey.java`
#### Snippet
```java

  private static boolean isUtcEquivalentName(String zoneId) {
    return zoneId.equals("utc") || zoneId.equals("z") || zoneId.equals("ut") || zoneId.equals("uct") || zoneId
        .equals("ut") || zoneId.equals("gmt") || zoneId.equals("gmt0") || zoneId.equals("greenwich") || zoneId
        .equals("universal") || zoneId.equals("zulu");
```

### DuplicateCondition
Duplicate condition `zoneId .equals("ut")`
in `pinot-common/src/main/java/org/apache/pinot/common/function/TimeZoneKey.java`
#### Snippet
```java

  private static boolean isUtcEquivalentName(String zoneId) {
    return zoneId.equals("utc") || zoneId.equals("z") || zoneId.equals("ut") || zoneId.equals("uct") || zoneId
        .equals("ut") || zoneId.equals("gmt") || zoneId.equals("gmt0") || zoneId.equals("greenwich") || zoneId
        .equals("universal") || zoneId.equals("zulu");
  }
```

## RuleId[id=IgnoreResultOfCall]
### IgnoreResultOfCall
Result of `File.mkdirs()` is ignored
in `pinot-plugins/pinot-stream-ingestion/pinot-kafka-2.0/src/main/java/org/apache/pinot/plugin/stream/kafka20/server/KafkaDataServerStartable.java`
#### Snippet
```java

    File logDir = new File(_logDirPath);
    logDir.mkdirs();

    props.put("zookeeper.session.timeout.ms", "60000");
```

### IgnoreResultOfCall
Result of `File.mkdirs()` is ignored
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/HLRealtimeSegmentDataManager.java`
#### Snippet
```java
    _resourceTmpDir = new File(resourceDataDir, RESOURCE_TEMP_DIR_NAME);
    if (!_resourceTmpDir.exists()) {
      _resourceTmpDir.mkdirs();
    }
    // create and init stream level consumer
```

### IgnoreResultOfCall
Result of `File.mkdirs()` is ignored
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/LLRealtimeSegmentDataManager.java`
#### Snippet
```java
      _resourceTmpDir = new File(resourceDataDir, RESOURCE_TEMP_DIR_NAME);
      if (!_resourceTmpDir.exists()) {
        _resourceTmpDir.mkdirs();
      }
      _state = State.INITIAL_CONSUMING;
```

### IgnoreResultOfCall
Result of `Condition.await()` is ignored
in `pinot-core/src/main/java/org/apache/pinot/core/query/scheduler/MultiLevelPriorityQueue.java`
#### Snippet
```java
        while ((schedulerQueryContext = takeNextInternal()) == null) {
          try {
            _queryReaderCondition.await(_wakeUpTimeMicros, TimeUnit.MICROSECONDS);
          } catch (InterruptedException e) {
            return null;
```

### IgnoreResultOfCall
Result of `BlockingQueue.offer()` is ignored
in `pinot-core/src/main/java/org/apache/pinot/core/operator/combine/BaseSingleBlockCombineOperator.java`
#### Snippet
```java
        }
      }
      _blockingQueue.offer(resultsBlock);
      // When query is satisfied, skip processing the remaining segments
      if (_resultsBlockMerger.isQuerySatisfied(resultsBlock)) {
```

### IgnoreResultOfCall
Result of `BlockingQueue.offer()` is ignored
in `pinot-core/src/main/java/org/apache/pinot/core/operator/combine/BaseSingleBlockCombineOperator.java`
#### Snippet
```java
  @Override
  protected void onProcessSegmentsException(Throwable t) {
    _blockingQueue.offer(new ExceptionResultsBlock(t));
  }

```

### IgnoreResultOfCall
Result of `BlockingQueue.offer()` is ignored
in `pinot-core/src/main/java/org/apache/pinot/core/operator/combine/MinMaxValueBasedSelectionOrderByCombineOperator.java`
#### Snippet
```java
    while ((operatorId = _nextOperatorId.getAndIncrement()) < _numOperators) {
      if (operatorId >= _endOperatorId.get()) {
        _blockingQueue.offer(EMPTY_RESULTS_BLOCK);
        continue;
      }
```

### IgnoreResultOfCall
Result of `BlockingQueue.offer()` is ignored
in `pinot-core/src/main/java/org/apache/pinot/core/operator/combine/MinMaxValueBasedSelectionOrderByCombineOperator.java`
#### Snippet
```java
            if (result > 0 || (result == 0 && numOrderByExpressions == 1)) {
              _endOperatorId.set(operatorId);
              _blockingQueue.offer(EMPTY_RESULTS_BLOCK);
              continue;
            }
```

### IgnoreResultOfCall
Result of `BlockingQueue.offer()` is ignored
in `pinot-core/src/main/java/org/apache/pinot/core/operator/combine/MinMaxValueBasedSelectionOrderByCombineOperator.java`
#### Snippet
```java
            if (result < 0 || (result == 0 && numOrderByExpressions == 1)) {
              _endOperatorId.set(operatorId);
              _blockingQueue.offer(EMPTY_RESULTS_BLOCK);
              continue;
            }
```

### IgnoreResultOfCall
Result of `BlockingQueue.offer()` is ignored
in `pinot-core/src/main/java/org/apache/pinot/core/operator/combine/MinMaxValueBasedSelectionOrderByCombineOperator.java`
#### Snippet
```java
      }
      threadBoundaryValue = boundaryValue;
      _blockingQueue.offer(resultsBlock);
    }
  }
```

### IgnoreResultOfCall
Result of `BlockingQueue.offer()` is ignored
in `pinot-core/src/main/java/org/apache/pinot/core/operator/streaming/BaseStreamingCombineOperator.java`
#### Snippet
```java
        if (isChildOperatorSingleBlock()) {
          T resultsBlock = operator.nextBlock();
          _blockingQueue.offer(resultsBlock);
          // When query is satisfied, skip processing the remaining segments
          if (isQuerySatisfied(resultsBlock, tracker)) {
```

### IgnoreResultOfCall
Result of `BlockingQueue.offer()` is ignored
in `pinot-core/src/main/java/org/apache/pinot/core/operator/streaming/BaseStreamingCombineOperator.java`
#### Snippet
```java
          T resultsBlock;
          while ((resultsBlock = operator.nextBlock()) != null) {
            _blockingQueue.offer(resultsBlock);
            // When query is satisfied, skip processing the remaining segments
            if (isQuerySatisfied(resultsBlock, tracker)) {
```

### IgnoreResultOfCall
Result of `BlockingQueue.offer()` is ignored
in `pinot-core/src/main/java/org/apache/pinot/core/operator/streaming/BaseStreamingCombineOperator.java`
#### Snippet
```java
      }
      // offer the LAST_RESULTS_BLOCK indicate finish of the current operator.
      _blockingQueue.offer(LAST_RESULTS_BLOCK);
    }
  }
```

### IgnoreResultOfCall
Result of `BlockingQueue.offer()` is ignored
in `pinot-core/src/main/java/org/apache/pinot/core/operator/streaming/BaseStreamingCombineOperator.java`
#### Snippet
```java
  @Override
  protected void onProcessSegmentsException(Throwable t) {
    _blockingQueue.offer(new ExceptionResultsBlock(t));
  }

```

### IgnoreResultOfCall
Result of `Condition.await()` is ignored
in `pinot-minion/src/main/java/org/apache/pinot/minion/event/MinionEventObservers.java`
#### Snippet
```java
              _endedTaskQueue.poll();
            } else {
              _availableToClean.await(task._endTs + _eventObserverCleanupDelayMs - nowMs, TimeUnit.MILLISECONDS);
            }
          }
```

### IgnoreResultOfCall
Result of `ExecutorService.awaitTermination()` is ignored
in `pinot-controller/src/main/java/org/apache/pinot/controller/BaseControllerStarter.java`
#### Snippet
```java
      LOGGER.info("Shutting down executor service");
      _executorService.shutdownNow();
      _executorService.awaitTermination(10L, TimeUnit.SECONDS);
    } catch (final Exception e) {
      LOGGER.error("Caught exception while shutting down", e);
```

### IgnoreResultOfCall
Result of `BlockingQueue.offer()` is ignored
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/relocation/SegmentRelocator.java`
#### Snippet
```java
  void putTableToWait(String tableNameWithType) {
    if (_waitingTables.add(tableNameWithType)) {
      _waitingQueue.offer(tableNameWithType);
      LOGGER.debug("Table: {} is added in waiting queue, total waiting: {}", tableNameWithType, _waitingTables.size());
      return;
```

### IgnoreResultOfCall
Result of `File.mkdir()` is ignored
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/data/generator/DataGenerator.java`
#### Snippet
```java
    }

    _outDir.mkdir();

    for (final String column : _genSpec.getColumns()) {
```

### IgnoreResultOfCall
Result of `File.mkdir()` is ignored
in `pinot-server/src/main/java/org/apache/pinot/server/api/resources/TablesResource.java`
#### Snippet
```java
      File segmentTarUploadDir =
          new File(_serverInstance.getInstanceDataManager().getSegmentFileDirectory(), SEGMENT_UPLOAD_DIR);
      segmentTarUploadDir.mkdir();

      segmentTarFile = new File(segmentTarUploadDir, tableNameWithType + "_" + segmentName + "_" + UUID.randomUUID()
```

### IgnoreResultOfCall
Result of `File.mkdir()` is ignored
in `pinot-server/src/main/java/org/apache/pinot/server/api/resources/TablesResource.java`
#### Snippet
```java
      File tmpSegmentTarDir =
          new File(_serverInstance.getInstanceDataManager().getSegmentFileDirectory(), PEER_SEGMENT_DOWNLOAD_DIR);
      tmpSegmentTarDir.mkdir();

      File segmentTarFile = new File(tmpSegmentTarDir, tableNameWithType + "_" + segmentName + "_" + UUID.randomUUID()
```

### IgnoreResultOfCall
Result of `File.mkdirs()` is ignored
in `pinot-tools/src/main/java/org/apache/pinot/tools/QuickStartBase.java`
#### Snippet
```java
      File baseDir = new File(quickstartTmpDir, tableName);
      File dataDir = new File(baseDir, "rawdata");
      dataDir.mkdirs();
      if (useDefaultBootstrapTableDir()) {
        copyResourceTableToTmpDirectory(directory, tableName, baseDir, dataDir, true);
```

### IgnoreResultOfCall
Result of `File.mkdirs()` is ignored
in `pinot-tools/src/main/java/org/apache/pinot/tools/BootstrapTableTool.java`
#### Snippet
```java
      throws Exception {
    File setupTableTmpDir = new File(FileUtils.getTempDirectory(), String.valueOf(System.currentTimeMillis()));
    setupTableTmpDir.mkdirs();

    File tableDir = new File(_tableDir);
```

### IgnoreResultOfCall
Result of `ExecutorService.awaitTermination()` is ignored
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/PerfBenchmarkRunner.java`
#### Snippet
```java
      }
      executorService.shutdown();
      executorService.awaitTermination(_timeoutInSeconds, TimeUnit.SECONDS);
    } else {
      List<String> invertedIndexColumns = null;
```

### IgnoreResultOfCall
Result of `File.delete()` is ignored
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StopProcessCommand.java`
#### Snippet
```java
    reader.close();

    file.delete();
    return true;
  }
```

### IgnoreResultOfCall
Result of `File.mkdirs()` is ignored
in `pinot-tools/src/main/java/org/apache/pinot/tools/utils/JarUtils.java`
#### Snippet
```java
        File parent = dest.getParentFile();
        if (parent != null) {
          parent.mkdirs();
        }

```

### IgnoreResultOfCall
Result of `File.mkdir()` is ignored
in `pinot-tools/src/main/java/org/apache/pinot/tools/segment/converter/DictionaryToRawIndexConverter.java`
#### Snippet
```java
        FileUtils.deleteQuietly(outputDir);
        outputDir = new File(_outputDir);
        outputDir.mkdir();
      } else {
        LOGGER.error("Output directory '{}' already exists, use -overwrite to overwrite", outputDir);
```

### IgnoreResultOfCall
Result of `ExecutorService.awaitTermination()` is ignored
in `pinot-tools/src/main/java/org/apache/pinot/tools/segment/converter/DictionaryToRawIndexConverter.java`
#### Snippet
```java

    executorService.shutdown();
    executorService.awaitTermination(1, TimeUnit.HOURS);
    return ret;
  }
```

### IgnoreResultOfCall
Result of `File.mkdir()` is ignored
in `pinot-tools/src/main/java/org/apache/pinot/tools/filesystem/PinotFSBenchmarkDriver.java`
#### Snippet
```java
      File tmpDirectory = new File(_localTempDir.getPath(), directoryPath);
      URI directoryUri = combinePath(listTestUri, directoryPath);
      tmpDirectory.mkdir();

      for (int j = 0; j < numSegments; j++) {
```

### IgnoreResultOfCall
Result of `File.createNewFile()` is ignored
in `pinot-tools/src/main/java/org/apache/pinot/tools/filesystem/PinotFSBenchmarkDriver.java`
#### Snippet
```java
        String relativePath = "segment_" + j;
        File tmpFile = new File(tmpDirectory, relativePath);
        tmpFile.createNewFile();
        _pinotFS.copyFromLocalFile(tmpFile, combinePath(directoryUri, relativePath));
      }
```

### IgnoreResultOfCall
Result of `File.delete()` is ignored
in `pinot-tools/src/main/java/org/apache/pinot/tools/filesystem/PinotFSBenchmarkDriver.java`
#### Snippet
```java

    if (_localTempDir.exists()) {
      _localTempDir.delete();
    }

```

### IgnoreResultOfCall
Result of `File.mkdir()` is ignored
in `pinot-tools/src/main/java/org/apache/pinot/tools/filesystem/PinotFSBenchmarkDriver.java`
#### Snippet
```java
    // Set up the base directory
    _pinotFS.mkdir(_baseDirectoryUri);
    _localTempDir.mkdir();
  }

```

### IgnoreResultOfCall
Result of `File.createNewFile()` is ignored
in `pinot-tools/src/main/java/org/apache/pinot/tools/filesystem/PinotFSBenchmarkDriver.java`
#### Snippet
```java
      String relativePath = "segment_" + i;
      File tmpFile = new File(_localTempDir.getPath(), relativePath);
      tmpFile.createNewFile();
      _pinotFS.copyFromLocalFile(tmpFile, combinePath(listTestUri, relativePath));
    }
```

### IgnoreResultOfCall
Result of `File.createNewFile()` is ignored
in `pinot-tools/src/main/java/org/apache/pinot/tools/filesystem/PinotFSBenchmarkDriver.java`
#### Snippet
```java
      throws IOException {
    File tmpLargeFile = new File(_localTempDir, fileName);
    tmpLargeFile.createNewFile();
    RandomAccessFile raf = new RandomAccessFile(tmpLargeFile, "rw");
    raf.setLength(sizeInBytes);
```

### IgnoreResultOfCall
Result of `BlockingQueue.offer()` is ignored
in `pinot-query-runtime/src/main/java/org/apache/pinot/query/runtime/executor/RoundRobinScheduler.java`
#### Snippet
```java
          if (_available.containsKey(opChainId)) {
            _available.remove(opChainId);
            _ready.offer(_aliveChains.get(opChainId));
          }
        } finally {
```

### IgnoreResultOfCall
Result of `BlockingQueue.offer()` is ignored
in `pinot-query-runtime/src/main/java/org/apache/pinot/query/runtime/executor/RoundRobinScheduler.java`
#### Snippet
```java
    try {
      _aliveChains.put(operatorChain.getId(), operatorChain);
      _ready.offer(operatorChain);
    } finally {
      _lock.unlock();
```

### IgnoreResultOfCall
Result of `BlockingQueue.offer()` is ignored
in `pinot-query-runtime/src/main/java/org/apache/pinot/query/runtime/executor/RoundRobinScheduler.java`
#### Snippet
```java
      if (_available.containsKey(opChainId)) {
        _available.remove(opChainId);
        _ready.offer(_aliveChains.get(opChainId));
      } else {
        // There are two cases here:
```

### IgnoreResultOfCall
Result of `BlockingQueue.offer()` is ignored
in `pinot-query-runtime/src/main/java/org/apache/pinot/query/service/dispatch/QueryDispatcher.java`
#### Snippet
```java
                  .putMetadata(QueryConfig.KEY_OF_BROKER_REQUEST_TIMEOUT_MS, String.valueOf(timeoutMs))
                  .putAllMetadata(queryOptions).build(), stageId, queryServerInstance, deadline,
                  dispatchCallbacks::offer);
            });
          }
```

### IgnoreResultOfCall
Result of `FileChannel.write()` is ignored
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/writer/impl/BaseChunkSVForwardIndexWriter.java`
#### Snippet
```java
    // Write the header and close the file.
    _header.flip();
    _dataFile.write(_header, 0);
    _dataFile.close();
  }
```

### IgnoreResultOfCall
Result of `File.renameTo()` is ignored
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/converter/SegmentV1V2ToV3FormatConverter.java`
#### Snippet
```java
    File newLocation = SegmentDirectoryPaths.segmentDirectoryFor(v2SegmentDirectory, SegmentVersion.v3);
    LOGGER.info("v3 segment location for segment: {} is {}", v2Metadata.getName(), newLocation);
    v3TempDirectory.renameTo(newLocation);
    deleteV2Files(v2SegmentDirectory);
  }
```

### IgnoreResultOfCall
Result of `File.mkdir()` is ignored
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/converter/SegmentV1V2ToV3FormatConverter.java`
#### Snippet
```java
      File[] indexFiles = textIndexFile.listFiles();
      File v3LuceneIndexDir = new File(v3Dir, textIndexFile.getName());
      v3LuceneIndexDir.mkdir();
      for (File indexFile : indexFiles) {
        File v3LuceneIndexFile = new File(v3LuceneIndexDir, indexFile.getName());
```

### IgnoreResultOfCall
Result of `File.createNewFile()` is ignored
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/store/SingleFileIndexDirectory.java`
#### Snippet
```java
    _indexFile = new File(segmentDirectory, V1Constants.INDEX_FILE_NAME);
    if (!_indexFile.exists()) {
      _indexFile.createNewFile();
    }
    _columnEntries = new TreeMap<>();
```

### IgnoreResultOfCall
Result of `File.mkdirs()` is ignored
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/creator/impl/SegmentIndexCreationDriverImpl.java`
#### Snippet
```java
    final File indexDir = new File(config.getOutDir());
    if (!indexDir.exists()) {
      indexDir.mkdirs();
    }

```

### IgnoreResultOfCall
Result of `FileChannel.write()` is ignored
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/creator/impl/inv/json/BaseJsonIndexCreator.java`
#### Snippet
```java
        FileChannel dictionaryFileChannel = new RandomAccessFile(_dictionaryFile, "r").getChannel();
        FileChannel invertedIndexFileChannel = new RandomAccessFile(_invertedIndexFile, "r").getChannel()) {
      indexFileChannel.write(headerBuffer);
      dictionaryFileChannel.transferTo(0, dictionaryFileLength, indexFileChannel);
      invertedIndexFileChannel.transferTo(0, invertedIndexFileLength, indexFileChannel);
```

### IgnoreResultOfCall
Result of `FileChannel.write()` is ignored
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/creator/impl/inv/geospatial/BaseH3IndexCreator.java`
#### Snippet
```java
        FileChannel bitmapOffsetFileChannel = new RandomAccessFile(_bitmapOffsetFile, "r").getChannel();
        FileChannel bitmapValueFileChannel = new RandomAccessFile(_bitmapValueFile, "r").getChannel()) {
      indexFileChannel.write(headerBuffer);
      dictionaryFileChannel.transferTo(0, _dictionaryFile.length(), indexFileChannel);
      bitmapOffsetFileChannel.transferTo(0, _bitmapOffsetFile.length(), indexFileChannel);
```

### IgnoreResultOfCall
Result of `FileChannel.write()` is ignored
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/creator/impl/text/NativeTextIndexCreator.java`
#### Snippet
```java
        FileChannel invertedIndexFileChannel = new RandomAccessFile(_invertedIndexFile, "r").getChannel();
        FileChannel fstFileChannel = new RandomAccessFile(_fstIndexFile, "rw").getChannel()) {
      indexFileChannel.write(headerBuffer);
      fstFileChannel.transferTo(0, _fstDataSize, indexFileChannel);
      invertedIndexFileChannel.transferTo(0, invertedIndexFileLength, indexFileChannel);
```

## RuleId[id=AccessStaticViaInstance]
### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryStringCompression.BenchmarkNoDictionaryStringCompressionState._factory' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryStringCompression.java`
#### Snippet
```java
      BenchmarkNoDictionaryStringCompression.BenchmarkNoDictionaryStringCompressionState state)
      throws IOException {
    state._factory.highCompressor().compress(state._uncompressedString, state._lz4CompressedStringOutput);
    return state._lz4CompressedStringOutput.position();
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryStringCompression.BenchmarkNoDictionaryStringCompressionState._uncompressedString' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryStringCompression.java`
#### Snippet
```java
      BenchmarkNoDictionaryStringCompression.BenchmarkNoDictionaryStringCompressionState state)
      throws IOException {
    state._factory.highCompressor().compress(state._uncompressedString, state._lz4CompressedStringOutput);
    return state._lz4CompressedStringOutput.position();
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryStringCompression.BenchmarkNoDictionaryStringCompressionState._lz4CompressedStringOutput' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryStringCompression.java`
#### Snippet
```java
      BenchmarkNoDictionaryStringCompression.BenchmarkNoDictionaryStringCompressionState state)
      throws IOException {
    state._factory.highCompressor().compress(state._uncompressedString, state._lz4CompressedStringOutput);
    return state._lz4CompressedStringOutput.position();
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryStringCompression.BenchmarkNoDictionaryStringCompressionState._lz4CompressedStringOutput' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryStringCompression.java`
#### Snippet
```java
      throws IOException {
    state._factory.highCompressor().compress(state._uncompressedString, state._lz4CompressedStringOutput);
    return state._lz4CompressedStringOutput.position();
  }

```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryStringCompression.BenchmarkNoDictionaryStringCompressionState._factory' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryStringCompression.java`
#### Snippet
```java
      BenchmarkNoDictionaryStringCompression.BenchmarkNoDictionaryStringCompressionState state)
      throws IOException {
    state._factory.fastDecompressor().decompress(state._lz4CompressedStringInput, state._lz4StringDecompressed);
    return state._lz4StringDecompressed.position();
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryStringCompression.BenchmarkNoDictionaryStringCompressionState._lz4CompressedStringInput' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryStringCompression.java`
#### Snippet
```java
      BenchmarkNoDictionaryStringCompression.BenchmarkNoDictionaryStringCompressionState state)
      throws IOException {
    state._factory.fastDecompressor().decompress(state._lz4CompressedStringInput, state._lz4StringDecompressed);
    return state._lz4StringDecompressed.position();
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryStringCompression.BenchmarkNoDictionaryStringCompressionState._lz4StringDecompressed' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryStringCompression.java`
#### Snippet
```java
      BenchmarkNoDictionaryStringCompression.BenchmarkNoDictionaryStringCompressionState state)
      throws IOException {
    state._factory.fastDecompressor().decompress(state._lz4CompressedStringInput, state._lz4StringDecompressed);
    return state._lz4StringDecompressed.position();
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryStringCompression.BenchmarkNoDictionaryStringCompressionState._lz4StringDecompressed' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryStringCompression.java`
#### Snippet
```java
      throws IOException {
    state._factory.fastDecompressor().decompress(state._lz4CompressedStringInput, state._lz4StringDecompressed);
    return state._lz4StringDecompressed.position();
  }

```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryStringCompression.BenchmarkNoDictionaryStringCompressionState._snappyCompressedStringInput' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryStringCompression.java`
#### Snippet
```java
  public int benchmarkSnappyStringDecompression(BenchmarkNoDictionaryStringCompressionState state)
      throws IOException {
    int size = Snappy.uncompress(state._snappyCompressedStringInput, state._snappyStringDecompressed);
    return size;
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryStringCompression.BenchmarkNoDictionaryStringCompressionState._snappyStringDecompressed' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryStringCompression.java`
#### Snippet
```java
  public int benchmarkSnappyStringDecompression(BenchmarkNoDictionaryStringCompressionState state)
      throws IOException {
    int size = Snappy.uncompress(state._snappyCompressedStringInput, state._snappyStringDecompressed);
    return size;
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryStringCompression.BenchmarkNoDictionaryStringCompressionState._factory' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryStringCompression.java`
#### Snippet
```java
      BenchmarkNoDictionaryStringCompression.BenchmarkNoDictionaryStringCompressionState state)
      throws IOException {
    state._factory.fastCompressor().compress(state._uncompressedString, state._lz4CompressedStringOutput);
    return state._lz4CompressedStringOutput.position();
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryStringCompression.BenchmarkNoDictionaryStringCompressionState._uncompressedString' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryStringCompression.java`
#### Snippet
```java
      BenchmarkNoDictionaryStringCompression.BenchmarkNoDictionaryStringCompressionState state)
      throws IOException {
    state._factory.fastCompressor().compress(state._uncompressedString, state._lz4CompressedStringOutput);
    return state._lz4CompressedStringOutput.position();
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryStringCompression.BenchmarkNoDictionaryStringCompressionState._lz4CompressedStringOutput' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryStringCompression.java`
#### Snippet
```java
      BenchmarkNoDictionaryStringCompression.BenchmarkNoDictionaryStringCompressionState state)
      throws IOException {
    state._factory.fastCompressor().compress(state._uncompressedString, state._lz4CompressedStringOutput);
    return state._lz4CompressedStringOutput.position();
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryStringCompression.BenchmarkNoDictionaryStringCompressionState._lz4CompressedStringOutput' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryStringCompression.java`
#### Snippet
```java
      throws IOException {
    state._factory.fastCompressor().compress(state._uncompressedString, state._lz4CompressedStringOutput);
    return state._lz4CompressedStringOutput.position();
  }

```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryStringCompression.BenchmarkNoDictionaryStringCompressionState._uncompressedString' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryStringCompression.java`
#### Snippet
```java
  public int benchmarkSnappyStringCompression(BenchmarkNoDictionaryStringCompressionState state)
      throws IOException {
    int size = Snappy.compress(state._uncompressedString, state._snappyCompressedStringOutput);
    return size;
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryStringCompression.BenchmarkNoDictionaryStringCompressionState._snappyCompressedStringOutput' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryStringCompression.java`
#### Snippet
```java
  public int benchmarkSnappyStringCompression(BenchmarkNoDictionaryStringCompressionState state)
      throws IOException {
    int size = Snappy.compress(state._uncompressedString, state._snappyCompressedStringOutput);
    return size;
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryStringCompression.BenchmarkNoDictionaryStringCompressionState._zstandardStringDecompressed' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryStringCompression.java`
#### Snippet
```java
  public int benchmarkZstandardStringDecompression(BenchmarkNoDictionaryStringCompressionState state)
      throws IOException {
    int size = Zstd.decompress(state._zstandardStringDecompressed, state._zstandardCompressedStringInput);
    return size;
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryStringCompression.BenchmarkNoDictionaryStringCompressionState._zstandardCompressedStringInput' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryStringCompression.java`
#### Snippet
```java
  public int benchmarkZstandardStringDecompression(BenchmarkNoDictionaryStringCompressionState state)
      throws IOException {
    int size = Zstd.decompress(state._zstandardStringDecompressed, state._zstandardCompressedStringInput);
    return size;
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryStringCompression.BenchmarkNoDictionaryStringCompressionState._factory' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryStringCompression.java`
#### Snippet
```java
      BenchmarkNoDictionaryStringCompression.BenchmarkNoDictionaryStringCompressionState state)
      throws IOException {
    state._factory.fastDecompressor().decompress(state._lz4CompressedStringInput, state._lz4StringDecompressed);
    return state._lz4StringDecompressed.position();
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryStringCompression.BenchmarkNoDictionaryStringCompressionState._lz4CompressedStringInput' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryStringCompression.java`
#### Snippet
```java
      BenchmarkNoDictionaryStringCompression.BenchmarkNoDictionaryStringCompressionState state)
      throws IOException {
    state._factory.fastDecompressor().decompress(state._lz4CompressedStringInput, state._lz4StringDecompressed);
    return state._lz4StringDecompressed.position();
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryStringCompression.BenchmarkNoDictionaryStringCompressionState._lz4StringDecompressed' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryStringCompression.java`
#### Snippet
```java
      BenchmarkNoDictionaryStringCompression.BenchmarkNoDictionaryStringCompressionState state)
      throws IOException {
    state._factory.fastDecompressor().decompress(state._lz4CompressedStringInput, state._lz4StringDecompressed);
    return state._lz4StringDecompressed.position();
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryStringCompression.BenchmarkNoDictionaryStringCompressionState._lz4StringDecompressed' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryStringCompression.java`
#### Snippet
```java
      throws IOException {
    state._factory.fastDecompressor().decompress(state._lz4CompressedStringInput, state._lz4StringDecompressed);
    return state._lz4StringDecompressed.position();
  }

```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryStringCompression.BenchmarkNoDictionaryStringCompressionState._zstandardCompressedStringOutput' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryStringCompression.java`
#### Snippet
```java
  public int benchmarkZstandardStringCompression(BenchmarkNoDictionaryStringCompressionState state)
      throws IOException {
    int size = Zstd.compress(state._zstandardCompressedStringOutput, state._uncompressedString);
    return size;
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryStringCompression.BenchmarkNoDictionaryStringCompressionState._uncompressedString' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryStringCompression.java`
#### Snippet
```java
  public int benchmarkZstandardStringCompression(BenchmarkNoDictionaryStringCompressionState state)
      throws IOException {
    int size = Zstd.compress(state._zstandardCompressedStringOutput, state._uncompressedString);
    return size;
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryIntegerCompression.BenchmarkNoDictionaryIntegerCompressionState._zstdCompressedIntegerOutput' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryIntegerCompression.java`
#### Snippet
```java
  public int benchmarkZstandardIntegerCompression(BenchmarkNoDictionaryIntegerCompressionState state)
      throws IOException {
    int size = Zstd.compress(state._zstdCompressedIntegerOutput, state._uncompressedInt);
    return size;
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryIntegerCompression.BenchmarkNoDictionaryIntegerCompressionState._uncompressedInt' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryIntegerCompression.java`
#### Snippet
```java
  public int benchmarkZstandardIntegerCompression(BenchmarkNoDictionaryIntegerCompressionState state)
      throws IOException {
    int size = Zstd.compress(state._zstdCompressedIntegerOutput, state._uncompressedInt);
    return size;
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryIntegerCompression.BenchmarkNoDictionaryIntegerCompressionState._factory' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryIntegerCompression.java`
#### Snippet
```java
  public int benchmarkLZ4IntegerCompression(BenchmarkNoDictionaryIntegerCompressionState state)
      throws IOException {
    state._factory.fastCompressor().compress(state._uncompressedInt, state._lz4CompressedIntegerOutput);
    return state._lz4CompressedIntegerOutput.position();
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryIntegerCompression.BenchmarkNoDictionaryIntegerCompressionState._uncompressedInt' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryIntegerCompression.java`
#### Snippet
```java
  public int benchmarkLZ4IntegerCompression(BenchmarkNoDictionaryIntegerCompressionState state)
      throws IOException {
    state._factory.fastCompressor().compress(state._uncompressedInt, state._lz4CompressedIntegerOutput);
    return state._lz4CompressedIntegerOutput.position();
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryIntegerCompression.BenchmarkNoDictionaryIntegerCompressionState._lz4CompressedIntegerOutput' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryIntegerCompression.java`
#### Snippet
```java
  public int benchmarkLZ4IntegerCompression(BenchmarkNoDictionaryIntegerCompressionState state)
      throws IOException {
    state._factory.fastCompressor().compress(state._uncompressedInt, state._lz4CompressedIntegerOutput);
    return state._lz4CompressedIntegerOutput.position();
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryIntegerCompression.BenchmarkNoDictionaryIntegerCompressionState._lz4CompressedIntegerOutput' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryIntegerCompression.java`
#### Snippet
```java
      throws IOException {
    state._factory.fastCompressor().compress(state._uncompressedInt, state._lz4CompressedIntegerOutput);
    return state._lz4CompressedIntegerOutput.position();
  }

```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryIntegerCompression.BenchmarkNoDictionaryIntegerCompressionState._snappyCompressedIntegerInput' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryIntegerCompression.java`
#### Snippet
```java
  public int benchmarkSnappyIntegerDecompression(BenchmarkNoDictionaryIntegerCompressionState state)
      throws IOException {
    int size = Snappy.uncompress(state._snappyCompressedIntegerInput, state._snappyIntegerDecompressed);
    return size;
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryIntegerCompression.BenchmarkNoDictionaryIntegerCompressionState._snappyIntegerDecompressed' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryIntegerCompression.java`
#### Snippet
```java
  public int benchmarkSnappyIntegerDecompression(BenchmarkNoDictionaryIntegerCompressionState state)
      throws IOException {
    int size = Snappy.uncompress(state._snappyCompressedIntegerInput, state._snappyIntegerDecompressed);
    return size;
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryIntegerCompression.BenchmarkNoDictionaryIntegerCompressionState._factory' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryIntegerCompression.java`
#### Snippet
```java
  public int benchmarkLZ4HCIntegerCompression(BenchmarkNoDictionaryIntegerCompressionState state)
      throws IOException {
    state._factory.highCompressor().compress(state._uncompressedInt, state._lz4CompressedIntegerOutput);
    return state._lz4CompressedIntegerOutput.position();
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryIntegerCompression.BenchmarkNoDictionaryIntegerCompressionState._uncompressedInt' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryIntegerCompression.java`
#### Snippet
```java
  public int benchmarkLZ4HCIntegerCompression(BenchmarkNoDictionaryIntegerCompressionState state)
      throws IOException {
    state._factory.highCompressor().compress(state._uncompressedInt, state._lz4CompressedIntegerOutput);
    return state._lz4CompressedIntegerOutput.position();
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryIntegerCompression.BenchmarkNoDictionaryIntegerCompressionState._lz4CompressedIntegerOutput' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryIntegerCompression.java`
#### Snippet
```java
  public int benchmarkLZ4HCIntegerCompression(BenchmarkNoDictionaryIntegerCompressionState state)
      throws IOException {
    state._factory.highCompressor().compress(state._uncompressedInt, state._lz4CompressedIntegerOutput);
    return state._lz4CompressedIntegerOutput.position();
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryIntegerCompression.BenchmarkNoDictionaryIntegerCompressionState._lz4CompressedIntegerOutput' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryIntegerCompression.java`
#### Snippet
```java
      throws IOException {
    state._factory.highCompressor().compress(state._uncompressedInt, state._lz4CompressedIntegerOutput);
    return state._lz4CompressedIntegerOutput.position();
  }

```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryIntegerCompression.BenchmarkNoDictionaryIntegerCompressionState._zstdIntegerDecompressed' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryIntegerCompression.java`
#### Snippet
```java
  public int benchmarkZstandardIntegerDecompression(BenchmarkNoDictionaryIntegerCompressionState state)
      throws IOException {
    int size = Zstd.decompress(state._zstdIntegerDecompressed, state._zstandardCompressedIntegerInput);
    return size;
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryIntegerCompression.BenchmarkNoDictionaryIntegerCompressionState._zstandardCompressedIntegerInput' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryIntegerCompression.java`
#### Snippet
```java
  public int benchmarkZstandardIntegerDecompression(BenchmarkNoDictionaryIntegerCompressionState state)
      throws IOException {
    int size = Zstd.decompress(state._zstdIntegerDecompressed, state._zstandardCompressedIntegerInput);
    return size;
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryIntegerCompression.BenchmarkNoDictionaryIntegerCompressionState._factory' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryIntegerCompression.java`
#### Snippet
```java
  public int benchmarkLZ4HCIntegerDecompression(BenchmarkNoDictionaryIntegerCompressionState state)
      throws IOException {
    state._factory.safeDecompressor().decompress(state._lz4CompressedIntegerInput, state._lz4IntegerDecompressed);
    return state._lz4IntegerDecompressed.position();
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryIntegerCompression.BenchmarkNoDictionaryIntegerCompressionState._lz4CompressedIntegerInput' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryIntegerCompression.java`
#### Snippet
```java
  public int benchmarkLZ4HCIntegerDecompression(BenchmarkNoDictionaryIntegerCompressionState state)
      throws IOException {
    state._factory.safeDecompressor().decompress(state._lz4CompressedIntegerInput, state._lz4IntegerDecompressed);
    return state._lz4IntegerDecompressed.position();
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryIntegerCompression.BenchmarkNoDictionaryIntegerCompressionState._lz4IntegerDecompressed' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryIntegerCompression.java`
#### Snippet
```java
  public int benchmarkLZ4HCIntegerDecompression(BenchmarkNoDictionaryIntegerCompressionState state)
      throws IOException {
    state._factory.safeDecompressor().decompress(state._lz4CompressedIntegerInput, state._lz4IntegerDecompressed);
    return state._lz4IntegerDecompressed.position();
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryIntegerCompression.BenchmarkNoDictionaryIntegerCompressionState._lz4IntegerDecompressed' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryIntegerCompression.java`
#### Snippet
```java
      throws IOException {
    state._factory.safeDecompressor().decompress(state._lz4CompressedIntegerInput, state._lz4IntegerDecompressed);
    return state._lz4IntegerDecompressed.position();
  }

```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryIntegerCompression.BenchmarkNoDictionaryIntegerCompressionState._uncompressedInt' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryIntegerCompression.java`
#### Snippet
```java
  public int benchmarkSnappyIntegerCompression(BenchmarkNoDictionaryIntegerCompressionState state)
      throws IOException {
    int size = Snappy.compress(state._uncompressedInt, state._snappyCompressedIntegerOutput);
    return size;
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryIntegerCompression.BenchmarkNoDictionaryIntegerCompressionState._snappyCompressedIntegerOutput' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryIntegerCompression.java`
#### Snippet
```java
  public int benchmarkSnappyIntegerCompression(BenchmarkNoDictionaryIntegerCompressionState state)
      throws IOException {
    int size = Snappy.compress(state._uncompressedInt, state._snappyCompressedIntegerOutput);
    return size;
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryIntegerCompression.BenchmarkNoDictionaryIntegerCompressionState._factory' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryIntegerCompression.java`
#### Snippet
```java
  public int benchmarkLZ4IntegerDecompression(BenchmarkNoDictionaryIntegerCompressionState state)
      throws IOException {
    state._factory.safeDecompressor().decompress(state._lz4CompressedIntegerInput, state._lz4IntegerDecompressed);
    return state._lz4IntegerDecompressed.position();
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryIntegerCompression.BenchmarkNoDictionaryIntegerCompressionState._lz4CompressedIntegerInput' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryIntegerCompression.java`
#### Snippet
```java
  public int benchmarkLZ4IntegerDecompression(BenchmarkNoDictionaryIntegerCompressionState state)
      throws IOException {
    state._factory.safeDecompressor().decompress(state._lz4CompressedIntegerInput, state._lz4IntegerDecompressed);
    return state._lz4IntegerDecompressed.position();
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryIntegerCompression.BenchmarkNoDictionaryIntegerCompressionState._lz4IntegerDecompressed' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryIntegerCompression.java`
#### Snippet
```java
  public int benchmarkLZ4IntegerDecompression(BenchmarkNoDictionaryIntegerCompressionState state)
      throws IOException {
    state._factory.safeDecompressor().decompress(state._lz4CompressedIntegerInput, state._lz4IntegerDecompressed);
    return state._lz4IntegerDecompressed.position();
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryIntegerCompression.BenchmarkNoDictionaryIntegerCompressionState._lz4IntegerDecompressed' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryIntegerCompression.java`
#### Snippet
```java
      throws IOException {
    state._factory.safeDecompressor().decompress(state._lz4CompressedIntegerInput, state._lz4IntegerDecompressed);
    return state._lz4IntegerDecompressed.position();
  }

```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryLongCompression.BenchmarkNoDictionaryLongCompressionState._zstandardCompressedLongOutput' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryLongCompression.java`
#### Snippet
```java
  public int benchmarkZstandardLongCompression(BenchmarkNoDictionaryLongCompressionState state)
      throws IOException {
    int size = Zstd.compress(state._zstandardCompressedLongOutput, state._uncompressedLong);
    return size;
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryLongCompression.BenchmarkNoDictionaryLongCompressionState._uncompressedLong' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryLongCompression.java`
#### Snippet
```java
  public int benchmarkZstandardLongCompression(BenchmarkNoDictionaryLongCompressionState state)
      throws IOException {
    int size = Zstd.compress(state._zstandardCompressedLongOutput, state._uncompressedLong);
    return size;
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryLongCompression.BenchmarkNoDictionaryLongCompressionState._uncompressedLong' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryLongCompression.java`
#### Snippet
```java
  public int benchmarkSnappyLongCompression(BenchmarkNoDictionaryLongCompressionState state)
      throws IOException {
    int size = Snappy.compress(state._uncompressedLong, state._snappyCompressedLongOutput);
    return size;
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryLongCompression.BenchmarkNoDictionaryLongCompressionState._snappyCompressedLongOutput' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryLongCompression.java`
#### Snippet
```java
  public int benchmarkSnappyLongCompression(BenchmarkNoDictionaryLongCompressionState state)
      throws IOException {
    int size = Snappy.compress(state._uncompressedLong, state._snappyCompressedLongOutput);
    return size;
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryLongCompression.BenchmarkNoDictionaryLongCompressionState._zstandardLongDecompressedOutput' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryLongCompression.java`
#### Snippet
```java
  public int benchmarkZstandardLongDecompression(BenchmarkNoDictionaryLongCompressionState state)
      throws IOException {
    int size = Zstd.decompress(state._zstandardLongDecompressedOutput, state._zstandardCompressedLongInput);
    return size;
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryLongCompression.BenchmarkNoDictionaryLongCompressionState._zstandardCompressedLongInput' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryLongCompression.java`
#### Snippet
```java
  public int benchmarkZstandardLongDecompression(BenchmarkNoDictionaryLongCompressionState state)
      throws IOException {
    int size = Zstd.decompress(state._zstandardLongDecompressedOutput, state._zstandardCompressedLongInput);
    return size;
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryLongCompression.BenchmarkNoDictionaryLongCompressionState._factory' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryLongCompression.java`
#### Snippet
```java
      BenchmarkNoDictionaryLongCompression.BenchmarkNoDictionaryLongCompressionState state)
      throws IOException {
    state._factory.safeDecompressor().decompress(state._lz4CompressedLongInput, state._lz4LongDecompressed);
    return state._lz4LongDecompressed.position();
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryLongCompression.BenchmarkNoDictionaryLongCompressionState._lz4CompressedLongInput' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryLongCompression.java`
#### Snippet
```java
      BenchmarkNoDictionaryLongCompression.BenchmarkNoDictionaryLongCompressionState state)
      throws IOException {
    state._factory.safeDecompressor().decompress(state._lz4CompressedLongInput, state._lz4LongDecompressed);
    return state._lz4LongDecompressed.position();
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryLongCompression.BenchmarkNoDictionaryLongCompressionState._lz4LongDecompressed' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryLongCompression.java`
#### Snippet
```java
      BenchmarkNoDictionaryLongCompression.BenchmarkNoDictionaryLongCompressionState state)
      throws IOException {
    state._factory.safeDecompressor().decompress(state._lz4CompressedLongInput, state._lz4LongDecompressed);
    return state._lz4LongDecompressed.position();
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryLongCompression.BenchmarkNoDictionaryLongCompressionState._lz4LongDecompressed' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryLongCompression.java`
#### Snippet
```java
      throws IOException {
    state._factory.safeDecompressor().decompress(state._lz4CompressedLongInput, state._lz4LongDecompressed);
    return state._lz4LongDecompressed.position();
  }

```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryLongCompression.BenchmarkNoDictionaryLongCompressionState._factory' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryLongCompression.java`
#### Snippet
```java
      BenchmarkNoDictionaryLongCompression.BenchmarkNoDictionaryLongCompressionState state)
      throws IOException {
    state._factory.highCompressor().compress(state._uncompressedLong, state._lz4CompressedLongOutput);
    return state._lz4CompressedLongOutput.position();
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryLongCompression.BenchmarkNoDictionaryLongCompressionState._uncompressedLong' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryLongCompression.java`
#### Snippet
```java
      BenchmarkNoDictionaryLongCompression.BenchmarkNoDictionaryLongCompressionState state)
      throws IOException {
    state._factory.highCompressor().compress(state._uncompressedLong, state._lz4CompressedLongOutput);
    return state._lz4CompressedLongOutput.position();
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryLongCompression.BenchmarkNoDictionaryLongCompressionState._lz4CompressedLongOutput' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryLongCompression.java`
#### Snippet
```java
      BenchmarkNoDictionaryLongCompression.BenchmarkNoDictionaryLongCompressionState state)
      throws IOException {
    state._factory.highCompressor().compress(state._uncompressedLong, state._lz4CompressedLongOutput);
    return state._lz4CompressedLongOutput.position();
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryLongCompression.BenchmarkNoDictionaryLongCompressionState._lz4CompressedLongOutput' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryLongCompression.java`
#### Snippet
```java
      throws IOException {
    state._factory.highCompressor().compress(state._uncompressedLong, state._lz4CompressedLongOutput);
    return state._lz4CompressedLongOutput.position();
  }

```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryLongCompression.BenchmarkNoDictionaryLongCompressionState._factory' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryLongCompression.java`
#### Snippet
```java
      BenchmarkNoDictionaryLongCompression.BenchmarkNoDictionaryLongCompressionState state)
      throws IOException {
    state._factory.fastCompressor().compress(state._uncompressedLong, state._lz4CompressedLongOutput);
    return state._lz4CompressedLongOutput.position();
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryLongCompression.BenchmarkNoDictionaryLongCompressionState._uncompressedLong' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryLongCompression.java`
#### Snippet
```java
      BenchmarkNoDictionaryLongCompression.BenchmarkNoDictionaryLongCompressionState state)
      throws IOException {
    state._factory.fastCompressor().compress(state._uncompressedLong, state._lz4CompressedLongOutput);
    return state._lz4CompressedLongOutput.position();
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryLongCompression.BenchmarkNoDictionaryLongCompressionState._lz4CompressedLongOutput' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryLongCompression.java`
#### Snippet
```java
      BenchmarkNoDictionaryLongCompression.BenchmarkNoDictionaryLongCompressionState state)
      throws IOException {
    state._factory.fastCompressor().compress(state._uncompressedLong, state._lz4CompressedLongOutput);
    return state._lz4CompressedLongOutput.position();
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryLongCompression.BenchmarkNoDictionaryLongCompressionState._lz4CompressedLongOutput' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryLongCompression.java`
#### Snippet
```java
      throws IOException {
    state._factory.fastCompressor().compress(state._uncompressedLong, state._lz4CompressedLongOutput);
    return state._lz4CompressedLongOutput.position();
  }

```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryLongCompression.BenchmarkNoDictionaryLongCompressionState._factory' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryLongCompression.java`
#### Snippet
```java
      BenchmarkNoDictionaryLongCompression.BenchmarkNoDictionaryLongCompressionState state)
      throws IOException {
    state._factory.safeDecompressor().decompress(state._lz4CompressedLongInput, state._lz4LongDecompressed);
    return state._lz4LongDecompressed.position();
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryLongCompression.BenchmarkNoDictionaryLongCompressionState._lz4CompressedLongInput' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryLongCompression.java`
#### Snippet
```java
      BenchmarkNoDictionaryLongCompression.BenchmarkNoDictionaryLongCompressionState state)
      throws IOException {
    state._factory.safeDecompressor().decompress(state._lz4CompressedLongInput, state._lz4LongDecompressed);
    return state._lz4LongDecompressed.position();
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryLongCompression.BenchmarkNoDictionaryLongCompressionState._lz4LongDecompressed' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryLongCompression.java`
#### Snippet
```java
      BenchmarkNoDictionaryLongCompression.BenchmarkNoDictionaryLongCompressionState state)
      throws IOException {
    state._factory.safeDecompressor().decompress(state._lz4CompressedLongInput, state._lz4LongDecompressed);
    return state._lz4LongDecompressed.position();
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryLongCompression.BenchmarkNoDictionaryLongCompressionState._lz4LongDecompressed' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryLongCompression.java`
#### Snippet
```java
      throws IOException {
    state._factory.safeDecompressor().decompress(state._lz4CompressedLongInput, state._lz4LongDecompressed);
    return state._lz4LongDecompressed.position();
  }

```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryLongCompression.BenchmarkNoDictionaryLongCompressionState._snappyCompressedLongInput' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryLongCompression.java`
#### Snippet
```java
  public int benchmarkSnappyLongDecompression(BenchmarkNoDictionaryLongCompressionState state)
      throws IOException {
    int size = Snappy.uncompress(state._snappyCompressedLongInput, state._snappyLongDecompressedOutput);
    return size;
  }
```

### AccessStaticViaInstance
Static member 'org.apache.pinot.perf.BenchmarkNoDictionaryLongCompression.BenchmarkNoDictionaryLongCompressionState._snappyLongDecompressedOutput' accessed via instance reference
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryLongCompression.java`
#### Snippet
```java
  public int benchmarkSnappyLongDecompression(BenchmarkNoDictionaryLongCompressionState state)
      throws IOException {
    int size = Snappy.uncompress(state._snappyCompressedLongInput, state._snappyLongDecompressedOutput);
    return size;
  }
```

## RuleId[id=RedundantMethodOverride]
### RedundantMethodOverride
Method `setLhs()` is identical to its super method
in `pinot-common/src/main/java/org/apache/pinot/common/request/context/predicate/TextContainsPredicate.java`
#### Snippet
```java

  @Override
  public void setLhs(ExpressionContext lhs) {
    _lhs = lhs;
  }
```

### RedundantMethodOverride
Method `getLhs()` is identical to its super method
in `pinot-common/src/main/java/org/apache/pinot/common/request/context/predicate/TextContainsPredicate.java`
#### Snippet
```java

  @Override
  public ExpressionContext getLhs() {
    return _lhs;
  }
```

### RedundantMethodOverride
Method `toJsonString()` is identical to its super method
in `pinot-common/src/main/java/org/apache/pinot/common/response/broker/BrokerResponseStats.java`
#### Snippet
```java
  }

  public String toJsonString()
      throws IOException {
    return JsonUtils.objectToString(this);
```

### RedundantMethodOverride
Method `initialValue()` is identical to its super method
in `pinot-core/src/main/java/org/apache/pinot/core/util/trace/TraceContext.java`
#### Snippet
```java
  private static final ThreadLocal<TraceEntry> TRACE_ENTRY_THREAD_LOCAL = new ThreadLocal<TraceEntry>() {
    @Override
    protected TraceEntry initialValue() {
      return null;
    }
```

### RedundantMethodOverride
Method `equals()` is identical to its super method
in `pinot-core/src/main/java/org/apache/pinot/core/query/utils/idset/EmptyIdSet.java`
#### Snippet
```java

  @Override
  public boolean equals(Object o) {
    return this == o;
  }
```

### RedundantMethodOverride
Method `getResultMetadata()` is identical to its super method
in `pinot-core/src/main/java/org/apache/pinot/core/operator/transform/function/DistinctFromTransformFunction.java`
#### Snippet
```java

  @Override
  public TransformResultMetadata getResultMetadata() {
    return BOOLEAN_SV_NO_DICTIONARY_METADATA;
  }
```

### RedundantMethodOverride
Method `cleanup()` is identical to its super method
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/BootstrapTableCommand.java`
#### Snippet
```java

  @Override
  public void cleanup() {
  }

```

### RedundantMethodOverride
Method `cleanup()` is identical to its super method
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/QuickStartCommand.java`
#### Snippet
```java

  @Override
  public void cleanup() {
  }

```

### RedundantMethodOverride
Method `cleanup()` is identical to its super method
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/DeleteTableCommand.java`
#### Snippet
```java

  @Override
  public void cleanup() {
  }

```

### RedundantMethodOverride
Method `cleanup()` is identical to its super method
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartControllerCommand.java`
#### Snippet
```java

  @Override
  public void cleanup() {
  }

```

### RedundantMethodOverride
Method `cleanup()` is identical to its super method
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AddTableCommand.java`
#### Snippet
```java

  @Override
  public void cleanup() {
  }

```

### RedundantMethodOverride
Method `cleanup()` is identical to its super method
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ChangeTableState.java`
#### Snippet
```java

  @Override
  public void cleanup() {
  }
}
```

### RedundantMethodOverride
Method `cleanup()` is identical to its super method
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/GitHubEventsQuickStartCommand.java`
#### Snippet
```java

  @Override
  public void cleanup() {
  }

```

### RedundantMethodOverride
Method `cleanup()` is identical to its super method
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/DeleteSchemaCommand.java`
#### Snippet
```java

  @Override
  public void cleanup() {
  }

```

### RedundantMethodOverride
Method `cleanup()` is identical to its super method
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/OfflineSegmentIntervalCheckerCommand.java`
#### Snippet
```java

  @Override
  public void cleanup() {
  }

```

### RedundantMethodOverride
Method `cleanup()` is identical to its super method
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/SegmentProcessorFrameworkCommand.java`
#### Snippet
```java

  @Override
  public void cleanup() {
  }

```

### RedundantMethodOverride
Method `cleanup()` is identical to its super method
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartMinionCommand.java`
#### Snippet
```java

  @Override
  public void cleanup() {
  }

```

### RedundantMethodOverride
Method `cleanup()` is identical to its super method
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/PostQueryCommand.java`
#### Snippet
```java

  @Override
  public void cleanup() {
  }

```

### RedundantMethodOverride
Method `cleanup()` is identical to its super method
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/UploadSegmentCommand.java`
#### Snippet
```java

  @Override
  public void cleanup() {
  }

```

### RedundantMethodOverride
Method `cleanup()` is identical to its super method
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartZookeeperCommand.java`
#### Snippet
```java

  @Override
  public void cleanup() {
  }

```

### RedundantMethodOverride
Method `cleanup()` is identical to its super method
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartBrokerCommand.java`
#### Snippet
```java

  @Override
  public void cleanup() {
  }

```

### RedundantMethodOverride
Method `cleanup()` is identical to its super method
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AddSchemaCommand.java`
#### Snippet
```java

  @Override
  public void cleanup() {
  }

```

### RedundantMethodOverride
Method `cleanup()` is identical to its super method
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/OperateClusterConfigCommand.java`
#### Snippet
```java

  @Override
  public void cleanup() {
  }

```

### RedundantMethodOverride
Method `cleanup()` is identical to its super method
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/GenerateDataCommand.java`
#### Snippet
```java

  @Override
  public void cleanup() {
  }

```

### RedundantMethodOverride
Method `cleanup()` is identical to its super method
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/DeleteClusterCommand.java`
#### Snippet
```java

  @Override
  public void cleanup() {
  }

```

### RedundantMethodOverride
Method `cleanup()` is identical to its super method
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StreamGitHubEventsCommand.java`
#### Snippet
```java

  @Override
  public void cleanup() {
  }

```

### RedundantMethodOverride
Method `cleanup()` is identical to its super method
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartServerCommand.java`
#### Snippet
```java

  @Override
  public void cleanup() {
  }

```

### RedundantMethodOverride
Method `cleanup()` is identical to its super method
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StopProcessCommand.java`
#### Snippet
```java

  @Override
  public void cleanup() {
  }

```

### RedundantMethodOverride
Method `cleanup()` is identical to its super method
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/FileSystemCommand.java`
#### Snippet
```java

  @Override
  public void cleanup() {
  }

```

### RedundantMethodOverride
Method `cleanup()` is identical to its super method
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/MoveReplicaGroup.java`
#### Snippet
```java

  @Override
  public void cleanup() {
  }

```

### RedundantMethodOverride
Method `init()` is identical to its super method
in `pinot-broker/src/main/java/org/apache/pinot/broker/broker/AllowAllAccessControlFactory.java`
#### Snippet
```java
  }

  public void init(PinotConfiguration configuration) {
  }

```

## RuleId[id=IntegerMultiplicationImplicitCastToLong]
### IntegerMultiplicationImplicitCastToLong
_waitForPushTimeSeconds \* 1000: integer multiplication implicitly cast to long
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/SegmentStatusChecker.java`
#### Snippet
```java
          _pinotHelixResourceManager.getSegmentZKMetadata(tableNameWithType, partitionName);
      if (segmentZKMetadata != null
          && segmentZKMetadata.getPushTime() > System.currentTimeMillis() - _waitForPushTimeSeconds * 1000) {
        // Push is not finished yet, skip the segment
        continue;
```

### IntegerMultiplicationImplicitCastToLong
nReplicasExternal \* 100: integer multiplication implicitly cast to long
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/SegmentStatusChecker.java`
#### Snippet
```java
    _controllerMetrics.setValueOfTableGauge(tableNameWithType, ControllerGauge.NUMBER_OF_REPLICAS, nReplicasExternal);
    _controllerMetrics.setValueOfTableGauge(tableNameWithType, ControllerGauge.PERCENT_OF_REPLICAS,
        (nReplicasIdealMax > 0) ? (nReplicasExternal * 100 / nReplicasIdealMax) : 100);
    _controllerMetrics.setValueOfTableGauge(tableNameWithType, ControllerGauge.SEGMENTS_IN_ERROR_STATE, nErrors);
    _controllerMetrics.setValueOfTableGauge(tableNameWithType, ControllerGauge.PERCENT_SEGMENTS_AVAILABLE,
```

### IntegerMultiplicationImplicitCastToLong
(nSegments - nOffline) \* 100: integer multiplication implicitly cast to long
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/SegmentStatusChecker.java`
#### Snippet
```java
    _controllerMetrics.setValueOfTableGauge(tableNameWithType, ControllerGauge.SEGMENTS_IN_ERROR_STATE, nErrors);
    _controllerMetrics.setValueOfTableGauge(tableNameWithType, ControllerGauge.PERCENT_SEGMENTS_AVAILABLE,
        (nSegments > 0) ? (nSegments - nOffline) * 100 / nSegments : 100);
    _controllerMetrics.setValueOfTableGauge(tableNameWithType, ControllerGauge.TABLE_COMPRESSED_SIZE,
        tableCompressedSize);
```

### IntegerMultiplicationImplicitCastToLong
extTimeSec \* 1000: integer multiplication implicitly cast to long
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/realtime/SegmentCompletionManager.java`
#### Snippet
```java
      SegmentCompletionProtocol.Response response = abortIfTooLateAndReturnHold(now, instanceId, offset);
      if (response == null) {
        long maxTimeAllowedToCommitMs = now + extTimeSec * 1000;
        if (maxTimeAllowedToCommitMs > _startTimeMs + MAX_COMMIT_TIME_FOR_ALL_SEGMENTS_SECONDS * 1000) {
          _logger.warn("Not accepting lease extension from {} startTime={} requestedTime={}", instanceId, _startTimeMs,
```

### IntegerMultiplicationImplicitCastToLong
_dataTypeSizeMap.get(dataType) \* getAverageDataLen(colName): integer multiplication implicitly cast to long
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/io/InputManager.java`
#### Snippet
```java
    } else {
      if (dataType == FieldSpec.DataType.BYTES || dataType == FieldSpec.DataType.STRING) {
        return _dataTypeSizeMap.get(dataType) * getAverageDataLen(colName);
      } else {
        return _dataTypeSizeMap.get(dataType);
```

### IntegerMultiplicationImplicitCastToLong
segmentSizeRuleParams.getActualSegmentSizeMB() \* MEGA_BYTE: integer multiplication implicitly cast to long
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/rules/impl/SegmentSizeRule.java`
#### Snippet
```java
      }
    } else {
      segmentSize = segmentSizeRuleParams.getActualSegmentSizeMB() * MEGA_BYTE;
      numRows = segmentSizeRuleParams.getNumRowsInActualSegment();
    }
```

### IntegerMultiplicationImplicitCastToLong
numHoursToConsume \* 3600: integer multiplication implicitly cast to long
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/realtime/provisioning/MemoryEstimator.java`
#### Snippet
```java
          continue;
        }
        long secondsToConsume = numHoursToConsume * 3600;
        // consuming for _numHoursSampleSegmentConsumed, gives size sampleCompletedSegmentSizeBytes
        // hence, consuming for numHoursToConsume would give:
```

### IntegerMultiplicationImplicitCastToLong
_dataSizeInMBsForCopyTest \* 1024 \* 1024: integer multiplication implicitly cast to long
in `pinot-tools/src/main/java/org/apache/pinot/tools/filesystem/PinotFSBenchmarkDriver.java`
#### Snippet
```java
    LOGGER.info("Created {} for copy test...", copyTestUri);

    long fileSizeInBytes = _dataSizeInMBsForCopyTest * 1024 * 1024;
    File largeTmpFile = createFileWithSize("largeFile", fileSizeInBytes);
    for (int i = 0; i < _numOps; i++) {
```

### IntegerMultiplicationImplicitCastToLong
sizeOfEntry \* normalizeDocsPerChunk(writerVersion, numDocsPerChunk): integer multiplication implicitly cast to long
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/writer/impl/FixedByteChunkSVForwardIndexWriter.java`
#### Snippet
```java
      throws IOException {
    super(file, compressionType, totalDocs, normalizeDocsPerChunk(writerVersion, numDocsPerChunk),
        (sizeOfEntry * normalizeDocsPerChunk(writerVersion, numDocsPerChunk)), sizeOfEntry,
        writerVersion, true);
    _chunkDataOffset = 0;
```

### IntegerMultiplicationImplicitCastToLong
rowSizeInBytes \* numRowsPerChunk: integer multiplication implicitly cast to long
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/readerwriter/impl/FixedByteSingleValueMultiColumnReaderWriter.java`
#### Snippet
```java

    _numColumns = _columnSizesInBytes.length;
    _chunkSizeInBytes = rowSizeInBytes * numRowsPerChunk;
  }

```

### IntegerMultiplicationImplicitCastToLong
2 \* cardinality \* Integer.BYTES: integer multiplication implicitly cast to long
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/readers/sorted/SortedIndexReaderImpl.java`
#### Snippet
```java
  public SortedIndexReaderImpl(PinotDataBuffer dataBuffer, int cardinality) {
    // 2 values per dictionary id
    Preconditions.checkState(dataBuffer.size() == 2 * cardinality * Integer.BYTES);
    _reader = new FixedByteValueReaderWriter(dataBuffer);
    _cardinality = cardinality;
```

### IntegerMultiplicationImplicitCastToLong
numChunks \* Integer.BYTES: integer multiplication implicitly cast to long
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/readers/forward/FixedBitMVForwardIndexReader.java`
#### Snippet
```java
    _numDocsPerChunk = (int) (Math.ceil((float) PREFERRED_NUM_VALUES_PER_CHUNK / (numValues / numDocs)));
    int numChunks = (numDocs + _numDocsPerChunk - 1) / _numDocsPerChunk;
    long endOffset = numChunks * Integer.BYTES;
    _chunkOffsetReader = new FixedByteValueReaderWriter(dataBuffer.view(0L, endOffset));
    int bitmapSize = (numValues + Byte.SIZE - 1) / Byte.SIZE;
```

### IntegerMultiplicationImplicitCastToLong
chunkRowId \* ROW_OFFSET_SIZE: integer multiplication implicitly cast to long
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/readers/forward/VarByteChunkSVForwardIndexReader.java`
#### Snippet
```java
    // These offsets are offset in the data buffer
    long chunkStartOffset = getChunkPosition(chunkId);
    long valueStartOffset = chunkStartOffset + _dataBuffer.getInt(chunkStartOffset + chunkRowId * ROW_OFFSET_SIZE);
    long valueEndOffset = getValueEndOffset(chunkId, chunkRowId, chunkStartOffset);

```

### IntegerMultiplicationImplicitCastToLong
(chunkRowId + 1) \* ROW_OFFSET_SIZE: integer multiplication implicitly cast to long
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/readers/forward/VarByteChunkSVForwardIndexReader.java`
#### Snippet
```java
        return _dataBuffer.size();
      } else {
        int valueEndOffsetInChunk = _dataBuffer.getInt(chunkStartOffset + (chunkRowId + 1) * ROW_OFFSET_SIZE);
        if (valueEndOffsetInChunk == 0) {
          // Last row in the last chunk (chunk is incomplete, which stores 0 as the offset for the absent rows)
```

### IntegerMultiplicationImplicitCastToLong
(chunkRowId + 1) \* ROW_OFFSET_SIZE: integer multiplication implicitly cast to long
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/readers/forward/VarByteChunkSVForwardIndexReader.java`
#### Snippet
```java
        return getChunkPosition(chunkId + 1);
      } else {
        return chunkStartOffset + _dataBuffer.getInt(chunkStartOffset + (chunkRowId + 1) * ROW_OFFSET_SIZE);
      }
    }
```

### IntegerMultiplicationImplicitCastToLong
chunkRowId \* ROW_OFFSET_SIZE: integer multiplication implicitly cast to long
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/readers/forward/VarByteChunkSVForwardIndexReader.java`
#### Snippet
```java
    // These offsets are offset in the data buffer
    long chunkStartOffset = getChunkPosition(chunkId);
    long valueStartOffset = chunkStartOffset + _dataBuffer.getInt(chunkStartOffset + chunkRowId * ROW_OFFSET_SIZE);
    long valueEndOffset = getValueEndOffset(chunkId, chunkRowId, chunkStartOffset);

```

### IntegerMultiplicationImplicitCastToLong
ranges.size() \* _valueType.size(): integer multiplication implicitly cast to long
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/creator/impl/inv/RangeIndexCreator.java`
#### Snippet
```java
        writeNumberToHeader(header, rangeStart);
      }
      bytesWritten += ranges.size() * _valueType.size(); // Range start values

      Number lastRangeEnd = _numberValueBuffer.get(ranges.get(ranges.size() - 1).getRight());
```

### IntegerMultiplicationImplicitCastToLong
(ranges.size() + 1) \* Long.BYTES: integer multiplication implicitly cast to long
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/creator/impl/inv/RangeIndexCreator.java`
#### Snippet
```java
      //compute the offset where the bitmap for the first range would be written
      //bitmap start offset for each range, one extra to make it easy to get the length for last one.
      long bitmapOffsetHeaderSize = (ranges.size() + 1) * Long.BYTES;

      long bitmapOffset = bytesWritten + bitmapOffsetHeaderSize;
```

### IntegerMultiplicationImplicitCastToLong
numRowsPerChunk \* _valueSizeInBytes: integer multiplication implicitly cast to long
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/realtime/impl/forward/FixedByteSVMutableForwardIndex.java`
#### Snippet
```java
    _valueSizeInBytes = storedType.size();
    _numRowsPerChunk = numRowsPerChunk;
    _chunkSizeInBytes = numRowsPerChunk * _valueSizeInBytes;
    _memoryManager = memoryManager;
    _allocationContext = allocationContext;
```

### IntegerMultiplicationImplicitCastToLong
rowCapacity \* _columnSizeInBytes: integer multiplication implicitly cast to long
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/realtime/impl/forward/FixedByteMVMutableForwardIndex.java`
#### Snippet
```java
  private void addDataBuffer(int rowCapacity) {
    try {
      long size = rowCapacity * _columnSizeInBytes;
      LOGGER.info("Allocating data buffer of size {} for column {}", size, _context);
      // NOTE: PinotDataBuffer is tracked in PinotDataBufferMemoryManager. No need to track and close inside the class.
```

### IntegerMultiplicationImplicitCastToLong
iBuf.capacity() \* Integer.BYTES: integer multiplication implicitly cast to long
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/realtime/impl/dictionary/BaseOffHeapMutableDictionary.java`
#### Snippet
```java
    long size = 0;
    for (IntBuffer iBuf : valueToDictId._iBufList) {
      size = size + iBuf.capacity() * Integer.BYTES;
    }
    return size;
```

### IntegerMultiplicationImplicitCastToLong
i \* Integer.BYTES: integer multiplication implicitly cast to long
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/startree/v2/builder/OffHeapSingleTreeBuilder.java`
#### Snippet
```java
        long offset2 = (long) sortedDocIds[i2] * _numDimensions * Integer.BYTES;
        for (int i = 0; i < _numDimensions; i++) {
          int dimension1 = dataBuffer.getInt(offset1 + i * Integer.BYTES);
          int dimension2 = dataBuffer.getInt(offset2 + i * Integer.BYTES);
          if (dimension1 != dimension2) {
```

### IntegerMultiplicationImplicitCastToLong
i \* Integer.BYTES: integer multiplication implicitly cast to long
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/startree/v2/builder/OffHeapSingleTreeBuilder.java`
#### Snippet
```java
        for (int i = 0; i < _numDimensions; i++) {
          int dimension1 = dataBuffer.getInt(offset1 + i * Integer.BYTES);
          int dimension2 = dataBuffer.getInt(offset2 + i * Integer.BYTES);
          if (dimension1 != dimension2) {
            return dimension1 - dimension2;
```

### IntegerMultiplicationImplicitCastToLong
dimensionId \* Integer.BYTES: integer multiplication implicitly cast to long
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/startree/v2/builder/OffHeapSingleTreeBuilder.java`
#### Snippet
```java
      throws IOException {
    ensureBufferReadable(docId);
    return _starTreeRecordBuffer.getInt(_starTreeRecordOffsets.get(docId) + dimensionId * Integer.BYTES);
  }

```

### IntegerMultiplicationImplicitCastToLong
i \* Integer.BYTES: integer multiplication implicitly cast to long
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/startree/v2/builder/OffHeapSingleTreeBuilder.java`
#### Snippet
```java
      long offset2 = _starTreeRecordOffsets.get(sortedDocIds[i2]);
      for (int i = dimensionId + 1; i < _numDimensions; i++) {
        int dimension1 = _starTreeRecordBuffer.getInt(offset1 + i * Integer.BYTES);
        int dimension2 = _starTreeRecordBuffer.getInt(offset2 + i * Integer.BYTES);
        if (dimension1 != dimension2) {
```

### IntegerMultiplicationImplicitCastToLong
i \* Integer.BYTES: integer multiplication implicitly cast to long
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/startree/v2/builder/OffHeapSingleTreeBuilder.java`
#### Snippet
```java
      for (int i = dimensionId + 1; i < _numDimensions; i++) {
        int dimension1 = _starTreeRecordBuffer.getInt(offset1 + i * Integer.BYTES);
        int dimension2 = _starTreeRecordBuffer.getInt(offset2 + i * Integer.BYTES);
        if (dimension1 != dimension2) {
          return dimension1 - dimension2;
```

## RuleId[id=ExcessiveLambdaUsage]
### ExcessiveLambdaUsage
Excessive lambda usage
in `pinot-core/src/main/java/org/apache/pinot/core/auth/BasicAuthUtils.java`
#### Snippet
```java

          Set<String> tables = Optional.ofNullable(user.getTables())
              .orElseGet(() -> Collections.emptyList())
              .stream().collect(Collectors.toSet());
          Set<String> permissions = Optional.ofNullable(user.getPermissios())
```

### ExcessiveLambdaUsage
Excessive lambda usage
in `pinot-core/src/main/java/org/apache/pinot/core/auth/BasicAuthUtils.java`
#### Snippet
```java
              .stream().collect(Collectors.toSet());
          Set<String> permissions = Optional.ofNullable(user.getPermissios())
              .orElseGet(() -> Collections.emptyList())
              .stream().map(x -> x.toString())
              .collect(Collectors.toSet());
```

## RuleId[id=ReturnFromFinallyBlock]
### ReturnFromFinallyBlock
'return' inside 'finally' block
in `pinot-common/src/main/java/org/apache/pinot/common/utils/BcryptUtils.java`
#### Snippet
```java
            System.out.println(e.getMessage());
        } finally {
            return isMatch;
        }
    }
```

## RuleId[id=MismatchedCollectionQueryUpdate]
### MismatchedCollectionQueryUpdate
Contents of collection `partitionByKeyList` are queried, but never updated
in `pinot-query-planner/src/main/java/org/apache/calcite/rel/rules/PinotWindowExchangeNodeInsertRule.java`
#### Snippet
```java

    if (windowGroup.orderKeys.getKeys().size() == windowGroup.keys.asList().size()) {
      Set<Integer> partitionByKeyList = new HashSet<>(windowGroup.keys.toList());
      Set<Integer> orderByKeyList = new HashSet<>(windowGroup.orderKeys.getKeys());
      isPartitionByOnly = partitionByKeyList.equals(orderByKeyList);
```

### MismatchedCollectionQueryUpdate
Contents of collection `orderByKeyList` are queried, but never updated
in `pinot-query-planner/src/main/java/org/apache/calcite/rel/rules/PinotWindowExchangeNodeInsertRule.java`
#### Snippet
```java
    if (windowGroup.orderKeys.getKeys().size() == windowGroup.keys.asList().size()) {
      Set<Integer> partitionByKeyList = new HashSet<>(windowGroup.keys.toList());
      Set<Integer> orderByKeyList = new HashSet<>(windowGroup.orderKeys.getKeys());
      isPartitionByOnly = partitionByKeyList.equals(orderByKeyList);
    }
```

### MismatchedCollectionQueryUpdate
Contents of collection `headersWrapper` are updated, but never queried
in `pinot-common/src/main/java/org/apache/pinot/common/utils/http/HttpClient.java`
#### Snippet
```java
      @Nullable Map<String, String> headers, @Nullable AuthProvider authProvider)
      throws IOException {
    Map<String, String> headersWrapper = MapUtils.isEmpty(headers) ? new HashMap<>() : new HashMap<>(headers);
    headersWrapper.put(HttpHeaders.CONTENT_TYPE, JSON_CONTENT_TYPE);
    HttpEntity entity =
```

### MismatchedCollectionQueryUpdate
Contents of collection `_userConfigMap` are queried, but never updated
in `pinot-common/src/main/java/org/apache/pinot/common/config/provider/AccessControlUserCache.java`
#### Snippet
```java
    private final UserConfigChangeListener _userConfigChangeListener = new UserConfigChangeListener();

    private final Map<String, UserConfig> _userConfigMap = new ConcurrentHashMap<>();
    private final Map<String, UserConfig> _userControllerConfigMap = new ConcurrentHashMap<>();
    private final Map<String, UserConfig> _userBrokerConfigMap = new ConcurrentHashMap<>();
```

### MismatchedCollectionQueryUpdate
Contents of collection `missingSegments` are updated, but never queried
in `pinot-controller/src/main/java/org/apache/pinot/controller/util/TableSizeReader.java`
#### Snippet
```java
    // errors, as described above.
    // estimatedSize >= reportedSize. If no server reported error, estimatedSize == reportedSize
    List<String> missingSegments = new ArrayList<>();
    for (Map.Entry<String, SegmentSizeDetails> entry : segmentToSizeDetailsMap.entrySet()) {
      String segment = entry.getKey();
```

### MismatchedCollectionQueryUpdate
Contents of collection `segmentList` are queried, but never updated
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/PinotHelixResourceManager.java`
#### Snippet
```java
    // Get the segment list for this table
    IdealState is = _helixAdmin.getResourceIdealState(_helixClusterName, tableNameWithType);
    List<String> segmentList = new ArrayList<>(is.getPartitionSet());

    // Make a list of segment metadata for the given table
```

### MismatchedCollectionQueryUpdate
Contents of collection `_sparkConf` are queried, but never updated
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/LaunchSparkDataIngestionJobCommand.java`
#### Snippet
```java
      "Additional Spark configuration values as key value pairs separated by : e.g. -sparkConf spark.executor"
          + ".cores=2:num-executors=3")
  private Map<String, String> _sparkConf;
  @CommandLine.Unmatched
  private String[] _unmatchedArgs;
```

### MismatchedCollectionQueryUpdate
Contents of collection `_pluginsToLoad` are queried, but never updated
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/LaunchSparkDataIngestionJobCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-pluginsToLoad"}, required = false, arity = "1..*", split = ":", description = "List "
      + "of plugin name separated by : to load at runtime. e.g. pinto-s3:pinot-parquet")
  private List<String> _pluginsToLoad;

  // Kafka plugins need to be excluded as they contain scala dependencies which cause
```

### MismatchedCollectionQueryUpdate
Contents of collection `_pluginsToExclude` are queried, but never updated
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/LaunchSparkDataIngestionJobCommand.java`
#### Snippet
```java
      false, arity = "1..*", split = ":", description =
      "List " + "of plugin name separated by : to not load at runtime. e.g. pinto-s3:pinot-parquet")
  private List<String> _pluginsToExclude;
  @CommandLine.Option(names = {"-pinotBaseDir"}, required = false, description = "Pinot binary installation directory")
  private String _pinotBaseDir;
```

### MismatchedCollectionQueryUpdate
Contents of collection `filterColumns` are updated, but never queried
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AnonymizeDataCommand.java`
#### Snippet
```java
    }

    Set<String> filterColumns = new HashSet<>();
    Map<String, Integer> filterColumnCardinalityMap = new HashMap<>();
    if (_columnsParticipatingInFilter != null) {
```

### MismatchedCollectionQueryUpdate
Contents of collection `_info` are updated, but never queried
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/builder/FSTBuilder.java`
#### Snippet
```java
   * Information about the automaton and its compilation.
   */
  private TreeMap<InfoEntry, Object> _info;
  /**
   * {@link #_previous} sequence's length, used in assertions only.
```

### MismatchedCollectionQueryUpdate
Contents of collection `split` are updated, but never queried
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/automaton/MinimizationOperations.java`
#### Snippet
```java
    LinkedList<IntPair> pending = new LinkedList<IntPair>();
    boolean[][] pending2 = new boolean[sigma.length][states.length];
    ArrayList<State> split = new ArrayList<State>();
    boolean[] split2 = new boolean[states.length];
    ArrayList<Integer> refine = new ArrayList<Integer>();
```

## RuleId[id=PointlessBitwiseExpression]
### PointlessBitwiseExpression
`1 << 0` can be replaced with '1'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/FSTFlags.java`
#### Snippet
```java
public enum FSTFlags {
  /** Daciuk: flexible FST encoding. */
  FLEXIBLE(1 << 0),

  /** Daciuk: stop bit in use. */
```

### PointlessBitwiseExpression
`1 << 0` can be replaced with '1'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/ConstantArcSizeFST.java`
#### Snippet
```java
  public final static int BIT_ARC_FINAL = 1 << 1;
  /** An arc flag indicating the arc is last within its state. */
  public final static int BIT_ARC_LAST = 1 << 0;
  /** A dummy address of the terminal state. */
  public final static int TERMINAL_STATE = 0;
```

### PointlessBitwiseExpression
`1 << 0` can be replaced with '1'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/ImmutableFST.java`
#### Snippet
```java
   * available when building the automaton.
   */
  public static final int BIT_FINAL_ARC = 1 << 0;

  /**
```

### PointlessBitwiseExpression
`1 << 0` can be replaced with '1'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/customobject/QuantileDigest.java`
#### Snippet
```java

  private static class Flags {
    public static final int HAS_LEFT = 1 << 0;
    public static final int HAS_RIGHT = 1 << 1;
  }
```

## RuleId[id=StringConcatenationInLoops]
### StringConcatenationInLoops
String concatenation `+=` in loop
in `pinot-common/src/main/java/org/apache/pinot/common/utils/SqlResultComparator.java`
#### Snippet
```java
      for (int j = 0; j < actualValue.size(); j++) {
        if (orderByColumnIndexs.contains(j)) {
          actualOrderByColumnValues += ", " + actualValue.get(j).toString();
          expectedOrderByColumnValues += ", " + expectedValue.get(j).toString();
        } else {
```

### StringConcatenationInLoops
String concatenation `+=` in loop
in `pinot-common/src/main/java/org/apache/pinot/common/utils/SqlResultComparator.java`
#### Snippet
```java
        if (orderByColumnIndexs.contains(j)) {
          actualOrderByColumnValues += ", " + actualValue.get(j).toString();
          expectedOrderByColumnValues += ", " + expectedValue.get(j).toString();
        } else {
          actualOtherColumnValues += ", " + actualValue.get(j).toString();
```

### StringConcatenationInLoops
String concatenation `+=` in loop
in `pinot-common/src/main/java/org/apache/pinot/common/utils/SqlResultComparator.java`
#### Snippet
```java
          expectedOrderByColumnValues += ", " + expectedValue.get(j).toString();
        } else {
          actualOtherColumnValues += ", " + actualValue.get(j).toString();
          expectOtherColumnValues += ", " + expectedValue.get(j).toString();
        }
```

### StringConcatenationInLoops
String concatenation `+=` in loop
in `pinot-common/src/main/java/org/apache/pinot/common/utils/SqlResultComparator.java`
#### Snippet
```java
        } else {
          actualOtherColumnValues += ", " + actualValue.get(j).toString();
          expectOtherColumnValues += ", " + expectedValue.get(j).toString();
        }
      }
```

### StringConcatenationInLoops
String concatenation `+=` in loop
in `pinot-common/src/main/java/org/apache/pinot/common/utils/request/RequestUtils.java`
#### Snippet
```java
      for (Expression operand : expression.getFunctionCall().getOperands()) {
        if (!isFirstParam) {
          res += ", ";
        } else {
          isFirstParam = false;
```

### StringConcatenationInLoops
String concatenation `+=` in loop
in `pinot-common/src/main/java/org/apache/pinot/common/utils/request/RequestUtils.java`
#### Snippet
```java
          isFirstParam = false;
        }
        res += prettyPrint(operand);
      }
      res += ")";
```

### StringConcatenationInLoops
String concatenation `+=` in loop
in `pinot-tools/src/main/java/org/apache/pinot/tools/QuickStartBase.java`
#### Snippet
```java
      String result = "[";
      for (int i = 0; i < arrayNode.size() - 1; i++) {
        result += jsonNode2String(arrayNode.get(i)) + ", ";
      }
      if (arrayNode.size() > 0) {
```

### StringConcatenationInLoops
String concatenation `+=` in loop
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/OperateClusterConfigCommand.java`
#### Snippet
```java
          String key = fieldNamesIterator.next();
          String value = jsonNode.get(key).textValue();
          results += String.format("%s=%s\n", key, value);
        }
        return results;
```

### StringConcatenationInLoops
String concatenation `+` in loop
in `pinot-tools/src/main/java/org/apache/pinot/tools/anonymizer/PinotDataAndQueryAnonymizer.java`
#### Snippet
```java

      if (fieldSpec.isSingleValueField()) {
        prefix = prefix + "_SV";
      } else {
        prefix = prefix + "_MV";
```

### StringConcatenationInLoops
String concatenation `+` in loop
in `pinot-tools/src/main/java/org/apache/pinot/tools/anonymizer/PinotDataAndQueryAnonymizer.java`
#### Snippet
```java
        prefix = prefix + "_SV";
      } else {
        prefix = prefix + "_MV";
      }

```

## RuleId[id=UnusedAssignment]
### UnusedAssignment
The value `segmentsToPush.size()` assigned to `pushParallelism` is never used
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-hadoop/src/main/java/org/apache/pinot/plugin/ingestion/batch/hadoop/HadoopSegmentMetadataPushJobRunner.java`
#### Snippet
```java
    int pushParallelism = _spec.getPushJobSpec().getPushParallelism();
    if (pushParallelism < 1) {
      pushParallelism = segmentsToPush.size();
    }
    // Push from driver
```

### UnusedAssignment
The value `segmentsToPush.size()` assigned to `pushParallelism` is never used
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-hadoop/src/main/java/org/apache/pinot/plugin/ingestion/batch/hadoop/HadoopSegmentTarPushJobRunner.java`
#### Snippet
```java
    int pushParallelism = _spec.getPushJobSpec().getPushParallelism();
    if (pushParallelism < 1) {
      pushParallelism = segmentsToPush.size();
    }
    // Push from driver
```

### UnusedAssignment
Variable `serverInstances` initializer `new HashSet<>()` is redundant
in `pinot-query-planner/src/main/java/org/apache/pinot/query/routing/WorkerManager.java`
#### Snippet
```java
    // all of the tables in the query.
    // TODO: actually make assignment strategy decisions for intermediate stages
    Set<ServerInstance> serverInstances = new HashSet<>();
    if (tableNames.size() == 0) {
      // This could be the case from queries that don't actually fetch values from the tables. In such cases the
```

### UnusedAssignment
Variable `exchange` initializer `null` is redundant
in `pinot-query-planner/src/main/java/org/apache/calcite/rel/rules/PinotAggregateExchangeNodeInsertRule.java`
#### Snippet
```java
    // 2. attach exchange.
    List<Integer> groupSetIndices = ImmutableIntList.range(0, oldAggRel.getGroupCount());
    LogicalExchange exchange = null;
    if (groupSetIndices.size() == 0) {
      exchange = LogicalExchange.create(newLeafAgg, RelDistributions.hash(Collections.emptyList()));
```

### UnusedAssignment
Variable `magic` initializer `0` is redundant
in `pinot-spi/src/main/java/org/apache/pinot/spi/data/readers/RecordReaderUtils.java`
#### Snippet
```java
  public static boolean isGZippedFile(File file)
      throws IOException {
    int magic = 0;
    try (RandomAccessFile raf = new RandomAccessFile(file, "r")) {
      magic = raf.read() & 0xff | ((raf.read() << 8) & 0xff00);
```

### UnusedAssignment
Variable `replication` initializer `0` is redundant
in `pinot-spi/src/main/java/org/apache/pinot/spi/config/table/TableConfig.java`
#### Snippet
```java
  @JsonIgnore
  public int getReplication() {
    int replication = 0;
    if (_tableType == TableType.REALTIME) {
      StreamConfig streamConfig = new StreamConfig(_tableName, IngestionConfigUtils.getStreamConfigMap(this));
```

### UnusedAssignment
Variable `_length` initializer `-1` is redundant
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/StreamMessage.java`
#### Snippet
```java
  private final T _value;
  protected final StreamMessageMetadata _metadata;
  int _length = -1;

  public StreamMessage(@Nullable byte[] key, T value, @Nullable StreamMessageMetadata metadata, int length) {
```

### UnusedAssignment
Variable `tableType` initializer `null` is redundant
in `pinot-core/src/main/java/org/apache/pinot/core/query/reduce/ExecutionStatsAggregator.java`
#### Snippet
```java
    }

    TableType tableType = null;
    String instanceName = null;
    if (routingInstance != null) {
```

### UnusedAssignment
Variable `instanceName` initializer `null` is redundant
in `pinot-core/src/main/java/org/apache/pinot/core/query/reduce/ExecutionStatsAggregator.java`
#### Snippet
```java

    TableType tableType = null;
    String instanceName = null;
    if (routingInstance != null) {
      tableType = routingInstance.getTableType();
```

### UnusedAssignment
Variable `bitmap` initializer `null` is redundant
in `pinot-core/src/main/java/org/apache/pinot/core/operator/transform/function/ScalarTransformFunctionWrapper.java`
#### Snippet
```java
      PinotDataType parameterType = parameterTypes[_nonLiteralIndices[i]];
      TransformFunction transformFunction = _nonLiteralFunctions[i];
      RoaringBitmap bitmap = null;
      switch (parameterType) {
        case INTEGER:
```

### UnusedAssignment
Variable `segmentUploader` initializer `null` is redundant
in `pinot-core/src/main/java/org/apache/pinot/server/realtime/ServerSegmentCompletionProtocolHandler.java`
#### Snippet
```java
    }

    Server2ControllerSegmentUploader segmentUploader = null;
    try {
      segmentUploader =
```

### UnusedAssignment
Variable `_enableKeyValueStitch` initializer `false` is redundant
in `pinot-plugins/pinot-stream-ingestion/pinot-pulsar/src/main/java/org/apache/pinot/plugin/stream/pulsar/PulsarPartitionLevelConsumer.java`
#### Snippet
```java
  private final ExecutorService _executorService;
  private final Reader _reader;
  private boolean _enableKeyValueStitch = false;

  public PulsarPartitionLevelConsumer(String clientId, StreamConfig streamConfig,
```

### UnusedAssignment
Variable `_columnDataTypes` initializer `new HashMap<>()` is redundant
in `pinot-clients/pinot-jdbc-client/src/main/java/org/apache/pinot/client/PinotResultMetadata.java`
#### Snippet
```java
  private int _totalColumns;
  private Map<Integer, String> _columns = new HashMap<>();
  private Map<Integer, String> _columnDataTypes = new HashMap<>();

  public PinotResultMetadata(int totalColumns, Map<String, Integer> columnsNameToIndex,
```

### UnusedAssignment
Variable `schemaAndUnrecognizedProps` initializer `null` is redundant
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotSchemaRestletResource.java`
#### Snippet
```java
      @ApiParam(value = "Whether to reload the table if the new schema is backward compatible") @DefaultValue("false")
      @QueryParam("reload") boolean reload, String schemaJsonString) {
    Pair<Schema, Map<String, Object>> schemaAndUnrecognizedProps = null;
    try {
      schemaAndUnrecognizedProps = JsonUtils.stringToObjectAndUnrecognizedProperties(schemaJsonString, Schema.class);
```

### UnusedAssignment
Variable `schemaAndUnrecognizedProperties` initializer `null` is redundant
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotSchemaRestletResource.java`
#### Snippet
```java
      @Context HttpHeaders httpHeaders,
      @Context Request request) {
    Pair<Schema, Map<String, Object>> schemaAndUnrecognizedProperties = null;
    try {
      schemaAndUnrecognizedProperties =
```

### UnusedAssignment
Variable `schemaAndUnrecognizedProps` initializer `null` is redundant
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotSchemaRestletResource.java`
#### Snippet
```java
  @ManualAuthorization // performed after parsing schema
  public String validateSchema(String schemaJsonString, @Context HttpHeaders httpHeaders, @Context Request request) {
    Pair<Schema, Map<String, Object>> schemaAndUnrecognizedProps = null;
    try {
      schemaAndUnrecognizedProps = JsonUtils.stringToObjectAndUnrecognizedProperties(schemaJsonString, Schema.class);
```

### UnusedAssignment
Variable `tableSizeDetails` initializer `null` is redundant
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/TableSize.java`
#### Snippet
```java
    TableSizeReader tableSizeReader =
        new TableSizeReader(_executor, _connectionManager, _controllerMetrics, _pinotHelixResourceManager);
    TableSizeReader.TableSizeDetails tableSizeDetails = null;
    try {
      tableSizeDetails =
```

### UnusedAssignment
Variable `userExist` initializer `false` is redundant
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotAccessControlUserRestletResource.java`
#### Snippet
```java
        try {

            boolean userExist = false;
            userExist = _pinotHelixResourceManager.hasUser(username, componentTypeStr);

```

### UnusedAssignment
Variable `segmentMetadata` initializer `null` is redundant
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotSegmentRestletResource.java`
#### Snippet
```java
      @ApiParam(value = "Columns name", allowMultiple = true) @QueryParam("columns") List<String> columns) {
    segmentName = URIUtils.decode(segmentName);
    Map<String, String> segmentMetadata = null;
    if (TableNameBuilder.getTableTypeFromTableName(tableName) != null) {
      segmentMetadata = getSegmentMetadataInternal(tableName, segmentName);
```

### UnusedAssignment
Variable `tableExist` initializer `false` is redundant
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotTableRestletResource.java`
#### Snippet
```java
    List<String> tablesDeleted = new LinkedList<>();
    try {
      boolean tableExist = false;
      if (verifyTableType(tableName, tableType, TableType.OFFLINE)) {
        tableExist = _pinotHelixResourceManager.hasOfflineTable(tableName);
```

### UnusedAssignment
Variable `ingestionStatus` initializer `null` is redundant
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotTableRestletResource.java`
#### Snippet
```java
            Response.Status.BAD_REQUEST);
      }
      TableStatus.IngestionStatus ingestionStatus = null;
      if (TableType.OFFLINE == tableType) {
        ingestionStatus =
```

### UnusedAssignment
Variable `exists` initializer `false` is redundant
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/minion/PinotTaskManager.java`
#### Snippet
```java
  private void scheduleJob(String tableWithType, String taskType, String cronExprStr)
      throws SchedulerException {
    boolean exists = false;
    try {
      exists = _scheduler.checkExists(JobKey.jobKey(tableWithType, taskType));
```

### UnusedAssignment
Variable `response` initializer `null` is redundant
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/realtime/SegmentCompletionManager.java`
#### Snippet
```java
    private SegmentCompletionProtocol.Response committerNotifiedCommit(String instanceId,
        StreamPartitionMsgOffset offset, long now) {
      SegmentCompletionProtocol.Response response = null;
      response = checkBadCommitRequest(instanceId, offset, now);
      if (response != null) {
```

### UnusedAssignment
Variable `adminName` initializer `null` is redundant
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/PinotHelixResourceManager.java`
#### Snippet
```java
    }

    String adminName = null;
    try {
      adminName = InetAddress.getLocalHost().getCanonicalHostName() + "-ADMIN";
```

### UnusedAssignment
Variable `svColRawSizePerDoc` initializer `0` is redundant
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/rules/impl/NoDictionaryOnHeapDictionaryJointRule.java`
#### Snippet
```java
      double withDictSize;

      long svColRawSizePerDoc = 0;
      try {
        svColRawSizePerDoc = _input.getColRawSizePerDoc(colName);
```

### UnusedAssignment
Variable `line` initializer `null` is redundant
in `pinot-connectors/pinot-flink-connector/src/main/java/org/apache/pinot/connector/flink/FlinkQuickStart.java`
#### Snippet
```java
    final URL resource = classLoader.getResource("starbucks-stores-world.csv");
    try (BufferedReader br = new BufferedReader(new InputStreamReader(resource.openStream()))) {
      String line = null;
      while ((line = br.readLine()) != null) {
        // split by comma, but in quotes
```

### UnusedAssignment
Variable `existingTotalDoc` initializer `0` is redundant
in `pinot-compatibility-verifier/src/main/java/org/apache/pinot/compat/StreamOp.java`
#### Snippet
```java
          JsonUtils.fileToObject(new File(getAbsoluteFileName(_tableConfigFileName)), TableConfig.class);
      String tableName = tableConfig.getTableName();
      long existingTotalDoc = 0;

      // get original rows
```

### UnusedAssignment
Variable `schemaUpdateFailed` initializer `false` is redundant
in `pinot-plugins/pinot-input-format/pinot-avro/src/main/java/org/apache/pinot/plugin/inputformat/avro/KafkaAvroMessageDecoder.java`
#### Snippet
```java
    System.arraycopy(payload, SCHEMA_HASH_START_OFFSET + offset, _reusableMD5Bytes, 0, SCHEMA_HASH_LENGTH);

    boolean schemaUpdateFailed = false;
    org.apache.avro.Schema schema = _md5ToAvroSchemaMap.getSchema(_reusableMD5Bytes);
    if (schema == null) {
```

### UnusedAssignment
The value `true` assigned to `schemaUpdateFailed` is never used
in `pinot-plugins/pinot-input-format/pinot-avro/src/main/java/org/apache/pinot/plugin/inputformat/avro/KafkaAvroMessageDecoder.java`
#### Snippet
```java
            LOGGER
                .error("Error fetching schema using url {}. Attempting to continue with previous schema", schemaUri, e);
            schemaUpdateFailed = true;
          }
        } else {
```

### UnusedAssignment
Variable `srcHostsList` initializer `null` is redundant
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/MoveReplicaGroup.java`
#### Snippet
```java

    File srcFile = new File(_srcHosts);
    List<String> srcHostsList = null;
    if (srcFile.exists()) {
      srcHostsList = readHostsFromFile(_srcHosts);
```

### UnusedAssignment
Variable `s` initializer `0` is redundant
in `pinot-tools/src/main/java/org/apache/pinot/tools/utils/JarUtils.java`
#### Snippet
```java
          byte[] buffer = new byte[8 * 1024];

          int s = 0;
          while ((s = in.read(buffer)) > 0) {
            out.write(buffer, 0, s);
```

### UnusedAssignment
Variable `_schema` initializer `null` is redundant
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/creator/SegmentGeneratorConfig.java`
#### Snippet
```java
  private String _segmentEndTime = null;
  private SegmentVersion _segmentVersion = SegmentVersion.v3;
  private Schema _schema = null;
  private FSTType _fstTypeForFSTIndex = FSTType.LUCENE;
  private RecordReaderConfig _readerConfig = null;
```

### UnusedAssignment
Variable `singleStageBrokerRequestHandler` initializer `null` is redundant
in `pinot-broker/src/main/java/org/apache/pinot/broker/broker/helix/BaseBrokerStarter.java`
#### Snippet
```java
    String brokerRequestHandlerType =
        _brokerConf.getProperty(Broker.BROKER_REQUEST_HANDLER_TYPE, Broker.DEFAULT_BROKER_REQUEST_HANDLER_TYPE);
    BrokerRequestHandler singleStageBrokerRequestHandler = null;
    if (brokerRequestHandlerType.equalsIgnoreCase(Broker.GRPC_BROKER_REQUEST_HANDLER_TYPE)) {
      singleStageBrokerRequestHandler =
```

### UnusedAssignment
Variable `interval` initializer `null` is redundant
in `pinot-broker/src/main/java/org/apache/pinot/broker/routing/segmentpruner/TimeSegmentPruner.java`
#### Snippet
```java
    while (i < size1 || j < size2) {
      // Get the `smaller` interval
      Interval interval = null;
      if (j == size2 || i < size1 && intervals1.get(i).compareTo(intervals2.get(j)) <= 0) {
        interval = intervals1.get(i++);
```

### UnusedAssignment
Variable `encodedUrl` initializer `null` is redundant
in `pinot-plugins/pinot-file-system/pinot-s3/src/main/java/org/apache/pinot/plugin/filesystem/S3PinotFS.java`
#### Snippet
```java
    try {
      HeadObjectResponse s3ObjectMetadata = getS3ObjectMetadata(uri);
      String encodedUrl = null;
      try {
        encodedUrl = URLEncoder.encode(uri.getHost() + uri.getPath(), StandardCharsets.UTF_8.toString());
```

### UnusedAssignment
Variable `encodedUrl` initializer `null` is redundant
in `pinot-plugins/pinot-file-system/pinot-s3/src/main/java/org/apache/pinot/plugin/filesystem/S3PinotFS.java`
#### Snippet
```java
      throws IOException {
    try {
      String encodedUrl = null;
      try {
        encodedUrl = URLEncoder.encode(srcUri.getHost() + srcUri.getPath(), StandardCharsets.UTF_8.toString());
```

### UnusedAssignment
Variable `packed` initializer `0` is redundant
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/util/PinotDataBitSetV2.java`
#### Snippet
```java
      long byteOffset = bitOffset / Byte.SIZE;
      bitOffset = bitOffset & 7;
      int packed = 0;
      int i = 0;

```

### UnusedAssignment
Variable `packed` initializer `0` is redundant
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/util/PinotDataBitSetV2.java`
#### Snippet
```java
      long byteOffset = bitOffset / Byte.SIZE;
      int i = 0;
      int packed = 0;

      /*
```

### UnusedAssignment
Variable `a` initializer `null` is redundant
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/automaton/RegExp.java`
#### Snippet
```java
      throws IllegalArgumentException {
    List<Automaton> list;
    Automaton a = null;
    switch (_kind) {
      case REGEXP_UNION:
```

### UnusedAssignment
Variable `recordReadStartTime` initializer `System.currentTimeMillis()` is redundant
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/creator/impl/SegmentIndexCreationDriverImpl.java`
#### Snippet
```java
      TransformPipeline.Result reusedResult = new TransformPipeline.Result();
      while (_recordReader.hasNext()) {
        long recordReadStartTime = System.currentTimeMillis();
        long recordReadStopTime = System.currentTimeMillis();
        long indexStopTime;
```

### UnusedAssignment
Variable `recordReadStopTime` initializer `System.currentTimeMillis()` is redundant
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/creator/impl/SegmentIndexCreationDriverImpl.java`
#### Snippet
```java
      while (_recordReader.hasNext()) {
        long recordReadStartTime = System.currentTimeMillis();
        long recordReadStopTime = System.currentTimeMillis();
        long indexStopTime;
        reuse.clear();
```

### UnusedAssignment
The value `new File(indexDirURI)` assigned to `localIndexDir` is never used
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/indexsegment/immutable/ImmutableSegmentLoader.java`
#### Snippet
```java
    File localIndexDir = null;
    if (scheme != null && scheme.equalsIgnoreCase("file")) {
      localIndexDir = new File(indexDirURI);
    }

```

## RuleId[id=SuspiciousNameCombination]
### SuspiciousNameCombination
'y' should probably not be passed as parameter 'x'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/automaton/BasicAutomata.java`
#### Snippet
```java
      } else { // cx<cy
        s.addTransition(new Transition(cx, atLeast(x, n + 1, initials, zeros && cx == '0')));
        s.addTransition(new Transition(cy, atMost(y, n + 1)));
        if (cx + 1 < cy) {
          s.addTransition(new Transition((char) (cx + 1), (char) (cy - 1), anyOfRightLength(x, n + 1)));
```

## RuleId[id=JavadocReference]
### JavadocReference
Cannot resolve symbol `JavaTypeFactoryImpl`
in `pinot-query-planner/src/main/java/org/apache/pinot/query/type/TypeFactory.java`
#### Snippet
```java
 * Extends Java-base TypeFactory from Calcite.
 *
 * <p>{@link JavaTypeFactoryImpl} is used here because we are not overriding much of the TypeFactory methods
 * required by Calcite. We will start extending {@link SqlTypeFactoryImpl} or even {@link RelDataTypeFactory}
 * when necessary for Pinot to override such mechanism.
```

### JavadocReference
Cannot resolve symbol `SqlTypeFactoryImpl`
in `pinot-query-planner/src/main/java/org/apache/pinot/query/type/TypeFactory.java`
#### Snippet
```java
 *
 * <p>{@link JavaTypeFactoryImpl} is used here because we are not overriding much of the TypeFactory methods
 * required by Calcite. We will start extending {@link SqlTypeFactoryImpl} or even {@link RelDataTypeFactory}
 * when necessary for Pinot to override such mechanism.
 *
```

### JavadocReference
Cannot resolve symbol `RelDataTypeFactory`
in `pinot-query-planner/src/main/java/org/apache/pinot/query/type/TypeFactory.java`
#### Snippet
```java
 *
 * <p>{@link JavaTypeFactoryImpl} is used here because we are not overriding much of the TypeFactory methods
 * required by Calcite. We will start extending {@link SqlTypeFactoryImpl} or even {@link RelDataTypeFactory}
 * when necessary for Pinot to override such mechanism.
 *
```

### JavadocReference
Cannot resolve symbol `JavaTypeFactoryImpl`
in `pinot-query-planner/src/main/java/org/apache/pinot/query/type/TypeFactory.java`
#### Snippet
```java
 * when necessary for Pinot to override such mechanism.
 *
 * <p>Noted that {@link JavaTypeFactoryImpl} is subject to change. Please pay extra attention to this class when
 * upgrading Calcite versions.
 */
```

### JavadocReference
Cannot resolve symbol `SqlNode`
in `pinot-query-planner/src/main/java/org/apache/pinot/query/parser/QueryRewriter.java`
#### Snippet
```java
   *
   * It should be functionally identical to running {@link org.apache.pinot.sql.parsers.rewriter.QueryRewriter}.
   * But it operates on a {@link SqlNode} tree instead of a flat pinot query object.
   *
   * @param sqlNodeRoot root of the sqlNode tree
```

### JavadocReference
Cannot resolve symbol `RelDataType`
in `pinot-query-planner/src/main/java/org/apache/pinot/query/catalog/PinotTable.java`
#### Snippet
```java
 *
 * <p>This construct is used to connect a Pinot table to Apache Calcite's relational planner by providing a
 * {@link RelDataType} of the table to the planner.
 */
public class PinotTable extends AbstractTable implements ScannableTable {
```

### JavadocReference
Cannot resolve symbol `Plan.ObjectField`
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/serde/ProtoSerializable.java`
#### Snippet
```java

  /**
   * Setting object's own member variable from a serialized {@link Plan.ObjectField}.
   * @param objFields the serialized ObjectField.
   */
```

### JavadocReference
Cannot resolve symbol `Plan.ObjectField`
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/serde/ProtoSerializable.java`
#### Snippet
```java

  /**
   * convert the object to a serialized {@link Plan.ObjectField}.
   * @return the serialized ObjectField.
   */
```

### JavadocReference
Cannot resolve symbol `Plan.ObjectField`
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/serde/ProtoSerializable.java`
#### Snippet
```java
 *
 * <p>Classes that implement {@code ProtoSerializable} should provide methods to convert to and from
 * {@link Plan.ObjectField}.
 */
public interface ProtoSerializable {
```

### JavadocReference
Cannot resolve symbol `org.apache.calcite.rel.RelNode`
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/stage/StageNode.java`
#### Snippet
```java

/**
 * Stage Node is a serializable version of the {@link org.apache.calcite.rel.RelNode}.
 *
 * TODO: stage node currently uses java.io.Serializable as its serialization format.
```

### JavadocReference
Cannot resolve symbol `org.apache.calcite.rex.RexNode`
in `pinot-query-planner/src/main/java/org/apache/pinot/query/parser/CalciteRexExpressionParser.java`
#### Snippet
```java
 *
 * <p>This class is extracted from {@link org.apache.pinot.sql.parsers.CalciteSqlParser}. It contains the logic
 * to parsed {@link org.apache.calcite.rex.RexNode}, in the format of {@link RexExpression} and convert them into
 * Thrift {@link Expression} format.
 */
```

### JavadocReference
Cannot resolve symbol `Plan.ObjectField`
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/serde/ProtoSerializationUtils.java`
#### Snippet
```java

  /**
   * Convert object into a proto {@link Plan.ObjectField}.
   *
   * @param object object to be converted.
```

### JavadocReference
Cannot resolve symbol `Plan.ObjectField`
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/serde/ProtoSerializationUtils.java`
#### Snippet
```java

  /**
   * Reflectively set object's field based on {@link Plan.ObjectField} provided.
   *
   * @param object the object to be set.
```

### JavadocReference
Cannot resolve symbol `HepPlanner`
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/logical/LogicalPlanner.java`
#### Snippet
```java

/**
 * The {@code LogicalPlanner} is an extended implementation of the Calcite's {@link HepPlanner}.
 */
public class LogicalPlanner extends HepPlanner {
```

### JavadocReference
Cannot resolve symbol `RelNode`
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/logical/RelToStageConverter.java`
#### Snippet
```java

/**
 * The {@code StageNodeConverter} converts a logical {@link RelNode} to a {@link StageNode}.
 */
public final class RelToStageConverter {
```

### JavadocReference
Cannot resolve symbol `org.apache.calcite.rel.type.RelDataTypeFactoryImpl`
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/logical/RelToStageConverter.java`
#### Snippet
```java
   * @param relDataType the DECIMAL rel data type.
   * @return proper {@link DataSchema.ColumnDataType}.
   * @see {@link org.apache.calcite.rel.type.RelDataTypeFactoryImpl#decimalOf}.
   */
  private static DataSchema.ColumnDataType resolveDecimal(RelDataType relDataType) {
```

### JavadocReference
Cannot resolve symbol `decimalOf`
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/logical/RelToStageConverter.java`
#### Snippet
```java
   * @param relDataType the DECIMAL rel data type.
   * @return proper {@link DataSchema.ColumnDataType}.
   * @see {@link org.apache.calcite.rel.type.RelDataTypeFactoryImpl#decimalOf}.
   */
  private static DataSchema.ColumnDataType resolveDecimal(RelDataType relDataType) {
```

### JavadocReference
Cannot resolve symbol `RelRoot`
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/logical/StagePlanner.java`
#### Snippet
```java

/**
 * QueryPlanMaker walks top-down from {@link RelRoot} and construct a forest of trees with {@link StageNode}.
 *
 * This class is non-threadsafe. Do not reuse the stage planner for multiple query plans.
```

### JavadocReference
Cannot resolve symbol `RexNode`
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/logical/RexExpression.java`
#### Snippet
```java

/**
 * {@code RexExpression} is the serializable format of the {@link RexNode}.
 */
public interface RexExpression {
```

### JavadocReference
Cannot resolve symbol `RelDistribution.Type`
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/logical/ShuffleRewriteVisitor.java`
#### Snippet
```java
  /**
   * This method rewrites {@code root} <b>in place</b>, removing any unnecessary shuffles
   * by replacing the distribution type with {@link RelDistribution.Type#SINGLETON}.
   *
   * @param root the root node of the tree to rewrite
```

### JavadocReference
Cannot resolve symbol `SINGLETON`
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/logical/ShuffleRewriteVisitor.java`
#### Snippet
```java
  /**
   * This method rewrites {@code root} <b>in place</b>, removing any unnecessary shuffles
   * by replacing the distribution type with {@link RelDistribution.Type#SINGLETON}.
   *
   * @param root the root node of the tree to rewrite
```

### JavadocReference
Cannot resolve symbol `RexInputRef`
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/physical/colocated/ColocationKey.java`
#### Snippet
```java
/**
 * ColocationKey describes how data is distributed in a given stage. It consists of a list of columns which are stored
 * as a list of {@link RexInputRef#getIndex()}, the number of partitions and the hash-algorithm used. A given stage may
 * have more than 1 ColocationKey, in which case one may use a {@link java.util.Set< ColocationKey >} to represent this
 * behavior.
```

### JavadocReference
Cannot resolve symbol `getIndex()`
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/physical/colocated/ColocationKey.java`
#### Snippet
```java
/**
 * ColocationKey describes how data is distributed in a given stage. It consists of a list of columns which are stored
 * as a list of {@link RexInputRef#getIndex()}, the number of partitions and the hash-algorithm used. A given stage may
 * have more than 1 ColocationKey, in which case one may use a {@link java.util.Set< ColocationKey >} to represent this
 * behavior.
```

### JavadocReference
Cannot resolve symbol `org.apache.calcite.sql.SqlKind`
in `pinot-query-planner/src/main/java/org/apache/calcite/sql/fun/PinotOperatorTable.java`
#### Snippet
```java
  /**
   * Initialize without duplicate, e.g. when 2 duplicate operator is linked with the same op
   * {@link org.apache.calcite.sql.SqlKind} it causes problem.
   *
   * <p>This is a direct copy of the {@link org.apache.calcite.sql.util.ReflectiveSqlOperatorTable} and can be hard to
```

### JavadocReference
Cannot resolve symbol `org.apache.calcite.sql.util.ReflectiveSqlOperatorTable`
in `pinot-query-planner/src/main/java/org/apache/calcite/sql/fun/PinotOperatorTable.java`
#### Snippet
```java
   * {@link org.apache.calcite.sql.SqlKind} it causes problem.
   *
   * <p>This is a direct copy of the {@link org.apache.calcite.sql.util.ReflectiveSqlOperatorTable} and can be hard to
   * debug, suggest changing to a non-dynamic registration. Dynamic function support should happen via catalog.
   */
```

### JavadocReference
Cannot resolve symbol `SqlOperator`
in `pinot-query-planner/src/main/java/org/apache/calcite/sql/fun/PinotOperatorTable.java`
#### Snippet
```java

/**
 * {@link PinotOperatorTable} defines the {@link SqlOperator} overrides on top of the {@link SqlStdOperatorTable}.
 *
 * <p>The main purpose of this Pinot specific SQL operator table is to
```

### JavadocReference
Cannot resolve symbol `AggregateReduceFunctionsRule`
in `pinot-query-planner/src/main/java/org/apache/calcite/rel/rules/PinotReduceAggregateFunctionsRule.java`
#### Snippet
```java
 *
 * <p>This implementation follows closely with Calcite's
 * {@link AggregateReduceFunctionsRule}.
 */
public class PinotReduceAggregateFunctionsRule extends RelOptRule {
```

### JavadocReference
Cannot resolve symbol `SqlStdOperatorTable`
in `pinot-query-planner/src/main/java/org/apache/calcite/sql/fun/PinotOperatorTable.java`
#### Snippet
```java

/**
 * {@link PinotOperatorTable} defines the {@link SqlOperator} overrides on top of the {@link SqlStdOperatorTable}.
 *
 * <p>The main purpose of this Pinot specific SQL operator table is to
```

### JavadocReference
Cannot resolve symbol `org.apache.calcite.prepare.Prepare.CatalogReader`
in `pinot-query-planner/src/main/java/org/apache/calcite/sql/fun/PinotOperatorTable.java`
#### Snippet
```java
 *   <li>Ensure that any specific SQL validation rules can apply with Pinot override entirely over Calcite's.</li>
 *   <li>Ability to create customer operators that are not function and cannot use
 *     {@link org.apache.calcite.prepare.Prepare.CatalogReader} to override</li>
 *   <li>Still maintain minimum customization and benefit from Calcite's original operator table setting.</li>
 * </ul>
```

### JavadocReference
Cannot resolve symbol `CalciteSchema`
in `pinot-query-planner/src/main/java/org/apache/calcite/jdbc/CalciteSchemaBuilder.java`
#### Snippet
```java

/**
 * This class is used to create a {@link CalciteSchema} with a given {@link Schema} as the root.
 *
 * <p>This class resides in calcite.jdbc namespace because there's no complex logic we have in terms of catalog-based
```

### JavadocReference
Cannot resolve symbol `Schema`
in `pinot-query-planner/src/main/java/org/apache/calcite/jdbc/CalciteSchemaBuilder.java`
#### Snippet
```java

/**
 * This class is used to create a {@link CalciteSchema} with a given {@link Schema} as the root.
 *
 * <p>This class resides in calcite.jdbc namespace because there's no complex logic we have in terms of catalog-based
```

### JavadocReference
Cannot resolve symbol `SimpleCalciteSchema`
in `pinot-query-planner/src/main/java/org/apache/calcite/jdbc/CalciteSchemaBuilder.java`
#### Snippet
```java
 *
 * <p>This class resides in calcite.jdbc namespace because there's no complex logic we have in terms of catalog-based
 * schema construct. We instead create a {@link SimpleCalciteSchema} that's package protected.
 */
public class CalciteSchemaBuilder {
```

### JavadocReference
Cannot resolve symbol `CalciteSchema`
in `pinot-query-planner/src/main/java/org/apache/calcite/jdbc/CalciteSchemaBuilder.java`
#### Snippet
```java

  /**
   * Creates a {@link CalciteSchema} with a given {@link Schema} as the root.
   *
   * <p>Calcite creates two layer of abstraction, the {@link CalciteSchema} is use internally for planner and
```

### JavadocReference
Cannot resolve symbol `Schema`
in `pinot-query-planner/src/main/java/org/apache/calcite/jdbc/CalciteSchemaBuilder.java`
#### Snippet
```java

  /**
   * Creates a {@link CalciteSchema} with a given {@link Schema} as the root.
   *
   * <p>Calcite creates two layer of abstraction, the {@link CalciteSchema} is use internally for planner and
```

### JavadocReference
Cannot resolve symbol `CalciteSchema`
in `pinot-query-planner/src/main/java/org/apache/calcite/jdbc/CalciteSchemaBuilder.java`
#### Snippet
```java
   * Creates a {@link CalciteSchema} with a given {@link Schema} as the root.
   *
   * <p>Calcite creates two layer of abstraction, the {@link CalciteSchema} is use internally for planner and
   * {@link Schema} is user-facing with overrides. In our case we don't have a complex internal wrapper extension
   * so we only reuse the package protected {@link SimpleCalciteSchema}.
```

### JavadocReference
Cannot resolve symbol `Schema`
in `pinot-query-planner/src/main/java/org/apache/calcite/jdbc/CalciteSchemaBuilder.java`
#### Snippet
```java
   *
   * <p>Calcite creates two layer of abstraction, the {@link CalciteSchema} is use internally for planner and
   * {@link Schema} is user-facing with overrides. In our case we don't have a complex internal wrapper extension
   * so we only reuse the package protected {@link SimpleCalciteSchema}.
   *
```

### JavadocReference
Cannot resolve symbol `SimpleCalciteSchema`
in `pinot-query-planner/src/main/java/org/apache/calcite/jdbc/CalciteSchemaBuilder.java`
#### Snippet
```java
   * <p>Calcite creates two layer of abstraction, the {@link CalciteSchema} is use internally for planner and
   * {@link Schema} is user-facing with overrides. In our case we don't have a complex internal wrapper extension
   * so we only reuse the package protected {@link SimpleCalciteSchema}.
   *
   * <p>If there's need to extend this feature for planner functionalities we should create our own extension to the
```

### JavadocReference
Cannot resolve symbol `CalciteSchema`
in `pinot-query-planner/src/main/java/org/apache/calcite/jdbc/CalciteSchemaBuilder.java`
#### Snippet
```java
   *
   * <p>If there's need to extend this feature for planner functionalities we should create our own extension to the
   * {@link CalciteSchema}.
   *
   * @param root schema to use as a root schema
```

### JavadocReference
Cannot resolve symbol `org.apache.calcite.sql.util.ChainedSqlOperatorTable`
in `pinot-query-planner/src/main/java/org/apache/calcite/sql/util/PinotChainedSqlOperatorTable.java`
#### Snippet
```java
/**
 * ============================================================================
 * THIS CLASS IS COPIED FROM Calcite's {@link org.apache.calcite.sql.util.ChainedSqlOperatorTable} and modified the
 * function lookup to terminate early once found from ordered SqlOperatorTable list. This is to avoid some
 * hard-coded casting assuming all Sql identifier looked-up are of the same SqlOperator type.
```

### JavadocReference
Cannot resolve symbol `SqlOperatorTable`
in `pinot-query-planner/src/main/java/org/apache/calcite/sql/util/PinotChainedSqlOperatorTable.java`
#### Snippet
```java
 * ============================================================================
 *
 * PinotChainedSqlOperatorTable implements the {@link SqlOperatorTable} interface by
 * chaining together any number of underlying operator table instances.
 */
```

### JavadocReference
Cannot resolve symbol `SqlOperatorTables`
in `pinot-query-planner/src/main/java/org/apache/calcite/sql/util/PinotChainedSqlOperatorTable.java`
#### Snippet
```java
  }

  /** Internal constructor; call {@link SqlOperatorTables#chain}. */
  protected PinotChainedSqlOperatorTable(ImmutableList<SqlOperatorTable> tableList) {
    _tableList = ImmutableList.copyOf(tableList);
```

### JavadocReference
Cannot resolve symbol `chain`
in `pinot-query-planner/src/main/java/org/apache/calcite/sql/util/PinotChainedSqlOperatorTable.java`
#### Snippet
```java
  }

  /** Internal constructor; call {@link SqlOperatorTables#chain}. */
  protected PinotChainedSqlOperatorTable(ImmutableList<SqlOperatorTable> tableList) {
    _tableList = ImmutableList.copyOf(tableList);
```

### JavadocReference
Cannot resolve symbol `org.apache.calcite.rel.rules.AggregateReduceFunctionsRule`
in `pinot-query-planner/src/main/java/org/apache/calcite/rel/rules/PinotAggregateExchangeNodeInsertRule.java`
#### Snippet
```java
 *
 * Pinot uses special intermediate data representation for partially aggregated results, thus we can't use
 * {@link org.apache.calcite.rel.rules.AggregateReduceFunctionsRule} to reduce complex aggregation.
 *
 * This rule is here to introduces Pinot-special aggregation splits. In-general, all aggregations are split into
```

### JavadocReference
Cannot resolve symbol `RelOptRuleCall`
in `pinot-query-planner/src/main/java/org/apache/calcite/rel/rules/PinotAggregateExchangeNodeInsertRule.java`
#### Snippet
```java
   * @see org.apache.pinot.core.query.aggregation.function.AggregationFunction
   *
   * @param call the {@link RelOptRuleCall} on match.
   */
  @Override
```

### JavadocReference
Cannot resolve symbol `org.apache.calcite.sql.SqlOperator`
in `pinot-query-planner/src/main/java/org/apache/calcite/prepare/PinotCalciteCatalogReader.java`
#### Snippet
```java
  }

  /** Converts a function to a {@link org.apache.calcite.sql.SqlOperator}. */
  private static SqlOperator toOp(SqlIdentifier name,
      final org.apache.calcite.schema.Function function) {
```

### JavadocReference
Cannot resolve symbol `ModelHandler`
in `pinot-query-planner/src/main/java/org/apache/calcite/prepare/PinotCalciteCatalogReader.java`
#### Snippet
```java
   * or classes.
   *
   * @see ModelHandler#addFunctions */
  public static SqlOperatorTable operatorTable(String... classNames) {
    // Dummy schema to collect the functions
```

### JavadocReference
Cannot resolve symbol `addFunctions`
in `pinot-query-planner/src/main/java/org/apache/calcite/prepare/PinotCalciteCatalogReader.java`
#### Snippet
```java
   * or classes.
   *
   * @see ModelHandler#addFunctions */
  public static SqlOperatorTable operatorTable(String... classNames) {
    // Dummy schema to collect the functions
```

### JavadocReference
Cannot resolve symbol `org.apache.calcite.prepare.CalciteCatalogReader`
in `pinot-query-planner/src/main/java/org/apache/calcite/prepare/PinotCalciteCatalogReader.java`
#### Snippet
```java
/**
 * ============================================================================
 * THIS CLASS IS COPIED FROM Calcite's {@link org.apache.calcite.prepare.CalciteCatalogReader} and modified the
 * case sensitivity of Function lookup. which is ALWAYS case-insensitive regardless of conventions on
 * column/table identifier.
```

### JavadocReference
Cannot resolve symbol `org.apache.calcite.prepare.Prepare.CatalogReader`
in `pinot-query-planner/src/main/java/org/apache/calcite/prepare/PinotCalciteCatalogReader.java`
#### Snippet
```java
 * ============================================================================
 *
 * Pinot's implementation of {@link org.apache.calcite.prepare.Prepare.CatalogReader}
 * and also {@link org.apache.calcite.sql.SqlOperatorTable} based on tables and
 * functions defined schemas.
```

### JavadocReference
Cannot resolve symbol `org.apache.calcite.sql.SqlOperatorTable`
in `pinot-query-planner/src/main/java/org/apache/calcite/prepare/PinotCalciteCatalogReader.java`
#### Snippet
```java
 *
 * Pinot's implementation of {@link org.apache.calcite.prepare.Prepare.CatalogReader}
 * and also {@link org.apache.calcite.sql.SqlOperatorTable} based on tables and
 * functions defined schemas.
 */
```

### JavadocReference
Cannot resolve symbol `org.apache.calcite.sql.SqlKind`
in `pinot-query-planner/src/main/java/org/apache/calcite/prepare/PinotCalciteCatalogReader.java`
#### Snippet
```java
  }

  /** Deduces the {@link org.apache.calcite.sql.SqlKind} of a user-defined
   * function based on a {@link Hints} annotation, if present. */
  private static SqlKind kind(org.apache.calcite.schema.Function function) {
```

### JavadocReference
Cannot resolve symbol `Hints`
in `pinot-query-planner/src/main/java/org/apache/calcite/prepare/PinotCalciteCatalogReader.java`
#### Snippet
```java

  /** Deduces the {@link org.apache.calcite.sql.SqlKind} of a user-defined
   * function based on a {@link Hints} annotation, if present. */
  private static SqlKind kind(org.apache.calcite.schema.Function function) {
    if (function instanceof ScalarFunctionImpl) {
```

### JavadocReference
Cannot resolve symbol `org.apache.pinot.spi.config.table.tuner.TableConfigTuner`
in `pinot-spi/src/main/java/org/apache/pinot/spi/config/table/TunerConfig.java`
#### Snippet
```java

/**
 * Encapsulates custom config for {@link org.apache.pinot.spi.config.table.tuner.TableConfigTuner}
 * The 'name' field specifies the exact type of tuner used for this table. This is used by the
 * controller to retrieve the specific implementation during table creation.
```

### JavadocReference
Cannot resolve symbol `SqlNode`
in `pinot-common/src/main/java/org/apache/pinot/sql/parsers/parser/UnparseUtils.java`
#### Snippet
```java

/**
 * {@code UnparseUtils} provides utility for unparsing keywords, {@link SqlNode} or {@link SqlNodeList} using provided
 * {@link SqlWriter}.
 *
```

### JavadocReference
Cannot resolve symbol `SqlNodeList`
in `pinot-common/src/main/java/org/apache/pinot/sql/parsers/parser/UnparseUtils.java`
#### Snippet
```java

/**
 * {@code UnparseUtils} provides utility for unparsing keywords, {@link SqlNode} or {@link SqlNodeList} using provided
 * {@link SqlWriter}.
 *
```

### JavadocReference
Cannot resolve symbol `SqlWriter`
in `pinot-common/src/main/java/org/apache/pinot/sql/parsers/parser/UnparseUtils.java`
#### Snippet
```java
/**
 * {@code UnparseUtils} provides utility for unparsing keywords, {@link SqlNode} or {@link SqlNodeList} using provided
 * {@link SqlWriter}.
 *
 * @see SqlNode#unparse(SqlWriter, int, int)
```

### JavadocReference
Cannot resolve symbol `SqlNode`
in `pinot-common/src/main/java/org/apache/pinot/sql/parsers/parser/UnparseUtils.java`
#### Snippet
```java
 * {@link SqlWriter}.
 *
 * @see SqlNode#unparse(SqlWriter, int, int)
 */
class UnparseUtils {
```

### JavadocReference
Cannot resolve symbol `unparse(SqlWriter, int, int)`
in `pinot-common/src/main/java/org/apache/pinot/sql/parsers/parser/UnparseUtils.java`
#### Snippet
```java
 * {@link SqlWriter}.
 *
 * @see SqlNode#unparse(SqlWriter, int, int)
 */
class UnparseUtils {
```

### JavadocReference
Cannot resolve symbol `SqlWriter`
in `pinot-common/src/main/java/org/apache/pinot/sql/parsers/parser/UnparseUtils.java`
#### Snippet
```java
 * {@link SqlWriter}.
 *
 * @see SqlNode#unparse(SqlWriter, int, int)
 */
class UnparseUtils {
```

### JavadocReference
Cannot resolve symbol `ZNRecord`
in `pinot-common/src/main/java/org/apache/pinot/common/utils/SchemaUtils.java`
#### Snippet
```java

  /**
   * Wrap {@link Schema} into a {@link ZNRecord}.
   */
  public static ZNRecord toZNRecord(@Nonnull Schema schema) {
```

### JavadocReference
Cannot resolve symbol `ZNRecord`
in `pinot-common/src/main/java/org/apache/pinot/common/utils/SchemaUtils.java`
#### Snippet
```java

  /**
   * Fetch {@link Schema} from a {@link ZNRecord}.
   */
  public static Schema fromZNRecord(@Nonnull ZNRecord record)
```

### JavadocReference
Cannot resolve symbol `HttpEntity`
in `pinot-common/src/main/java/org/apache/pinot/common/utils/http/HttpClient.java`
#### Snippet
```java
   * Deprecated due to lack of auth header support. May break for deployments with auth enabled
   *
   * @see #sendPutRequest(URI, HttpEntity, Map, AuthProvider)
   */
  public SimpleHttpResponse sendPutRequest(URI uri, @Nullable HttpEntity payload, @Nullable Map<String, String> headers)
```

### JavadocReference
Cannot resolve symbol `CloseableHttpClient`
in `pinot-common/src/main/java/org/apache/pinot/common/utils/http/HttpClient.java`
#### Snippet
```java

/**
 * The {@code HTTPClient} wraps around a {@link CloseableHttpClient} to provide a reusable client for making
 * HTTP requests.
 */
```

### JavadocReference
Cannot resolve symbol `HttpEntity`
in `pinot-common/src/main/java/org/apache/pinot/common/utils/http/HttpClient.java`
#### Snippet
```java
   * Deprecated due to lack of auth header support. May break for deployments with auth enabled
   *
   * @see #sendPostRequest(URI, HttpEntity, Map, AuthProvider)
   */
  public SimpleHttpResponse sendPostRequest(URI uri, @Nullable HttpEntity payload,
```

### JavadocReference
Cannot resolve symbol `HelixManager`
in `pinot-common/src/main/java/org/apache/pinot/common/utils/helix/HelixHelper.java`
#### Snippet
```java
   * Returns the enabled instances in the cluster with the given tag.
   *
   * TODO: refactor code to use this method over {@link #getEnabledInstancesWithTag(HelixManager, String)} if applicable
   * to reuse instance configs in order to reduce ZK accesses
   */
```

### JavadocReference
Cannot resolve symbol `HelixManager`
in `pinot-common/src/main/java/org/apache/pinot/common/utils/helix/HelixHelper.java`
#### Snippet
```java
   * Returns the instances in the cluster with the given tag.
   *
   * TODO: refactor code to use this method over {@link #getInstancesWithTag(HelixManager, String)} if applicable to
   * reuse instance configs in order to reduce ZK accesses
   */
```

### JavadocReference
Cannot resolve symbol `ZNRecord`
in `pinot-common/src/main/java/org/apache/pinot/common/minion/BaseTaskMetadata.java`
#### Snippet
```java

  /**
   * @return {@link ZNRecord} containing the task metadata
   */
  public abstract ZNRecord toZNRecord();
```

### JavadocReference
Cannot resolve symbol `ArrayUtils`
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/ArrayFunctions.java`
#### Snippet
```java

/**
 * Inbuilt array scalar functions. See {@link ArrayUtils} for details.
 */
public class ArrayFunctions {
```

### JavadocReference
Cannot resolve symbol `StringUtils`
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java

  /**
   * @see StringUtils#reverse(String)
   * @param input
   * @return reversed input in from end to start
```

### JavadocReference
Cannot resolve symbol `reverse(String)`
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java

  /**
   * @see StringUtils#reverse(String)
   * @param input
   * @return reversed input in from end to start
```

### JavadocReference
Cannot resolve symbol `StringUtils`
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java

  /**
   * @see StringUtils#startsWith(CharSequence, CharSequence)
   * @param input
   * @param prefix substring to check if it is the prefix
```

### JavadocReference
Cannot resolve symbol `startsWith(CharSequence, CharSequence)`
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java

  /**
   * @see StringUtils#startsWith(CharSequence, CharSequence)
   * @param input
   * @param prefix substring to check if it is the prefix
```

### JavadocReference
Cannot resolve symbol `StringUtils`
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java

  /**
   * @see StringUtils#endsWith(CharSequence, CharSequence)
   * @param input
   * @param suffix substring to check if it is the prefix
```

### JavadocReference
Cannot resolve symbol `endsWith(CharSequence, CharSequence)`
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java

  /**
   * @see StringUtils#endsWith(CharSequence, CharSequence)
   * @param input
   * @param suffix substring to check if it is the prefix
```

### JavadocReference
Cannot resolve symbol `StringUtils`
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java

  /**
   * @see StringUtils#right(String, int)
   * @param input
   * @return get substring ending at the last index with specified length
```

### JavadocReference
Cannot resolve symbol `right(String, int)`
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java

  /**
   * @see StringUtils#right(String, int)
   * @param input
   * @return get substring ending at the last index with specified length
```

### JavadocReference
Cannot resolve symbol `StringUtils`
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java

  /**
   * @see StringUtils#repeat(String, String, int)
   * @param input
   * @param times
```

### JavadocReference
Cannot resolve symbol `repeat(String, String, int)`
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java

  /**
   * @see StringUtils#repeat(String, String, int)
   * @param input
   * @param times
```

### JavadocReference
Cannot resolve symbol `StringUtils`
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java

  /**
   * @see StringUtils#left(String, int)
   * @param input
   * @return get substring starting from the first index and extending upto specified length.
```

### JavadocReference
Cannot resolve symbol `left(String, int)`
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java

  /**
   * @see StringUtils#left(String, int)
   * @param input
   * @return get substring starting from the first index and extending upto specified length.
```

### JavadocReference
Cannot resolve symbol `StringUtils`
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java

  /**
   * @see StringUtils#repeat(char, int)
   * @param input
   * @param times
```

### JavadocReference
Cannot resolve symbol `repeat(char, int)`
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java

  /**
   * @see StringUtils#repeat(char, int)
   * @param input
   * @param times
```

### JavadocReference
Cannot resolve symbol `StringUtils`
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java

  /**
   * @see StringUtils#remove(String, String)
   * @param input
   * @param search
```

### JavadocReference
Cannot resolve symbol `remove(String, String)`
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java

  /**
   * @see StringUtils#remove(String, String)
   * @param input
   * @param search
```

### JavadocReference
Cannot resolve symbol `StringUtils`
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java

  /**
   * @see StringUtils#indexOf(CharSequence, CharSequence)
   * Return the 1st occurence of a substring within the String
   * @param input
```

### JavadocReference
Cannot resolve symbol `indexOf(CharSequence, CharSequence)`
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java

  /**
   * @see StringUtils#indexOf(CharSequence, CharSequence)
   * Return the 1st occurence of a substring within the String
   * @param input
```

### JavadocReference
Cannot resolve symbol `StringUtils`
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java

  /**
   * @see StringUtils#leftPad(String, int, char)
   * @param input
   * @param size final size of the string
```

### JavadocReference
Cannot resolve symbol `leftPad(String, int, char)`
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java

  /**
   * @see StringUtils#leftPad(String, int, char)
   * @param input
   * @param size final size of the string
```

### JavadocReference
Cannot resolve symbol `StringUtils`
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java

  /**
   * @see StringUtils#lastIndexOf(CharSequence, CharSequence, int)
   * Return the Nth occurence of a substring in string starting from the end of the string.
   * @param input
```

### JavadocReference
Cannot resolve symbol `lastIndexOf(CharSequence, CharSequence, int)`
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java

  /**
   * @see StringUtils#lastIndexOf(CharSequence, CharSequence, int)
   * Return the Nth occurence of a substring in string starting from the end of the string.
   * @param input
```

### JavadocReference
Cannot resolve symbol `StringUtils`
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java

  /**
   * @see StringUtils#rightPad(String, int, char)
   * @param input
   * @param size final size of the string
```

### JavadocReference
Cannot resolve symbol `rightPad(String, int, char)`
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java

  /**
   * @see StringUtils#rightPad(String, int, char)
   * @param input
   * @param size final size of the string
```

### JavadocReference
Cannot resolve symbol `StringUtils`
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java

  /**
   * @see StringUtils#lastIndexOf(CharSequence, CharSequence)
   * Return the last occurence of a substring within the String
   * @param input
```

### JavadocReference
Cannot resolve symbol `lastIndexOf(CharSequence, CharSequence)`
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java

  /**
   * @see StringUtils#lastIndexOf(CharSequence, CharSequence)
   * Return the last occurence of a substring within the String
   * @param input
```

### JavadocReference
Cannot resolve symbol `StringUtils`
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java

  /**
   * @see StringUtils#ordinalIndexOf(CharSequence, CharSequence, int)
   * Return the Nth occurence of a substring within the String
   * @param input
```

### JavadocReference
Cannot resolve symbol `ordinalIndexOf(CharSequence, CharSequence, int)`
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java

  /**
   * @see StringUtils#ordinalIndexOf(CharSequence, CharSequence, int)
   * Return the Nth occurence of a substring within the String
   * @param input
```

### JavadocReference
Cannot resolve symbol `StringUtils`
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java

  /**
   * @see StringUtils#split(String, String)
   * @param input
   * @param delimiter
```

### JavadocReference
Cannot resolve symbol `split(String, String)`
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java

  /**
   * @see StringUtils#split(String, String)
   * @param input
   * @param delimiter
```

### JavadocReference
Cannot resolve symbol `ZkHelixPropertyStore`
in `pinot-common/src/main/java/org/apache/pinot/common/metadata/ZKMetadataProvider.java`
#### Snippet
```java

  /**
   * NOTE: this method is very expensive, use {@link #getSegments(ZkHelixPropertyStore, String)} instead if only segment
   * names are needed.
   */
```

### JavadocReference
Cannot resolve symbol `Roaring64NavigableMap`
in `pinot-core/src/main/java/org/apache/pinot/core/query/utils/idset/Roaring64NavigableMapIdSet.java`
#### Snippet
```java

/**
 * The {@code Roaring64NavigableMapIdSet} is an IdSet backed by the {@link Roaring64NavigableMap}, and can be used to
 * store LONG ids.
 */
```

### JavadocReference
Cannot resolve symbol `RoaringBitmap`
in `pinot-core/src/main/java/org/apache/pinot/core/query/utils/idset/RoaringBitmapIdSet.java`
#### Snippet
```java

/**
 * The {@code RoaringBitmapIdSet} is an IdSet backed by the {@link RoaringBitmap}, and can be used to store INT ids.
 */
public class RoaringBitmapIdSet implements IdSet {
```

### JavadocReference
Cannot resolve symbol `Pair`
in `pinot-core/src/main/java/org/apache/pinot/core/query/optimizer/statement/JsonStatementOptimizer.java`
#### Snippet
```java
   * @param outputDataType to keep track of output datatype of JSON_EXTRACT_SCALAR function which depends upon the outer
   *                 function that json path expression appears in.
   * @return A {@link Pair} of values where the first value is alias for the input expression and second
   * value indicates whether json path expression was found (true) or not (false) in the expression.
   */
```

### JavadocReference
Cannot resolve symbol `Group`
in `pinot-plugins/pinot-input-format/pinot-parquet/src/main/java/org/apache/pinot/plugin/inputformat/parquet/ParquetNativeRecordExtractor.java`
#### Snippet
```java

/**
 * ParquetNativeRecordExtractor extract values from Parquet {@link Group}.
 */
public class ParquetNativeRecordExtractor extends BaseRecordExtractor<Group> {
```

### JavadocReference
Cannot resolve symbol `HelixManager`
in `pinot-minion/src/main/java/org/apache/pinot/minion/executor/MinionTaskZkMetadataManager.java`
#### Snippet
```java

/**
 * An abstraction on top of {@link HelixManager}, created for the {@link PinotTaskExecutor}, restricted to only
 * get/update minion task metadata
 */
```

### JavadocReference
Cannot resolve symbol `TaskFactory`
in `pinot-minion/src/main/java/org/apache/pinot/minion/taskfactory/TaskFactoryRegistry.java`
#### Snippet
```java

/**
 * Registry for all {@link TaskFactory}.
 * <p>All {@link PinotTaskExecutor} in {@link TaskExecutorFactoryRegistry} will automatically be registered.
 */
```

### JavadocReference
Cannot resolve symbol `MessageId`
in `pinot-plugins/pinot-stream-ingestion/pinot-pulsar/src/main/java/org/apache/pinot/plugin/stream/pulsar/MessageIdStreamOffset.java`
#### Snippet
```java

/**
 * {@link StreamPartitionMsgOffset} implementation for Pulsar {@link MessageId}
 */
public class MessageIdStreamOffset implements StreamPartitionMsgOffset {
```

### JavadocReference
Cannot resolve symbol `Message`
in `pinot-plugins/pinot-stream-ingestion/pinot-pulsar/src/main/java/org/apache/pinot/plugin/stream/pulsar/PulsarStreamLevelConsumer.java`
#### Snippet
```java

  /**
   * Get next {@link GenericRow} after decoding pulsar {@link Message}
   */
  @Override
```

### JavadocReference
Cannot resolve symbol `PulsarClient`
in `pinot-plugins/pinot-stream-ingestion/pinot-pulsar/src/main/java/org/apache/pinot/plugin/stream/pulsar/PulsarPartitionLevelConnectionHandler.java`
#### Snippet
```java

  /**
   * Creates a new instance of {@link PulsarClient} and {@link Reader}
   */
  public PulsarPartitionLevelConnectionHandler(String clientId, StreamConfig streamConfig) {
```

### JavadocReference
Cannot resolve symbol `Reader`
in `pinot-plugins/pinot-stream-ingestion/pinot-pulsar/src/main/java/org/apache/pinot/plugin/stream/pulsar/PulsarPartitionLevelConnectionHandler.java`
#### Snippet
```java

  /**
   * Creates a new instance of {@link PulsarClient} and {@link Reader}
   */
  public PulsarPartitionLevelConnectionHandler(String clientId, StreamConfig streamConfig) {
```

### JavadocReference
Cannot resolve symbol `PulsarClientException`
in `pinot-plugins/pinot-stream-ingestion/pinot-pulsar/src/main/java/org/apache/pinot/plugin/stream/pulsar/PulsarStreamMetadataProvider.java`
#### Snippet
```java
   * If offset criteria is largest, the message id of the largest record in the partition is returned.
   * throws {@link IllegalArgumentException} if the offset criteria is invalid
   * throws {@link PulsarClientException} if there was an error from pulsar server on requesting message ids.
   * @param offsetCriteria offset criteria to fetch {@link StreamPartitionMsgOffset}.
   *                       Depends on the semantics of the stream e.g. smallest, largest for Kafka
```

### JavadocReference
Cannot resolve symbol `org.apache.pulsar.client.api.Reader`
in `pinot-plugins/pinot-stream-ingestion/pinot-pulsar/src/main/java/org/apache/pinot/plugin/stream/pulsar/PulsarMessageBatch.java`
#### Snippet
```java
   * the partition id is fixed for a particular partition.
   * We return entryId incremented by 1 while keeping ledgerId and partitionId as same.
   * If ledgerId has incremented, the {@link org.apache.pulsar.client.api.Reader} takes care of that during seek
   * operation
   * and returns the first record in the new ledger.
```

### JavadocReference
Cannot resolve symbol `org.apache.pulsar.client.api.Reader`
in `pinot-plugins/pinot-stream-ingestion/pinot-pulsar/src/main/java/org/apache/pinot/plugin/stream/pulsar/PulsarPartitionLevelConsumer.java`
#### Snippet
```java
  /**
   * Fetch records from the Pulsar stream between the start and end KinesisCheckpoint
   * Used {@link org.apache.pulsar.client.api.Reader} to read the messaged from pulsar partitioned topic
   * The reader seeks to the startMsgOffset and starts reading records in a loop until endMsgOffset or timeout is
   * reached.
```

### JavadocReference
Cannot resolve symbol `Reader`
in `pinot-plugins/pinot-stream-ingestion/pinot-pulsar/src/main/java/org/apache/pinot/plugin/stream/pulsar/PulsarStreamLevelConsumerManager.java`
#### Snippet
```java

  /**
   * Get {@link Reader} for {@link PulsarConfig}. If the reader is already created we return the instance, otherwise
   * a new reader is created.
   */
```

### JavadocReference
Cannot resolve symbol `Reader`
in `pinot-plugins/pinot-stream-ingestion/pinot-pulsar/src/main/java/org/apache/pinot/plugin/stream/pulsar/PulsarStreamLevelConsumerManager.java`
#### Snippet
```java

  /**
   *  remove the {@link Reader} from consumer pool after closing it.
   */
  public static void releasePulsarConsumer(final Reader<byte[]> pulsarConsumer) {
```

### JavadocReference
Cannot resolve symbol `HelixManager`
in `pinot-controller/src/main/java/org/apache/pinot/controller/LeadControllerManager.java`
#### Snippet
```java
   * Marks the cached indices invalid and isShuttingDown to be true.
   * Adding the synchronized block here and in the following callback methods
   * to make sure that {@link HelixManager} won't be closed when the callback changes happened.
   */
  public void stop() {
```

### JavadocReference
Cannot resolve symbol `HelixAdmin`
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/PinotHelixResourceManager.java`
#### Snippet
```java

  /**
   * This util is similar to {@link HelixAdmin#resetPartition(String, String, String, List)}.
   * However instead of resetting only the ERROR state to its initial state. we reset all state regardless.
   */
```

### JavadocReference
Cannot resolve symbol `resetPartition(String, String, String, List)`
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/PinotHelixResourceManager.java`
#### Snippet
```java

  /**
   * This util is similar to {@link HelixAdmin#resetPartition(String, String, String, List)}.
   * However instead of resetting only the ERROR state to its initial state. we reset all state regardless.
   */
```

### JavadocReference
Cannot resolve symbol `Row`
in `pinot-connectors/pinot-flink-connector/src/main/java/org/apache/pinot/connector/flink/common/FlinkRowGenericRowConverter.java`
#### Snippet
```java


/** Converts {@link Row} type data into {@link GenericRow} format. */
public class FlinkRowGenericRowConverter implements PinotGenericRowConverter<Row> {

```

### JavadocReference
Cannot resolve symbol `MutableRoaringBitmap`
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/index/mutable/ThreadSafeMutableRoaringBitmap.java`
#### Snippet
```java

/**
 * Helper wrapper class for {@link MutableRoaringBitmap} to make it thread-safe.
 */
public class ThreadSafeMutableRoaringBitmap {
```

### JavadocReference
Cannot resolve symbol `createIndexCreator(IndexCreationContext, Object)`
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/creator/IndexCreationContext.java`
#### Snippet
```java

/**
 * Provides parameters for constructing indexes via {@link IndexType#createIndexCreator(IndexCreationContext, Object)}.
 * The responsibility for ensuring that the correct parameters for a particular
 * index type lies with the caller.
```

### JavadocReference
Cannot resolve symbol `ZNRecord`
in `pinot-broker/src/main/java/org/apache/pinot/broker/routing/segmentmetadata/SegmentZkMetadataFetchListener.java`
#### Snippet
```java
 * Interface to register with {@link SegmentZkMetadataFetcher}.
 *
 * <p>When registered, SegmentZKMetadataFetcher will fetch {@link ZNRecord} for associated {@code onlineSegments} list
 * or refreshed {@code segment}. Thus batch up all ZK access for segment metadata.
 */
```

### JavadocReference
Cannot resolve symbol `ZNRecord`
in `pinot-broker/src/main/java/org/apache/pinot/broker/routing/segmentmetadata/SegmentZkMetadataFetcher.java`
#### Snippet
```java

/**
 * {@code SegmentZkMetadataFetcher} is used to cache {@link ZNRecord} stored in {@link ZkHelixPropertyStore} for
 * segments.
 */
```

### JavadocReference
Cannot resolve symbol `ZkHelixPropertyStore`
in `pinot-broker/src/main/java/org/apache/pinot/broker/routing/segmentmetadata/SegmentZkMetadataFetcher.java`
#### Snippet
```java

/**
 * {@code SegmentZkMetadataFetcher} is used to cache {@link ZNRecord} stored in {@link ZkHelixPropertyStore} for
 * segments.
 */
```

### JavadocReference
Cannot resolve symbol `org.apache.pinot.common.proto.Worker.StagePlan`
in `pinot-query-runtime/src/main/java/org/apache/pinot/query/runtime/plan/DistributedStagePlan.java`
#### Snippet
```java
/**
 * {@code DistributedStagePlan} is the deserialized version of the
 * {@link org.apache.pinot.common.proto.Worker.StagePlan}.
 *
 * <p>It is also the extended version of the {@link org.apache.pinot.core.query.request.ServerQueryRequest}.
```

### JavadocReference
Cannot resolve symbol `Worker.StagePlan`
in `pinot-query-runtime/src/main/java/org/apache/pinot/query/runtime/plan/serde/QueryPlanSerDeUtils.java`
#### Snippet
```java

/**
 * This utility class serialize/deserialize between {@link Worker.StagePlan} elements to Planner elements.
 */
public class QueryPlanSerDeUtils {
```

### JavadocReference
Cannot resolve symbol `org.apache.pinot.common.proto.Mailbox`
in `pinot-query-runtime/src/main/java/org/apache/pinot/query/runtime/blocks/TransferableBlock.java`
#### Snippet
```java
/**
 * A {@code TransferableBlock} is a wrapper around {@link DataBlock} for transferring data using
 * {@link org.apache.pinot.common.proto.Mailbox}.
 */
public class TransferableBlock implements Block {
```

### JavadocReference
Cannot resolve symbol `org.apache.pinot.common.proto.Worker.QueryResponse`
in `pinot-query-runtime/src/main/java/org/apache/pinot/query/service/QueryConfig.java`
#### Snippet
```java

  /**
   * Configuration keys for {@link org.apache.pinot.common.proto.Worker.QueryResponse} extra metadata.
   */
  public static final String KEY_OF_SERVER_RESPONSE_STATUS_ERROR = "ERROR";
```

### JavadocReference
Cannot resolve symbol `org.apache.pinot.common.proto.Worker.QueryRequest`
in `pinot-query-runtime/src/main/java/org/apache/pinot/query/service/QueryConfig.java`
#### Snippet
```java

  /**
   * Configuration keys for {@link org.apache.pinot.common.proto.Worker.QueryRequest} extra metadata.
   */
  public static final String KEY_OF_BROKER_REQUEST_ID = "pinot.query.runner.broker.request.id";
```

### JavadocReference
Symbol `org.apache.pinot.plugin.inputformat.json.JSONMessageDecoder` is inaccessible from here
in `pinot-plugins/pinot-input-format/pinot-clp-log/src/main/java/org/apache/pinot/plugin/inputformat/clplog/CLPLogMessageDecoder.java`
#### Snippet
```java
 * An implementation of StreamMessageDecoder to read log events from a stream. This is an experimental feature.
 * It allows us to encode user-specified fields of a log event using CLP. See {@link CLPLogRecordExtractor} for more
 * details. The implementation is based on {@link org.apache.pinot.plugin.inputformat.json.JSONMessageDecoder}.
 */
public class CLPLogMessageDecoder implements StreamMessageDecoder<byte[]> {
```

### JavadocReference
Symbol `org.apache.pinot.plugin.inputformat.json.JSONRecordExtractor` is inaccessible from here
in `pinot-plugins/pinot-input-format/pinot-clp-log/src/main/java/org/apache/pinot/plugin/inputformat/clplog/CLPLogRecordExtractor.java`
#### Snippet
```java
 * </ul>
 * All remaining fields are processed in the same way as they are in
 * {@link org.apache.pinot.plugin.inputformat.json.JSONRecordExtractor}. Specifically:
 * <ul>
 *   <li>If the caller passed a set of fields to {@code init}, then only those fields are extracted from each
```

### JavadocReference
Symbol `org.apache.pinot.plugin.inputformat.json.JSONRecordExtractor` is inaccessible from here
in `pinot-plugins/pinot-input-format/pinot-clp-log/src/main/java/org/apache/pinot/plugin/inputformat/clplog/CLPLogRecordExtractor.java`
#### Snippet
```java
 *   <li>Otherwise, all fields are extracted from each record.</li>
 * </ul>
 * This class' implementation is based on {@link org.apache.pinot.plugin.inputformat.json.JSONRecordExtractor}.
 */
public class CLPLogRecordExtractor extends BaseRecordExtractor<Map<String, Object>> {
```

### JavadocReference
Cannot resolve symbol `org.apache.lucene.search.TopScoreDocCollector`
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/readers/text/LuceneDocIdCollector.java`
#### Snippet
```java
 * A simple collector created to bypass all the heap heavy process
 * of collecting the results in Lucene. Lucene by default will
 * create a {@link org.apache.lucene.search.TopScoreDocCollector}
 * which internally uses a {@link org.apache.lucene.search.TopDocsCollector}
 * and uses a PriorityQueue to maintain the top results. From the heap usage
```

### JavadocReference
Cannot resolve symbol `org.apache.lucene.search.TopDocsCollector`
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/readers/text/LuceneDocIdCollector.java`
#### Snippet
```java
 * of collecting the results in Lucene. Lucene by default will
 * create a {@link org.apache.lucene.search.TopScoreDocCollector}
 * which internally uses a {@link org.apache.lucene.search.TopDocsCollector}
 * and uses a PriorityQueue to maintain the top results. From the heap usage
 * experiments (please see the design doc), we found out that this was
```

## RuleId[id=ManualArrayToCollectionCopy]
### ManualArrayToCollectionCopy
Manual array to collection copy
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/upsert/merger/UnionMerger.java`
#### Snippet
```java
  private static Object union(Object[] a, Object[] b) {
    Set<Object> union = new TreeSet<>();
    for (Object value : a) {
      union.add(value);
    }
```

### ManualArrayToCollectionCopy
Manual array to collection copy
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/upsert/merger/UnionMerger.java`
#### Snippet
```java
      union.add(value);
    }
    for (Object value : b) {
      union.add(value);
    }
```

## RuleId[id=UnaryPlus]
### UnaryPlus
Unary `+` operator
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/customobject/QuantileDigest.java`
#### Snippet
```java
      int result;
      long temp;
      temp = _count != +0.0d ? Double.doubleToLongBits(_count) : 0L;
      result = (int) (temp ^ (temp >>> 32));
      temp = _mean != +0.0d ? Double.doubleToLongBits(_mean) : 0L;
```

### UnaryPlus
Unary `+` operator
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/customobject/QuantileDigest.java`
#### Snippet
```java
      temp = _count != +0.0d ? Double.doubleToLongBits(_count) : 0L;
      result = (int) (temp ^ (temp >>> 32));
      temp = _mean != +0.0d ? Double.doubleToLongBits(_mean) : 0L;
      result = 31 * result + (int) (temp ^ (temp >>> 32));
      return result;
```

## RuleId[id=UnnecessarySemicolon]
### UnnecessarySemicolon
Unnecessary semicolon `;`
in `pinot-common/src/main/java/org/apache/pinot/common/segment/generation/SegmentGenerationUtils.java`
#### Snippet
```java
    if (PinotFSFactory.isSchemeSupported(scheme)) {
      // Try to use PinotFS to read table config URI
      try (PinotFS pinotFS = PinotFSFactory.create(scheme);) {
        tableConfigJson = IOUtils.toString(pinotFS.open(tableConfigURI), StandardCharsets.UTF_8);
      } catch (IOException e) {
```

### UnnecessarySemicolon
Unnecessary semicolon `;`
in `pinot-core/src/main/java/org/apache/pinot/core/query/reduce/SelectionOnlyStreamingReducer.java`
#### Snippet
```java
    int numRows = dataTable.getNumberOfRows();
    if (nullHandlingEnabled) {
      RoaringBitmap[] nullBitmaps = new RoaringBitmap[numColumns];;
      for (int coldId = 0; coldId < numColumns; coldId++) {
        nullBitmaps[coldId] = dataTable.getNullRowIds(coldId);
```

### UnnecessarySemicolon
Unnecessary semicolon `;`
in `pinot-core/src/main/java/org/apache/pinot/core/query/reduce/ExecutionStatsAggregator.java`
#### Snippet
```java
    if (routingInstance != null) {
      tableType = routingInstance.getTableType();
      instanceName = routingInstance.getShortName();;
    } else if (tableName != null) {
      tableType = TableNameBuilder.getTableTypeFromTableName(tableName);
```

### UnnecessarySemicolon
Unnecessary semicolon `;`
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/LLRealtimeSegmentDataManager.java`
#### Snippet
```java
      createPartitionMetadataProvider("Get Partition Lag State");
    }
    ;
    return _partitionMetadataProvider.getCurrentPartitionLagState(consumerPartitionStateMap);
  }
```

### UnnecessarySemicolon
Unnecessary semicolon `;`
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/HistogramAggregationFunction.java`
#### Snippet
```java
      _lower = arguments.get(1).getLiteral().getDoubleValue();
      _upper = arguments.get(2).getLiteral().getDoubleValue();
      int numBins = arguments.get(3).getLiteral().getIntValue();;
      Preconditions.checkArgument(_upper > _lower,
          "The right most edge must be greater than left most edge, given %s and %s", _lower, _upper);
```

### UnnecessarySemicolon
Unnecessary semicolon `;`
in `pinot-core/src/main/java/org/apache/pinot/core/operator/filter/predicate/PredicateEvaluator.java`
#### Snippet
```java
  default int getNumMatchingItems() {
    return Integer.MIN_VALUE;
  };

  /**
```

### UnnecessarySemicolon
Unnecessary semicolon `;`
in `pinot-core/src/main/java/org/apache/pinot/server/access/AccessControlFactory.java`
#### Snippet
```java

  default void init(PinotConfiguration configuration) {
  };

  /**
```

### UnnecessarySemicolon
Unnecessary semicolon `;`
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/io/metadata/TimeFieldSpecMetadata.java`
#### Snippet
```java
  @JsonSetter(nulls = Nulls.SKIP)
  public void setCardinality(int cardinality) {
    ;
  }

```

### UnnecessarySemicolon
Unnecessary semicolon `;`
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/io/metadata/TimeFieldSpecMetadata.java`
#### Snippet
```java
  @JsonSetter(nulls = Nulls.SKIP)
  public void setNumValuesPerEntry(double numValuesPerEntry) {
    ;
  }

```

### UnnecessarySemicolon
Unnecessary semicolon `;`
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/io/metadata/TimeFieldSpecMetadata.java`
#### Snippet
```java
  @JsonSetter(nulls = Nulls.SKIP)
  public void setAverageLength(int averageLength) {
    ;
  }

```

### UnnecessarySemicolon
Unnecessary semicolon `;`
in `pinot-tools/src/main/java/org/apache/pinot/tools/utils/StreamSourceType.java`
#### Snippet
```java
  KAFKA,
  KINESIS,
  PULSAR;
}

```

### UnnecessarySemicolon
Unnecessary semicolon `;`
in `pinot-broker/src/main/java/org/apache/pinot/broker/broker/AccessControlFactory.java`
#### Snippet
```java

  public void init(PinotConfiguration configuration) {
  };

  /**
```

### UnnecessarySemicolon
Unnecessary semicolon `;`
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/data/manager/TableDataManager.java`
#### Snippet
```java
   */
  default void onConsumingToDropped(String segmentNameStr) {
  };

  /**
```

### UnnecessarySemicolon
Unnecessary semicolon `;`
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/data/manager/TableDataManager.java`
#### Snippet
```java
   */
  default void onConsumingToOnline(String segmentNameStr) {
  };
}

```

## RuleId[id=SimplifyStreamApiCallChains]
### SimplifyStreamApiCallChains
Can be replaced with 'java.util.HashSet' constructor
in `pinot-query-planner/src/main/java/org/apache/pinot/query/routing/WorkerManager.java`
#### Snippet
```java
      // routing need not be tenant aware.
      // Eg: SELECT 1 AS one FROM select_having_expression_test_test_having HAVING 1 > 2;
      serverInstances = _routingManager.getEnabledServerInstanceMap().values().stream().collect(Collectors.toSet());
    } else {
      serverInstances = fetchServersForIntermediateStage(tableNames);
```

### SimplifyStreamApiCallChains
Can be replaced with 'String.join'
in `pinot-spi/src/main/java/org/apache/pinot/spi/env/CommonsConfigurationUtils.java`
#### Snippet
```java
  private static Object mapValue(String key, Configuration configuration) {
    return Optional.of(configuration.getStringArray(key)).filter(values -> values.length > 1).<Object>map(
        values -> Arrays.stream(values).collect(Collectors.joining(",")))
        .orElseGet(() -> configuration.getProperty(key));
  }
```

### SimplifyStreamApiCallChains
Can be replaced with 'java.util.ArrayList' constructor
in `pinot-common/src/main/java/org/apache/pinot/common/config/provider/AccessControlUserCache.java`
#### Snippet
```java

    public List<UserConfig> getAllServerUserConfig() {
        return _userServerConfigMap.values().stream().collect(Collectors.toList());
    }

```

### SimplifyStreamApiCallChains
Can be replaced with 'java.util.ArrayList' constructor
in `pinot-common/src/main/java/org/apache/pinot/common/config/provider/AccessControlUserCache.java`
#### Snippet
```java

    public List<UserConfig> getAllBrokerUserConfig() {
        return _userBrokerConfigMap.values().stream().collect(Collectors.toList());
    }

```

### SimplifyStreamApiCallChains
Can be replaced with 'java.util.ArrayList' constructor
in `pinot-common/src/main/java/org/apache/pinot/common/config/provider/AccessControlUserCache.java`
#### Snippet
```java
    @Nullable
    public List<String> getAllUserName() {
        return _userConfigMap.keySet().stream().collect(Collectors.toList());
    }

```

### SimplifyStreamApiCallChains
Can be replaced with 'java.util.ArrayList' constructor
in `pinot-common/src/main/java/org/apache/pinot/common/config/provider/AccessControlUserCache.java`
#### Snippet
```java

    public List<UserConfig> getAllControllerUserConfig() {
        return _userControllerConfigMap.values().stream().collect(Collectors.toList());
    }

```

### SimplifyStreamApiCallChains
Can be replaced with 'java.util.ArrayList' constructor
in `pinot-common/src/main/java/org/apache/pinot/common/config/provider/AccessControlUserCache.java`
#### Snippet
```java
    @Nullable
    public List<UserConfig> getAllUserConfig() {
        return _userConfigMap.values().stream().collect(Collectors.toList());
    }

```

### SimplifyStreamApiCallChains
Can be replaced with 'java.util.HashSet' constructor
in `pinot-core/src/main/java/org/apache/pinot/core/auth/BasicAuthUtils.java`
#### Snippet
```java
          Set<String> tables = Optional.ofNullable(user.getTables())
              .orElseGet(() -> Collections.emptyList())
              .stream().collect(Collectors.toSet());
          Set<String> permissions = Optional.ofNullable(user.getPermissios())
              .orElseGet(() -> Collections.emptyList())
```

### SimplifyStreamApiCallChains
''stream().forEach()'' can be replaced with 'forEach()'' (may change semantics)
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotBrokerRestletResource.java`
#### Snippet
```java
    Map<String, List<InstanceInfo>> resultMap = new HashMap<>();
    _pinotHelixResourceManager.getAllRawTables().stream()
        .forEach(table -> resultMap.put(table, getBrokersForTableV2(table, null, state)));
    return resultMap;
  }
```

### SimplifyStreamApiCallChains
''stream().forEach()'' can be replaced with 'forEach()'' (may change semantics)
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotBrokerRestletResource.java`
#### Snippet
```java
    Map<String, List<String>> resultMap = new HashMap<>();
    _pinotHelixResourceManager.getAllRawTables().stream()
        .forEach(table -> resultMap.put(table, getBrokersForTable(table, null, state)));
    return resultMap;
  }
```

### SimplifyStreamApiCallChains
''stream().forEach()'' can be replaced with 'forEach()'' (may change semantics)
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotBrokerRestletResource.java`
#### Snippet
```java
    Map<String, List<String>> resultMap = new HashMap<>();
    _pinotHelixResourceManager.getAllBrokerTenantNames().stream()
        .forEach(tenant -> resultMap.put(tenant, getBrokersForTenant(tenant, state)));
    return resultMap;
  }
```

### SimplifyStreamApiCallChains
''stream().forEach()'' can be replaced with 'forEach()'' (may change semantics)
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotBrokerRestletResource.java`
#### Snippet
```java
    Map<String, List<InstanceInfo>> resultMap = new HashMap<>();
    _pinotHelixResourceManager.getAllBrokerTenantNames().stream()
        .forEach(tenant -> resultMap.put(tenant, getBrokersForTenantV2(tenant, state)));
    return resultMap;
  }
```

## RuleId[id=TypeParameterHidesVisibleType]
### TypeParameterHidesVisibleType
Type parameter `VALUE` hides type parameter 'VALUE'
in `pinot-broker/src/main/java/org/apache/pinot/broker/routing/segmentpruner/interval/IntervalTree.java`
#### Snippet
```java
  }

  private class Node<VALUE> implements Comparable<Node> {
    private final Interval _interval;
    private final List<VALUE> _values;
```

## RuleId[id=StringOperationCanBeSimplified]
### StringOperationCanBeSimplified
`toUpperCase()` call can be replaced with 'equalsIgnoreCase()'
in `pinot-core/src/main/java/org/apache/pinot/core/query/optimizer/statement/JsonStatementOptimizer.java`
#### Snippet
```java
        boolean hasJsonPathExpression = false;
        StringBuffer alias = new StringBuffer();
        if (function.getOperator().toUpperCase().equals("AS")) {
          // We don't need to compute an alias for AS function since AS function defines its own alias.
          hasJsonPathExpression = optimizeJsonIdentifier(operands.get(0), schema, outputDataType).getRight();
```

### StringOperationCanBeSimplified
`toLowerCase()` call can be replaced with 'equalsIgnoreCase()'
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotTableInstances.java`
#### Snippet
```java
    ArrayNode servers = JsonUtils.newArrayNode();

    if (type == null || type.isEmpty() || type.toLowerCase().equals("broker")) {
      if (_pinotHelixResourceManager.hasOfflineTable(tableName)) {
        ObjectNode e = JsonUtils.newObjectNode();
```

### StringOperationCanBeSimplified
`toLowerCase()` call can be replaced with 'equalsIgnoreCase()'
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotTableInstances.java`
#### Snippet
```java
    }

    if (type == null || type.isEmpty() || type.toLowerCase().equals("server")) {
      if (_pinotHelixResourceManager.hasOfflineTable(tableName)) {
        ObjectNode e = JsonUtils.newObjectNode();
```

## RuleId[id=UnnecessaryCallToStringValueOf]
### UnnecessaryCallToStringValueOf
Unnecessary `String.valueOf()` call
in `pinot-core/src/main/java/org/apache/pinot/core/query/optimizer/statement/JsonStatementOptimizer.java`
#### Snippet
```java
    switch (literal.getSetField()) {
      case BOOL_VALUE:
        result.append(String.valueOf(literal.getBinaryValue()));
        break;
      case BYTE_VALUE:
```

### UnnecessaryCallToStringValueOf
Unnecessary `String.valueOf()` call
in `pinot-core/src/main/java/org/apache/pinot/core/query/optimizer/statement/JsonStatementOptimizer.java`
#### Snippet
```java
        break;
      case INT_VALUE:
        result.append(String.valueOf(literal.getIntValue()));
        break;
      case LONG_VALUE:
```

### UnnecessaryCallToStringValueOf
Unnecessary `String.valueOf()` call
in `pinot-core/src/main/java/org/apache/pinot/core/query/optimizer/statement/JsonStatementOptimizer.java`
#### Snippet
```java
        break;
      case LONG_VALUE:
        result.append(String.valueOf(literal.getLongValue()));
        break;
      case DOUBLE_VALUE:
```

### UnnecessaryCallToStringValueOf
Unnecessary `String.valueOf()` call
in `pinot-core/src/main/java/org/apache/pinot/core/query/optimizer/statement/JsonStatementOptimizer.java`
#### Snippet
```java
        break;
      case DOUBLE_VALUE:
        result.append(String.valueOf(literal.getDoubleValue()));
        break;
      case STRING_VALUE:
```

### UnnecessaryCallToStringValueOf
Unnecessary `String.valueOf()` call
in `pinot-core/src/main/java/org/apache/pinot/core/query/optimizer/statement/JsonStatementOptimizer.java`
#### Snippet
```java
      case BINARY_VALUE:
        result.append(
            aliasing ? String.valueOf(literal.getBinaryValue()) : "'" + String.valueOf(literal.getBinaryValue()) + "'");
        break;
      default:
```

### UnnecessaryCallToStringValueOf
Unnecessary `String.valueOf()` call
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/ZookeeperLauncher.java`
#### Snippet
```java

  public ZookeeperLauncher(String baseTempDir) {
    _tempDir = new File(baseTempDir, "zk_" + String.valueOf(System.currentTimeMillis()));
    if (_tempDir.exists()) {
      Preconditions.checkArgument(_tempDir.delete());
```

### UnnecessaryCallToStringValueOf
Unnecessary `String.valueOf()` call
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/store/SingleFileIndexDirectory.java`
#### Snippet
```java

    String context = allocationContext(_indexFile,
        "single_file_index.rw." + "." + String.valueOf(fromFilePos) + "." + String.valueOf(size));

    // Backward-compatible: index file is always big-endian
```

### UnnecessaryCallToStringValueOf
Unnecessary `String.valueOf()` call
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/store/SingleFileIndexDirectory.java`
#### Snippet
```java

    String context = allocationContext(_indexFile,
        "single_file_index.rw." + "." + String.valueOf(fromFilePos) + "." + String.valueOf(size));

    // Backward-compatible: index file is always big-endian
```

## RuleId[id=FinallyBlockCannotCompleteNormally]
### FinallyBlockCannotCompleteNormally
`finally` block can not complete normally
in `pinot-common/src/main/java/org/apache/pinot/common/utils/BcryptUtils.java`
#### Snippet
```java
        } catch (Exception e) {
            System.out.println(e.getMessage());
        } finally {
            return isMatch;
        }
```

## RuleId[id=DuplicatedCode]
### DuplicatedCode
Duplicated code
in `pinot-broker/src/main/java/org/apache/pinot/broker/api/HttpRequesterIdentity.java`
#### Snippet
```java
    Multimap<String, String> headers = ArrayListMultimap.create();
    request.getHeaderNames().forEach(key -> request.getHeaders(key).forEach(value -> headers.put(key, value)));

    HttpRequesterIdentity identity = new HttpRequesterIdentity();
    identity.setHttpHeaders(headers);
    identity.setEndpointUrl(request.getRequestURL().toString());
    return identity;
```

### DuplicatedCode
Duplicated code
in `pinot-broker/src/main/java/org/apache/pinot/broker/broker/BrokerAdminApiApplication.java`
#### Snippet
```java
    beanConfig.setContact("https://github.com/apache/pinot");
    beanConfig.setVersion("1.0");
    beanConfig.setExpandSuperTypes(false);
    if (_useHttps) {
      beanConfig.setSchemes(new String[]{CommonConstants.HTTPS_PROTOCOL});
    } else {
      beanConfig.setSchemes(new String[]{CommonConstants.HTTP_PROTOCOL, CommonConstants.HTTPS_PROTOCOL});
    }
    beanConfig.setBasePath("/");
    beanConfig.setResourcePackage(_brokerResourcePackages);
    beanConfig.setScan(true);
```

### DuplicatedCode
Duplicated code
in `pinot-broker/src/main/java/org/apache/pinot/broker/broker/helix/BaseBrokerStarter.java`
#### Snippet
```java
    String existingPortStr = instanceConfigSimpleFields.get(key);
    if (port > 0) {
      String portStr = Integer.toString(port);
      if (!portStr.equals(existingPortStr)) {
        LOGGER.info("Updating '{}' for instance: {} to: {}", key, _instanceId, port);
        instanceConfigSimpleFields.put(key, portStr);
        return true;
      }
    } else {
      if (existingPortStr != null) {
        LOGGER.info("Removing '{}' from instance: {}", key, _instanceId);
        instanceConfigSimpleFields.remove(key);
        return true;
      }
    }
    return false;
```

### DuplicatedCode
Duplicated code
in `pinot-broker/src/main/java/org/apache/pinot/broker/querylog/QueryLogger.java`
#### Snippet
```java
      _requestId = requestId;
      _query = query;
      _table = table;
      _timeUsedMs = timeUsedMs;
      _requestContext = requestContext;
      _requester = requester;
      _response = response;
      _serverStats = serverStats;
      _numUnavailableSegments = numUnavailableSegments;
```

### DuplicatedCode
Duplicated code
in `pinot-broker/src/main/java/org/apache/pinot/broker/requesthandler/BaseBrokerRequestHandler.java`
#### Snippet
```java
    long requestId = _requestIdGenerator.incrementAndGet();
    requestContext.setRequestId(requestId);
    requestContext.setRequestArrivalTimeMillis(System.currentTimeMillis());

    // First-stage access control to prevent unauthenticated requests from using up resources. Secondary table-level
    // check comes later.
    boolean hasAccess = _accessControlFactory.create().hasAccess(requesterIdentity);
    if (!hasAccess) {
      _brokerMetrics.addMeteredGlobalValue(BrokerMeter.REQUEST_DROPPED_DUE_TO_ACCESS_ERROR, 1);
      LOGGER.info("Access denied for requestId {}", requestId);
      requestContext.setErrorCode(QueryException.ACCESS_DENIED_ERROR_CODE);
      return new BrokerResponseNative(QueryException.ACCESS_DENIED_ERROR);
    }
```

### DuplicatedCode
Duplicated code
in `pinot-broker/src/main/java/org/apache/pinot/broker/requesthandler/BaseBrokerRequestHandler.java`
#### Snippet
```java
      if (offlineBrokerRequest != null) {
        // NOTE: Routing table might be null if table is just removed
        RoutingTable routingTable = _routingManager.getRoutingTable(offlineBrokerRequest, requestId);
        if (routingTable != null) {
          unavailableSegments.addAll(routingTable.getUnavailableSegments());
          Map<ServerInstance, List<String>> serverInstanceToSegmentsMap = routingTable.getServerInstanceToSegmentsMap();
          if (!serverInstanceToSegmentsMap.isEmpty()) {
            offlineRoutingTable = serverInstanceToSegmentsMap;
          } else {
            offlineBrokerRequest = null;
          }
          numPrunedSegmentsTotal += routingTable.getNumPrunedSegments();
        } else {
          offlineBrokerRequest = null;
        }
      }
```

### DuplicatedCode
Duplicated code
in `pinot-broker/src/main/java/org/apache/pinot/broker/requesthandler/BaseBrokerRequestHandler.java`
#### Snippet
```java
    String timeColumn = timeBoundaryInfo.getTimeColumn();
    String timeValue = timeBoundaryInfo.getTimeValue();
    Expression timeFilterExpression = RequestUtils.getFunctionExpression(
        isOfflineRequest ? FilterKind.LESS_THAN_OR_EQUAL.name() : FilterKind.GREATER_THAN.name());
    timeFilterExpression.getFunctionCall().setOperands(
        Arrays.asList(RequestUtils.getIdentifierExpression(timeColumn), RequestUtils.getLiteralExpression(timeValue)));

    Expression filterExpression = pinotQuery.getFilterExpression();
    if (filterExpression != null) {
      Expression andFilterExpression = RequestUtils.getFunctionExpression(FilterKind.AND.name());
      andFilterExpression.getFunctionCall().setOperands(Arrays.asList(filterExpression, timeFilterExpression));
      pinotQuery.setFilterExpression(andFilterExpression);
    } else {
      pinotQuery.setFilterExpression(timeFilterExpression);
    }
```

### DuplicatedCode
Duplicated code
in `pinot-broker/src/main/java/org/apache/pinot/broker/routing/instanceselector/StrictReplicaGroupInstanceSelector.java`
#### Snippet
```java
      String segment = entry.getKey();
      // NOTE: onlineInstances is either a TreeSet or an EmptySet (sorted)
      Set<String> onlineInstances = entry.getValue();
      Map<String, String> idealStateInstanceStateMap = idealStateAssignment.get(segment);
      Set<String> unavailableInstances =
          unavailableInstancesMap.getOrDefault(idealStateInstanceStateMap.keySet(), Collections.emptySet());
      List<SegmentInstanceCandidate> candidates = new ArrayList<>(onlineInstances.size());
```

### DuplicatedCode
Duplicated code
in `pinot-broker/src/main/java/org/apache/pinot/broker/routing/segmentmetadata/SegmentZkMetadataFetcher.java`
#### Snippet
```java
        int numSegments = onlineSegments.size();
        List<String> segments = new ArrayList<>(numSegments);
        List<String> segmentZKMetadataPaths = new ArrayList<>(numSegments);
        for (String segment : onlineSegments) {
          segments.add(segment);
          segmentZKMetadataPaths.add(_segmentZKMetadataPathPrefix + segment);
        }
```

### DuplicatedCode
Duplicated code
in `pinot-broker/src/main/java/org/apache/pinot/broker/routing/segmentpruner/MultiPartitionColumnsSegmentPruner.java`
#### Snippet
```java
    if (znRecord == null) {
      LOGGER.warn("Failed to find segment ZK metadata for segment: {}, table: {}", segment, _tableNameWithType);
      return null;
    }

    String partitionMetadataJson = znRecord.getSimpleField(Segment.PARTITION_METADATA);
    if (partitionMetadataJson == null) {
      LOGGER.warn("Failed to find segment partition metadata for segment: {}, table: {}", segment, _tableNameWithType);
      return INVALID_COLUMN_PARTITION_INFO_MAP;
    }

    SegmentPartitionMetadata segmentPartitionMetadata;
    try {
      segmentPartitionMetadata = SegmentPartitionMetadata.fromJsonString(partitionMetadataJson);
    } catch (Exception e) {
      LOGGER.warn("Caught exception while extracting segment partition metadata for segment: {}, table: {}", segment,
          _tableNameWithType, e);
      return INVALID_COLUMN_PARTITION_INFO_MAP;
    }
```

### DuplicatedCode
Duplicated code
in `pinot-broker/src/main/java/org/apache/pinot/broker/routing/segmentpruner/MultiPartitionColumnsSegmentPruner.java`
#### Snippet
```java
          int numOperands = operands.size();
          for (int i = 1; i < numOperands; i++) {
            if (partitionInfo._partitions.contains(partitionInfo._partitionFunction.getPartition(
                operands.get(i).getLiteral().getFieldValue().toString()))) {
              return true;
            }
          }
          return false;
```

### DuplicatedCode
Duplicated code
in `pinot-broker/src/main/java/org/apache/pinot/broker/routing/segmentpruner/TimeSegmentPruner.java`
#### Snippet
```java
        Identifier identifier = operands.get(0).getIdentifier();
        if (identifier != null && identifier.getName().equals(_timeColumn)) {
          long timeStamp = _timeFormatSpec.fromFormatToMillis(operands.get(1).getLiteral().getFieldValue().toString());
          return Collections.singletonList(new Interval(timeStamp, timeStamp));
        } else {
          return null;
        }
```

### DuplicatedCode
Duplicated code
in `pinot-broker/src/main/java/org/apache/pinot/broker/routing/segmentselector/RealtimeSegmentSelector.java`
#### Snippet
```java
          LLCSegmentName llcSegmentName = new LLCSegmentName(segment);
          partitionIdToFirstConsumingLLCSegmentMap
              .compute(llcSegmentName.getPartitionGroupId(), (k, consumingSegment) -> {
                if (consumingSegment == null) {
                  return llcSegmentName;
                } else {
                  if (llcSegmentName.getSequenceNumber() < consumingSegment.getSequenceNumber()) {
                    return llcSegmentName;
                  } else {
                    return consumingSegment;
                  }
                }
              });
```

### DuplicatedCode
Duplicated code
in `pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/ExternalViewReader.java`
#### Snippet
```java
      byte[] brokerResourceNodeData = _zkClient.readData(BROKER_EXTERNAL_VIEW_PATH, true);
      brokerResourceNodeData = unpackZnodeIfNecessary(brokerResourceNodeData);
      JsonNode jsonObject = OBJECT_READER.readTree(getInputStream(brokerResourceNodeData));
      JsonNode brokerResourceNode = jsonObject.get("mapFields");

      Iterator<Entry<String, JsonNode>> resourceEntries = brokerResourceNode.fields();
```

### DuplicatedCode
Duplicated code
in `pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/ExternalViewReader.java`
#### Snippet
```java
        Iterator<Entry<String, JsonNode>> brokerEntries = resource.fields();
        while (brokerEntries.hasNext()) {
          Entry<String, JsonNode> brokerEntry = brokerEntries.next();
          String brokerName = brokerEntry.getKey();
          if (brokerName.startsWith("Broker_") && "ONLINE".equals(brokerEntry.getValue().asText())) {
            brokerUrls.add(getHostPort(brokerName));
          }
        }
```

### DuplicatedCode
Duplicated code
in `pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/ResultTableResultSet.java`
#### Snippet
```java
    table.addHeader(columnDataTypes);

    int numRows = getRowCount();
    for (int r = 0; r < numRows; r++) {
      String[] columnValues = new String[numColumns];
      for (int c = 0; c < numColumns; c++) {
        try {
          columnValues[c] = getString(r, c);
        } catch (Exception e) {
          columnNames[c] = "ERROR";
        }
      }
      table.addRow(columnValues);
    }
    return table.toString();
```

### DuplicatedCode
Duplicated code
in `pinot-common/src/main/java/org/apache/pinot/common/config/provider/AccessControlUserCache.java`
#### Snippet
```java
                    UserConfig userConfig = AccessControlUserConfigUtils.fromZNRecord(userRecord);
                    String username = userConfig.getUsernameWithComponent();

                    if (userConfig.getComponentType().equals(ComponentType.CONTROLLER)) {
                        _userControllerConfigMap.put(username, userConfig);
                    } else if (userConfig.getComponentType().equals(ComponentType.BROKER)) {
                        _userBrokerConfigMap.put(username, userConfig);
                    } else if (userConfig.getComponentType().equals(ComponentType.SERVER)) {
                        _userServerConfigMap.put(username, userConfig);
                    }
```

### DuplicatedCode
Duplicated code
in `pinot-common/src/main/java/org/apache/pinot/common/config/provider/TableCache.java`
#### Snippet
```java
      if (CollectionUtils.isEmpty(tableNamesWithType)) {
        return;
      }

      // Only process new added table configs. Changed/removed table configs are handled by other callbacks.
      List<String> pathsToAdd = new ArrayList<>();
      for (String tableNameWithType : tableNamesWithType) {
        if (!_tableConfigInfoMap.containsKey(tableNameWithType)) {
          pathsToAdd.add(TABLE_CONFIG_PATH_PREFIX + tableNameWithType);
        }
      }
```

### DuplicatedCode
Duplicated code
in `pinot-common/src/main/java/org/apache/pinot/common/datatable/DataTableImplV4.java`
#### Snippet
```java
    int size = positionOffsetInVariableBufferAndGetLength(rowId, colId);
    int type = _variableSizeData.getInt();
    if (size == 0) {
      assert type == CustomObject.NULL_TYPE_VALUE;
      return null;
    }
    ByteBuffer buffer = _variableSizeData.slice();
    buffer.limit(size);
    return new CustomObject(type, buffer);
```

### DuplicatedCode
Duplicated code
in `pinot-common/src/main/java/org/apache/pinot/common/datatable/BaseDataTable.java`
#### Snippet
```java
    int type = _variableSizeData.getInt();
    if (size == 0) {
      assert type == CustomObject.NULL_TYPE_VALUE;
      return null;
    }
    ByteBuffer buffer = _variableSizeData.slice();
    buffer.limit(size);
    return new CustomObject(type, buffer);
```

### DuplicatedCode
Duplicated code
in `pinot-common/src/main/java/org/apache/pinot/common/datatable/DataTableImplV4.java`
#### Snippet
```java
    int position = _fixDataSize + colId * Integer.BYTES * 2;
    if (_fixedSizeData == null || position >= _fixedSizeData.limit()) {
      return null;
    }
    _fixedSizeData.position(position);
    int offset = _fixedSizeData.getInt();
    int bytesLength = _fixedSizeData.getInt();
    if (bytesLength > 0) {
      _variableSizeData.position(offset);
      byte[] nullBitmapBytes = new byte[bytesLength];
      _variableSizeData.get(nullBitmapBytes);
      return RoaringBitmapUtils.deserialize(nullBitmapBytes);
    } else {
      return null;
    }
```

### DuplicatedCode
Duplicated code
in `pinot-common/src/main/java/org/apache/pinot/common/datatable/DataTableImplV4.java`
#### Snippet
```java
    ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream();
    DataOutputStream dataOutputStream = new DataOutputStream(byteArrayOutputStream);

    dataOutputStream.writeInt(_stringDictionary.length);
    for (String entry : _stringDictionary) {
      byte[] valueBytes = entry.getBytes(UTF_8);
      dataOutputStream.writeInt(valueBytes.length);
      dataOutputStream.write(valueBytes);
    }

    return byteArrayOutputStream.toByteArray();
```

### DuplicatedCode
Duplicated code
in `pinot-common/src/main/java/org/apache/pinot/common/datatable/DataTableImplV3.java`
#### Snippet
```java
    dataOutputStream.writeInt(_numRows);
    dataOutputStream.writeInt(_numColumns);
    int dataOffset = HEADER_SIZE;

    // Write exceptions section offset(START|SIZE).
    dataOutputStream.writeInt(dataOffset);
    byte[] exceptionsBytes;
    exceptionsBytes = serializeExceptions();
    dataOutputStream.writeInt(exceptionsBytes.length);
    dataOffset += exceptionsBytes.length;

    // Write dictionary map section offset(START|SIZE).
    dataOutputStream.writeInt(dataOffset);
    byte[] dictionaryMapBytes = null;
```

### DuplicatedCode
Duplicated code
in `pinot-common/src/main/java/org/apache/pinot/common/datatable/DataTableImplV3.java`
#### Snippet
```java
    byte[] dataSchemaBytes = null;
    if (_dataSchema != null) {
      dataSchemaBytes = _dataSchema.toBytes();
      dataOutputStream.writeInt(dataSchemaBytes.length);
      dataOffset += dataSchemaBytes.length;
    } else {
      dataOutputStream.writeInt(0);
    }

    // Write fixed size data section offset(START|SIZE).
    dataOutputStream.writeInt(dataOffset);
    if (_fixedSizeDataBytes != null) {
      dataOutputStream.writeInt(_fixedSizeDataBytes.length);
      dataOffset += _fixedSizeDataBytes.length;
    } else {
      dataOutputStream.writeInt(0);
    }

    // Write variable size data section offset(START|SIZE).
    dataOutputStream.writeInt(dataOffset);
    if (_variableSizeDataBytes != null) {
      dataOutputStream.writeInt(_variableSizeDataBytes.length);
    } else {
      dataOutputStream.writeInt(0);
    }

    // Write actual data.
    // Write exceptions bytes.
    dataOutputStream.write(exceptionsBytes);
    // Write dictionary map bytes.
    if (dictionaryMapBytes != null) {
      dataOutputStream.write(dictionaryMapBytes);
    }
    // Write data schema bytes.
    if (dataSchemaBytes != null) {
      dataOutputStream.write(dataSchemaBytes);
    }
    // Write fixed size data bytes.
    if (_fixedSizeDataBytes != null) {
      dataOutputStream.write(_fixedSizeDataBytes);
    }
    // Write variable size data bytes.
    if (_variableSizeDataBytes != null) {
      dataOutputStream.write(_variableSizeDataBytes);
    }
```

### DuplicatedCode
Duplicated code
in `pinot-common/src/main/java/org/apache/pinot/common/datatable/DataTableImplV2.java`
#### Snippet
```java
    if (_dataSchema != null) {
      dataSchemaBytes = _dataSchema.toBytes();
      dataOutputStream.writeInt(dataSchemaBytes.length);
      dataOffset += dataSchemaBytes.length;
    } else {
      dataOutputStream.writeInt(0);
    }

    // Write fixed size data.
    dataOutputStream.writeInt(dataOffset);
    if (_fixedSizeDataBytes != null) {
      dataOutputStream.writeInt(_fixedSizeDataBytes.length);
      dataOffset += _fixedSizeDataBytes.length;
    } else {
      dataOutputStream.writeInt(0);
    }

    // Write variable size data.
    dataOutputStream.writeInt(dataOffset);
    if (_variableSizeDataBytes != null) {
      dataOutputStream.writeInt(_variableSizeDataBytes.length);
    } else {
      dataOutputStream.writeInt(0);
    }
```

### DuplicatedCode
Duplicated code
in `pinot-common/src/main/java/org/apache/pinot/common/datatable/DataTableImplV2.java`
#### Snippet
```java
    dataOutputStream.write(metadataBytes);
    if (dataSchemaBytes != null) {
      dataOutputStream.write(dataSchemaBytes);
    }
    if (_fixedSizeDataBytes != null) {
      dataOutputStream.write(_fixedSizeDataBytes);
    }
    if (_variableSizeDataBytes != null) {
      dataOutputStream.write(_variableSizeDataBytes);
    }
```

### DuplicatedCode
Duplicated code
in `pinot-common/src/main/java/org/apache/pinot/common/datatable/DataTableImplV3.java`
#### Snippet
```java
    ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream();
    DataOutputStream dataOutputStream = new DataOutputStream(byteArrayOutputStream);

    dataOutputStream.writeInt(_errCodeToExceptionMap.size());

    for (Map.Entry<Integer, String> entry : _errCodeToExceptionMap.entrySet()) {
      int key = entry.getKey();
      String value = entry.getValue();
      byte[] valueBytes = value.getBytes(UTF_8);
      dataOutputStream.writeInt(key);
      dataOutputStream.writeInt(valueBytes.length);
      dataOutputStream.write(valueBytes);
    }

    return byteArrayOutputStream.toByteArray();
```

### DuplicatedCode
Duplicated code
in `pinot-common/src/main/java/org/apache/pinot/common/datatable/BaseDataTable.java`
#### Snippet
```java
      int dictionarySize = buffer.getInt();
      Map<Integer, String> dictionary = new HashMap<>(dictionarySize);
      for (int j = 0; j < dictionarySize; j++) {
        int key = buffer.getInt();
        String value = DataTableUtils.decodeString(buffer);
        dictionary.put(key, value);
      }
```

### DuplicatedCode
Duplicated code
in `pinot-common/src/main/java/org/apache/pinot/common/datatable/BaseDataTable.java`
#### Snippet
```java
    if (_dataSchema == null) {
      return _metadata.toString();
    } else {
      StringBuilder stringBuilder = new StringBuilder();
      stringBuilder.append("resultSchema:").append('\n');
      stringBuilder.append(_dataSchema).append('\n');
      stringBuilder.append("numRows: ").append(_numRows).append('\n');
      stringBuilder.append("metadata: ").append(_metadata.toString()).append('\n');
      return stringBuilder.toString();
    }
```

### DuplicatedCode
Duplicated code
in `pinot-common/src/main/java/org/apache/pinot/common/datatable/DataTableImplV2.java`
#### Snippet
```java
    byte[] dictionaryMapBytes = null;
    if (_dictionaryMap != null) {
      dictionaryMapBytes = serializeDictionaryMap();
      dataOutputStream.writeInt(dictionaryMapBytes.length);
      dataOffset += dictionaryMapBytes.length;
    } else {
      dataOutputStream.writeInt(0);
    }

    // Write metadata.
    dataOutputStream.writeInt(dataOffset);
```

### DuplicatedCode
Duplicated code
in `pinot-common/src/main/java/org/apache/pinot/common/datatable/DataTableImplV3.java`
#### Snippet
```java
    ThreadResourceUsageProvider threadResourceUsageProvider = new ThreadResourceUsageProvider();

    ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream();
    DataOutputStream dataOutputStream = new DataOutputStream(byteArrayOutputStream);
    writeLeadingSections(dataOutputStream);

    // Add table serialization time metadata if thread timer is enabled.
    if (ThreadResourceUsageProvider.isThreadCpuTimeMeasurementEnabled()) {
      long responseSerializationCpuTimeNs = threadResourceUsageProvider.getThreadTimeNs();
      getMetadata().put(MetadataKey.RESPONSE_SER_CPU_TIME_NS.getName(), String.valueOf(responseSerializationCpuTimeNs));
    }

    // Write metadata: length followed by actual metadata bytes.
    // NOTE: We ignore metadata serialization time in "responseSerializationCpuTimeNs" as it's negligible while
    // considering it will bring a lot code complexity.
    byte[] metadataBytes = serializeMetadata();
    dataOutputStream.writeInt(metadataBytes.length);
    dataOutputStream.write(metadataBytes);

    return byteArrayOutputStream.toByteArray();
```

### DuplicatedCode
Duplicated code
in `pinot-common/src/main/java/org/apache/pinot/common/datatable/DataTableImplV3.java`
#### Snippet
```java
    ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream();
    DataOutputStream dataOutputStream = new DataOutputStream(byteArrayOutputStream);

    dataOutputStream.writeInt(_metadata.size());

    for (Map.Entry<String, String> entry : _metadata.entrySet()) {
      MetadataKey key = MetadataKey.getByName(entry.getKey());
      // Ignore unknown keys.
      if (key == null) {
        continue;
      }
      String value = entry.getValue();
      dataOutputStream.writeInt(key.getId());
      if (key.getValueType() == MetadataValueType.INT) {
        dataOutputStream.write(Ints.toByteArray(Integer.parseInt(value)));
      } else if (key.getValueType() == MetadataValueType.LONG) {
        dataOutputStream.write(Longs.toByteArray(Long.parseLong(value)));
      } else {
        byte[] valueBytes = value.getBytes(UTF_8);
        dataOutputStream.writeInt(valueBytes.length);
        dataOutputStream.write(valueBytes);
      }
    }

    return byteArrayOutputStream.toByteArray();
```

### DuplicatedCode
Duplicated code
in `pinot-common/src/main/java/org/apache/pinot/common/datatable/DataTableImplV3.java`
#### Snippet
```java
    int numEntries = buffer.getInt();
    Map<String, String> metadata = new HashMap<>();
    for (int i = 0; i < numEntries; i++) {
      int keyId = buffer.getInt();
      MetadataKey key = MetadataKey.getById(keyId);
      // Ignore unknown keys.
      if (key == null) {
        continue;
      }
      if (key.getValueType() == MetadataValueType.INT) {
        String value = "" + buffer.getInt();
        metadata.put(key.getName(), value);
      } else if (key.getValueType() == MetadataValueType.LONG) {
        String value = "" + buffer.getLong();
        metadata.put(key.getName(), value);
      } else {
        String value = DataTableUtils.decodeString(buffer);
        metadata.put(key.getName(), value);
      }
    }
    return metadata;
```

### DuplicatedCode
Duplicated code
in `pinot-common/src/main/java/org/apache/pinot/common/minion/MinionClient.java`
#### Snippet
```java
    HttpResponse response = HTTP_CLIENT.execute(httpGet);
    int statusCode = response.getStatusLine().getStatusCode();
    final String responseString = IOUtils.toString(response.getEntity().getContent());
    if (statusCode >= 400) {
      throw new HttpException(String
          .format("Unable to get tasks states map. Error code %d, Error message: %s", statusCode, responseString));
    }
    return JsonUtils.stringToObject(responseString, new TypeReference<Map<String, String>>() {
    });
```

### DuplicatedCode
Duplicated code
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
    HttpEntity entity = MultipartEntityBuilder.create().setMode(HttpMultipartMode.BROWSER_COMPATIBLE)
        .addPart(contentBody.getFilename(), contentBody).build();

    // Build the request
    RequestBuilder requestBuilder =
        RequestBuilder.create(method).setVersion(HttpVersion.HTTP_1_1).setUri(uri).setEntity(entity);
    HttpClient.addHeadersAndParameters(requestBuilder, headers, parameters);
    HttpClient.setTimeout(requestBuilder, socketTimeoutMs);
    return requestBuilder.build();
```

### DuplicatedCode
Duplicated code
in `pinot-common/src/main/java/org/apache/pinot/common/utils/HashUtil.java`
#### Snippet
```java
    int length = data.length;
    int seed = 0x9747b28c;
    // 'm' and 'r' are mixing constants generated offline.
    // They're not really 'magic', they just happen to work well.
    final int m = 0x5bd1e995;
    final int r = 24;

    // Initialize the hash to a random value
    int h = seed ^ length;
    int length4 = length / 4;

    for (int i = 0; i < length4; i++) {
      final int i4 = i * 4;
      int k =
          (data[i4 + 0] & 0xff) + ((data[i4 + 1] & 0xff) << 8) + ((data[i4 + 2] & 0xff) << 16) + ((data[i4 + 3] & 0xff)
              << 24);
      k *= m;
      k ^= k >>> r;
      k *= m;
      h *= m;
      h ^= k;
    }

    // CHECKSTYLE:OFF: checkstyle:coding
    // Handle the last few bytes of the input array
    switch (length % 4) {
      case 3:
        h ^= (data[(length & ~3) + 2] & 0xff) << 16;
      case 2:
        h ^= (data[(length & ~3) + 1] & 0xff) << 8;
      case 1:
        h ^= data[length & ~3] & 0xff;
        h *= m;
    }
    // CHECKSTYLE:ON: checkstyle:coding

    h ^= h >>> 13;
    h *= m;
    h ^= h >>> 15;

    return h;
```

### DuplicatedCode
Duplicated code
in `pinot-common/src/main/java/org/apache/pinot/common/utils/PinotDataType.java`
#### Snippet
```java
      PinotDataType singleValueType = getSingleValueType();
      for (int i = 0; i < length; i++) {
        try {
          intArray[i] = singleValueType.toInt(valueArray[i]);
        } catch (ClassCastException e) {
          intArray[i] = anyToInt(valueArray[i]);
        }
      }
      return intArray;
```

### DuplicatedCode
Duplicated code
in `pinot-common/src/main/java/org/apache/pinot/common/utils/PinotDataType.java`
#### Snippet
```java
      PinotDataType singleValueType = getSingleValueType();
      for (int i = 0; i < length; i++) {
        try {
          longArray[i] = singleValueType.toLong(valueArray[i]);
        } catch (ClassCastException e) {
          longArray[i] = anyToLong(valueArray[i]);
        }
      }
      return longArray;
```

### DuplicatedCode
Duplicated code
in `pinot-common/src/main/java/org/apache/pinot/common/utils/PinotDataType.java`
#### Snippet
```java
      PinotDataType singleValueType = getSingleValueType();
      for (int i = 0; i < length; i++) {
        try {
          floatArray[i] = singleValueType.toFloat(valueArray[i]);
        } catch (ClassCastException e) {
          floatArray[i] = anyToFloat(valueArray[i]);
        }
      }
      return floatArray;
```

### DuplicatedCode
Duplicated code
in `pinot-common/src/main/java/org/apache/pinot/common/utils/PinotDataType.java`
#### Snippet
```java
      PinotDataType singleValueType = getSingleValueType();
      for (int i = 0; i < length; i++) {
        try {
          doubleArray[i] = singleValueType.toDouble(valueArray[i]);
        } catch (ClassCastException e) {
          doubleArray[i] = anyToDouble(valueArray[i]);
        }
      }
      return doubleArray;
```

### DuplicatedCode
Duplicated code
in `pinot-common/src/main/java/org/apache/pinot/common/utils/PinotDataType.java`
#### Snippet
```java
    if (cls == Integer.class) {
      return INTEGER;
    }
    if (cls == Long.class) {
      return LONG;
    }
    if (cls == Float.class) {
      return FLOAT;
    }
    if (cls == Double.class) {
      return DOUBLE;
    }
```

### DuplicatedCode
Duplicated code
in `pinot-common/src/main/java/org/apache/pinot/common/utils/SqlResultComparator.java`
#### Snippet
```java
      SqlSelect selectNode;
      if (sqlNode instanceof SqlOrderBy) {
        // Store order-by info into the select sql node
        SqlOrderBy orderByNode = (SqlOrderBy) sqlNode;
        selectNode = (SqlSelect) orderByNode.query;
        selectNode.setOrderBy(orderByNode.orderList);
        selectNode.setFetch(orderByNode.fetch);
        selectNode.setOffset(orderByNode.offset);
      } else {
        selectNode = (SqlSelect) sqlNode;
      }
```

### DuplicatedCode
Duplicated code
in `pinot-common/src/main/java/org/apache/pinot/common/utils/fetcher/HttpSegmentFetcher.java`
#### Snippet
```java
        String hostName = downloadURI.getHost();
        int port = downloadURI.getPort();
        // If the original download address is specified as host name, need add a "HOST" HTTP header to the HTTP
        // request. Otherwise, if the download address is a LB address, when the LB be configured as "disallow direct
        // access by IP address", downloading will fail.
        List<Header> httpHeaders = new LinkedList<>();
        if (!InetAddresses.isInetAddress(hostName)) {
          httpHeaders.add(new BasicHeader(HttpHeaders.HOST, hostName + ":" + port));
        }
```

### DuplicatedCode
Duplicated code
in `pinot-common/src/main/java/org/apache/pinot/common/utils/fetcher/HttpSegmentFetcher.java`
#### Snippet
```java
      } catch (HttpErrorStatusException e) {
        int statusCode = e.getStatusCode();
        if (statusCode == HttpStatus.SC_NOT_FOUND || statusCode >= 500) {
          // Temporary exception
          // 404 is treated as a temporary exception, as the downloadURI may be backed by multiple hosts,
          // if singe host is down, can retry with another host.
          _logger.warn("Got temporary error status code: {} while downloading segment from: {} to: {}", statusCode, uri,
              dest, e);
          return false;
        } else {
          // Permanent exception
          _logger.error("Got permanent error status code: {} while downloading segment from: {} to: {}, won't retry",
              statusCode, uri, dest, e);
          throw e;
        }
      } catch (Exception e) {
```

### DuplicatedCode
Duplicated code
in `pinot-common/src/main/java/org/apache/pinot/common/utils/fetcher/SegmentFetcherFactory.java`
#### Snippet
```java
    if (crypterName == null) {
      fetchSegmentToLocal(uri, dest);
    } else {
      // download
      File tempDownloadedFile = new File(dest.getPath() + ENCODED_SUFFIX);
      fetchSegmentToLocal(uri, tempDownloadedFile);

      // decrypt
      PinotCrypter crypter = PinotCrypterFactory.create(crypterName);
      crypter.decrypt(tempDownloadedFile, dest);
    }
```

### DuplicatedCode
Duplicated code
in `pinot-common/src/main/java/org/apache/pinot/common/utils/helix/HelixHelper.java`
#### Snippet
```java
      for (String partition : resourceExternalView.getPartitionSet()) {
        Map<String, String> stateMap = resourceExternalView.getStateMap(partition);
        for (String instance : stateMap.keySet()) {
          if (stateMap.get(instance).equalsIgnoreCase(ONLINE)) {
            instanceSet.add(instance);
          }
        }
      }
```

### DuplicatedCode
Duplicated code
in `pinot-common/src/main/java/org/apache/pinot/common/utils/http/HttpClient.java`
#### Snippet
```java
    AuthProviderUtils.toRequestHeaders(authProvider).forEach(requestBuilder::addHeader);
    if (MapUtils.isNotEmpty(headers)) {
      for (Map.Entry<String, String> header : headers.entrySet()) {
        requestBuilder.addHeader(header.getKey(), header.getValue());
      }
    }
    setTimeout(requestBuilder, DELETE_REQUEST_SOCKET_TIMEOUT_MS);
    return sendRequest(requestBuilder.build());
```

### DuplicatedCode
Duplicated code
in `pinot-common/src/main/java/org/apache/pinot/common/utils/http/HttpClient.java`
#### Snippet
```java
    if (payload != null) {
      requestBuilder.setEntity(payload);
    }
    AuthProviderUtils.toRequestHeaders(authProvider).forEach(requestBuilder::addHeader);
    if (MapUtils.isNotEmpty(headers)) {
      for (Map.Entry<String, String> header : headers.entrySet()) {
        requestBuilder.addHeader(header.getKey(), header.getValue());
      }
    }
    setTimeout(requestBuilder, DEFAULT_SOCKET_TIMEOUT_MS);
    return sendRequest(requestBuilder.build());
```

### DuplicatedCode
Duplicated code
in `pinot-common/src/main/java/org/apache/pinot/common/utils/http/HttpClient.java`
#### Snippet
```java
    Map<String, String> headersWrapper = MapUtils.isEmpty(headers) ? new HashMap<>() : new HashMap<>(headers);
    headersWrapper.put(HttpHeaders.CONTENT_TYPE, JSON_CONTENT_TYPE);
    HttpEntity entity =
        jsonRequestBody == null ? null : new StringEntity(jsonRequestBody, ContentType.APPLICATION_JSON);
```

### DuplicatedCode
Duplicated code
in `pinot-common/src/main/java/org/apache/pinot/common/utils/http/HttpClient.java`
#### Snippet
```java
    MultipartEntityBuilder builder = MultipartEntityBuilder.create();
    builder.addTextBody("body", body);
    post.setEntity(builder.build());
    if (MapUtils.isNotEmpty(headers)) {
      for (String key : headers.keySet()) {
        post.addHeader(key, headers.get(key));
      }
    }
    try (CloseableHttpResponse response = _httpClient.execute(post)) {
      StatusLine statusLine = response.getStatusLine();
      int statusCode = statusLine.getStatusCode();
      if (statusCode >= 300) {
        return new SimpleHttpResponse(statusCode, getErrorMessage(post, response));
      }
      return new SimpleHttpResponse(statusCode, EntityUtils.toString(response.getEntity()));
    }
```

### DuplicatedCode
Duplicated code
in `pinot-common/src/main/java/org/apache/pinot/sql/parsers/CalciteSqlCompiler.java`
#### Snippet
```java
    BrokerRequest brokerRequest = new BrokerRequest();
    brokerRequest.setPinotQuery(pinotQuery);
    // Set table name in broker request because it is used for access control, query routing etc.
    DataSource dataSource = pinotQuery.getDataSource();
    if (dataSource != null) {
      QuerySource querySource = new QuerySource();
      querySource.setTableName(dataSource.getTableName());
      brokerRequest.setQuerySource(querySource);
    }
```

### DuplicatedCode
Duplicated code
in `pinot-common/src/main/java/org/apache/pinot/sql/parsers/CalciteSqlParser.java`
#### Snippet
```java
    int numOperands = operands.size();

    // Check that there are exactly 3 or 4 arguments
    if (numOperands != 3 && numOperands != 4) {
      throw new SqlCompilationException(
          "Expect 3 or 4 arguments for transform function: jsonExtractScalar(jsonFieldName, 'jsonPath', "
              + "'resultsType', ['defaultValue'])");
    }
    if (!operands.get(1).isSetLiteral() || !operands.get(2).isSetLiteral() || (numOperands == 4 && !operands.get(3)
        .isSetLiteral())) {
      throw new SqlCompilationException(
          "Expect the 2nd/3rd/4th argument of transform function: jsonExtractScalar(jsonFieldName, 'jsonPath',"
              + " 'resultsType', ['defaultValue']) to be a single-quoted literal value.");
    }
```

### DuplicatedCode
Duplicated code
in `pinot-connectors/pinot-flink-connector/src/main/java/org/apache/pinot/connector/flink/sink/FlinkSegmentWriter.java`
#### Snippet
```java
    _tableConfig = tableConfig;
    _tableNameWithType = _tableConfig.getTableName();
    Preconditions.checkState(
        _tableConfig.getIngestionConfig() != null && _tableConfig.getIngestionConfig().getBatchIngestionConfig() != null
            && CollectionUtils.isNotEmpty(
            _tableConfig.getIngestionConfig().getBatchIngestionConfig().getBatchConfigMaps()),
        "Must provide ingestionConfig->batchIngestionConfig->batchConfigMaps in tableConfig for table: %s",
        _tableNameWithType);
    _batchIngestionConfig = _tableConfig.getIngestionConfig().getBatchIngestionConfig();
    Preconditions.checkState(_batchIngestionConfig.getBatchConfigMaps().size() == 1,
        "batchConfigMaps must contain only 1 BatchConfig for table: %s", _tableNameWithType);
```

### DuplicatedCode
Duplicated code
in `pinot-connectors/pinot-flink-connector/src/main/java/org/apache/pinot/connector/flink/sink/FlinkSegmentWriter.java`
#### Snippet
```java
    _batchConfig = new BatchConfig(_tableNameWithType, batchConfigMap);

    Preconditions.checkState(StringUtils.isNotBlank(_batchConfig.getOutputDirURI()),
        "Must provide: %s in batchConfigs for table: %s", BatchConfigProperties.OUTPUT_DIR_URI, _tableNameWithType);
    _outputDirURI = _batchConfig.getOutputDirURI();
    Files.createDirectories(Paths.get(_outputDirURI));

    _schema = schema;
    _fieldsToRead = _schema.getColumnNames();
    _recordTransformer = CompositeTransformer.getDefaultTransformer(_tableConfig, _schema);
    _avroSchema = SegmentProcessorAvroUtils.convertPinotSchemaToAvroSchema(_schema);
    _reusableRecord = new GenericData.Record(_avroSchema);
```

### DuplicatedCode
Duplicated code
in `pinot-connectors/pinot-flink-connector/src/main/java/org/apache/pinot/connector/flink/sink/FlinkSegmentWriter.java`
#### Snippet
```java
      File segmentDir = new File(flushDir, "segment_dir");

      // Make BatchIngestionConfig for flush
      Map<String, String> batchConfigMapOverride = new HashMap<>(_batchConfig.getBatchConfigMap());
      batchConfigMapOverride.put(BatchConfigProperties.INPUT_DIR_URI, _bufferFile.getAbsolutePath());
      batchConfigMapOverride.put(BatchConfigProperties.OUTPUT_DIR_URI, segmentDir.getAbsolutePath());
      batchConfigMapOverride.put(BatchConfigProperties.INPUT_FORMAT, BUFFER_FILE_FORMAT.toString());
      BatchIngestionConfig batchIngestionConfig = new BatchIngestionConfig(Lists.newArrayList(batchConfigMapOverride),
          _batchIngestionConfig.getSegmentIngestionType(), _batchIngestionConfig.getSegmentIngestionFrequency(),
          _batchIngestionConfig.getConsistentDataPush());

      // Build segment
      SegmentGeneratorConfig segmentGeneratorConfig =
          IngestionUtils.generateSegmentGeneratorConfig(_tableConfig, _schema, batchIngestionConfig);
```

### DuplicatedCode
Duplicated code
in `pinot-controller/src/main/java/org/apache/pinot/controller/BaseControllerStarter.java`
#### Snippet
```java
        if (_isStarted) {
          // If we've connected to Helix at some point, the instance status depends on being connected to ZK
          if (helixManager.isConnected()) {
            return ServiceStatus.Status.GOOD;
          } else {
            return ServiceStatus.Status.BAD;
          }
        }

        // Return starting until zk is connected
        if (!helixManager.isConnected()) {
          return ServiceStatus.Status.STARTING;
        } else {
          _isStarted = true;
          _statusDescription = ServiceStatus.STATUS_DESCRIPTION_NONE;
          return ServiceStatus.Status.GOOD;
        }
```

### DuplicatedCode
Duplicated code
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/LLCSegmentCompletionHandlers.java`
#### Snippet
```java
    if (instanceId == null || segmentName == null || (offset == -1 && streamPartitionMsgOffset == null)) {
      LOGGER.error("Invalid call: offset={}, segmentName={}, instanceId={}, streamPartitionMsgOffset={}", offset,
          segmentName, instanceId, streamPartitionMsgOffset);
      return SegmentCompletionProtocol.RESP_FAILED.toJsonString();
    }
    SegmentCompletionProtocol.Request.Params requestParams = new SegmentCompletionProtocol.Request.Params();
```

### DuplicatedCode
Duplicated code
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotLeadControllerRestletResource.java`
#### Snippet
```java
    HelixManager helixManager = _pinotHelixResourceManager.getHelixZkManager();
    boolean isLeadControllerResourceEnabled;
    try {
      isLeadControllerResourceEnabled = LeadControllerUtils.isLeadControllerResourceEnabled(helixManager);
    } catch (Exception e) {
      throw new ControllerApplicationException(LOGGER,
          "Exception when checking whether lead controller resource is enabled or not.",
          Response.Status.INTERNAL_SERVER_ERROR, e);
    }

    // Returns empty map if lead controller resource is disabled.
    if (!isLeadControllerResourceEnabled) {
      return new LeadControllerResponse(false, leadControllerEntryMap);
    }

    ExternalView leadControllerResourceExternalView = getLeadControllerResourceExternalView(helixManager);
```

### DuplicatedCode
Duplicated code
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotQueryResource.java`
#### Snippet
```java
    if (instanceIds.isEmpty()) {
      return QueryException.BROKER_RESOURCE_MISSING_ERROR.toString();
    }

    instanceIds.retainAll(_pinotHelixResourceManager.getOnlineInstanceList());
    if (instanceIds.isEmpty()) {
      return QueryException.BROKER_INSTANCE_MISSING_ERROR.toString();
    }

    // Send query to a random broker.
    String instanceId = instanceIds.get(RANDOM.nextInt(instanceIds.size()));
    return sendRequestToBroker(query, instanceId, traceEnabled, queryOptions, httpHeaders);
```

### DuplicatedCode
Duplicated code
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotSchemaRestletResource.java`
#### Snippet
```java
    Pair<Schema, Map<String, Object>> schemaAndUnrecognizedProps = null;
    try {
      schemaAndUnrecognizedProps = JsonUtils.stringToObjectAndUnrecognizedProperties(schemaJsonString, Schema.class);
    } catch (Exception e) {
      String msg = String.format("Invalid schema config json string: %s", schemaJsonString);
      throw new ControllerApplicationException(LOGGER, msg, Response.Status.BAD_REQUEST, e);
    }
    Schema schema = schemaAndUnrecognizedProps.getLeft();
```

### DuplicatedCode
Duplicated code
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotSchemaRestletResource.java`
#### Snippet
```java
    validateSchemaInternal(schema);
    AccessControlUtils.validatePermission(schema.getSchemaName(), AccessType.READ, httpHeaders, endpointUrl,
        _accessControlFactory.create());
    ObjectNode response = schema.toJsonObject();
    response.set("unrecognizedProperties", JsonUtils.objectToJsonNode(schemaAndUnrecognizedProps.getRight()));
    try {
      return JsonUtils.objectToPrettyString(response);
    } catch (JsonProcessingException e) {
      throw new RuntimeException(e);
    }
```

### DuplicatedCode
Duplicated code
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotSegmentRestletResource.java`
#### Snippet
```java
    long startTimestamp;
    long endTimestamp;
    try {
      startTimestamp = Strings.isNullOrEmpty(startTimestampStr) ? Long.MIN_VALUE : Long.parseLong(startTimestampStr);
      endTimestamp = Strings.isNullOrEmpty(endTimestampStr) ? Long.MAX_VALUE : Long.parseLong(endTimestampStr);
    } catch (NumberFormatException e) {
      throw new ControllerApplicationException(LOGGER,
          "Failed to parse the start/end timestamp. Please make sure they are in 'millisSinceEpoch' format.",
          Response.Status.BAD_REQUEST, e);
    }
    Preconditions.checkArgument(startTimestamp < endTimestamp,
        "The value of startTimestamp should be smaller than the one of endTimestamp. Start timestamp: %d. End "
            + "timestamp: %d", startTimestamp, endTimestamp);

    List<String> tableNamesWithType = ResourceUtils.getExistingTableNamesWithType(_pinotHelixResourceManager, tableName,
        Constants.validateTableType(tableTypeStr), LOGGER);
```

### DuplicatedCode
Duplicated code
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotSegmentRestletResource.java`
#### Snippet
```java
    BiMap<String, String> serverEndPoints =
        _pinotHelixResourceManager.getDataInstanceAdminEndpoints(serverToSegments.keySet());
    CompletionServiceHelper completionServiceHelper =
        new CompletionServiceHelper(_executor, _connectionManager, serverEndPoints);

    List<String> serverUrls = new ArrayList<>();
    BiMap<String, String> endpointsToServers = serverEndPoints.inverse();
```

### DuplicatedCode
Duplicated code
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotTableIndexingConfigs.java`
#### Snippet
```java
    TableConfig tableConfig;
    try {
      tableConfig = JsonUtils.stringToObject(tableConfigString, TableConfig.class);
      Schema schema = _pinotHelixResourceManager.getSchemaForTableConfig(tableConfig);
      TableConfigUtils.validate(tableConfig, schema);
    } catch (Exception e) {
      String msg = String.format("Invalid table config: %s", tableName);
      throw new ControllerApplicationException(LOGGER, msg, Response.Status.BAD_REQUEST, e);
    }
```

### DuplicatedCode
Duplicated code
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/PinotHelixBrokerResourceOnlineOfflineStateModelGenerator.java`
#### Snippet
```java
ZNRecord record = new ZNRecord(PINOT_BROKER_RESOURCE_ONLINE_OFFLINE_STATE_MODEL);

    /*
     * initial state in always offline for an instance.
     *
     */
    record.setSimpleField(StateModelDefinitionProperty.INITIAL_STATE.toString(), OFFLINE_STATE);

    /*
     * this is a ondered list of states in which we want the instances to be in. the first entry is
     * given the top most priority.
     *
     */

    List<String> statePriorityList = new ArrayList<String>();
    statePriorityList.add(ONLINE_STATE);
    statePriorityList.add(OFFLINE_STATE);
    statePriorityList.add(DROPPED_STATE);
    record.setListField(StateModelDefinitionProperty.STATE_PRIORITY_LIST.toString(), statePriorityList);

    /**
     *
     * If you are wondering what R and -1 signify, here is an explanation -1 means that don't even
     * try to keep any instances in this state. R says that all instances in the preference list
     * should be in this state.
     *
     */
    for (String state : statePriorityList) {
      String key = state + ".meta";
      Map<String, String> metadata = new HashMap<String, String>();
      if (state.equals(ONLINE_STATE)) {
        metadata.put("count", "R");
        record.setMapField(key, metadata);
      }
      if (state.equals(OFFLINE_STATE)) {
        metadata.put("count", "-1");
        record.setMapField(key, metadata);
      }
      if (state.equals(DROPPED_STATE)) {
        metadata.put("count", "-1");
        record.setMapField(key, metadata);
      }
    }

    /*
     * construction a state transition table, this tells the controller the next state given initial
     * and final states.
     *
     */
    for (String state : statePriorityList) {
      String key = state + ".next";
      if (state.equals(ONLINE_STATE)) {
        Map<String, String> metadata = new HashMap<String, String>();
        metadata.put(OFFLINE_STATE, OFFLINE_STATE);
        metadata.put(DROPPED_STATE, DROPPED_STATE);
        record.setMapField(key, metadata);
      }
      if (state.equals("OFFLINE")) {
        Map<String, String> metadata = new HashMap<String, String>();
        metadata.put(ONLINE_STATE, ONLINE_STATE);
        metadata.put(DROPPED_STATE, DROPPED_STATE);
        record.setMapField(key, metadata);
      }
    }

    /*
     * This is the transition priority list, again the first inserted gets the top most priority.
     *
     */
    List<String> stateTransitionPriorityList = new ArrayList<String>();

    stateTransitionPriorityList.add("ONLINE-OFFLINE");
    stateTransitionPriorityList.add("ONLINE-DROPPED");
    stateTransitionPriorityList.add("OFFLINE-ONLINE");
    stateTransitionPriorityList.add("OFFLINE-DROPPED");

    record.setListField(StateModelDefinitionProperty.STATE_TRANSITION_PRIORITYLIST.toString(),
        stateTransitionPriorityList);
```

### DuplicatedCode
Duplicated code
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/assignment/instance/FDAwareInstancePartitionSelector.java`
#### Snippet
```java
      int numPartitions = _replicaGroupPartitionConfig.getNumPartitions();
      if (numPartitions <= 0) {
        numPartitions = 1;
      }
      // Assign all instances within a replica-group to each partition if not configured
      int numInstancesPerPartition = _replicaGroupPartitionConfig.getNumInstancesPerPartition();
      if (numInstancesPerPartition > 0) {
        Preconditions.checkState(numInstancesPerPartition <= numInstancesPerReplicaGroup,
            "Number of instances per partition: %s must be smaller or equal to number of instances per replica-group:"
                + " %s", numInstancesPerPartition, numInstancesPerReplicaGroup);
      } else {
        numInstancesPerPartition = numInstancesPerReplicaGroup;
      }
      LOGGER.info("Selecting {} partitions, {} instances per partition within a replica-group for table: {}",
          numPartitions, numInstancesPerPartition, _tableNameWithType);
```

### DuplicatedCode
Duplicated code
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/minion/PinotHelixTaskResourceManager.java`
#### Snippet
```java
    Map<String, TaskDebugInfo> taskDebugInfos = new TreeMap<>();
    WorkflowContext workflowContext = _taskDriver.getWorkflowContext(getHelixJobQueueName(taskType));
    if (workflowContext == null) {
      return taskDebugInfos;
    }
    Map<String, TaskState> helixJobStates = workflowContext.getJobStates();
```

### DuplicatedCode
Duplicated code
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/realtime/MissingConsumingSegmentFinder.java`
#### Snippet
```java
      try {
        ZNRecord znRecord = _propertyStore
            .get(ZKMetadataProvider.constructPropertyStorePathForSegment(tableName, segmentName), stat,
                AccessOption.PERSISTENT);
        Preconditions.checkState(znRecord != null, "Failed to find segment ZK metadata for segment: %s of table: %s",
            segmentName, tableName);
        return new SegmentZKMetadata(znRecord);
      } catch (Exception e) {
        _controllerMetrics.addMeteredTableValue(tableName, ControllerMeter.LLC_ZOOKEEPER_FETCH_FAILURES, 1L);
        throw e;
      }
```

### DuplicatedCode
Duplicated code
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/realtime/SegmentCompletionManager.java`
#### Snippet
```java
    final String segmentNameStr = reqParams.getSegmentName();
    final LLCSegmentName segmentName = new LLCSegmentName(segmentNameStr);
    final String tableName = segmentName.getTableName();
    if (!isLeader(tableName) || !_helixManager.isConnected()) {
      return SegmentCompletionProtocol.RESP_NOT_LEADER;
    }
    final String instanceId = reqParams.getInstanceId();
```

### DuplicatedCode
Duplicated code
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/rebalance/TableRebalancer.java`
#### Snippet
```java
    Map<String, Map<String, String>> nextAssignment = new TreeMap<>();
    Map<String, Integer> numSegmentsToOffloadMap = getNumSegmentsToOffloadMap(currentAssignment, targetAssignment);
    Map<Pair<Set<String>, Set<String>>, Set<String>> assignmentMap = new HashMap<>();
```

### DuplicatedCode
Duplicated code
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/rules/impl/BloomFilterRule.java`
#### Snippet
```java
    int numCols = _input.getNumCols();
    double[] weights = new double[numCols];
    AtomicDouble totalWeight = new AtomicDouble(0);

    // For each query, find out the dimensions used in 'EQ'
    // and accumulate the (weighted) frequencies
    _input.getParsedQueries().forEach(query -> {
      Double weight = _input.getQueryWeight(query);
      totalWeight.addAndGet(weight);
      FixedLenBitset fixedLenBitset = parseQuery(_input.getQueryContext(query));
      LOGGER.debug("fixedLenBitset {}", fixedLenBitset);
      for (Integer i : fixedLenBitset.getOffsets()) {
        weights[i] += weight;
      }
    });
```

### DuplicatedCode
Duplicated code
in `pinot-tools/src/main/java/org/apache/pinot/tools/BootstrapTableTool.java`
#### Snippet
```java
LOGGER.info("Launch data ingestion job to build index segment for table {} and push to controller [{}]",
            tableName, controllerAuthority);
        try (Reader reader = new BufferedReader(new FileReader(ingestionJobSpecFile.getAbsolutePath()))) {
          SegmentGenerationJobSpec spec = new Yaml().loadAs(reader, SegmentGenerationJobSpec.class);

          // rewrite table and schema URI spec if the controller URI is not the same as the bootstrap tool setting.
          TableSpec tableSpec = spec.getTableSpec();
          URI tableConfigURI = URI.create(tableSpec.getTableConfigURI());
          tableSpec.setTableConfigURI(controllerAuthority + tableConfigURI.getPath());
          URI schemaURI = URI.create(tableSpec.getSchemaURI());
          tableSpec.setSchemaURI(controllerAuthority + schemaURI.getPath());
          PinotClusterSpec[] pinotClusterSpecs = spec.getPinotClusterSpecs();
          for (PinotClusterSpec pinotClusterSpec : pinotClusterSpecs) {
            pinotClusterSpec.setControllerURI(controllerAuthority);
          }

          String inputDirURI = spec.getInputDirURI();
          if (!new File(inputDirURI).exists()) {
            URL resolvedInputDirURI = BootstrapTableTool.class.getClassLoader().getResource(inputDirURI);
            if (resolvedInputDirURI != null && "jar".equals(resolvedInputDirURI.getProtocol())) {
              String[] splits = resolvedInputDirURI.getFile().split("!");
              String inputDir = new File(setupTableTmpDir, "inputData").toString();
              JarUtils.copyResourcesToDirectory(splits[0], splits[1].substring(1), inputDir);
              spec.setInputDirURI(inputDir);
            } else {
              spec.setInputDirURI(resolvedInputDirURI.toString());
            }
          }

          TlsSpec tlsSpec = spec.getTlsSpec();
          if (tlsSpec != null) {
            TlsUtils.installDefaultSSLSocketFactory(tlsSpec.getKeyStoreType(), tlsSpec.getKeyStorePath(),
                tlsSpec.getKeyStorePassword(), tlsSpec.getTrustStoreType(), tlsSpec.getTrustStorePath(),
                tlsSpec.getTrustStorePassword());
          }

          // url-based token needs to be resolved before job run
          spec.setAuthToken(AuthProviderUtils.toStaticToken(_authProvider));

          IngestionJobLauncher.runIngestionJob(spec);
        }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/common/datablock/DataBlockBuilder.java`
#### Snippet
```java
    _fixedSizeDataOutputStream.writeInt(_variableSizeDataByteArrayOutputStream.size());
    if (nullRowIds == null || nullRowIds.isEmpty()) {
      _fixedSizeDataOutputStream.writeInt(0);
    } else {
      byte[] bitmapBytes = RoaringBitmapUtils.serialize(nullRowIds);
      _fixedSizeDataOutputStream.writeInt(bitmapBytes.length);
      _variableSizeDataByteArrayOutputStream.write(bitmapBytes);
    }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/common/datablock/DataBlockBuilder.java`
#### Snippet
```java
    int numColumns = rowBuilder._numColumns;
    RoaringBitmap[] nullBitmaps = new RoaringBitmap[numColumns];
    DataSchema.ColumnDataType[] columnDataTypes = dataSchema.getColumnDataTypes();
    DataSchema.ColumnDataType[] storedColumnDataTypes = dataSchema.getStoredColumnDataTypes();
    Object[] nullPlaceholders = new Object[numColumns];
    for (int colId = 0; colId < numColumns; colId++) {
      nullBitmaps[colId] = new RoaringBitmap();
      nullPlaceholders[colId] = columnDataTypes[colId].convert(storedColumnDataTypes[colId].getNullPlaceholder());
    }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/common/datablock/DataBlockBuilder.java`
#### Snippet
```java
            if (value instanceof int[]) {
              int[] ints = (int[]) value;
              int length = ints.length;
              long[] longs = new long[length];
              ArrayCopyUtils.copy(ints, longs, length);
              setColumn(rowBuilder, byteBuffer, longs);
            } else {
              setColumn(rowBuilder, byteBuffer, (long[]) value);
            }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/common/datablock/DataBlockBuilder.java`
#### Snippet
```java
            if (value instanceof int[]) {
              int[] ints = (int[]) value;
              int length = ints.length;
              double[] doubles = new double[length];
              ArrayCopyUtils.copy(ints, doubles, length);
              setColumn(rowBuilder, byteBuffer, doubles);
            } else if (value instanceof long[]) {
              long[] longs = (long[]) value;
              int length = longs.length;
              double[] doubles = new double[length];
              ArrayCopyUtils.copy(longs, doubles, length);
              setColumn(rowBuilder, byteBuffer, doubles);
            } else if (value instanceof float[]) {
              float[] floats = (float[]) value;
              int length = floats.length;
              double[] doubles = new double[length];
              ArrayCopyUtils.copy(floats, doubles, length);
              setColumn(rowBuilder, byteBuffer, doubles);
            } else {
              setColumn(rowBuilder, byteBuffer, (double[]) value);
            }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/common/datatable/DataTableBuilderV2V3.java`
#### Snippet
```java
    String columnName = _dataSchema.getColumnName(colId);
    Map<String, Integer> dictionary = _dictionaryMap.get(columnName);
    if (dictionary == null) {
      dictionary = new HashMap<>();
      _dictionaryMap.put(columnName, dictionary);
      _reverseDictionaryMap.put(columnName, new HashMap<>());
    }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/common/evaluators/DefaultJsonPathEvaluator.java`
#### Snippet
```java
    if (reader.isDictionaryEncoded()) {
      reader.readDictIds(docIds, length, dictIdsBuffer, context);
      if (dictionary.getValueType() == FieldSpec.DataType.BYTES) {
        for (int i = 0; i < length; i++) {
          processValue(i, extractFromBytes(dictionary, dictIdsBuffer[i]), defaultValue, valueBuffer);
        }
      } else {
        for (int i = 0; i < length; i++) {
          processValue(i, extractFromString(dictionary, dictIdsBuffer[i]), defaultValue, valueBuffer);
        }
      }
    } else {
      switch (reader.getStoredType()) {
        case STRING:
          for (int i = 0; i < length; i++) {
            processValue(i, extractFromString(reader, context, docIds[i]), defaultValue, valueBuffer);
          }
          break;
        case BYTES:
          for (int i = 0; i < length; i++) {
            processValue(i, extractFromBytes(reader, context, docIds[i]), defaultValue, valueBuffer);
          }
          break;
        default:
          throw new IllegalStateException();
      }
    }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/common/evaluators/DefaultJsonPathEvaluator.java`
#### Snippet
```java
    if (reader.isDictionaryEncoded()) {
      reader.readDictIds(docIds, length, dictIdsBuffer, context);
      if (dictionary.getValueType() == FieldSpec.DataType.BYTES) {
        for (int i = 0; i < length; i++) {
          processList(i, extractFromBytes(dictionary, dictIdsBuffer[i]), valueBuffer);
        }
      } else {
        for (int i = 0; i < length; i++) {
          processList(i, extractFromString(dictionary, dictIdsBuffer[i]), valueBuffer);
        }
      }
    } else {
      switch (reader.getStoredType()) {
        case STRING:
          for (int i = 0; i < length; i++) {
            processList(i, extractFromString(reader, context, docIds[i]), valueBuffer);
          }
          break;
        case BYTES:
          for (int i = 0; i < length; i++) {
            processList(i, extractFromBytes(reader, context, docIds[i]), valueBuffer);
          }
          break;
        default:
          throw new IllegalStateException();
      }
    }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/data/table/IndexedTable.java`
#### Snippet
```java
        Object[] existingValues = v.getValues();
        Object[] newValues = newRecord.getValues();
        int aggNum = 0;
        for (int i = _numKeyColumns; i < _numColumns; i++) {
          existingValues[i] = _aggregationFunctions[aggNum++].merge(existingValues[i], newValues[i]);
        }
        return v;
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/geospatial/transform/function/StAsBinaryFunction.java`
#### Snippet
```java
    Preconditions.checkArgument(arguments.size() == 1, "Exactly 1 argument is required for transform function: %s",
        getName());
    TransformFunction transformFunction = arguments.get(0);
    Preconditions.checkArgument(transformFunction.getResultMetadata().isSingleValue(),
        "Argument must be single-valued for transform function: %s", getName());
    Preconditions.checkArgument(transformFunction.getResultMetadata().getDataType() == FieldSpec.DataType.BYTES,
        "The argument must be of bytes type");
    _transformFunction = transformFunction;
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/operator/combine/GroupByCombineOperator.java`
#### Snippet
```java
int operatorId;
    while ((operatorId = _nextOperatorId.getAndIncrement()) < _numOperators) {
      Operator operator = _operators.get(operatorId);
      try {
        if (operator instanceof AcquireReleaseColumnsSegmentOperator) {
          ((AcquireReleaseColumnsSegmentOperator) operator).acquire();
        }
        GroupByResultsBlock resultsBlock = (GroupByResultsBlock) operator.nextBlock();
        if (_indexedTable == null) {
          synchronized (this) {
            if (_indexedTable == null) {
              DataSchema dataSchema = resultsBlock.getDataSchema();
              // NOTE: Use trimSize as resultSize on server size.
              if (_trimThreshold >= MAX_TRIM_THRESHOLD) {
                // special case of trim threshold where it is set to max value.
                // there won't be any trimming during upsert in this case.
                // thus we can avoid the overhead of read-lock and write-lock
                // in the upsert method.
                _indexedTable = new UnboundedConcurrentIndexedTable(dataSchema, _queryContext, _trimSize);
              } else {
                _indexedTable =
                    new ConcurrentIndexedTable(dataSchema, _queryContext, _trimSize, _trimSize, _trimThreshold);
              }
            }
          }
        }

        // Merge processing exceptions.
        List<ProcessingException> processingExceptionsToMerge = resultsBlock.getProcessingExceptions();
        if (processingExceptionsToMerge != null) {
          _mergedProcessingExceptions.addAll(processingExceptionsToMerge);
        }

        // Set groups limit reached flag.
        if (resultsBlock.isNumGroupsLimitReached()) {
          _numGroupsLimitReached = true;
        }

        // Merge aggregation group-by result.
        // Iterate over the group-by keys, for each key, update the group-by result in the indexedTable
        Collection<IntermediateRecord> intermediateRecords = resultsBlock.getIntermediateRecords();
        // Count the number of merged keys
        int mergedKeys = 0;
        // For now, only GroupBy OrderBy query has pre-constructed intermediate records
        if (intermediateRecords == null) {
          // Merge aggregation group-by result.
          AggregationGroupByResult aggregationGroupByResult = resultsBlock.getAggregationGroupByResult();
          if (aggregationGroupByResult != null) {
            // Iterate over the group-by keys, for each key, update the group-by result in the indexedTable
            Iterator<GroupKeyGenerator.GroupKey> dicGroupKeyIterator = aggregationGroupByResult.getGroupKeyIterator();
            while (dicGroupKeyIterator.hasNext()) {
              GroupKeyGenerator.GroupKey groupKey = dicGroupKeyIterator.next();
              Object[] keys = groupKey._keys;
              Object[] values = Arrays.copyOf(keys, _numColumns);
              int groupId = groupKey._groupId;
              for (int i = 0; i < _numAggregationFunctions; i++) {
                values[_numGroupByExpressions + i] = aggregationGroupByResult.getResultForGroupId(i, groupId);
              }
              _indexedTable.upsert(new Key(keys), new Record(values));
              Tracing.ThreadAccountantOps.sampleAndCheckInterruptionPeriodically(mergedKeys);
              mergedKeys++;
            }
          }
        } else {
          for (IntermediateRecord intermediateResult : intermediateRecords) {
            //TODO: change upsert api so that it accepts intermediateRecord directly
            _indexedTable.upsert(intermediateResult._key, intermediateResult._record);
            Tracing.ThreadAccountantOps.sampleAndCheckInterruptionPeriodically(mergedKeys);
            mergedKeys++;
          }
        }
      } finally {
        if (operator instanceof AcquireReleaseColumnsSegmentOperator) {
          ((AcquireReleaseColumnsSegmentOperator) operator).release();
        }
      }
    }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/operator/combine/GroupByCombineOperator.java`
#### Snippet
```java
    if (!opCompleted) {
      // If this happens, the broker side should already timed out, just log the error and return
      String errorMessage =
          String.format("Timed out while combining group-by order-by results after %dms, queryContext = %s", timeoutMs,
              _queryContext);
      LOGGER.error(errorMessage);
      return new ExceptionResultsBlock(new TimeoutException(errorMessage));
    }

    IndexedTable indexedTable = _indexedTable;
    if (!_queryContext.isServerReturnFinalResult()) {
      indexedTable.finish(false);
    } else {
      indexedTable.finish(true, true);
    }
    GroupByResultsBlock mergedBlock = new GroupByResultsBlock(indexedTable);
    mergedBlock.setNumGroupsLimitReached(_numGroupsLimitReached);
    mergedBlock.setNumResizes(indexedTable.getNumResizes());
    mergedBlock.setResizeTimeMs(indexedTable.getResizeTimeMs());

    // Set the processing exceptions.
    if (!_mergedProcessingExceptions.isEmpty()) {
      mergedBlock.setProcessingExceptions(new ArrayList<>(_mergedProcessingExceptions));
    }

    return mergedBlock;
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/operator/combine/MinMaxValueBasedSelectionOrderByCombineOperator.java`
#### Snippet
```java
    DataSchema mergedDataSchema = mergedBlock.getDataSchema();
    DataSchema dataSchemaToMerge = blockToMerge.getDataSchema();
    assert mergedDataSchema != null && dataSchemaToMerge != null;
    if (!mergedDataSchema.equals(dataSchemaToMerge)) {
      String errorMessage =
          String.format("Data schema mismatch between merged block: %s and block to merge: %s, drop block to merge",
              mergedDataSchema, dataSchemaToMerge);
      // NOTE: This is segment level log, so log at debug level to prevent flooding the log.
      LOGGER.debug(errorMessage);
      mergedBlock.addToProcessingExceptions(
          QueryException.getException(QueryException.MERGE_RESPONSE_ERROR, errorMessage));
      return;
    }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/operator/dociditerators/ExpressionScanDocIdIterator.java`
#### Snippet
```java
        for (int i = 0; i < numDocs; i++) {
          int[] dictIds = dictIdsArray[i];
          int numDictIds = dictIds.length;
          _numEntriesScanned += numDictIds;
          if (_predicateEvaluator.applyMV(dictIds, numDictIds)) {
            matchingDocIds.add(_docIdBuffer[i]);
          }
        }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/operator/dociditerators/MVScanDocIdIterator.java`
#### Snippet
```java
    if (!docIdIterator.hasNext()) {
      return new MutableRoaringBitmap();
    }
    RoaringBitmapWriter<MutableRoaringBitmap> result;
    if (firstDoc.isPresent() && lastDoc.isPresent()) {
      result = RoaringBitmapWriter.bufferWriter()
          .expectedRange(firstDoc.getAsInt(), lastDoc.getAsInt())
          .runCompress(false)
          .get();
    } else {
      result = RoaringBitmapWriter.bufferWriter()
          .runCompress(false)
          .get();
    }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/operator/dociditerators/SVScanDocIdIterator.java`
#### Snippet
```java
      assert !nullBitmap.isEmpty();
      int copyToIdx = 0;
      for (int i = 0; i < limit; i++) {
        if (!nullBitmap.contains(docIds[i])) {
          // Compact non-null entries into the prefix of the docIds and values arrays.
          docIds[copyToIdx] = docIds[i];
          values[copyToIdx++] = values[i];
        }
      }
      return copyToIdx;
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/operator/filter/H3InclusionIndexFilterOperator.java`
#### Snippet
```java
    ExpressionFilterOperator expressionFilterOperator =
        new ExpressionFilterOperator(_segment, _queryContext, _predicate, _numDocs);
    ScanBasedDocIdIterator docIdIterator =
        (ScanBasedDocIdIterator) expressionFilterOperator.getNextBlock().getBlockDocIdSet().iterator();
    MutableRoaringBitmap result = docIdIterator.applyAnd(partialMatchDocIds);
    result.or(fullMatchDocIds);
    return new FilterBlock(new BitmapDocIdSet(result, _numDocs) {
      @Override
      public long getNumEntriesScannedInFilter() {
        return docIdIterator.getNumEntriesScanned();
      }
    });
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/operator/filter/predicate/EqualsPredicateEvaluatorFactory.java`
#### Snippet
```java
      super(eqPredicate);
      String predicateValue = PredicateUtils.getStoredValue(eqPredicate.getValue(), dataType);
      _matchingDictId = dictionary.indexOf(predicateValue);
      if (_matchingDictId >= 0) {
        _matchingDictIds = new int[]{_matchingDictId};
        if (dictionary.length() == 1) {
          _alwaysTrue = true;
        }
      } else {
        _matchingDictIds = new int[0];
        _alwaysFalse = true;
      }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/operator/filter/predicate/RangePredicateEvaluatorFactory.java`
#### Snippet
```java
      super(rangePredicate);
      if (lowerInclusive) {
        _inclusiveLowerBound = lowerBound;
      } else {
        _inclusiveLowerBound = lowerBound + 1;
        Preconditions.checkArgument(_inclusiveLowerBound > lowerBound, "Invalid range: %s", rangePredicate);
      }
      if (upperInclusive) {
        _inclusiveUpperBound = upperBound;
      } else {
        _inclusiveUpperBound = upperBound - 1;
        Preconditions.checkArgument(_inclusiveUpperBound < upperBound, "Invalid range: %s", rangePredicate);
      }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/operator/filter/predicate/RangePredicateEvaluatorFactory.java`
#### Snippet
```java
      super(rangePredicate);
      if (lowerInclusive) {
        _inclusiveLowerBound = lowerBound;
      } else {
        _inclusiveLowerBound = Math.nextUp(lowerBound);
        Preconditions.checkArgument(_inclusiveLowerBound > lowerBound, "Invalid range: %s", rangePredicate);
      }
      if (upperInclusive) {
        _inclusiveUpperBound = upperBound;
      } else {
        _inclusiveUpperBound = Math.nextDown(upperBound);
        Preconditions.checkArgument(_inclusiveUpperBound < upperBound, "Invalid range: %s", rangePredicate);
      }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/operator/query/AggregationOperator.java`
#### Snippet
```java
    if (_aggregationFunctions.length > 0) {
      stringBuilder.append(_aggregationFunctions[0].toExplainString());
      for (int i = 1; i < _aggregationFunctions.length; i++) {
        stringBuilder.append(", ").append(_aggregationFunctions[i].toExplainString());
      }
    }

    return stringBuilder.append(')').toString();
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/operator/query/FilteredGroupByOperator.java`
#### Snippet
```java
    StringBuilder stringBuilder = new StringBuilder(EXPLAIN_NAME).append("(groupKeys:");
    if (_groupByExpressions.length > 0) {
      stringBuilder.append(_groupByExpressions[0].toString());
      for (int i = 1; i < _groupByExpressions.length; i++) {
        stringBuilder.append(", ").append(_groupByExpressions[i].toString());
      }
    }

    stringBuilder.append(", aggregations:");
    if (_aggregationFunctions.length > 0) {
      stringBuilder.append(_aggregationFunctions[0].toExplainString());
      for (int i = 1; i < _aggregationFunctions.length; i++) {
        stringBuilder.append(", ").append(_aggregationFunctions[i].toExplainString());
      }
    }

    return stringBuilder.append(')').toString();
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/operator/query/SelectionOnlyOperator.java`
#### Snippet
```java
    StringBuilder stringBuilder = new StringBuilder(EXPLAIN_NAME).append("(selectList:");
    if (!_expressions.isEmpty()) {
      stringBuilder.append(_expressions.get(0));
      for (int i = 1; i < _expressions.size(); i++) {
        stringBuilder.append(", ").append(_expressions.get(i));
      }
    }
    return stringBuilder.append(')').toString();
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/operator/query/SelectionOnlyOperator.java`
#### Snippet
```java
      if (_nullHandlingEnabled) {
        for (int i = 0; i < numExpressions; i++) {
          _nullBitmaps[i] = _blockValSets[i].getNullBitmap();
        }
        for (int docId = 0; docId < numDocsToAdd; docId++) {
          Object[] values = blockValueFetcher.getRow(docId);
          for (int colId = 0; colId < numExpressions; colId++) {
            if (_nullBitmaps[colId] != null && _nullBitmaps[colId].contains(docId)) {
              values[colId] = null;
            }
          }
          _rows.add(values);
        }
      } else {
        for (int i = 0; i < numDocsToAdd; i++) {
          _rows.add(blockValueFetcher.getRow(i));
        }
      }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/operator/transform/function/BinaryOperatorTransformFunction.java`
#### Snippet
```java
    switch (_rightStoredType) {
      case INT:
        fillIntResultArray(valueBlock, leftIntValues, length);
        break;
      case LONG:
        fillLongResultArray(valueBlock, leftIntValues, length);
        break;
      case FLOAT:
        fillFloatResultArray(valueBlock, leftIntValues, length);
        break;
      case DOUBLE:
        fillDoubleResultArray(valueBlock, leftIntValues, length);
        break;
      case BIG_DECIMAL:
        fillBigDecimalResultArray(valueBlock, leftIntValues, length);
        break;
      case STRING:
        fillStringResultArray(valueBlock, leftIntValues, length);
        break;
      case UNKNOWN:
        fillResultUnknown(length);
        break;
      default:
        throw illegalState();
    }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/operator/transform/function/BinaryOperatorTransformFunction.java`
#### Snippet
```java
    String[] rightStringValues = _rightTransformFunction.transformToStringValuesSV(valueBlock);
    for (int i = 0; i < length; i++) {
      try {
        _intValuesSV[i] =
            getIntResult(BigDecimal.valueOf(leftValues[i]).compareTo(new BigDecimal(rightStringValues[i])));
      } catch (NumberFormatException e) {
        _intValuesSV[i] = 0;
      }
    }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/operator/transform/function/CaseTransformFunction.java`
#### Snippet
```java
        if (_numSelections == 1) {
          System.arraycopy(intValues, 0, _intValuesSV, 0, numDocs);
        } else {
          for (int j = 0; j < numDocs; j++) {
            if (selected[j] == i) {
              _intValuesSV[j] = intValues[j];
            }
          }
        }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/operator/transform/function/DivisionTransformFunction.java`
#### Snippet
```java
    _resultDataType = DataType.DOUBLE;
    for (TransformFunction argument : arguments) {
      if (argument.getResultMetadata().getDataType() == DataType.BIG_DECIMAL) {
        _resultDataType = DataType.BIG_DECIMAL;
        break;
      }
    }
    if (_resultDataType == DataType.BIG_DECIMAL) {
      _bigDecimalLiterals = new BigDecimal[2];
    } else {
      _doubleLiterals = new double[2];
    }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/operator/transform/function/GreatestTransformFunction.java`
#### Snippet
```java
      for (int j = 0; j < numDocs & j < values.getLeft().length; j++) {
        // If current value is not null, we process the data.
        if (curNull == null || !curNull.contains(j)) {
          // If existing maximum value is null, we set the value directly.
          if (nullBitmap != null && nullBitmap.contains(j)) {
            _intValuesSV[j] = values.getLeft()[j];
          } else {
            _intValuesSV[j] = Math.max(_intValuesSV[j], values.getLeft()[j]);
          }
        }
      }
      if (nullBitmap != null && curNull != null) {
        nullBitmap.and(curNull);
      } else {
        nullBitmap = null;
      }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/operator/transform/function/LeastTransformFunction.java`
#### Snippet
```java
      for (int j = 0; j < numDocs & j < values.getLeft().length; j++) {
        // If current value is not null, we process the data.
        if (curNull == null || !curNull.contains(j)) {
          // If existing minimum value is null, we set the value directly.
          if (nullBitmap != null && nullBitmap.contains(j)) {
            _intValuesSV[j] = values.getLeft()[j];
          } else {
            _intValuesSV[j] = Math.min(_intValuesSV[j], values.getLeft()[j]);
          }
        }
      }
      if (nullBitmap != null && curNull != null) {
        nullBitmap.and(curNull);
      } else {
        nullBitmap = null;
      }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/BaseDistinctAggregateAggregationFunction.java`
#### Snippet
```java
    BlockValSet blockValSet = blockValSetMap.get(_expression);

    // For dictionary-encoded expression, store dictionary ids into the bitmap
    Dictionary dictionary = blockValSet.getDictionary();
    if (dictionary != null) {
      RoaringBitmap dictIdBitmap = getDictIdBitmap(aggregationResultHolder, dictionary);
      int[][] dictIds = blockValSet.getDictionaryIdsMV();
      for (int i = 0; i < length; i++) {
        dictIdBitmap.add(dictIds[i]);
      }
      return;
    }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/DistinctCountBitmapAggregationFunction.java`
#### Snippet
```java
    Dictionary dictionary = blockValSet.getDictionary();
    if (dictionary != null) {
      int[] dictIds = blockValSet.getDictionaryIdsSV();
      for (int i = 0; i < length; i++) {
        getDictIdBitmap(groupByResultHolder, groupKeyArray[i], dictionary).add(dictIds[i]);
      }
      return;
    }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/BaseDistinctAggregateAggregationFunction.java`
#### Snippet
```java
    BlockValSet blockValSet = blockValSetMap.get(_expression);

    // For dictionary-encoded expression, store dictionary ids into the bitmap
    Dictionary dictionary = blockValSet.getDictionary();
    if (dictionary != null) {
      int[][] dictIds = blockValSet.getDictionaryIdsMV();
      for (int i = 0; i < length; i++) {
        getDictIdBitmap(groupByResultHolder, groupKeyArray[i], dictionary).add(dictIds[i]);
      }
      return;
    }

    // For non-dictionary-encoded expression, store values into the value set
    DataType storedType = blockValSet.getValueType().getStoredType();
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/BaseDistinctAggregateAggregationFunction.java`
#### Snippet
```java
        for (int i = 0; i < length; i++) {
          ObjectOpenHashSet<String> stringSet =
              (ObjectOpenHashSet<String>) getValueSet(groupByResultHolder, groupKeyArray[i], DataType.STRING);
          //noinspection ManualArrayToCollectionCopy
          for (String value : stringValues[i]) {
            //noinspection UseBulkOperation
            stringSet.add(value);
          }
        }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/DistinctCountBitmapAggregationFunction.java`
#### Snippet
```java
    Dictionary dictionary = blockValSet.getDictionary();
    if (dictionary != null) {
      int[] dictIds = blockValSet.getDictionaryIdsSV();
      for (int i = 0; i < length; i++) {
        setDictIdForGroupKeys(groupByResultHolder, groupKeysArray[i], dictionary, dictIds[i]);
      }
      return;
    }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/BaseDistinctAggregateAggregationFunction.java`
#### Snippet
```java
    BlockValSet blockValSet = blockValSetMap.get(_expression);

    // For dictionary-encoded expression, store dictionary ids into the bitmap
    Dictionary dictionary = blockValSet.getDictionary();
    if (dictionary != null) {
      int[][] dictIds = blockValSet.getDictionaryIdsMV();
      for (int i = 0; i < length; i++) {
        for (int groupKey : groupKeysArray[i]) {
          getDictIdBitmap(groupByResultHolder, groupKey, dictionary).add(dictIds[i]);
        }
      }
      return;
    }

    // For non-dictionary-encoded expression, store hash code of the values into the value set
    DataType storedType = blockValSet.getValueType().getStoredType();
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/BaseDistinctAggregateAggregationFunction.java`
#### Snippet
```java
        for (int i = 0; i < length; i++) {
          for (int groupKey : groupKeysArray[i]) {
            IntOpenHashSet intSet = (IntOpenHashSet) getValueSet(groupByResultHolder, groupKey, DataType.INT);
            for (int value : intValues[i]) {
              intSet.add(value);
            }
          }
        }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/BaseDistinctAggregateAggregationFunction.java`
#### Snippet
```java
        for (int i = 0; i < length; i++) {
          for (int groupKey : groupKeysArray[i]) {
            LongOpenHashSet longSet = (LongOpenHashSet) getValueSet(groupByResultHolder, groupKey, DataType.LONG);
            for (long value : longValues[i]) {
              longSet.add(value);
            }
          }
        }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/BaseDistinctAggregateAggregationFunction.java`
#### Snippet
```java
        for (int i = 0; i < length; i++) {
          for (int groupKey : groupKeysArray[i]) {
            FloatOpenHashSet floatSet = (FloatOpenHashSet) getValueSet(groupByResultHolder, groupKey, DataType.FLOAT);
            for (float value : floatValues[i]) {
              floatSet.add(value);
            }
          }
        }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/BaseDistinctAggregateAggregationFunction.java`
#### Snippet
```java
        for (int i = 0; i < length; i++) {
          for (int groupKey : groupKeysArray[i]) {
            DoubleOpenHashSet doubleSet =
                (DoubleOpenHashSet) getValueSet(groupByResultHolder, groupKey, DataType.DOUBLE);
            for (double value : doubleValues[i]) {
              doubleSet.add(value);
            }
          }
        }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/BaseDistinctAggregateAggregationFunction.java`
#### Snippet
```java
        for (int i = 0; i < length; i++) {
          for (int groupKey : groupKeysArray[i]) {
            ObjectOpenHashSet<String> stringSet =
                (ObjectOpenHashSet<String>) getValueSet(groupByResultHolder, groupKey, DataType.STRING);
            //noinspection ManualArrayToCollectionCopy
            for (String value : stringValues[i]) {
              //noinspection UseBulkOperation
              stringSet.add(value);
            }
          }
        }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/BaseSingleInputAggregationFunction.java`
#### Snippet
```java
    StringBuilder stringBuilder = new StringBuilder(getType().getName()).append('(');
    int numArguments = getInputExpressions().size();
    if (numArguments > 0) {
      stringBuilder.append(getInputExpressions().get(0).toString());
      for (int i = 1; i < numArguments; i++) {
        stringBuilder.append(", ").append(getInputExpressions().get(i).toString());
      }
    }
    return stringBuilder.append(')').toString();
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/DistinctCountHLLAggregationFunction.java`
#### Snippet
```java
    HyperLogLog hyperLogLog = new HyperLogLog(_log2m);
    Dictionary dictionary = dictIdsWrapper._dictionary;
    RoaringBitmap dictIdBitmap = dictIdsWrapper._dictIdBitmap;
    PeekableIntIterator iterator = dictIdBitmap.getIntIterator();
    while (iterator.hasNext()) {
      hyperLogLog.offer(dictionary.get(iterator.next()));
    }
    return hyperLogLog;
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/DistinctCountThetaSketchAggregationFunction.java`
#### Snippet
```java
    int numExpressions = _inputExpressions.size();
    boolean[] singleValues = new boolean[numExpressions];
    DataType[] valueTypes = new DataType[numExpressions];
    Object[] valueArrays = new Object[numExpressions];
    extractValues(blockValSetMap, singleValues, valueTypes, valueArrays);
    int numFilters = _filterEvaluators.size();
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/DistinctCountThetaSketchAggregationFunction.java`
#### Snippet
```java
            for (int i = 0; i < numFilters; i++) {
              FilterEvaluator filterEvaluator = _filterEvaluators.get(i);
              UpdateSketch updateSketch = updateSketches.get(i + 1);
              for (int j = 0; j < length; j++) {
                if (filterEvaluator.evaluate(singleValues, valueTypes, valueArrays, j)) {
                  updateSketch.update(intValues[j]);
                }
              }
            }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/DistinctCountThetaSketchAggregationFunction.java`
#### Snippet
```java
              if (_includeDefaultSketch) {
                updateSketches.get(0).update(value);
              }
              for (int j = 0; j < numFilters; j++) {
                if (_filterEvaluators.get(j).evaluate(singleValues, valueTypes, valueArrays, i)) {
                  updateSketches.get(j + 1).update(value);
                }
              }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/DistinctCountThetaSketchAggregationFunction.java`
#### Snippet
```java
            for (int i = 0; i < numFilters; i++) {
              FilterEvaluator filterEvaluator = _filterEvaluators.get(i);
              for (int j = 0; j < length; j++) {
                if (filterEvaluator.evaluate(singleValues, valueTypes, valueArrays, j)) {
                  for (int groupKey : groupKeysArray[i]) {
                    getUpdateSketches(groupByResultHolder, groupKey).get(i + 1).update(intValues[j]);
                  }
                }
              }
            }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/FirstDoubleValueWithTimeAggregationFunction.java`
#### Snippet
```java
    ValueLongPair<Double> defaultValueLongPair = getDefaultValueTimePair();
    Double firstData = defaultValueLongPair.getValue();
    long firstTime = defaultValueLongPair.getTime();
    double[] doubleValues = blockValSet.getDoubleValuesSV();
    long[] timeValues = timeValSet.getLongValuesSV();
    for (int i = 0; i < length; i++) {
      double data = doubleValues[i];
      long time = timeValues[i];
      if (time <= firstTime) {
        firstTime = time;
        firstData = data;
      }
    }
    setAggregationResult(aggregationResultHolder, firstData, firstTime);
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/FirstDoubleValueWithTimeAggregationFunction.java`
#### Snippet
```java
    double[] doubleValues = blockValSet.getDoubleValuesSV();
    long[] timeValues = timeValSet.getLongValuesSV();
    for (int i = 0; i < length; i++) {
      double data = doubleValues[i];
      long time = timeValues[i];
      setGroupByResult(groupKeyArray[i], groupByResultHolder, data, time);
    }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/FirstDoubleValueWithTimeAggregationFunction.java`
#### Snippet
```java
    double[] doubleValues = blockValSet.getDoubleValuesSV();
    long[] timeValues = timeValSet.getLongValuesSV();
    for (int i = 0; i < length; i++) {
      double value = doubleValues[i];
      long time = timeValues[i];
      for (int groupKey : groupKeysArray[i]) {
        setGroupByResult(groupKey, groupByResultHolder, value, time);
      }
    }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/FirstFloatValueWithTimeAggregationFunction.java`
#### Snippet
```java
    ValueLongPair<Float> defaultValueLongPair = getDefaultValueTimePair();
    Float firstData = defaultValueLongPair.getValue();
    long firstTime = defaultValueLongPair.getTime();
    float[] floatValues = blockValSet.getFloatValuesSV();
    long[] timeValues = timeValSet.getLongValuesSV();
    for (int i = 0; i < length; i++) {
      float data = floatValues[i];
      long time = timeValues[i];
      if (time <= firstTime) {
        firstTime = time;
        firstData = data;
      }
    }
    setAggregationResult(aggregationResultHolder, firstData, firstTime);
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/FirstFloatValueWithTimeAggregationFunction.java`
#### Snippet
```java
    float[] floatValues = blockValSet.getFloatValuesSV();
    long[] timeValues = timeValSet.getLongValuesSV();
    for (int i = 0; i < length; i++) {
      float data = floatValues[i];
      long time = timeValues[i];
      setGroupByResult(groupKeyArray[i], groupByResultHolder, data, time);
    }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/FirstFloatValueWithTimeAggregationFunction.java`
#### Snippet
```java
    float[] floatValues = blockValSet.getFloatValuesSV();
    long[] timeValues = timeValSet.getLongValuesSV();
    for (int i = 0; i < length; i++) {
      float value = floatValues[i];
      long time = timeValues[i];
      for (int groupKey : groupKeysArray[i]) {
        setGroupByResult(groupKey, groupByResultHolder, value, time);
      }
    }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/FirstIntValueWithTimeAggregationFunction.java`
#### Snippet
```java
    ValueLongPair<Integer> defaultValueLongPair = getDefaultValueTimePair();
    Integer firstData = defaultValueLongPair.getValue();
    long firstTime = defaultValueLongPair.getTime();
    int[] intValues = blockValSet.getIntValuesSV();
    long[] timeValues = timeValSet.getLongValuesSV();
    for (int i = 0; i < length; i++) {
      int data = intValues[i];
      long time = timeValues[i];
      if (time <= firstTime) {
        firstTime = time;
        firstData = data;
      }
    }
    setAggregationResult(aggregationResultHolder, firstData, firstTime);
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/FirstIntValueWithTimeAggregationFunction.java`
#### Snippet
```java
    int[] intValues = blockValSet.getIntValuesSV();
    long[] timeValues = timeValSet.getLongValuesSV();
    for (int i = 0; i < length; i++) {
      int data = intValues[i];
      long time = timeValues[i];
      setGroupByResult(groupKeyArray[i], groupByResultHolder, data, time);
    }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/FirstIntValueWithTimeAggregationFunction.java`
#### Snippet
```java
    int[] intValues = blockValSet.getIntValuesSV();
    long[] timeValues = timeValSet.getLongValuesSV();
    for (int i = 0; i < length; i++) {
      int value = intValues[i];
      long time = timeValues[i];
      for (int groupKey : groupKeysArray[i]) {
        setGroupByResult(groupKey, groupByResultHolder, value, time);
      }
    }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/FirstLongValueWithTimeAggregationFunction.java`
#### Snippet
```java
    ValueLongPair<Long> defaultValueLongPair = getDefaultValueTimePair();
    Long firstData = defaultValueLongPair.getValue();
    long firstTime = defaultValueLongPair.getTime();
    long[] longValues = blockValSet.getLongValuesSV();
    long[] timeValues = timeValSet.getLongValuesSV();
    for (int i = 0; i < length; i++) {
      long data = longValues[i];
      long time = timeValues[i];
      if (time <= firstTime) {
        firstTime = time;
        firstData = data;
      }
    }
    setAggregationResult(aggregationResultHolder, firstData, firstTime);
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/FirstLongValueWithTimeAggregationFunction.java`
#### Snippet
```java
    long[] longValues = blockValSet.getLongValuesSV();
    long[] timeValues = timeValSet.getLongValuesSV();
    for (int i = 0; i < length; i++) {
      long data = longValues[i];
      long time = timeValues[i];
      setGroupByResult(groupKeyArray[i], groupByResultHolder, data, time);
    }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/FirstLongValueWithTimeAggregationFunction.java`
#### Snippet
```java
    long[] longValues = blockValSet.getLongValuesSV();
    long[] timeValues = timeValSet.getLongValuesSV();
    for (int i = 0; i < length; i++) {
      long value = longValues[i];
      long time = timeValues[i];
      for (int groupKey : groupKeysArray[i]) {
        setGroupByResult(groupKey, groupByResultHolder, value, time);
      }
    }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/FirstStringValueWithTimeAggregationFunction.java`
#### Snippet
```java
    ValueLongPair<String> defaultValueLongPair = getDefaultValueTimePair();
    String firstData = defaultValueLongPair.getValue();
    long firstTime = defaultValueLongPair.getTime();
    String[] stringValues = blockValSet.getStringValuesSV();
    long[] timeValues = timeValSet.getLongValuesSV();
    for (int i = 0; i < length; i++) {
      String data = stringValues[i];
      long time = timeValues[i];
      if (time <= firstTime) {
        firstTime = time;
        firstData = data;
      }
    }
    setAggregationResult(aggregationResultHolder, firstData, firstTime);
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/FirstStringValueWithTimeAggregationFunction.java`
#### Snippet
```java
    String[] stringValues = blockValSet.getStringValuesSV();
    long[] timeValues = timeValSet.getLongValuesSV();
    for (int i = 0; i < length; i++) {
      String data = stringValues[i];
      long time = timeValues[i];
      setGroupByResult(groupKeyArray[i], groupByResultHolder, data, time);
    }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/FirstStringValueWithTimeAggregationFunction.java`
#### Snippet
```java
    String[] stringValues = blockValSet.getStringValuesSV();
    long[] timeValues = timeValSet.getLongValuesSV();
    for (int i = 0; i < length; i++) {
      String value = stringValues[i];
      long time = timeValues[i];
      for (int groupKey : groupKeysArray[i]) {
        setGroupByResult(groupKey, groupByResultHolder, value, time);
      }
    }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/FirstWithTimeAggregationFunction.java`
#### Snippet
```java
    BlockValSet blockValSet = blockValSetMap.get(_expression);
    BlockValSet blockTimeSet = blockValSetMap.get(_timeCol);
    if (blockValSet.getValueType() != DataType.BYTES) {
      aggregateResultWithRawData(length, aggregationResultHolder, blockValSet, blockTimeSet);
    } else {
      ValueLongPair<V> defaultValueLongPair = getDefaultValueTimePair();
      V firstData = defaultValueLongPair.getValue();
      long firstTime = defaultValueLongPair.getTime();
      // Serialized FirstPair
      byte[][] bytesValues = blockValSet.getBytesValuesSV();
      for (int i = 0; i < length; i++) {
        ValueLongPair<V> firstWithTimePair = _objectSerDe.deserialize(bytesValues[i]);
        V data = firstWithTimePair.getValue();
        long time = firstWithTimePair.getTime();
        if (time <= firstTime) {
          firstTime = time;
          firstData = data;
        }
      }
      setAggregationResult(aggregationResultHolder, firstData, firstTime);
    }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/FirstWithTimeAggregationFunction.java`
#### Snippet
```java
    BlockValSet blockValSet = blockValSetMap.get(_expression);
    BlockValSet timeValSet = blockValSetMap.get(_timeCol);
    if (blockValSet.getValueType() != DataType.BYTES) {
      aggregateGroupResultWithRawDataSv(length, groupKeyArray, groupByResultHolder,
          blockValSet, timeValSet);
    } else {
      // Serialized FirstPair
      byte[][] bytesValues = blockValSet.getBytesValuesSV();
      for (int i = 0; i < length; i++) {
        ValueLongPair<V> firstWithTimePair = _objectSerDe.deserialize(bytesValues[i]);
        setGroupByResult(groupKeyArray[i],
            groupByResultHolder,
            firstWithTimePair.getValue(),
            firstWithTimePair.getTime());
      }
    }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/FirstWithTimeAggregationFunction.java`
#### Snippet
```java
    BlockValSet blockValSet = blockValSetMap.get(_expression);
    BlockValSet timeValSet = blockValSetMap.get(_timeCol);
    if (blockValSet.getValueType() != DataType.BYTES) {
      aggregateGroupResultWithRawDataMv(length, groupKeysArray, groupByResultHolder, blockValSet, timeValSet);
    } else {
      // Serialized ValueTimePair
      byte[][] bytesValues = blockValSet.getBytesValuesSV();
      for (int i = 0; i < length; i++) {
        ValueLongPair<V> firstWithTimePair = _objectSerDe.deserialize(bytesValues[i]);
        V data = firstWithTimePair.getValue();
        long time = firstWithTimePair.getTime();
        for (int groupKey : groupKeysArray[i]) {
          setGroupByResult(groupKey, groupByResultHolder, data, time);
        }
      }
    }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/HistogramAggregationFunction.java`
#### Snippet
```java
        for (int i = 0; i < length && i < values.length; i++) {
          int binId = this.getBinId(values[i]);
          if (binId != INVALID_BIN) {
            histogram[binId] += 1;
          }
        }
        setAggregationResult(aggregationResultHolder, histogram);
        break;
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/MaxAggregationFunction.java`
#### Snippet
```java
    BlockValSet blockValSet = blockValSetMap.get(_expression);
    if (_nullHandlingEnabled) {
      // TODO: avoid the null bitmap check when it is null or empty for better performance.
      RoaringBitmap nullBitmap = blockValSet.getNullBitmap();
      if (nullBitmap == null) {
        nullBitmap = new RoaringBitmap();
      }
      aggregateNullHandlingEnabled(length, aggregationResultHolder, blockValSet, nullBitmap);
      return;
    }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/MaxAggregationFunction.java`
#### Snippet
```java
    BlockValSet blockValSet = blockValSetMap.get(_expression);
    if (_nullHandlingEnabled) {
      RoaringBitmap nullBitmap = blockValSet.getNullBitmap();
      if (nullBitmap == null) {
        nullBitmap = new RoaringBitmap();
      }
      if (nullBitmap.getCardinality() < length) {
        double[] valueArray = blockValSet.getDoubleValuesSV();
        for (int i = 0; i < length; i++) {
          double value = valueArray[i];
          int groupKey = groupKeyArray[i];
          Double result = groupByResultHolder.getResult(groupKey);
          if (!nullBitmap.contains(i) && (result == null || value > result)) {
            groupByResultHolder.setValueForKey(groupKey, value);
          }
        }
      }
      return;
    }

    double[] valueArray = blockValSet.getDoubleValuesSV();
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/MaxAggregationFunction.java`
#### Snippet
```java
    if (_nullHandlingEnabled) {
      if (intermediateMaxResult1 == null) {
        return intermediateMaxResult2;
      }
      if (intermediateMaxResult2 == null) {
        return intermediateMaxResult1;
      }
    }

    if (intermediateMaxResult1 > intermediateMaxResult2) {
      return intermediateMaxResult1;
    }
    return intermediateMaxResult2;
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/MaxMVAggregationFunction.java`
#### Snippet
```java
    double[][] valuesArray = blockValSetMap.get(_expression).getDoubleValuesMV();
    double max = aggregationResultHolder.getDoubleResult();
    for (int i = 0; i < length; i++) {
      for (double value : valuesArray[i]) {
        if (value > max) {
          max = value;
        }
      }
    }
    aggregationResultHolder.setValue(max);
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/MaxMVAggregationFunction.java`
#### Snippet
```java
    double[][] valuesArray = blockValSetMap.get(_expression).getDoubleValuesMV();
    for (int i = 0; i < length; i++) {
      int groupKey = groupKeyArray[i];
      double max = groupByResultHolder.getDoubleResult(groupKey);
      for (double value : valuesArray[i]) {
        if (value > max) {
          max = value;
        }
      }
      groupByResultHolder.setValueForKey(groupKey, max);
    }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/MaxMVAggregationFunction.java`
#### Snippet
```java
    double[][] valuesArray = blockValSetMap.get(_expression).getDoubleValuesMV();
    for (int i = 0; i < length; i++) {
      double[] values = valuesArray[i];
      for (int groupKey : groupKeysArray[i]) {
        double max = groupByResultHolder.getDoubleResult(groupKey);
        for (double value : values) {
          if (value > max) {
            max = value;
          }
        }
        groupByResultHolder.setValueForKey(groupKey, max);
      }
    }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/PercentileAggregationFunction.java`
#### Snippet
```java
    int size = intermediateResult.size();
    if (size == 0) {
      return DEFAULT_FINAL_RESULT;
    } else {
      double[] values = intermediateResult.elements();
      Arrays.sort(values, 0, size);
      if (_percentile == 100) {
        return values[size - 1];
      } else {
        return values[(int) ((long) size * _percentile / 100)];
      }
    }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/groupby/NoDictionaryMultiColumnGroupKeyGenerator.java`
#### Snippet
```java
              for (int j = 0; j < numDocs; j++) {
                int mvSize = intValues[j].length;
                int[] mvKeys = new int[mvSize];
                for (int k = 0; k < mvSize; k++) {
                  mvKeys[k] = onTheFlyDictionary.put(intValues[j][k]);
                }
                keys[j][i] = mvKeys;
              }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/groupby/NoDictionarySingleColumnGroupKeyGenerator.java`
#### Snippet
```java
        if (nullBitmap.getCardinality() < numDocs) {
          for (int i = 0; i < numDocs; i++) {
            groupKeys[i] = nullBitmap.contains(i) ? getKeyForNullValue() : getKeyForValue(intValues[i]);
          }
        } else if (numDocs > 0) {
          Arrays.fill(groupKeys, 0, numDocs, getKeyForNullValue());
        }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/groupby/NoDictionarySingleColumnGroupKeyGenerator.java`
#### Snippet
```java
          for (int i = 0; i < numDocs; i++) {
            int mvSize = intValues[i].length;
            int[] mvKeys = new int[mvSize];
            for (int j = 0; j < mvSize; j++) {
              mvKeys[j] = getKeyForValue(intValues[i][j]);
            }
            groupKeys[i] = mvKeys;
          }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/distinct/DistinctExecutorUtils.java`
#### Snippet
```java
            System.arraycopy(dictIdsArray, 0, newDictIdsArray, 0, currentLength);
            for (int j = 1; j < numValues; j++) {
              int offset = j * currentLength;
              for (int k = 0; k < currentLength; k++) {
                newDictIdsArray[offset + k] = dictIdsArray[k].clone();
              }
            }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/distinct/dictionary/DictionaryBasedMultiColumnDistinctOnlyExecutor.java`
#### Snippet
```java
      int[][] dictIdsArray = new int[numDocs][numExpressions];
      for (int i = 0; i < numExpressions; i++) {
        BlockValSet blockValueSet = valueBlock.getBlockValueSet(_expressions.get(i));
        int[] dictIdsForExpression = blockValueSet.getDictionaryIdsSV();
        for (int j = 0; j < numDocs; j++) {
          dictIdsArray[j][i] = dictIdsForExpression[j];
        }
      }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/distinct/dictionary/DictionaryBasedMultiColumnDistinctOnlyExecutor.java`
#### Snippet
```java
      int[][] svDictIds = new int[numExpressions][];
      int[][][] mvDictIds = new int[numExpressions][][];
      for (int i = 0; i < numExpressions; i++) {
        BlockValSet blockValueSet = valueBlock.getBlockValueSet(_expressions.get(i));
        if (blockValueSet.isSingleValue()) {
          svDictIds[i] = blockValueSet.getDictionaryIdsSV();
        } else {
          mvDictIds[i] = blockValueSet.getDictionaryIdsMV();
        }
      }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/distinct/raw/RawBigDecimalSingleColumnDistinctOnlyExecutor.java`
#### Snippet
```java
    if (_nullHandlingEnabled) {
      RoaringBitmap nullBitmap = blockValueSet.getNullBitmap();
      for (int i = 0; i < numDocs; i++) {
        if (nullBitmap != null && nullBitmap.contains(i)) {
          values[i] = null;
        }
        _valueSet.add(values[i]);
        if (_valueSet.size() >= _limit) {
          return true;
        }
      }
    } else {
      for (int i = 0; i < numDocs; i++) {
        _valueSet.add(values[i]);
        if (_valueSet.size() >= _limit) {
          return true;
        }
      }
    }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/distinct/raw/RawDoubleSingleColumnDistinctOnlyExecutor.java`
#### Snippet
```java
      if (_nullHandlingEnabled) {
        // TODO(nhejazi): consider having a separate set of classes to handle the case with null handling enabled.
        RoaringBitmap nullBitmap = blockValueSet.getNullBitmap();
        for (int i = 0; i < numDocs; i++) {
          if (nullBitmap != null && nullBitmap.contains(i)) {
            _hasNull = true;
          } else {
            _valueSet.add(values[i]);
            if (_valueSet.size() >= _limit - (_hasNull ? 1 : 0)) {
              return true;
            }
          }
        }
      } else {
        for (int i = 0; i < numDocs; i++) {
          _valueSet.add(values[i]);
          if (_valueSet.size() >= _limit) {
            return true;
          }
        }
      }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/distinct/raw/RawDoubleSingleColumnDistinctOrderByExecutor.java`
#### Snippet
```java
      if (_nullHandlingEnabled) {
        RoaringBitmap nullBitmap = blockValueSet.getNullBitmap();
        for (int i = 0; i < numDocs; i++) {
          if (nullBitmap != null && nullBitmap.contains(i)) {
            _hasNull = true;
          } else {
            add(values[i]);
          }
        }
      } else {
        for (int i = 0; i < numDocs; i++) {
          add(values[i]);
        }
      }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/optimizer/filter/MergeEqInFilterOptimizer.java`
#### Snippet
```java
            List<Expression> operands = childFunction.getOperands();
            Expression lhs = operands.get(0);
            Set<Expression> inPredicateValuesSet = new HashSet<>();
            int numOperands = operands.size();
            for (int i = 1; i < numOperands; i++) {
              inPredicateValuesSet.add(operands.get(i));
            }
            int numUniqueValues = inPredicateValuesSet.size();
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/pruner/BloomFilterSegmentPruner.java`
#### Snippet
```java
    String column = eqPredicate.getLhs().getIdentifier();
    DataSource dataSource = segment instanceof ImmutableSegment ? segment.getDataSource(column)
        : dataSourceCache.computeIfAbsent(column, segment::getDataSource);
    // NOTE: Column must exist after DataSchemaSegmentPruner
    assert dataSource != null;
    DataSourceMetadata dataSourceMetadata = dataSource.getDataSourceMetadata();
    ValueCache.CachedValue cachedValue = valueCache.get(eqPredicate, dataSourceMetadata.getDataType());
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/pruner/BloomFilterSegmentPruner.java`
#### Snippet
```java
    List<String> values = inPredicate.getValues();
    // Skip pruning when there are too many values in the IN predicate
    if (values.size() > _inPredicateThreshold) {
      return false;
    }
    String column = inPredicate.getLhs().getIdentifier();
    DataSource dataSource = segment instanceof ImmutableSegment ? segment.getDataSource(column)
        : dataSourceCache.computeIfAbsent(column, segment::getDataSource);
    // NOTE: Column must exist after DataSchemaSegmentPruner
    assert dataSource != null;
    DataSourceMetadata dataSourceMetadata = dataSource.getDataSourceMetadata();
    List<ValueCache.CachedValue> cachedValues = valueCache.get(inPredicate, dataSourceMetadata.getDataType());
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/reduce/BaseGapfillProcessor.java`
#### Snippet
```java
    DataSchema dataSchema = brokerResponseNative.getResultTable().getDataSchema();
    DataSchema resultTableSchema = getResultTableDataSchema(dataSchema);
    if (brokerResponseNative.getResultTable().getRows().isEmpty()) {
      brokerResponseNative.setResultTable(new ResultTable(resultTableSchema, Collections.emptyList()));
      return;
    }

    String[] columns = dataSchema.getColumnNames();

    Map<String, Integer> indexes = new HashMap<>();
    for (int i = 0; i < columns.length; i++) {
      indexes.put(columns[i], i);
    }

    _isGroupBySelections = new boolean[dataSchema.getColumnDataTypes().length];

    // The first one argument of timeSeries is time column. The left ones are defining entity.
    for (ExpressionContext entityColum : _timeSeries) {
      int index = indexes.get(entityColum.getIdentifier());
      _isGroupBySelections[index] = true;
    }

    for (int i = 0; i < _isGroupBySelections.length; i++) {
      if (_isGroupBySelections[i]) {
        _groupByKeyIndexes.add(i);
      }
    }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/query/reduce/GroupByDataTableReducer.java`
#### Snippet
```java
        Object[] row = sortedIterator.next().getValues();
        extractFinalAggregationResults(row);
        for (int i = 0; i < numColumns; i++) {
          Object value = row[i];
          if (value != null) {
            row[i] = columnDataTypes[i].convert(row[i]);
          }
        }
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/segment/processing/genericrow/GenericRowDeserializer.java`
#### Snippet
```java
            int numBytes1 = _dataBuffer.getInt(offset1);
            offset1 += Integer.BYTES;
            byte[] stringBytes1 = new byte[numBytes1];
            _dataBuffer.copyTo(offset1, stringBytes1);
            int numBytes2 = _dataBuffer.getInt(offset2);
            offset2 += Integer.BYTES;
            byte[] stringBytes2 = new byte[numBytes2];
            _dataBuffer.copyTo(offset2, stringBytes2);
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/core/segment/processing/reducer/DedupReducer.java`
#### Snippet
```java
    LOGGER.info("Start reducing on partition: {}", _partitionId);
    long reduceStartTimeMs = System.currentTimeMillis();

    GenericRowFileReader fileReader = _fileManager.getFileReader();
    int numRows = fileReader.getNumRows();
    int numSortFields = fileReader.getNumSortFields();
    LOGGER.info("Start sorting on numRows: {}, numSortFields: {}", numRows, numSortFields);
    long sortStartTimeMs = System.currentTimeMillis();
    GenericRowFileRecordReader recordReader = fileReader.getRecordReader();
    LOGGER.info("Finish sorting in {}ms", System.currentTimeMillis() - sortStartTimeMs);
```

### DuplicatedCode
Duplicated code
in `pinot-core/src/main/java/org/apache/pinot/server/access/BasicAuthAccessFactory.java`
#### Snippet
```java
      if (requesterIdentity instanceof GrpcRequesterIdentity) {
        GrpcRequesterIdentity identity = (GrpcRequesterIdentity) requesterIdentity;
        return identity.getGrpcMetadata().get(AUTHORIZATION_KEY);
      }
      if (requesterIdentity instanceof HttpRequesterIdentity) {
        HttpRequesterIdentity identity = (HttpRequesterIdentity) requesterIdentity;
        return identity.getHttpHeaders().get(AUTHORIZATION_KEY);
      }
      throw new UnsupportedOperationException("GrpcRequesterIdentity or HttpRequesterIdentity is required");
```

### DuplicatedCode
Duplicated code
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkColumnValueSegmentPruner.java`
#### Snippet
```java
    Map<Integer, String> strings = new HashMap<>();
    List<GenericRow> rows = new ArrayList<>();
    String[] lowCardinalityValues = IntStream.range(0, 10).mapToObj(i -> "value" + i)
        .toArray(String[]::new);
    for (int i = 0; i < numRows; i++) {
      GenericRow row = new GenericRow();
      row.putValue(SORTED_COL_NAME, numRows - i);
      row.putValue(INT_COL_NAME, (int) _supplier.getAsLong());
      row.putValue(NO_INDEX_INT_COL_NAME, (int) _supplier.getAsLong());
      row.putValue(RAW_INT_COL_NAME, (int) _supplier.getAsLong());
      row.putValue(RAW_STRING_COL_NAME,
          strings.computeIfAbsent((int) _supplier.getAsLong(), k -> UUID.randomUUID().toString()));
      row.putValue(NO_INDEX_STRING_COL, row.getValue(RAW_STRING_COL_NAME));
      row.putValue(LOW_CARDINALITY_STRING_COL, lowCardinalityValues[i % lowCardinalityValues.length]);
      rows.add(row);
    }
    return rows;
```

### DuplicatedCode
Duplicated code
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkOrderByQueries.java`
#### Snippet
```java
        row.putValue(INT_COL_NAME, (int) _supplier.getAsLong());
        row.putValue(NO_INDEX_INT_COL_NAME, (int) _supplier.getAsLong());
        row.putValue(RAW_INT_COL_NAME, (int) _supplier.getAsLong());
        row.putValue(RAW_STRING_COL_NAME, strings.computeIfAbsent(
            (int) _supplier.getAsLong(), k -> UUID.randomUUID().toString()));
        row.putValue(NO_INDEX_STRING_COL, row.getValue(RAW_STRING_COL_NAME));
```

### DuplicatedCode
Duplicated code
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkColumnValueSegmentPruner.java`
#### Snippet
```java
    Schema schema = new Schema.SchemaBuilder().setSchemaName(TABLE_NAME)
        .addSingleValueDimension(SORTED_COL_NAME, FieldSpec.DataType.INT)
        .addSingleValueDimension(NO_INDEX_INT_COL_NAME, FieldSpec.DataType.INT)
        .addSingleValueDimension(RAW_INT_COL_NAME, FieldSpec.DataType.INT)
        .addSingleValueDimension(INT_COL_NAME, FieldSpec.DataType.INT)
        .addSingleValueDimension(RAW_STRING_COL_NAME, FieldSpec.DataType.STRING)
        .addSingleValueDimension(NO_INDEX_STRING_COL, FieldSpec.DataType.STRING)
        .addSingleValueDimension(LOW_CARDINALITY_STRING_COL, FieldSpec.DataType.STRING)
        .build();
    SegmentGeneratorConfig config = new SegmentGeneratorConfig(tableConfig, schema);
    config.setOutDir(INDEX_DIR.getPath());
    config.setTableName(TABLE_NAME);
    config.setSegmentName(segmentName);

    SegmentIndexCreationDriverImpl driver = new SegmentIndexCreationDriverImpl();
    try (RecordReader recordReader = new GenericRowRecordReader(rows)) {
      driver.init(config, recordReader);
      driver.build();
    }
```

### DuplicatedCode
Duplicated code
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkCombineGroupBy.java`
#### Snippet
```java
    _d2 = new ArrayList<>(CARDINALITY_D2);
    for (int i = 0; i < CARDINALITY_D2; i++) {
      _d2.add(i);
    }

    _queryContext = QueryContextConverterUtils.getQueryContext(
        "SELECT sum(m1), max(m2) FROM testTable GROUP BY d1, d2 ORDER BY sum(m1) LIMIT 500");
    _dataSchema = new DataSchema(new String[]{"d1", "d2", "sum(m1)", "max(m2)"}, new DataSchema.ColumnDataType[]{
        DataSchema.ColumnDataType.STRING, DataSchema.ColumnDataType.INT, DataSchema.ColumnDataType.DOUBLE,
        DataSchema.ColumnDataType.DOUBLE
    });

    _executorService = Executors.newFixedThreadPool(10);
```

### DuplicatedCode
Duplicated code
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkFixedBitIntReader.java`
#### Snippet
```java
    FileUtils.deleteDirectory(INDEX_DIR);
    FileUtils.forceMkdir(INDEX_DIR);
    File indexFile = new File(INDEX_DIR, "bit-" + _numBits);
    int maxValue = _numBits < 31 ? 1 << _numBits : Integer.MAX_VALUE;
    try (FixedBitSVForwardIndexWriter indexWriter = new FixedBitSVForwardIndexWriter(indexFile, NUM_VALUES, _numBits)) {
      for (int i = 0; i < NUM_VALUES; i++) {
        indexWriter.putDictId(RANDOM.nextInt(maxValue));
      }
    }
    _dataBuffer = PinotDataBuffer.mapReadOnlyBigEndianFile(indexFile);
```

### DuplicatedCode
Duplicated code
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkPinotDataBitSet.java`
#### Snippet
```java
    try (FixedBitSVForwardIndexWriter indexWriter = new FixedBitSVForwardIndexWriter(indexFile, NUM_VALUES, _numBits)) {
      for (int i = 0; i < NUM_VALUES; i++) {
        indexWriter.putDictId(RANDOM.nextInt(maxValue));
      }
    }
    _dataBuffer = PinotDataBuffer.mapReadOnlyBigEndianFile(indexFile);
    _bitSet = new PinotDataBitSet(_dataBuffer);
```

### DuplicatedCode
Duplicated code
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkFixedBitSVForwardIndexReader.java`
#### Snippet
```java
    _readerV2 = new FixedBitSVForwardIndexReaderV2(_dataBuffer, NUM_VALUES, _numBits);

    int sequentialDocId = RANDOM.nextInt(32);
    int denseDocId = RANDOM.nextInt(32);
    int sparseDocId = RANDOM.nextInt(32);
    for (int i = 0; i < NUM_DOC_IDS; i++) {
      _sequentialDocIds[i] = sequentialDocId;
      _denseDocIds[i] = denseDocId;
      _sparseDocIds[i] = sparseDocId;
      sequentialDocId++;
      denseDocId += 1 + RANDOM.nextInt(2);
      sparseDocId += 5 + RANDOM.nextInt(6);
    }
```

### DuplicatedCode
Duplicated code
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkFixedBitSVForwardIndexReaderMixedCardinalities.java`
#### Snippet
```java
    int sequentialDocId = RANDOM.nextInt(32);
    int denseDocId = RANDOM.nextInt(32);
    int sparseDocId = RANDOM.nextInt(32);
    for (int i = 0; i < NUM_DOC_IDS; i++) {
      _sequentialDocIds[i] = sequentialDocId;
      _denseDocIds[i] = denseDocId;
      _sparseDocIds[i] = sparseDocId;
      sequentialDocId++;
      denseDocId += 1 + RANDOM.nextInt(2);
      sparseDocId += 5 + RANDOM.nextInt(6);
    }
```

### DuplicatedCode
Duplicated code
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkFixedBitSVForwardIndexReaderMixedCardinalities.java`
#### Snippet
```java
    _reader0.readDictIds(_sequentialDocIds, NUM_DOC_IDS, _dictIdBuffer0, null);
    bh.consume(_dictIdBuffer0);
    _reader1.readDictIds(_sequentialDocIds, NUM_DOC_IDS, _dictIdBuffer1, null);
    bh.consume(_dictIdBuffer1);
    _reader2.readDictIds(_sequentialDocIds, NUM_DOC_IDS, _dictIdBuffer2, null);
    bh.consume(_dictIdBuffer2);
```

### DuplicatedCode
Duplicated code
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkFixedByteSVForwardIndexReader.java`
#### Snippet
```java
    try (ChunkReaderContext context = _uncompressedReader.createContext()) {
      for (int block = 0; block < _numBlocks; block++) {
        for (int i = 0; i < _docIds.length; i++) {
          _docIds[i] = block * _blockSize + i;
        }
        _uncompressedReader.readValuesSV(_docIds, _docIds.length, _doubleBuffer, context);
        bh.consume(_doubleBuffer);
      }
    }
```

### DuplicatedCode
Duplicated code
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkFixedByteSVForwardIndexReader.java`
#### Snippet
```java
    try (ChunkReaderContext context = _uncompressedReader.createContext()) {
      for (int block = 0; block < _numBlocks; block++) {
        for (int i = 0; i < _docIds.length; i++) {
          _docIds[i] = block * _blockSize + i;
        }
        for (int i = 0; i < _docIds.length; i++) {
          _doubleBuffer[i] = _uncompressedReader.getLong(_docIds[i], context);
        }
        bh.consume(_doubleBuffer);
      }
    }
```

### DuplicatedCode
Duplicated code
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNativeAndLuceneBasedLike.java`
#### Snippet
```java
    SegmentGeneratorConfig config = new SegmentGeneratorConfig(tableConfig, schema);
    config.setOutDir(INDEX_DIR.getPath());
    config.setTableName(TABLE_NAME);
    config.setSegmentName(SEGMENT_NAME);
    config.setFSTIndexType(fstType);
    SegmentIndexCreationDriverImpl driver = new SegmentIndexCreationDriverImpl();
    try (RecordReader recordReader = new GenericRowRecordReader(rows)) {
      driver.init(config, recordReader);
      driver.build();
    }
```

### DuplicatedCode
Duplicated code
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryIntegerCompression.java`
#### Snippet
```java
      allocateBufferMemory();

      Snappy.compress(_uncompressedInt, _snappyCompressedIntegerInput);
      Zstd.compress(_zstandardCompressedIntegerInput, _uncompressedInt);
      // ZSTD compressor with change the position of _uncompressedInt, a flip() operation over input to reset
      // position for lz4 is required
      _uncompressedInt.flip();
      _factory.fastCompressor().compress(_uncompressedInt, _lz4CompressedIntegerInput);

      _zstdIntegerDecompressed.rewind();
      _zstandardCompressedIntegerInput.flip();
      _uncompressedInt.flip();
```

### DuplicatedCode
Duplicated code
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryIntegerCompression.java`
#### Snippet
```java
      _snappyIntegerDecompressed = ByteBuffer.allocateDirect(_uncompressedInt.capacity() * 2);
      _zstdIntegerDecompressed = ByteBuffer.allocateDirect(_uncompressedInt.capacity() * 2);
      _snappyCompressedIntegerInput = ByteBuffer.allocateDirect(_uncompressedInt.capacity() * 2);
      _zstandardCompressedIntegerInput = ByteBuffer.allocateDirect(_uncompressedInt.capacity() * 2);
      _lz4IntegerDecompressed = ByteBuffer.allocateDirect(_uncompressedInt.capacity() * 2);
      _lz4CompressedIntegerOutput = ByteBuffer.allocateDirect(_uncompressedInt.capacity() * 2);
      _lz4CompressedIntegerInput = ByteBuffer.allocateDirect(_uncompressedInt.capacity() * 2);
      _lz4CompressedIntegerOutput = ByteBuffer.allocateDirect(_uncompressedInt.capacity() * 2);
      _snappyCompressedIntegerOutput = ByteBuffer.allocateDirect(_uncompressedInt.capacity() * 2);
```

### DuplicatedCode
Duplicated code
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryIntegerCompression.java`
#### Snippet
```java
      _snappyCompressedIntegerOutput.clear();
      _snappyIntegerDecompressed.clear();
      _zstdCompressedIntegerOutput.clear();
      _zstdIntegerDecompressed.clear();
      _lz4CompressedIntegerOutput.clear();
      _lz4IntegerDecompressed.clear();

      _uncompressedInt.rewind();
      _zstandardCompressedIntegerInput.rewind();
      _lz4CompressedIntegerInput.rewind();
```

### DuplicatedCode
Duplicated code
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryStringCompression.java`
#### Snippet
```java
      Snappy.compress(_uncompressedString, _snappyCompressedStringInput);
      Zstd.compress(_zstandardCompressedStringInput, _uncompressedString);
      // ZSTD compressor with change the position of _uncompressedString, a flip() operation over input to reset
      // position for lz4 is required
      _uncompressedString.flip();
      _factory.fastCompressor().compress(_uncompressedString, _lz4CompressedStringInput);

      _zstandardStringDecompressed.rewind();
      _zstandardCompressedStringInput.flip();
      _uncompressedString.flip();
      _snappyStringDecompressed.flip();
      _lz4CompressedStringInput.flip();
```

### DuplicatedCode
Duplicated code
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkOrderByQueries.java`
#### Snippet
```java
    _supplier = Distribution.createLongSupplier(42, _scenario);
    FileUtils.deleteQuietly(INDEX_DIR);

    buildSegment(FIRST_SEGMENT_NAME);
    buildSegment(SECOND_SEGMENT_NAME);
    IndexLoadingConfig indexLoadingConfig = new IndexLoadingConfig();

    Set<String> invertedIndexCols = new HashSet<>();
    invertedIndexCols.add(INT_COL_NAME);
    invertedIndexCols.add(LOW_CARDINALITY_STRING_COL);

    indexLoadingConfig.setRangeIndexColumns(invertedIndexCols);
    indexLoadingConfig.setInvertedIndexColumns(invertedIndexCols);

    ImmutableSegment firstImmutableSegment =
        ImmutableSegmentLoader.load(new File(INDEX_DIR, FIRST_SEGMENT_NAME), indexLoadingConfig);
    ImmutableSegment secondImmutableSegment =
        ImmutableSegmentLoader.load(new File(INDEX_DIR, SECOND_SEGMENT_NAME), indexLoadingConfig);
    _indexSegment = firstImmutableSegment;
    _indexSegments = Arrays.asList(firstImmutableSegment, secondImmutableSegment);
```

### DuplicatedCode
Duplicated code
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkOrderByQueries.java`
#### Snippet
```java
List<GenericRow> rows = createTestData(_numRows);
    List<FieldConfig> fieldConfigs = new ArrayList<>();

    TableConfig tableConfig = new TableConfigBuilder(TableType.OFFLINE).setTableName(TABLE_NAME)
        .setInvertedIndexColumns(Collections.singletonList(INT_COL_NAME))
        .setFieldConfigList(fieldConfigs)
        .setNoDictionaryColumns(Arrays.asList(RAW_INT_COL_NAME, RAW_STRING_COL_NAME))
        .setSortedColumn(SORTED_COL_NAME)
        .setStarTreeIndexConfigs(Collections.singletonList(new StarTreeIndexConfig(
            Arrays.asList(SORTED_COL_NAME, INT_COL_NAME), null, Collections.singletonList(
            new AggregationFunctionColumnPair(AggregationFunctionType.SUM, RAW_INT_COL_NAME).toColumnName()),
            Integer.MAX_VALUE)))
        .build();
    Schema schema = new Schema.SchemaBuilder().setSchemaName(TABLE_NAME)
        .addSingleValueDimension(SORTED_COL_NAME, FieldSpec.DataType.INT)
        .addSingleValueDimension(NO_INDEX_INT_COL_NAME, FieldSpec.DataType.INT)
        .addSingleValueDimension(RAW_INT_COL_NAME, FieldSpec.DataType.INT)
        .addSingleValueDimension(INT_COL_NAME, FieldSpec.DataType.INT)
        .addSingleValueDimension(RAW_STRING_COL_NAME, FieldSpec.DataType.STRING)
        .addSingleValueDimension(NO_INDEX_STRING_COL, FieldSpec.DataType.STRING)
        .addSingleValueDimension(LOW_CARDINALITY_STRING_COL, FieldSpec.DataType.STRING)
        .build();
    SegmentGeneratorConfig config = new SegmentGeneratorConfig(tableConfig, schema);
    config.setOutDir(INDEX_DIR.getPath());
    config.setTableName(TABLE_NAME);
    config.setSegmentName(segmentName);

    SegmentIndexCreationDriverImpl driver = new SegmentIndexCreationDriverImpl();
    try (RecordReader recordReader = new GenericRowRecordReader(rows)) {
      driver.init(config, recordReader);
      driver.build();
    }
```

### DuplicatedCode
Duplicated code
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkRangeIndex.java`
#### Snippet
```java
          Arrays.sort(sorted);
          for (int i = 0, d = 0; i < sorted.length; i += (sorted.length / 10)) {
            deciles[d++] = sorted[i];
          }
          deciles[10] = sorted[_numDocs - 1];
          _deciles = deciles;
          break;
```

### DuplicatedCode
Duplicated code
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkRangeIndex.java`
#### Snippet
```java
          MutableRoaringBitmap result = new MutableRoaringBitmap();
          IntIterator docIdIterator = partial.getIntIterator();
          while (docIdIterator.hasNext()) {
            int next = docIdIterator.next();
            if (intValues[next] >= min && intValues[next] <= max) {
              result.add(next);
            }
          }
          if (matching != null) {
            result.or(matching);
          }
          return result;
```

### DuplicatedCode
Duplicated code
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkRawForwardIndexReader.java`
#### Snippet
```java
      _bytes = new byte[_records][];
      StringBuilder sb = new StringBuilder();
      for (int i = 0; i < _records; i++) {
        int words = (int) supplier.getAsLong();
        for (int j = 0; j < words; j++) {
          sb.append(WORDS[random.nextInt(WORDS.length)]);
        }
        _bytes[i] = sb.toString().getBytes(StandardCharsets.UTF_8);
        _maxLength = Math.max(_maxLength, _bytes[i].length);
        sb.setLength(0);
      }
```

### DuplicatedCode
Duplicated code
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-hadoop/src/main/java/org/apache/pinot/plugin/ingestion/batch/hadoop/HadoopSegmentCreationMapper.java`
#### Snippet
```java
      PinotFSFactory.create(inputFileURI.getScheme()).copyToLocalFile(inputFileURI, localInputDataFile);

      //create task spec
      SegmentGenerationTaskSpec taskSpec = new SegmentGenerationTaskSpec();
      taskSpec.setInputFilePath(localInputDataFile.getAbsolutePath());
      taskSpec.setOutputDirectoryPath(localOutputTempDir.getAbsolutePath());
      taskSpec.setRecordReaderSpec(_spec.getRecordReaderSpec());
      taskSpec.setSchema(SegmentGenerationUtils.getSchema(_spec.getTableSpec().getSchemaURI(), _spec.getAuthToken()));
      taskSpec.setTableConfig(
          SegmentGenerationUtils.getTableConfig(_spec.getTableSpec().getTableConfigURI(), _spec.getAuthToken()));
      taskSpec.setSequenceId(idx);
      taskSpec.setSegmentNameGeneratorSpec(_spec.getSegmentNameGeneratorSpec());
      taskSpec.setFailOnEmptySegment(_spec.isFailOnEmptySegment());
      taskSpec.setCustomProperty(BatchConfigProperties.INPUT_DATA_FILE_URI_KEY, inputFileURI.toString());
```

### DuplicatedCode
Duplicated code
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-hadoop/src/main/java/org/apache/pinot/plugin/ingestion/batch/hadoop/HadoopSegmentCreationMapper.java`
#### Snippet
```java
File localSegmentDir = new File(localOutputTempDir, segmentName);
      String segmentTarFileName = URLEncoder.encode(segmentName + Constants.TAR_GZ_FILE_EXT, "UTF-8");
      File localSegmentTarFile = new File(localOutputTempDir, segmentTarFileName);
      LOGGER.info("Tarring segment from: {} to: {}", localSegmentDir, localSegmentTarFile);
      TarGzCompressionUtils.createTarGzFile(localSegmentDir, localSegmentTarFile);
      long uncompressedSegmentSize = FileUtils.sizeOf(localSegmentDir);
      long compressedSegmentSize = FileUtils.sizeOf(localSegmentTarFile);
      LOGGER.info("Size for segment: {}, uncompressed: {}, compressed: {}", segmentName,
          DataSizeUtils.fromBytes(uncompressedSegmentSize), DataSizeUtils.fromBytes(compressedSegmentSize));
      //move segment to output PinotFS
      URI relativeOutputPath = SegmentGenerationUtils.getRelativeOutputPath(inputDirURI, inputFileURI, outputDirURI);
      URI outputSegmentTarURI = relativeOutputPath.resolve(segmentTarFileName);
      SegmentGenerationJobUtils.moveLocalTarFileToRemote(localSegmentTarFile, outputSegmentTarURI,
          _spec.isOverwriteOutput());

      // Create and upload segment metadata tar file
      String metadataTarFileName = URLEncoder.encode(segmentName + Constants.METADATA_TAR_GZ_FILE_EXT, "UTF-8");
      URI outputMetadataTarURI = relativeOutputPath.resolve(metadataTarFileName);
      if (outputDirFS.exists(outputMetadataTarURI) && (_spec.isOverwriteOutput() || !_spec.isCreateMetadataTarGz())) {
        LOGGER.info("Deleting existing metadata tar gz file: {}", outputMetadataTarURI);
        outputDirFS.delete(outputMetadataTarURI, true);
      }

      if (taskSpec.isCreateMetadataTarGz()) {
        File localMetadataTarFile = new File(localOutputTempDir, metadataTarFileName);
        SegmentGenerationJobUtils.createSegmentMetadataTarGz(localSegmentDir, localMetadataTarFile);
        SegmentGenerationJobUtils.moveLocalTarFileToRemote(localMetadataTarFile, outputMetadataTarURI,
            _spec.isOverwriteOutput());
      }
      FileUtils.deleteQuietly(localSegmentDir);
      FileUtils.deleteQuietly(localInputDataFile);
```

### DuplicatedCode
Duplicated code
in `pinot-plugins/pinot-minion-tasks/pinot-minion-builtin-tasks/src/main/java/org/apache/pinot/plugin/minion/tasks/segmentgenerationandpush/SegmentGenerationAndPushTaskExecutor.java`
#### Snippet
```java
    File localSegmentTarFile = new File(localOutputTempDir, segmentTarFileName);
    LOGGER.info("Tarring segment from: {} to: {}", localSegmentDir, localSegmentTarFile);
    TarGzCompressionUtils.createTarGzFile(localSegmentDir, localSegmentTarFile);
    long uncompressedSegmentSize = FileUtils.sizeOf(localSegmentDir);
    long compressedSegmentSize = FileUtils.sizeOf(localSegmentTarFile);
    LOGGER.info("Size for segment: {}, uncompressed: {}, compressed: {}", segmentName,
        DataSizeUtils.fromBytes(uncompressedSegmentSize), DataSizeUtils.fromBytes(compressedSegmentSize));
```

### DuplicatedCode
Duplicated code
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-hadoop/src/main/java/org/apache/pinot/plugin/ingestion/batch/hadoop/HadoopSegmentGenerationJobRunner.java`
#### Snippet
```java
_spec = spec;
    if (_spec.getInputDirURI() == null) {
      throw new RuntimeException("Missing property 'inputDirURI' in 'jobSpec' file");
    }
    if (_spec.getOutputDirURI() == null) {
      throw new RuntimeException("Missing property 'outputDirURI' in 'jobSpec' file");
    }
    if (_spec.getRecordReaderSpec() == null) {
      throw new RuntimeException("Missing property 'recordReaderSpec' in 'jobSpec' file");
    }
    if (_spec.getTableSpec() == null) {
      throw new RuntimeException("Missing property 'tableSpec' in 'jobSpec' file");
    }
    if (_spec.getTableSpec().getTableName() == null) {
      throw new RuntimeException("Missing property 'tableName' in 'tableSpec'");
    }
    if (_spec.getTableSpec().getSchemaURI() == null) {
      if (_spec.getPinotClusterSpecs() == null || _spec.getPinotClusterSpecs().length == 0) {
        throw new RuntimeException("Missing property 'schemaURI' in 'tableSpec'");
      }
      PinotClusterSpec pinotClusterSpec = _spec.getPinotClusterSpecs()[0];
      String schemaURI = SegmentGenerationUtils
          .generateSchemaURI(pinotClusterSpec.getControllerURI(), _spec.getTableSpec().getTableName());
      _spec.getTableSpec().setSchemaURI(schemaURI);
    }
    if (_spec.getTableSpec().getTableConfigURI() == null) {
      if (_spec.getPinotClusterSpecs() == null || _spec.getPinotClusterSpecs().length == 0) {
        throw new RuntimeException("Missing property 'tableConfigURI' in 'tableSpec'");
      }
      PinotClusterSpec pinotClusterSpec = _spec.getPinotClusterSpecs()[0];
      String tableConfigURI = SegmentGenerationUtils
          .generateTableConfigURI(pinotClusterSpec.getControllerURI(), _spec.getTableSpec().getTableName());
      _spec.getTableSpec().setTableConfigURI(tableConfigURI);
    }
    if (_spec.getExecutionFrameworkSpec().getExtraConfigs() == null) {
      _spec.getExecutionFrameworkSpec().setExtraConfigs(new HashMap<>());
    }
```

### DuplicatedCode
Duplicated code
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-standalone/src/main/java/org/apache/pinot/plugin/ingestion/batch/standalone/SegmentGenerationJobRunner.java`
#### Snippet
```java
    if (_spec.getRecordReaderSpec() == null) {
      throw new RuntimeException("Missing property 'recordReaderSpec' in 'jobSpec' file");
    }
    if (_spec.getTableSpec() == null) {
      throw new RuntimeException("Missing property 'tableSpec' in 'jobSpec' file");
    }
    if (_spec.getTableSpec().getTableName() == null) {
      throw new RuntimeException("Missing property 'tableName' in 'tableSpec'");
    }
```

### DuplicatedCode
Duplicated code
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-standalone/src/main/java/org/apache/pinot/plugin/ingestion/batch/standalone/SegmentGenerationJobRunner.java`
#### Snippet
```java
    if (_spec.getTableSpec().getSchemaURI() == null) {
      if (_spec.getPinotClusterSpecs() == null || _spec.getPinotClusterSpecs().length == 0) {
        throw new RuntimeException("Missing property 'schemaURI' in 'tableSpec'");
      }
      PinotClusterSpec pinotClusterSpec = _spec.getPinotClusterSpecs()[0];
      String schemaURI = SegmentGenerationUtils
          .generateSchemaURI(pinotClusterSpec.getControllerURI(), _spec.getTableSpec().getTableName());
      _spec.getTableSpec().setSchemaURI(schemaURI);
    }
```

### DuplicatedCode
Duplicated code
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-standalone/src/main/java/org/apache/pinot/plugin/ingestion/batch/standalone/SegmentGenerationJobRunner.java`
#### Snippet
```java
    if (_spec.getTableSpec().getTableConfigURI() == null) {
      if (_spec.getPinotClusterSpecs() == null || _spec.getPinotClusterSpecs().length == 0) {
        throw new RuntimeException("Missing property 'tableConfigURI' in 'tableSpec'");
      }
      PinotClusterSpec pinotClusterSpec = _spec.getPinotClusterSpecs()[0];
      String tableConfigURI = SegmentGenerationUtils
          .generateTableConfigURI(pinotClusterSpec.getControllerURI(), _spec.getTableSpec().getTableName());
      _spec.getTableSpec().setTableConfigURI(tableConfigURI);
    }
```

### DuplicatedCode
Duplicated code
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-hadoop/src/main/java/org/apache/pinot/plugin/ingestion/batch/hadoop/HadoopSegmentGenerationJobRunner.java`
#### Snippet
```java
    List<PinotFSSpec> pinotFSSpecs = _spec.getPinotFSSpecs();
    for (PinotFSSpec pinotFSSpec : pinotFSSpecs) {
      PinotFSFactory.register(pinotFSSpec.getScheme(), pinotFSSpec.getClassName(), new PinotConfiguration(pinotFSSpec));
    }
    //Get list of files to process
    URI inputDirURI = new URI(_spec.getInputDirURI());
    if (inputDirURI.getScheme() == null) {
      inputDirURI = new File(_spec.getInputDirURI()).toURI();
    }
    PinotFS inputDirFS = PinotFSFactory.create(inputDirURI.getScheme());
    List<String> filteredFiles = SegmentGenerationUtils.listMatchedFilesWithRecursiveOption(inputDirFS, inputDirURI,
        _spec.getIncludeFileNamePattern(), _spec.getExcludeFileNamePattern(), _spec.isSearchRecursively());
```

### DuplicatedCode
Duplicated code
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-hadoop/src/main/java/org/apache/pinot/plugin/ingestion/batch/hadoop/HadoopSegmentGenerationJobRunner.java`
#### Snippet
```java
    URI outputDirURI = new URI(_spec.getOutputDirURI());
    if (outputDirURI.getScheme() == null) {
      outputDirURI = new File(_spec.getOutputDirURI()).toURI();
    }
    PinotFS outputDirFS = PinotFSFactory.create(outputDirURI.getScheme());
    outputDirFS.mkdir(outputDirURI);

    //Get staging directory for temporary output pinot segments
    String stagingDir = _spec.getExecutionFrameworkSpec().getExtraConfigs().get(STAGING_DIR_FIELD);
```

### DuplicatedCode
Duplicated code
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-hadoop/src/main/java/org/apache/pinot/plugin/ingestion/batch/hadoop/HadoopSegmentGenerationJobRunner.java`
#### Snippet
```java
    ArrayList<File> validPluginDirectories = new ArrayList();

    for (String pluginsDirPath : pluginDirectories) {
      File pluginsDir = new File(pluginsDirPath);
      if (pluginsDir.exists()) {
        validPluginDirectories.add(pluginsDir);
      } else {
        LOGGER.warn("Cannot find Pinot plugins directory at [{}]", pluginsDirPath);
        return;
      }
    }

    File pluginsTarGzFile = new File(PINOT_PLUGINS_TAR_GZ);
```

### DuplicatedCode
Duplicated code
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-hadoop/src/main/java/org/apache/pinot/plugin/ingestion/batch/hadoop/HadoopSegmentMetadataPushJobRunner.java`
#### Snippet
```java
    List<PinotFSSpec> pinotFSSpecs = _spec.getPinotFSSpecs();
    for (PinotFSSpec pinotFSSpec : pinotFSSpecs) {
      PinotFSFactory.register(pinotFSSpec.getScheme(), pinotFSSpec.getClassName(), new PinotConfiguration(pinotFSSpec));
    }

    //Get outputFS for writing output pinot segments
    URI outputDirURI;
    try {
      outputDirURI = new URI(_spec.getOutputDirURI());
      if (outputDirURI.getScheme() == null) {
        outputDirURI = new File(_spec.getOutputDirURI()).toURI();
      }
    } catch (URISyntaxException e) {
      throw new RuntimeException("outputDirURI is not valid - '" + _spec.getOutputDirURI() + "'");
    }
    PinotFS outputDirFS = PinotFSFactory.create(outputDirURI.getScheme());
    //Get list of files to process
    String[] files;
    try {
      files = outputDirFS.listFiles(outputDirURI, true);
    } catch (IOException e) {
      throw new RuntimeException("Unable to list all files under outputDirURI - '" + outputDirURI + "'");
    }

    List<String> segmentsToPush = new ArrayList<>();
    for (String file : files) {
      if (file.endsWith(Constants.TAR_GZ_FILE_EXT)) {
        segmentsToPush.add(file);
      }
    }

    int pushParallelism = _spec.getPushJobSpec().getPushParallelism();
    if (pushParallelism < 1) {
      pushParallelism = segmentsToPush.size();
    }
```

### DuplicatedCode
Duplicated code
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-hadoop/src/main/java/org/apache/pinot/plugin/ingestion/batch/hadoop/HadoopSegmentUriPushJobRunner.java`
#### Snippet
```java
    List<PinotFSSpec> pinotFSSpecs = _spec.getPinotFSSpecs();
    for (PinotFSSpec pinotFSSpec : pinotFSSpecs) {
      PinotFSFactory.register(pinotFSSpec.getScheme(), pinotFSSpec.getClassName(), new PinotConfiguration(pinotFSSpec));
    }

    //Get outputFS for writing output Pinot segments
    URI outputDirURI;
    try {
      outputDirURI = new URI(_spec.getOutputDirURI());
      if (outputDirURI.getScheme() == null) {
        outputDirURI = new File(_spec.getOutputDirURI()).toURI();
      }
    } catch (URISyntaxException e) {
      throw new RuntimeException("outputDirURI is not valid - '" + _spec.getOutputDirURI() + "'");
    }
    PinotFS outputDirFS = PinotFSFactory.create(outputDirURI.getScheme());

    //Get list of files to process
    String[] files;
    try {
      files = outputDirFS.listFiles(outputDirURI, true);
    } catch (IOException e) {
      throw new RuntimeException("Unable to list all files under outputDirURI - '" + outputDirURI + "'");
    }
    List<String> segmentUris = new ArrayList<>();
    for (String file : files) {
      URI uri = URI.create(file);
      if (uri.getPath().endsWith(Constants.TAR_GZ_FILE_EXT)) {
        URI updatedURI = SegmentPushUtils
            .generateSegmentTarURI(outputDirURI, uri, _spec.getPushJobSpec().getSegmentUriPrefix(),
                _spec.getPushJobSpec().getSegmentUriSuffix());
        segmentUris.add(updatedURI.toString());
      }
    }
```

### DuplicatedCode
Duplicated code
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-spark-2.4/src/main/java/org/apache/pinot/plugin/ingestion/batch/spark/SparkSegmentGenerationJobRunner.java`
#### Snippet
```java
JavaSparkContext sparkContext = JavaSparkContext.fromSparkContext(SparkContext.getOrCreate());

      // Pinot plugins are necessary to launch Pinot ingestion job from every mapper.
      // In order to ensure pinot plugins would be loaded to each worker, this method
      // tars entire plugins directory and set this file into Distributed cache.
      // Then each executor job will untar the plugin tarball, and set system properties accordingly.
      packPluginsToDistributedCache(sparkContext);

      // Add dependency jars
      if (_spec.getExecutionFrameworkSpec().getExtraConfigs().containsKey(DEPS_JAR_DIR)) {
        addDepsJarToDistributedCache(sparkContext,
            _spec.getExecutionFrameworkSpec().getExtraConfigs().get(DEPS_JAR_DIR));
      }

      List<String> pathAndIdxList = new ArrayList<>();
      if (!SegmentGenerationJobUtils.useGlobalDirectorySequenceId(_spec.getSegmentNameGeneratorSpec())) {
        Map<String, List<String>> localDirIndex = new HashMap<>();
        for (String filteredFile : filteredFiles) {
          Path filteredParentPath = Paths.get(filteredFile).getParent();
          if (!localDirIndex.containsKey(filteredParentPath.toString())) {
            localDirIndex.put(filteredParentPath.toString(), new ArrayList<>());
          }
          localDirIndex.get(filteredParentPath.toString()).add(filteredFile);
        }
        for (String parentPath : localDirIndex.keySet()) {
          List<String> siblingFiles = localDirIndex.get(parentPath);
          Collections.sort(siblingFiles);
          for (int i = 0; i < siblingFiles.size(); i++) {
            pathAndIdxList.add(String.format("%s %d", siblingFiles.get(i), i));
          }
        }
      } else {
        for (int i = 0; i < filteredFiles.size(); i++) {
          pathAndIdxList.add(String.format("%s %d", filteredFiles.get(i), i));
        }
      }
      int numDataFiles = pathAndIdxList.size();
      int jobParallelism = _spec.getSegmentCreationJobParallelism();
      if (jobParallelism <= 0 || jobParallelism > numDataFiles) {
        jobParallelism = numDataFiles;
      }

      JavaRDD<String> pathRDD = sparkContext.parallelize(pathAndIdxList, jobParallelism);

      final String pluginsInclude =
          (sparkContext.getConf().contains(PLUGINS_INCLUDE_PROPERTY_NAME)) ? sparkContext.getConf()
              .get(PLUGINS_INCLUDE_PROPERTY_NAME) : null;
      final URI finalInputDirURI = inputDirURI;
      final URI finalOutputDirURI = (stagingDirURI == null) ? outputDirURI : stagingDirURI;
```

### DuplicatedCode
Duplicated code
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-spark-2.4/src/main/java/org/apache/pinot/plugin/ingestion/batch/spark/SparkSegmentGenerationJobRunner.java`
#### Snippet
```java
PluginManager.get().init();
          for (PinotFSSpec pinotFSSpec : _spec.getPinotFSSpecs()) {
            PinotFSFactory
                .register(pinotFSSpec.getScheme(), pinotFSSpec.getClassName(), new PinotConfiguration(pinotFSSpec));
          }
          PinotFS finalOutputDirFS = PinotFSFactory.create(finalOutputDirURI.getScheme());
          String[] splits = pathAndIdx.split(" ");
          String path = splits[0];
          int idx = Integer.valueOf(splits[1]);
          // Load Pinot Plugins copied from Distributed cache.
          File localPluginsTarFile = new File(PINOT_PLUGINS_TAR_GZ);
          if (localPluginsTarFile.exists()) {
            File pluginsDirFile = new File(PINOT_PLUGINS_DIR + "-" + idx);
            try {
              TarGzCompressionUtils.untar(localPluginsTarFile, pluginsDirFile);
            } catch (Exception e) {
              LOGGER.error("Failed to untar local Pinot plugins tarball file [{}]", localPluginsTarFile, e);
              throw new RuntimeException(e);
            }
            LOGGER.info("Trying to set System Property: [{}={}]", PLUGINS_DIR_PROPERTY_NAME,
                pluginsDirFile.getAbsolutePath());
            System.setProperty(PLUGINS_DIR_PROPERTY_NAME, pluginsDirFile.getAbsolutePath());
            if (pluginsInclude != null) {
              LOGGER.info("Trying to set System Property: [{}={}]", PLUGINS_INCLUDE_PROPERTY_NAME, pluginsInclude);
              System.setProperty(PLUGINS_INCLUDE_PROPERTY_NAME, pluginsInclude);
            }
            LOGGER.info("Pinot plugins System Properties are set at [{}], plugins includes [{}]",
                System.getProperty(PLUGINS_DIR_PROPERTY_NAME), System.getProperty(PLUGINS_INCLUDE_PROPERTY_NAME));
          } else {
            LOGGER.warn("Cannot find local Pinot plugins tar file at [{}]", localPluginsTarFile.getAbsolutePath());
          }
          URI inputFileURI = URI.create(path);
          if (inputFileURI.getScheme() == null) {
            inputFileURI =
                new URI(finalInputDirURI.getScheme(), inputFileURI.getSchemeSpecificPart(), inputFileURI.getFragment());
          }

          //create localTempDir for input and output
          File localTempDir = new File(FileUtils.getTempDirectory(), "pinot-" + UUID.randomUUID());
          File localInputTempDir = new File(localTempDir, "input");
          FileUtils.forceMkdir(localInputTempDir);
          File localOutputTempDir = new File(localTempDir, "output");
          FileUtils.forceMkdir(localOutputTempDir);

          //copy input path to local
          File localInputDataFile = new File(localInputTempDir, getFileName(inputFileURI));
          LOGGER.info("Trying to copy input file from {} to {}", inputFileURI, localInputDataFile);
          PinotFSFactory.create(inputFileURI.getScheme()).copyToLocalFile(inputFileURI, localInputDataFile);

          //create task spec
          SegmentGenerationTaskSpec taskSpec = new SegmentGenerationTaskSpec();
          taskSpec.setInputFilePath(localInputDataFile.getAbsolutePath());
          taskSpec.setOutputDirectoryPath(localOutputTempDir.getAbsolutePath());
          taskSpec.setRecordReaderSpec(_spec.getRecordReaderSpec());
          taskSpec
              .setSchema(SegmentGenerationUtils.getSchema(_spec.getTableSpec().getSchemaURI(), _spec.getAuthToken()));
          taskSpec.setTableConfig(
              SegmentGenerationUtils.getTableConfig(_spec.getTableSpec().getTableConfigURI(), _spec.getAuthToken()));
          taskSpec.setSequenceId(idx);
          taskSpec.setSegmentNameGeneratorSpec(_spec.getSegmentNameGeneratorSpec());
          taskSpec.setFailOnEmptySegment(_spec.isFailOnEmptySegment());
```

### DuplicatedCode
Duplicated code
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-spark-3.2/src/main/java/org/apache/pinot/plugin/ingestion/batch/spark3/SparkSegmentGenerationJobRunner.java`
#### Snippet
```java
taskSpec.setCustomProperty(BatchConfigProperties.INPUT_DATA_FILE_URI_KEY, inputFileURI.toString());

          SegmentGenerationTaskRunner taskRunner = new SegmentGenerationTaskRunner(taskSpec);
          String segmentName = taskRunner.run();

          // Tar segment directory to compress file
          File localSegmentDir = new File(localOutputTempDir, segmentName);
          String segmentTarFileName = URLEncoder.encode(segmentName + Constants.TAR_GZ_FILE_EXT, "UTF-8");
          File localSegmentTarFile = new File(localOutputTempDir, segmentTarFileName);
          LOGGER.info("Tarring segment from: {} to: {}", localSegmentDir, localSegmentTarFile);
          TarGzCompressionUtils.createTarGzFile(localSegmentDir, localSegmentTarFile);
          long uncompressedSegmentSize = FileUtils.sizeOf(localSegmentDir);
          long compressedSegmentSize = FileUtils.sizeOf(localSegmentTarFile);
          LOGGER.info("Size for segment: {}, uncompressed: {}, compressed: {}", segmentName,
              DataSizeUtils.fromBytes(uncompressedSegmentSize), DataSizeUtils.fromBytes(compressedSegmentSize));
          // Move segment to output PinotFS
          URI relativeOutputPath =
              SegmentGenerationUtils.getRelativeOutputPath(finalInputDirURI, inputFileURI, finalOutputDirURI);
          URI outputSegmentTarURI = relativeOutputPath.resolve(segmentTarFileName);
          SegmentGenerationJobUtils.moveLocalTarFileToRemote(localSegmentTarFile, outputSegmentTarURI,
              _spec.isOverwriteOutput());

          // Create and upload segment metadata tar file
          String metadataTarFileName = URLEncoder.encode(segmentName + Constants.METADATA_TAR_GZ_FILE_EXT, "UTF-8");
          URI outputMetadataTarURI = relativeOutputPath.resolve(metadataTarFileName);
          if (finalOutputDirFS.exists(outputMetadataTarURI) && (_spec.isOverwriteOutput()
              || !_spec.isCreateMetadataTarGz())) {
            LOGGER.info("Deleting existing metadata tar gz file: {}", outputMetadataTarURI);
            finalOutputDirFS.delete(outputMetadataTarURI, true);
          }
          if (taskSpec.isCreateMetadataTarGz()) {
            File localMetadataTarFile = new File(localOutputTempDir, metadataTarFileName);
            SegmentGenerationJobUtils.createSegmentMetadataTarGz(localSegmentDir, localMetadataTarFile);
            SegmentGenerationJobUtils.moveLocalTarFileToRemote(localMetadataTarFile, outputMetadataTarURI,
                _spec.isOverwriteOutput());
          }
          FileUtils.deleteQuietly(localSegmentDir);
          FileUtils.deleteQuietly(localInputDataFile);
```

### DuplicatedCode
Duplicated code
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-spark-2.4/src/main/java/org/apache/pinot/plugin/ingestion/batch/spark/SparkSegmentGenerationJobRunner.java`
#### Snippet
```java
SegmentGenerationTaskRunner taskRunner = new SegmentGenerationTaskRunner(taskSpec);
          String segmentName = taskRunner.run();

          // Tar segment directory to compress file
          File localSegmentDir = new File(localOutputTempDir, segmentName);
          String segmentTarFileName = URLEncoder.encode(segmentName + Constants.TAR_GZ_FILE_EXT, "UTF-8");
          File localSegmentTarFile = new File(localOutputTempDir, segmentTarFileName);
          LOGGER.info("Tarring segment from: {} to: {}", localSegmentDir, localSegmentTarFile);
          TarGzCompressionUtils.createTarGzFile(localSegmentDir, localSegmentTarFile);
          long uncompressedSegmentSize = FileUtils.sizeOf(localSegmentDir);
          long compressedSegmentSize = FileUtils.sizeOf(localSegmentTarFile);
          LOGGER.info("Size for segment: {}, uncompressed: {}, compressed: {}", segmentName,
              DataSizeUtils.fromBytes(uncompressedSegmentSize), DataSizeUtils.fromBytes(compressedSegmentSize));
          // Move segment to output PinotFS
          URI relativeOutputPath =
              SegmentGenerationUtils.getRelativeOutputPath(finalInputDirURI, inputFileURI, finalOutputDirURI);
          URI outputSegmentTarURI = relativeOutputPath.resolve(segmentTarFileName);
          SegmentGenerationJobUtils.moveLocalTarFileToRemote(localSegmentTarFile, outputSegmentTarURI,
              _spec.isOverwriteOutput());

          // Create and upload segment metadata tar file
          String metadataTarFileName = URLEncoder.encode(segmentName + Constants.METADATA_TAR_GZ_FILE_EXT, "UTF-8");
          URI outputMetadataTarURI = relativeOutputPath.resolve(metadataTarFileName);

          if (finalOutputDirFS.exists(outputMetadataTarURI) && (_spec.isOverwriteOutput()
              || !_spec.isCreateMetadataTarGz())) {
            LOGGER.info("Deleting existing metadata tar gz file: {}", outputMetadataTarURI);
            finalOutputDirFS.delete(outputMetadataTarURI, true);
          }
          if (taskSpec.isCreateMetadataTarGz()) {
            File localMetadataTarFile = new File(localOutputTempDir, metadataTarFileName);
            SegmentGenerationJobUtils.createSegmentMetadataTarGz(localSegmentDir, localMetadataTarFile);
            SegmentGenerationJobUtils.moveLocalTarFileToRemote(localMetadataTarFile, outputMetadataTarURI,
                _spec.isOverwriteOutput());
          }
          FileUtils.deleteQuietly(localSegmentDir);
          FileUtils.deleteQuietly(localInputDataFile);
```

### DuplicatedCode
Duplicated code
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-spark-2.4/src/main/java/org/apache/pinot/plugin/ingestion/batch/spark/SparkSegmentGenerationJobRunner.java`
#### Snippet
```java
    if (depsJarDir != null) {
      URI depsJarDirURI = URI.create(depsJarDir);
      if (depsJarDirURI.getScheme() == null) {
        depsJarDirURI = new File(depsJarDir).toURI();
      }
      PinotFS pinotFS = PinotFSFactory.create(depsJarDirURI.getScheme());
      String[] files = pinotFS.listFiles(depsJarDirURI, true);
      for (String file : files) {
        if (!pinotFS.isDirectory(URI.create(file))) {
          if (file.endsWith(".jar")) {
            LOGGER.info("Adding deps jar: {} to distributed cache", file);
            sparkContext.addJar(file);
          }
        }
      }
    }
```

### DuplicatedCode
Duplicated code
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-spark-2.4/src/main/java/org/apache/pinot/plugin/ingestion/batch/spark/SparkSegmentGenerationJobRunner.java`
#### Snippet
```java
    String[] pluginDirectories = PluginManager.get().getPluginsDirectories();
    if (pluginDirectories == null) {
      LOGGER.warn("Plugin directories is null, skipping packaging...");
      return;
    }

    ArrayList<File> validPluginDirectories = new ArrayList();

    for (String pluginsDirPath : pluginDirectories) {
      File pluginsDir = new File(pluginsDirPath);
      if (pluginsDir.exists()) {
        validPluginDirectories.add(pluginsDir);
      } else {
        LOGGER.warn("Cannot find Pinot plugins directory at [{}]", pluginsDirPath);
        return;
      }
    }

    File pluginsTarGzFile = new File(PINOT_PLUGINS_TAR_GZ);
    try {
      File[] files = validPluginDirectories.toArray(new File[0]);
      TarGzCompressionUtils.createTarGzFile(files, pluginsTarGzFile);
    } catch (IOException e) {
      LOGGER.error("Failed to tar plugins directories", e);
    }
    sparkContext.addFile(pluginsTarGzFile.getAbsolutePath());
    String pluginsIncludes = System.getProperty(PLUGINS_INCLUDE_PROPERTY_NAME);
    if (pluginsIncludes != null) {
      sparkContext.getConf().set(PLUGINS_INCLUDE_PROPERTY_NAME, pluginsIncludes);
    }
```

### DuplicatedCode
Duplicated code
in `pinot-plugins/pinot-file-system/pinot-s3/src/main/java/org/apache/pinot/plugin/filesystem/S3PinotFS.java`
#### Snippet
```java
        AssumeRoleRequest.Builder assumeRoleRequestBuilder =
            AssumeRoleRequest.builder().roleArn(s3Config.getRoleArn()).roleSessionName(s3Config.getRoleSessionName())
                .durationSeconds(s3Config.getSessionDurationSeconds());
        AssumeRoleRequest assumeRoleRequest;
        if (StringUtils.isNotEmpty(s3Config.getExternalId())) {
          assumeRoleRequest = assumeRoleRequestBuilder.externalId(s3Config.getExternalId()).build();
        } else {
          assumeRoleRequest = assumeRoleRequestBuilder.build();
        }
```

### DuplicatedCode
Duplicated code
in `pinot-plugins/pinot-file-system/pinot-s3/src/main/java/org/apache/pinot/plugin/filesystem/S3PinotFS.java`
#### Snippet
```java
    if (!_disableAcl) {
      putReqBuilder.acl(ObjectCannedACL.BUCKET_OWNER_FULL_CONTROL);
    }

    if (_serverSideEncryption != null) {
      putReqBuilder.serverSideEncryption(_serverSideEncryption).ssekmsKeyId(_ssekmsKeyId);
      if (_ssekmsEncryptionContext != null) {
        putReqBuilder.ssekmsEncryptionContext(_ssekmsEncryptionContext);
      }
    }
    return putReqBuilder.build();
```

### DuplicatedCode
Duplicated code
in `pinot-plugins/pinot-input-format/pinot-avro-base/src/main/java/org/apache/pinot/plugin/inputformat/avro/AvroIngestionSchemaValidator.java`
#### Snippet
```java
        org.apache.avro.Schema nonNullSchema = null;
        for (org.apache.avro.Schema childFieldSchema : avroColumnSchema.getTypes()) {
          if (childFieldSchema.getType() != org.apache.avro.Schema.Type.NULL) {
            if (nonNullSchema == null) {
              nonNullSchema = childFieldSchema;
            } else {
              throw new IllegalStateException("More than one non-null schema in UNION schema");
            }
          }
        }
```

### DuplicatedCode
Duplicated code
in `pinot-plugins/pinot-input-format/pinot-avro-base/src/main/java/org/apache/pinot/plugin/inputformat/avro/AvroUtils.java`
#### Snippet
```java
        for (org.apache.avro.Schema childFieldSchema : fieldSchema.getTypes()) {
          if (childFieldSchema.getType() != org.apache.avro.Schema.Type.NULL) {
            if (nonNullSchema == null) {
              nonNullSchema = childFieldSchema;
            } else {
              throw new IllegalStateException("More than one non-null schema in UNION schema");
            }
          }
        }
```

### DuplicatedCode
Duplicated code
in `pinot-plugins/pinot-input-format/pinot-avro-base/src/main/java/org/apache/pinot/plugin/inputformat/avro/AvroUtils.java`
#### Snippet
```java
    if (fieldTypeMap == null) {
      pinotSchema.addField(new DimensionFieldSpec(name, dataType, isSingleValueField));
    } else {
      FieldSpec.FieldType fieldType = fieldTypeMap.getOrDefault(name, FieldSpec.FieldType.DIMENSION);
      Preconditions.checkNotNull(fieldType, "Field type not specified for field: %s", name);
      switch (fieldType) {
        case DIMENSION:
          pinotSchema.addField(new DimensionFieldSpec(name, dataType, isSingleValueField));
          break;
        case METRIC:
          Preconditions.checkState(isSingleValueField, "Metric field: %s cannot be multi-valued", name);
          pinotSchema.addField(new MetricFieldSpec(name, dataType));
          break;
        case DATE_TIME:
          Preconditions.checkState(isSingleValueField, "Time field: %s cannot be multi-valued", name);
          Preconditions.checkNotNull(timeUnit, "Time unit cannot be null");
          // TODO: Switch to new format after releasing 0.11.0
          //       "EPOCH|" + timeUnit.name()
          String format = "1:" + timeUnit.name() + ":EPOCH";
          String granularity = "1:" + timeUnit.name();
          pinotSchema.addField(new DateTimeFieldSpec(name, dataType, format, granularity));
          break;
        default:
          throw new UnsupportedOperationException("Unsupported field type: " + fieldType + " for field: " + name);
      }
    }
```

### DuplicatedCode
Duplicated code
in `pinot-plugins/pinot-input-format/pinot-avro/src/main/java/org/apache/pinot/plugin/inputformat/avro/KafkaAvroMessageDecoder.java`
#### Snippet
```java
    String recordExtractorClass = props.get(RECORD_EXTRACTOR_CONFIG_KEY);
    String recordExtractorConfigClass = props.get(RECORD_EXTRACTOR_CONFIG_CONFIG_KEY);
    // Backward compatibility to support Avro by default
    if (recordExtractorClass == null) {
      recordExtractorClass = AvroRecordExtractor.class.getName();
      recordExtractorConfigClass = AvroRecordExtractorConfig.class.getName();
    }
    RecordExtractorConfig config = null;
    if (recordExtractorConfigClass != null) {
      config = PluginManager.get().createInstance(recordExtractorConfigClass);
      config.init(props);
    }
    _avroRecordExtractor = PluginManager.get().createInstance(recordExtractorClass);
    _avroRecordExtractor.init(fieldsToRead, config);
```

### DuplicatedCode
Duplicated code
in `pinot-plugins/pinot-input-format/pinot-clp-log/src/main/java/org/apache/pinot/plugin/inputformat/clplog/CLPLogMessageDecoder.java`
#### Snippet
```java
    try {
      JsonNode message = JsonUtils.bytesToJsonNode(payload);
      Map<String, Object> from = JsonUtils.jsonNodeToMap(message);
      _recordExtractor.extract(from, destination);
      return destination;
    } catch (Exception e) {
      LOGGER.error("Caught exception while decoding row, discarding row. Payload is {}", new String(payload), e);
      return null;
    }
```

### DuplicatedCode
Duplicated code
in `pinot-plugins/pinot-input-format/pinot-confluent-avro/src/main/java/org/apache/pinot/plugin/inputformat/avro/confluent/KafkaConfluentSchemaRegistryAvroMessageDecoder.java`
#### Snippet
```java
    RestService restService = new RestService(schemaRegistryUrl);

    ConfigDef configDef = new ConfigDef();
    SslConfigs.addClientSslSupport(configDef);
    Map<String, ConfigDef.ConfigKey> configKeyMap = configDef.configKeys();
    Map<String, Object> sslConfigs = new HashMap<>();
    for (String key : configs.keySet()) {
      if (!key.equals(SCHEMA_REGISTRY_REST_URL) && key.startsWith(SCHEMA_REGISTRY_OPTS_PREFIX)) {
        String value = configs.get(key);
        String schemaRegistryOptKey = key.substring(SCHEMA_REGISTRY_OPTS_PREFIX.length());

        if (configKeyMap.containsKey(schemaRegistryOptKey)) {
          if (configKeyMap.get(schemaRegistryOptKey).type == ConfigDef.Type.PASSWORD) {
            sslConfigs.put(schemaRegistryOptKey, new Password(value));
          } else {
            sslConfigs.put(schemaRegistryOptKey, value);
          }
        }
      }
    }

    if (!sslConfigs.isEmpty()) {
      DefaultSslEngineFactory sslFactory = new DefaultSslEngineFactory();
      sslFactory.configure(sslConfigs);
      restService.setSslSocketFactory(sslFactory.sslContext().getSocketFactory());
    }
    return restService;
```

### DuplicatedCode
Duplicated code
in `pinot-plugins/pinot-minion-tasks/pinot-minion-builtin-tasks/src/main/java/org/apache/pinot/plugin/minion/tasks/BaseMultipleSegmentsConversionExecutor.java`
#### Snippet
```java
    _pinotTaskConfig = pinotTaskConfig;
    _eventObserver = MinionEventObservers.getInstance().getMinionEventObserver(pinotTaskConfig.getTaskId());
    String taskType = pinotTaskConfig.getTaskType();
    Map<String, String> configs = pinotTaskConfig.getConfigs();
    String tableNameWithType = configs.get(MinionConstants.TABLE_NAME_KEY);
    String inputSegmentNames = configs.get(MinionConstants.SEGMENT_NAME_KEY);
```

### DuplicatedCode
Duplicated code
in `pinot-plugins/pinot-minion-tasks/pinot-minion-builtin-tasks/src/main/java/org/apache/pinot/plugin/minion/tasks/BaseSingleSegmentConversionExecutor.java`
#### Snippet
```java
      httpHeaders.add(segmentZKMetadataCustomMapModifierHeader);
      httpHeaders.addAll(AuthProviderUtils.toRequestHeaders(authProvider));

      // Set parameters for upload request.
      NameValuePair enableParallelPushProtectionParameter =
          new BasicNameValuePair(FileUploadDownloadClient.QueryParameters.ENABLE_PARALLEL_PUSH_PROTECTION, "true");
      NameValuePair tableNameParameter = new BasicNameValuePair(FileUploadDownloadClient.QueryParameters.TABLE_NAME,
          TableNameBuilder.extractRawTableName(tableNameWithType));
      NameValuePair tableTypeParameter = new BasicNameValuePair(FileUploadDownloadClient.QueryParameters.TABLE_TYPE,
          TableNameBuilder.getTableTypeFromTableName(tableNameWithType).toString());
```

### DuplicatedCode
Duplicated code
in `pinot-plugins/pinot-minion-tasks/pinot-minion-builtin-tasks/src/main/java/org/apache/pinot/plugin/minion/tasks/BaseMultipleSegmentsConversionExecutor.java`
#### Snippet
```java
        httpHeaders.addAll(AuthProviderUtils.toRequestHeaders(authProvider));

        // Set parameters for upload request
        NameValuePair enableParallelPushProtectionParameter =
            new BasicNameValuePair(FileUploadDownloadClient.QueryParameters.ENABLE_PARALLEL_PUSH_PROTECTION, "true");
        NameValuePair tableNameParameter = new BasicNameValuePair(FileUploadDownloadClient.QueryParameters.TABLE_NAME,
            TableNameBuilder.extractRawTableName(tableNameWithType));
        NameValuePair tableTypeParameter = new BasicNameValuePair(FileUploadDownloadClient.QueryParameters.TABLE_TYPE,
            TableNameBuilder.getTableTypeFromTableName(tableNameWithType).toString());
```

### DuplicatedCode
Duplicated code
in `pinot-plugins/pinot-minion-tasks/pinot-minion-builtin-tasks/src/main/java/org/apache/pinot/plugin/minion/tasks/BaseMultipleSegmentsConversionExecutor.java`
#### Snippet
```java
    LOGGER.info("Trying to push Pinot segment with push mode {} from {}", pushMode, outputSegmentTarURI);

    PushJobSpec pushJobSpec = new PushJobSpec();
    pushJobSpec.setPushAttempts(DEFUALT_PUSH_ATTEMPTS);
    pushJobSpec.setPushParallelism(DEFAULT_PUSH_PARALLELISM);
    pushJobSpec.setPushRetryIntervalMillis(DEFAULT_PUSH_RETRY_INTERVAL_MILLIS);
    pushJobSpec.setSegmentUriPrefix(taskConfigs.get(BatchConfigProperties.PUSH_SEGMENT_URI_PREFIX));
    pushJobSpec.setSegmentUriSuffix(taskConfigs.get(BatchConfigProperties.PUSH_SEGMENT_URI_SUFFIX));

    SegmentGenerationJobSpec spec = generatePushJobSpec(tableName, taskConfigs, pushJobSpec);
```

### DuplicatedCode
Duplicated code
in `pinot-plugins/pinot-minion-tasks/pinot-minion-builtin-tasks/src/main/java/org/apache/pinot/plugin/minion/tasks/BaseMultipleSegmentsConversionExecutor.java`
#### Snippet
```java
    TableSpec tableSpec = new TableSpec();
    tableSpec.setTableName(tableName);

    PinotClusterSpec pinotClusterSpec = new PinotClusterSpec();
    pinotClusterSpec.setControllerURI(taskConfigs.get(BatchConfigProperties.PUSH_CONTROLLER_URI));
    PinotClusterSpec[] pinotClusterSpecs = new PinotClusterSpec[]{pinotClusterSpec};

    SegmentGenerationJobSpec spec = new SegmentGenerationJobSpec();
    spec.setPushJobSpec(pushJobSpec);
    spec.setTableSpec(tableSpec);
    spec.setPinotClusterSpecs(pinotClusterSpecs);
    spec.setAuthToken(taskConfigs.get(BatchConfigProperties.AUTH_TOKEN));

    return spec;
```

### DuplicatedCode
Duplicated code
in `pinot-plugins/pinot-minion-tasks/pinot-minion-builtin-tasks/src/main/java/org/apache/pinot/plugin/minion/tasks/mergerollup/MergeRollupTaskExecutor.java`
#### Snippet
```java
    int numInputSegments = segmentDirs.size();
    _eventObserver.notifyProgress(pinotTaskConfig, "Converting segments: " + numInputSegments);
    String taskType = pinotTaskConfig.getTaskType();
    Map<String, String> configs = pinotTaskConfig.getConfigs();
    LOGGER.info("Starting task: {} with configs: {}", taskType, configs);
    long startMillis = System.currentTimeMillis();

    String tableNameWithType = configs.get(MinionConstants.TABLE_NAME_KEY);
```

### DuplicatedCode
Duplicated code
in `pinot-plugins/pinot-minion-tasks/pinot-minion-builtin-tasks/src/main/java/org/apache/pinot/plugin/minion/tasks/mergerollup/MergeRollupTaskExecutor.java`
#### Snippet
```java
    TableConfig tableConfig = getTableConfig(tableNameWithType);
    Schema schema = getSchema(tableNameWithType);

    SegmentProcessorConfig.Builder segmentProcessorConfigBuilder =
        new SegmentProcessorConfig.Builder().setTableConfig(tableConfig).setSchema(schema);

    // Time handler config
    segmentProcessorConfigBuilder
        .setTimeHandlerConfig(MergeTaskUtils.getTimeHandlerConfig(tableConfig, schema, configs));

    // Partitioner config
    segmentProcessorConfigBuilder
        .setPartitionerConfigs(MergeTaskUtils.getPartitionerConfigs(tableConfig, schema, configs));
```

### DuplicatedCode
Duplicated code
in `pinot-plugins/pinot-minion-tasks/pinot-minion-builtin-tasks/src/main/java/org/apache/pinot/plugin/minion/tasks/mergerollup/MergeRollupTaskExecutor.java`
#### Snippet
```java
segmentProcessorConfigBuilder.setAggregationTypes(MergeTaskUtils.getAggregationTypes(configs));

    // Segment config
    segmentProcessorConfigBuilder.setSegmentConfig(MergeTaskUtils.getSegmentConfig(configs));

    // Progress observer
    segmentProcessorConfigBuilder.setProgressObserver(p -> _eventObserver.notifyProgress(_pinotTaskConfig, p));

    SegmentProcessorConfig segmentProcessorConfig = segmentProcessorConfigBuilder.build();

    List<RecordReader> recordReaders = new ArrayList<>(numInputSegments);
    int count = 1;
    for (File segmentDir : segmentDirs) {
      _eventObserver.notifyProgress(_pinotTaskConfig,
          String.format("Creating RecordReader for: %s (%d out of %d)", segmentDir, count++, numInputSegments));
      PinotSegmentRecordReader recordReader = new PinotSegmentRecordReader();
      // NOTE: Do not fill null field with default value to be consistent with other record readers
      recordReader.init(segmentDir, null, null, true);
      recordReaders.add(recordReader);
    }
    List<File> outputSegmentDirs;
    try {
      _eventObserver.notifyProgress(_pinotTaskConfig, "Generating segments");
      outputSegmentDirs = new SegmentProcessorFramework(recordReaders, segmentProcessorConfig, workingDir).process();
    } finally {
      for (RecordReader recordReader : recordReaders) {
        recordReader.close();
      }
    }

    long endMillis = System.currentTimeMillis();
    LOGGER.info("Finished task: {} with configs: {}. Total time: {}ms", taskType, configs, (endMillis - startMillis));
    List<SegmentConversionResult> results = new ArrayList<>();
    for (File outputSegmentDir : outputSegmentDirs) {
      String outputSegmentName = outputSegmentDir.getName();
      results.add(new SegmentConversionResult.Builder().setFile(outputSegmentDir).setSegmentName(outputSegmentName)
          .setTableNameWithType(tableNameWithType).build());
    }
    return results;
```

### DuplicatedCode
Duplicated code
in `pinot-plugins/pinot-minion-tasks/pinot-minion-builtin-tasks/src/main/java/org/apache/pinot/plugin/minion/tasks/mergerollup/MergeRollupTaskGenerator.java`
#### Snippet
```java
              if (!isMergedSegment(preSelectedSegment, mergeLevel, sortedMergeLevels)) {
                hasUnmergedSegments = true;
              }
              if (!isMergedSegment(preSelectedSegment, lowerMergeLevel, sortedMergeLevels)) {
                areAllSegmentsReadyToMerge = false;
              }
              if (hasSpilledOverData(preSelectedSegment, bucketMs)) {
                hasSpilledOverData = true;
              }
              selectedSegmentsForBucket.add(preSelectedSegment);
```

### DuplicatedCode
Duplicated code
in `pinot-plugins/pinot-stream-ingestion/pinot-kafka-2.0/src/main/java/org/apache/pinot/plugin/stream/kafka20/KafkaStreamLevelConsumer.java`
#### Snippet
```java
        _currentCount++;

        final long now = System.currentTimeMillis();
        // Log every minute or 100k events
        if (now - _lastLogTime > 60000 || _currentCount - _lastCount >= 100000) {
          if (_lastCount == 0) {
            _instanceLogger
                .info("Consumed {} events from kafka stream {}", _currentCount, _streamConfig.getTopicName());
          } else {
            _instanceLogger.info("Consumed {} events from kafka stream {} (rate:{}/s)", _currentCount - _lastCount,
                _streamConfig.getTopicName(), (float) (_currentCount - _lastCount) * 1000 / (now - _lastLogTime));
          }
          _lastCount = _currentCount;
          _lastLogTime = now;
        }
        return destination;
```

### DuplicatedCode
Duplicated code
in `pinot-plugins/pinot-stream-ingestion/pinot-kafka-2.0/src/main/java/org/apache/pinot/plugin/stream/kafka20/server/KafkaDataServerStartable.java`
#### Snippet
```java
    long endTime = System.currentTimeMillis() + timeoutMs;
    String errorMessageSuffix = errorMessage != null ? ", error message: " + errorMessage : "";
    while (System.currentTimeMillis() < endTime) {
      try {
        if (Boolean.TRUE.equals(condition.apply(null))) {
          return;
        }
        Thread.sleep(checkIntervalMs);
      } catch (Exception e) {
        LOGGER.error("Caught exception while checking the condition" + errorMessageSuffix, e);
      }
    }
    LOGGER.error("Failed to meet condition in " + timeoutMs + "ms" + errorMessageSuffix);
```

### DuplicatedCode
Duplicated code
in `pinot-query-runtime/src/main/java/org/apache/pinot/query/runtime/operator/MailboxReceiveOperator.java`
#### Snippet
```java
      ReceivingMailbox mailbox = _mailboxes.remove();
      TransferableBlock block = mailbox.poll();

      // Release the mailbox when the block is end-of-stream
      if (block != null && block.isSuccessfulEndOfStreamBlock()) {
        _mailboxService.releaseReceivingMailbox(mailbox);
        _opChainStats.getOperatorStatsMap().putAll(block.getResultMetadata());
        continue;
      }

      // Add the mailbox back to the queue if the block is not end-of-stream
      _mailboxes.add(mailbox);
```

### DuplicatedCode
Duplicated code
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/function/InbuiltFunctionEvaluator.java`
#### Snippet
```java
      try {
        int numArguments = _argumentNodes.length;
        for (int i = 0; i < numArguments; i++) {
          _arguments[i] = _argumentNodes[i].execute(row);
        }
        if (!_functionInfo.hasNullableParameters()) {
          // Preserve null values during ingestion transformation if function is an inbuilt
          // scalar function that cannot handle nulls, and invoked with null parameter(s).
          for (Object argument : _arguments) {
            if (argument == null) {
              return null;
            }
          }
        }
        _functionInvoker.convertTypes(_arguments);
        return _functionInvoker.invoke(_arguments);
      } catch (Exception e) {
        throw new RuntimeException("Caught exception while executing function: " + this, e);
      }
```

### DuplicatedCode
Duplicated code
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/util/PinotDataBitSet.java`
#### Snippet
```java
    long bitOffset = (long) index * numBitsPerValue;
    int byteOffset = (int) (bitOffset / Byte.SIZE);
    int bitOffsetInFirstByte = (int) (bitOffset % Byte.SIZE);

    int firstByte = _dataBuffer.getByte(byteOffset);

    int firstByteMask = BYTE_MASK >>> bitOffsetInFirstByte;
    int numBitsLeft = numBitsPerValue - (Byte.SIZE - bitOffsetInFirstByte);
    if (numBitsLeft <= 0) {
      // The value is inside the first byte
      firstByteMask &= BYTE_MASK << -numBitsLeft;
      _dataBuffer.putByte(byteOffset, (byte) ((firstByte & ~firstByteMask) | (value << -numBitsLeft)));
    } else {
      // The value is in multiple bytes
      _dataBuffer
          .putByte(byteOffset, (byte) ((firstByte & ~firstByteMask) | ((value >>> numBitsLeft) & firstByteMask)));
      while (numBitsLeft > Byte.SIZE) {
        numBitsLeft -= Byte.SIZE;
        byteOffset++;
        _dataBuffer.putByte(byteOffset, (byte) (value >> numBitsLeft));
      }
      byteOffset++;
      int lastByte = _dataBuffer.getByte(byteOffset);
      _dataBuffer.putByte(byteOffset,
          (byte) ((lastByte & (BYTE_MASK >>> numBitsLeft)) | (value << (Byte.SIZE - numBitsLeft))));
    }
```

### DuplicatedCode
Duplicated code
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/util/PinotDataBitSet.java`
#### Snippet
```java
    long startBitOffset = (long) startIndex * numBitsPerValue;
    int byteOffset = (int) (startBitOffset / Byte.SIZE);
    int bitOffsetInFirstByte = (int) (startBitOffset % Byte.SIZE);

    int firstByte = _dataBuffer.getByte(byteOffset);

    for (int i = 0; i < length; i++) {
      int value = values[i];
      if (bitOffsetInFirstByte == Byte.SIZE) {
        bitOffsetInFirstByte = 0;
        byteOffset++;
        firstByte = _dataBuffer.getByte(byteOffset);
      }
      int firstByteMask = BYTE_MASK >>> bitOffsetInFirstByte;
      int numBitsLeft = numBitsPerValue - (Byte.SIZE - bitOffsetInFirstByte);
      if (numBitsLeft <= 0) {
        // The value is inside the first byte
        firstByteMask &= BYTE_MASK << -numBitsLeft;
        firstByte = ((firstByte & ~firstByteMask) | (value << -numBitsLeft));
        _dataBuffer.putByte(byteOffset, (byte) firstByte);
        bitOffsetInFirstByte = Byte.SIZE + numBitsLeft;
      } else {
        // The value is in multiple bytes
        _dataBuffer
            .putByte(byteOffset, (byte) ((firstByte & ~firstByteMask) | ((value >>> numBitsLeft) & firstByteMask)));
        while (numBitsLeft > Byte.SIZE) {
          numBitsLeft -= Byte.SIZE;
          byteOffset++;
          _dataBuffer.putByte(byteOffset, (byte) (value >> numBitsLeft));
        }
        byteOffset++;
        int lastByte = _dataBuffer.getByte(byteOffset);
        firstByte = (lastByte & (0xFF >>> numBitsLeft)) | (value << (Byte.SIZE - numBitsLeft));
        _dataBuffer.putByte(byteOffset, (byte) firstByte);
        bitOffsetInFirstByte = numBitsLeft;
      }
    }
```

### DuplicatedCode
Duplicated code
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/util/PinotDataBitSetV2.java`
#### Snippet
```java
        packed = (int) _dataBuffer.getByte(byteOffset) & 0xff;
        out[i] = (packed >>> 7) & 1;
        out[i + 1] = (packed >>> 6) & 1;
        out[i + 2] = (packed >>> 5) & 1;
        out[i + 3] = (packed >>> 4) & 1;
        out[i + 4] = (packed >>> 3) & 1;
        out[i + 5] = (packed >>> 2) & 1;
        out[i + 6] = (packed >>> 1) & 1;
```

### DuplicatedCode
Duplicated code
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/util/PinotDataBitSetV2.java`
#### Snippet
```java
        out[i] = (packed >>> 7) & 1;
        out[i + 1] = (packed >>> 6) & 1;
        out[i + 2] = (packed >>> 5) & 1;
        out[i + 3] = (packed >>> 4) & 1;
        out[i + 4] = (packed >>> 3) & 1;
```

### DuplicatedCode
Duplicated code
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/writer/impl/VarByteChunkSVForwardIndexWriter.java`
#### Snippet
```java
    _chunkBuffer.putInt(_chunkHeaderOffset, _chunkDataOffSet);
    _chunkHeaderOffset += CHUNK_HEADER_ENTRY_ROW_OFFSET_SIZE;
    // write all the strings into the data buffer as if it's a single string,
    // but with its own embedded header so offsets to strings within the body
    // can be located
    _chunkBuffer.putInt(_chunkDataOffSet, values.length);
    _chunkDataOffSet += Integer.BYTES;
    int headerSize = Integer.BYTES * values.length;
    int bodyPosition = _chunkDataOffSet + headerSize;
    _chunkBuffer.position(bodyPosition);
    int bodySize = 0;
```

### DuplicatedCode
Duplicated code
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/realtime/impl/forward/FixedByteMVMutableForwardIndex.java`
#### Snippet
```java
    FixedByteSingleValueMultiColReader headerReader = getCurrentReader(docId);
    int rowInCurrentHeader = getRowInCurrentHeader(docId);
    int bufferIndex = headerReader.getInt(rowInCurrentHeader, 0);
    int startIndex = headerReader.getInt(rowInCurrentHeader, 1);
    int length = headerReader.getInt(rowInCurrentHeader, 2);
    FixedByteSingleValueMultiColReader dataReader = _dataReaders.get(bufferIndex);
```

### DuplicatedCode
Duplicated code
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/realtime/impl/json/MutableJsonIndexImpl.java`
#### Snippet
```java
      int rightBracketIndex = key.indexOf(']', leftBracketIndex + 2);
      Preconditions.checkArgument(rightBracketIndex > 0, "Missing right bracket in key: %s", key);

      String leftPart = key.substring(0, leftBracketIndex);
      String arrayIndex = key.substring(leftBracketIndex + 1, rightBracketIndex);
      String rightPart = key.substring(rightBracketIndex + 1);
```

### DuplicatedCode
Duplicated code
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/realtime/impl/json/MutableJsonIndexImpl.java`
#### Snippet
```java
      RoaringBitmap matchingDocIdsForKeyValuePair = _postingListMap.get(keyValuePair);
      if (matchingDocIdsForKeyValuePair != null) {
        if (matchingDocIds == null) {
          return matchingDocIdsForKeyValuePair.clone();
        } else {
          matchingDocIds.and(matchingDocIdsForKeyValuePair);
          return matchingDocIds;
        }
      } else {
        return new RoaringBitmap();
      }
```

### DuplicatedCode
Duplicated code
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/recordtransformer/ComplexTypeTransformer.java`
#### Snippet
```java
        if (_fieldsToUnnest.contains(column)) {
          for (Object inner : collection) {
            if (inner instanceof Map) {
              Map<String, Object> innerMap = (Map<String, Object>) inner;
              flattenMap(column, innerMap, new ArrayList<>(innerMap.keySet()));
            }
          }
        } else if (shallConvertToJson(collection)) {
          try {
            // convert the collection to JSON string
            String jsonString = JsonFunctions.jsonFormat(collection);
            record.putValue(column, jsonString);
          } catch (JsonProcessingException e) {
            throw new RuntimeException(
                String.format("Caught exception while converting value to JSON string %s", value), e);
          }
        }
```

### DuplicatedCode
Duplicated code
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/recordtransformer/ComplexTypeTransformer.java`
#### Snippet
```java
    switch (_collectionNotUnnestedToJson) {
      case ALL:
        return true;
      case NONE:
        return false;
      case NON_PRIMITIVE:
        return !containPrimitives(value);
      default:
        throw new IllegalArgumentException(
            String.format("Unsupported collectionNotUnnestedToJson %s", _collectionNotUnnestedToJson));
    }
```

### DuplicatedCode
Duplicated code
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/recordtransformer/DataTypeTransformer.java`
#### Snippet
```java
      List<Object> standardizedValues = new ArrayList<>(numValues);
      for (Object singleValue : values) {
        Object standardizedValue = standardize(column, singleValue, true);
        if (standardizedValue != null) {
          standardizedValues.add(standardizedValue);
        }
      }
      int numStandardizedValues = standardizedValues.size();
      if (numStandardizedValues == 0) {
        return null;
      }
      if (numStandardizedValues == 1) {
        return standardizedValues.get(0);
      }
```

### DuplicatedCode
Duplicated code
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/loader/ForwardIndexHandler.java`
#### Snippet
```java
    Map<String, String> metadataProperties = new HashMap<>();
    metadataProperties.put(getKeyFor(column, HAS_DICTIONARY), String.valueOf(false));
    metadataProperties.put(getKeyFor(column, DICTIONARY_ELEMENT_SIZE), String.valueOf(0));
    SegmentMetadataUtils.updateMetadataProperties(_segmentDirectory, metadataProperties);

    // Remove the inverted index, FST index and range index
    removeDictRelatedIndexes(column, segmentWriter);
```

### DuplicatedCode
Duplicated code
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/loader/ForwardIndexHandler.java`
#### Snippet
```java
    ColumnMetadata existingColMetadata = _segmentDirectory.getSegmentMetadata().getColumnMetadataFor(column);
    boolean isSingleValue = existingColMetadata.isSingleValue();

    File indexDir = _segmentDirectory.getSegmentMetadata().getIndexDir();
    String segmentName = _segmentDirectory.getSegmentMetadata().getName();
    File inProgress = new File(indexDir, column + ".fwd.inprogress");
    String fileExtension = isSingleValue ? V1Constants.Indexes.RAW_SV_FORWARD_INDEX_FILE_EXTENSION
        : V1Constants.Indexes.RAW_MV_FORWARD_INDEX_FILE_EXTENSION;
    File fwdIndexFile = new File(indexDir, column + fileExtension);

    if (!inProgress.exists()) {
      // Marker file does not exist, which means last run ended normally.
      // Create a marker file.
      FileUtils.touch(inProgress);
    } else {
      // Marker file exists, which means last run was interrupted.
      // Remove forward index if exists.
      FileUtils.deleteQuietly(fwdIndexFile);
    }
```

### DuplicatedCode
Duplicated code
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/loader/ForwardIndexHandler.java`
#### Snippet
```java
      ForwardIndexConfig config = _fieldIndexConfigs.get(column).getConfig(StandardIndexes.forward());

      try (ForwardIndexCreator creator = StandardIndexes.forward().createIndexCreator(context, config)) {
        if (!reader.getStoredType().equals(creator.getValueType())) {
          // Creator stored type should match reader stored type for raw columns. We do not support changing datatypes.
          String failureMsg =
              "Unsupported operation to change datatype for column=" + column + " from " + reader.getStoredType()
                  .toString() + " to " + creator.getValueType().toString();
          throw new UnsupportedOperationException(failureMsg);
        }

        int numDocs = existingColMetadata.getTotalDocs();
        forwardIndexRewriteHelper(column, existingColMetadata, reader, creator, numDocs, null, null);
      }
```

### DuplicatedCode
Duplicated code
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/loader/InvertedIndexAndDictionaryBasedForwardIndexCreator.java`
#### Snippet
```java
      writeToForwardIndex(dictionary, context);

      // Setup and return the metadata properties to update
      Map<String, String> metadataProperties = new HashMap<>();
      metadataProperties.put(getKeyFor(_columnName, HAS_DICTIONARY), String.valueOf(_dictionaryEnabled));
      metadataProperties.put(getKeyFor(_columnName, DICTIONARY_ELEMENT_SIZE),
          String.valueOf(_dictionaryEnabled ? _columnMetadata.getColumnMaxLength() : 0));
```

### DuplicatedCode
Duplicated code
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/loader/invertedindex/InvertedIndexHandler.java`
#### Snippet
```java
        if (columnMetadata.isSingleValue()) {
          // Single-value column.
          for (int i = 0; i < numDocs; i++) {
            creator.add(forwardIndexReader.getDictId(i, readerContext));
          }
        } else {
          // Multi-value column.
          int[] dictIds = new int[columnMetadata.getMaxNumberOfMultiValues()];
          for (int i = 0; i < numDocs; i++) {
            int length = forwardIndexReader.getDictIdMV(i, dictIds, readerContext);
            creator.add(dictIds, length);
          }
        }
        creator.seal();
```

### DuplicatedCode
Duplicated code
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/readers/forward/FixedBitMVForwardIndexReader.java`
#### Snippet
```java
    int contextDocId = context._docId;
    int contextEndOffset = context._endOffset;
    int startIndex;
    if (docId == contextDocId + 1) {
      startIndex = contextEndOffset;
    } else {
      int chunkId = docId / _numDocsPerChunk;
      if (docId > contextDocId && chunkId == contextDocId / _numDocsPerChunk) {
        // Same chunk
        startIndex = _bitmapReader.getNextNthSetBitOffset(contextEndOffset + 1, docId - contextDocId - 1);
      } else {
        // Different chunk
        int chunkOffset = _chunkOffsetReader.getInt(chunkId);
        int indexInChunk = docId % _numDocsPerChunk;
        if (indexInChunk == 0) {
          startIndex = chunkOffset;
        } else {
          startIndex = _bitmapReader.getNextNthSetBitOffset(chunkOffset + 1, indexInChunk);
        }
      }
    }
    int endIndex;
    if (docId == _numDocs - 1) {
      endIndex = _numValues;
    } else {
      endIndex = _bitmapReader.getNextSetBitOffset(startIndex + 1);
    }
```

### DuplicatedCode
Duplicated code
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/readers/forward/FixedByteChunkMVForwardIndexReader.java`
#### Snippet
```java
    int chunkId = docId / _numDocsPerChunk;
    int chunkRowId = docId % _numDocsPerChunk;

    // These offsets are offset in the data buffer
    long chunkStartOffset = getChunkPosition(chunkId);
    long valueStartOffset =
        chunkStartOffset + _dataBuffer.getInt(chunkStartOffset + (long) chunkRowId * ROW_OFFSET_SIZE);
    long valueEndOffset = getValueEndOffset(chunkId, chunkRowId, chunkStartOffset);
```

### DuplicatedCode
Duplicated code
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/readers/forward/FixedByteChunkMVForwardIndexReader.java`
#### Snippet
```java
    if (rowId == _numDocsPerChunk - 1) {
      // Last row in the chunk
      return chunkBuffer.limit();
    } else {
      int valueEndOffset = chunkBuffer.getInt((rowId + 1) * ROW_OFFSET_SIZE);
      if (valueEndOffset == 0) {
        // Last row in the last chunk (chunk is incomplete, which stores 0 as the offset for the absent rows)
        return chunkBuffer.limit();
      } else {
        return valueEndOffset;
      }
    }
```

### DuplicatedCode
Duplicated code
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/readers/forward/FixedByteChunkMVForwardIndexReader.java`
#### Snippet
```java
    if (chunkId == _numChunks - 1) {
      // Last chunk
      if (chunkRowId == _numDocsPerChunk - 1) {
        // Last row in the last chunk
        return _dataBuffer.size();
      } else {
        int valueEndOffsetInChunk = _dataBuffer
            .getInt(chunkStartOffset + (long) (chunkRowId + 1) * ROW_OFFSET_SIZE);
        if (valueEndOffsetInChunk == 0) {
          // Last row in the last chunk (chunk is incomplete, which stores 0 as the offset for the absent rows)
          return _dataBuffer.size();
        } else {
          return chunkStartOffset + valueEndOffsetInChunk;
        }
      }
    } else {
      if (chunkRowId == _numDocsPerChunk - 1) {
        // Last row in the chunk
        return getChunkPosition(chunkId + 1);
      } else {
        return chunkStartOffset + _dataBuffer
            .getInt(chunkStartOffset + (long) (chunkRowId + 1) * ROW_OFFSET_SIZE);
      }
    }
```

### DuplicatedCode
Duplicated code
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/readers/forward/VarByteChunkMVForwardIndexReader.java`
#### Snippet
```java
    byte[] compressedBytes;
    if (_isCompressed) {
      compressedBytes = getBytesCompressed(docId, context);
    } else {
      compressedBytes = getBytesUncompressed(docId);
    }
    ByteBuffer byteBuffer = ByteBuffer.wrap(compressedBytes);
    int numValues = byteBuffer.getInt();
    int contentOffset = (numValues + 1) * Integer.BYTES;
```

### DuplicatedCode
Duplicated code
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/readers/forward/VarByteChunkMVForwardIndexReader.java`
#### Snippet
```java
    for (int i = 0; i < numValues; i++) {
      int length = byteBuffer.getInt((i + 1) * Integer.BYTES);
      byte[] bytes = new byte[length];
      byteBuffer.position(contentOffset);
      byteBuffer.get(bytes, 0, length);
      valueBuffer[i] = new String(bytes, StandardCharsets.UTF_8);
      contentOffset += length;
    }
    return numValues;
```

### DuplicatedCode
Duplicated code
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/readers/forward/VarByteChunkMVForwardIndexReader.java`
#### Snippet
```java
    for (int i = 0; i < numValues; i++) {
      int length = byteBuffer.getInt((i + 1) * Integer.BYTES);
      byte[] bytes = new byte[length];
      byteBuffer.position(contentOffset);
      byteBuffer.get(bytes, 0, length);
      valueBuffer[i] = bytes;
      contentOffset += length;
    }
    return numValues;
```

### DuplicatedCode
Duplicated code
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/readers/forward/VarByteChunkMVForwardIndexReader.java`
#### Snippet
```java
    int chunkRowId = docId % _numDocsPerChunk;
    ByteBuffer chunkBuffer = getChunkBuffer(docId, context);

    // These offsets are offset in the chunk buffer
    int valueStartOffset = chunkBuffer.getInt(chunkRowId * ROW_OFFSET_SIZE);
    int valueEndOffset = getValueEndOffset(chunkRowId, chunkBuffer);

    byte[] bytes = new byte[valueEndOffset - valueStartOffset];
    chunkBuffer.position(valueStartOffset);
    chunkBuffer.get(bytes);
    return bytes;
```

### DuplicatedCode
Duplicated code
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/readers/forward/VarByteChunkSVForwardIndexReaderV4.java`
#### Snippet
```java
      int index = docId - _docIdOffset;
      int offset = _chunk.getInt((index + 1) * Integer.BYTES);
      int nextOffset = index == _numDocsInCurrentChunk - 1
          ? _chunk.limit()
          : _chunk.getInt((index + 2) * Integer.BYTES);
      byte[] bytes = new byte[nextOffset - offset];
      _chunk.position(offset);
      _chunk.get(bytes);
      _chunk.position(0);
      return bytes;
```

### DuplicatedCode
Duplicated code
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/readers/json/ImmutableJsonIndexReader.java`
#### Snippet
```java
      int dictId = _dictionary.indexOf(keyValuePair);
      if (dictId >= 0) {
        ImmutableRoaringBitmap matchingDocIdsForKeyValuePair = _invertedIndex.getDocIds(dictId);
        if (matchingDocIds == null) {
          matchingDocIds = matchingDocIdsForKeyValuePair.toMutableRoaringBitmap();
        } else {
          matchingDocIds.and(matchingDocIdsForKeyValuePair);
        }
        return matchingDocIds;
      } else {
        return new MutableRoaringBitmap();
      }
```

### DuplicatedCode
Duplicated code
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/GeometrySerializer.java`
#### Snippet
```java
    int pointCount = byteBuffer.getInt();
    int[] startIndexes = new int[partCount];
    for (int i = 0; i < partCount; i++) {
      startIndexes[i] = byteBuffer.getInt();
    }

    int[] partLengths = new int[partCount];
    if (partCount > 1) {
      partLengths[0] = startIndexes[1];
      for (int i = 1; i < partCount - 1; i++) {
        partLengths[i] = startIndexes[i + 1] - startIndexes[i];
      }
    }
    partLengths[partCount - 1] = pointCount - startIndexes[partCount - 1];
```

### DuplicatedCode
Duplicated code
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/GeometrySerializer.java`
#### Snippet
```java
    int numGeometries = geometry.getNumGeometries();
    int numParts = 0;
    int numPoints = geometry.getNumPoints();
    for (int i = 0; i < numGeometries; i++) {
      Polygon polygon = (Polygon) geometry.getGeometryN(i);
      if (polygon.getNumPoints() > 0) {
        numParts += polygon.getNumInteriorRing() + 1;
      }
    }
```

### DuplicatedCode
Duplicated code
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/SegmentPushUtils.java`
#### Snippet
```java
        URI controllerURI;
        try {
          controllerURI = new URI(pinotClusterSpec.getControllerURI());
        } catch (URISyntaxException e) {
          throw new RuntimeException("Got invalid controller uri - '" + pinotClusterSpec.getControllerURI() + "'");
        }
        LOGGER.info("Pushing segment: {} to location: {} for table {}", segmentName, controllerURI, tableName);
        int attempts = 1;
        if (spec.getPushJobSpec() != null && spec.getPushJobSpec().getPushAttempts() > 0) {
          attempts = spec.getPushJobSpec().getPushAttempts();
        }
        long retryWaitMs = 1000L;
        if (spec.getPushJobSpec() != null && spec.getPushJobSpec().getPushRetryIntervalMillis() > 0) {
          retryWaitMs = spec.getPushJobSpec().getPushRetryIntervalMillis();
        }
```

### DuplicatedCode
Duplicated code
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/SegmentPushUtils.java`
#### Snippet
```java
        int attempts = 1;
        if (spec.getPushJobSpec() != null && spec.getPushJobSpec().getPushAttempts() > 0) {
          attempts = spec.getPushJobSpec().getPushAttempts();
        }
        long retryWaitMs = 1000L;
        if (spec.getPushJobSpec() != null && spec.getPushJobSpec().getPushRetryIntervalMillis() > 0) {
          retryWaitMs = spec.getPushJobSpec().getPushRetryIntervalMillis();
        }
```

### DuplicatedCode
Duplicated code
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/SegmentPushUtils.java`
#### Snippet
```java
          } catch (HttpErrorStatusException e) {
            int statusCode = e.getStatusCode();
            if (statusCode >= 500) {
              // Temporary exception
              LOGGER.warn("Caught temporary exception while pushing table: {} segment: {} to {}, will retry", tableName,
                  segmentName, controllerURI, e);
              return false;
            } else {
              // Permanent exception
              LOGGER.error("Caught permanent exception while pushing table: {} segment: {} to {}, won't retry",
                  tableName, segmentName, controllerURI, e);
              throw e;
            }
          } finally {
```

### DuplicatedCode
Duplicated code
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/automaton/Automaton.java`
#### Snippet
```java
      Collection<Transition> tr;

      tr = s._transitionSet;
      for (Transition t : tr) {
        if (!visited.contains(t._to)) {
          visited.add(t._to);
          worklist.add(t._to);
        }
      }
```

### DuplicatedCode
Duplicated code
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/automaton/RunAutomaton.java`
#### Snippet
```java
    int a = 0;
    int b = _points.length;
    while (b - a > 1) {
      int d = (a + b) >>> 1;
      if (_points[d] > c) {
        b = d;
      } else if (_points[d] < c) {
        a = d;
      } else {
        return d;
      }
    }
    return a;
```

### DuplicatedCode
Duplicated code
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/automaton/SpecialOperations.java`
#### Snippet
```java
            if (t._max < m) {
              m = t._max;
            }
            s._transitionSet.add(new Transition(t._min, m, t._to));
            if (m + 1 > Character.MAX_VALUE) {
              break;
            }
            t._min = (char) (m + 1);
```

### DuplicatedCode
Duplicated code
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/automaton/TransitionComparator.java`
#### Snippet
```java
      if (t1._to != t2._to) {
        if (t1._to == null) {
          return -1;
        } else if (t2._to == null) {
          return 1;
        } else if (t1._to._number < t2._to._number) {
          return -1;
        } else if (t1._to._number > t2._to._number) {
          return 1;
        }
      }
```

### DuplicatedCode
Duplicated code
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/builder/FSTBuilder.java`
#### Snippet
```java
    final FSTBuilder builder = new FSTBuilder();

    int i = 0;
    for (byte[] chs : input) {
      builder.add(chs, 0, chs.length, i < outputSymbols.length ? outputSymbols[i] : -1);
      ++i;
    }

    return builder.complete();
```

### DuplicatedCode
Duplicated code
in `pinot-server/src/main/java/org/apache/pinot/server/api/resources/DebugResource.java`
#### Snippet
```java
      Map<String, String> recordsLagMap = new HashMap<>();
      Map<String, String> availabilityLagMsMap = new HashMap<>();
      realtimeSegmentDataManager.getPartitionToLagState(partitionStateMap).forEach((k, v) -> {
        recordsLagMap.put(k, v.getRecordsLag());
        availabilityLagMsMap.put(k, v.getAvailabilityLagMs());
      });
```

### DuplicatedCode
Duplicated code
in `pinot-server/src/main/java/org/apache/pinot/server/api/resources/TableSizeResource.java`
#### Snippet
```java
    InstanceDataManager instanceDataManager = _serverInstance.getInstanceDataManager();

    if (instanceDataManager == null) {
      throw new WebApplicationException("Invalid server initialization", Response.Status.INTERNAL_SERVER_ERROR);
    }

    TableDataManager tableDataManager = instanceDataManager.getTableDataManager(tableName);
    if (tableDataManager == null) {
      throw new WebApplicationException("Table: " + tableName + " is not found", Response.Status.NOT_FOUND);
    }
```

### DuplicatedCode
Duplicated code
in `pinot-server/src/main/java/org/apache/pinot/server/api/resources/TablesResource.java`
#### Snippet
```java
    ServerResourceUtils.validateDataAccess(_accessControlFactory, tableNameWithType, httpHeaders);

    TableDataManager tableDataManager =
        ServerResourceUtils.checkGetTableDataManager(_serverInstance, tableNameWithType);
    SegmentDataManager segmentDataManager = tableDataManager.acquireSegment(segmentName);
    if (segmentDataManager == null) {
      throw new WebApplicationException(
          String.format("Table %s segment %s does not exist", tableNameWithType, segmentName),
          Response.Status.NOT_FOUND);
    }
```

### DuplicatedCode
Duplicated code
in `pinot-tools/src/main/java/org/apache/pinot/tools/BootstrapTableTool.java`
#### Snippet
```java
    TableConfig tableConfig =
        JsonUtils.inputStreamToObject(new FileInputStream(offlineTableConfigFile), TableConfig.class);
    if (tableConfig.getIngestionConfig() != null
        && tableConfig.getIngestionConfig().getBatchIngestionConfig() != null) {
      updatedTableConfig(tableConfig, setupTableTmpDir);
    }

    LOGGER.info("Adding offline table: {}", tableName);
    File updatedTableConfigFile =
        new File(setupTableTmpDir, String.format("%s_%d.config", tableName, System.currentTimeMillis()));
    FileOutputStream outputStream = new FileOutputStream(updatedTableConfigFile);
    outputStream.write(JsonUtils.objectToPrettyString(tableConfig).getBytes());
    outputStream.close();
```

### DuplicatedCode
Duplicated code
in `pinot-tools/src/main/java/org/apache/pinot/tools/HybridQuickstart.java`
#### Snippet
```java
String q1 = "select count(*) from airlineStats limit 1";
    printStatus(Color.YELLOW, "Total number of documents in the table");
    printStatus(Color.CYAN, "Query : " + q1);
    printStatus(Color.YELLOW, prettyPrintResponse(runner.runQuery(q1)));
    printStatus(Color.GREEN, "***************************************************");

    String q2 =
        "select AirlineID, sum(Cancelled) from airlineStats group by AirlineID order by sum(Cancelled) desc limit 5";
    printStatus(Color.YELLOW, "Top 5 airlines in cancellation ");
    printStatus(Color.CYAN, "Query : " + q2);
    printStatus(Color.YELLOW, prettyPrintResponse(runner.runQuery(q2)));
    printStatus(Color.GREEN, "***************************************************");

    String q3 =
        "select AirlineID, Year, sum(Flights) from airlineStats where Year > 2010 group by AirlineID, Year order by "
            + "sum(Flights) desc limit 5";
    printStatus(Color.YELLOW, "Top 5 airlines in number of flights after 2010");
    printStatus(Color.CYAN, "Query : " + q3);
    printStatus(Color.YELLOW, prettyPrintResponse(runner.runQuery(q3)));
    printStatus(Color.GREEN, "***************************************************");

    String q4 =
        "select OriginCityName, max(Flights) from airlineStats group by OriginCityName order by max(Flights) desc "
            + "limit 5";
    printStatus(Color.YELLOW, "Top 5 cities for number of flights");
    printStatus(Color.CYAN, "Query : " + q4);
    printStatus(Color.YELLOW, prettyPrintResponse(runner.runQuery(q4)));
    printStatus(Color.GREEN, "***************************************************");

    String q5 = "select AirlineID, OriginCityName, DestCityName, Year from airlineStats order by Year limit 5";
    printStatus(Color.YELLOW, "Print AirlineID, OriginCityName, DestCityName, Year for 5 records ordered by Year");
    printStatus(Color.CYAN, "Query : " + q5);
    printStatus(Color.YELLOW, prettyPrintResponse(runner.runQuery(q5)));
    printStatus(Color.GREEN, "***************************************************");
```

### DuplicatedCode
Duplicated code
in `pinot-tools/src/main/java/org/apache/pinot/tools/HybridQuickstart.java`
#### Snippet
```java
    startKafka();
    startAllDataStreams(_kafkaStarter, quickstartTmpDir);

    printStatus(Color.CYAN, "***** Starting Zookeeper, controller, broker, server and minion *****");
    runner.startAll();
    Runtime.getRuntime().addShutdownHook(new Thread(() -> {
      try {
        printStatus(Color.GREEN, "***** Shutting down realtime quick start *****");
        runner.stop();
        FileUtils.deleteDirectory(quickstartTmpDir);
      } catch (Exception e) {
        e.printStackTrace();
      }
    }));

    printStatus(Color.CYAN, "***** Bootstrap all tables *****");
    runner.bootstrapTable();

    printStatus(Color.CYAN, "***** Waiting for 5 seconds for a few events to get populated *****");
    Thread.sleep(5000);

    printStatus(Color.YELLOW, "***** Realtime quickstart setup complete *****");
    runSampleQueries(runner);

    printStatus(Color.GREEN, "You can always go to http://localhost:9000 to play around in the query console");
```

### DuplicatedCode
Duplicated code
in `pinot-tools/src/main/java/org/apache/pinot/tools/PinotZKChanger.java`
#### Snippet
```java
    IdealState idealState = _helixAdmin.getResourceIdealState(_clusterName, tableName);
    ExternalView externalView = _helixAdmin.getResourceExternalView(_clusterName, tableName);
    Map<String, Map<String, String>> mapFieldsIS = idealState.getRecord().getMapFields();
    Map<String, Map<String, String>> mapFieldsEV = externalView.getRecord().getMapFields();
```

### DuplicatedCode
Duplicated code
in `pinot-tools/src/main/java/org/apache/pinot/tools/SegmentDumpTool.java`
#### Snippet
```java
    CommandLine commandLine = new CommandLine(tool);
    CommandLine.ParseResult result = commandLine.parseArgs(args);
    if (commandLine.isUsageHelpRequested() || result.matchedArgs().size() == 0) {
      commandLine.usage(System.out);
      return;
    }
    tool.execute();
```

### DuplicatedCode
Duplicated code
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AvroSchemaToPinotSchema.java`
#### Snippet
```java
    schema.setSchemaName(_pinotSchemaName);

    File outputDir = new File(_outputDir);
    if (!outputDir.isDirectory()) {
      LOGGER.error("ERROR: Output directory: {} does not exist or is not a directory", _outputDir);
      return false;
    }
    File outputFile = new File(outputDir, _pinotSchemaName + ".json");
    LOGGER.info("Store Pinot schema to file: {}", outputFile.getAbsolutePath());

    try (FileWriter writer = new FileWriter(outputFile)) {
      writer.write(schema.toPrettyJsonString());
    }

    return true;
```

### DuplicatedCode
Duplicated code
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AvroSchemaToPinotSchema.java`
#### Snippet
```java
    Map<String, FieldSpec.FieldType> fieldTypes = new HashMap<>();
    if (_dimensions != null) {
      for (String column : _dimensions.split("\\s*,\\s*")) {
        fieldTypes.put(column, FieldSpec.FieldType.DIMENSION);
      }
    }
    if (_metrics != null) {
      for (String column : _metrics.split("\\s*,\\s*")) {
        fieldTypes.put(column, FieldSpec.FieldType.METRIC);
      }
    }
    if (_timeColumnName != null) {
      fieldTypes.put(_timeColumnName, FieldSpec.FieldType.DATE_TIME);
    }
    return fieldTypes;
```

### DuplicatedCode
Duplicated code
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ShowClusterInfoCommand.java`
#### Snippet
```java
    Set<String> includeTableSet = new HashSet<>();
    String[] includeTables = _tables.split(",");
    for (String includeTable : includeTables) {
      String name = stripTypeFromName(includeTable.trim());
      if (name.length() > 0) {
        includeTableSet.add(name);
      }
    }
```

### DuplicatedCode
Duplicated code
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/filesystem/CopyFiles.java`
#### Snippet
```java
    try {
      super.initialPinotFS();
    } catch (Exception e) {
      System.err.println("Failed to initialize PinotFS, exception: " + e.getMessage());
      return false;
    }

    URI sourceURI = URI.create(_source);
    PinotFS sourcePinotFS = Utils.getPinotFS(sourceURI);

    URI destinationURI = URI.create(_destination);
    PinotFS destinationPinotFS = Utils.getPinotFS(destinationURI);
```

### DuplicatedCode
Duplicated code
in `pinot-tools/src/main/java/org/apache/pinot/tools/anonymizer/MapBasedGlobalDictionaries.java`
#### Snippet
```java
    Iterator<Map.Entry<Object, DerivedValue>> sortedIterator = sortedMap.entrySet().iterator();
    int i = 0;
    while (sortedIterator.hasNext()) {
      Map.Entry<Object, DerivedValue> entry = sortedIterator.next();
      DerivedValue derivedValue = entry.getValue();
      derivedValue._derivedValue = INT_BASE_VALUE + i++;
    }
```

### DuplicatedCode
Duplicated code
in `pinot-tools/src/main/java/org/apache/pinot/tools/anonymizer/MapBasedGlobalDictionaries.java`
#### Snippet
```java
    Arrays.sort(values);
    sortedIterator = sortedMap.entrySet().iterator();
    i = 0;
    while (sortedIterator.hasNext()) {
      Map.Entry<Object, DerivedValue> entry = sortedIterator.next();
      DerivedValue derivedValue = entry.getValue();
      derivedValue._derivedValue = values[i++];
    }
    return values;
```

### DuplicatedCode
Duplicated code
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/QueryRunner.java`
#### Snippet
```java
    PerfBenchmarkDriver driver = new PerfBenchmarkDriver(conf);
    Queue<String> queryQueue = new LinkedBlockingDeque<>(queueDepth);
    AtomicInteger numQueriesExecuted = new AtomicInteger(0);
    AtomicInteger numExceptions = new AtomicInteger(0);
    AtomicLong totalBrokerTime = new AtomicLong(0L);
    AtomicLong totalClientTime = new AtomicLong(0L);
    List<Statistics> statisticsList = Collections.singletonList(new Statistics(CLIENT_TIME_STATISTICS));

    ExecutorService executorService = Executors.newFixedThreadPool(numThreads);
    for (int i = 0; i < numThreads; i++) {
      executorService.submit(
          new Worker(driver, queryQueue, numQueriesExecuted, totalBrokerTime, totalClientTime, numExceptions,
              statisticsList, headers));
    }
    executorService.shutdown();

    final long startTimeAbsolute = System.currentTimeMillis();
```

### DuplicatedCode
Duplicated code
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/QueryRunner.java`
#### Snippet
```java
    while (!queryQueue.isEmpty()) {
      Thread.sleep(1);
    }
    executorService.shutdownNow();
    while (!executorService.isTerminated()) {
      Thread.sleep(1);
    }

    long timePassed = System.currentTimeMillis() - startTime;
    QuerySummary querySummary =
        new QuerySummary(timePassed, numQueriesExecuted.get(), numExceptions.get(), totalBrokerTime.get(),
            totalClientTime.get(), statisticsList);
    LOGGER.info("--------------------------------------------------------------------------------");
    LOGGER.info("FINAL REPORT:");
```

### DuplicatedCode
Duplicated code
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/QueryRunner.java`
#### Snippet
```java
        if (timeout > 0 && System.currentTimeMillis() - startTimeAbsolute > timeout) {
          LOGGER.info("Timeout of {} sec reached. Aborting", timeout);
          timeoutReached = true;
          break;
        }
        long nanoTime = System.nanoTime();
        while (nextQueryNanos > nanoTime - NANO_DELTA) {
          Thread.sleep(Math.max((int) ((nextQueryNanos - nanoTime) / 1E6), 1));
          nanoTime = System.nanoTime();
        }

        while (!queryQueue.offer(query)) {
          Thread.sleep(1);
        }

        nextQueryNanos += queryIntervalNanos;

        long currentTime = System.currentTimeMillis();
```

### DuplicatedCode
Duplicated code
in `pinot-tools/src/main/java/org/apache/pinot/tools/service/PinotServiceManager.java`
#### Snippet
```java
    if (!controllerConf.containsKey(CommonConstants.Helix.CONFIG_OF_CLUSTER_NAME)) {
      controllerConf.setProperty(CommonConstants.Helix.CONFIG_OF_CLUSTER_NAME, _clusterName);
    }
    if (!controllerConf.containsKey(CommonConstants.Helix.CONFIG_OF_ZOOKEEPR_SERVER)) {
      controllerConf.setProperty(CommonConstants.Helix.CONFIG_OF_ZOOKEEPR_SERVER, _zkAddress);
    }
    ServiceStartable controllerStarter = getServiceStartable(controllerStarterClassName);
    controllerStarter.init(controllerConf);
    controllerStarter.start();
    String instanceId = controllerStarter.getInstanceId();
    _runningInstanceMap.put(instanceId, controllerStarter);
```

### DuplicatedCode
Duplicated code
in `pinot-tools/src/main/java/org/apache/pinot/tools/streams/githubevents/PullRequestMergedEvent.java`
#### Snippet
```java
    Set<String> reviewers;
    if (_reviewCommentsArray != null && !_reviewCommentsArray.isEmpty()) {
      reviewers = new HashSet<>();
      for (JsonNode reviewComment : _reviewCommentsArray) {
        reviewers.add(reviewComment.get("user").get("login").asText());
      }
    } else {
      reviewers = Collections.emptySet();
    }
    return reviewers;
```

## RuleId[id=ProtectedMemberInFinalClass]
### ProtectedMemberInFinalClass
Class member declared `protected` in 'final' class
in `pinot-core/src/main/java/org/apache/pinot/core/util/OsCheck.java`
#### Snippet
```java

  // cached result of OS detection
  protected static final OSType _detectedOS;

  private OsCheck() {
```

### ProtectedMemberInFinalClass
Class member declared `protected` in 'final' class
in `pinot-minion/src/main/java/org/apache/pinot/minion/MinionAdminApiApplication.java`
#### Snippet
```java
    register(new AbstractBinder() {
      @Override
      protected void configure() {
        // TODO: Add bindings as needed in future.
        bind(instanceId).named(MINION_INSTANCE_ID);
```

### ProtectedMemberInFinalClass
Class member declared `protected` in 'final' class
in `pinot-controller/src/main/java/org/apache/pinot/controller/BaseControllerStarter.java`
#### Snippet
```java
    _adminApp.registerBinder(new AbstractBinder() {
      @Override
      protected void configure() {
        bind(_config).to(ControllerConf.class);
        bind(_helixParticipantInstanceId).named(CONTROLLER_INSTANCE_ID);
```

### ProtectedMemberInFinalClass
Class member declared `protected` in 'final' class
in `pinot-server/src/main/java/org/apache/pinot/server/api/AdminApiApplication.java`
#### Snippet
```java
    register(new AbstractBinder() {
      @Override
      protected void configure() {
        bind(_shutDownInProgress).to(AtomicBoolean.class);
        bind(_serverInstance).to(ServerInstance.class);
```

### ProtectedMemberInFinalClass
Class member declared `protected` in 'final' class
in `pinot-tools/src/main/java/org/apache/pinot/tools/service/PinotServiceManagerAdminApiApplication.java`
#### Snippet
```java
    register(new AbstractBinder() {
      @Override
      protected void configure() {
        bind(pinotServiceManager).to(PinotServiceManager.class);
      }
```

### ProtectedMemberInFinalClass
Class member declared `protected` in 'final' class
in `pinot-broker/src/main/java/org/apache/pinot/broker/broker/BrokerAdminApiApplication.java`
#### Snippet
```java
    register(new AbstractBinder() {
      @Override
      protected void configure() {
        bind(connMgr).to(HttpConnectionManager.class);
        bind(_executorService).to(Executor.class);
```

## RuleId[id=DanglingJavadoc]
### DanglingJavadoc
Dangling Javadoc comment
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/serde/ProtoSerializable.java`
#### Snippet
```java
 * under the License.
 */
/**
 * Autogenerated by Thrift Compiler (0.13.0)
 *
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/serde/ProtoProperties.java`
#### Snippet
```java
 * under the License.
 */
/**
 * Autogenerated by Thrift Compiler (0.13.0)
 *
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-spi/src/main/java/org/apache/pinot/spi/plugin/PluginClassLoader.java`
#### Snippet
```java
    _classLoader = PluginClassLoader.class.getClassLoader();

    /**
     * ClassLoader in java9+ does not extend URLClassLoader.
     * If the class is not found in the parent classloader,
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-plugins/pinot-stream-ingestion/pinot-kafka-2.0/src/main/java/org/apache/pinot/plugin/stream/kafka20/KafkaMessageBatch.java`
#### Snippet
```java

  @Override
  /**
   * Returns the metadata for the last filtered message if any, null otherwise.
   */
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-common/src/main/java/org/apache/pinot/common/utils/NamedThreadFactory.java`
#### Snippet
```java
package org.apache.pinot.common.utils;

/**
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-common/src/main/java/org/apache/pinot/common/request/QuerySource.java`
#### Snippet
```java
 * under the License.
 */
/**
 * Autogenerated by Thrift Compiler (0.15.0)
 *
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-common/src/main/java/org/apache/pinot/common/request/BrokerRequest.java`
#### Snippet
```java
 * under the License.
 */
/**
 * Autogenerated by Thrift Compiler (0.15.0)
 *
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-common/src/main/java/org/apache/pinot/common/request/Function.java`
#### Snippet
```java
 * under the License.
 */
/**
 * Autogenerated by Thrift Compiler (0.17.0)
 *
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-common/src/main/java/org/apache/pinot/common/request/DataSource.java`
#### Snippet
```java
 * under the License.
 */
/**
 * Autogenerated by Thrift Compiler (0.15.0)
 *
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-common/src/main/java/org/apache/pinot/common/request/ExpressionType.java`
#### Snippet
```java
 * under the License.
 */
/**
 * Autogenerated by Thrift Compiler (0.17.0)
 *
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-common/src/main/java/org/apache/pinot/common/request/JoinType.java`
#### Snippet
```java
 * under the License.
 */
/**
 * Autogenerated by Thrift Compiler (0.15.0)
 *
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-common/src/main/java/org/apache/pinot/common/request/Join.java`
#### Snippet
```java
 * under the License.
 */
/**
 * Autogenerated by Thrift Compiler (0.15.0)
 *
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-common/src/main/java/org/apache/pinot/common/request/Expression.java`
#### Snippet
```java
 * under the License.
 */
/**
 * Autogenerated by Thrift Compiler (0.17.0)
 *
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-common/src/main/java/org/apache/pinot/common/request/Identifier.java`
#### Snippet
```java
 * under the License.
 */
/**
 * Autogenerated by Thrift Compiler (0.17.0)
 *
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-common/src/main/java/org/apache/pinot/common/request/InstanceRequest.java`
#### Snippet
```java
 * under the License.
 */
/**
 * Autogenerated by Thrift Compiler (0.15.0)
 *
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-common/src/main/java/org/apache/pinot/common/request/Literal.java`
#### Snippet
```java
 * under the License.
 */
/**
 * Autogenerated by Thrift Compiler (0.17.0)
 *
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-common/src/main/java/org/apache/pinot/common/request/PinotQuery.java`
#### Snippet
```java
 * under the License.
 */
/**
 * Autogenerated by Thrift Compiler (0.17.0)
 *
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-common/src/main/java/org/apache/pinot/common/function/FunctionRegistry.java`
#### Snippet
```java
  private static final NameMultimap<Function> FUNCTION_MAP = new NameMultimap<>();

  /**
   * Registers the scalar functions via reflection.
   * NOTE: In order to plugin methods using reflection, the methods should be inside a class that includes ".function."
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/DateTimeFunctions.java`
#### Snippet
```java
  }

  /**
   * The {@code timezoneId} for the following methods must be of a Joda-Time format:
   * https://www.joda.org/joda-time/timezones.html
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-common/src/main/java/org/apache/pinot/common/response/ProcessingException.java`
#### Snippet
```java
 * under the License.
 */
/**
 * Autogenerated by Thrift Compiler (0.15.0)
 *
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-core/src/main/java/org/apache/pinot/core/common/BlockValSet.java`
#### Snippet
```java
  Dictionary getDictionary();

  /**
   * SINGLE-VALUED COLUMN APIs
   */
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-core/src/main/java/org/apache/pinot/core/common/BlockValSet.java`
#### Snippet
```java
  byte[][] getBytesValuesSV();

  /**
   * MULTI-VALUED COLUMN APIs
   */
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-core/src/main/java/org/apache/pinot/core/common/DataBlockCache.java`
#### Snippet
```java
  }

  /**
   * SINGLE-VALUED COLUMN API
   */
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-core/src/main/java/org/apache/pinot/core/common/DataBlockCache.java`
#### Snippet
```java
  }

  /**
   * MULTI-VALUED COLUMN API
   */
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-core/src/main/java/org/apache/pinot/core/common/DataFetcher.java`
#### Snippet
```java
  }

  /**
   * SINGLE-VALUED COLUMN API
   */
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-core/src/main/java/org/apache/pinot/core/common/DataFetcher.java`
#### Snippet
```java
  }

  /**
   * MULTI-VALUED COLUMN API
   */
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-core/src/main/java/org/apache/pinot/core/operator/filter/predicate/PredicateEvaluator.java`
#### Snippet
```java
public interface PredicateEvaluator {

  /**
   * APIs for both dictionary based and raw value based predicate evaluator
   */
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-core/src/main/java/org/apache/pinot/core/operator/filter/predicate/PredicateEvaluator.java`
#### Snippet
```java
  boolean applyMV(int[] values, int length);

  /**
   * APIs for dictionary based predicate evaluator
   */
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-core/src/main/java/org/apache/pinot/core/operator/filter/predicate/PredicateEvaluator.java`
#### Snippet
```java
  int[] getNonMatchingDictIds();

  /**
   * APIs for raw value based predicate evaluator.
   */
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-core/src/main/java/org/apache/pinot/core/operator/transform/function/PushDownTransformFunction.java`
#### Snippet
```java
public interface PushDownTransformFunction {

  /**
   * SINGLE-VALUED APIs
   */
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-core/src/main/java/org/apache/pinot/core/operator/transform/function/PushDownTransformFunction.java`
#### Snippet
```java
  void transformToStringValuesSV(ProjectionBlock projectionBlock, TransformEvaluator evaluator, String[] buffer);

  /**
   * MULTI-VALUED APIs
   */
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-core/src/main/java/org/apache/pinot/core/operator/transform/function/TransformFunction.java`
#### Snippet
```java
  TransformResultMetadata getResultMetadata();

  /**
   * DICTIONARY BASED APIs
   */
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-core/src/main/java/org/apache/pinot/core/operator/transform/function/TransformFunction.java`
#### Snippet
```java
  }

  /**
   * SINGLE-VALUED APIs
   */
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-core/src/main/java/org/apache/pinot/core/operator/transform/function/TransformFunction.java`
#### Snippet
```java
  }

  /**
   * MULTI-VALUED APIs
   */
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/PinotHelixSegmentOnlineOfflineStateModelGenerator.java`
#### Snippet
```java
    record.setListField(StateModelDefinitionProperty.STATE_PRIORITY_LIST.toString(), statePriorityList);

    /**
     *
     * If you are wondering what R and -1 signify, here is an explanation -1 means that don't even
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/PinotHelixBrokerResourceOnlineOfflineStateModelGenerator.java`
#### Snippet
```java
    record.setListField(StateModelDefinitionProperty.STATE_PRIORITY_LIST.toString(), statePriorityList);

    /**
     *
     * If you are wondering what R and -1 signify, here is an explanation -1 means that don't even
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/PinotHelixResourceManager.java`
#### Snippet
```java
  }

  /**
   * Instance related APIs
   */
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/PinotHelixResourceManager.java`
#### Snippet
```java
  }

  /**
   * Tenant related APIs
   */
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/PinotHelixResourceManager.java`
#### Snippet
```java
  // TODO: move tenant related APIs here

  /**
   * Resource related APIs
   */
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/PinotHelixResourceManager.java`
#### Snippet
```java
  }

  /**
   * Table related APIs
   */
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/PinotHelixResourceManager.java`
#### Snippet
```java
  // TODO: move table related APIs here

  /**
   * Segment related APIs
   */
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/rules/utils/QueryInvertedSortedIndexRecommender.java`
#### Snippet
```java
    // case: AND connected top level predicates.
    if (type == FilterContext.Type.AND) {
      /**** Run parsePredicateList on its children, and yielding PredicateParseResult p1, p2, p3 ..., pn ****/
      List<PredicateParseResult> childResults = new ArrayList<>();
      for (int i = 0; i < filterContextTopLevel.getChildren().size(); i++) {
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/rules/utils/QueryInvertedSortedIndexRecommender.java`
#### Snippet
```java
      }

      /**** Reorder the list and calculate the nESI WITHOUT any recommendation ****/
      // Also initiate a cache to fast calculate the all possible reordering of this AND predicate
      childResults = reorderAndPredicateList(childResults);
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/rules/utils/QueryInvertedSortedIndexRecommender.java`
#### Snippet
```java
          percentSelected);

      /**** chose the optimal PredicateParseResult(s) and pack them as exclusive candidates ****/
      List<Pair<Double, PredicateParseResult>> totalNESIWithIdxSorted = new LinkedList<>();

```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-tools/src/main/java/org/apache/pinot/tools/anonymizer/PinotDataAndQueryAnonymizer.java`
#### Snippet
```java
  }

  /*****************************************************
   *                                                   *
   *             QueryGenerator                        *
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/index/creator/ForwardIndexCreator.java`
#### Snippet
```java
  DataType getValueType();

  /**
   * DICTIONARY-ENCODED INDEX APIs
   */
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/index/creator/ForwardIndexCreator.java`
#### Snippet
```java
  }

  /**
   * SINGLE-VALUE COLUMN RAW INDEX APIs
   */
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/index/creator/ForwardIndexCreator.java`
#### Snippet
```java
  }

  /**
   * MULTI-VALUE COLUMN RAW INDEX APIs
   * TODO: Not supported yet
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/index/mutable/MutableForwardIndex.java`
#### Snippet
```java
  int getLengthOfLongestElement();

  /**
   * DICTIONARY-ENCODED INDEX APIs
   */
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/index/mutable/MutableForwardIndex.java`
#### Snippet
```java
  }

  /**
   * SINGLE-VALUE COLUMN RAW INDEX APIs
   */
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/index/mutable/MutableForwardIndex.java`
#### Snippet
```java
  }

  /**
   * MULTI-VALUE COLUMN RAW INDEX APIs
   * TODO: Not supported yet
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/index/reader/ForwardIndexReader.java`
#### Snippet
```java
  }

  /**
   * DICTIONARY-ENCODED INDEX APIs
   */
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/index/reader/ForwardIndexReader.java`
#### Snippet
```java
  }

  /**
   * SINGLE-VALUE COLUMN RAW INDEX APIs
   */
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/index/reader/ForwardIndexReader.java`
#### Snippet
```java
  }

  /**
   * MULTI-VALUE COLUMN RAW INDEX APIs
   */
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-query-runtime/src/main/java/org/apache/pinot/query/service/QueryConfig.java`
#### Snippet
```java
  public static final String KEY_OF_SERVER_RESPONSE_STATUS_OK = "OK";

  /**
   * Configuration keys for managing the scheduler
   */
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkThreadResourceUsageProvider.java`
#### Snippet
```java

@State(Scope.Benchmark)
/**
 * Hotspot:
 * Benchmark                                             Mode  Cnt   Score    Error  Units
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-plugins/pinot-file-system/pinot-gcs/src/main/java/org/apache/pinot/plugin/filesystem/GcsPinotFS.java`
#### Snippet
```java
      throw new IOException(String.format("Cannot copy from or to a subdirectory: '%s' -> '%s'", srcUri, dstUri));
    }
    /**
     * If an non-empty blob exists and does not end with "/"
     * gcs will create a 0 length blob ending with "/".
```

### DanglingJavadoc
Dangling Javadoc comment
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/loader/invertedindex/TextIndexHandler.java`
#### Snippet
```java
 * under the License.
 */
/**
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
```

## RuleId[id=SwitchStatementWithConfusingDeclaration]
### SwitchStatementWithConfusingDeclaration
Local variable `index` declared in one 'switch' branch and used in another
in `pinot-spi/src/main/java/org/apache/pinot/spi/data/Schema.java`
#### Snippet
```java
      switch (fieldType) {
        case DIMENSION:
          int index = _dimensionNames.indexOf(columnName);
          _dimensionNames.remove(index);
          _dimensionFieldSpecs.remove(index);
```

### SwitchStatementWithConfusingDeclaration
Local variable `innerFunction` declared in one 'switch' branch and used in another
in `pinot-common/src/main/java/org/apache/pinot/sql/parsers/rewriter/SelectionsRewriter.java`
#### Snippet
```java
          return;
        }
        Function innerFunction = operands.get(0).getFunctionCall();
        if (innerFunction != null && innerFunction.getOperator().equals("arraysum")) {
          Function sumMvFunc = new Function("summv");
```

### SwitchStatementWithConfusingDeclaration
Local variable `stringBuilder` declared in one 'switch' branch and used in another
in `pinot-common/src/main/java/org/apache/pinot/common/request/context/FilterContext.java`
#### Snippet
```java
    switch (_type) {
      case AND:
        StringBuilder stringBuilder = new StringBuilder().append('(').append(_children.get(0));
        int numChildren = _children.size();
        for (int i = 1; i < numChildren; i++) {
```

### SwitchStatementWithConfusingDeclaration
Local variable `numChildren` declared in one 'switch' branch and used in another
in `pinot-common/src/main/java/org/apache/pinot/common/request/context/FilterContext.java`
#### Snippet
```java
      case AND:
        StringBuilder stringBuilder = new StringBuilder().append('(').append(_children.get(0));
        int numChildren = _children.size();
        for (int i = 1; i < numChildren; i++) {
          stringBuilder.append(" AND ").append(_children.get(i));
```

### SwitchStatementWithConfusingDeclaration
Local variable `children` declared in one 'switch' branch and used in another
in `pinot-common/src/main/java/org/apache/pinot/common/request/context/RequestContextUtils.java`
#### Snippet
```java
    switch (filterKind) {
      case AND:
        List<FilterContext> children = new ArrayList<>(numOperands);
        for (ExpressionContext operand : operands) {
          children.add(getFilter(operand));
```

### SwitchStatementWithConfusingDeclaration
Local variable `values` declared in one 'switch' branch and used in another
in `pinot-common/src/main/java/org/apache/pinot/common/request/context/RequestContextUtils.java`
#### Snippet
```java
            new NotEqPredicate(operands.get(0), getStringValue(operands.get(1))));
      case IN:
        List<String> values = new ArrayList<>(numOperands - 1);
        for (int i = 1; i < numOperands; i++) {
          values.add(getStringValue(operands.get(i)));
```

### SwitchStatementWithConfusingDeclaration
Local variable `children` declared in one 'switch' branch and used in another
in `pinot-common/src/main/java/org/apache/pinot/common/request/context/RequestContextUtils.java`
#### Snippet
```java
    switch (filterKind) {
      case AND:
        List<FilterContext> children = new ArrayList<>(numOperands);
        for (Expression operand : operands) {
          children.add(getFilter(operand));
```

### SwitchStatementWithConfusingDeclaration
Local variable `values` declared in one 'switch' branch and used in another
in `pinot-common/src/main/java/org/apache/pinot/common/request/context/RequestContextUtils.java`
#### Snippet
```java
            new NotEqPredicate(getExpression(operands.get(0)), getStringValue(operands.get(1))));
      case IN:
        List<String> values = new ArrayList<>(numOperands - 1);
        for (int i = 1; i < numOperands; i++) {
          values.add(getStringValue(operands.get(i)));
```

### SwitchStatementWithConfusingDeclaration
Local variable `childFilters` declared in one 'switch' branch and used in another
in `pinot-core/src/main/java/org/apache/pinot/core/plan/FilterPlanNode.java`
#### Snippet
```java
    switch (filter.getType()) {
      case AND:
        List<FilterContext> childFilters = filter.getChildren();
        List<BaseFilterOperator> childFilterOperators = new ArrayList<>(childFilters.size());
        for (FilterContext childFilter : childFilters) {
```

### SwitchStatementWithConfusingDeclaration
Local variable `childFilterOperators` declared in one 'switch' branch and used in another
in `pinot-core/src/main/java/org/apache/pinot/core/plan/FilterPlanNode.java`
#### Snippet
```java
      case AND:
        List<FilterContext> childFilters = filter.getChildren();
        List<BaseFilterOperator> childFilterOperators = new ArrayList<>(childFilters.size());
        for (FilterContext childFilter : childFilters) {
          BaseFilterOperator childFilterOperator = constructPhysicalOperator(childFilter, numDocs);
```

### SwitchStatementWithConfusingDeclaration
Local variable `textIndexReader` declared in one 'switch' branch and used in another
in `pinot-core/src/main/java/org/apache/pinot/core/plan/FilterPlanNode.java`
#### Snippet
```java
          switch (predicate.getType()) {
            case TEXT_CONTAINS:
              TextIndexReader textIndexReader = dataSource.getTextIndex();
              if (!(textIndexReader instanceof NativeTextIndexReader)
                  && !(textIndexReader instanceof NativeMutableTextIndex)) {
```

### SwitchStatementWithConfusingDeclaration
Local variable `nullValueVector` declared in one 'switch' branch and used in another
in `pinot-core/src/main/java/org/apache/pinot/core/plan/FilterPlanNode.java`
#### Snippet
```java
              return new JsonMatchFilterOperator(jsonIndex, (JsonMatchPredicate) predicate, numDocs);
            case IS_NULL:
              NullValueVectorReader nullValueVector = dataSource.getNullValueVector();
              if (nullValueVector != null) {
                return new BitmapBasedFilterOperator(nullValueVector.getNullBitmap(), false, numDocs);
```

### SwitchStatementWithConfusingDeclaration
Local variable `children` declared in one 'switch' branch and used in another
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/DistinctCountThetaSketchAggregationFunction.java`
#### Snippet
```java
    switch (filter.getType()) {
      case AND:
        List<FilterContext> children = filter.getChildren();
        List<FilterEvaluator> childEvaluators = new ArrayList<>(children.size());
        for (FilterContext child : children) {
```

### SwitchStatementWithConfusingDeclaration
Local variable `childEvaluators` declared in one 'switch' branch and used in another
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/DistinctCountThetaSketchAggregationFunction.java`
#### Snippet
```java
      case AND:
        List<FilterContext> children = filter.getChildren();
        List<FilterEvaluator> childEvaluators = new ArrayList<>(children.size());
        for (FilterContext child : children) {
          childEvaluators.add(getFilterEvaluator(child, expressionIndexMap));
```

### SwitchStatementWithConfusingDeclaration
Local variable `length` declared in one 'switch' branch and used in another
in `pinot-core/src/main/java/org/apache/pinot/core/common/datablock/DataBlockBuilder.java`
#### Snippet
```java
          case BOOLEAN_ARRAY:
            boolean[] booleans = (boolean[]) value;
            int length = booleans.length;
            int[] ints = new int[length];
            ArrayCopyUtils.copy(booleans, ints, length);
```

### SwitchStatementWithConfusingDeclaration
Local variable `length` declared in one 'switch' branch and used in another
in `pinot-core/src/main/java/org/apache/pinot/core/operator/transform/function/CastTransformFunction.java`
#### Snippet
```java
      switch (_sourceDataType) {
        case BOOLEAN:
          int length = valueBlock.getNumDocs();
          initStringValuesSV(length);
          int[] intValues = _transformFunction.transformToIntValuesSV(valueBlock);
```

### SwitchStatementWithConfusingDeclaration
Local variable `intValues` declared in one 'switch' branch and used in another
in `pinot-core/src/main/java/org/apache/pinot/core/operator/transform/function/CastTransformFunction.java`
#### Snippet
```java
      switch (resultDataType) {
        case INT:
          int[] intValues = _transformFunction.transformToIntValuesSV(valueBlock);
          ArrayCopyUtils.copy(intValues, _stringValuesSV, length);
          break;
```

### SwitchStatementWithConfusingDeclaration
Local variable `longValues` declared in one 'switch' branch and used in another
in `pinot-core/src/main/java/org/apache/pinot/core/operator/transform/function/CastTransformFunction.java`
#### Snippet
```java
          break;
        case LONG:
          long[] longValues = _transformFunction.transformToLongValuesSV(valueBlock);
          ArrayCopyUtils.copy(longValues, _stringValuesSV, length);
          break;
```

### SwitchStatementWithConfusingDeclaration
Local variable `length` declared in one 'switch' branch and used in another
in `pinot-core/src/main/java/org/apache/pinot/core/operator/transform/function/CastTransformFunction.java`
#### Snippet
```java
      switch (_sourceDataType) {
        case BOOLEAN:
          int length = valueBlock.getNumDocs();
          initStringValuesMV(length);
          int[][] intValuesMV = _transformFunction.transformToIntValuesMV(valueBlock);
```

### SwitchStatementWithConfusingDeclaration
Local variable `intValuesMV` declared in one 'switch' branch and used in another
in `pinot-core/src/main/java/org/apache/pinot/core/operator/transform/function/CastTransformFunction.java`
#### Snippet
```java
      switch (resultDataType) {
        case INT:
          int[][] intValuesMV = _transformFunction.transformToIntValuesMV(valueBlock);
          ArrayCopyUtils.copy(intValuesMV, _stringValuesMV, length);
          break;
```

### SwitchStatementWithConfusingDeclaration
Local variable `longValuesMV` declared in one 'switch' branch and used in another
in `pinot-core/src/main/java/org/apache/pinot/core/operator/transform/function/CastTransformFunction.java`
#### Snippet
```java
          break;
        case LONG:
          long[][] longValuesMV = _transformFunction.transformToLongValuesMV(valueBlock);
          ArrayCopyUtils.copy(longValuesMV, _stringValuesMV, length);
          break;
```

### SwitchStatementWithConfusingDeclaration
Local variable `latest` declared in one 'switch' branch and used in another
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/rebalance/ZkBasedTableRebalanceObserver.java`
#### Snippet
```java
      // Write to Zk if there's change since previous stats computation
      case IDEAL_STATE_CHANGE_TRIGGER:
        TableRebalanceProgressStats.RebalanceStateStats latest =
            getDifferenceBetweenTableRebalanceStates(targetState, currentState);
        if (TableRebalanceProgressStats.statsDiffer(_tableRebalanceProgressStats.getCurrentToTargetConvergence(),
```

### SwitchStatementWithConfusingDeclaration
Local variable `newSizeOfEntry` declared in one 'switch' branch and used in another
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/loader/InvertedIndexAndDictionaryBasedForwardIndexCreator.java`
#### Snippet
```java
    switch (_storedType) {
      case STRING:
        int newSizeOfEntry = dictionary.getStringValue(dictId).length() + curSizeOfRow;
        putInt(_forwardIndexMaxSizeBuffer, docId, newSizeOfEntry);
        maxRowLengthInBytes[0] = Math.max(newSizeOfEntry, maxRowLengthInBytes[0]);
```

### SwitchStatementWithConfusingDeclaration
Local variable `numBytesPerValue` declared in one 'switch' branch and used in another
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/dictionary/DictionaryIndexType.java`
#### Snippet
```java
            : new DoubleDictionary(dataBuffer, length);
      case BIG_DECIMAL:
        int numBytesPerValue = metadata.getColumnMaxLength();
        return loadOnHeap ? new OnHeapBigDecimalDictionary(dataBuffer, length, numBytesPerValue)
            : new BigDecimalDictionary(dataBuffer, length, numBytesPerValue);
```

### SwitchStatementWithConfusingDeclaration
Local variable `numValues` declared in one 'switch' branch and used in another
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/creator/impl/SegmentDictionaryCreator.java`
#### Snippet
```java
      case INT:
        int[] sortedInts = (int[]) sortedValues;
        int numValues = sortedInts.length;
        Preconditions.checkState(numValues > 0);
        _intValueToIndexMap = new Int2IntOpenHashMap(numValues);
```

### SwitchStatementWithConfusingDeclaration
Local variable `columnMetadata` declared in one 'switch' branch and used in another
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/startree/v2/builder/StarTreeV2BuilderConfig.java`
#### Snippet
```java
      switch (fieldSpec.getFieldType()) {
        case DIMENSION:
          ColumnMetadata columnMetadata = segmentMetadata.getColumnMetadataFor(column);
          if (columnMetadata.hasDictionary()
              && columnMetadata.getCardinality() <= DIMENSION_CARDINALITY_THRESHOLD_FOR_DEFAULT_CONFIG) {
```

### SwitchStatementWithConfusingDeclaration
Local variable `longColumnVector` declared in one 'switch' branch and used in another
in `pinot-plugins/pinot-input-format/pinot-orc/src/main/java/org/apache/pinot/plugin/inputformat/orc/ORCRecordReader.java`
#### Snippet
```java
      case BOOLEAN:
        // Extract to String
        LongColumnVector longColumnVector = (LongColumnVector) columnVector;
        if (longColumnVector.noNulls || !longColumnVector.isNull[rowId]) {
          return Boolean.toString(longColumnVector.vector[rowId] == 1);
```

### SwitchStatementWithConfusingDeclaration
Local variable `doubleColumnVector` declared in one 'switch' branch and used in another
in `pinot-plugins/pinot-input-format/pinot-orc/src/main/java/org/apache/pinot/plugin/inputformat/orc/ORCRecordReader.java`
#### Snippet
```java
      case FLOAT:
        // Extract to Float
        DoubleColumnVector doubleColumnVector = (DoubleColumnVector) columnVector;
        if (doubleColumnVector.noNulls || !doubleColumnVector.isNull[rowId]) {
          return (float) doubleColumnVector.vector[rowId];
```

### SwitchStatementWithConfusingDeclaration
Local variable `bytesColumnVector` declared in one 'switch' branch and used in another
in `pinot-plugins/pinot-input-format/pinot-orc/src/main/java/org/apache/pinot/plugin/inputformat/orc/ORCRecordReader.java`
#### Snippet
```java
      case CHAR:
        // Extract to String
        BytesColumnVector bytesColumnVector = (BytesColumnVector) columnVector;
        if (bytesColumnVector.noNulls || !bytesColumnVector.isNull[rowId]) {
          int length = bytesColumnVector.length[rowId];
```

### SwitchStatementWithConfusingDeclaration
Local variable `values` declared in one 'switch' branch and used in another
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/indexsegment/mutable/MutableSegmentImpl.java`
#### Snippet
```java
          switch (dataType.getStoredType()) {
            case INT:
              Object[] values = (Object[]) value;
              int[] intValues = new int[values.length];
              for (int i = 0; i < values.length; i++) {
```

## RuleId[id=TrivialIf]
### TrivialIf
`if` statement can be simplified
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/TableConfigsRestletResource.java`
#### Snippet
```java
    try {
      boolean tableExists = false;
      if (_pinotHelixResourceManager.hasRealtimeTable(tableName) || _pinotHelixResourceManager
          .hasOfflineTable(tableName)) {
        tableExists = true;
```

### TrivialIf
`if` statement can be simplified
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/lineage/DefaultLineageManager.java`
#### Snippet
```java
    // data rollback for APPEND tables, we should remove this check.
    String batchSegmentIngestionType = IngestionConfigUtils.getBatchSegmentIngestionType(tableConfig);
    if (!batchSegmentIngestionType.equalsIgnoreCase("REFRESH")
        || lineageEntry.getTimestamp() < System.currentTimeMillis() - REPLACED_SEGMENTS_RETENTION_IN_MILLIS) {
      return true;
```

### TrivialIf
`if` statement can be simplified
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/rebalance/TableRebalanceProgressStats.java`
#### Snippet
```java

  public static boolean statsDiffer(RebalanceStateStats base, RebalanceStateStats compare) {
    if (base._replicasToRebalance != compare._replicasToRebalance
        || base._segmentsToRebalance != compare._segmentsToRebalance
        || base._segmentsMissing != compare._segmentsMissing
```

### TrivialIf
`if` statement can be simplified
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StopProcessCommand.java`
#### Snippet
```java
        @Override
        public boolean accept(File dir, String name) {
          if (StringUtils.containsIgnoreCase(name, "pinotAdminServer")) {
            return true;
          }
```

### TrivialIf
`if` statement can be simplified
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StopProcessCommand.java`
#### Snippet
```java
        @Override
        public boolean accept(File dir, String name) {
          if (StringUtils.containsIgnoreCase(name, "pinotAdminController")) {
            return true;
          }
```

### TrivialIf
`if` statement can be simplified
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StopProcessCommand.java`
#### Snippet
```java
        @Override
        public boolean accept(File dir, String name) {
          if (StringUtils.containsIgnoreCase(name, "pinotAdminBroker")) {
            return true;
          }
```

### TrivialIf
`if` statement can be simplified
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/automaton/RegExp.java`
#### Snippet
```java
    if (match('[')) {
      boolean negate = false;
      if (match('^')) {
        negate = true;
      }
```

### TrivialIf
`if` statement can be simplified
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/dictionary/DictionaryIndexType.java`
#### Snippet
```java

    double indexSizeRatio = indexWithoutDictSize / indexWithDictSize;
    if (indexSizeRatio <= noDictionarySizeRatioThreshold) {
      return false;
    }
```

### TrivialIf
`if` statement can be simplified
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/customobject/QuantileDigest.java`
#### Snippet
```java
        return false;
      }
      if (Double.compare(bucket._mean, _mean) != 0) {
        return false;
      }
```

## RuleId[id=OptionalUsedAsFieldOrParameterType]
### OptionalUsedAsFieldOrParameterType
`OptionalInt` used as type for parameter 'firstDoc'
in `pinot-core/src/main/java/org/apache/pinot/core/operator/dociditerators/ScanBasedDocIdIterator.java`
#### Snippet
```java
public interface ScanBasedDocIdIterator extends BlockDocIdIterator {

  MutableRoaringBitmap applyAnd(BatchIterator batchIterator, OptionalInt firstDoc, OptionalInt lastDoc);

  /**
```

### OptionalUsedAsFieldOrParameterType
`OptionalInt` used as type for parameter 'lastDoc'
in `pinot-core/src/main/java/org/apache/pinot/core/operator/dociditerators/ScanBasedDocIdIterator.java`
#### Snippet
```java
public interface ScanBasedDocIdIterator extends BlockDocIdIterator {

  MutableRoaringBitmap applyAnd(BatchIterator batchIterator, OptionalInt firstDoc, OptionalInt lastDoc);

  /**
```

## RuleId[id=CharsetObjectCanBeUsed]
### CharsetObjectCanBeUsed
StandardCharsets.UTF_8 can be used instead
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-hadoop/src/main/java/org/apache/pinot/plugin/ingestion/batch/hadoop/HadoopSegmentCreationMapper.java`
#### Snippet
```java
      // Tar segment directory to compress file
      File localSegmentDir = new File(localOutputTempDir, segmentName);
      String segmentTarFileName = URLEncoder.encode(segmentName + Constants.TAR_GZ_FILE_EXT, "UTF-8");
      File localSegmentTarFile = new File(localOutputTempDir, segmentTarFileName);
      LOGGER.info("Tarring segment from: {} to: {}", localSegmentDir, localSegmentTarFile);
```

### CharsetObjectCanBeUsed
StandardCharsets.UTF_8 can be used instead
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-hadoop/src/main/java/org/apache/pinot/plugin/ingestion/batch/hadoop/HadoopSegmentCreationMapper.java`
#### Snippet
```java

      // Create and upload segment metadata tar file
      String metadataTarFileName = URLEncoder.encode(segmentName + Constants.METADATA_TAR_GZ_FILE_EXT, "UTF-8");
      URI outputMetadataTarURI = relativeOutputPath.resolve(metadataTarFileName);
      if (outputDirFS.exists(outputMetadataTarURI) && (_spec.isOverwriteOutput() || !_spec.isCreateMetadataTarGz())) {
```

### CharsetObjectCanBeUsed
StandardCharsets.UTF_8 can be used instead
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-spark-3.2/src/main/java/org/apache/pinot/plugin/ingestion/batch/spark3/SparkSegmentGenerationJobRunner.java`
#### Snippet
```java
          // Tar segment directory to compress file
          File localSegmentDir = new File(localOutputTempDir, segmentName);
          String segmentTarFileName = URLEncoder.encode(segmentName + Constants.TAR_GZ_FILE_EXT, "UTF-8");
          File localSegmentTarFile = new File(localOutputTempDir, segmentTarFileName);
          LOGGER.info("Tarring segment from: {} to: {}", localSegmentDir, localSegmentTarFile);
```

### CharsetObjectCanBeUsed
StandardCharsets.UTF_8 can be used instead
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-spark-3.2/src/main/java/org/apache/pinot/plugin/ingestion/batch/spark3/SparkSegmentGenerationJobRunner.java`
#### Snippet
```java

          // Create and upload segment metadata tar file
          String metadataTarFileName = URLEncoder.encode(segmentName + Constants.METADATA_TAR_GZ_FILE_EXT, "UTF-8");
          URI outputMetadataTarURI = relativeOutputPath.resolve(metadataTarFileName);
          if (finalOutputDirFS.exists(outputMetadataTarURI) && (_spec.isOverwriteOutput()
```

### CharsetObjectCanBeUsed
StandardCharsets.UTF_8 can be used instead
in `pinot-spi/src/main/java/org/apache/pinot/spi/utils/builder/ControllerRequestURLBuilder.java`
#### Snippet
```java
  private static String encode(String s) {
    try {
      return URLEncoder.encode(s, "UTF-8");
    } catch (Exception e) {
      // Should never happen
```

### CharsetObjectCanBeUsed
StandardCharsets.UTF_8 can be used instead
in `pinot-spi/src/main/java/org/apache/pinot/spi/utils/builder/ControllerRequestURLBuilder.java`
#### Snippet
```java
    return String.format("%s?tableNameWithType=%s&batchConfigMapStr=%s&sourceURIStr=%s",
        StringUtil.join("/", _baseUrl, "ingestFromURI"), tableNameWithType,
        URLEncoder.encode(batchConfigMapStr, StandardCharsets.UTF_8.toString()),
        URLEncoder.encode(sourceURIStr, StandardCharsets.UTF_8.toString()));
  }
```

### CharsetObjectCanBeUsed
StandardCharsets.UTF_8 can be used instead
in `pinot-spi/src/main/java/org/apache/pinot/spi/utils/builder/ControllerRequestURLBuilder.java`
#### Snippet
```java
        StringUtil.join("/", _baseUrl, "ingestFromURI"), tableNameWithType,
        URLEncoder.encode(batchConfigMapStr, StandardCharsets.UTF_8.toString()),
        URLEncoder.encode(sourceURIStr, StandardCharsets.UTF_8.toString()));
  }

```

### CharsetObjectCanBeUsed
StandardCharsets.UTF_8 can be used instead
in `pinot-spi/src/main/java/org/apache/pinot/spi/utils/builder/ControllerRequestURLBuilder.java`
#### Snippet
```java
    return String.format("%s?tableNameWithType=%s&batchConfigMapStr=%s",
        StringUtil.join("/", _baseUrl, "ingestFromFile"), tableNameWithType,
        URLEncoder.encode(batchConfigMapStr, StandardCharsets.UTF_8.toString()));
  }

```

### CharsetObjectCanBeUsed
StandardCharsets.UTF_8 can be used instead
in `pinot-spi/src/main/java/org/apache/pinot/spi/filesystem/LocalPinotFS.java`
#### Snippet
```java
    //       Do not use uri.getPath() because it does not decode '+' to ' '
    try {
      return new File(URLDecoder.decode(uri.getRawPath(), "UTF-8"));
    } catch (UnsupportedEncodingException e) {
      throw new RuntimeException(e);
```

### CharsetObjectCanBeUsed
StandardCharsets.UTF_8 can be used instead
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-standalone/src/main/java/org/apache/pinot/plugin/ingestion/batch/standalone/SegmentGenerationJobRunner.java`
#### Snippet
```java
        // Tar segment directory to compress file
        localSegmentDir = new File(localOutputTempDir, segmentName);
        String segmentTarFileName = URLEncoder.encode(segmentName + Constants.TAR_GZ_FILE_EXT, "UTF-8");
        localSegmentTarFile = new File(localOutputTempDir, segmentTarFileName);
        LOGGER.info("Tarring segment from: {} to: {}", localSegmentDir, localSegmentTarFile);
```

### CharsetObjectCanBeUsed
StandardCharsets.UTF_8 can be used instead
in `pinot-plugins/pinot-file-system/pinot-adls/src/main/java/org/apache/pinot/plugin/filesystem/AzurePinotFSUtil.java`
#### Snippet
```java
      throws IOException {
    // Pinot side code uses `URLEncoder` when building uri
    String path = URLDecoder.decode(uri.getRawPath(), "UTF-8");
    if (path.startsWith(DIRECTORY_DELIMITER)) {
      path = path.substring(1);
```

### CharsetObjectCanBeUsed
StandardCharsets.UTF_8 can be used instead
in `pinot-common/src/main/java/org/apache/pinot/common/utils/URIUtils.java`
#### Snippet
```java
  public static String decode(String string) {
    try {
      return URLDecoder.decode(string, "UTF-8");
    } catch (Exception e) {
      // Should never happen
```

### CharsetObjectCanBeUsed
StandardCharsets.UTF_8 can be used instead
in `pinot-common/src/main/java/org/apache/pinot/common/utils/URIUtils.java`
#### Snippet
```java
  public static String encode(String string) {
    try {
      return URLEncoder.encode(string, "UTF-8");
    } catch (Exception e) {
      // Should never happen
```

### CharsetObjectCanBeUsed
StandardCharsets.UTF_8 can be used instead
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
  public static String decodeUrl(String input)
      throws UnsupportedEncodingException {
    return URLDecoder.decode(input, StandardCharsets.UTF_8.toString());
  }

```

### CharsetObjectCanBeUsed
StandardCharsets.UTF_8 can be used instead
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
  public static String encodeUrl(String input)
      throws UnsupportedEncodingException {
    return URLEncoder.encode(input, StandardCharsets.UTF_8.toString());
  }

```

### CharsetObjectCanBeUsed
StandardCharsets.UTF_8 can be used instead
in `pinot-controller/src/main/java/org/apache/pinot/controller/util/AutoAddInvertedIndex.java`
#### Snippet
```java
    httpURLConnection.setRequestMethod("PUT");

    BufferedWriter writer = new BufferedWriter(new OutputStreamWriter(httpURLConnection.getOutputStream(), "UTF-8"));
    writer.write(tableConfig.toJsonString());
    writer.flush();
```

### CharsetObjectCanBeUsed
StandardCharsets.UTF_8 can be used instead
in `pinot-controller/src/main/java/org/apache/pinot/controller/util/AutoAddInvertedIndex.java`
#### Snippet
```java
    writer.flush();

    BufferedReader reader = new BufferedReader(new InputStreamReader(httpURLConnection.getInputStream(), "UTF-8"));
    return reader.readLine().equals("done");
  }
```

### CharsetObjectCanBeUsed
StandardCharsets.UTF_8 can be used instead
in `pinot-controller/src/main/java/org/apache/pinot/controller/util/AutoAddInvertedIndex.java`
#### Snippet
```java
    urlConnection.setDoOutput(true);

    BufferedWriter writer = new BufferedWriter(new OutputStreamWriter(urlConnection.getOutputStream(), "UTF-8"));
    writer.write(JsonUtils.newObjectNode().put("sql", query).toString());
    writer.flush();
```

### CharsetObjectCanBeUsed
StandardCharsets.UTF_8 can be used instead
in `pinot-controller/src/main/java/org/apache/pinot/controller/util/AutoAddInvertedIndex.java`
#### Snippet
```java
    writer.flush();

    BufferedReader reader = new BufferedReader(new InputStreamReader(urlConnection.getInputStream(), "UTF-8"));
    return JsonUtils.stringToJsonNode(reader.readLine());
  }
```

### CharsetObjectCanBeUsed
StandardCharsets.UTF_8 can be used instead
in `pinot-controller/src/main/java/org/apache/pinot/controller/util/ServerSegmentMetadataReader.java`
#### Snippet
```java
      String endpoint) {
    try {
      tableNameWithType = URLEncoder.encode(tableNameWithType, StandardCharsets.UTF_8.name());
      segmentName = URLEncoder.encode(segmentName, StandardCharsets.UTF_8.name());
      String paramsStr = generateColumnsParam(columns);
```

### CharsetObjectCanBeUsed
StandardCharsets.UTF_8 can be used instead
in `pinot-controller/src/main/java/org/apache/pinot/controller/util/ServerSegmentMetadataReader.java`
#### Snippet
```java
    try {
      tableNameWithType = URLEncoder.encode(tableNameWithType, StandardCharsets.UTF_8.name());
      segmentName = URLEncoder.encode(segmentName, StandardCharsets.UTF_8.name());
      String paramsStr = generateColumnsParam(columns);
      return String.format("%s/tables/%s/segments/%s/metadata?%s", endpoint, tableNameWithType, segmentName, paramsStr);
```

### CharsetObjectCanBeUsed
StandardCharsets.UTF_8 can be used instead
in `pinot-controller/src/main/java/org/apache/pinot/controller/util/ServerSegmentMetadataReader.java`
#### Snippet
```java
      String endpoint) {
    try {
      tableNameWithType = URLEncoder.encode(tableNameWithType, StandardCharsets.UTF_8.name());
      String paramsStr = generateColumnsParam(columns);
      return String.format("%s/tables/%s/metadata?%s", endpoint, tableNameWithType, paramsStr);
```

### CharsetObjectCanBeUsed
StandardCharsets.UTF_8 can be used instead
in `pinot-server/src/main/java/org/apache/pinot/server/api/resources/TablesResource.java`
#### Snippet
```java
    for (int i = 0; i < columns.size(); i++) {
      try {
        columns.set(i, URLDecoder.decode(columns.get(i), StandardCharsets.UTF_8.name()));
      } catch (UnsupportedEncodingException e) {
        throw new RuntimeException(e.getCause());
```

### CharsetObjectCanBeUsed
StandardCharsets.UTF_8 can be used instead
in `pinot-server/src/main/java/org/apache/pinot/server/api/resources/TablesResource.java`
#### Snippet
```java
    TableDataManager tableDataManager = ServerResourceUtils.checkGetTableDataManager(_serverInstance, tableName);
    try {
      segmentName = URLDecoder.decode(segmentName, StandardCharsets.UTF_8.name());
    } catch (UnsupportedEncodingException e) {
      throw new RuntimeException(e.getCause());
```

### CharsetObjectCanBeUsed
StandardCharsets.UTF_8 can be used instead
in `pinot-server/src/main/java/org/apache/pinot/server/api/resources/TablesResource.java`
#### Snippet
```java
    for (String column : columns) {
      try {
        decodedColumns.add(URLDecoder.decode(column, StandardCharsets.UTF_8.name()));
      } catch (UnsupportedEncodingException e) {
        throw new RuntimeException(e.getCause());
```

### CharsetObjectCanBeUsed
StandardCharsets.UTF_8 can be used instead
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AbstractBaseAdminCommand.java`
#### Snippet
```java
  private static String readInputStream(InputStream inputStream)
      throws IOException {
    final BufferedReader reader = new BufferedReader(new InputStreamReader(inputStream, "UTF-8"));
    final StringBuilder sb = new StringBuilder();
    String line;
```

### CharsetObjectCanBeUsed
StandardCharsets.UTF_8 can be used instead
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StreamAvroIntoKafkaCommand.java`
#### Snippet
```java
          default:
            String recordJson = genericRecord.toString();
            bytes = recordJson.getBytes("utf-8");
            break;
        }
```

### CharsetObjectCanBeUsed
StandardCharsets.UTF_8 can be used instead
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-spark-2.4/src/main/java/org/apache/pinot/plugin/ingestion/batch/spark/SparkSegmentGenerationJobRunner.java`
#### Snippet
```java
          // Tar segment directory to compress file
          File localSegmentDir = new File(localOutputTempDir, segmentName);
          String segmentTarFileName = URLEncoder.encode(segmentName + Constants.TAR_GZ_FILE_EXT, "UTF-8");
          File localSegmentTarFile = new File(localOutputTempDir, segmentTarFileName);
          LOGGER.info("Tarring segment from: {} to: {}", localSegmentDir, localSegmentTarFile);
```

### CharsetObjectCanBeUsed
StandardCharsets.UTF_8 can be used instead
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-spark-2.4/src/main/java/org/apache/pinot/plugin/ingestion/batch/spark/SparkSegmentGenerationJobRunner.java`
#### Snippet
```java

          // Create and upload segment metadata tar file
          String metadataTarFileName = URLEncoder.encode(segmentName + Constants.METADATA_TAR_GZ_FILE_EXT, "UTF-8");
          URI outputMetadataTarURI = relativeOutputPath.resolve(metadataTarFileName);

```

### CharsetObjectCanBeUsed
StandardCharsets.UTF_8 can be used instead
in `pinot-plugins/pinot-file-system/pinot-s3/src/main/java/org/apache/pinot/plugin/filesystem/S3PinotFS.java`
#### Snippet
```java
      String encodedUrl = null;
      try {
        encodedUrl = URLEncoder.encode(uri.getHost() + uri.getPath(), StandardCharsets.UTF_8.toString());
      } catch (UnsupportedEncodingException e) {
        throw new RuntimeException(e);
```

### CharsetObjectCanBeUsed
StandardCharsets.UTF_8 can be used instead
in `pinot-plugins/pinot-file-system/pinot-s3/src/main/java/org/apache/pinot/plugin/filesystem/S3PinotFS.java`
#### Snippet
```java
      String encodedUrl = null;
      try {
        encodedUrl = URLEncoder.encode(srcUri.getHost() + srcUri.getPath(), StandardCharsets.UTF_8.toString());
      } catch (UnsupportedEncodingException e) {
        throw new RuntimeException(e);
```

### CharsetObjectCanBeUsed
StandardCharsets.UTF_8 can be used instead
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/SegmentPushUtils.java`
#### Snippet
```java
      if (fileSystem instanceof LocalPinotFS) {
        // For local file system, we don't need to copy the tar file.
        tarFile = new File(URLDecoder.decode(tarFileURI.getRawPath(), "UTF-8"));
      } else {
        // For other file systems, we need to download the file to local file system
```

## RuleId[id=ReplaceAllDot]
### ReplaceAllDot
Suspicious regex expression "." in call to 'split()'
in `pinot-clients/pinot-jdbc-client/src/main/java/org/apache/pinot/client/PinotConnectionMetaData.java`
#### Snippet
```java
  @Override
  public int getDriverMinorVersion() {
    return Integer.parseInt(DRIVER_VERSION.split(".")[1]);
  }

```

### ReplaceAllDot
Suspicious regex expression "." in call to 'split()'
in `pinot-clients/pinot-jdbc-client/src/main/java/org/apache/pinot/client/PinotConnectionMetaData.java`
#### Snippet
```java
  @Override
  public int getDriverMajorVersion() {
    return Integer.parseInt(DRIVER_VERSION.split(".")[0]);
  }

```

## RuleId[id=ImplicitArrayToString]
### ImplicitArrayToString
Implicit call to 'toString()' on array returned by call to `literal.getBinaryValue()`
in `pinot-core/src/main/java/org/apache/pinot/core/query/optimizer/statement/JsonStatementOptimizer.java`
#### Snippet
```java
    switch (literal.getSetField()) {
      case BOOL_VALUE:
        result.append(String.valueOf(literal.getBinaryValue()));
        break;
      case BYTE_VALUE:
```

### ImplicitArrayToString
Implicit call to 'toString()' on array returned by call to `literal.getBinaryValue()`
in `pinot-core/src/main/java/org/apache/pinot/core/query/optimizer/statement/JsonStatementOptimizer.java`
#### Snippet
```java
      case BINARY_VALUE:
        result.append(
            aliasing ? String.valueOf(literal.getBinaryValue()) : "'" + String.valueOf(literal.getBinaryValue()) + "'");
        break;
      default:
```

### ImplicitArrayToString
Implicit call to 'toString()' on array returned by call to `literal.getBinaryValue()`
in `pinot-core/src/main/java/org/apache/pinot/core/query/optimizer/statement/JsonStatementOptimizer.java`
#### Snippet
```java
      case BINARY_VALUE:
        result.append(
            aliasing ? String.valueOf(literal.getBinaryValue()) : "'" + String.valueOf(literal.getBinaryValue()) + "'");
        break;
      default:
```

## RuleId[id=AutoCloseableResource]
### AutoCloseableResource
'PinotFS' used without 'try'-with-resources statement
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-hadoop/src/main/java/org/apache/pinot/plugin/ingestion/batch/hadoop/HadoopSegmentUriPushJobRunner.java`
#### Snippet
```java
      throw new RuntimeException("outputDirURI is not valid - '" + _spec.getOutputDirURI() + "'");
    }
    PinotFS outputDirFS = PinotFSFactory.create(outputDirURI.getScheme());

    //Get list of files to process
```

### AutoCloseableResource
'PinotFS' used without 'try'-with-resources statement
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-hadoop/src/main/java/org/apache/pinot/plugin/ingestion/batch/hadoop/HadoopSegmentMetadataPushJobRunner.java`
#### Snippet
```java
      throw new RuntimeException("outputDirURI is not valid - '" + _spec.getOutputDirURI() + "'");
    }
    PinotFS outputDirFS = PinotFSFactory.create(outputDirURI.getScheme());
    //Get list of files to process
    String[] files;
```

### AutoCloseableResource
'PinotFS' used without 'try'-with-resources statement
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-hadoop/src/main/java/org/apache/pinot/plugin/ingestion/batch/hadoop/HadoopSegmentCreationMapper.java`
#### Snippet
```java
        outputDirURI = new File(_spec.getOutputDirURI()).toURI();
      }
      PinotFS outputDirFS = PinotFSFactory.create(outputDirURI.getScheme());

      URI inputFileURI = URI.create(path);
```

### AutoCloseableResource
'PinotFS' used without 'try'-with-resources statement
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-hadoop/src/main/java/org/apache/pinot/plugin/ingestion/batch/hadoop/HadoopSegmentCreationMapper.java`
#### Snippet
```java
      //copy input path to local
      File localInputDataFile = new File(localInputTempDir, getFileName(inputFileURI));
      PinotFSFactory.create(inputFileURI.getScheme()).copyToLocalFile(inputFileURI, localInputDataFile);

      //create task spec
```

### AutoCloseableResource
'PinotFS' used without 'try'-with-resources statement
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-spark-3.2/src/main/java/org/apache/pinot/plugin/ingestion/batch/spark3/SparkSegmentUriPushJobRunner.java`
#### Snippet
```java
      throw new RuntimeException("outputDirURI is not valid - '" + _spec.getOutputDirURI() + "'");
    }
    PinotFS outputDirFS = PinotFSFactory.create(outputDirURI.getScheme());

    //Get list of files to process
```

### AutoCloseableResource
'PinotFS' used without 'try'-with-resources statement
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-spark-3.2/src/main/java/org/apache/pinot/plugin/ingestion/batch/spark3/SparkSegmentGenerationJobRunner.java`
#### Snippet
```java
      outputDirURI = new File(_spec.getOutputDirURI()).toURI();
    }
    PinotFS outputDirFS = PinotFSFactory.create(outputDirURI.getScheme());
    outputDirFS.mkdir(outputDirURI);

```

### AutoCloseableResource
'PinotFS' used without 'try'-with-resources statement
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-spark-3.2/src/main/java/org/apache/pinot/plugin/ingestion/batch/spark3/SparkSegmentGenerationJobRunner.java`
#### Snippet
```java
        depsJarDirURI = new File(depsJarDir).toURI();
      }
      PinotFS pinotFS = PinotFSFactory.create(depsJarDirURI.getScheme());
      String[] files = pinotFS.listFiles(depsJarDirURI, true);
      for (String file : files) {
```

### AutoCloseableResource
'PinotFS' used without 'try'-with-resources statement
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-spark-3.2/src/main/java/org/apache/pinot/plugin/ingestion/batch/spark3/SparkSegmentGenerationJobRunner.java`
#### Snippet
```java
                .register(pinotFSSpec.getScheme(), pinotFSSpec.getClassName(), new PinotConfiguration(pinotFSSpec));
          }
          PinotFS finalOutputDirFS = PinotFSFactory.create(finalOutputDirURI.getScheme());
          String[] splits = pathAndIdx.split(" ");
          String path = splits[0];
```

### AutoCloseableResource
'PinotFS' used without 'try'-with-resources statement
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-spark-3.2/src/main/java/org/apache/pinot/plugin/ingestion/batch/spark3/SparkSegmentGenerationJobRunner.java`
#### Snippet
```java
          File localInputDataFile = new File(localInputTempDir, getFileName(inputFileURI));
          LOGGER.info("Trying to copy input file from {} to {}", inputFileURI, localInputDataFile);
          PinotFSFactory.create(inputFileURI.getScheme()).copyToLocalFile(inputFileURI, localInputDataFile);

          //create task spec
```

### AutoCloseableResource
'DatagramSocket' used without 'try'-with-resources statement
in `pinot-spi/src/main/java/org/apache/pinot/spi/utils/NetUtils.java`
#### Snippet
```java
  public static String getHostAddress()
      throws SocketException, UnknownHostException {
    DatagramSocket ds = new DatagramSocket();
    ds.connect(InetAddress.getByName(DUMMY_OUT_IP), 80);
    InetAddress localAddress = ds.getLocalAddress();
```

### AutoCloseableResource
'Stream' used without 'try'-with-resources statement
in `pinot-spi/src/main/java/org/apache/pinot/spi/filesystem/LocalPinotFS.java`
#### Snippet
```java
      return Arrays.stream(file.list()).map(s -> getFileMetadata(new File(file, s))).collect(Collectors.toList());
    } else {
      return Files.walk(Paths.get(fileUri)).filter(s -> !s.equals(file.toPath())).map(p -> getFileMetadata(p.toFile()))
          .collect(Collectors.toList());
    }
```

### AutoCloseableResource
'Stream' used without 'try'-with-resources statement
in `pinot-spi/src/main/java/org/apache/pinot/spi/filesystem/LocalPinotFS.java`
#### Snippet
```java
      return Arrays.stream(file.list()).map(s -> new File(file, s)).map(File::getAbsolutePath).toArray(String[]::new);
    } else {
      return Files.walk(Paths.get(fileUri)).
          filter(s -> !s.equals(file.toPath())).map(Path::toString).toArray(String[]::new);
    }
```

### AutoCloseableResource
'Stream' used without 'try'-with-resources statement
in `pinot-common/src/main/java/org/apache/pinot/common/utils/log/LocalLogFileServer.java`
#### Snippet
```java
      throws IOException {
    Set<String> allFiles = new TreeSet<>();
    Files.walk(_logRootDirPath).filter(Files::isRegularFile).forEach(
        f -> allFiles.add(f.toAbsolutePath().toString().replace(_logRootDirPath.toAbsolutePath() + "/", "")));
    return allFiles;
```

### AutoCloseableResource
'PinotFS' used without 'try'-with-resources statement
in `pinot-common/src/main/java/org/apache/pinot/common/utils/fetcher/PinotFSSegmentFetcher.java`
#### Snippet
```java
  protected void fetchSegmentToLocalWithoutRetry(URI uri, File dest)
      throws Exception {
    PinotFSFactory.create(uri.getScheme()).copyToLocalFile(uri, dest);
  }
}
```

### AutoCloseableResource
'PinotFS' used without 'try'-with-resources statement
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/PinotFSSegmentUploader.java`
#### Snippet
```java
          segmentName.getSegmentName() + UUID.randomUUID().toString()));
      try {
        PinotFS pinotFS = PinotFSFactory.create(new URI(_segmentStoreUriStr).getScheme());
        // Check and delete any existing segment file.
        if (pinotFS.exists(destUri)) {
```

### AutoCloseableResource
'PinotFS' used without 'try'-with-resources statement
in `pinot-plugins/pinot-input-format/pinot-protobuf/src/main/java/org/apache/pinot/plugin/inputformat/protobuf/ProtoBufUtils.java`
#### Snippet
```java
    }
    if (PinotFSFactory.isSchemeSupported(scheme)) {
      PinotFS pinotFS = PinotFSFactory.create(scheme);
      Path localTmpDir = Files.createTempDirectory(TMP_DIR_PREFIX + System.currentTimeMillis());
      File protoDescriptorLocalFile = createLocalFile(descriptorFileURI, localTmpDir.toFile());
```

### AutoCloseableResource
'KinesisClient' used without 'try'-with-resources statement
in `pinot-plugins/pinot-stream-ingestion/pinot-kinesis/src/main/java/org/apache/pinot/plugin/stream/kinesis/server/KinesisDataServerStartable.java`
#### Snippet
```java
                  AttributeMap.builder().put(SdkHttpConfigurationOption.TRUST_ALL_CERTIFICATES, Boolean.TRUE).build()))
          .credentialsProvider(getLocalAWSCredentials()).region(Region.of(DEFAULT_REGION))
          .endpointOverride(new URI(_localStackKinesisEndpoint)).build();

      kinesisClient.createStream(
```

### AutoCloseableResource
'PinotFS' used without 'try'-with-resources statement
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/upload/ZKOperator.java`
#### Snippet
```java
      throws Exception {
    LOGGER.info("Copying segment from: {} to: {}", segmentFile.getAbsolutePath(), finalSegmentLocationURI);
    PinotFSFactory.create(finalSegmentLocationURI.getScheme()).copyFromLocalFile(segmentFile, finalSegmentLocationURI);
  }

```

### AutoCloseableResource
'PinotFS' used without 'try'-with-resources statement
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/upload/ZKOperator.java`
#### Snippet
```java
      Preconditions.checkState(sourceDownloadURI.getScheme().equals(finalSegmentLocationURI.getScheme()));
      LOGGER.info("Copying segment from: {} to: {}", sourceDownloadURI, finalSegmentLocationURI);
      PinotFSFactory.create(finalSegmentLocationURI.getScheme()).copy(sourceDownloadURI, finalSegmentLocationURI);
    }
  }
```

### AutoCloseableResource
'PinotFS' used without 'try'-with-resources statement
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotSegmentUploadDownloadRestletResource.java`
#### Snippet
```java
          try {
            URI segmentURI = new URI(sourceDownloadURIStr);
            PinotFS pinotFS = PinotFSFactory.create(segmentURI.getScheme());
            segmentSizeInBytes = pinotFS.length(segmentURI);
          } catch (Exception e) {
```

### AutoCloseableResource
'PinotFS' used without 'try'-with-resources statement
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotSegmentUploadDownloadRestletResource.java`
#### Snippet
```java
    } else {
      URI remoteSegmentFileURI = URIUtils.getUri(dataDirURI.toString(), tableName, URIUtils.encode(segmentName));
      PinotFS pinotFS = PinotFSFactory.create(dataDirURI.getScheme());
      if (!pinotFS.exists(remoteSegmentFileURI)) {
        throw new ControllerApplicationException(LOGGER,
```

### AutoCloseableResource
'PinotFS' used without 'try'-with-resources statement
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/ControllerFilePathProvider.java`
#### Snippet
```java
      LOGGER.info("Data directory: {}", _dataDirURI);

      PinotFS pinotFS = PinotFSFactory.create(_dataDirURI.getScheme());
      if (pinotFS.exists(_dataDirURI)) {
        Preconditions
```

### AutoCloseableResource
'PinotFS' used without 'try'-with-resources statement
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/LLCSegmentCompletionHandlers.java`
#### Snippet
```java
            .getUri(ControllerFilePathProvider.getInstance().getDataDirURI().toString(), rawTableName,
                URIUtils.encode(segmentName));
        PinotFS pinotFS = PinotFSFactory.create(segmentFileURI.getScheme());
        // Multiple threads can reach this point at the same time, if the following scenario happens
        // The server that was asked to commit did so very slowly (due to network speeds). Meanwhile the FSM in
```

### AutoCloseableResource
'PinotFS' used without 'try'-with-resources statement
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/LLCSegmentCompletionHandlers.java`
#### Snippet
```java
          .getUri(ControllerFilePathProvider.getInstance().getDataDirURI().toString(), rawTableName,
              URIUtils.encode(SegmentCompletionUtils.generateSegmentFileName(segmentName)));
      PinotFSFactory.create(segmentFileURI.getScheme()).copyFromLocalFile(localTempFile, segmentFileURI);
      SegmentCompletionProtocol.Response.Params responseParams = new SegmentCompletionProtocol.Response.Params()
          .withStreamPartitionMsgOffset(requestParams.getStreamPartitionMsgOffset())
```

### AutoCloseableResource
'PinotFS' used without 'try'-with-resources statement
in `pinot-controller/src/main/java/org/apache/pinot/controller/util/FileIngestionHelper.java`
#### Snippet
```java
          IngestionConfigUtils.getInputFsProps(batchConfigMap));
    }
    PinotFSFactory.create(sourceFileURIScheme).copyToLocalFile(sourceFileURI, destFile);
  }

```

### AutoCloseableResource
'PinotFS' used without 'try'-with-resources statement
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/SegmentDeletionManager.java`
#### Snippet
```java
      String rawTableName = TableNameBuilder.extractRawTableName(tableNameWithType);
      URI fileToDeleteURI = URIUtils.getUri(_dataDir, rawTableName, URIUtils.encode(segmentId));
      PinotFS pinotFS = PinotFSFactory.create(fileToDeleteURI.getScheme());
      if (retentionMs <= 0) {
        // delete the segment file instantly if retention is set to zero
```

### AutoCloseableResource
'PinotFS' used without 'try'-with-resources statement
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/SegmentDeletionManager.java`
#### Snippet
```java
    if (_dataDir != null) {
      URI deletedDirURI = URIUtils.getUri(_dataDir, DELETED_SEGMENTS);
      PinotFS pinotFS = PinotFSFactory.create(deletedDirURI.getScheme());

      try {
```

### AutoCloseableResource
'PinotFS' used without 'try'-with-resources statement
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/realtime/PinotLLCRealtimeSegmentManager.java`
#### Snippet
```java
    URI tableDirURI = URIUtils.getUri(_controllerConf.getDataDir(), rawTableName);
    URI uriToMoveTo = URIUtils.getUri(_controllerConf.getDataDir(), rawTableName, URIUtils.encode(segmentName));
    PinotFS pinotFS = PinotFSFactory.create(tableDirURI.getScheme());
    Preconditions.checkState(pinotFS.move(segmentFileURI, uriToMoveTo, true),
        "Failed to move segment file for segment: %s from: %s to: %s", segmentName, segmentLocation, uriToMoveTo);
```

### AutoCloseableResource
'PinotSegmentRecordReader' used without 'try'-with-resources statement
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/realtime/provisioning/MemoryEstimator.java`
#### Snippet
```java
      long multiValuesSum = 0;
      try {
        PinotSegmentRecordReader segmentRecordReader = new PinotSegmentRecordReader(_sampleCompletedSegment);
        GenericRow row = new GenericRow();

```

### AutoCloseableResource
'LineIterator' used without 'try'-with-resources statement
in `pinot-tools/src/main/java/org/apache/pinot/tools/QuickStartBase.java`
#### Snippet
```java
        StreamDataProvider.getStreamDataProducer(KafkaStarterUtils.KAFKA_PRODUCER_CLASS_NAME, properties);
    try {
      LineIterator dataStream = FileUtils.lineIterator(dataFile);

      while (dataStream.hasNext()) {
```

### AutoCloseableResource
'PinotFS' used without 'try'-with-resources statement
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/LaunchSparkDataIngestionJobCommand.java`
#### Snippet
```java
        depsJarDirURI = new File(depsJarDir).toURI();
      }
      PinotFS pinotFS = PinotFSFactory.create(depsJarDirURI.getScheme());
      String[] files = pinotFS.listFiles(depsJarDirURI, true);
      for (String file : files) {
```

### AutoCloseableResource
'PinotFS' used without 'try'-with-resources statement
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/LaunchSparkDataIngestionJobCommand.java`
#### Snippet
```java
        depsJarDirURI = new File(depsJarDir).toURI();
      }
      PinotFS pinotFS = PinotFSFactory.create(depsJarDirURI.getScheme());
      String[] files = pinotFS.listFiles(depsJarDirURI, true);
      for (String file : files) {
```

### AutoCloseableResource
'JSONRecordReader' used without 'try'-with-resources statement
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/DataImportDryRunCommand.java`
#### Snippet
```java
  @Override
  public boolean execute() throws Exception {
    JSONRecordReader jsonRecordReader = new JSONRecordReader();
    jsonRecordReader.init(new File(_jsonFile), null, null);

```

### AutoCloseableResource
'PinotFS' used without 'try'-with-resources statement
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/filesystem/DeleteFiles.java`
#### Snippet
```java
      }
      try {
        PinotFSFactory.create(scheme).delete(pathURI, _force);
      } catch (IOException e) {
        System.err.println("Unable to delete files under: " + pathURI + ", exception: " + e.getMessage());
```

### AutoCloseableResource
'PinotFS' used without 'try'-with-resources statement
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/filesystem/ListFiles.java`
#### Snippet
```java
      }
      try {
        PinotFS pinotFS = PinotFSFactory.create(scheme);
        if (pinotFS.isDirectory(pathURI)) {
          System.out.println(filePath + ":\n");
```

### AutoCloseableResource
'RandomAccessFile' used without 'try'-with-resources statement
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/memory/BasePinotLBuffer.java`
#### Snippet
```java
  public void readFrom(long offset, File file, long srcOffset, long size)
      throws IOException {
    try (FileChannel fileChannel = new RandomAccessFile(file, "r").getChannel()) {
      if (size <= Integer.MAX_VALUE) {
        fileChannel.read(_buffer.toDirectByteBuffer(offset, (int) size), srcOffset);
```

### AutoCloseableResource
'RandomAccessFile' used without 'try'-with-resources statement
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/memory/PinotByteBuffer.java`
#### Snippet
```java
      throws IOException {
    if (readOnly) {
      try (FileChannel fileChannel = new RandomAccessFile(file, "r").getChannel()) {
        ByteBuffer buffer = fileChannel.map(FileChannel.MapMode.READ_ONLY, offset, size).order(byteOrder);
        return new PinotByteBuffer(buffer, true, false);
```

### AutoCloseableResource
'RandomAccessFile' used without 'try'-with-resources statement
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/memory/PinotByteBuffer.java`
#### Snippet
```java
      }
    } else {
      try (FileChannel fileChannel = new RandomAccessFile(file, "rw").getChannel()) {
        ByteBuffer buffer = fileChannel.map(FileChannel.MapMode.READ_WRITE, offset, size).order(byteOrder);
        return new PinotByteBuffer(buffer, true, true);
```

### AutoCloseableResource
'PinotFS' used without 'try'-with-resources statement
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-spark-2.4/src/main/java/org/apache/pinot/plugin/ingestion/batch/spark/SparkSegmentUriPushJobRunner.java`
#### Snippet
```java
      throw new RuntimeException("outputDirURI is not valid - '" + _spec.getOutputDirURI() + "'");
    }
    PinotFS outputDirFS = PinotFSFactory.create(outputDirURI.getScheme());

    //Get list of files to process
```

### AutoCloseableResource
'PinotFS' used without 'try'-with-resources statement
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-spark-2.4/src/main/java/org/apache/pinot/plugin/ingestion/batch/spark/SparkSegmentGenerationJobRunner.java`
#### Snippet
```java
        depsJarDirURI = new File(depsJarDir).toURI();
      }
      PinotFS pinotFS = PinotFSFactory.create(depsJarDirURI.getScheme());
      String[] files = pinotFS.listFiles(depsJarDirURI, true);
      for (String file : files) {
```

### AutoCloseableResource
'PinotFS' used without 'try'-with-resources statement
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-spark-2.4/src/main/java/org/apache/pinot/plugin/ingestion/batch/spark/SparkSegmentGenerationJobRunner.java`
#### Snippet
```java
                .register(pinotFSSpec.getScheme(), pinotFSSpec.getClassName(), new PinotConfiguration(pinotFSSpec));
          }
          PinotFS finalOutputDirFS = PinotFSFactory.create(finalOutputDirURI.getScheme());
          String[] splits = pathAndIdx.split(" ");
          String path = splits[0];
```

### AutoCloseableResource
'PinotFS' used without 'try'-with-resources statement
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-spark-2.4/src/main/java/org/apache/pinot/plugin/ingestion/batch/spark/SparkSegmentGenerationJobRunner.java`
#### Snippet
```java
          File localInputDataFile = new File(localInputTempDir, getFileName(inputFileURI));
          LOGGER.info("Trying to copy input file from {} to {}", inputFileURI, localInputDataFile);
          PinotFSFactory.create(inputFileURI.getScheme()).copyToLocalFile(inputFileURI, localInputDataFile);

          //create task spec
```

### AutoCloseableResource
'PinotFS' used without 'try'-with-resources statement
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-spark-2.4/src/main/java/org/apache/pinot/plugin/ingestion/batch/spark/SparkSegmentGenerationJobRunner.java`
#### Snippet
```java
      outputDirURI = new File(_spec.getOutputDirURI()).toURI();
    }
    PinotFS outputDirFS = PinotFSFactory.create(outputDirURI.getScheme());
    outputDirFS.mkdir(outputDirURI);

```

### AutoCloseableResource
'OpChain' used without 'try'-with-resources statement
in `pinot-query-runtime/src/main/java/org/apache/pinot/query/runtime/executor/RoundRobinScheduler.java`
#### Snippet
```java
    try {
      OpChainId chainId = operatorChain.getId();
      _aliveChains.remove(chainId);
      // it could be that the onDataAvailable callback was called when the OpChain was executing, in which case there
      // could be a dangling entry in _seenMail.
```

### AutoCloseableResource
'PinotDataBuffer' used without 'try'-with-resources statement
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkRoaringBitmapCreation.java`
#### Snippet
```java
    }

    PinotDataBuffer dataBuffer = PinotByteBuffer.mapReadOnlyBigEndianFile(bufferFile);
    long offsetBufferEndOffset = (long) (_numBitmaps + 1) * Integer.BYTES;
    _offsetLengthBuffer = dataBuffer.view(0, offsetBufferEndOffset, ByteOrder.BIG_ENDIAN);
```

### AutoCloseableResource
'SegmentDirectory' used without 'try'-with-resources statement
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkOfflineIndexReader.java`
#### Snippet
```java

    SegmentDirectory segmentDirectory = SegmentDirectoryLoaderRegistry.getDefaultSegmentDirectoryLoader()
        .load(indexDir.toURI(), new SegmentDirectoryLoaderContext.Builder().setSegmentName(segmentMetadata.getName())
            .setSegmentDirectoryConfigs(new PinotConfiguration(props)).build());
    SegmentDirectory.Reader segmentReader = segmentDirectory.createReader();
```

### AutoCloseableResource
'PinotFS' used without 'try'-with-resources statement
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-common/src/main/java/org/apache/pinot/plugin/ingestion/batch/common/SegmentGenerationJobUtils.java`
#### Snippet
```java
      throws Exception {
    LOGGER.info("Trying to move metadata tar file from: [{}] to [{}]", localMetadataTarFile, outputMetadataTarURI);
    PinotFS outputPinotFS = PinotFSFactory.create(outputMetadataTarURI.getScheme());
    if (!overwrite && outputPinotFS.exists(outputMetadataTarURI)) {
      LOGGER.warn("Not overwrite existing output metadata tar file: {}", outputPinotFS.exists(outputMetadataTarURI));
```

### AutoCloseableResource
'RandomAccessFile' used without 'try'-with-resources statement
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/util/VarLengthValueWriter.java`
#### Snippet
```java
  public VarLengthValueWriter(File outputFile, int numValues)
      throws IOException {
    _fileChannel = new RandomAccessFile(outputFile, "rw").getChannel();
    _offsetBuffer = _fileChannel.map(FileChannel.MapMode.READ_WRITE, 0, Integer.MAX_VALUE);

```

### AutoCloseableResource
'RandomAccessFile' used without 'try'-with-resources statement
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/writer/impl/BaseChunkSVForwardIndexWriter.java`
#### Snippet
```java
    int maxCompressedChunkSize = _chunkCompressor.maxCompressedSize(_chunkSize); // may exceed original chunk size
    _compressedBuffer = ByteBuffer.allocateDirect(maxCompressedChunkSize);
    _dataFile = new RandomAccessFile(file, "rw").getChannel();
  }

```

### AutoCloseableResource
'RandomAccessFile' used without 'try'-with-resources statement
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/writer/impl/VarByteChunkSVForwardIndexWriterV4.java`
#### Snippet
```java
    _dataBuffer = new File(file.getName() + DATA_BUFFER_SUFFIX);
    _output = new RandomAccessFile(file, "rw");
    _dataChannel = new RandomAccessFile(_dataBuffer, "rw").getChannel();
    _chunkCompressor = ChunkCompressorFactory.getCompressor(compressionType, true);
    _chunkBuffer = ByteBuffer.allocateDirect(chunkSize).order(ByteOrder.LITTLE_ENDIAN);
```

### AutoCloseableResource
'Buffer' used without 'try'-with-resources statement
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/writer/impl/MutableOffHeapByteArrayStore.java`
#### Snippet
```java
      if ((currentBufferSize << 1) >= 0) {
        // The expanded buffer size should be enough for the current value
        buffer = expand(Math.max(currentBufferSize << 1, valueLength + Integer.BYTES));
      } else {
        // Int overflow
```

### AutoCloseableResource
'Buffer' used without 'try'-with-resources statement
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/writer/impl/MutableOffHeapByteArrayStore.java`
#### Snippet
```java
      } else {
        // Int overflow
        buffer = expand(Integer.MAX_VALUE);
      }
      index = buffer.add(value);
```

### AutoCloseableResource
'Buffer' used without 'try'-with-resources statement
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/writer/impl/MutableOffHeapByteArrayStore.java`
#### Snippet
```java
    _allocationContext = allocationContext;
    _startSize = numArrays * (avgArrayLen + 4); // For each array, we store the array and its startoffset (4 bytes)
    expand(_startSize);
  }

```

### AutoCloseableResource
'PinotFS' used without 'try'-with-resources statement
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/SegmentPushUtils.java`
#### Snippet
```java
    for (String segmentUri : segmentUris) {
      URI segmentURI = URI.create(segmentUri);
      PinotFS outputDirFS = PinotFSFactory.create(segmentURI.getScheme());
      for (PinotClusterSpec pinotClusterSpec : spec.getPinotClusterSpecs()) {
        URI controllerURI;
```

### AutoCloseableResource
'PinotSegmentColumnReader' used without 'try'-with-resources statement
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/upsert/UpsertUtils.java`
#### Snippet
```java
      _comparisonColumnReaders = new PinotSegmentColumnReader[comparisonColumns.size()];
      for (int i = 0; i < comparisonColumns.size(); i++) {
        _comparisonColumnReaders[i] = new PinotSegmentColumnReader(segment, comparisonColumns.get(i));
      }
    }
```

### AutoCloseableResource
'PinotDataBuffer' used without 'try'-with-resources statement
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/store/FilePerIndexDirectory.java`
#### Snippet
```java
  @Override
  public void removeIndex(String columnName, IndexType<?, ?, ?> indexType) {
    _indexBuffers.remove(new IndexKey(columnName, indexType));
    if (indexType == StandardIndexes.text()) {
      TextIndexUtils.cleanupTextIndex(_segmentDirectory, columnName);
```

### AutoCloseableResource
'RandomAccessFile' used without 'try'-with-resources statement
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/store/SingleFileIndexDirectory.java`
#### Snippet
```java
    long nextOffset = 0;
    // With FileChannel, we can seek to the data flexibly.
    try (FileChannel srcCh = new RandomAccessFile(srcFile, "r").getChannel();
        FileChannel dstCh = new RandomAccessFile(destFile, "rw").getChannel()) {
      for (IndexEntry index : indicesToCopy.values()) {
```

### AutoCloseableResource
'RandomAccessFile' used without 'try'-with-resources statement
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/store/SingleFileIndexDirectory.java`
#### Snippet
```java
    // With FileChannel, we can seek to the data flexibly.
    try (FileChannel srcCh = new RandomAccessFile(srcFile, "r").getChannel();
        FileChannel dstCh = new RandomAccessFile(destFile, "rw").getChannel()) {
      for (IndexEntry index : indicesToCopy.values()) {
        srcCh.transferTo(index._startOffset, index._size, dstCh);
```

### AutoCloseableResource
'RandomAccessFile' used without 'try'-with-resources statement
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/creator/impl/inv/BitmapInvertedIndexWriter.java`
#### Snippet
```java
  public BitmapInvertedIndexWriter(File outputFile, int numBitmaps)
      throws IOException {
    this(new RandomAccessFile(outputFile, "rw").getChannel(), numBitmaps, true);
  }

```

### AutoCloseableResource
'RandomAccessFile' used without 'try'-with-resources statement
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/creator/impl/inv/MmapFileWriter.java`
#### Snippet
```java
  public MmapFileWriter(File file, int size)
      throws IOException {
    _fileChannel = new RandomAccessFile(file, "rw").getChannel();
    _buffer = _fileChannel.map(FileChannel.MapMode.READ_WRITE, 0, size);
  }
```

### AutoCloseableResource
'IndexCreator' used without 'try'-with-resources statement
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/creator/impl/SegmentColumnarIndexCreator.java`
#### Snippet
```java
    C config = fieldIndexConfigs.getConfig(index);
    if (config.isEnabled()) {
      creatorsByIndex.put(index, index.createIndexCreator(context, config));
    }
  }
```

### AutoCloseableResource
'FileChannel' used without 'try'-with-resources statement
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/creator/impl/inv/RangeIndexCreator.java`
#### Snippet
```java
      header.writeLong(bitmapOffset);
      bytesWritten += Long.BYTES;
      fos.getChannel().position(bitmapOffset);

      for (int i = 0; i < ranges.size(); i++) {
```

### AutoCloseableResource
'RandomAccessFile' used without 'try'-with-resources statement
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/creator/impl/inv/json/BaseJsonIndexCreator.java`
#### Snippet
```java
    headerBuffer.position(0);

    try (FileChannel indexFileChannel = new RandomAccessFile(_indexFile, "rw").getChannel();
        FileChannel dictionaryFileChannel = new RandomAccessFile(_dictionaryFile, "r").getChannel();
        FileChannel invertedIndexFileChannel = new RandomAccessFile(_invertedIndexFile, "r").getChannel()) {
```

### AutoCloseableResource
'RandomAccessFile' used without 'try'-with-resources statement
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/creator/impl/inv/json/BaseJsonIndexCreator.java`
#### Snippet
```java

    try (FileChannel indexFileChannel = new RandomAccessFile(_indexFile, "rw").getChannel();
        FileChannel dictionaryFileChannel = new RandomAccessFile(_dictionaryFile, "r").getChannel();
        FileChannel invertedIndexFileChannel = new RandomAccessFile(_invertedIndexFile, "r").getChannel()) {
      indexFileChannel.write(headerBuffer);
```

### AutoCloseableResource
'RandomAccessFile' used without 'try'-with-resources statement
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/creator/impl/inv/json/BaseJsonIndexCreator.java`
#### Snippet
```java
    try (FileChannel indexFileChannel = new RandomAccessFile(_indexFile, "rw").getChannel();
        FileChannel dictionaryFileChannel = new RandomAccessFile(_dictionaryFile, "r").getChannel();
        FileChannel invertedIndexFileChannel = new RandomAccessFile(_invertedIndexFile, "r").getChannel()) {
      indexFileChannel.write(headerBuffer);
      dictionaryFileChannel.transferTo(0, dictionaryFileLength, indexFileChannel);
```

### AutoCloseableResource
'RandomAccessFile' used without 'try'-with-resources statement
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/creator/impl/inv/geospatial/BaseH3IndexCreator.java`
#### Snippet
```java
    headerBuffer.position(0);

    try (FileChannel indexFileChannel = new RandomAccessFile(_indexFile, "rw").getChannel();
        FileChannel dictionaryFileChannel = new RandomAccessFile(_dictionaryFile, "r").getChannel();
        FileChannel bitmapOffsetFileChannel = new RandomAccessFile(_bitmapOffsetFile, "r").getChannel();
```

### AutoCloseableResource
'RandomAccessFile' used without 'try'-with-resources statement
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/creator/impl/inv/geospatial/BaseH3IndexCreator.java`
#### Snippet
```java

    try (FileChannel indexFileChannel = new RandomAccessFile(_indexFile, "rw").getChannel();
        FileChannel dictionaryFileChannel = new RandomAccessFile(_dictionaryFile, "r").getChannel();
        FileChannel bitmapOffsetFileChannel = new RandomAccessFile(_bitmapOffsetFile, "r").getChannel();
        FileChannel bitmapValueFileChannel = new RandomAccessFile(_bitmapValueFile, "r").getChannel()) {
```

### AutoCloseableResource
'RandomAccessFile' used without 'try'-with-resources statement
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/creator/impl/inv/geospatial/BaseH3IndexCreator.java`
#### Snippet
```java
    try (FileChannel indexFileChannel = new RandomAccessFile(_indexFile, "rw").getChannel();
        FileChannel dictionaryFileChannel = new RandomAccessFile(_dictionaryFile, "r").getChannel();
        FileChannel bitmapOffsetFileChannel = new RandomAccessFile(_bitmapOffsetFile, "r").getChannel();
        FileChannel bitmapValueFileChannel = new RandomAccessFile(_bitmapValueFile, "r").getChannel()) {
      indexFileChannel.write(headerBuffer);
```

### AutoCloseableResource
'RandomAccessFile' used without 'try'-with-resources statement
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/creator/impl/inv/geospatial/BaseH3IndexCreator.java`
#### Snippet
```java
        FileChannel dictionaryFileChannel = new RandomAccessFile(_dictionaryFile, "r").getChannel();
        FileChannel bitmapOffsetFileChannel = new RandomAccessFile(_bitmapOffsetFile, "r").getChannel();
        FileChannel bitmapValueFileChannel = new RandomAccessFile(_bitmapValueFile, "r").getChannel()) {
      indexFileChannel.write(headerBuffer);
      dictionaryFileChannel.transferTo(0, _dictionaryFile.length(), indexFileChannel);
```

### AutoCloseableResource
'RandomAccessFile' used without 'try'-with-resources statement
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/creator/impl/text/NativeTextIndexCreator.java`
#### Snippet
```java
    headerBuffer.position(0);

    try (FileChannel indexFileChannel = new RandomAccessFile(_indexFile, "rw").getChannel();
        FileChannel invertedIndexFileChannel = new RandomAccessFile(_invertedIndexFile, "r").getChannel();
        FileChannel fstFileChannel = new RandomAccessFile(_fstIndexFile, "rw").getChannel()) {
```

### AutoCloseableResource
'RandomAccessFile' used without 'try'-with-resources statement
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/creator/impl/text/NativeTextIndexCreator.java`
#### Snippet
```java

    try (FileChannel indexFileChannel = new RandomAccessFile(_indexFile, "rw").getChannel();
        FileChannel invertedIndexFileChannel = new RandomAccessFile(_invertedIndexFile, "r").getChannel();
        FileChannel fstFileChannel = new RandomAccessFile(_fstIndexFile, "rw").getChannel()) {
      indexFileChannel.write(headerBuffer);
```

### AutoCloseableResource
'RandomAccessFile' used without 'try'-with-resources statement
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/creator/impl/text/NativeTextIndexCreator.java`
#### Snippet
```java
    try (FileChannel indexFileChannel = new RandomAccessFile(_indexFile, "rw").getChannel();
        FileChannel invertedIndexFileChannel = new RandomAccessFile(_invertedIndexFile, "r").getChannel();
        FileChannel fstFileChannel = new RandomAccessFile(_fstIndexFile, "rw").getChannel()) {
      indexFileChannel.write(headerBuffer);
      fstFileChannel.transferTo(0, _fstDataSize, indexFileChannel);
```

### AutoCloseableResource
'RandomAccessFile' used without 'try'-with-resources statement
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/creator/impl/inv/OffHeapBitmapInvertedIndexCreator.java`
#### Snippet
```java
  public void seal()
      throws IOException {
    try (FileChannel channel = new RandomAccessFile(_invertedIndexFile, "rw").getChannel()) {
      seal(channel);
    }
```

### AutoCloseableResource
'RandomAccessFile' used without 'try'-with-resources statement
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/startree/v2/builder/StarTreeIndexCombiner.java`
#### Snippet
```java
  private IndexValue writeFile(File srcFile)
      throws IOException {
    try (FileChannel src = new RandomAccessFile(srcFile, "r").getChannel()) {
      long offset = _fileChannel.position();
      long size = src.size();
```

### AutoCloseableResource
'RandomAccessFile' used without 'try'-with-resources statement
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/startree/v2/builder/StarTreeIndexCombiner.java`
#### Snippet
```java
      throws IOException {
    Preconditions.checkState(!indexFile.exists(), "Star-tree index file already exists");
    _fileChannel = new RandomAccessFile(indexFile, "rw").getChannel();
  }

```

### AutoCloseableResource
'PinotSegmentColumnReader' used without 'try'-with-resources statement
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/startree/v2/builder/BaseSingleTreeBuilder.java`
#### Snippet
```java
        _skipStarNodeCreationForDimensions.add(i);
      }
      _dimensionReaders[i] = new PinotSegmentColumnReader(segment, dimension);
      Preconditions.checkState(_dimensionReaders[i].hasDictionary(),
          "Dimension: " + dimension + " does not have dictionary");
```

### AutoCloseableResource
'PinotSegmentColumnReader' used without 'try'-with-resources statement
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/startree/v2/builder/BaseSingleTreeBuilder.java`
#### Snippet
```java
      if (_valueAggregators[index].getAggregationType() != AggregationFunctionType.COUNT) {
        String column = functionColumnPair.getColumn();
        _metricReaders[index] = new PinotSegmentColumnReader(segment, column);
      }

```

### AutoCloseableResource
'SingleValueUnsortedForwardIndexCreator' used without 'try'-with-resources statement
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/startree/v2/builder/BaseSingleTreeBuilder.java`
#### Snippet
```java
      int cardinality = _segment.getDictionary(dimension).length();
      dimensionIndexCreators[i] =
          new SingleValueUnsortedForwardIndexCreator(_outputDir, _dimensionsSplitOrder[i], cardinality, _numDocs);
    }

```

### AutoCloseableResource
'SingleValueVarByteRawIndexCreator' used without 'try'-with-resources statement
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/startree/v2/builder/BaseSingleTreeBuilder.java`
#### Snippet
```java
      if (valueType == BYTES) {
        metricIndexCreators[i] =
            new SingleValueVarByteRawIndexCreator(_outputDir, ChunkCompressionType.PASS_THROUGH, metric, _numDocs,
                BYTES, valueAggregator.getMaxAggregatedValueByteSize());
      } else {
```

### AutoCloseableResource
'SingleValueFixedByteRawIndexCreator' used without 'try'-with-resources statement
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/startree/v2/builder/BaseSingleTreeBuilder.java`
#### Snippet
```java
      } else {
        metricIndexCreators[i] =
            new SingleValueFixedByteRawIndexCreator(_outputDir, ChunkCompressionType.PASS_THROUGH, metric, _numDocs,
                valueType);
      }
```

## RuleId[id=ComparatorMethodParameterNotUsed]
### ComparatorMethodParameterNotUsed
Comparator does not return 0 for equal elements
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/MoveReplicaGroup.java`
#### Snippet
```java
          public int compare(SourceSegments s1, SourceSegments s2) {
            // arbitrary decision for equals case
            return (s1._replicaCount > s2._replicaCount ? -1 : 1);
          }
        });
```

### ComparatorMethodParameterNotUsed
Comparator does not return 0 for equal elements
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/MoveReplicaGroup.java`
#### Snippet
```java
          @Override
          public int compare(ServerInstance o1, ServerInstance o2) {
            return o1._segments < o2._segments ? -1 : 1;
          }
        });
```

## RuleId[id=RedundantCast]
### RedundantCast
Casting `pair1.getObjectValue()` to `Comparable` is redundant
in `pinot-spi/src/main/java/org/apache/pinot/spi/utils/Pairs.java`
#### Snippet
```java
    public int compare(IntObjectPair pair1, IntObjectPair pair2) {

      Comparable c1 = (Comparable) pair1.getObjectValue();
      Comparable c2 = (Comparable) pair2.getObjectValue();

```

### RedundantCast
Casting `pair2.getObjectValue()` to `Comparable` is redundant
in `pinot-spi/src/main/java/org/apache/pinot/spi/utils/Pairs.java`
#### Snippet
```java

      Comparable c1 = (Comparable) pair1.getObjectValue();
      Comparable c2 = (Comparable) pair2.getObjectValue();

      int cmpValue = c1.compareTo(c2);
```

### RedundantCast
Casting `n` to `long` is redundant
in `pinot-common/src/main/java/org/apache/pinot/common/utils/TarGzCompressionUtils.java`
#### Snippet
```java

    if (maxStreamRateInByte == SYNC_DISK_WRITE_WITH_UPSTREAM_RATE) {
      for (count = 0L; -1 != (n = inputStream.read(buffer)); count += (long) n) {
        outputStream.write(buffer, 0, n);
        fd.sync(); // flush the buffer timely to the disk so that the disk bandwidth wouldn't get saturated
```

### RedundantCast
Casting `n` to `long` is redundant
in `pinot-common/src/main/java/org/apache/pinot/common/utils/TarGzCompressionUtils.java`
#### Snippet
```java
    } else {
      RateLimiter rateLimiter = RateLimiter.create(maxStreamRateInByte);
      for (count = 0L; -1 != (n = inputStream.read(buffer)); count += (long) n) {
        rateLimiter.acquire(n);
        outputStream.write(buffer, 0, n);
```

### RedundantCast
Casting `value` to `Object[]` is redundant
in `pinot-core/src/main/java/org/apache/pinot/core/util/SegmentProcessorAvroUtils.java`
#### Snippet
```java
      Object value = genericRow.getValue(field);
      if (value instanceof Object[]) {
        reusableRecord.put(field, Arrays.asList((Object[]) value));
      } else {
        if (value instanceof byte[]) {
```

### RedundantCast
Casting `input` to `BigDecimal` is redundant
in `pinot-core/src/main/java/org/apache/pinot/core/function/scalar/SketchFunctions.java`
#### Snippet
```java
      sketch.update((Double) input);
    } else if (input instanceof BigDecimal) {
      sketch.update(((BigDecimal) input).toString());
    } else if (input instanceof String) {
      sketch.update((String) input);
```

### RedundantCast
Casting `value` to `byte[][]` is redundant
in `pinot-core/src/main/java/org/apache/pinot/core/common/datablock/DataBlockBuilder.java`
#### Snippet
```java
            break;
          case BYTES_ARRAY:
            setColumn(rowBuilder, byteBuffer, (byte[][]) value);
            break;
          case STRING_ARRAY:
```

### RedundantCast
Casting `segmentsExcludeReplaced.size()` to `long` is redundant
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/SegmentStatusChecker.java`
#### Snippet
```java
        idealState.serialize(RECORD_SERIALIZER).length);
    _controllerMetrics.setValueOfTableGauge(tableNameWithType, ControllerGauge.SEGMENT_COUNT,
        (long) segmentsExcludeReplaced.size());
    _controllerMetrics.setValueOfTableGauge(tableNameWithType, ControllerGauge.SEGMENT_COUNT_INCLUDING_REPLACED,
        (long) (idealState.getPartitionSet().size()));
```

### RedundantCast
Casting `(System.currentTimeMillis() - _tableRebalanceProgressStats.getStartTimeMs())` to `long` is redundant
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/rebalance/ZkBasedTableRebalanceObserver.java`
#### Snippet
```java
  public void onError(String errorMsg) {
    long timeToFinishInSeconds =
        (long) (System.currentTimeMillis() - _tableRebalanceProgressStats.getStartTimeMs()) / 1000;
    _tableRebalanceProgressStats.setTimeToFinishInSeconds(timeToFinishInSeconds);
    _tableRebalanceProgressStats.setStatus(RebalanceResult.Status.FAILED.toString());
```

### RedundantCast
Casting `value` to `Object[]` is redundant
in `pinot-tools/src/main/java/org/apache/pinot/tools/segment/converter/PinotSegmentToAvroConverter.java`
#### Snippet
```java
            Object value = entry.getValue();
            if (value instanceof Object[]) {
              record.put(field, Arrays.asList((Object[]) value));
            } else if (value instanceof byte[]) {
              record.put(field, ByteBuffer.wrap((byte[]) value));
```

### RedundantCast
Casting `origValue` to `Object[]` is redundant
in `pinot-tools/src/main/java/org/apache/pinot/tools/anonymizer/PinotDataAndQueryAnonymizer.java`
#### Snippet
```java
          avroRow.put(derivedColumnName, origValue);
        } else {
          avroRow.put(derivedColumnName, Arrays.asList((Object[]) origValue));
        }
      } else if (_globalDictionaryColumns.containsKey(columnName)) {
```

### RedundantCast
Casting `derivedValue` to `Object[]` is redundant
in `pinot-tools/src/main/java/org/apache/pinot/tools/anonymizer/PinotDataAndQueryAnonymizer.java`
#### Snippet
```java
          avroRow.put(derivedColumnName, derivedValue);
        } else {
          avroRow.put(derivedColumnName, Arrays.asList((Object[]) derivedValue));
        }
      }
```

### RedundantCast
Casting `currentValue` to `Comparable` is redundant
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/upsert/merger/MinMerger.java`
#### Snippet
```java
  @Override
  public Object merge(Object previousValue, Object currentValue) {
    return ((Comparable) previousValue).compareTo((Comparable) currentValue) < 0 ? previousValue : currentValue;
  }
}
```

### RedundantCast
Casting `currentValue` to `Comparable` is redundant
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/upsert/merger/MaxMerger.java`
#### Snippet
```java
  @Override
  public Object merge(Object previousValue, Object currentValue) {
    return ((Comparable) previousValue).compareTo((Comparable) currentValue) > 0 ? previousValue : currentValue;
  }
}
```

### RedundantCast
Casting `chunkBuffer.duplicate().position(...).limit(...)` to `ByteBuffer` is redundant
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/readers/forward/FixedByteChunkMVForwardIndexReader.java`
#### Snippet
```java
    int valueEndOffset = getValueEndOffset(chunkRowId, chunkBuffer);
    // cast only for JDK8 compilation profile
    return (ByteBuffer) chunkBuffer.duplicate().position(valueStartOffset).limit(valueEndOffset);
  }

```

### RedundantCast
Casting `getIntValue(...)` to `long` is redundant
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/realtime/impl/dictionary/IntOnHeapMutableDictionary.java`
#### Snippet
```java
  @Override
  public long getLongValue(int dictId) {
    return (long) getIntValue(dictId);
  }

```

### RedundantCast
Casting `getIntValue(...)` to `long` is redundant
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/realtime/impl/dictionary/IntOffHeapMutableDictionary.java`
#### Snippet
```java
  @Override
  public long getLongValue(int dictId) {
    return (long) getIntValue(dictId);
  }

```

## RuleId[id=JavadocDeclaration]
### JavadocDeclaration
`@param fs` tag description is missing
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-hadoop/src/main/java/org/apache/pinot/plugin/ingestion/batch/hadoop/HadoopSegmentGenerationJobRunner.java`
#### Snippet
```java
   * so that move() can be used.
   *
   * @param fs
   * @param sourceDir
   * @param destDir
```

### JavadocDeclaration
`@param sourceDir` tag description is missing
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-hadoop/src/main/java/org/apache/pinot/plugin/ingestion/batch/hadoop/HadoopSegmentGenerationJobRunner.java`
#### Snippet
```java
   *
   * @param fs
   * @param sourceDir
   * @param destDir
   * @param overwrite
```

### JavadocDeclaration
`@param destDir` tag description is missing
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-hadoop/src/main/java/org/apache/pinot/plugin/ingestion/batch/hadoop/HadoopSegmentGenerationJobRunner.java`
#### Snippet
```java
   * @param fs
   * @param sourceDir
   * @param destDir
   * @param overwrite
   * @throws IOException
```

### JavadocDeclaration
`@param overwrite` tag description is missing
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-hadoop/src/main/java/org/apache/pinot/plugin/ingestion/batch/hadoop/HadoopSegmentGenerationJobRunner.java`
#### Snippet
```java
   * @param sourceDir
   * @param destDir
   * @param overwrite
   * @throws IOException
   * @throws URISyntaxException
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-hadoop/src/main/java/org/apache/pinot/plugin/ingestion/batch/hadoop/HadoopSegmentGenerationJobRunner.java`
#### Snippet
```java
   * @param destDir
   * @param overwrite
   * @throws IOException
   * @throws URISyntaxException
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-hadoop/src/main/java/org/apache/pinot/plugin/ingestion/batch/hadoop/HadoopSegmentGenerationJobRunner.java`
#### Snippet
```java
   * @param overwrite
   * @throws IOException
   * @throws URISyntaxException
   */
  private void moveFiles(PinotFS fs, URI sourceDir, URI destDir, boolean overwrite)
```

### JavadocDeclaration
`@param job` tag description is missing
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-hadoop/src/main/java/org/apache/pinot/plugin/ingestion/batch/hadoop/HadoopSegmentGenerationJobRunner.java`
#### Snippet
```java
   * as otherwise it's not available (since the pinot-all jar - which is bigger - is what we've set as our job jar).
   *
   * @param job
   * @param outputDirFS
   * @param stagingDirURI
```

### JavadocDeclaration
`@param outputDirFS` tag description is missing
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-hadoop/src/main/java/org/apache/pinot/plugin/ingestion/batch/hadoop/HadoopSegmentGenerationJobRunner.java`
#### Snippet
```java
   *
   * @param job
   * @param outputDirFS
   * @param stagingDirURI
   * @throws Exception
```

### JavadocDeclaration
`@param stagingDirURI` tag description is missing
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-hadoop/src/main/java/org/apache/pinot/plugin/ingestion/batch/hadoop/HadoopSegmentGenerationJobRunner.java`
#### Snippet
```java
   * @param job
   * @param outputDirFS
   * @param stagingDirURI
   * @throws Exception
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-hadoop/src/main/java/org/apache/pinot/plugin/ingestion/batch/hadoop/HadoopSegmentGenerationJobRunner.java`
#### Snippet
```java
   * @param outputDirFS
   * @param stagingDirURI
   * @throws Exception
   */
  protected void addMapperJarToDistributedCache(Job job, PinotFS outputDirFS, URI stagingDirURI)
```

### JavadocDeclaration
Class/method reference, quoted text, or HTML link are expected after @see tag
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/logical/RelToStageConverter.java`
#### Snippet
```java
   * @param relDataType the DECIMAL rel data type.
   * @return proper {@link DataSchema.ColumnDataType}.
   * @see {@link org.apache.calcite.rel.type.RelDataTypeFactoryImpl#decimalOf}.
   */
  private static DataSchema.ColumnDataType resolveDecimal(RelDataType relDataType) {
```

### JavadocDeclaration
Illegal character
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/physical/colocated/ColocationKey.java`
#### Snippet
```java
 * ColocationKey describes how data is distributed in a given stage. It consists of a list of columns which are stored
 * as a list of {@link RexInputRef#getIndex()}, the number of partitions and the hash-algorithm used. A given stage may
 * have more than 1 ColocationKey, in which case one may use a {@link java.util.Set< ColocationKey >} to represent this
 * behavior.
 *
```

### JavadocDeclaration
Illegal character
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/physical/colocated/ColocationKey.java`
#### Snippet
```java
 * ColocationKey describes how data is distributed in a given stage. It consists of a list of columns which are stored
 * as a list of {@link RexInputRef#getIndex()}, the number of partitions and the hash-algorithm used. A given stage may
 * have more than 1 ColocationKey, in which case one may use a {@link java.util.Set< ColocationKey >} to represent this
 * behavior.
 *
```

### JavadocDeclaration
`@param recordReaderConfigClassName` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/data/readers/RecordReaderFactory.java`
#### Snippet
```java
   * Construct a RecordReaderConfig instance from a given file.
   *
   * @param recordReaderConfigClassName
   * @param readerConfigFile
   * @return
```

### JavadocDeclaration
`@param readerConfigFile` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/data/readers/RecordReaderFactory.java`
#### Snippet
```java
   *
   * @param recordReaderConfigClassName
   * @param readerConfigFile
   * @return
   * @throws IOException
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/data/readers/RecordReaderFactory.java`
#### Snippet
```java
   * @param recordReaderConfigClassName
   * @param readerConfigFile
   * @return
   * @throws IOException
   * @throws ClassNotFoundException
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/data/readers/RecordReaderFactory.java`
#### Snippet
```java
   * @param readerConfigFile
   * @return
   * @throws IOException
   * @throws ClassNotFoundException
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/data/readers/RecordReaderFactory.java`
#### Snippet
```java
   * @return
   * @throws IOException
   * @throws ClassNotFoundException
   */
  public static RecordReaderConfig getRecordReaderConfigByClassName(String recordReaderConfigClassName,
```

### JavadocDeclaration
`@param recordReaderConfigClassName` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/data/readers/RecordReaderFactory.java`
#### Snippet
```java
   * Construct a RecordReaderConfig instance from a given file path.
   *
   * @param recordReaderConfigClassName
   * @param readerConfigFile
   * @return
```

### JavadocDeclaration
`@param readerConfigFile` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/data/readers/RecordReaderFactory.java`
#### Snippet
```java
   *
   * @param recordReaderConfigClassName
   * @param readerConfigFile
   * @return
   * @throws IOException
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/data/readers/RecordReaderFactory.java`
#### Snippet
```java
   * @param recordReaderConfigClassName
   * @param readerConfigFile
   * @return
   * @throws IOException
   * @throws ClassNotFoundException
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/data/readers/RecordReaderFactory.java`
#### Snippet
```java
   * @param readerConfigFile
   * @return
   * @throws IOException
   * @throws ClassNotFoundException
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/data/readers/RecordReaderFactory.java`
#### Snippet
```java
   * @return
   * @throws IOException
   * @throws ClassNotFoundException
   */
  public static RecordReaderConfig getRecordReaderConfigByClassName(String recordReaderConfigClassName,
```

### JavadocDeclaration
`@param fileFormatStr` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/data/readers/RecordReaderFactory.java`
#### Snippet
```java
   * Get registered RecordReader class name given a file format.
   *
   * @param fileFormatStr
   * @return recordReaderClassName
   */
```

### JavadocDeclaration
`@param fileFormatStr` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/data/readers/RecordReaderFactory.java`
#### Snippet
```java
   * Get registered RecordReaderConfig class name given a file format.
   *
   * @param fileFormatStr
   * @return recordReaderConfigClassName
   */
```

### JavadocDeclaration
`@param fileFormat` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/data/readers/RecordReaderFactory.java`
#### Snippet
```java
   * Construct a RecordReaderConfig instance from a given file.
   *
   * @param fileFormat
   * @param readerConfigFile
   * @return a RecordReaderConfig instance
```

### JavadocDeclaration
`@param readerConfigFile` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/data/readers/RecordReaderFactory.java`
#### Snippet
```java
   *
   * @param fileFormat
   * @param readerConfigFile
   * @return a RecordReaderConfig instance
   * @throws Exception
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/data/readers/RecordReaderFactory.java`
#### Snippet
```java
   * @param readerConfigFile
   * @return a RecordReaderConfig instance
   * @throws Exception
   */
  public static RecordReaderConfig getRecordReaderConfig(FileFormat fileFormat, String readerConfigFile)
```

### JavadocDeclaration
`@param encryptedFile` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/crypt/PinotCrypter.java`
#### Snippet
```java
  /**
   * Decrypts file into file location provided. The implementation should clean up file after any failures.
   * @param encryptedFile
   * @param decryptedFile
   */
```

### JavadocDeclaration
`@param decryptedFile` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/crypt/PinotCrypter.java`
#### Snippet
```java
   * Decrypts file into file location provided. The implementation should clean up file after any failures.
   * @param encryptedFile
   * @param decryptedFile
   */
  void decrypt(File encryptedFile, File decryptedFile);
```

### JavadocDeclaration
`@param decryptedFile` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/crypt/PinotCrypter.java`
#### Snippet
```java
  /**
   * Encrypts the file into the file location provided. The implementation should clean up file after any failures.
   * @param decryptedFile
   * @param encryptedFile
   */
```

### JavadocDeclaration
`@param encryptedFile` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/crypt/PinotCrypter.java`
#### Snippet
```java
   * Encrypts the file into the file location provided. The implementation should clean up file after any failures.
   * @param decryptedFile
   * @param encryptedFile
   */
  void encrypt(File decryptedFile, File encryptedFile);
```

### JavadocDeclaration
`@param config` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/crypt/PinotCrypter.java`
#### Snippet
```java
  /**
   * Initializes a crypter with any configurations it might need.
   * @param config
   */
  void init(PinotConfiguration config);
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/utils/ResourceFinder.java`
#### Snippet
```java
   * @param pathName Relative Path of the resource
   * @return InputStream containing file contents
   * @throws IOException
   */
  public static InputStream openResourceWithRelativePath(ClassLoader classLoader, String pathName)
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/utils/ResourceFinder.java`
#### Snippet
```java
   * @param pathName Absolute or Relative Path of the resource
   * @return InputStream containing file contents
   * @throws IOException
   */
  public static InputStream openResource(ClassLoader classLoader, String pathName)
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/utils/ResourceFinder.java`
#### Snippet
```java
   * @param uri of the resource
   * @return InputStream containing file contents
   * @throws IOException
   */
  public static InputStream openResource(URI uri)
```

### JavadocDeclaration
`@param oldFieldSpec` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/data/FieldSpec.java`
#### Snippet
```java
   * all other fields except DefaultNullValue and Max Length should be retained.
   *
   * @param oldFieldSpec
   * @return
   */
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/data/FieldSpec.java`
#### Snippet
```java
   *
   * @param oldFieldSpec
   * @return
   */
  public boolean isBackwardCompatibleWith(FieldSpec oldFieldSpec) {
```

### JavadocDeclaration
`@param pinotFSSpec` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/env/PinotConfiguration.java`
#### Snippet
```java
   * Intended for use by Job Runners
   *
   * @param pinotFSSpec
   */
  public PinotConfiguration(PinotFSSpec pinotFSSpec) {
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/utils/NetUtils.java`
#### Snippet
```java
   * Find an open port.
   * @return an open port
   * @throws IOException
   */
  public static int findOpenPort()
```

### JavadocDeclaration
`@param basePort` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/utils/NetUtils.java`
#### Snippet
```java
  /**
   * Find the first open port from default port in an incremental order.
   * @param basePort
   * @return an open port
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/utils/retry/RetryPolicy.java`
#### Snippet
```java
   *
   * @param operation The operation to attempt, which returns true on success and false on failure.
   * @throws AttemptsExceededException
   * @throws RetriableOperationException
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/utils/retry/RetryPolicy.java`
#### Snippet
```java
   * @param operation The operation to attempt, which returns true on success and false on failure.
   * @throws AttemptsExceededException
   * @throws RetriableOperationException
   */
  void attempt(Callable<Boolean> operation)
```

### JavadocDeclaration
`@param streamConfig` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/StreamPartitionMsgOffsetFactory.java`
#### Snippet
```java
  /**
   * Initialization, called once when the factory is created.
   * @param streamConfig
   */
  void init(StreamConfig streamConfig);
```

### JavadocDeclaration
`@param other` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/StreamPartitionMsgOffsetFactory.java`
#### Snippet
```java
   * Construct an offset from another one provided, of the same type.
   *
   * @param other
   * @return
   */
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/StreamPartitionMsgOffsetFactory.java`
#### Snippet
```java
   *
   * @param other
   * @return
   */
  StreamPartitionMsgOffset create(StreamPartitionMsgOffset other);
```

### JavadocDeclaration
`@param offsetStr` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/StreamPartitionMsgOffsetFactory.java`
#### Snippet
```java
  /**
   * Construct an offset from the string provided.
   * @param offsetStr
   * @return StreamPartitionMsgOffset
   */
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/StreamConsumerFactory.java`
#### Snippet
```java
   * @param clientId a client id to identify the creator of this consumer
   * @param partition the partition id of the partition for which this metadata provider is being created
   * @return
   */
  public abstract StreamMetadataProvider createPartitionMetadataProvider(String clientId, int partition);
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/StreamConsumerFactory.java`
#### Snippet
```java
   * @param clientId a client id to identify the creator of this consumer
   * @param partition the partition id of the partition for which this consumer is being created
   * @return
   */
  public abstract PartitionLevelConsumer createPartitionLevelConsumer(String clientId, int partition);
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/StreamConsumerFactory.java`
#### Snippet
```java
   * Creates a metadata provider which provides stream specific metadata
   * @param clientId a client id to identify the creator of this consumer
   * @return
   */
  public abstract StreamMetadataProvider createStreamMetadataProvider(String clientId);
```

### JavadocDeclaration
`@param streamConfig` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/StreamConsumerFactoryProvider.java`
#### Snippet
```java
   * Constructs the {@link StreamConsumerFactory} using the {@link StreamConfig::getConsumerFactoryClassName()}
   * property and initializes it
   * @param streamConfig
   * @return
   */
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/StreamConsumerFactoryProvider.java`
#### Snippet
```java
   * property and initializes it
   * @param streamConfig
   * @return
   */
  public static StreamConsumerFactory create(StreamConfig streamConfig) {
```

### JavadocDeclaration
`@param index` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/MessageBatch.java`
#### Snippet
```java
  /**
   * Returns the offset of the message at a particular index inside a set of messages returned from the stream.
   * @param index
   * @return
   */
```

### JavadocDeclaration
`@param startOffset` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/PartitionLevelConsumer.java`
#### Snippet
```java
   * TODO Issue 5359 remove this API once external kafka consumers implements return of StreamPartitionMsgOffset
   * Fetch messages from the stream between the specified offsets
   * @param startOffset
   * @param endOffset
   * @param timeoutMillis
```

### JavadocDeclaration
`@param endOffset` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/PartitionLevelConsumer.java`
#### Snippet
```java
   * Fetch messages from the stream between the specified offsets
   * @param startOffset
   * @param endOffset
   * @param timeoutMillis
   * @return
```

### JavadocDeclaration
`@param timeoutMillis` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/PartitionLevelConsumer.java`
#### Snippet
```java
   * @param startOffset
   * @param endOffset
   * @param timeoutMillis
   * @return
   * @throws java.util.concurrent.TimeoutException
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/PartitionLevelConsumer.java`
#### Snippet
```java
   * @param endOffset
   * @param timeoutMillis
   * @return
   * @throws java.util.concurrent.TimeoutException
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/PartitionLevelConsumer.java`
#### Snippet
```java
   * @param timeoutMillis
   * @return
   * @throws java.util.concurrent.TimeoutException
   */
  @Deprecated
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/MessageBatch.java`
#### Snippet
```java
   * Returns the offset of the message at a particular index inside a set of messages returned from the stream.
   * @param index
   * @return
   */
  int getMessageOffsetAtIndex(int index);
```

### JavadocDeclaration
`@param index` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/MessageBatch.java`
#### Snippet
```java
  /**
   * Returns the offset of the next message.
   * @param index
   * @return
   */
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/MessageBatch.java`
#### Snippet
```java
   * Returns the offset of the next message.
   * @param index
   * @return
   */
  default StreamPartitionMsgOffset getNextStreamPartitionMsgOffsetAtIndex(int index) {
```

### JavadocDeclaration
`@param index` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/MessageBatch.java`
#### Snippet
```java
  /**
   * Returns the length of the message at a particular index inside a set of messages returned from the stream.
   * @param index
   * @return
   */
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/MessageBatch.java`
#### Snippet
```java
   * Returns the length of the message at a particular index inside a set of messages returned from the stream.
   * @param index
   * @return
   */
  int getMessageLengthAtIndex(int index);
```

### JavadocDeclaration
`@param index` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/MessageBatch.java`
#### Snippet
```java
  /**
   * Returns the message at a particular index inside a set of messages returned from the stream.
   * @param index
   * @return
   */
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/MessageBatch.java`
#### Snippet
```java
   * Returns the message at a particular index inside a set of messages returned from the stream.
   * @param index
   * @return
   */
  @Deprecated
```

### JavadocDeclaration
`@param index` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/MessageBatch.java`
#### Snippet
```java
  /**
   * Returns the offset of the next message.
   * @param index
   * @return
   */
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/MessageBatch.java`
#### Snippet
```java
   * Returns the offset of the next message.
   * @param index
   * @return
   */
  @Deprecated
```

### JavadocDeclaration
`@param topic` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/StreamDataServerStartable.java`
#### Snippet
```java
   * Create a data stream (e.g Kafka topic) in the server.
   *
   * @param topic
   * @param topicProps
   */
```

### JavadocDeclaration
`@param topicProps` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/StreamDataServerStartable.java`
#### Snippet
```java
   *
   * @param topic
   * @param topicProps
   */
  void createTopic(String topic, Properties topicProps);
```

### JavadocDeclaration
`@param props` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/StreamDataServerStartable.java`
#### Snippet
```java
   * Init the server.
   *
   * @param props
   */
  void init(Properties props);
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/StreamLevelConsumer.java`
#### Snippet
```java
  /**
   * Shutdown the stream consumer
   * @throws Exception
   */
  void shutdown()
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/StreamLevelConsumer.java`
#### Snippet
```java
  /**
   * Initialize and start the stream level consumer
   * @throws Exception
   */
  void start()
```

### JavadocDeclaration
`@param destination` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/StreamLevelConsumer.java`
#### Snippet
```java
  /**
   * Get next row from the stream and decode it into a generic row
   * @param destination
   * @return
   */
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/StreamLevelConsumer.java`
#### Snippet
```java
   * Get next row from the stream and decode it into a generic row
   * @param destination
   * @return
   */
  GenericRow next(GenericRow destination);
```

### JavadocDeclaration
`@param pluginName` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/plugin/PluginManager.java`
#### Snippet
```java
  /**
   * Creates an instance of className using classloader specific to the plugin
   * @param pluginName
   * @param className
   * @param <T>
```

### JavadocDeclaration
`@param className` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/plugin/PluginManager.java`
#### Snippet
```java
   * Creates an instance of className using classloader specific to the plugin
   * @param pluginName
   * @param className
   * @param <T>
   * @return
```

### JavadocDeclaration
`@param ` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/plugin/PluginManager.java`
#### Snippet
```java
   * @param pluginName
   * @param className
   * @param <T>
   * @return
   * @throws Exception
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/plugin/PluginManager.java`
#### Snippet
```java
   * @param className
   * @param <T>
   * @return
   * @throws Exception
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/plugin/PluginManager.java`
#### Snippet
```java
   * @param <T>
   * @return
   * @throws Exception
   */
  public <T> T createInstance(String pluginName, String className)
```

### JavadocDeclaration
`@param pluginName` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/plugin/PluginManager.java`
#### Snippet
```java
  /**
   * Loads a class using the plugin specific class loader
   * @param pluginName
   * @param className
   * @return
```

### JavadocDeclaration
`@param className` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/plugin/PluginManager.java`
#### Snippet
```java
   * Loads a class using the plugin specific class loader
   * @param pluginName
   * @param className
   * @return
   * @throws ClassNotFoundException
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/plugin/PluginManager.java`
#### Snippet
```java
   * @param pluginName
   * @param className
   * @return
   * @throws ClassNotFoundException
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/plugin/PluginManager.java`
#### Snippet
```java
   * @param className
   * @return
   * @throws ClassNotFoundException
   */
  public Class<?> loadClass(String pluginName, String className)
```

### JavadocDeclaration
`@param className` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/plugin/PluginManager.java`
#### Snippet
```java
   * <li>com.x.y.foo</li> loads the class in the default class path
   * <li>pluginName:com.x.y.foo</li> loads the class in plugin specific classloader
   * @param className
   * @return
   * @throws ClassNotFoundException
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/plugin/PluginManager.java`
#### Snippet
```java
   * <li>pluginName:com.x.y.foo</li> loads the class in plugin specific classloader
   * @param className
   * @return
   * @throws ClassNotFoundException
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/plugin/PluginManager.java`
#### Snippet
```java
   * @param className
   * @return
   * @throws ClassNotFoundException
   */
  public Class<?> loadClass(String className)
```

### JavadocDeclaration
`@param pluginsDirectories` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/plugin/PluginManager.java`
#### Snippet
```java
   * names. It will traverse the directories in order and produce a <String, File> map of plugins to be loaded.
   * If a plugin is found in multiple directories, only the first copy of it will be picked up.
   * @param pluginsDirectories
   * @param pluginsInclude
   * @return A hash map with key = plugin name, value = file object
```

### JavadocDeclaration
`@param pluginsInclude` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/plugin/PluginManager.java`
#### Snippet
```java
   * If a plugin is found in multiple directories, only the first copy of it will be picked up.
   * @param pluginsDirectories
   * @param pluginsInclude
   * @return A hash map with key = plugin name, value = file object
   */
```

### JavadocDeclaration
`@param pluginName` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/plugin/PluginManager.java`
#### Snippet
```java
  /**
   *
   * @param pluginName
   * @param className
   * @param argTypes
```

### JavadocDeclaration
`@param className` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/plugin/PluginManager.java`
#### Snippet
```java
   *
   * @param pluginName
   * @param className
   * @param argTypes
   * @param argValues
```

### JavadocDeclaration
`@param argTypes` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/plugin/PluginManager.java`
#### Snippet
```java
   * @param pluginName
   * @param className
   * @param argTypes
   * @param argValues
   * @param <T>
```

### JavadocDeclaration
`@param argValues` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/plugin/PluginManager.java`
#### Snippet
```java
   * @param className
   * @param argTypes
   * @param argValues
   * @param <T>
   * @return
```

### JavadocDeclaration
`@param ` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/plugin/PluginManager.java`
#### Snippet
```java
   * @param argTypes
   * @param argValues
   * @param <T>
   * @return
   */
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/plugin/PluginManager.java`
#### Snippet
```java
   * @param argValues
   * @param <T>
   * @return
   */
  public <T> T createInstance(String pluginName, String className, Class[] argTypes, Object[] argValues)
```

### JavadocDeclaration
`@param className` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/plugin/PluginManager.java`
#### Snippet
```java
   * <li>com.x.y.foo</li> loads the class in the default class path
   * <li>pluginName:com.x.y.foo</li> loads the class in plugin specific classloader
   * @param className
   * @return
   */
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/plugin/PluginManager.java`
#### Snippet
```java
   * <li>pluginName:com.x.y.foo</li> loads the class in plugin specific classloader
   * @param className
   * @return
   */
  public <T> T createInstance(String className, Class[] argTypes, Object[] argValues)
```

### JavadocDeclaration
`@param pluginName` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/plugin/PluginManager.java`
#### Snippet
```java
  /**
   * Loads jars recursively
   * @param pluginName
   * @param directory
   */
```

### JavadocDeclaration
`@param directory` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/plugin/PluginManager.java`
#### Snippet
```java
   * Loads jars recursively
   * @param pluginName
   * @param directory
   */
  public void load(String pluginName, File directory) {
```

### JavadocDeclaration
`@param className` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/plugin/PluginManager.java`
#### Snippet
```java
   * <li>com.x.y.foo</li> loads the class in the default class path
   * <li>pluginName:com.x.y.foo</li> loads the class in plugin specific classloader
   * @param className
   * @return
   */
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/plugin/PluginManager.java`
#### Snippet
```java
   * <li>pluginName:com.x.y.foo</li> loads the class in plugin specific classloader
   * @param className
   * @return
   */
  public <T> T createInstance(String className)
```

### JavadocDeclaration
`@param metadata` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/StreamMessageMetadata.java`
#### Snippet
```java
   * @param firstStreamRecordIngestionTimeMs the time that the message was ingested by the first stream provider
   *                         in the ingestion pipeline. use Long.MIN_VALUE if not applicable
   * @param metadata
   */
  public StreamMessageMetadata(long recordIngestionTimeMs, long firstStreamRecordIngestionTimeMs,
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/OffsetCriteria.java`
#### Snippet
```java
  /**
   * True if the offset criteria is defined as a timestamp string
   * @return
   */
  public boolean isTimestamp() {
```

### JavadocDeclaration
`@param customString` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/OffsetCriteria.java`
#### Snippet
```java
    /**
     * Builds an {@link OffsetCriteria} with {@link OffsetType} CUSTOM
     * @param customString
     * @return
     */
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/OffsetCriteria.java`
#### Snippet
```java
     * Builds an {@link OffsetCriteria} with {@link OffsetType} CUSTOM
     * @param customString
     * @return
     */
    public OffsetCriteria withOffsetCustom(String customString) {
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/OffsetCriteria.java`
#### Snippet
```java
  /**
   * Getter for offset string
   * @return
   */
  public String getOffsetString() {
```

### JavadocDeclaration
`@param periodString` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/OffsetCriteria.java`
#### Snippet
```java
    /**
     * Builds an {@link OffsetCriteria} with {@link OffsetType} PERIOD
     * @param periodString
     * @return
     */
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/OffsetCriteria.java`
#### Snippet
```java
     * Builds an {@link OffsetCriteria} with {@link OffsetType} PERIOD
     * @param periodString
     * @return
     */
    public OffsetCriteria withOffsetAsPeriod(String periodString) {
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/OffsetCriteria.java`
#### Snippet
```java
    /**
     * Builds an {@link OffsetCriteria} with {@link OffsetType} SMALLEST
     * @return
     */
    public OffsetCriteria withOffsetSmallest() {
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/OffsetCriteria.java`
#### Snippet
```java
  /**
   * True if the offset criteria is defined as a period string
   * @return
   */
  public boolean isPeriod() {
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/OffsetCriteria.java`
#### Snippet
```java
  /**
   * True if the offset criteria is defined to read from the largest known offset
   * @return
   */
  public boolean isLargest() {
```

### JavadocDeclaration
`@param timestamp` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/OffsetCriteria.java`
#### Snippet
```java
    /**
     * Builds an {@link OffsetCriteria} with {@link OffsetType} TIMESTAMP
     * @param timestamp
     * @return
     */
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/OffsetCriteria.java`
#### Snippet
```java
     * Builds an {@link OffsetCriteria} with {@link OffsetType} TIMESTAMP
     * @param timestamp
     * @return
     */
    public OffsetCriteria withOffsetAsTimestamp(String timestamp) {
```

### JavadocDeclaration
`@param offsetString` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/OffsetCriteria.java`
#### Snippet
```java
    /**
     * Builds an {@link OffsetCriteria} with the right {@link OffsetType} given the offset string
     * @param offsetString
     * @return
     */
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/OffsetCriteria.java`
#### Snippet
```java
     * Builds an {@link OffsetCriteria} with the right {@link OffsetType} given the offset string
     * @param offsetString
     * @return
     */
    public OffsetCriteria withOffsetString(String offsetString) {
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/OffsetCriteria.java`
#### Snippet
```java
  /**
   * True if the offset criteria is defined as a custom format string
   * @return
   */
  public boolean isCustom() {
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/OffsetCriteria.java`
#### Snippet
```java
  /**
   * True if the offset criteria is defined to read from smallest available offset
   * @return
   */
  public boolean isSmallest() {
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/OffsetCriteria.java`
#### Snippet
```java
    /**
     * Builds an {@link OffsetCriteria} with {@link OffsetType} LARGEST
     * @return
     */
    public OffsetCriteria withOffsetLargest() {
```

### JavadocDeclaration
`@param controllerURI` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/ingestion/batch/spec/PinotClusterSpec.java`
#### Snippet
```java
   * E.g. http://localhost:9000
   *
   * @param controllerURI
   */
  public void setControllerURI(String controllerURI) {
```

### JavadocDeclaration
`@param className` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/ingestion/batch/spec/RecordReaderSpec.java`
#### Snippet
```java
   *    org.apache.pinot.plugin.inputformat.thrift.ThriftRecordReader
   *
   * @param className
   */
  public void setClassName(String className) {
```

### JavadocDeclaration
`@param configs` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/ingestion/batch/spec/RecordReaderSpec.java`
#### Snippet
```java
   * Used to init RecordReaderConfig class name, this config is required for CSV and Thrift data format.
   *
   * @param configs
   */
  public void setConfigs(Map<String, String> configs) {
```

### JavadocDeclaration
`@param dataFormat` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/ingestion/batch/spec/RecordReaderSpec.java`
#### Snippet
```java
  /**
   * Record data format, e.g. 'avro', 'parquet', 'orc', 'csv', 'json', 'thrift' etc.
   * @param dataFormat
   */
  public void setDataFormat(String dataFormat) {
```

### JavadocDeclaration
`@param configClassName` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/ingestion/batch/spec/RecordReaderSpec.java`
#### Snippet
```java
   *    org.apache.pinot.plugin.inputformat.thrift.ThriftRecordReaderConfig
   *
   * @param configClassName
   */
  public void setConfigClassName(String configClassName) {
```

### JavadocDeclaration
`@param className` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/ingestion/batch/spec/PinotFSSpec.java`
#### Snippet
```java
   *    org.apache.pinot.plugin.filesystem.HadoopPinotFS is used for HDFS
   *
   * @param className
   */
  public void setClassName(String className) {
```

### JavadocDeclaration
`@param scheme` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/ingestion/batch/spec/PinotFSSpec.java`
#### Snippet
```java
   * E.g. local, hdfs, dbfs, etc
   *
   * @param scheme
   */
  public void setScheme(String scheme) {
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/ingestion/batch/runner/IngestionJobRunner.java`
#### Snippet
```java
   * Run IngestionJobRunner
   *
   * @throws Exception
   */
  void run()
```

### JavadocDeclaration
`@param jobSpec` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/ingestion/batch/runner/IngestionJobRunner.java`
#### Snippet
```java
   * Initialize IngestionJobRunner with SegmentGenerationJobSpec
   *
   * @param jobSpec
   */
  void init(SegmentGenerationJobSpec jobSpec);
```

### JavadocDeclaration
`@param includeFileNamePattern` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/ingestion/batch/spec/SegmentGenerationJobSpec.java`
#### Snippet
```java
   *    'glob:**\/*.avro' will include all the avro files under inputDirURI recursively.
   *
   * @param includeFileNamePattern
   */
  public void setIncludeFileNamePattern(String includeFileNamePattern) {
```

### JavadocDeclaration
`@param excludeFileNamePattern` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/ingestion/batch/spec/SegmentGenerationJobSpec.java`
#### Snippet
```java
   *    'glob:**\/*.avro' will exclude all the avro files under inputDirURI recursively.
   *
   * @param excludeFileNamePattern
   */
  public void setExcludeFileNamePattern(String excludeFileNamePattern) {
```

### JavadocDeclaration
`@param segmentUriSuffix` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/ingestion/batch/spec/PushJobSpec.java`
#### Snippet
```java
   * Used in SegmentUriPushJobRunner, which is used to composite the segment uri to send to pinot controller.
   * The URI sends to controller is in the format ${segmentUriPrefix}${segmentPath}${segmentUriSuffix}
   * @param segmentUriSuffix
   */
  public void setSegmentUriSuffix(String segmentUriSuffix) {
```

### JavadocDeclaration
`@param pushRetryIntervalMillis` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/ingestion/batch/spec/PushJobSpec.java`
#### Snippet
```java
  /**
   * retry wait Ms, default to 1 second.
   * @param pushRetryIntervalMillis
   */
  public void setPushRetryIntervalMillis(long pushRetryIntervalMillis) {
```

### JavadocDeclaration
`@param pushAttempts` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/ingestion/batch/spec/PushJobSpec.java`
#### Snippet
```java
  /**
   * number of attempts for push job, default is 1, which means no retry.
   * @param pushAttempts
   */
  public void setPushAttempts(int pushAttempts) {
```

### JavadocDeclaration
`@param segmentUriPrefix` tag description is missing
in `pinot-spi/src/main/java/org/apache/pinot/spi/ingestion/batch/spec/PushJobSpec.java`
#### Snippet
```java
   * Used in SegmentUriPushJobRunner, which is used to composite the segment uri to send to pinot controller.
   * The URI sends to controller is in the format ${segmentUriPrefix}${segmentPath}${segmentUriSuffix}
   * @param segmentUriPrefix
   */
  public void setSegmentUriPrefix(String segmentUriPrefix) {
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-plugins/pinot-minion-tasks/pinot-minion-builtin-tasks/src/main/java/org/apache/pinot/plugin/minion/tasks/BaseMultipleSegmentsConversionExecutor.java`
#### Snippet
```java
   * @param workingDir Working directory for the converted segment
   * @return a list of segment conversion result
   * @throws Exception
   */
  protected abstract List<SegmentConversionResult> convert(PinotTaskConfig pinotTaskConfig, List<File> segmentDirs,
```

### JavadocDeclaration
`@param tableName` tag description is missing
in `pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/UpdatableBrokerCache.java`
#### Snippet
```java
  /**
   * Method to get one random broker for a given table
   * @param tableName
   * @return Broker address corresponding to the table
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/UpdatableBrokerCache.java`
#### Snippet
```java
  /**
   * Initializes the cache
   * @throws Exception
   */
  void init()
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/UpdatableBrokerCache.java`
#### Snippet
```java
  /**
   * Manually trigger a cache refresh
   * @throws Exception
   */
  void triggerBrokerCacheUpdate()
```

### JavadocDeclaration
`@param properties` tag description is missing
in `pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/ConnectionFactory.java`
#### Snippet
```java

  /**
   * @param properties
   * @param controllerUrl url host:port of the controller
   * @return A connection that connects to brokers as per the given controller
```

### JavadocDeclaration
`@param groupKeyColumnIndex` tag description is missing
in `pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/ResultSet.java`
#### Snippet
```java
  /**
   * Get the group key name for the given key column index. use getGroupKeyLength() to know the number of groupKey
   * @param groupKeyColumnIndex
   * @return group key column name
   */
```

### JavadocDeclaration
`@param table` tag description is missing
in `pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/BrokerSelector.java`
#### Snippet
```java
  /**
   * Returns the broker address in the form host:port
   * @param table
   * @return
   */
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/BrokerSelector.java`
#### Snippet
```java
   * Returns the broker address in the form host:port
   * @param table
   * @return
   */
  String selectBroker(String table);
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-plugins/pinot-file-system/pinot-adls/src/main/java/org/apache/pinot/plugin/filesystem/AzurePinotFSUtil.java`
#### Snippet
```java
   * @param uri a uri path
   * @return url encoded path in Azure Data Lake Gen2 format
   * @throws IOException
   */
  public static String convertUriToUrlEncodedAzureStylePath(URI uri)
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-plugins/pinot-file-system/pinot-adls/src/main/java/org/apache/pinot/plugin/filesystem/AzurePinotFSUtil.java`
#### Snippet
```java
   * @param uri a uri path
   * @return path in Azure Data Lake Gen2 format
   * @throws IOException
   */
  public static String convertUriToAzureStylePath(URI uri)
```

### JavadocDeclaration
`@param streamConfig` tag description is missing
in `pinot-plugins/pinot-stream-ingestion/pinot-kafka-2.0/src/main/java/org/apache/pinot/plugin/stream/kafka20/KafkaPartitionLevelStreamConfig.java`
#### Snippet
```java
  /**
   * Builds a wrapper around {@link StreamConfig} to fetch kafka partition level consumer related configs
   * @param streamConfig
   */
  public KafkaPartitionLevelStreamConfig(StreamConfig streamConfig) {
```

### JavadocDeclaration
`@param streamConfig` tag description is missing
in `pinot-plugins/pinot-stream-ingestion/pinot-kafka-2.0/src/main/java/org/apache/pinot/plugin/stream/kafka20/KafkaStreamLevelStreamConfig.java`
#### Snippet
```java
  /**
   * Builds a wrapper around {@link StreamConfig} to fetch kafka stream level consumer specific configs
   * @param streamConfig
   * @param tableName
   * @param groupId
```

### JavadocDeclaration
`@param tableName` tag description is missing
in `pinot-plugins/pinot-stream-ingestion/pinot-kafka-2.0/src/main/java/org/apache/pinot/plugin/stream/kafka20/KafkaStreamLevelStreamConfig.java`
#### Snippet
```java
   * Builds a wrapper around {@link StreamConfig} to fetch kafka stream level consumer specific configs
   * @param streamConfig
   * @param tableName
   * @param groupId
   */
```

### JavadocDeclaration
`@param groupId` tag description is missing
in `pinot-plugins/pinot-stream-ingestion/pinot-kafka-2.0/src/main/java/org/apache/pinot/plugin/stream/kafka20/KafkaStreamLevelStreamConfig.java`
#### Snippet
```java
   * @param streamConfig
   * @param tableName
   * @param groupId
   */
  public KafkaStreamLevelStreamConfig(StreamConfig streamConfig, String tableName, String groupId) {
```

### JavadocDeclaration
`@param property` tag description is missing
in `pinot-plugins/pinot-stream-ingestion/pinot-kafka-base/src/main/java/org/apache/pinot/plugin/stream/kafka/KafkaStreamConfigProperties.java`
#### Snippet
```java
  /**
   * Helper method to create a property string for kafka stream
   * @param property
   * @return
   */
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-plugins/pinot-stream-ingestion/pinot-kafka-base/src/main/java/org/apache/pinot/plugin/stream/kafka/KafkaStreamConfigProperties.java`
#### Snippet
```java
   * Helper method to create a property string for kafka stream
   * @param property
   * @return
   */
  public static String constructStreamProperty(String property) {
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/sql/parsers/dml/DataManipulationStatement.java`
#### Snippet
```java
  /**
   * The method to execute this Statement, e.g. MINION or HTTP.
   * @return
   */
  ExecutionType getExecutionType();
```

### JavadocDeclaration
`@param expression` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/sql/parsers/rewriter/PredicateComparisonRewriter.java`
#### Snippet
```java
   * Rewrites a function expression.
   *
   * @param expression
   * @return re-written expression
   */
```

### JavadocDeclaration
`@param expressions` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/sql/parsers/CalciteSqlParser.java`
#### Snippet
```java
   * Extract all the identifiers from given expressions.
   *
   * @param expressions
   * @param excludeAs if true, ignores the right side identifier for AS function.
   * @return all the identifier names.
```

### JavadocDeclaration
Tag `return` is not allowed here
in `pinot-plugins/pinot-file-system/pinot-adls/src/main/java/org/apache/pinot/plugin/filesystem/ADLSGen2PinotFS.java`
#### Snippet
```java
   * @param srcFile location of the file locally
   * @param dstUri location to move the file to.
   * @return nothing.
   */
  @Override
```

### JavadocDeclaration
Tag `return` is not allowed here
in `pinot-plugins/pinot-file-system/pinot-adls/src/main/java/org/apache/pinot/plugin/filesystem/ADLSGen2PinotFS.java`
#### Snippet
```java
   * @param srcUri location of the file.
   * @param dstFile location to move the file to.
   * @return nothing.
   */
  @Override
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-plugins/pinot-file-system/pinot-adls/src/main/java/org/apache/pinot/plugin/filesystem/ADLSGen2PinotFS.java`
#### Snippet
```java
   * @param file input file
   * @return byte array of md5 hash
   * @throws Exception
   */
  private byte[] computeContentMd5(File file)
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUtils.java`
#### Snippet
```java
   * doesn't already have them in a collection.
   * @param closeables one or more resources to close
   * @throws IOException
   */
  public static void close(Closeable... closeables)
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUtils.java`
#### Snippet
```java
   * subsequent resources.
   * @param closeables collection of resources to close
   * @throws IOException
   */
  public static void close(Iterable<? extends Closeable> closeables)
```

### JavadocDeclaration
`@param srcFile` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUtils.java`
#### Snippet
```java
  /**
   * Deletes the destination file if it exists then calls org.apache.commons moveFile.
   * @param srcFile
   * @param destFile
   */
```

### JavadocDeclaration
`@param destFile` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUtils.java`
#### Snippet
```java
   * Deletes the destination file if it exists then calls org.apache.commons moveFile.
   * @param srcFile
   * @param destFile
   */
  public static void moveFileWithOverwrite(File srcFile, File destFile)
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUtils.java`
#### Snippet
```java
   * @param count Number of bytes to transfer
   * @param dest Destination file channel
   * @throws IOException
   */
  public static void transferBytes(FileChannel src, long position, long count, FileChannel dest)
```

### JavadocDeclaration
`@param loggerName` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/LoggerUtils.java`
#### Snippet
```java
  /**
   * Set logger level at runtime.
   * @param loggerName
   * @param logLevel
   * @return logger info
```

### JavadocDeclaration
`@param logLevel` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/LoggerUtils.java`
#### Snippet
```java
   * Set logger level at runtime.
   * @param loggerName
   * @param logLevel
   * @return logger info
   */
```

### JavadocDeclaration
`@param loggerName` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/LoggerUtils.java`
#### Snippet
```java
  /**
   * Fetch logger info of name, level and filter.
   * @param loggerName
   * @return logger info
   */
```

### JavadocDeclaration
`@param partitionRange` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/HLCSegmentName.java`
#### Snippet
```java
   * @param groupId is like myTable_REALTIME_1442428556382_0 (where 1442428556382 is the time when the group was created
   *                or it is line myTable
   * @param partitionRange
   * @param sequenceNumber
   */
```

### JavadocDeclaration
`@param sequenceNumber` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/HLCSegmentName.java`
#### Snippet
```java
   *                or it is line myTable
   * @param partitionRange
   * @param sequenceNumber
   */
  public HLCSegmentName(String groupId, String partitionRange, String sequenceNumber) {
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @param rawTableName Raw table name
   * @return Response
   * @throws IOException
   * @throws HttpErrorStatusException
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @return Response
   * @throws IOException
   * @throws HttpErrorStatusException
   */
  public SimpleHttpResponse uploadSegment(URI uri, String segmentName, InputStream inputStream, String rawTableName)
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @param parameters HTTP parameters
   * @return Response
   * @throws IOException
   * @throws HttpErrorStatusException
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @return Response
   * @throws IOException
   * @throws HttpErrorStatusException
   */
  public SimpleHttpResponse updateSchema(URI uri, String schemaName, File schemaFile, @Nullable List<Header> headers,
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @param schemaFile Schema file
   * @return Response
   * @throws IOException
   * @throws HttpErrorStatusException
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @return Response
   * @throws IOException
   * @throws HttpErrorStatusException
   */
  @Deprecated
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @param uri The uri to ask servers to upload segment to segment store
   * @return the uploaded segment download url from segment store
   * @throws URISyntaxException
   * @throws IOException
   * @throws HttpErrorStatusException
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @return the uploaded segment download url from segment store
   * @throws URISyntaxException
   * @throws IOException
   * @throws HttpErrorStatusException
   *
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @param allowRefresh whether to refresh a segment if it already exists
   * @return Response
   * @throws IOException
   * @throws HttpErrorStatusException
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @return Response
   * @throws IOException
   * @throws HttpErrorStatusException
   */
  public SimpleHttpResponse uploadSegment(URI uri, String segmentName, File segmentFile, String tableName,
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @param dest File destination
   * @return Response status code
   * @throws IOException
   * @throws HttpErrorStatusException
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @return Response status code
   * @throws IOException
   * @throws HttpErrorStatusException
   */
  @Deprecated
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @param socketTimeoutMs Socket timeout in milliseconds
   * @return Response
   * @throws IOException
   * @throws HttpErrorStatusException
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @return Response
   * @throws IOException
   * @throws HttpErrorStatusException
   */
  public SimpleHttpResponse sendSegmentUri(URI uri, String downloadUri, @Nullable List<Header> headers,
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @param authProvider auth provider
   * @return Response status code
   * @throws IOException
   * @throws HttpErrorStatusException
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @return Response status code
   * @throws IOException
   * @throws HttpErrorStatusException
   */
  public int downloadFile(URI uri, File dest, AuthProvider authProvider)
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @param socketTimeoutMs Socket timeout in milliseconds
   * @return Response
   * @throws IOException
   * @throws HttpErrorStatusException
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @return Response
   * @throws IOException
   * @throws HttpErrorStatusException
   */
  @Deprecated
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @param schemaFile Schema file
   * @return Response
   * @throws IOException
   * @throws HttpErrorStatusException
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @return Response
   * @throws IOException
   * @throws HttpErrorStatusException
   */
  @Deprecated
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @param jsonString Segment json string
   * @return Response
   * @throws IOException
   * @throws HttpErrorStatusException
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @return Response
   * @throws IOException
   * @throws HttpErrorStatusException
   */
  @Deprecated
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @param parameters HTTP parameters
   * @return Response
   * @throws IOException
   * @throws HttpErrorStatusException
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @return Response
   * @throws IOException
   * @throws HttpErrorStatusException
   */
  public SimpleHttpResponse addSchema(URI uri, String schemaName, File schemaFile, @Nullable List<Header> headers,
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   *                  -1 for no disk write limit, 0 for limit the writing to min(untar, download) rate
   * @return Response status code
   * @throws IOException
   * @throws HttpErrorStatusException
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @return Response status code
   * @throws IOException
   * @throws HttpErrorStatusException
   */
  public File downloadUntarFileStreamed(URI uri, File dest, AuthProvider authProvider, List<Header> httpHeaders,
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @param uri URI
   * @return Response
   * @throws IOException
   * @throws HttpErrorStatusException
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @return Response
   * @throws IOException
   * @throws HttpErrorStatusException
   */
  public SimpleHttpResponse revertReplaceSegments(URI uri)
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @param socketTimeoutMs Socket timeout in milliseconds
   * @return Response
   * @throws IOException
   * @throws HttpErrorStatusException
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @return Response
   * @throws IOException
   * @throws HttpErrorStatusException
   */
  public SimpleHttpResponse uploadSegmentMetadata(URI uri, String segmentName, File segmentMetadataFile,
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @param socketTimeoutMs Socket timeout in milliseconds
   * @return Response
   * @throws IOException
   * @throws HttpErrorStatusException
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @return Response
   * @throws IOException
   * @throws HttpErrorStatusException
   */
  public SimpleHttpResponse sendSegmentCompletionProtocolRequest(URI uri, @Nullable List<Header> headers,
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @param socketTimeoutMs Socket timeout in milliseconds
   * @return Response
   * @throws IOException
   * @throws HttpErrorStatusException
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @return Response
   * @throws IOException
   * @throws HttpErrorStatusException
   */
  public SimpleHttpResponse uploadSegment(URI uri, String segmentName, File segmentFile, @Nullable List<Header> headers,
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @param tableType Table type
   * @return Response
   * @throws IOException
   * @throws HttpErrorStatusException
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @return Response
   * @throws IOException
   * @throws HttpErrorStatusException
   */
  public SimpleHttpResponse uploadSegment(URI uri, String segmentName, InputStream inputStream,
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @param authProvider auth provider
   * @return Response
   * @throws IOException
   * @throws HttpErrorStatusException
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @return Response
   * @throws IOException
   * @throws HttpErrorStatusException
   */
  public SimpleHttpResponse startReplaceSegments(URI uri, StartReplaceSegmentsRequest startReplaceSegmentsRequest,
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @param socketTimeoutMs Socket timeout in milliseconds
   * @return Response
   * @throws IOException
   * @throws HttpErrorStatusException
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @return Response
   * @throws IOException
   * @throws HttpErrorStatusException
   */
  public SimpleHttpResponse sendSegmentJson(URI uri, String jsonString, @Nullable List<Header> headers,
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @param tableType Table type
   * @return Response
   * @throws IOException
   * @throws HttpErrorStatusException
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @return Response
   * @throws IOException
   * @throws HttpErrorStatusException
   */
  public SimpleHttpResponse uploadSegment(URI uri, String segmentName, File segmentFile, String tableName,
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @param socketTimeoutMs Socket timeout in milliseconds
   * @return Response
   * @throws IOException
   * @throws HttpErrorStatusException
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @return Response
   * @throws IOException
   * @throws HttpErrorStatusException
   */
  public SimpleHttpResponse uploadSegment(URI uri, String segmentName, InputStream inputStream,
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @param httpHeaders http headers
   * @return Response status code
   * @throws IOException
   * @throws HttpErrorStatusException
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @return Response status code
   * @throws IOException
   * @throws HttpErrorStatusException
   */
  public int downloadFile(URI uri, File dest, AuthProvider authProvider, List<Header> httpHeaders)
```

### JavadocDeclaration
Wrong tag `oaram`
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   *
   * @param uri URI
   * @oaram socketTimeoutMs Socket timeout in milliseconds
   * @param authProvider auth provider
   * @return Response
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @param authProvider auth provider
   * @return Response
   * @throws IOException
   * @throws HttpErrorStatusException
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @return Response
   * @throws IOException
   * @throws HttpErrorStatusException
   */
  public SimpleHttpResponse endReplaceSegments(URI uri, int socketTimeoutMs, @Nullable
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @param dest File destination
   * @return Response status code
   * @throws IOException
   * @throws HttpErrorStatusException
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @return Response status code
   * @throws IOException
   * @throws HttpErrorStatusException
   */
  @Deprecated
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @param rawTableName Raw table name
   * @return Response
   * @throws IOException
   * @throws HttpErrorStatusException
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @return Response
   * @throws IOException
   * @throws HttpErrorStatusException
   */
  @Deprecated
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @param tableName Table name with or without type suffix
   * @return Response
   * @throws IOException
   * @throws HttpErrorStatusException
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * @return Response
   * @throws IOException
   * @throws HttpErrorStatusException
   */
  @Deprecated
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/http/HttpClient.java`
#### Snippet
```java
   *                  -1 for no disk write limit, 0 for limit the writing to min(untar, download) rate
   * @return The untarred directory
   * @throws IOException
   * @throws HttpErrorStatusException
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/http/HttpClient.java`
#### Snippet
```java
   * @return The untarred directory
   * @throws IOException
   * @throws HttpErrorStatusException
   */
  public File downloadUntarFileStreamed(URI uri, int socketTimeoutMs, File dest, AuthProvider authProvider,
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/http/HttpClient.java`
#### Snippet
```java
   * @param httpHeaders http headers
   * @return Response status code
   * @throws IOException
   * @throws HttpErrorStatusException
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/http/HttpClient.java`
#### Snippet
```java
   * @return Response status code
   * @throws IOException
   * @throws HttpErrorStatusException
   */
  public int downloadFile(URI uri, int socketTimeoutMs, File dest, AuthProvider authProvider, List<Header> httpHeaders)
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/utils/fetcher/SegmentFetcherFactory.java`
#### Snippet
```java
   *                  -1 for no disk write limit, 0 for limit the writing to min(untar, download) rate
   * @return the untared directory
   * @throws Exception
   */
  public static File fetchAndStreamUntarToLocal(String uri, File tempRootDir, long maxStreamRateInByte)
```

### JavadocDeclaration
`@param customMap` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/lineage/SegmentLineage.java`
#### Snippet
```java
  /**
   * Set custom map
   * @param customMap
   */
  public void setCustomMap(Map<String, String> customMap) {
```

### JavadocDeclaration
`@param uriStr` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/segment/generation/SegmentGenerationUtils.java`
#### Snippet
```java
   * Convert a File URI String to URI Object, use parent URI scheme/userInfo/host/port if sheme is not specified.
   *
   * @param uriStr
   * @param fullUriForPathOnlyUriStr
   * @return
```

### JavadocDeclaration
`@param fullUriForPathOnlyUriStr` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/segment/generation/SegmentGenerationUtils.java`
#### Snippet
```java
   *
   * @param uriStr
   * @param fullUriForPathOnlyUriStr
   * @return
   * @throws URISyntaxException
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/segment/generation/SegmentGenerationUtils.java`
#### Snippet
```java
   * @param uriStr
   * @param fullUriForPathOnlyUriStr
   * @return
   * @throws URISyntaxException
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/segment/generation/SegmentGenerationUtils.java`
#### Snippet
```java
   * @param fullUriForPathOnlyUriStr
   * @return
   * @throws URISyntaxException
   */
  public static URI getFileURI(String uriStr, URI fullUriForPathOnlyUriStr)
```

### JavadocDeclaration
`@param uriStr` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/segment/generation/SegmentGenerationUtils.java`
#### Snippet
```java
   * Convert Directory URI String to URI Object, default to local file system scheme.
   *
   * @param uriStr
   * @return
   * @throws URISyntaxException
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/segment/generation/SegmentGenerationUtils.java`
#### Snippet
```java
   *
   * @param uriStr
   * @return
   * @throws URISyntaxException
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/segment/generation/SegmentGenerationUtils.java`
#### Snippet
```java
   * @param uriStr
   * @return
   * @throws URISyntaxException
   */
  public static URI getDirectoryURI(String uriStr)
```

### JavadocDeclaration
`@param inputFileURI` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/segment/generation/SegmentGenerationUtils.java`
#### Snippet
```java
   * Extract file name from a given URI.
   *
   * @param inputFileURI
   * @return
   */
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/segment/generation/SegmentGenerationUtils.java`
#### Snippet
```java
   *
   * @param inputFileURI
   * @return
   */
  public static String getFileName(URI inputFileURI) {
```

### JavadocDeclaration
Wrong tag `ScalarFunction`
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/HashFunctions.java`
#### Snippet
```java
 * Inbuilt Hash Transformation Functions
 * The functions can be used as UDFs in Query when added in the FunctionRegistry.
 * @ScalarFunction annotation is used with each method for the registration
 *
 * Example usage:
```

### JavadocDeclaration
`@param input` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
  /**
   * @see StringUtils#reverse(String)
   * @param input
   * @return reversed input in from end to start
   */
```

### JavadocDeclaration
`@param input` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
  /**
   * @see StringUtils#startsWith(CharSequence, CharSequence)
   * @param input
   * @param prefix substring to check if it is the prefix
   * @return true if string starts with prefix, false o.w.
```

### JavadocDeclaration
`@param input` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
  /**
   * @see StringUtils#endsWith(CharSequence, CharSequence)
   * @param input
   * @param suffix substring to check if it is the prefix
   * @return true if string ends with prefix, false o.w.
```

### JavadocDeclaration
`@param input` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java

  /**
   * @param input
   * @param charsetName encoding
   * @return bytearray to string
```

### JavadocDeclaration
`@param input` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
  /**
   * @see StringUtils#right(String, int)
   * @param input
   * @return get substring ending at the last index with specified length
   */
```

### JavadocDeclaration
`@param input` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java

  /**
   * @param input
   * @return trim spaces from right side of the string
   */
```

### JavadocDeclaration
`@param input` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java

  /**
   * @param input
   * @param delimiter
   * @param limit
```

### JavadocDeclaration
`@param delimiter` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
  /**
   * @param input
   * @param delimiter
   * @param limit
   * @return splits string on specified delimiter limiting the number of results till the specified limit
```

### JavadocDeclaration
`@param limit` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
   * @param input
   * @param delimiter
   * @param limit
   * @return splits string on specified delimiter limiting the number of results till the specified limit
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
   * @param input url encoded string
   * @return plaintext string
   * @throws UnsupportedEncodingException
   */
  @ScalarFunction
```

### JavadocDeclaration
`@param input` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
  /**
   * @see StringUtils#repeat(char, int)
   * @param input
   * @param times
   * @return concatenate the string to itself specified number of times
```

### JavadocDeclaration
`@param times` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
   * @see StringUtils#repeat(char, int)
   * @param input
   * @param times
   * @return concatenate the string to itself specified number of times
   */
```

### JavadocDeclaration
`@param input` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
  /**
   * @see String#trim()
   * @param input
   * @return trim spaces from both ends of the string
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
   * @param input plaintext string
   * @return url encoded string
   * @throws UnsupportedEncodingException
   */
  @ScalarFunction
```

### JavadocDeclaration
`@param input` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
  /**
   * @see StringUtils#remove(String, String)
   * @param input
   * @param search
   * @return removes all instances of search from string
```

### JavadocDeclaration
`@param search` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
   * @see StringUtils#remove(String, String)
   * @param input
   * @param search
   * @return removes all instances of search from string
   */
```

### JavadocDeclaration
`@param input` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
  /**
   * @see StringUtils#leftPad(String, int, char)
   * @param input
   * @param size final size of the string
   * @param pad pad string to be used
```

### JavadocDeclaration
`@param input` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
  /**
   * @see StandardCharsets#UTF_8#encode(String)
   * @param input
   * @return bytes
   */
```

### JavadocDeclaration
Wrong tag `ScalarFunction`
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
 * Inbuilt String Transformation Functions
 * The functions can be used as UDFs in Query when added in the FunctionRegistry.
 * @ScalarFunction annotation is used with each method for the registration
 *
 * Example usage:
```

### JavadocDeclaration
`@param input` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
  /**
   * @see String#length()
   * @param input
   * @return length of the string
   */
```

### JavadocDeclaration
`@param timestamp` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/DateTimeFunctions.java`
#### Snippet
```java
   * @param unit the timeunit of the period to add. e.g. milliseconds, seconds, days, year
   * @param interval value of the period to add.
   * @param timestamp
   * @return
   */
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/DateTimeFunctions.java`
#### Snippet
```java
   * @param interval value of the period to add.
   * @param timestamp
   * @return
   */
  @ScalarFunction(names = {"timestampAdd", "dateAdd"})
```

### JavadocDeclaration
`@param unit` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/DateTimeFunctions.java`
#### Snippet
```java
   * Get difference between two timestamps and return the result in the specified timeunit.
   * e.g. timestampDiff('days', ago('10D'), ago('2D')) will return 8 i.e. 8 days
   * @param unit
   * @param timestamp1
   * @param timestamp2
```

### JavadocDeclaration
`@param timestamp1` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/DateTimeFunctions.java`
#### Snippet
```java
   * e.g. timestampDiff('days', ago('10D'), ago('2D')) will return 8 i.e. 8 days
   * @param unit
   * @param timestamp1
   * @param timestamp2
   * @return
```

### JavadocDeclaration
`@param timestamp2` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/DateTimeFunctions.java`
#### Snippet
```java
   * @param unit
   * @param timestamp1
   * @param timestamp2
   * @return
   */
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/DateTimeFunctions.java`
#### Snippet
```java
   * @param timestamp1
   * @param timestamp2
   * @return
   */
  @ScalarFunction(names = {"timestampDiff", "dateDiff"})
```

### JavadocDeclaration
`@param input` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
  /**
   * @see StringUtils#rightPad(String, int, char)
   * @param input
   * @param size final size of the string
   * @param pad pad string to be used
```

### JavadocDeclaration
`@param input` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
  /**
   * @see String#codePointAt(int)
   * @param input
   * @return the Unicode codepoint of the first character of the string
   */
```

### JavadocDeclaration
`@param bytes` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java

  /**
   * @param bytes
   * @param charsetName encoding
   * @return bytearray to string
```

### JavadocDeclaration
`@param input` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
   * @see StringUtils#ordinalIndexOf(CharSequence, CharSequence, int)
   * Return the Nth occurence of a substring within the String
   * @param input
   * @param find substring to find
   * @param instance Integer denoting the instance no.
```

### JavadocDeclaration
`@param codepoint` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
  /**
   * @see Character#toChars(int)
   * @param codepoint
   * @return the character corresponding to the Unicode codepoint
   */
```

### JavadocDeclaration
`@param input` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
  /**
   * TODO: Revisit if index should be one-based (both Presto and Postgres use one-based index, which starts with 1)
   * @param input
   * @param delimiter
   * @param index
```

### JavadocDeclaration
`@param delimiter` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
   * TODO: Revisit if index should be one-based (both Presto and Postgres use one-based index, which starts with 1)
   * @param input
   * @param delimiter
   * @param index
   * @return splits string on specified delimiter and returns String at specified index from the split.
```

### JavadocDeclaration
`@param index` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
   * @param input
   * @param delimiter
   * @param index
   * @return splits string on specified delimiter and returns String at specified index from the split.
   */
```

### JavadocDeclaration
`@param input` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
  /**
   * @see Normalizer#normalize(CharSequence, Normalizer.Form)
   * @param input
   * @return transforms string with NFC normalization form.
   */
```

### JavadocDeclaration
`@param input` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
  /**
   * @see StandardCharsets#US_ASCII#encode(String)
   * @param input
   * @return bytes
   */
```

### JavadocDeclaration
`@param input` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
  /**
   * @see String#contains(CharSequence)
   * @param input
   * @param substring
   * @return returns true if substring present in main string else false.
```

### JavadocDeclaration
`@param substring` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
   * @see String#contains(CharSequence)
   * @param input
   * @param substring
   * @return returns true if substring present in main string else false.
   */
```

### JavadocDeclaration
`@param input` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
  /**
   * @see StringUtils#repeat(String, String, int)
   * @param input
   * @param times
   * @return concatenate the string to itself specified number of times with specified seperator
```

### JavadocDeclaration
`@param times` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
   * @see StringUtils#repeat(String, String, int)
   * @param input
   * @param times
   * @return concatenate the string to itself specified number of times with specified seperator
   */
```

### JavadocDeclaration
`@param input` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
  /**
   * @see String#replaceAll(String, String)
   * @param input
   * @param find target substring to replace
   * @param substitute new substring to be replaced with target
```

### JavadocDeclaration
`@param value` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
  /**
   * @see #StringFunctions#regexpExtract(String, String, int, String)
   * @param value
   * @param regexp
   * @param group
```

### JavadocDeclaration
`@param regexp` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
   * @see #StringFunctions#regexpExtract(String, String, int, String)
   * @param value
   * @param regexp
   * @param group
   * @return the matched result.
```

### JavadocDeclaration
`@param group` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
   * @param value
   * @param regexp
   * @param group
   * @return the matched result.
   */
```

### JavadocDeclaration
`@param input1` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
  /**
   * Join two input string with no seperator in between
   * @param input1
   * @param input2
   * @return The two input strings joined
```

### JavadocDeclaration
`@param input2` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
   * Join two input string with no seperator in between
   * @param input1
   * @param input2
   * @return The two input strings joined
   */
```

### JavadocDeclaration
`@param value` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
  /**
   * @see #StringFunctions#regexpExtract(String, String, int, String)
   * @param value
   * @param regexp
   * @return the matched result.
```

### JavadocDeclaration
`@param regexp` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
   * @see #StringFunctions#regexpExtract(String, String, int, String)
   * @param value
   * @param regexp
   * @return the matched result.
   */
```

### JavadocDeclaration
`@param input` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
  /**
   * @see StringUtils#left(String, int)
   * @param input
   * @return get substring starting from the first index and extending upto specified length.
   */
```

### JavadocDeclaration
`@param input1` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
  /**
   * Join two input string with seperator in between
   * @param input1
   * @param input2
   * @param seperator
```

### JavadocDeclaration
`@param input2` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
   * Join two input string with seperator in between
   * @param input1
   * @param input2
   * @param seperator
   * @return The two input strings joined by the seperator
```

### JavadocDeclaration
`@param seperator` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
   * @param input1
   * @param input2
   * @param seperator
   * @return The two input strings joined by the seperator
   */
```

### JavadocDeclaration
`@param input` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
  /**
   * @see Normalizer#normalize(CharSequence, Normalizer.Form)
   * @param input
   * @param form
   * @return transforms string with the specified normalization form
```

### JavadocDeclaration
`@param form` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
   * @see Normalizer#normalize(CharSequence, Normalizer.Form)
   * @param input
   * @param form
   * @return transforms string with the specified normalization form
   */
```

### JavadocDeclaration
`@param input` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
   * @see StringUtils#indexOf(CharSequence, CharSequence)
   * Return the 1st occurence of a substring within the String
   * @param input
   * @param find substring to find
   * @return start index of the 1st instance of substring in main string
```

### JavadocDeclaration
`@param input` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
  /**
   * @see String#toUpperCase()
   * @param input
   * @return string in upper case format
   */
```

### JavadocDeclaration
`@param input` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
   * @see StringUtils#lastIndexOf(CharSequence, CharSequence, int)
   * Return the Nth occurence of a substring in string starting from the end of the string.
   * @param input
   * @param find substring to find
   * @param instance Integer denoting the instance no.
```

### JavadocDeclaration
`@param input` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
  /**
   * @see String#toLowerCase())
   * @param input
   * @return string in lower case format
   */
```

### JavadocDeclaration
`@param input1` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
  /**
   * Join two input string with seperator in between
   * @param input1
   * @param input2
   * @param seperator
```

### JavadocDeclaration
`@param input2` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
   * Join two input string with seperator in between
   * @param input1
   * @param input2
   * @param seperator
   * @return The two input strings joined by the seperator
```

### JavadocDeclaration
`@param seperator` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
   * @param input1
   * @param input2
   * @param seperator
   * @return The two input strings joined by the seperator
   */
```

### JavadocDeclaration
`@param input` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
   * @see StringUtils#lastIndexOf(CharSequence, CharSequence)
   * Return the last occurence of a substring within the String
   * @param input
   * @param find substring to find
   * @return start index of the last instance of substring in main string
```

### JavadocDeclaration
`@param input1` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java

  /**
   * @param input1
   * @param input2
   * @return returns the Hamming distance of input1 and input2, note that the two strings must have the same length.
```

### JavadocDeclaration
`@param input2` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
  /**
   * @param input1
   * @param input2
   * @return returns the Hamming distance of input1 and input2, note that the two strings must have the same length.
   */
```

### JavadocDeclaration
`@param input` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java

  /**
   * @param input
   * @return trim spaces from left side of the string
   */
```

### JavadocDeclaration
`@param input` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
  /**
   * @see StringUtils#split(String, String)
   * @param input
   * @param delimiter
   * @return splits string on specified delimiter and returns an array.
```

### JavadocDeclaration
`@param delimiter` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java
   * @see StringUtils#split(String, String)
   * @param input
   * @param delimiter
   * @return splits string on specified delimiter and returns an array.
   */
```

### JavadocDeclaration
Tag `return` is not allowed here
in `pinot-common/src/main/java/org/apache/pinot/common/datablock/DataBlockUtils.java`
#### Snippet
```java
   * @param dataSchema data schema.
   * @param columnSizes array of column size.
   * @return row size in bytes.
   */
  public static void computeColumnSizeInBytes(DataSchema dataSchema, int[] columnSizes) {
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-common/src/main/java/org/apache/pinot/common/datablock/BaseDataBlock.java`
#### Snippet
```java
  /**
   * Return the int serialized form of the data block version and type.
   * @return
   */
  protected abstract int getDataBlockVersionType();
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/SegmentCommitter.java`
#### Snippet
```java
   * Commits a realtime segment to persistent store
   * @param segmentBuildDescriptor object that describes segment to be committed
   * @return
   */
  SegmentCompletionProtocol.Response commit(LLRealtimeSegmentDataManager.SegmentBuildDescriptor segmentBuildDescriptor);
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/SegmentCommitterFactory.java`
#### Snippet
```java
   * @param params Parameters to use in the Segment completion request
   * @param controllerVipUrl Unused,
   * @return
   * @throws URISyntaxException
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/SegmentCommitterFactory.java`
#### Snippet
```java
   * @param controllerVipUrl Unused,
   * @return
   * @throws URISyntaxException
   */
  public SegmentCommitter createSegmentCommitter(boolean isSplitCommit, SegmentCompletionProtocol.Request.Params params,
```

### JavadocDeclaration
`@param segmentName` tag description is missing
in `pinot-core/src/main/java/org/apache/pinot/core/util/PeerServerSegmentFinder.java`
#### Snippet
```java
  /**
   *
   * @param segmentName
   * @param downloadScheme Can be either http or https.
   * @param helixManager
```

### JavadocDeclaration
`@param helixManager` tag description is missing
in `pinot-core/src/main/java/org/apache/pinot/core/util/PeerServerSegmentFinder.java`
#### Snippet
```java
   * @param segmentName
   * @param downloadScheme Can be either http or https.
   * @param helixManager
   * @return a list of uri strings of the form http(s)://hostname:port/segments/tablenameWithType/segmentName
   * for the servers hosting ONLINE segments; empty list if no such server found.
```

### JavadocDeclaration
`@param queryContext` tag description is missing
in `pinot-core/src/main/java/org/apache/pinot/core/plan/maker/InstancePlanMakerImplV2.java`
#### Snippet
```java
   * In-place rewrite QueryContext based on the information from local IndexSegment.
   *
   * @param queryContext
   * @param indexSegment
   */
```

### JavadocDeclaration
`@param indexSegment` tag description is missing
in `pinot-core/src/main/java/org/apache/pinot/core/plan/maker/InstancePlanMakerImplV2.java`
#### Snippet
```java
   *
   * @param queryContext
   * @param indexSegment
   */
  @VisibleForTesting
```

### JavadocDeclaration
`@param queryContext` tag description is missing
in `pinot-core/src/main/java/org/apache/pinot/core/util/GapfillUtils.java`
#### Snippet
```java
  /**
   * Get the gapfill type for queryContext. Also do the validation for gapfill request.
   * @param queryContext
   */
  public static GapfillType getGapfillType(QueryContext queryContext) {
```

### JavadocDeclaration
`@param threads` tag description is missing
in `pinot-core/src/main/java/org/apache/pinot/core/query/scheduler/SchedulerGroupAccountant.java`
#### Snippet
```java
  /**
   * Releases thread capacity reserved for this scheduler group
   * @param threads
   */
  void releasedReservedThreads(int threads);
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-core/src/main/java/org/apache/pinot/core/query/scheduler/SchedulerGroupAccountant.java`
#### Snippet
```java
  /**
   * Total number of threads reserved for this group
   * @return
   */
  int totalReservedThreads();
```

### JavadocDeclaration
`@param query` tag description is missing
in `pinot-core/src/main/java/org/apache/pinot/core/query/scheduler/TableBasedGroupMapper.java`
#### Snippet
```java
  /**
   * Maps query to per-table {@link SchedulerGroup}
   * @param query
   * @return table name (per-table) SchedulerGroup
   */
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-core/src/main/java/org/apache/pinot/core/query/scheduler/SchedulerGroup.java`
#### Snippet
```java
  /**
   * Number of pending queries
   * @return
   */
  int numPending();
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-core/src/main/java/org/apache/pinot/core/query/scheduler/SchedulerQueryContext.java`
#### Snippet
```java
  /**
   * Convenience method to get query arrival time
   * @return
   */
  public long getArrivalTimeMs() {
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-core/src/main/java/org/apache/pinot/core/query/scheduler/MultiLevelPriorityQueue.java`
#### Snippet
```java
  /**
   * Blocking call to read the next query in order of priority
   * @return
   */
  @Nullable
```

### JavadocDeclaration
`@param rhs` tag description is missing
in `pinot-core/src/main/java/org/apache/pinot/core/query/scheduler/fcfs/FCFSSchedulerGroup.java`
#### Snippet
```java
  /**
   * Group that has pending query with earlier arrival time has higher priority.
   * @param rhs
   * @return 1 if this has lower arrival time than rhs
   *         -1 if this has higher arrival time than lhs
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-core/src/main/java/org/apache/pinot/core/query/scheduler/resources/ResourceManager.java`
#### Snippet
```java
   * Check if the query for a scheduler group can get required resources for scheduling
   * @param accountant resource accounting information for a group
   * @return
   */
  public boolean canSchedule(SchedulerGroupAccountant accountant) {
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-core/src/main/java/org/apache/pinot/core/query/scheduler/resources/ResourceManager.java`
#### Snippet
```java
  /**
   * Returns executor service for running queries.
   * @return
   */
  final public ListeningExecutorService getQueryRunners() {
```

### JavadocDeclaration
`@param query` tag description is missing
in `pinot-core/src/main/java/org/apache/pinot/core/query/scheduler/resources/ResourceManager.java`
#### Snippet
```java
   * service limits the number of resources available for executing query
   * as per the configured policy
   * @param query
   * @param accountant Accountant for a scheduler group
   * @return
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-core/src/main/java/org/apache/pinot/core/query/scheduler/resources/ResourceManager.java`
#### Snippet
```java
   * @param query
   * @param accountant Accountant for a scheduler group
   * @return
   */
  public abstract QueryExecutorService getExecutorService(ServerQueryRequest query,
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-core/src/main/java/org/apache/pinot/core/query/scheduler/resources/ResourceManager.java`
#### Snippet
```java
   * Total number of query worker threads. Query worker threads are a pool of threads
   * for parallel processing of a query.
   * @return
   */
  final public int getNumQueryWorkerThreads() {
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-core/src/main/java/org/apache/pinot/core/query/scheduler/resources/ResourceManager.java`
#### Snippet
```java
   * Total number of query runner threads. Query runner threads are 'main'
   * threads executing the query.
   * @return
   */
  final public int getNumQueryRunnerThreads() {
```

### JavadocDeclaration
`@param query` tag description is missing
in `pinot-core/src/main/java/org/apache/pinot/core/query/scheduler/resources/PolicyBasedResourceManager.java`
#### Snippet
```java
   * Returns an executor service that query executor can use like a dedicated
   * service for submitting jobs for parallel execution.
   * @param query
   * @param accountant Accountant for a scheduler group
   * @return BoundedAccountingExecutor service that limits the number of threads available
```

### JavadocDeclaration
`@param value` tag description is missing
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/AggregationResultHolder.java`
#### Snippet
```java
  /**
   * Set the aggregation result value.
   * @param value
   */
  void setValue(Object value);
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/AggregationResultHolder.java`
#### Snippet
```java
  /**
   * Returns the result of aggregation.
   * @return
   */
  <T> T getResult();
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/AggregationResultHolder.java`
#### Snippet
```java
   * Returns the 'primitive int' aggregation result.
   *
   * @return
   */
  int getIntResult();
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/AggregationResultHolder.java`
#### Snippet
```java
  /**
   * Returns the 'primitive double' aggregation result.
   * @return
   */
  double getDoubleResult();
```

### JavadocDeclaration
`@param value` tag description is missing
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/AggregationResultHolder.java`
#### Snippet
```java
  /**
   * Set the 'primitive int' aggregation result.
   * @param value
   */
  void setValue(int value);
```

### JavadocDeclaration
`@param value` tag description is missing
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/AggregationResultHolder.java`
#### Snippet
```java
  /**
   * Set the 'primitive double' aggregation result.
   * @param value
   */
  void setValue(double value);
```

### JavadocDeclaration
`@param defaultValue` tag description is missing
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/DoubleAggregationResultHolder.java`
#### Snippet
```java
  /**
   * Constructor for the class.
   * @param defaultValue
   */
  public DoubleAggregationResultHolder(double defaultValue) {
```

### JavadocDeclaration
`@param groupKey` tag description is missing
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/groupby/GroupByResultHolder.java`
#### Snippet
```java
  /**
   * Store the given value (of type ResultType) for the given groupKey.
   * @param groupKey
   * @param value
   */
```

### JavadocDeclaration
`@param value` tag description is missing
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/groupby/GroupByResultHolder.java`
#### Snippet
```java
   * Store the given value (of type ResultType) for the given groupKey.
   * @param groupKey
   * @param value
   */
  void setValueForKey(int groupKey, Object value);
```

### JavadocDeclaration
`@param capacity` tag description is missing
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/groupby/GroupByResultHolder.java`
#### Snippet
```java
   * of unique group keys.
   *
   * @param capacity
   */
  void ensureCapacity(int capacity);
```

### JavadocDeclaration
`@param groupKey` tag description is missing
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/groupby/GroupByResultHolder.java`
#### Snippet
```java
   * function it is holding the result for).
   *
   * @param groupKey
   * @return
   */
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/groupby/GroupByResultHolder.java`
#### Snippet
```java
   *
   * @param groupKey
   * @return
   */
  int getIntResult(int groupKey);
```

### JavadocDeclaration
`@param groupKey` tag description is missing
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/groupby/GroupByResultHolder.java`
#### Snippet
```java
   * Stores the given value (of type double) for the given groupKey.
   *
   * @param groupKey
   * @param value
   */
```

### JavadocDeclaration
`@param value` tag description is missing
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/groupby/GroupByResultHolder.java`
#### Snippet
```java
   *
   * @param groupKey
   * @param value
   */
  void setValueForKey(int groupKey, double value);
```

### JavadocDeclaration
`@param groupKey` tag description is missing
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/groupby/GroupByResultHolder.java`
#### Snippet
```java
   * function it is holding the result for).
   *
   * @param groupKey
   * @return
   */
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/groupby/GroupByResultHolder.java`
#### Snippet
```java
   *
   * @param groupKey
   * @return
   */
  <T> T getResult(int groupKey);
```

### JavadocDeclaration
`@param groupKey` tag description is missing
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/groupby/GroupByResultHolder.java`
#### Snippet
```java
   * Stores the given value (of type int) for the given groupKey.
   *
   * @param groupKey
   * @param value
   */
```

### JavadocDeclaration
`@param value` tag description is missing
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/groupby/GroupByResultHolder.java`
#### Snippet
```java
   *
   * @param groupKey
   * @param value
   */
  void setValueForKey(int groupKey, int value);
```

### JavadocDeclaration
`@param groupKey` tag description is missing
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/groupby/GroupByResultHolder.java`
#### Snippet
```java
   * function it is holding the result for).
   *
   * @param groupKey
   * @return
   */
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/groupby/GroupByResultHolder.java`
#### Snippet
```java
   *
   * @param groupKey
   * @return
   */
  double getDoubleResult(int groupKey);
```

### JavadocDeclaration
Class/method reference, quoted text, or HTML link are expected after @see tag
in `pinot-core/src/main/java/org/apache/pinot/core/common/BlockDocIdIterator.java`
#### Snippet
```java
  /**
   * Empirically determined to be the best batch size for batch iterators.
   * @see {https://github.com/RoaringBitmap/RoaringBitmap/pull/243#issuecomment-381278304}
   */
  int OPTIMAL_ITERATOR_BATCH_SIZE = 256;
```

### JavadocDeclaration
`@param tarFile` tag description is missing
in `pinot-core/src/main/java/org/apache/pinot/core/metadata/MetadataExtractor.java`
#### Snippet
```java
  /**
   * Returns a SegmentMetadata object from a tarred file
   * @param tarFile
   * @param workingDir
   * @return
```

### JavadocDeclaration
`@param workingDir` tag description is missing
in `pinot-core/src/main/java/org/apache/pinot/core/metadata/MetadataExtractor.java`
#### Snippet
```java
   * Returns a SegmentMetadata object from a tarred file
   * @param tarFile
   * @param workingDir
   * @return
   * @throws Exception
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-core/src/main/java/org/apache/pinot/core/metadata/MetadataExtractor.java`
#### Snippet
```java
   * @param tarFile
   * @param workingDir
   * @return
   * @throws Exception
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-core/src/main/java/org/apache/pinot/core/metadata/MetadataExtractor.java`
#### Snippet
```java
   * @param workingDir
   * @return
   * @throws Exception
   */
  SegmentMetadata extractMetadata(File tarFile, File workingDir)
```

### JavadocDeclaration
Wrong tag `ScalarFunction`
in `pinot-core/src/main/java/org/apache/pinot/core/function/scalar/SketchFunctions.java`
#### Snippet
```java
 * Inbuilt Sketch Transformation Functions
 * The functions can be used as UDFs in Query when added in the FunctionRegistry.
 * @ScalarFunction annotation is used with each method for the registration
 *
 * Note these will just make sketches that contain a single item, these are intended to be used during ingestion to
```

### JavadocDeclaration
`@param serverRoutingInstance` tag description is missing
in `pinot-core/src/main/java/org/apache/pinot/core/transport/QueryResponse.java`
#### Snippet
```java
  /**
   * Returns the time taken for the server to respond to the query.
   * @param serverRoutingInstance
   * @return
   */
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-core/src/main/java/org/apache/pinot/core/transport/QueryResponse.java`
#### Snippet
```java
   * Returns the time taken for the server to respond to the query.
   * @param serverRoutingInstance
   * @return
   */
  long getServerResponseDelayMs(ServerRoutingInstance serverRoutingInstance);
```

### JavadocDeclaration
`@param serverRoutingStatsManager` tag description is missing
in `pinot-core/src/main/java/org/apache/pinot/core/transport/QueryRouter.java`
#### Snippet
```java
   * @param brokerId broker id
   * @param brokerMetrics broker metrics
   * @param serverRoutingStatsManager
   */
  public QueryRouter(String brokerId, BrokerMetrics brokerMetrics,
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-core/src/main/java/org/apache/pinot/core/periodictask/PeriodicTaskScheduler.java`
#### Snippet
```java
   * Get number of tasks scheduled. Method is thread safe since task list is not modified after it is
   * initialized in {@link #init} method.
   * @return
   */
  public int getPeriodicTaskCount() {
```

### JavadocDeclaration
`@param messageId` tag description is missing
in `pinot-plugins/pinot-stream-ingestion/pinot-pulsar/src/main/java/org/apache/pinot/plugin/stream/pulsar/MessageIdStreamOffset.java`
#### Snippet
```java
   * returns the class object from string message id in the format ledgerId:entryId:partitionId
   * throws {@link IOException} if message if format is invalid.
   * @param messageId
   */
  public MessageIdStreamOffset(String messageId) {
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-clients/pinot-jdbc-client/src/main/java/org/apache/pinot/client/PinotDriver.java`
#### Snippet
```java
   * @param info properties required for creating connection
   * @return JDBC connection object to query pinot
   * @throws SQLException
   */
  @Override
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotSchemaRestletResource.java`
#### Snippet
```java
   * @param schema  schema
   * @param reload  set to true to reload the tables using the schema, so committed segments can pick up the new schema
   * @return
   */
  private SuccessResponse updateSchema(String schemaName, Schema schema, boolean reload) {
```

### JavadocDeclaration
`@param tenantName` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotTenantRestletResource.java`
#### Snippet
```java
   * This method expects a tenant name and will return a list of tables tagged on that tenant. It assumes that the
   * tagname is for server tenants only.
   * @param tenantName
   * @return
   */
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotTenantRestletResource.java`
#### Snippet
```java
   * tagname is for server tenants only.
   * @param tenantName
   * @return
   */
  @GET
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotSegmentRestletResource.java`
#### Snippet
```java
   * Internal method to update schema
   * @param tableNameWithType  name of the table
   * @return
   */
  private SuccessResponse updateZKTimeIntervalInternal(String tableNameWithType) {
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/util/SegmentCompletionUtils.java`
#### Snippet
```java
   * segment when a segment is uploaded using split commit. Each attempt has a unique file name suffix
   * @param segmentName segment name
   * @return
   */
  public static String getSegmentNamePrefix(String segmentName) {
```

### JavadocDeclaration
`@param tableConfigStr` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotTableRestletResource.java`
#### Snippet
```java
   * API to create a table. Before adding, validations will be done (min number of replicas,
   * checking offline and realtime table configs match, checking for tenants existing)
   * @param tableConfigStr
   */
  @POST
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/util/TableSizeReader.java`
#### Snippet
```java
   * @param tableName table name without type
   * @param timeoutMsec timeout in milliseconds for reading table sizes from server
   * @return
   */
  @Nullable
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/PinotHelixSegmentOnlineOfflineStateModelGenerator.java`
#### Snippet
```java
  /**
   * This method is not used, Code is to be removed when we have the new state model running in production
   * @return
   */
  public static StateModelDefinition generatePinotStateModelDefinitionOld() {
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/PinotTableIdealStateBuilder.java`
#### Snippet
```java
   * @param tableName resource name
   * @param numCopies is the number of replicas
   * @return
   */
  public static IdealState buildEmptyIdealStateFor(String tableName, int numCopies, boolean enableBatchMessageMode) {
```

### JavadocDeclaration
`@param tableConfig` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/lineage/LineageManager.java`
#### Snippet
```java
  /**
   * Update lineage based on customMap for start replace calls
   * @param tableConfig
   * @param lineageEntryId
   * @param customMap
```

### JavadocDeclaration
`@param lineageEntryId` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/lineage/LineageManager.java`
#### Snippet
```java
   * Update lineage based on customMap for start replace calls
   * @param tableConfig
   * @param lineageEntryId
   * @param customMap
   * @param lineage
```

### JavadocDeclaration
`@param customMap` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/lineage/LineageManager.java`
#### Snippet
```java
   * @param tableConfig
   * @param lineageEntryId
   * @param customMap
   * @param lineage
   */
```

### JavadocDeclaration
`@param lineage` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/lineage/LineageManager.java`
#### Snippet
```java
   * @param lineageEntryId
   * @param customMap
   * @param lineage
   */
  void updateLineageForStartReplaceSegments(TableConfig tableConfig, String lineageEntryId,
```

### JavadocDeclaration
`@param tableConfig` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/lineage/LineageManager.java`
#### Snippet
```java
  /**
   * Update lineage based on customMap for revert replace calls
   * @param tableConfig
   * @param lineageEntryId
   * @param customMap
```

### JavadocDeclaration
`@param lineageEntryId` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/lineage/LineageManager.java`
#### Snippet
```java
   * Update lineage based on customMap for revert replace calls
   * @param tableConfig
   * @param lineageEntryId
   * @param customMap
   * @param lineage
```

### JavadocDeclaration
`@param customMap` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/lineage/LineageManager.java`
#### Snippet
```java
   * @param tableConfig
   * @param lineageEntryId
   * @param customMap
   * @param lineage
   */
```

### JavadocDeclaration
`@param lineage` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/lineage/LineageManager.java`
#### Snippet
```java
   * @param lineageEntryId
   * @param customMap
   * @param lineage
   */
  void updateLineageForRevertReplaceSegments(TableConfig tableConfig, String lineageEntryId,
```

### JavadocDeclaration
`@param tableConfig` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/lineage/LineageManager.java`
#### Snippet
```java
  /**
   * Update lineage for retention purposes
   * @param tableConfig
   * @param lineage
   * @param allSegments
```

### JavadocDeclaration
`@param lineage` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/lineage/LineageManager.java`
#### Snippet
```java
   * Update lineage for retention purposes
   * @param tableConfig
   * @param lineage
   * @param allSegments
   * @param segmentsToDelete
```

### JavadocDeclaration
`@param allSegments` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/lineage/LineageManager.java`
#### Snippet
```java
   * @param tableConfig
   * @param lineage
   * @param allSegments
   * @param segmentsToDelete
   * @param consumingSegments
```

### JavadocDeclaration
`@param segmentsToDelete` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/lineage/LineageManager.java`
#### Snippet
```java
   * @param lineage
   * @param allSegments
   * @param segmentsToDelete
   * @param consumingSegments
   */
```

### JavadocDeclaration
`@param consumingSegments` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/lineage/LineageManager.java`
#### Snippet
```java
   * @param allSegments
   * @param segmentsToDelete
   * @param consumingSegments
   */
  void updateLineageForRetention(TableConfig tableConfig, SegmentLineage lineage, List<String> allSegments,
```

### JavadocDeclaration
`@param tableConfig` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/lineage/LineageManager.java`
#### Snippet
```java
  /**
   * Update lineage based on customMap for end replace calls
   * @param tableConfig
   * @param lineageEntryId
   * @param customMap
```

### JavadocDeclaration
`@param lineageEntryId` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/lineage/LineageManager.java`
#### Snippet
```java
   * Update lineage based on customMap for end replace calls
   * @param tableConfig
   * @param lineageEntryId
   * @param customMap
   * @param lineage
```

### JavadocDeclaration
`@param customMap` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/lineage/LineageManager.java`
#### Snippet
```java
   * @param tableConfig
   * @param lineageEntryId
   * @param customMap
   * @param lineage
   */
```

### JavadocDeclaration
`@param lineage` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/lineage/LineageManager.java`
#### Snippet
```java
   * @param lineageEntryId
   * @param customMap
   * @param lineage
   */
  void updateLineageForEndReplaceSegments(TableConfig tableConfig, String lineageEntryId, Map<String, String> customMap,
```

### JavadocDeclaration
`@param path` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/realtime/PinotRealtimeSegmentManager.java`
#### Snippet
```java
   * - Data change listener for all existing real-time segments
   *
   * @param path
   */
  private void refreshWatchers(String path) {
```

### JavadocDeclaration
`@param taskType` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/minion/PinotHelixTaskResourceManager.java`
#### Snippet
```java
   * yet.
   *
   * @param taskType
   * @return Set of task names
   */
```

### JavadocDeclaration
Wrong tag `note:`
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/minion/PinotHelixTaskResourceManager.java`
#### Snippet
```java
  /**
   * Get all task types.
   * @note: It reads all resource config back and check which are workflows and which are jobs, so it can take some time
   * if there are a lot of tasks.
   * @return Set of all task types
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/realtime/SegmentCompletionManager.java`
#### Snippet
```java
   * This method is to be called when a server reports that it has stopped consuming a real-time segment.
   *
   * @return
   */
  public SegmentCompletionProtocol.Response segmentStoppedConsuming(
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/realtime/SegmentCompletionManager.java`
#### Snippet
```java
   * If the repsonse code is not COMMIT_SUCCESS, then the caller may remove the segment that has been saved.
   *
   * @return
   */
  public SegmentCompletionProtocol.Response segmentCommitEnd(SegmentCompletionProtocol.Request.Params reqParams,
```

### JavadocDeclaration
`@param tableNameWithType` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/PinotHelixResourceManager.java`
#### Snippet
```java
  /**
   * Entry point for table Rebalacing.
   * @param tableNameWithType
   * @param rebalanceConfig
   * @param trackRebalanceProgress - Do we want to track rebalance progress stats
```

### JavadocDeclaration
`@param rebalanceConfig` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/PinotHelixResourceManager.java`
#### Snippet
```java
   * Entry point for table Rebalacing.
   * @param tableNameWithType
   * @param rebalanceConfig
   * @param trackRebalanceProgress - Do we want to track rebalance progress stats
   * @return RebalanceResult
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/PinotHelixResourceManager.java`
#### Snippet
```java
   * @param trackRebalanceProgress - Do we want to track rebalance progress stats
   * @return RebalanceResult
   * @throws TableNotFoundException
   */
  public RebalanceResult rebalanceTable(String tableNameWithType, Configuration rebalanceConfig,
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/PinotHelixResourceManager.java`
#### Snippet
```java
  /**
   * Validate the table config and update it
   * @throws IOException
   */
  public void updateTableConfig(TableConfig tableConfig)
```

### JavadocDeclaration
`@param tableNameWithType` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/PinotHelixResourceManager.java`
#### Snippet
```java
   * List the segment lineage
   *
   * @param tableNameWithType
   */
  public SegmentLineage listSegmentLineage(String tableNameWithType) {
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/PinotHelixResourceManager.java`
#### Snippet
```java
   * @param enableInstance: 'True' for enabling the instance and 'False' for disabling the instance.
   * @param timeOutMs: Time-out for setting ideal-state.
   * @return
   */
  private PinotResourceManagerResponse enableInstance(String instanceName, boolean enableInstance, long timeOutMs) {
```

### JavadocDeclaration
`@param tableNameWithType` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/PinotHelixResourceManager.java`
#### Snippet
```java
   * Creates a new SegmentZkMetadata entry. This call is atomic and ensures that only of the create calls succeeds.
   *
   * @param tableNameWithType
   * @param segmentZKMetadata
   * @return
```

### JavadocDeclaration
`@param segmentZKMetadata` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/PinotHelixResourceManager.java`
#### Snippet
```java
   *
   * @param tableNameWithType
   * @param segmentZKMetadata
   * @return
   */
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/PinotHelixResourceManager.java`
#### Snippet
```java
   * @param tableNameWithType
   * @param segmentZKMetadata
   * @return
   */
  public boolean createSegmentZkMetadata(String tableNameWithType, SegmentZKMetadata segmentZKMetadata) {
```

### JavadocDeclaration
`@param lineageUpdateType` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/PinotHelixResourceManager.java`
#### Snippet
```java
   * @param lineageEntryToMatch lineage entry that needs to match with the entry from the newly fetched segment lineage.
   * @param propertyStore property store
   * @param lineageUpdateType
   * @param customMap
   */
```

### JavadocDeclaration
`@param customMap` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/PinotHelixResourceManager.java`
#### Snippet
```java
   * @param propertyStore property store
   * @param lineageUpdateType
   * @param customMap
   */
  private boolean writeLineageEntryWithTightLoop(TableConfig tableConfig, String lineageEntryId,
```

### JavadocDeclaration
`@param tableNameWithType` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/PinotHelixResourceManager.java`
#### Snippet
```java
   * Update is done with retry logic along with read-modify-write block for achieving atomic update of the lineage
   * metadata.
   * @param tableNameWithType
   * @param segmentLineageEntryId
   * @param endReplaceSegmentsRequest
```

### JavadocDeclaration
`@param segmentLineageEntryId` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/PinotHelixResourceManager.java`
#### Snippet
```java
   * metadata.
   * @param tableNameWithType
   * @param segmentLineageEntryId
   * @param endReplaceSegmentsRequest
   */
```

### JavadocDeclaration
`@param endReplaceSegmentsRequest` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/PinotHelixResourceManager.java`
#### Snippet
```java
   * @param tableNameWithType
   * @param segmentLineageEntryId
   * @param endReplaceSegmentsRequest
   */
  public void endReplaceSegments(String tableNameWithType, String segmentLineageEntryId,
```

### JavadocDeclaration
`@param tableNameWithType` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/PinotHelixResourceManager.java`
#### Snippet
```java
   * Update is done with retry logic along with read-modify-write block for achieving atomic update of the lineage
   * metadata.
   * @param tableNameWithType
   * @param segmentLineageEntryId
   * @param revertReplaceSegmentsRequest
```

### JavadocDeclaration
`@param segmentLineageEntryId` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/PinotHelixResourceManager.java`
#### Snippet
```java
   * metadata.
   * @param tableNameWithType
   * @param segmentLineageEntryId
   * @param revertReplaceSegmentsRequest
   */
```

### JavadocDeclaration
`@param revertReplaceSegmentsRequest` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/PinotHelixResourceManager.java`
#### Snippet
```java
   * @param tableNameWithType
   * @param segmentLineageEntryId
   * @param revertReplaceSegmentsRequest
   */
  public void revertReplaceSegments(String tableNameWithType, String segmentLineageEntryId, boolean forceRevert,
```

### JavadocDeclaration
`@param customMap` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/PinotHelixResourceManager.java`
#### Snippet
```java
   * @param segmentsTo a list of merged segments
   * @param forceCleanup True for enabling the force segment cleanup
   * @param customMap
   * @return Segment lineage entry id
   *
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/PinotHelixResourceManager.java`
#### Snippet
```java
   * @return Segment lineage entry id
   *
   * @throws InvalidConfigException
   */
  public String startReplaceSegments(String tableNameWithType, List<String> segmentsFrom, List<String> segmentsTo,
```

### JavadocDeclaration
InvalidConfigException is not declared to be thrown by method startReplaceSegments
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/PinotHelixResourceManager.java`
#### Snippet
```java
   * @return Segment lineage entry id
   *
   * @throws InvalidConfigException
   */
  public String startReplaceSegments(String tableNameWithType, List<String> segmentsFrom, List<String> segmentsTo,
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/data/generator/MultiValueGeneratorHelper.java`
#### Snippet
```java
   * @param rand random object
   * @param nextItemFunc function to get the next random item
   * @return
   */
  public static List<Object> generateMultiValueEntries(double numberOfValuesPerEntry, Random rand,
```

### JavadocDeclaration
Class/method reference, quoted text, or HTML link are expected after @see tag
in `pinot-server/src/main/java/org/apache/pinot/server/api/resources/TablesResource.java`
#### Snippet
```java
   * Please note that invocation of this endpoint may cause query performance to suffer, since we tar up the segment
   * to upload it.
   * @see <a>href="https://tinyurl.com/f63ru4sb</a>
   */
  @POST
```

### JavadocDeclaration
`@param segmentMetadata` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/realtime/provisioning/MemoryEstimator.java`
#### Snippet
```java
  /**
   * Creates a sample segment ZK metadata for the given segment metadata
   * @param segmentMetadata
   * @return
   */
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/realtime/provisioning/MemoryEstimator.java`
#### Snippet
```java
   * Creates a sample segment ZK metadata for the given segment metadata
   * @param segmentMetadata
   * @return
   */
  private SegmentZKMetadata getSegmentZKMetadata(SegmentMetadataImpl segmentMetadata, int totalDocs) {
```

### JavadocDeclaration
`@param totalMemoryForConsumingSegment` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/realtime/provisioning/MemoryEstimator.java`
#### Snippet
```java
   * Computes the memory by the inverted indexes in the consuming segment
   * This is just an estimation. We use MutableRoaringBitmap for inverted indexes, which use heap memory.
   * @param totalMemoryForConsumingSegment
   * @return
   */
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/realtime/provisioning/MemoryEstimator.java`
#### Snippet
```java
   * This is just an estimation. We use MutableRoaringBitmap for inverted indexes, which use heap memory.
   * @param totalMemoryForConsumingSegment
   * @return
   */
  private long getMemoryForInvertedIndex(long totalMemoryForConsumingSegment) {
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/realtime/provisioning/MemoryEstimator.java`
#### Snippet
```java
   * @param totalConsumingPartitions total consuming partitions we are provisioning for
   * @param retentionHours number of most recent hours to be retained in memory for queries.
   * @throws IOException
   */
  public void estimateMemoryUsed(File statsFile, int[] numHosts, int[] numHours, final int totalConsumingPartitions,
```

### JavadocDeclaration
`@param completedSegmentSizeBytes` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/realtime/provisioning/MemoryEstimator.java`
#### Snippet
```java
   * It also takes into account that a new segment will be created every numHoursToConsume hours, and so we might
   * need to keep multiple completed segments in memory at a time
   * @param completedSegmentSizeBytes
   * @param numHoursToConsume
   * @return
```

### JavadocDeclaration
`@param numHoursToConsume` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/realtime/provisioning/MemoryEstimator.java`
#### Snippet
```java
   * need to keep multiple completed segments in memory at a time
   * @param completedSegmentSizeBytes
   * @param numHoursToConsume
   * @return
   */
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/realtime/provisioning/MemoryEstimator.java`
#### Snippet
```java
   * @param completedSegmentSizeBytes
   * @param numHoursToConsume
   * @return
   */
  private long calculateMemoryForCompletedSegmentsPerPartition(long completedSegmentSizeBytes, int numHoursToConsume,
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/realtime/provisioning/MemoryEstimator.java`
#### Snippet
```java
  /**
   * Gets the average num multivalues across all multi value columns in the data
   * @return
   */
  private int getAvgMultiValues() {
```

### JavadocDeclaration
`@param originalDataFile` tag description is missing
in `pinot-compatibility-verifier/src/main/java/org/apache/pinot/compat/Utils.java`
#### Snippet
```java
  /**
   * Replace all occurrence of a string in originalDataFile and write the replaced content to replacedDataFile.
   * @param originalDataFile
   * @param replacedDataFile
   * @param original
```

### JavadocDeclaration
`@param replacedDataFile` tag description is missing
in `pinot-compatibility-verifier/src/main/java/org/apache/pinot/compat/Utils.java`
#### Snippet
```java
   * Replace all occurrence of a string in originalDataFile and write the replaced content to replacedDataFile.
   * @param originalDataFile
   * @param replacedDataFile
   * @param original
   * @param replaced
```

### JavadocDeclaration
`@param original` tag description is missing
in `pinot-compatibility-verifier/src/main/java/org/apache/pinot/compat/Utils.java`
#### Snippet
```java
   * @param originalDataFile
   * @param replacedDataFile
   * @param original
   * @param replaced
   * @throws IOException
```

### JavadocDeclaration
`@param replaced` tag description is missing
in `pinot-compatibility-verifier/src/main/java/org/apache/pinot/compat/Utils.java`
#### Snippet
```java
   * @param replacedDataFile
   * @param original
   * @param replaced
   * @throws IOException
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-compatibility-verifier/src/main/java/org/apache/pinot/compat/Utils.java`
#### Snippet
```java
   * @param original
   * @param replaced
   * @throws IOException
   */
  public static void replaceContent(File originalDataFile, File replacedDataFile, String original, String replaced)
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-compatibility-verifier/src/main/java/org/apache/pinot/compat/SegmentOp.java`
#### Snippet
```java
   * Verify given table name and segment name deleted from the controller.
   * @return true if no segment found, else false.
   * @throws IOException
   * @throws InterruptedException
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-compatibility-verifier/src/main/java/org/apache/pinot/compat/SegmentOp.java`
#### Snippet
```java
   * @return true if no segment found, else false.
   * @throws IOException
   * @throws InterruptedException
   */
  private boolean verifySegmentDeleted()
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-compatibility-verifier/src/main/java/org/apache/pinot/compat/SegmentOp.java`
#### Snippet
```java
   * @param state of the segment to be verified in the controller.
   * @return true if segment is in the state provided in the parameter, else false.
   * @throws IOException
   * @throws InterruptedException
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-compatibility-verifier/src/main/java/org/apache/pinot/compat/SegmentOp.java`
#### Snippet
```java
   * @return true if segment is in the state provided in the parameter, else false.
   * @throws IOException
   * @throws InterruptedException
   */
  private boolean verifySegmentInState(String state)
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-connectors/pinot-flink-connector/src/main/java/org/apache/pinot/connector/flink/sink/FlinkSegmentWriter.java`
#### Snippet
```java
   *
   * @return URI of the generated segment
   * @throws IOException
   */
  @Override
```

### JavadocDeclaration
`@param resourceName` tag description is missing
in `pinot-tools/src/main/java/org/apache/pinot/tools/PinotZKChanger.java`
#### Snippet
```java
  /**
   * Wait till state has stabilized {@link #isStable(String)}
   * @param resourceName
   * @throws InterruptedException
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-tools/src/main/java/org/apache/pinot/tools/PinotZKChanger.java`
#### Snippet
```java
   * Wait till state has stabilized {@link #isStable(String)}
   * @param resourceName
   * @throws InterruptedException
   */
  public void waitForStable(String resourceName)
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-tools/src/main/java/org/apache/pinot/tools/PinotZKChanger.java`
#### Snippet
```java
  /**
   * return true if IdealState = ExternalView
   * @return
   */
  public int isStable(String tableName) {
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-tools/src/main/java/org/apache/pinot/tools/ClusterStateVerifier.java`
#### Snippet
```java
   * @param tableName optional table names which is provided by user and about to scan
   * @param timeoutSec maximum timeout in second
   * @return
   */
  public boolean verifyClusterState(String tableName, long timeoutSec) {
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-tools/src/main/java/org/apache/pinot/tools/ClusterStateVerifier.java`
#### Snippet
```java
   * return true if all the tables are stable
   * @param tableNames list of table names which are about to scan
   * @return
   */
  private boolean waitForClusterStable(final List<String> tableNames, final long timeoutSec)
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-tools/src/main/java/org/apache/pinot/tools/ClusterStateVerifier.java`
#### Snippet
```java
   * @param tableNames list of table names which are about to scan
   * @param timeoutSec maximum timeout in second
   * @return
   */
  private boolean isClusterStable(final List<String> tableNames, final long timeoutSec) {
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/PerfBenchmarkRunner.java`
#### Snippet
```java
   *
   * @param args arguments for the perf benchmark runner.
   * @throws Exception
   */
  public static void main(String[] args)
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/PerfBenchmarkDriver.java`
#### Snippet
```java
   * @param isStartServer whether to start server.
   * @return perf benchmark driver.
   * @throws Exception
   */
  public static PerfBenchmarkDriver startComponents(boolean isStartZookeeper, boolean isStartController,
```

### JavadocDeclaration
`@param offlineTableName` tag description is missing
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/OfflineSegmentIntervalCheckerCommand.java`
#### Snippet
```java
  /**
   * Checks segments of table for invalid intervals and prints them out
   * @param offlineTableName
   */
  private List<String> checkOfflineTablesSegmentIntervals(String offlineTableName) {
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/QueryRunner.java`
#### Snippet
```java
   *
   * @return QuerySummary containing final report of query stats
   * @throws Exception
   */
  public static QuerySummary multiThreadedQueryRunner(PerfBenchmarkDriverConf conf, List<String> queries,
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/QueryRunner.java`
#### Snippet
```java
   *
   * @return QuerySummary containing final report of query stats
   * @throws Exception
   */
  public static QuerySummary singleThreadedQueryRunner(PerfBenchmarkDriverConf conf, List<String> queries,
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/QueryRunner.java`
#### Snippet
```java
   *
   * @return QuerySummary containing final report of query stats
   * @throws Exception
   */
  public static QuerySummary targetQPSQueryRunner(PerfBenchmarkDriverConf conf, List<String> queries,
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/QueryRunner.java`
#### Snippet
```java
   *
   * @return QuerySummary containing final report of query stats
   * @throws Exception
   */
  public static QuerySummary increasingQPSQueryRunner(PerfBenchmarkDriverConf conf, List<String> queries,
```

### JavadocDeclaration
`@param outputValues` tag description is missing
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/RealtimeProvisioningHelperCommand.java`
#### Snippet
```java
  /**
   * Displays the output values as a grid of numHoursToConsume vs numHostsToProvision
   * @param outputValues
   * @param numHosts
   * @param numHours
```

### JavadocDeclaration
`@param numHosts` tag description is missing
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/RealtimeProvisioningHelperCommand.java`
#### Snippet
```java
   * Displays the output values as a grid of numHoursToConsume vs numHostsToProvision
   * @param outputValues
   * @param numHosts
   * @param numHours
   */
```

### JavadocDeclaration
`@param numHours` tag description is missing
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/RealtimeProvisioningHelperCommand.java`
#### Snippet
```java
   * @param outputValues
   * @param numHosts
   * @param numHours
   */
  private void displayResults(String[][] outputValues, int[] numHosts, int[] numHours) {
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-tools/src/main/java/org/apache/pinot/tools/segment/converter/PinotSegmentConverter.java`
#### Snippet
```java
   * Convert Pinot Segment into another format.
   *
   * @throws Exception
   */
  void convert()
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-tools/src/main/java/org/apache/pinot/tools/segment/converter/DictionaryToRawIndexConverter.java`
#### Snippet
```java
   * @param compressOutput Tar/gzip the output segment
   * @return True if successful, False otherwise
   * @throws Exception
   */
  public boolean convertSegment(File segmentDir, String[] columns, File outputDir, boolean compressOutput)
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-tools/src/main/java/org/apache/pinot/tools/segment/converter/DictionaryToRawIndexConverter.java`
#### Snippet
```java
   * @param columns Converted columns
   * @param tableName New table name to be written in the meta-data. Skipped if null.
   * @throws IOException
   * @throws ConfigurationException
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-tools/src/main/java/org/apache/pinot/tools/segment/converter/DictionaryToRawIndexConverter.java`
#### Snippet
```java
   * @param tableName New table name to be written in the meta-data. Skipped if null.
   * @throws IOException
   * @throws ConfigurationException
   */
  private void updateMetadata(File segmentDir, String[] columns, String tableName)
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-tools/src/main/java/org/apache/pinot/tools/segment/converter/DictionaryToRawIndexConverter.java`
#### Snippet
```java
   *
   * @return True if successful, False otherwise
   * @throws Exception
   */
  public boolean convert()
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-tools/src/main/java/org/apache/pinot/tools/segment/converter/DictionaryToRawIndexConverter.java`
#### Snippet
```java
   *
   * @param args Arguments for the converter
   * @throws Exception
   */
  public static void main(String[] args)
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-tools/src/main/java/org/apache/pinot/tools/segment/converter/DictionaryToRawIndexConverter.java`
#### Snippet
```java
   * @param column Column to convert
   * @param newSegment Directory where raw index to be written
   * @throws IOException
   */
  private void convertOneColumn(IndexSegment segment, String column, File newSegment)
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-tools/src/main/java/org/apache/pinot/tools/anonymizer/PinotDataAndQueryAnonymizer.java`
#### Snippet
```java
  /**
   * Write global dictionaries and column name mapping to disk
   * @throws Exception
   */
  private void writeGlobalDictionariesAndColumnMapping()
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-tools/src/main/java/org/apache/pinot/tools/anonymizer/PinotDataAndQueryAnonymizer.java`
#### Snippet
```java
   * Read dictionaries from a single segment
   * @param segmentDirectory segment index directory
   * @throws Exception
   */
  private void readDictionariesFromSegment(String segmentDirectory)
```

### JavadocDeclaration
`@param resolutions` tag description is missing
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/index/reader/H3IndexResolution.java`
#### Snippet
```java
  /**
   * Creates the resolutions with the serialized short value
   * @param resolutions
   */
  public H3IndexResolution(short resolutions) {
```

### JavadocDeclaration
`@param sortedValues` tag description is missing
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/index/reader/Dictionary.java`
#### Snippet
```java
  /**
   * Returns the dictIds for the given sorted values. This method is for the IN/NOT IN predicate evaluation.
   * @param sortedValues
   * @param dictIds
   */
```

### JavadocDeclaration
`@param dictIds` tag description is missing
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/index/reader/Dictionary.java`
#### Snippet
```java
   * Returns the dictIds for the given sorted values. This method is for the IN/NOT IN predicate evaluation.
   * @param sortedValues
   * @param dictIds
   */
  default void getDictIds(List<String> sortedValues, IntSet dictIds) {
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/index/reader/ForwardIndexReader.java`
#### Snippet
```java
   * Returns the compression type (if valid). Only valid for RAW forward index columns implemented in
   * BaseChunkForwardIndexReader.
   * @return
   */
  default ChunkCompressionType getCompressionType() {
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/index/reader/ForwardIndexReader.java`
#### Snippet
```java
   * Returns the length of the longest entry. Only valid for RAW forward index columns implemented in
   * BaseChunkForwardIndexReader. Returns -1 otherwise.
   * @return
   */
  default int getLengthOfLongestEntry() {
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/store/ColumnIndexDirectory.java`
#### Snippet
```java
   * @param type index type
   * @return ByteBuffer like buffer for data
   * @throws IOException
   */
  public abstract PinotDataBuffer getBuffer(String column, IndexType<?, ?, ?> type)
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/store/ColumnIndexDirectory.java`
#### Snippet
```java
   * @param sizeBytes sizeBytes for the buffer allocation
   * @return ByteBuffer like buffer for data
   * @throws IOException
   */
  public abstract PinotDataBuffer newBuffer(String column, IndexType<?, ?, ?> type, long sizeBytes)
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/store/SegmentDirectory.java`
#### Snippet
```java
   * @return Reader object if successfully created. null if the directory
   *   is already locked for writes
   * @throws IOException
   */
  public abstract Reader createReader()
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/store/SegmentDirectory.java`
#### Snippet
```java
     * @param sizeBytes sizeBytes of index data
     * @return PinotDataBufferOld that writers can update
     * @throws IOException
     */
    // NOTE: an interface like readFrom(File f, String column, IndexType<?, ?, ?>, int sizeBytes) will be safe
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/store/SegmentDirectory.java`
#### Snippet
```java
     * @param type index type
     * @return a bytebuffer-like buffer holding index data
     * @throws IOException
     */
    public abstract PinotDataBuffer getIndexFor(String column, IndexType<?, ?, ?> type)
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/store/SegmentDirectory.java`
#### Snippet
```java
   * Create Writer for the directory
   * @return Writer object on success. null if the directory has active readers
   * @throws IOException
   */
  public abstract Writer createWriter()
```

### JavadocDeclaration
`@param columnName` tag description is missing
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/creator/SegmentIndexCreationDriver.java`
#### Snippet
```java
   *  Get the stats collector for a column
   *
   * @param columnName
   * @return AbstractColumnStatisticsCollector for the column.
   * @throws Exception
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/creator/SegmentIndexCreationDriver.java`
#### Snippet
```java
   * @param columnName
   * @return AbstractColumnStatisticsCollector for the column.
   * @throws Exception
   */
  ColumnStatistics getColumnStatisticsCollector(final String columnName)
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/creator/SegmentCreator.java`
#### Snippet
```java
   * Seals the segment, flushing it to disk.
   *
   * @throws ConfigurationException
   * @throws IOException
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/creator/SegmentCreator.java`
#### Snippet
```java
   *
   * @throws ConfigurationException
   * @throws IOException
   */
  void seal()
```

### JavadocDeclaration
`@param segmentCreationSpec` tag description is missing
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/creator/SegmentCreator.java`
#### Snippet
```java
   * Initializes the segment creation.
   *
   * @param segmentCreationSpec
   * @param indexCreationInfoMap
   * @param schema
```

### JavadocDeclaration
`@param indexCreationInfoMap` tag description is missing
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/creator/SegmentCreator.java`
#### Snippet
```java
   *
   * @param segmentCreationSpec
   * @param indexCreationInfoMap
   * @param schema
   * @param outDir
```

### JavadocDeclaration
`@param schema` tag description is missing
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/creator/SegmentCreator.java`
#### Snippet
```java
   * @param segmentCreationSpec
   * @param indexCreationInfoMap
   * @param schema
   * @param outDir
   * @throws Exception
```

### JavadocDeclaration
`@param outDir` tag description is missing
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/creator/SegmentCreator.java`
#### Snippet
```java
   * @param indexCreationInfoMap
   * @param schema
   * @param outDir
   * @throws Exception
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/creator/SegmentCreator.java`
#### Snippet
```java
   * @param schema
   * @param outDir
   * @throws Exception
   */
  void init(SegmentGeneratorConfig segmentCreationSpec, SegmentIndexCreationInfo segmentIndexCreationInfo,
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/creator/IndexCreationContext.java`
#### Snippet
```java
  /**
   * This is an abstraction leak from TextIndexType.
   * @return
   */
  boolean isTextCommitOnClose();
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/compression/ChunkDecompressor.java`
#### Snippet
```java
   * @param decompressedOutput ByteBuffer where the decompressed data is put.
   * @return Size of decompressed data.
   * @throws IOException
   */
  int decompress(ByteBuffer compressedInput, ByteBuffer decompressedOutput)
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/datasource/DataSourceMetadata.java`
#### Snippet
```java
  /**
   * Returns the max row length in bytes for a var byte MV column. {@code -1} if not applicable.
   * @return
   */
  default int getMaxRowLengthInBytes() {
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/compression/ChunkCompressor.java`
#### Snippet
```java
   * @return Size of the compressed output data.
   *
   * @throws IOException
   */
  int compress(ByteBuffer inUncompressed, ByteBuffer outCompressed)
```

### JavadocDeclaration
Wrong tag `see:`
in `pinot-broker/src/main/java/org/apache/pinot/broker/requesthandler/BrokerRequestHandlerDelegate.java`
#### Snippet
```java
 * {@link BrokerRequestHandler} based on the requested handle type.
 *
 * {@see: @CommonConstant
 */
public class BrokerRequestHandlerDelegate implements BrokerRequestHandler {
```

### JavadocDeclaration
`@param e` tag description is missing
in `pinot-query-runtime/src/main/java/org/apache/pinot/query/runtime/operator/OpChain.java`
#### Snippet
```java
  /**
   * cancel() is called when execution runs into error.
   * @param e
   */
  public void cancel(Throwable e) {
```

### JavadocDeclaration
`@param row` tag description is missing
in `pinot-query-runtime/src/main/java/org/apache/pinot/query/runtime/operator/SetOperator.java`
#### Snippet
```java
   * Returns true if the row is matched.
   * Also updates the right row set based on the Operator.
   * @param row
   * @return true if the row is matched.
   */
```

### JavadocDeclaration
`@param tableCache` tag description is missing
in `pinot-broker/src/main/java/org/apache/pinot/broker/requesthandler/BaseBrokerRequestHandler.java`
#### Snippet
```java
   * For a hybrid table, a segment partitioned column has to be the intersection of both offline and realtime tables.
   *
   * @param tableCache
   * @param tableName
   * @return segment partitioned columns belong to both offline and realtime tables.
```

### JavadocDeclaration
`@param tableName` tag description is missing
in `pinot-broker/src/main/java/org/apache/pinot/broker/requesthandler/BaseBrokerRequestHandler.java`
#### Snippet
```java
   *
   * @param tableCache
   * @param tableName
   * @return segment partitioned columns belong to both offline and realtime tables.
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-perf/src/main/java/org/apache/pinot/perf/RawIndexBenchmark.java`
#### Snippet
```java
   *
   * @param args Command line arguments.
   * @throws Exception
   */
  public static void main(String[] args)
```

### JavadocDeclaration
`@param segment` tag description is missing
in `pinot-perf/src/main/java/org/apache/pinot/perf/RawIndexBenchmark.java`
#### Snippet
```java
   *   <li> DocId's are in clusters containing {@link #_numConsecutiveLookups} ids. </li>
   * </ul>
   * @param segment
   * @return
   */
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-perf/src/main/java/org/apache/pinot/perf/RawIndexBenchmark.java`
#### Snippet
```java
   * </ul>
   * @param segment
   * @return
   */
  private int[] generateDocIds(IndexSegment segment) {
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-perf/src/main/java/org/apache/pinot/perf/RawIndexBenchmark.java`
#### Snippet
```java
   * The first column has raw indices (no dictionary), where as the second column is dictionary encoded.
   *
   * @throws Exception
   */
  private File buildSegment()
```

### JavadocDeclaration
`@param subPath` tag description is missing
in `pinot-plugins/pinot-file-system/pinot-gcs/src/main/java/org/apache/pinot/plugin/filesystem/GcsUri.java`
#### Snippet
```java
   * Returns true if this path contains the given subpath.
   *
   * @param subPath
   * @return
   */
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-plugins/pinot-file-system/pinot-gcs/src/main/java/org/apache/pinot/plugin/filesystem/GcsUri.java`
#### Snippet
```java
   *
   * @param subPath
   * @return
   */
  public boolean hasSubpath(GcsUri subPath) {
```

### JavadocDeclaration
`@param gcsUri` tag description is missing
in `pinot-plugins/pinot-file-system/pinot-gcs/src/main/java/org/apache/pinot/plugin/filesystem/GcsPinotFS.java`
#### Snippet
```java
   * Returns true if this is an existing directory
   *
   * @param gcsUri
   * @return true if the directory exists
   * @throws IOException
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-plugins/pinot-file-system/pinot-gcs/src/main/java/org/apache/pinot/plugin/filesystem/GcsPinotFS.java`
#### Snippet
```java
   * @param gcsUri
   * @return true if the directory exists
   * @throws IOException
   */
  private boolean existsDirectoryOrBucket(GcsUri gcsUri)
```

### JavadocDeclaration
Wrong tag `class`
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/writer/impl/MmapMemoryManager.java`
#### Snippet
```java

/**
 * @class MmapMemoryManager is an OffHeapMemoryManager that manages memory by
 * allocating it via mmap.
 *
```

### JavadocDeclaration
Wrong tag `note`
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/writer/impl/MmapMemoryManager.java`
#### Snippet
```java
 * and map areas of the file for each allocation request within a segment.
 *
 * @note Thread-unsafe. We expect to use this class only in a single writer case.
 */
public class MmapMemoryManager extends RealtimeIndexOffHeapMemoryManager {
```

### JavadocDeclaration
Class/method reference, quoted text, or HTML link are expected after @see tag
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/writer/impl/MmapMemoryManager.java`
#### Snippet
```java
   * @return buffer allocated in mmap mode
   *
   * @see {@link RealtimeIndexOffHeapMemoryManager#allocate(long, String)}
   */
  @Override
```

### JavadocDeclaration
`@param row` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/reader/impl/FixedByteSingleValueMultiColReader.java`
#### Snippet
```java
  /**
   *
   * @param row
   * @param col
   * @return
```

### JavadocDeclaration
`@param col` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/reader/impl/FixedByteSingleValueMultiColReader.java`
#### Snippet
```java
   *
   * @param row
   * @param col
   * @return
   */
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/reader/impl/FixedByteSingleValueMultiColReader.java`
#### Snippet
```java
   * @param row
   * @param col
   * @return
   */
  public float getFloat(int row, int col) {
```

### JavadocDeclaration
`@param row` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/reader/impl/FixedByteSingleValueMultiColReader.java`
#### Snippet
```java
  /**
   *
   * @param row
   * @param col
   * @return
```

### JavadocDeclaration
`@param col` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/reader/impl/FixedByteSingleValueMultiColReader.java`
#### Snippet
```java
   *
   * @param row
   * @param col
   * @return
   */
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/reader/impl/FixedByteSingleValueMultiColReader.java`
#### Snippet
```java
   * @param row
   * @param col
   * @return
   */
  public int getInt(int row, int col) {
```

### JavadocDeclaration
`@param row` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/reader/impl/FixedByteSingleValueMultiColReader.java`
#### Snippet
```java
   * Computes the offset where the actual column data can be read
   *
   * @param row
   * @param col
   * @return
```

### JavadocDeclaration
`@param col` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/reader/impl/FixedByteSingleValueMultiColReader.java`
#### Snippet
```java
   *
   * @param row
   * @param col
   * @return
   */
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/reader/impl/FixedByteSingleValueMultiColReader.java`
#### Snippet
```java
   * @param row
   * @param col
   * @return
   */
  private int computeOffset(int row, int col) {
```

### JavadocDeclaration
`@param row` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/reader/impl/FixedByteSingleValueMultiColReader.java`
#### Snippet
```java
   * Reads the double at row,col
   *
   * @param row
   * @param col
   * @return
```

### JavadocDeclaration
`@param col` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/reader/impl/FixedByteSingleValueMultiColReader.java`
#### Snippet
```java
   *
   * @param row
   * @param col
   * @return
   */
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/reader/impl/FixedByteSingleValueMultiColReader.java`
#### Snippet
```java
   * @param row
   * @param col
   * @return
   */
  public double getDouble(int row, int col) {
```

### JavadocDeclaration
`@param row` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/reader/impl/FixedByteSingleValueMultiColReader.java`
#### Snippet
```java
  /**
   *
   * @param row
   * @param col
   * @return
```

### JavadocDeclaration
`@param col` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/reader/impl/FixedByteSingleValueMultiColReader.java`
#### Snippet
```java
   *
   * @param row
   * @param col
   * @return
   */
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/reader/impl/FixedByteSingleValueMultiColReader.java`
#### Snippet
```java
   * @param row
   * @param col
   * @return
   */
  public long getLong(int row, int col) {
```

### JavadocDeclaration
`@param row` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/reader/impl/FixedByteSingleValueMultiColReader.java`
#### Snippet
```java
  /**
   *
   * @param row
   * @param col
   * @return
```

### JavadocDeclaration
`@param col` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/reader/impl/FixedByteSingleValueMultiColReader.java`
#### Snippet
```java
   *
   * @param row
   * @param col
   * @return
   */
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/reader/impl/FixedByteSingleValueMultiColReader.java`
#### Snippet
```java
   * @param row
   * @param col
   * @return
   */
  public short getShort(int row, int col) {
```

### JavadocDeclaration
`@param row` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/reader/impl/FixedByteSingleValueMultiColReader.java`
#### Snippet
```java
   * Generic method to read the raw bytes
   *
   * @param row
   * @param col
   * @return
```

### JavadocDeclaration
`@param col` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/reader/impl/FixedByteSingleValueMultiColReader.java`
#### Snippet
```java
   *
   * @param row
   * @param col
   * @return
   */
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/reader/impl/FixedByteSingleValueMultiColReader.java`
#### Snippet
```java
   * @param row
   * @param col
   * @return
   */
  public byte[] getBytes(int row, int col) {
```

### JavadocDeclaration
`@param row` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/reader/impl/FixedByteSingleValueMultiColReader.java`
#### Snippet
```java
   * to be of same length
   *
   * @param row
   * @param col
   * @return
```

### JavadocDeclaration
`@param col` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/reader/impl/FixedByteSingleValueMultiColReader.java`
#### Snippet
```java
   *
   * @param row
   * @param col
   * @return
   */
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/reader/impl/FixedByteSingleValueMultiColReader.java`
#### Snippet
```java
   * @param row
   * @param col
   * @return
   */
  public String getString(int row, int col) {
```

### JavadocDeclaration
`@param row` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/reader/impl/FixedByteSingleValueMultiColReader.java`
#### Snippet
```java
  /**
   *
   * @param row
   * @param col
   * @return
```

### JavadocDeclaration
`@param col` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/reader/impl/FixedByteSingleValueMultiColReader.java`
#### Snippet
```java
   *
   * @param row
   * @param col
   * @return
   */
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/reader/impl/FixedByteSingleValueMultiColReader.java`
#### Snippet
```java
   * @param row
   * @param col
   * @return
   */
  public char getChar(int row, int col) {
```

### JavadocDeclaration
Wrong tag `class`
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/writer/impl/MutableOffHeapByteArrayStore.java`
#### Snippet
```java

/**
 * @class OffHeapMutableByteArrayStore
 *
 * An off-heap byte array store that provides APIs to add byte array (value), retrieve a value, and compare value at
```

### JavadocDeclaration
Wrong tag `note`
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/writer/impl/MutableOffHeapByteArrayStore.java`
#### Snippet
```java
 * Empty byte arrays are supported.
 *
 * @note The class is thread-safe for single writer and multiple readers.
 *
 * This class has a list of OffHeapMutableByteArrayStore.Buffer objects. As Buffer objects get filled, new Buffer
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/readerwriter/RealtimeIndexOffHeapMemoryManager.java`
#### Snippet
```java
   * release all resources allocated.
   *
   * @throws IOException
   */
  public void close()
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/fst/RegexpMatcher.java`
#### Snippet
```java
   *    3) This process is bound to complete since we are making progression on the FST (which is a DAG) towards final
   *       nodes.
   * @return
   * @throws IOException
   */
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/fst/RegexpMatcher.java`
#### Snippet
```java
   *       nodes.
   * @return
   * @throws IOException
   */
  public List<Long> regexMatchOnFST()
```

### JavadocDeclaration
Javadoc pointing to itself
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/MatchResult.java`
#### Snippet
```java
   *
   * Note that to check for a general "input does not exist in the automaton"
   * you have to check for both {@link #NO_MATCH} and
   * {@link #AUTOMATON_HAS_PREFIX}.
   */
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/FST.java`
#### Snippet
```java
   *
   * @param inputString Serialized string
   * @return
   */
  protected Map<Integer, Integer> buildMap(String inputString) {
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/SegmentPushUtils.java`
#### Snippet
```java
   * @param fileSystem is the PinotFs used to copy segment tar file
   * @param segmentUriToTarPathMap contains the map of segment DownloadURI to segment tar file path
   * @throws Exception
   */
  public static void sendSegmentUriAndMetadata(SegmentGenerationJobSpec spec, PinotFS fileSystem,
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/SegmentPushUtils.java`
#### Snippet
```java
   * @param fileSystem is the PinotFs used to copy segment tar file
   * @param segmentUriToTarPathMap contains the map of segment DownloadURI to segment tar file path
   * @throws Exception
   */
  public static void sendSegmentUriAndMetadata(SegmentGenerationJobSpec spec, PinotFS fileSystem,
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/mutablefst/MutableFST.java`
#### Snippet
```java
  /**
   * The start state in the FST; there must be exactly one
   * @return
   */
  MutableState getStartState();
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/loader/LoaderUtils.java`
#### Snippet
```java
   * @param indexFile index file to write from.
   * @param indexType index type.
   * @throws IOException
   */
  public static void writeIndexToV3Format(SegmentDirectory.Writer segmentWriter, String column, File indexFile,
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/loader/defaultcolumn/DefaultColumnHandler.java`
#### Snippet
```java
   * <p>Supported default column actions include: <code>ADD/UPDATE/REMOVE DIMENSION/METRIC</code>
   *
   * @throws Exception
   */
  void updateDefaultColumns()
```

### JavadocDeclaration
`@param sortedValues` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/readers/BaseImmutableDictionary.java`
#### Snippet
```java
  /**
   * Returns the dictionary id for the given sorted values.
   * @param sortedValues
   * @param dictIds
   */
```

### JavadocDeclaration
`@param dictIds` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/readers/BaseImmutableDictionary.java`
#### Snippet
```java
   * Returns the dictionary id for the given sorted values.
   * @param sortedValues
   * @param dictIds
   */
  @Override
```

### JavadocDeclaration
`@param value` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/readers/RangeIndexReaderImpl.java`
#### Snippet
```java
   * Find the rangeIndex that the value falls in
   * Note this assumes that the value is in one of the range.
   * @param value
   * @return
   */
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/readers/RangeIndexReaderImpl.java`
#### Snippet
```java
   * Note this assumes that the value is in one of the range.
   * @param value
   * @return
   */
  private int findRangeId(int value) {
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/readers/text/LuceneTextIndexReader.java`
#### Snippet
```java
   * (for each column) are destroyed and as part of that
   * we release the text index
   * @throws IOException
   */
  @Override
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/creator/impl/fwd/SingleValueFixedByteRawIndexCreator.java`
#### Snippet
```java
   * @param valueType Type of the values
   * @param writerVersion writer format version
   * @throws IOException
   */
  public SingleValueFixedByteRawIndexCreator(File baseIndexDir, ChunkCompressionType compressionType, String column,
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/creator/impl/fwd/SingleValueFixedByteRawIndexCreator.java`
#### Snippet
```java
   * @param totalDocs Total number of documents to index
   * @param valueType Type of the values
   * @throws IOException
   */
  public SingleValueFixedByteRawIndexCreator(File baseIndexDir, ChunkCompressionType compressionType, String column,
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/creator/impl/fwd/SingleValueVarByteRawIndexCreator.java`
#### Snippet
```java
   * @param deriveNumDocsPerChunk true if writer should auto-derive the number of rows per chunk
   * @param writerVersion writer format version
   * @throws IOException
   */
  public SingleValueVarByteRawIndexCreator(File baseIndexDir, ChunkCompressionType compressionType, String column,
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/creator/impl/fwd/SingleValueVarByteRawIndexCreator.java`
#### Snippet
```java
   * @param valueType Type of the values
   * @param maxLength length of longest entry (in bytes)
   * @throws IOException
   */
  public SingleValueVarByteRawIndexCreator(File baseIndexDir, ChunkCompressionType compressionType, String column,
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/creator/impl/inv/text/LuceneFSTIndexCreator.java`
#### Snippet
```java
   * @param columnName Column name for which index is being created
   * @param sortedEntries Sorted entries of the unique values of the column.
   * @throws IOException
   */
  public LuceneFSTIndexCreator(File indexDir, String columnName, String[] sortedEntries)
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/creator/impl/inv/RangeIndexCreator.java`
#### Snippet
```java
   * @param numValues total number of values, used for Multi value columns (for single value columns numDocs==
   *                  numValues)
   * @throws IOException
   */
  public RangeIndexCreator(File indexDir, FieldSpec fieldSpec, DataType valueType, int numRanges, int numValuesPerRange,
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/creator/impl/inv/RangeIndexCreator.java`
#### Snippet
```java
   * 15:18:47.372 RangeIndexCreator - rangeValues = [ (0,0) ,(1,1) ,(2,2) ,(3,3) ,(4,4) , ]
   *
   * @throws IOException
   */
  @Override
```

### JavadocDeclaration
`@param columnName` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/realtime/impl/RealtimeSegmentStatsHistory.java`
#### Snippet
```java
   * For now, we return the average value.
   *
   * @param columnName
   * @return estimated
   */
```

### JavadocDeclaration
`@param historyFilePath` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/realtime/impl/RealtimeSegmentStatsHistory.java`
#### Snippet
```java
   * Constructor called when there is no file present.
   *
   * @param historyFilePath
   */
  private RealtimeSegmentStatsHistory(String historyFilePath) {
```

### JavadocDeclaration
`@param columnName` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/realtime/impl/RealtimeSegmentStatsHistory.java`
#### Snippet
```java
   * For now, we return the average value.
   *
   * @param columnName
   * @return estimated average string size
   */
```

### JavadocDeclaration
`@return` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/realtime/impl/RealtimeSegmentConfig.java`
#### Snippet
```java
   * Used by {@link MutableSegmentImpl} when
   * it starts consuming/indexing.
   * @return
   */
  public Set<String> getTextIndexColumns() {
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/startree/v2/builder/OffHeapSingleTreeBuilder.java`
#### Snippet
```java
   * @param segment Index segment
   * @param metadataProperties Segment metadata properties
   * @throws FileNotFoundException
   */
  public OffHeapSingleTreeBuilder(StarTreeV2BuilderConfig builderConfig, File outputDir, ImmutableSegment segment,
```

### JavadocDeclaration
Tag `goal` is not allowed here
in `contrib/pinot-fmpp-maven-plugin/src/main/java/org/apache/pinot/fmpp/FMPPMojo.java`
#### Snippet
```java
 * (if output has not changed, the files are not touched)
 *
 * @goal generate
 * @phase generate-sources
 */
```

### JavadocDeclaration
Tag `phase` is not allowed here
in `contrib/pinot-fmpp-maven-plugin/src/main/java/org/apache/pinot/fmpp/FMPPMojo.java`
#### Snippet
```java
 *
 * @goal generate
 * @phase generate-sources
 */
public class FMPPMojo extends AbstractMojo {
```

### JavadocDeclaration
Wrong tag `parameter`
in `contrib/pinot-fmpp-maven-plugin/src/main/java/org/apache/pinot/fmpp/FMPPMojo.java`
#### Snippet
```java
   * Location of the FreeMarker config file.
   *
   * @parameter default-value="src/main/resources/fmpp/config.fmpp"
   * @required
   */
```

### JavadocDeclaration
Wrong tag `required`
in `contrib/pinot-fmpp-maven-plugin/src/main/java/org/apache/pinot/fmpp/FMPPMojo.java`
#### Snippet
```java
   *
   * @parameter default-value="src/main/resources/fmpp/config.fmpp"
   * @required
   */
  private File config;
```

### JavadocDeclaration
Wrong tag `parameter`
in `contrib/pinot-fmpp-maven-plugin/src/main/java/org/apache/pinot/fmpp/FMPPMojo.java`
#### Snippet
```java
   * Where to find the FreeMarker template files.
   *
   * @parameter default-value="src/main/resources/fmpp/templates/"
   * @required
   */
```

### JavadocDeclaration
Wrong tag `required`
in `contrib/pinot-fmpp-maven-plugin/src/main/java/org/apache/pinot/fmpp/FMPPMojo.java`
#### Snippet
```java
   *
   * @parameter default-value="src/main/resources/fmpp/templates/"
   * @required
   */
  private File templates;
```

### JavadocDeclaration
Wrong tag `parameter`
in `contrib/pinot-fmpp-maven-plugin/src/main/java/org/apache/pinot/fmpp/FMPPMojo.java`
#### Snippet
```java
   * Used to add new source directories to the build.
   *
   * @parameter default-value="${project}"
   * @required
   * @readonly
```

### JavadocDeclaration
Wrong tag `required`
in `contrib/pinot-fmpp-maven-plugin/src/main/java/org/apache/pinot/fmpp/FMPPMojo.java`
#### Snippet
```java
   *
   * @parameter default-value="${project}"
   * @required
   * @readonly
   **/
```

### JavadocDeclaration
Wrong tag `readonly`
in `contrib/pinot-fmpp-maven-plugin/src/main/java/org/apache/pinot/fmpp/FMPPMojo.java`
#### Snippet
```java
   * @parameter default-value="${project}"
   * @required
   * @readonly
   **/
  private MavenProject project;
```

### JavadocDeclaration
Wrong tag `parameter`
in `contrib/pinot-fmpp-maven-plugin/src/main/java/org/apache/pinot/fmpp/FMPPMojo.java`
#### Snippet
```java
   * if maven properties are added as data
   *
   * @parameter default-value="true"
   * @required
   */
```

### JavadocDeclaration
Wrong tag `required`
in `contrib/pinot-fmpp-maven-plugin/src/main/java/org/apache/pinot/fmpp/FMPPMojo.java`
#### Snippet
```java
   *
   * @parameter default-value="true"
   * @required
   */
  private boolean addMavenDataLoader;
```

### JavadocDeclaration
Wrong tag `parameter`
in `contrib/pinot-fmpp-maven-plugin/src/main/java/org/apache/pinot/fmpp/FMPPMojo.java`
#### Snippet
```java
   * Where to write the generated files of the output files.
   *
   * @parameter default-value="${project.build.directory}/generated-sources/fmpp/"
   * @required
   */
```

### JavadocDeclaration
Wrong tag `required`
in `contrib/pinot-fmpp-maven-plugin/src/main/java/org/apache/pinot/fmpp/FMPPMojo.java`
#### Snippet
```java
   *
   * @parameter default-value="${project.build.directory}/generated-sources/fmpp/"
   * @required
   */
  private File output;
```

### JavadocDeclaration
Wrong tag `parameter`
in `contrib/pinot-fmpp-maven-plugin/src/main/java/org/apache/pinot/fmpp/FMPPMojo.java`
#### Snippet
```java
   *
   * @see <a href="http://fmpp.sourceforge.net/settings.html#key_data">FMPP Data Model Building</a>
   * @parameter default-value=""
   */
  private String data;
```

### JavadocDeclaration
Wrong tag `parameter`
in `contrib/pinot-fmpp-maven-plugin/src/main/java/org/apache/pinot/fmpp/FMPPMojo.java`
#### Snippet
```java
   * compilation scope to be added to ("compile" or "test")
   *
   * @parameter default-value="compile"
   * @required
   */
```

### JavadocDeclaration
Wrong tag `required`
in `contrib/pinot-fmpp-maven-plugin/src/main/java/org/apache/pinot/fmpp/FMPPMojo.java`
#### Snippet
```java
   *
   * @parameter default-value="compile"
   * @required
   */
  private String scope;
```

### JavadocDeclaration
`@throws` tag description is missing
in `pinot-plugins/pinot-segment-writer/pinot-segment-writer-file-based/src/main/java/org/apache/pinot/plugin/segmentwriter/filebased/FileBasedSegmentWriter.java`
#### Snippet
```java
   *
   * @return URI of the generated segment
   * @throws IOException
   */
  @Override
```

## RuleId[id=FieldMayBeFinal]
### FieldMayBeFinal
Field `_schema` may be 'final'
in `pinot-query-planner/src/main/java/org/apache/pinot/query/catalog/PinotTable.java`
#### Snippet
```java
 */
public class PinotTable extends AbstractTable implements ScannableTable {
  private Schema _schema;

  public PinotTable(Schema schema) {
```

### FieldMayBeFinal
Field `_explainPlan` may be 'final'
in `pinot-query-planner/src/main/java/org/apache/pinot/query/QueryEnvironment.java`
#### Snippet
```java
  public static class QueryPlannerResult {
    private QueryPlan _queryPlan;
    private String _explainPlan;
    Set<String> _tableNames;

```

### FieldMayBeFinal
Field `_queryPlan` may be 'final'
in `pinot-query-planner/src/main/java/org/apache/pinot/query/QueryEnvironment.java`
#### Snippet
```java
   */
  public static class QueryPlannerResult {
    private QueryPlan _queryPlan;
    private String _explainPlan;
    Set<String> _tableNames;
```

### FieldMayBeFinal
Field `_traitDefs` may be 'final'
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/logical/LogicalPlanner.java`
#### Snippet
```java
public class LogicalPlanner extends HepPlanner {

  private List<RelTraitDef> _traitDefs;

  public LogicalPlanner(HepProgram program, Context context) {
```

### FieldMayBeFinal
Field `_scannedTables` may be 'final'
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/physical/DispatchablePlanMetadata.java`
#### Snippet
```java
 */
public class DispatchablePlanMetadata implements Serializable {
  private List<String> _scannedTables;

  // used for assigning server/worker nodes.
```

### FieldMayBeFinal
Field `_requestId` may be 'final'
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/logical/StagePlanner.java`
#### Snippet
```java
  private final TableCache _tableCache;
  private int _stageIdCounter;
  private long _requestId;

  public StagePlanner(PlannerContext plannerContext, WorkerManager workerManager, long requestId,
```

### FieldMayBeFinal
Field `_numPartitions` may be 'final'
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/physical/colocated/ColocationKey.java`
#### Snippet
```java
class ColocationKey {
  private List<Integer> _indices;
  private int _numPartitions;
  private String _hashAlgorithm;

```

### FieldMayBeFinal
Field `_hashAlgorithm` may be 'final'
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/physical/colocated/ColocationKey.java`
#### Snippet
```java
  private List<Integer> _indices;
  private int _numPartitions;
  private String _hashAlgorithm;

  public List<Integer> getIndices() {
```

### FieldMayBeFinal
Field `_indices` may be 'final'
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/physical/colocated/ColocationKey.java`
#### Snippet
```java
 */
class ColocationKey {
  private List<Integer> _indices;
  private int _numPartitions;
  private String _hashAlgorithm;
```

### FieldMayBeFinal
Field `_customProperties` may be 'final'
in `pinot-query-planner/src/main/java/org/apache/pinot/query/routing/WorkerMetadata.java`
#### Snippet
```java
    public static final String TABLE_SEGMENTS_MAP_KEY = "tableSegmentsMap";
    private VirtualServerAddress _virtualServerAddress;
    private Map<String, String> _customProperties;

    public Builder() {
```

### FieldMayBeFinal
Field `_customProperties` may be 'final'
in `pinot-query-planner/src/main/java/org/apache/pinot/query/routing/StageMetadata.java`
#### Snippet
```java
    public static final String TIME_BOUNDARY_VALUE_KEY = "timeBoundaryInfo.timeValue";
    private List<WorkerMetadata> _workerMetadataList;
    private Map<String, String> _customProperties;

    public Builder() {
```

### FieldMayBeFinal
Field `_missingPinotColumn` may be 'final'
in `pinot-plugins/pinot-input-format/pinot-avro-base/src/main/java/org/apache/pinot/plugin/inputformat/avro/AvroIngestionSchemaValidator.java`
#### Snippet
```java
  private SchemaValidatorResult _singleValueMultiValueFieldMismatch = new SchemaValidatorResult();
  private SchemaValidatorResult _multiValueStructureMismatch = new SchemaValidatorResult();
  private SchemaValidatorResult _missingPinotColumn = new SchemaValidatorResult();

  public AvroIngestionSchemaValidator() {
```

### FieldMayBeFinal
Field `_singleValueMultiValueFieldMismatch` may be 'final'
in `pinot-plugins/pinot-input-format/pinot-avro-base/src/main/java/org/apache/pinot/plugin/inputformat/avro/AvroIngestionSchemaValidator.java`
#### Snippet
```java

  private SchemaValidatorResult _dataTypeMismatch = new SchemaValidatorResult();
  private SchemaValidatorResult _singleValueMultiValueFieldMismatch = new SchemaValidatorResult();
  private SchemaValidatorResult _multiValueStructureMismatch = new SchemaValidatorResult();
  private SchemaValidatorResult _missingPinotColumn = new SchemaValidatorResult();
```

### FieldMayBeFinal
Field `_multiValueStructureMismatch` may be 'final'
in `pinot-plugins/pinot-input-format/pinot-avro-base/src/main/java/org/apache/pinot/plugin/inputformat/avro/AvroIngestionSchemaValidator.java`
#### Snippet
```java
  private SchemaValidatorResult _dataTypeMismatch = new SchemaValidatorResult();
  private SchemaValidatorResult _singleValueMultiValueFieldMismatch = new SchemaValidatorResult();
  private SchemaValidatorResult _multiValueStructureMismatch = new SchemaValidatorResult();
  private SchemaValidatorResult _missingPinotColumn = new SchemaValidatorResult();

```

### FieldMayBeFinal
Field `_dataTypeMismatch` may be 'final'
in `pinot-plugins/pinot-input-format/pinot-avro-base/src/main/java/org/apache/pinot/plugin/inputformat/avro/AvroIngestionSchemaValidator.java`
#### Snippet
```java
  private Schema _pinotSchema;

  private SchemaValidatorResult _dataTypeMismatch = new SchemaValidatorResult();
  private SchemaValidatorResult _singleValueMultiValueFieldMismatch = new SchemaValidatorResult();
  private SchemaValidatorResult _multiValueStructureMismatch = new SchemaValidatorResult();
```

### FieldMayBeFinal
Field `_mismatchReason` may be 'final'
in `pinot-spi/src/main/java/org/apache/pinot/spi/data/SchemaValidatorResult.java`
#### Snippet
```java
public class SchemaValidatorResult {
  private long _mismatchCount;
  private StringBuilder _mismatchReason;

  public SchemaValidatorResult() {
```

### FieldMayBeFinal
Field `_crypterMap` may be 'final'
in `pinot-spi/src/main/java/org/apache/pinot/spi/crypt/PinotCrypterFactory.java`
#### Snippet
```java
  public static final Logger LOGGER = LoggerFactory.getLogger(PinotCrypterFactory.class);
  // Map of lower case simple class name to PinotCrypter object
  private static Map<String, PinotCrypter> _crypterMap = new HashMap<>();
  private static final String NOOP_PINOT_CRYPTER = "nooppinotcrypter";
  private static final String CLASS = "class";
```

### FieldMayBeFinal
Field `_taskName` may be 'final'
in `pinot-spi/src/main/java/org/apache/pinot/spi/config/task/AdhocTaskConfig.java`
#### Snippet
```java
  private String _taskType;
  private String _tableName;
  private String _taskName;
  private Map<String, String> _taskConfigs;

```

### FieldMayBeFinal
Field `_tableName` may be 'final'
in `pinot-spi/src/main/java/org/apache/pinot/spi/config/task/AdhocTaskConfig.java`
#### Snippet
```java
public class AdhocTaskConfig extends BaseJsonConfig {
  private String _taskType;
  private String _tableName;
  private String _taskName;
  private Map<String, String> _taskConfigs;
```

### FieldMayBeFinal
Field `_taskConfigs` may be 'final'
in `pinot-spi/src/main/java/org/apache/pinot/spi/config/task/AdhocTaskConfig.java`
#### Snippet
```java
  private String _tableName;
  private String _taskName;
  private Map<String, String> _taskConfigs;

  @JsonCreator
```

### FieldMayBeFinal
Field `_taskType` may be 'final'
in `pinot-spi/src/main/java/org/apache/pinot/spi/config/task/AdhocTaskConfig.java`
#### Snippet
```java
 */
public class AdhocTaskConfig extends BaseJsonConfig {
  private String _taskType;
  private String _tableName;
  private String _taskName;
```

### FieldMayBeFinal
Field `_tables` may be 'final'
in `pinot-spi/src/main/java/org/apache/pinot/spi/config/user/UserConfig.java`
#### Snippet
```java

    @JsonPropertyDescription("The tables owned of User")
    private List<String> _tables;

    @JsonPropertyDescription("The table permission of User")
```

### FieldMayBeFinal
Field `_username` may be 'final'
in `pinot-spi/src/main/java/org/apache/pinot/spi/config/user/UserConfig.java`
#### Snippet
```java

    @JsonPropertyDescription("The name of User")
    private String _username;

    @JsonPropertyDescription("The password of User")
```

### FieldMayBeFinal
Field `_componentType` may be 'final'
in `pinot-spi/src/main/java/org/apache/pinot/spi/config/user/UserConfig.java`
#### Snippet
```java

    @JsonPropertyDescription("The name of Component")
    private ComponentType _componentType;

    @JsonPropertyDescription("The role of user")
```

### FieldMayBeFinal
Field `_permissions` may be 'final'
in `pinot-spi/src/main/java/org/apache/pinot/spi/config/user/UserConfig.java`
#### Snippet
```java

    @JsonPropertyDescription("The table permission of User")
    private List<AccessType> _permissions;

    @JsonCreator
```

### FieldMayBeFinal
Field `_ingestionState` may be 'final'
in `pinot-spi/src/main/java/org/apache/pinot/spi/config/table/TableStatus.java`
#### Snippet
```java
  @JsonIgnoreProperties(ignoreUnknown = true)
  public static class IngestionStatus {
    private IngestionState _ingestionState;
    private String _errorMessage;

```

### FieldMayBeFinal
Field `_errorMessage` may be 'final'
in `pinot-spi/src/main/java/org/apache/pinot/spi/config/table/TableStatus.java`
#### Snippet
```java
  public static class IngestionStatus {
    private IngestionState _ingestionState;
    private String _errorMessage;

    public IngestionStatus(@JsonProperty("ingestionState") String ingestionState,
```

### FieldMayBeFinal
Field `_ingestionStatus` may be 'final'
in `pinot-spi/src/main/java/org/apache/pinot/spi/config/table/TableStatus.java`
#### Snippet
```java
public class TableStatus {

  private IngestionStatus _ingestionStatus;

  public enum IngestionState {
```

### FieldMayBeFinal
Field `_it` may be 'final'
in `pinot-spi/src/main/java/org/apache/pinot/spi/plugin/PluginClassLoader.java`
#### Snippet
```java

    return new Enumeration<URL>() {
      Iterator<URL> _it = allRes.iterator();

      @Override
```

### FieldMayBeFinal
Field `_registry` may be 'final'
in `pinot-spi/src/main/java/org/apache/pinot/spi/plugin/PluginManager.java`
#### Snippet
```java
      };

  private Map<Plugin, PluginClassLoader> _registry = new HashMap<>();
  private String _pluginsDirectories;
  private String _pluginsInclude;
```

### FieldMayBeFinal
Field `_offsetCriteria` may be 'final'
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/OffsetCriteria.java`
#### Snippet
```java
   */
  public static class OffsetCriteriaBuilder {
    private OffsetCriteria _offsetCriteria;

    public OffsetCriteriaBuilder() {
```

### FieldMayBeFinal
Field `_customProperties` may be 'final'
in `pinot-spi/src/main/java/org/apache/pinot/spi/ingestion/batch/spec/SegmentGenerationTaskSpec.java`
#### Snippet
```java
   * Custom properties set into segment metadata
   */
  private Map<String, String> _customProperties = new HashMap<>();

  public TableConfig getTableConfig() {
```

### FieldMayBeFinal
Field `_resultsArray` may be 'final'
in `pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/SelectionResultSet.java`
#### Snippet
```java
 */
class SelectionResultSet extends AbstractResultSet {
  private JsonNode _resultsArray;
  private JsonNode _columnsArray;

```

### FieldMayBeFinal
Field `_columnsArray` may be 'final'
in `pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/SelectionResultSet.java`
#### Snippet
```java
class SelectionResultSet extends AbstractResultSet {
  private JsonNode _resultsArray;
  private JsonNode _columnsArray;

  public SelectionResultSet(JsonNode selectionResults) {
```

### FieldMayBeFinal
Field `_zkClient` may be 'final'
in `pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/ExternalViewReader.java`
#### Snippet
```java
  public static final String KEY_HELIX_PORT = "HELIX_PORT";

  private ZkClient _zkClient;

  @VisibleForTesting
```

### FieldMayBeFinal
Field `_consumerOffsets` may be 'final'
in `pinot-plugins/pinot-stream-ingestion/pinot-kafka-2.0/src/main/java/org/apache/pinot/plugin/stream/kafka20/KafkaStreamLevelConsumer.java`
#### Snippet
```java
  private ConsumerRecords<Bytes, Bytes> _consumerRecords;
  private Iterator<ConsumerRecord<Bytes, Bytes>> _kafkaIterator;
  private Map<Integer, Long> _consumerOffsets = new HashMap<>(); // tracking current consumed records offsets.

  private long _lastLogTime = 0;
```

### FieldMayBeFinal
Field `_kafkaTopicName` may be 'final'
in `pinot-plugins/pinot-stream-ingestion/pinot-kafka-2.0/src/main/java/org/apache/pinot/plugin/stream/kafka20/KafkaStreamLevelStreamConfig.java`
#### Snippet
```java
  }};

  private String _kafkaTopicName;
  private String _groupId;
  private String _bootstrapServers;
```

### FieldMayBeFinal
Field `_groupId` may be 'final'
in `pinot-plugins/pinot-stream-ingestion/pinot-kafka-2.0/src/main/java/org/apache/pinot/plugin/stream/kafka20/KafkaStreamLevelStreamConfig.java`
#### Snippet
```java

  private String _kafkaTopicName;
  private String _groupId;
  private String _bootstrapServers;
  private Map<String, String> _kafkaConsumerProperties;
```

### FieldMayBeFinal
Field `_bootstrapServers` may be 'final'
in `pinot-plugins/pinot-stream-ingestion/pinot-kafka-2.0/src/main/java/org/apache/pinot/plugin/stream/kafka20/KafkaStreamLevelStreamConfig.java`
#### Snippet
```java
  private String _kafkaTopicName;
  private String _groupId;
  private String _bootstrapServers;
  private Map<String, String> _kafkaConsumerProperties;

```

### FieldMayBeFinal
Field `_kafkaConsumerProperties` may be 'final'
in `pinot-plugins/pinot-stream-ingestion/pinot-kafka-2.0/src/main/java/org/apache/pinot/plugin/stream/kafka20/KafkaStreamLevelStreamConfig.java`
#### Snippet
```java
  private String _groupId;
  private String _bootstrapServers;
  private Map<String, String> _kafkaConsumerProperties;

  /**
```

### FieldMayBeFinal
Field `_tableName` may be 'final'
in `pinot-common/src/main/java/org/apache/pinot/sql/parsers/parser/SqlInsertFromFile.java`
#### Snippet
```java
  private static final SqlSpecialOperator OPERATOR = new SqlSpecialOperator("UDF", SqlKind.OTHER_DDL);
  private SqlIdentifier _dbName;
  private SqlIdentifier _tableName;
  private SqlNodeList _fileList;

```

### FieldMayBeFinal
Field `_fileList` may be 'final'
in `pinot-common/src/main/java/org/apache/pinot/sql/parsers/parser/SqlInsertFromFile.java`
#### Snippet
```java
  private SqlIdentifier _dbName;
  private SqlIdentifier _tableName;
  private SqlNodeList _fileList;

  public SqlInsertFromFile(SqlParserPos pos, SqlIdentifier dbName, SqlIdentifier tableName, SqlNodeList fileList) {
```

### FieldMayBeFinal
Field `_dbName` may be 'final'
in `pinot-common/src/main/java/org/apache/pinot/sql/parsers/parser/SqlInsertFromFile.java`
#### Snippet
```java
public class SqlInsertFromFile extends SqlCall {
  private static final SqlSpecialOperator OPERATOR = new SqlSpecialOperator("UDF", SqlKind.OTHER_DDL);
  private SqlIdentifier _dbName;
  private SqlIdentifier _tableName;
  private SqlNodeList _fileList;
```

### FieldMayBeFinal
Field `_response` may be 'final'
in `pinot-common/src/main/java/org/apache/pinot/common/utils/SimpleHttpResponse.java`
#### Snippet
```java
public class SimpleHttpResponse {
  private int _statusCode;
  private String _response;

  public SimpleHttpResponse(int statusCode, String response) {
```

### FieldMayBeFinal
Field `_statusCode` may be 'final'
in `pinot-common/src/main/java/org/apache/pinot/common/utils/SimpleHttpResponse.java`
#### Snippet
```java

public class SimpleHttpResponse {
  private int _statusCode;
  private String _response;

```

### FieldMayBeFinal
Field `_port` may be 'final'
in `pinot-common/src/main/java/org/apache/pinot/common/utils/ZkStarter.java`
#### Snippet
```java
    private PublicZooKeeperServerMain _serverMain;
    private String _dataDirPath;
    private int _port;

    private ZookeeperInstance(PublicZooKeeperServerMain serverMain, String dataDirPath, int port) {
```

### FieldMayBeFinal
Field `_dataDirPath` may be 'final'
in `pinot-common/src/main/java/org/apache/pinot/common/utils/ZkStarter.java`
#### Snippet
```java
  public static class ZookeeperInstance {
    private PublicZooKeeperServerMain _serverMain;
    private String _dataDirPath;
    private int _port;

```

### FieldMayBeFinal
Field `_statMap` may be 'final'
in `pinot-common/src/main/java/org/apache/pinot/common/utils/helix/FakePropertyStore.java`
#### Snippet
```java
public class FakePropertyStore extends ZkHelixPropertyStore<ZNRecord> {
  private Map<String, ZNRecord> _contents = new HashMap<>();
  private Map<String, Stat> _statMap = new HashMap<>();
  private IZkDataListener _listener = null;

```

### FieldMayBeFinal
Field `_contents` may be 'final'
in `pinot-common/src/main/java/org/apache/pinot/common/utils/helix/FakePropertyStore.java`
#### Snippet
```java

public class FakePropertyStore extends ZkHelixPropertyStore<ZNRecord> {
  private Map<String, ZNRecord> _contents = new HashMap<>();
  private Map<String, Stat> _statMap = new HashMap<>();
  private IZkDataListener _listener = null;
```

### FieldMayBeFinal
Field `_isStartingCallable` may be 'final'
in `pinot-common/src/main/java/org/apache/pinot/common/utils/ServiceStatus.java`
#### Snippet
```java
  public static class LifecycleServiceStatusCallback implements ServiceStatusCallback {

    private Supplier<Boolean> _isStartingCallable;
    private Supplier<Boolean> _isShuttingDownCallable;

```

### FieldMayBeFinal
Field `_isShuttingDownCallable` may be 'final'
in `pinot-common/src/main/java/org/apache/pinot/common/utils/ServiceStatus.java`
#### Snippet
```java

    private Supplier<Boolean> _isStartingCallable;
    private Supplier<Boolean> _isShuttingDownCallable;

    public LifecycleServiceStatusCallback(Supplier<Boolean> isStartingCallable,
```

### FieldMayBeFinal
Field `_type` may be 'final'
in `pinot-common/src/main/java/org/apache/pinot/common/request/context/LiteralContext.java`
#### Snippet
```java
public class LiteralContext {
  // TODO: Support all of the types for sql.
  private FieldSpec.DataType _type;
  private Object _value;

```

### FieldMayBeFinal
Field `_bigDecimalValue` may be 'final'
in `pinot-common/src/main/java/org/apache/pinot/common/request/context/LiteralContext.java`
#### Snippet
```java
  private Object _value;

  private BigDecimal _bigDecimalValue;

  private static BigDecimal getBigDecimalValue(FieldSpec.DataType type, Object value) {
```

### FieldMayBeFinal
Field `_value` may be 'final'
in `pinot-common/src/main/java/org/apache/pinot/common/request/context/LiteralContext.java`
#### Snippet
```java
  // TODO: Support all of the types for sql.
  private FieldSpec.DataType _type;
  private Object _value;

  private BigDecimal _bigDecimalValue;
```

### FieldMayBeFinal
Field `_partitionMap` may be 'final'
in `pinot-common/src/main/java/org/apache/pinot/common/metadata/instance/InstanceZKMetadata.java`
#### Snippet
```java
  // Only care about realtime resources for now
  private Map<String, String> _groupIdMap = new HashMap<String, String>();
  private Map<String, String> _partitionMap = new HashMap<String, String>();

  public InstanceZKMetadata() {
```

### FieldMayBeFinal
Field `_groupIdMap` may be 'final'
in `pinot-common/src/main/java/org/apache/pinot/common/metadata/instance/InstanceZKMetadata.java`
#### Snippet
```java

  // Only care about realtime resources for now
  private Map<String, String> _groupIdMap = new HashMap<String, String>();
  private Map<String, String> _partitionMap = new HashMap<String, String>();

```

### FieldMayBeFinal
Field `_lookupTable` may be 'final'
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/offline/FastLookupDimensionTable.java`
#### Snippet
```java
class FastLookupDimensionTable implements DimensionTable {

  private Map<PrimaryKey, GenericRow> _lookupTable;
  private final Schema _tableSchema;
  private final List<String> _primaryKeyColumns;
```

### FieldMayBeFinal
Field `_metricEmitter` may be 'final'
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/RealtimeConsumptionRateManager.java`
#### Snippet
```java
    private final double _rate;
    private final RateLimiter _rateLimiter;
    private MetricEmitter _metricEmitter;

    private RateLimiterImpl(double rate, MetricEmitter metricEmitter) {
```

### FieldMayBeFinal
Field `_indexingThread` may be 'final'
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/HLRealtimeSegmentDataManager.java`
#### Snippet
```java
  private final ServerMetrics _serverMetrics;
  private final RealtimeTableDataManager _notifier;
  private Thread _indexingThread;

  private final String _sortedColumn;
```

### FieldMayBeFinal
Field `_lastUpdatedRawDocuments` may be 'final'
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/HLRealtimeSegmentDataManager.java`
#### Snippet
```java
  private final long _start = System.currentTimeMillis();
  private long _segmentEndTimeThreshold;
  private AtomicLong _lastUpdatedRawDocuments = new AtomicLong(0);

  private volatile boolean _keepIndexing = true;
```

### FieldMayBeFinal
Field `_numColumns` may be 'final'
in `pinot-core/src/main/java/org/apache/pinot/core/common/datablock/DataBlockBuilder.java`
#### Snippet
```java

  private int _numRows;
  private int _numColumns;

  private final Object2IntOpenHashMap<String> _dictionary = new Object2IntOpenHashMap<>();
```

### FieldMayBeFinal
Field `_inputTimeUnit` may be 'final'
in `pinot-core/src/main/java/org/apache/pinot/core/operator/transform/transformer/timeunit/CustomTimeUnitTransformer.java`
#### Snippet
```java
 */
public class CustomTimeUnitTransformer implements TimeUnitTransformer {
  private TimeUnit _inputTimeUnit;
  private CustomTimeUnit _outputTimeUnit;

```

### FieldMayBeFinal
Field `_outputTimeUnit` may be 'final'
in `pinot-core/src/main/java/org/apache/pinot/core/operator/transform/transformer/timeunit/CustomTimeUnitTransformer.java`
#### Snippet
```java
public class CustomTimeUnitTransformer implements TimeUnitTransformer {
  private TimeUnit _inputTimeUnit;
  private CustomTimeUnit _outputTimeUnit;

  private enum CustomTimeUnit {
```

### FieldMayBeFinal
Field `_innerHelixManager` may be 'final'
in `pinot-core/src/main/java/org/apache/pinot/server/access/ZkBasicAuthAccessFactory.java`
#### Snippet
```java
        private Map<String, ZkBasicAuthPrincipal> _name2principal;
        private AccessControlUserCache _userCache;
        private HelixManager _innerHelixManager;

        public BasicAuthAccessControl(HelixManager helixManager) {
```

### FieldMayBeFinal
Field `_fieldValue` may be 'final'
in `pinot-plugins/pinot-input-format/pinot-protobuf/src/main/java/org/apache/pinot/plugin/inputformat/protobuf/ProtoBufFieldInfo.java`
#### Snippet
```java
public class ProtoBufFieldInfo {

  private Object _fieldValue;
  private Descriptors.FieldDescriptor _fieldDescriptor;

```

### FieldMayBeFinal
Field `_fieldDescriptor` may be 'final'
in `pinot-plugins/pinot-input-format/pinot-protobuf/src/main/java/org/apache/pinot/plugin/inputformat/protobuf/ProtoBufFieldInfo.java`
#### Snippet
```java

  private Object _fieldValue;
  private Descriptors.FieldDescriptor _fieldDescriptor;

  public ProtoBufFieldInfo(Object fieldValue, Descriptors.FieldDescriptor fieldDescriptor) {
```

### FieldMayBeFinal
Field `_asyncSessionUpdateEnabled` may be 'final'
in `pinot-plugins/pinot-stream-ingestion/pinot-kinesis/src/main/java/org/apache/pinot/plugin/stream/kinesis/KinesisConfig.java`
#### Snippet
```java
  private String _externalId;
  private int _sessionDurationSeconds;
  private boolean _asyncSessionUpdateEnabled;
  private int _rpsLimit;

```

### FieldMayBeFinal
Field `_roleSessionName` may be 'final'
in `pinot-plugins/pinot-stream-ingestion/pinot-kinesis/src/main/java/org/apache/pinot/plugin/stream/kinesis/KinesisConfig.java`
#### Snippet
```java
  private boolean _iamRoleBasedAccess;
  private String _roleArn;
  private String _roleSessionName;
  private String _externalId;
  private int _sessionDurationSeconds;
```

### FieldMayBeFinal
Field `_iamRoleBasedAccess` may be 'final'
in `pinot-plugins/pinot-stream-ingestion/pinot-kinesis/src/main/java/org/apache/pinot/plugin/stream/kinesis/KinesisConfig.java`
#### Snippet
```java

  // IAM Role values
  private boolean _iamRoleBasedAccess;
  private String _roleArn;
  private String _roleSessionName;
```

### FieldMayBeFinal
Field `_sessionDurationSeconds` may be 'final'
in `pinot-plugins/pinot-stream-ingestion/pinot-kinesis/src/main/java/org/apache/pinot/plugin/stream/kinesis/KinesisConfig.java`
#### Snippet
```java
  private String _roleSessionName;
  private String _externalId;
  private int _sessionDurationSeconds;
  private boolean _asyncSessionUpdateEnabled;
  private int _rpsLimit;
```

### FieldMayBeFinal
Field `_externalId` may be 'final'
in `pinot-plugins/pinot-stream-ingestion/pinot-kinesis/src/main/java/org/apache/pinot/plugin/stream/kinesis/KinesisConfig.java`
#### Snippet
```java
  private String _roleArn;
  private String _roleSessionName;
  private String _externalId;
  private int _sessionDurationSeconds;
  private boolean _asyncSessionUpdateEnabled;
```

### FieldMayBeFinal
Field `_roleArn` may be 'final'
in `pinot-plugins/pinot-stream-ingestion/pinot-kinesis/src/main/java/org/apache/pinot/plugin/stream/kinesis/KinesisConfig.java`
#### Snippet
```java
  // IAM Role values
  private boolean _iamRoleBasedAccess;
  private String _roleArn;
  private String _roleSessionName;
  private String _externalId;
```

### FieldMayBeFinal
Field `_streamConfig` may be 'final'
in `pinot-plugins/pinot-stream-ingestion/pinot-pulsar/src/main/java/org/apache/pinot/plugin/stream/pulsar/PulsarStreamLevelConsumer.java`
#### Snippet
```java
  private StreamMessageDecoder _messageDecoder;

  private StreamConfig _streamConfig;
  private PulsarConfig _pulsarStreamLevelStreamConfig;

```

### FieldMayBeFinal
Field `_logger` may be 'final'
in `pinot-plugins/pinot-stream-ingestion/pinot-pulsar/src/main/java/org/apache/pinot/plugin/stream/pulsar/PulsarStreamLevelConsumer.java`
#### Snippet
```java
 */
public class PulsarStreamLevelConsumer implements StreamLevelConsumer {
  private Logger _logger;

  private StreamMessageDecoder _messageDecoder;
```

### FieldMayBeFinal
Field `_pulsarStreamLevelStreamConfig` may be 'final'
in `pinot-plugins/pinot-stream-ingestion/pinot-pulsar/src/main/java/org/apache/pinot/plugin/stream/pulsar/PulsarStreamLevelConsumer.java`
#### Snippet
```java

  private StreamConfig _streamConfig;
  private PulsarConfig _pulsarStreamLevelStreamConfig;

  private Reader<byte[]> _reader;
```

### FieldMayBeFinal
Field `_messageDecoder` may be 'final'
in `pinot-plugins/pinot-stream-ingestion/pinot-pulsar/src/main/java/org/apache/pinot/plugin/stream/pulsar/PulsarStreamLevelConsumer.java`
#### Snippet
```java
  private Logger _logger;

  private StreamMessageDecoder _messageDecoder;

  private StreamConfig _streamConfig;
```

### FieldMayBeFinal
Field `_totalColumns` may be 'final'
in `pinot-clients/pinot-jdbc-client/src/main/java/org/apache/pinot/client/PinotResultMetadata.java`
#### Snippet
```java

public class PinotResultMetadata extends AbstractBaseResultSetMetadata {
  private int _totalColumns;
  private Map<Integer, String> _columns = new HashMap<>();
  private Map<Integer, String> _columnDataTypes = new HashMap<>();
```

### FieldMayBeFinal
Field `_columns` may be 'final'
in `pinot-clients/pinot-jdbc-client/src/main/java/org/apache/pinot/client/PinotResultMetadata.java`
#### Snippet
```java
public class PinotResultMetadata extends AbstractBaseResultSetMetadata {
  private int _totalColumns;
  private Map<Integer, String> _columns = new HashMap<>();
  private Map<Integer, String> _columnDataTypes = new HashMap<>();

```

### FieldMayBeFinal
Field `_controllerURL` may be 'final'
in `pinot-clients/pinot-jdbc-client/src/main/java/org/apache/pinot/client/PinotConnection.java`
#### Snippet
```java
  private org.apache.pinot.client.Connection _session;
  private boolean _closed;
  private String _controllerURL;
  private PinotControllerTransport _controllerTransport;
  private final Map<String, Object> _queryOptions = new HashMap<String, Object>();
```

### FieldMayBeFinal
Field `_totalColumns` may be 'final'
in `pinot-clients/pinot-jdbc-client/src/main/java/org/apache/pinot/client/PinotResultSet.java`
#### Snippet
```java
  private int _totalRows;
  private int _currentRow;
  private int _totalColumns;
  private Map<String, Integer> _columns = new HashMap<>();
  private Map<Integer, String> _columnDataTypes = new HashMap<>();
```

### FieldMayBeFinal
Field `_columns` may be 'final'
in `pinot-clients/pinot-jdbc-client/src/main/java/org/apache/pinot/client/PinotResultSet.java`
#### Snippet
```java
  private int _currentRow;
  private int _totalColumns;
  private Map<String, Integer> _columns = new HashMap<>();
  private Map<Integer, String> _columnDataTypes = new HashMap<>();
  private boolean _closed;
```

### FieldMayBeFinal
Field `_columnDataTypes` may be 'final'
in `pinot-clients/pinot-jdbc-client/src/main/java/org/apache/pinot/client/PinotResultSet.java`
#### Snippet
```java
  private int _totalColumns;
  private Map<String, Integer> _columns = new HashMap<>();
  private Map<Integer, String> _columnDataTypes = new HashMap<>();
  private boolean _closed;
  private boolean _wasNull = false;
```

### FieldMayBeFinal
Field `_getMethod` may be 'final'
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/CallableHttpGet.java`
#### Snippet
```java
  private static final Logger LOGGER = LoggerFactory.getLogger(CallableHttpGet.class);
  private HttpClient _client;
  private GetMethod _getMethod;

  CallableHttpGet(HttpClient client, GetMethod getMethod) {
```

### FieldMayBeFinal
Field `_client` may be 'final'
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/CallableHttpGet.java`
#### Snippet
```java
public class CallableHttpGet {
  private static final Logger LOGGER = LoggerFactory.getLogger(CallableHttpGet.class);
  private HttpClient _client;
  private GetMethod _getMethod;

```

### FieldMayBeFinal
Field `_isLeadControllerResourceEnabled` may be 'final'
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotLeadControllerRestletResource.java`
#### Snippet
```java
  @JsonIgnoreProperties(ignoreUnknown = true)
  public static class LeadControllerResponse {
    private boolean _isLeadControllerResourceEnabled;
    private Map<String, LeadControllerEntry> _leadControllerEntryMap;

```

### FieldMayBeFinal
Field `_leadControllerEntryMap` may be 'final'
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotLeadControllerRestletResource.java`
#### Snippet
```java
  public static class LeadControllerResponse {
    private boolean _isLeadControllerResourceEnabled;
    private Map<String, LeadControllerEntry> _leadControllerEntryMap;

    @JsonCreator
```

### FieldMayBeFinal
Field `_description` may be 'final'
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PauseStatus.java`
#### Snippet
```java
  private boolean _pauseFlag;
  private Set<String> _consumingSegments;
  private String _description;

  @JsonCreator
```

### FieldMayBeFinal
Field `_consumingSegments` may be 'final'
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PauseStatus.java`
#### Snippet
```java
public class PauseStatus {
  private boolean _pauseFlag;
  private Set<String> _consumingSegments;
  private String _description;

```

### FieldMayBeFinal
Field `_pauseFlag` may be 'final'
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PauseStatus.java`
#### Snippet
```java
@JsonInclude(JsonInclude.Include.NON_NULL)
public class PauseStatus {
  private boolean _pauseFlag;
  private Set<String> _consumingSegments;
  private String _description;
```

### FieldMayBeFinal
Field `_cachedTableNamesWithType` may be 'final'
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/SegmentStatusChecker.java`
#### Snippet
```java
  private TableSizeReader _tableSizeReader;

  private Set<String> _cachedTableNamesWithType = new HashSet<>();

  /**
```

### FieldMayBeFinal
Field `_processedTables` may be 'final'
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/SegmentStatusChecker.java`
#### Snippet
```java
    private int _offlineTableCount;
    private int _disabledTableCount;
    private Set<String> _processedTables = new HashSet<>();
  }
}
```

### FieldMayBeFinal
Field `_nextOffset` may be 'final'
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/realtime/segment/CommittingSegmentDescriptor.java`
#### Snippet
```java
  private long _segmentSizeBytes;
  private String _segmentLocation;
  private String _nextOffset;
  private SegmentMetadataImpl _segmentMetadata;

```

### FieldMayBeFinal
Field `_propertyStore` may be 'final'
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/realtime/MissingConsumingSegmentFinder.java`
#### Snippet
```java

  static class SegmentMetadataFetcher {
    private ZkHelixPropertyStore<ZNRecord> _propertyStore;
    private ControllerMetrics _controllerMetrics;

```

### FieldMayBeFinal
Field `_controllerMetrics` may be 'final'
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/realtime/MissingConsumingSegmentFinder.java`
#### Snippet
```java
  static class SegmentMetadataFetcher {
    private ZkHelixPropertyStore<ZNRecord> _propertyStore;
    private ControllerMetrics _controllerMetrics;

    public SegmentMetadataFetcher(ZkHelixPropertyStore<ZNRecord> propertyStore, ControllerMetrics controllerMetrics) {
```

### FieldMayBeFinal
Field `_tableRebalanceProgressStats` may be 'final'
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/rebalance/ZkBasedTableRebalanceObserver.java`
#### Snippet
```java
  private final String _rebalanceJobId;
  private final PinotHelixResourceManager _pinotHelixResourceManager;
  private TableRebalanceProgressStats _tableRebalanceProgressStats;
  // Keep track of number of updates. Useful during debugging.
  private int _numUpdatesToZk;
```

### FieldMayBeFinal
Field `_bytes` may be 'final'
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/rules/utils/FixedLenBitset.java`
#### Snippet
```java
public class FixedLenBitset {
  public static final int NO_INDEX_APPLICABLE = 0;
  private long[] _bytes;
  private final int _lenOfArray;
  private final int _size;
```

### FieldMayBeFinal
Field `_queriesDisabled` may be 'final'
in `pinot-server/src/main/java/org/apache/pinot/server/starter/ServerQueriesDisabledTracker.java`
#### Snippet
```java
  private final String _clusterName;
  private final String _instanceId;
  private AtomicBoolean _queriesDisabled = new AtomicBoolean();

  public ServerQueriesDisabledTracker(String helixClusterName, String instanceId, HelixManager helixManager,
```

### FieldMayBeFinal
Field `_queryRunner` may be 'final'
in `pinot-server/src/main/java/org/apache/pinot/server/worker/WorkerQueryServer.java`
#### Snippet
```java

  private QueryServer _queryWorkerService;
  private QueryRunner _queryRunner;
  private InstanceDataManager _instanceDataManager;
  private ServerMetrics _serverMetrics;
```

### FieldMayBeFinal
Field `_serverMetrics` may be 'final'
in `pinot-server/src/main/java/org/apache/pinot/server/worker/WorkerQueryServer.java`
#### Snippet
```java
  private QueryRunner _queryRunner;
  private InstanceDataManager _instanceDataManager;
  private ServerMetrics _serverMetrics;

  public WorkerQueryServer(PinotConfiguration configuration, InstanceDataManager instanceDataManager,
```

### FieldMayBeFinal
Field `_queryWorkerService` may be 'final'
in `pinot-server/src/main/java/org/apache/pinot/server/worker/WorkerQueryServer.java`
#### Snippet
```java
  private final HelixManager _helixManager;

  private QueryServer _queryWorkerService;
  private QueryRunner _queryRunner;
  private InstanceDataManager _instanceDataManager;
```

### FieldMayBeFinal
Field `_instanceDataManager` may be 'final'
in `pinot-server/src/main/java/org/apache/pinot/server/worker/WorkerQueryServer.java`
#### Snippet
```java
  private QueryServer _queryWorkerService;
  private QueryRunner _queryRunner;
  private InstanceDataManager _instanceDataManager;
  private ServerMetrics _serverMetrics;

```

### FieldMayBeFinal
Field `_numberOfRows` may be 'final'
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/realtime/provisioning/MemoryEstimator.java`
#### Snippet
```java
    private Schema _schema;
    private TableConfig _tableConfig;
    private int _numberOfRows;
    private boolean _deleteCsv;
    private File _workingDir;
```

### FieldMayBeFinal
Field `_tableConfig` may be 'final'
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/realtime/provisioning/MemoryEstimator.java`
#### Snippet
```java
    private SchemaWithMetaData _schemaWithMetadata;
    private Schema _schema;
    private TableConfig _tableConfig;
    private int _numberOfRows;
    private boolean _deleteCsv;
```

### FieldMayBeFinal
Field `_varLengthDictionaryColumns` may be 'final'
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/realtime/provisioning/MemoryEstimator.java`
#### Snippet
```java
  private Set<String> _invertedIndexColumns = new HashSet<>();
  private Set<String> _noDictionaryColumns = new HashSet<>();
  private Set<String> _varLengthDictionaryColumns = new HashSet<>();
  int _avgMultiValues;

```

### FieldMayBeFinal
Field `_sampleCompletedSegmentSizeBytes` may be 'final'
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/realtime/provisioning/MemoryEstimator.java`
#### Snippet
```java

  private SegmentMetadataImpl _segmentMetadata;
  private long _sampleCompletedSegmentSizeBytes;
  private Set<String> _invertedIndexColumns = new HashSet<>();
  private Set<String> _noDictionaryColumns = new HashSet<>();
```

### FieldMayBeFinal
Field `_workingDir` may be 'final'
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/realtime/provisioning/MemoryEstimator.java`
#### Snippet
```java
    private int _numberOfRows;
    private boolean _deleteCsv;
    private File _workingDir;

    public SegmentGenerator(SchemaWithMetaData schemaWithMetadata, Schema schema, TableConfig tableConfig,
```

### FieldMayBeFinal
Field `_deleteCsv` may be 'final'
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/realtime/provisioning/MemoryEstimator.java`
#### Snippet
```java
    private TableConfig _tableConfig;
    private int _numberOfRows;
    private boolean _deleteCsv;
    private File _workingDir;

```

### FieldMayBeFinal
Field `_schemaWithMetadata` may be 'final'
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/realtime/provisioning/MemoryEstimator.java`
#### Snippet
```java
    private static final Logger LOGGER = LoggerFactory.getLogger(SegmentGenerator.class);

    private SchemaWithMetaData _schemaWithMetadata;
    private Schema _schema;
    private TableConfig _tableConfig;
```

### FieldMayBeFinal
Field `_invertedIndexColumns` may be 'final'
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/realtime/provisioning/MemoryEstimator.java`
#### Snippet
```java
  private SegmentMetadataImpl _segmentMetadata;
  private long _sampleCompletedSegmentSizeBytes;
  private Set<String> _invertedIndexColumns = new HashSet<>();
  private Set<String> _noDictionaryColumns = new HashSet<>();
  private Set<String> _varLengthDictionaryColumns = new HashSet<>();
```

### FieldMayBeFinal
Field `_schema` may be 'final'
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/realtime/provisioning/MemoryEstimator.java`
#### Snippet
```java

    private SchemaWithMetaData _schemaWithMetadata;
    private Schema _schema;
    private TableConfig _tableConfig;
    private int _numberOfRows;
```

### FieldMayBeFinal
Field `_noDictionaryColumns` may be 'final'
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/realtime/provisioning/MemoryEstimator.java`
#### Snippet
```java
  private long _sampleCompletedSegmentSizeBytes;
  private Set<String> _invertedIndexColumns = new HashSet<>();
  private Set<String> _noDictionaryColumns = new HashSet<>();
  private Set<String> _varLengthDictionaryColumns = new HashSet<>();
  int _avgMultiValues;
```

### FieldMayBeFinal
Field `_segmentMetadata` may be 'final'
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/realtime/provisioning/MemoryEstimator.java`
#### Snippet
```java
  private final int _tableRetentionHours;

  private SegmentMetadataImpl _segmentMetadata;
  private long _sampleCompletedSegmentSizeBytes;
  private Set<String> _invertedIndexColumns = new HashSet<>();
```

### FieldMayBeFinal
Field `_workingDir` may be 'final'
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/realtime/provisioning/MemoryEstimator.java`
#### Snippet
```java
  // Working dir will contain statsFile and also the generated segment if requested.
  // It will get deleted after memory estimation is done.
  private File _workingDir;

  private String[][] _activeMemoryPerHost;
```

### FieldMayBeFinal
Field `_segmentNames` may be 'final'
in `pinot-server/src/main/java/org/apache/pinot/server/starter/helix/SegmentMessageHandlerFactory.java`
#### Snippet
```java

    private String _tableName;
    private Set<String> _segmentNames;

    public ForceCommitMessageHandler(ForceCommitMessage forceCommitMessage, ServerMetrics metrics,
```

### FieldMayBeFinal
Field `_tableName` may be 'final'
in `pinot-server/src/main/java/org/apache/pinot/server/starter/helix/SegmentMessageHandlerFactory.java`
#### Snippet
```java
  private class ForceCommitMessageHandler extends DefaultMessageHandler {

    private String _tableName;
    private Set<String> _segmentNames;

```

### FieldMayBeFinal
Field `_tableConfig` may be 'final'
in `pinot-connectors/pinot-flink-connector/src/main/java/org/apache/pinot/connector/flink/sink/PinotSinkFunction.java`
#### Snippet
```java
  private final PinotGenericRowConverter<T> _recordConverter;

  private TableConfig _tableConfig;
  private Schema _schema;

```

### FieldMayBeFinal
Field `_schema` may be 'final'
in `pinot-connectors/pinot-flink-connector/src/main/java/org/apache/pinot/connector/flink/sink/PinotSinkFunction.java`
#### Snippet
```java

  private TableConfig _tableConfig;
  private Schema _schema;

  private transient SegmentWriter _segmentWriter;
```

### FieldMayBeFinal
Field `_generationNumber` may be 'final'
in `pinot-compatibility-verifier/src/main/java/org/apache/pinot/compat/CompatibilityOpsRunner.java`
#### Snippet
```java
  private String _parentDir;
  private final String _configFileName;
  private int _generationNumber;

  private CompatibilityOpsRunner(String configFileName, int generationNumber) {
```

### FieldMayBeFinal
Field `_durationInDaysThreshold` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/ValidateTableRetention.java`
#### Snippet
```java
      description = "Optional duration in days threshold to log a warning for table with too large retention time,"
          + " default: " + TableRetentionValidator.DEFAULT_DURATION_IN_DAYS_THRESHOLD)
  private long _durationInDaysThreshold = TableRetentionValidator.DEFAULT_DURATION_IN_DAYS_THRESHOLD;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, usageHelp = true,
```

### FieldMayBeFinal
Field `_help` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/ValidateTableRetention.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, usageHelp = true,
      description = "Print this message.")
  private boolean _help = false;

  @Override
```

### FieldMayBeFinal
Field `_tableNamePattern` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/ValidateTableRetention.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-tableNamePattern"}, required = false,
      description = "Optional table name pattern trigger to add inverted index, default: null (match any table name)")
  private String _tableNamePattern = null;

  @CommandLine.Option(names = {"-durationInDaysThreshold"}, required = false,
```

### FieldMayBeFinal
Field `_url` may be 'final'
in `pinot-plugins/pinot-input-format/pinot-avro/src/main/java/org/apache/pinot/plugin/inputformat/avro/KafkaAvroMessageDecoder.java`
#### Snippet
```java
  private static class SchemaFetcher implements Callable<Boolean> {
    private org.apache.avro.Schema _schema;
    private URL _url;
    private boolean _isSuccessful = false;

```

### FieldMayBeFinal
Field `_schemas` may be 'final'
in `pinot-plugins/pinot-input-format/pinot-avro/src/main/java/org/apache/pinot/plugin/inputformat/avro/KafkaAvroMessageDecoder.java`
#### Snippet
```java
  private static class MD5AvroSchemaMap {
    private List<byte[]> _md5s;
    private List<org.apache.avro.Schema> _schemas;

    /**
```

### FieldMayBeFinal
Field `_md5s` may be 'final'
in `pinot-plugins/pinot-input-format/pinot-avro/src/main/java/org/apache/pinot/plugin/inputformat/avro/KafkaAvroMessageDecoder.java`
#### Snippet
```java
   */
  private static class MD5AvroSchemaMap {
    private List<byte[]> _md5s;
    private List<org.apache.avro.Schema> _schemas;

```

### FieldMayBeFinal
Field `_isSuccessful` may be 'final'
in `pinot-plugins/pinot-input-format/pinot-avro/src/main/java/org/apache/pinot/plugin/inputformat/avro/KafkaAvroMessageDecoder.java`
#### Snippet
```java
    private org.apache.avro.Schema _schema;
    private URL _url;
    private boolean _isSuccessful = false;

    SchemaFetcher(URL url) {
```

### FieldMayBeFinal
Field `_cardinalityThreshold` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/AutoAddInvertedIndexTool.java`
#### Snippet
```java
      description = "Optional cardinality threshold to trigger adding inverted index, default: "
          + AutoAddInvertedIndex.DEFAULT_CARDINALITY_THRESHOLD)
  private long _cardinalityThreshold = AutoAddInvertedIndex.DEFAULT_CARDINALITY_THRESHOLD;

  @CommandLine.Option(names = {"-maxNumInvertedIndex"}, required = false,
```

### FieldMayBeFinal
Field `_dryRun` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/PinotNumReplicaChanger.java`
#### Snippet
```java
  private static final Logger LOGGER = LoggerFactory.getLogger(PinotNumReplicaChanger.class);

  private boolean _dryRun;

  public PinotNumReplicaChanger(String zkAddress, String clusterName, boolean dryRun) {
```

### FieldMayBeFinal
Field `_strategy` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/AutoAddInvertedIndexTool.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-strategy"}, required = false,
      description = "Strategy to add inverted index (QUERY), default: QUERY")
  private AutoAddInvertedIndex.Strategy _strategy = AutoAddInvertedIndex.Strategy.QUERY;

  @CommandLine.Option(names = {"-mode"}, required = false,
```

### FieldMayBeFinal
Field `_help` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/AutoAddInvertedIndexTool.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, usageHelp = true,
      description = "Print this message.")
  private boolean _help = false;

  @Override
```

### FieldMayBeFinal
Field `_tableSizeThreshold` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/AutoAddInvertedIndexTool.java`
#### Snippet
```java
      description = "Optional table size threshold to trigger adding inverted index, default: "
          + AutoAddInvertedIndex.DEFAULT_TABLE_SIZE_THRESHOLD)
  private long _tableSizeThreshold = AutoAddInvertedIndex.DEFAULT_TABLE_SIZE_THRESHOLD;

  @CommandLine.Option(names = {"-cardinalityThreshold"}, required = false,
```

### FieldMayBeFinal
Field `_maxNumInvertedIndex` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/AutoAddInvertedIndexTool.java`
#### Snippet
```java
      description = "Optional max number of inverted index added, default: "
          + AutoAddInvertedIndex.DEFAULT_MAX_NUM_INVERTED_INDEX_ADDED)
  private int _maxNumInvertedIndex = AutoAddInvertedIndex.DEFAULT_MAX_NUM_INVERTED_INDEX_ADDED;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, usageHelp = true,
```

### FieldMayBeFinal
Field `_tableNamePattern` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/AutoAddInvertedIndexTool.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-tableNamePattern"}, required = false,
      description = "Optional table name pattern trigger to add inverted index, default: null (match any table name)")
  private String _tableNamePattern = null;

  @CommandLine.Option(names = {"-tableSizeThreshold"}, required = false,
```

### FieldMayBeFinal
Field `_mode` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/AutoAddInvertedIndexTool.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-mode"}, required = false,
      description = "Mode to add inverted index (NEW|REMOVE|REFRESH|APPEND), default: NEW")
  private AutoAddInvertedIndex.Mode _mode = AutoAddInvertedIndex.Mode.NEW;

  @CommandLine.Option(names = {"-tableNamePattern"}, required = false,
```

### FieldMayBeFinal
Field `_help` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/SegmentDumpTool.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, usageHelp = true,
      description = "Print this message.")
  private boolean _help = false;

  private void dump()
```

### FieldMayBeFinal
Field `_segmentDir` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/SegmentDumpTool.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-path"}, required = true,
      description = "Path of the folder containing the segment" + " file")
  private String _segmentDir = null;

  @CommandLine.Option(names = {"-columns"}, arity = "1..*", description = "Columns to dump")
```

### FieldMayBeFinal
Field `_dumpStarTree` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/SegmentDumpTool.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-dumpStarTree"})
  private boolean _dumpStarTree = false;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, usageHelp = true,
```

### FieldMayBeFinal
Field `_help` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/UpdateSegmentState.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, usageHelp = true,
      description = "Print this message.")
  private boolean _help = false;

  public UpdateSegmentState() {
```

### FieldMayBeFinal
Field `_tempDir` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/PerfBenchmarkRunner.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-tempDir"}, required = false,
      description = "Path to temporary directory to start the cluster")
  private String _tempDir = "/tmp/";

  @CommandLine.Option(names = {"-loadMode"}, required = false, description = "Load mode of the segments (HEAP|MMAP).")
```

### FieldMayBeFinal
Field `_help` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/PerfBenchmarkRunner.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, usageHelp = true,
      description = "Print this message.")
  private boolean _help = false;

  @Override
```

### FieldMayBeFinal
Field `_loadMode` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/PerfBenchmarkRunner.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-loadMode"}, required = false, description = "Load mode of the segments (HEAP|MMAP).")
  private String _loadMode = "HEAP";

  @CommandLine.Option(names = {"-segmentFormatVersion"}, required = false,
```

### FieldMayBeFinal
Field `_numThreads` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/PerfBenchmarkRunner.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-numThreads"}, required = false,
      description = "Number of threads for batch load (default 10).")
  private int _numThreads = 10;

  @CommandLine.Option(names = {"-timeoutInSeconds"}, required = false,
```

### FieldMayBeFinal
Field `_timeoutInSeconds` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/PerfBenchmarkRunner.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-timeoutInSeconds"}, required = false,
      description = "Timeout in seconds for batch load (default 60).")
  private int _timeoutInSeconds = 60;

  @CommandLine.Option(names = {"-tableNames"}, required = false,
```

### FieldMayBeFinal
Field `_controllerPort` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/BootstrapTableCommand.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-controllerPort"}, required = false, description = "http port for broker.")
  private String _controllerPort = DEFAULT_CONTROLLER_PORT;

  @CommandLine.Option(names = {"-controllerProtocol"}, required = false, description = "protocol for controller.")
```

### FieldMayBeFinal
Field `_controllerProtocol` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/BootstrapTableCommand.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-controllerProtocol"}, required = false, description = "protocol for controller.")
  private String _controllerProtocol = CommonConstants.HTTP_PROTOCOL;

  @CommandLine.Option(names = {"-dir", "-d", "-directory"}, required = false,
```

### FieldMayBeFinal
Field `_help` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/BootstrapTableCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;

  private AuthProvider _authProvider;
```

### FieldMayBeFinal
Field `_version` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/PinotAdministrator.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-version", "-v", "--v", "--version"}, required = false,
      description = "Print the version of Pinot package.")
  private boolean _version = false;

  private int _status = 1;
```

### FieldMayBeFinal
Field `_help` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/PinotAdministrator.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false,
      description = "Print this message.")
  private boolean _help = false;

  @CommandLine.Option(names = {"-version", "-v", "--v", "--version"}, required = false,
```

### FieldMayBeFinal
Field `_help` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/QuickStartCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false,
      description = "Print this message.")
  private boolean _help = false;

  @Override
```

### FieldMayBeFinal
Field `_help` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/DeleteTableCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true, description = "Print "
      + "this message.")
  private boolean _help = false;

  private String _controllerAddress;
```

### FieldMayBeFinal
Field `_controllerMode` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartControllerCommand.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-controllerMode"}, description = "Pinot controller mode.")
  private ControllerConf.ControllerMode _controllerMode = ControllerConf.ControllerMode.DUAL;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, description = "Print this message.")
```

### FieldMayBeFinal
Field `_help` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartControllerCommand.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, description = "Print this message.")
  private boolean _help = false;

  @CommandLine.Option(names = {"-controllerHost"}, required = false, description = "host name for controller.")
```

### FieldMayBeFinal
Field `_help` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AddTableCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true, description = "Print "
      + "this message.")
  private boolean _help = false;

  private String _controllerAddress;
```

### FieldMayBeFinal
Field `_update` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AddTableCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-update"}, required = false,
      description = "Update the existing table instead of creating new one")
  private boolean _update = false;

  @CommandLine.Option(names = {"-exec"}, required = false, description = "Execute the command.")
```

### FieldMayBeFinal
Field `_controllerPort` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ChangeTableState.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-controllerPort"}, required = false, description = "Port number for controller.")
  private String _controllerPort = DEFAULT_CONTROLLER_PORT;

  @CommandLine.Option(names = {"-controllerProtocol"}, required = false, description = "protocol for controller.")
```

### FieldMayBeFinal
Field `_controllerProtocol` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ChangeTableState.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-controllerProtocol"}, required = false, description = "protocol for controller.")
  private String _controllerProtocol = CommonConstants.HTTP_PROTOCOL;

  @CommandLine.Option(names = {"-tableName"}, required = true, description = "Table name to disable")
```

### FieldMayBeFinal
Field `_help` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ChangeTableState.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;

  private AuthProvider _authProvider;
```

### FieldMayBeFinal
Field `_help` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/GitHubEventsQuickStartCommand.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, help = true, description = "Print this message.")
  private boolean _help = false;

  public void setPersonalAccessToken(String personalAccessToken) {
```

### FieldMayBeFinal
Field `_help` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ChangeNumReplicasCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;

  public boolean getHelp() {
```

### FieldMayBeFinal
Field `_zkAddress` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ChangeNumReplicasCommand.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-zkAddress"}, required = false, description = "HTTP address of Zookeeper.")
  private String _zkAddress = DEFAULT_ZK_ADDRESS;

  @CommandLine.Option(names = {"-clusterName"}, required = false, description = "Pinot cluster name.")
```

### FieldMayBeFinal
Field `_clusterName` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ChangeNumReplicasCommand.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-clusterName"}, required = false, description = "Pinot cluster name.")
  private String _clusterName = "PinotCluster";

  @CommandLine.Option(names = {"-tableName"}, required = true,
```

### FieldMayBeFinal
Field `_help` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/DeleteSchemaCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true, description = "Print "
      + "this message.")
  private boolean _help = false;

  private AuthProvider _authProvider;
```

### FieldMayBeFinal
Field `_clusterName` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/VerifyClusterStateCommand.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-clusterName"}, required = false, description = "Pinot cluster name.")
  private String _clusterName = "PinotCluster";

  @CommandLine.Option(names = {"-tableName"}, required = false,
```

### FieldMayBeFinal
Field `_zkAddress` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/VerifyClusterStateCommand.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-zkAddress"}, required = false, description = "HTTP address of Zookeeper.")
  private String _zkAddress = DEFAULT_ZK_ADDRESS;

  @CommandLine.Option(names = {"-clusterName"}, required = false, description = "Pinot cluster name.")
```

### FieldMayBeFinal
Field `_help` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/VerifyClusterStateCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;

  @Override
```

### FieldMayBeFinal
Field `_timeoutSec` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/VerifyClusterStateCommand.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-timeoutSec"}, required = false, description = "Maximum timeout in second.")
  private long _timeoutSec = 300L;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
```

### FieldMayBeFinal
Field `_help` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/VerifySegmentState.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;

  public boolean getHelp() {
```

### FieldMayBeFinal
Field `_help` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/JsonToPinotSchema.java`
#### Snippet
```java
  @SuppressWarnings("FieldCanBeLocal")
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, help = true, description = "Print this message.")
  private boolean _help = false;

  @Override
```

### FieldMayBeFinal
Field `_help` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/OfflineSegmentIntervalCheckerCommand.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, help = true, description = "Print this message.")
  private boolean _help = false;

  @Override
```

### FieldMayBeFinal
Field `_clusterName` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ShowClusterInfoCommand.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-clusterName"}, required = false, description = "Pinot cluster clusterName.")
  private String _clusterName = DEFAULT_CLUSTER_NAME;

  @CommandLine.Option(names = {"-tables"}, required = false, description = "Comma separated table names.")
```

### FieldMayBeFinal
Field `_tags` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ShowClusterInfoCommand.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-tags"}, required = false, description = "Commaa separated tag names.")
  private String _tags = "";

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
```

### FieldMayBeFinal
Field `_zkAddress` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ShowClusterInfoCommand.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-zkAddress"}, required = false, description = "HTTP address of Zookeeper.")
  private String _zkAddress = DEFAULT_ZK_ADDRESS;

  @CommandLine.Option(names = {"-clusterName"}, required = false, description = "Pinot cluster clusterName.")
```

### FieldMayBeFinal
Field `_tables` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ShowClusterInfoCommand.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-tables"}, required = false, description = "Comma separated table names.")
  private String _tables = "";

  @CommandLine.Option(names = {"-tags"}, required = false, description = "Commaa separated tag names.")
```

### FieldMayBeFinal
Field `_help` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ShowClusterInfoCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;

  @Override
```

### FieldMayBeFinal
Field `_brokerHost` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/QueryRunner.java`
#### Snippet
```java
  private int _numIntervalsToIncreaseQPS = 10;
  @CommandLine.Option(names = {"-brokerHost"}, required = false, description = "Broker host name (default localhost).")
  private String _brokerHost = "localhost";
  @CommandLine.Option(names = {"-brokerPort"}, required = false, description = "Broker port number (default 8099).")
  private int _brokerPort = 8099;
```

### FieldMayBeFinal
Field `_reportIntervalMs` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/QueryRunner.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-reportIntervalMs"}, required = false, description = "Interval in milliseconds to "
      + "report simple statistics (default 3000).")
  private int _reportIntervalMs = 3000;
  @CommandLine.Option(names = {"-numIntervalsToReportAndClearStatistics"}, required = false, description =
      "Number of report intervals to report detailed statistics and clear them," + " 0 means never (default 10).")
```

### FieldMayBeFinal
Field `_numTimesToRunQueries` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/QueryRunner.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-numTimesToRunQueries"}, required = false, description = "Number of times to run all "
      + "queries in the query file, 0 means infinite times (default 1).")
  private int _numTimesToRunQueries = 1;
  @CommandLine.Option(names = {"-reportIntervalMs"}, required = false, description = "Interval in milliseconds to "
      + "report simple statistics (default 3000).")
```

### FieldMayBeFinal
Field `_queryMode` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/QueryRunner.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-queryMode"}, required = false, description = "Mode of query generator "
      + "(full|resample).")
  private String _queryMode = QueryMode.FULL.toString();
  @CommandLine.Option(names = {"-queryCount"}, required = false, description = "Number of queries to run (default 0 ="
      + " all).")
```

### FieldMayBeFinal
Field `_brokerPort` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/QueryRunner.java`
#### Snippet
```java
  private String _brokerHost = "localhost";
  @CommandLine.Option(names = {"-brokerPort"}, required = false, description = "Broker port number (default 8099).")
  private int _brokerPort = 8099;
  @CommandLine.Option(names = {"-brokerURL"}, required = false, description = "Broker URL (no default, uses "
      + "brokerHost:brokerPort by default.")
```

### FieldMayBeFinal
Field `_verbose` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/QueryRunner.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-verbose"}, required = false, description = "Enable verbose query logging (default: "
      + "false).")
  private boolean _verbose = false;
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true, description = "Print "
      + "this message.")
```

### FieldMayBeFinal
Field `_numIntervalsToIncreaseQPS` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/QueryRunner.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-numIntervalsToIncreaseQPS"}, required = false, description = "Number of report "
      + "intervals to increase QPS for increasingQPS mode (default 10).")
  private int _numIntervalsToIncreaseQPS = 10;
  @CommandLine.Option(names = {"-brokerHost"}, required = false, description = "Broker host name (default localhost).")
  private String _brokerHost = "localhost";
```

### FieldMayBeFinal
Field `_queryCount` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/QueryRunner.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-queryCount"}, required = false, description = "Number of queries to run (default 0 ="
      + " all).")
  private int _queryCount = 0;
  @CommandLine.Option(names = {"-numTimesToRunQueries"}, required = false, description = "Number of times to run all "
      + "queries in the query file, 0 means infinite times (default 1).")
```

### FieldMayBeFinal
Field `_numThreads` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/QueryRunner.java`
#### Snippet
```java
      "Number of threads sending queries for multiThreads, targetQPS and increasingQPS mode (default 5). "
          + "This can be used to simulate multiple clients sending queries concurrently.")
  private int _numThreads = 5;
  @CommandLine.Option(names = {"-startQPS"}, required = false, description = "Start QPS for targetQPS and "
      + "increasingQPS mode")
```

### FieldMayBeFinal
Field `_numIntervalsToReportAndClearStatistics` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/QueryRunner.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-numIntervalsToReportAndClearStatistics"}, required = false, description =
      "Number of report intervals to report detailed statistics and clear them," + " 0 means never (default 10).")
  private int _numIntervalsToReportAndClearStatistics = 10;
  @CommandLine.Option(names = {"-numThreads"}, required = false, description =
      "Number of threads sending queries for multiThreads, targetQPS and increasingQPS mode (default 5). "
```

### FieldMayBeFinal
Field `_queueDepth` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/QueryRunner.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-queueDepth"}, required = false, description = "Queue size limit for multi-threaded "
      + "execution (default 64).")
  private int _queueDepth = 64;
  @CommandLine.Option(names = {"-timeout"}, required = false, description = "Timeout in milliseconds for completing "
      + "all queries (default: unlimited).")
```

### FieldMayBeFinal
Field `_timeout` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/QueryRunner.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-timeout"}, required = false, description = "Timeout in milliseconds for completing "
      + "all queries (default: unlimited).")
  private long _timeout = 0;
  @CommandLine.Option(names = {"-verbose"}, required = false, description = "Enable verbose query logging (default: "
      + "false).")
```

### FieldMayBeFinal
Field `_help` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/SegmentProcessorFrameworkCommand.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, help = true, description = "Print this message.")
  private boolean _help = false;

  @Override
```

### FieldMayBeFinal
Field `_help` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartMinionCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;
  @CommandLine.Option(names = {"-minionHost"}, required = false, description = "Host name for minion.")
  private String _minionHost;
```

### FieldMayBeFinal
Field `_help` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/RealtimeProvisioningHelperCommand.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, usageHelp = true)
  private boolean _help = false;

  public RealtimeProvisioningHelperCommand setTableConfigFile(String tableConfigFile) {
```

### FieldMayBeFinal
Field `_help` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/PostQueryCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true, description = "Print "
      + "this message.")
  private boolean _help = false;

  @CommandLine.Option(names = {"-o", "-option"}, required = false, description = "Additional options '-o key=value'")
```

### FieldMayBeFinal
Field `_additionalOptions` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/PostQueryCommand.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-o", "-option"}, required = false, description = "Additional options '-o key=value'")
  private Map<String, String> _additionalOptions = new HashMap<>();

  private AuthProvider _authProvider;
```

### FieldMayBeFinal
Field `_help` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/UploadSegmentCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;

  private AuthProvider _authProvider;
```

### FieldMayBeFinal
Field `_help` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AnonymizeDataCommand.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, help = true, description = "Print this message")
  private boolean _help = false;

  public boolean getHelp() {
```

### FieldMayBeFinal
Field `_mapBasedGlobalDictionaries` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AnonymizeDataCommand.java`
#### Snippet
```java
      description = "Whether to use map based global dictionary for improved performance of building global dictionary"
          + " but with additional heap overhead. True by default")
  private boolean _mapBasedGlobalDictionaries = true;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, help = true, description = "Print this message")
```

### FieldMayBeFinal
Field `_help` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartZookeeperCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;

  @Override
```

### FieldMayBeFinal
Field `_help` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartBrokerCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;

  @CommandLine.Option(names = {"-brokerHost"}, required = false, description = "host name for broker.")
```

### FieldMayBeFinal
Field `_help` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/CreateSegmentCommand.java`
#### Snippet
```java
  @SuppressWarnings("FieldCanBeLocal")
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, help = true, description = "Print this message.")
  private boolean _help = false;

  public CreateSegmentCommand setDataDir(String dataDir) {
```

### FieldMayBeFinal
Field `_help` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/DataImportDryRunCommand.java`
#### Snippet
```java
  @SuppressWarnings("FieldCanBeLocal")
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, help = true, description = "Print this message.")
  private boolean _help = false;

  @Override
```

### FieldMayBeFinal
Field `_help` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AddSchemaCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;

  private AuthProvider _authProvider;
```

### FieldMayBeFinal
Field `_help` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StreamAvroIntoKafkaCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;

  @CommandLine.Option(names = {"-kafkaBrokerList"}, required = false, description = "Kafka broker list.")
```

### FieldMayBeFinal
Field `_millisBetweenMessages` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StreamAvroIntoKafkaCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-millisBetweenMessages"}, required = false,
      description = "Delay in milliseconds between messages (default 1000 ms)")
  private String _millisBetweenMessages = "1000";

  @Override
```

### FieldMayBeFinal
Field `_help` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AvroSchemaToPinotSchema.java`
#### Snippet
```java
  @SuppressWarnings("FieldCanBeLocal")
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, help = true, description = "Print this message.")
  private boolean _help = false;

  @Override
```

### FieldMayBeFinal
Field `_help` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/OperateClusterConfigCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;

  private AuthProvider _authProvider;
```

### FieldMayBeFinal
Field `_format` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/GenerateDataCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-format"}, required = false, help = true,
      description = "Output format ('AVRO' or 'CSV').")
  private String _format = FORMAT_AVRO;

  @Override
```

### FieldMayBeFinal
Field `_help` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/GenerateDataCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;

  @CommandLine.Option(names = {"-format"}, required = false, help = true,
```

### FieldMayBeFinal
Field `_controllerProtocol` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AddTenantCommand.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-controllerProtocol"}, required = false, description = "protocol for controller.")
  private String _controllerProtocol = CommonConstants.HTTP_PROTOCOL;

  @CommandLine.Option(names = {"-name"}, required = true, description = "Name of the tenant to be created")
```

### FieldMayBeFinal
Field `_controllerPort` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AddTenantCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-controllerPort"}, required = false,
      description = "Port number to start the controller at.")
  private String _controllerPort = DEFAULT_CONTROLLER_PORT;

  @CommandLine.Option(names = {"-controllerProtocol"}, required = false, description = "protocol for controller.")
```

### FieldMayBeFinal
Field `_help` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AddTenantCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;

  private String _controllerAddress;
```

### FieldMayBeFinal
Field `_help` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/DeleteClusterCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;

  @Override
```

### FieldMayBeFinal
Field `_zkAddress` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartKafkaCommand.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-zkAddress"}, required = false, description = "Address of Zookeeper.")
  private String _zkAddress = KafkaStarterUtils.getDefaultKafkaZKAddress();
  private StreamDataServerStartable _kafkaStarter;

```

### FieldMayBeFinal
Field `_brokerId` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartKafkaCommand.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-brokerId"}, required = false, description = "Kafka broker ID.")
  private int _brokerId = KafkaStarterUtils.DEFAULT_BROKER_ID;

  @CommandLine.Option(names = {"-zkAddress"}, required = false, description = "Address of Zookeeper.")
```

### FieldMayBeFinal
Field `_port` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartKafkaCommand.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-port"}, required = false, description = "Port to start Kafka server on.")
  private int _port = KafkaStarterUtils.DEFAULT_KAFKA_PORT;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
```

### FieldMayBeFinal
Field `_help` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartKafkaCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;

  @CommandLine.Option(names = {"-brokerId"}, required = false, description = "Kafka broker ID.")
```

### FieldMayBeFinal
Field `_kinesisEndpoint` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StreamGitHubEventsCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-kinesisEndpoint"}, description = "Endpoint of localstack or any other Kinesis "
      + "cluster when not using AWS.")
  private String _kinesisEndpoint = null;

  @CommandLine.Option(names = {"-awsRegion"}, description = "AWS Region in which Kinesis is located")
```

### FieldMayBeFinal
Field `_help` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StreamGitHubEventsCommand.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, help = true, description = "Print this message.")
  private boolean _help = false;

  public void setPersonalAccessToken(String personalAccessToken) {
```

### FieldMayBeFinal
Field `_awsRegion` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StreamGitHubEventsCommand.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-awsRegion"}, description = "AWS Region in which Kinesis is located")
  private String _awsRegion = "us-east-1";

  @CommandLine.Option(names = {"-awsAccessKey"}, description = "AccessKey for AWS Account")
```

### FieldMayBeFinal
Field `_help` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartServerCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;

  @CommandLine.Option(names = {"-serverHost"}, required = false, description = "Host name for server.")
```

### FieldMayBeFinal
Field `_kafka` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StopProcessCommand.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-kafka"}, required = false, description = "Stop the Kafka process.")
  private boolean _kafka = false;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
```

### FieldMayBeFinal
Field `_help` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StopProcessCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Stop the PinotServer.")
  private boolean _help = false;

  public StopProcessCommand() {
```

### FieldMayBeFinal
Field `_downtime` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/RebalanceTableCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-downtime"},
      description = "Whether to allow downtime for the rebalance (false by default)")
  private boolean _downtime = false;

  @CommandLine.Option(names = {"-minAvailableReplicas"},
```

### FieldMayBeFinal
Field `_includeConsuming` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/RebalanceTableCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-includeConsuming"},
      description = "Whether to reassign CONSUMING segments for real-time table (false by default)")
  private boolean _includeConsuming = false;

  @CommandLine.Option(names = {"-bootstrap"},
```

### FieldMayBeFinal
Field `_externalViewStabilizationTimeoutInMs` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/RebalanceTableCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-externalViewStabilizationTimeoutInMs"},
      description = "How long to wait till external view converges with ideal view")
  private long _externalViewStabilizationTimeoutInMs =
      RebalanceConfigConstants.DEFAULT_EXTERNAL_VIEW_STABILIZATION_TIMEOUT_IN_MS;

```

### FieldMayBeFinal
Field `_bestEfforts` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/RebalanceTableCommand.java`
#### Snippet
```java
      description = "Whether to use best-efforts to rebalance (not fail the rebalance when the no-downtime contract"
          + " cannot be achieved, false by default)")
  private boolean _bestEfforts = false;

  @CommandLine.Option(names = {"-externalViewCheckIntervalInMs"},
```

### FieldMayBeFinal
Field `_bootstrap` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/RebalanceTableCommand.java`
#### Snippet
```java
      description = "Whether to rebalance table in bootstrap mode (regardless of minimum segment movement, reassign"
          + " all segments in a round-robin fashion as if adding new segments to an empty table, false by default)")
  private boolean _bootstrap = false;

  @CommandLine.Option(names = {"-downtime"},
```

### FieldMayBeFinal
Field `_help` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/RebalanceTableCommand.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, help = true, description = "Print this message")
  private boolean _help = false;

  public boolean getHelp() {
```

### FieldMayBeFinal
Field `_reassignInstances` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/RebalanceTableCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-reassignInstances"},
      description = "Whether to reassign instances before reassigning segments (false by default)")
  private boolean _reassignInstances = false;

  @CommandLine.Option(names = {"-includeConsuming"},
```

### FieldMayBeFinal
Field `_externalViewCheckIntervalInMs` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/RebalanceTableCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-externalViewCheckIntervalInMs"},
      description = "How often to check if external view converges with ideal view")
  private long _externalViewCheckIntervalInMs = RebalanceConfigConstants.DEFAULT_EXTERNAL_VIEW_CHECK_INTERVAL_IN_MS;

  @CommandLine.Option(names = {"-externalViewStabilizationTimeoutInMs"},
```

### FieldMayBeFinal
Field `_minAvailableReplicas` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/RebalanceTableCommand.java`
#### Snippet
```java
      description = "For no-downtime rebalance, minimum number of replicas to keep alive during rebalance, or maximum "
          + "number of replicas allowed to be unavailable if value is negative (1 by default)")
  private int _minAvailableReplicas = 1;

  @CommandLine.Option(names = {"-bestEfforts"},
```

### FieldMayBeFinal
Field `_dryRun` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/RebalanceTableCommand.java`
#### Snippet
```java
      description = "Whether to rebalance table in dry-run mode (just log the target assignment without applying"
          + " changes to the cluster, false by default)")
  private boolean _dryRun = false;

  @CommandLine.Option(names = {"-reassignInstances"},
```

### FieldMayBeFinal
Field `_maxSegmentsToMove` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/MoveReplicaGroup.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-maxSegmentsToMove", "-m", "--max"}, required = false,
      description = "MaxSegmentsToMove")
  private int _maxSegmentsToMove = Integer.MAX_VALUE;

  @CommandLine.Option(names = {"-zkHost", "--zk", "-z"}, required = true,
```

### FieldMayBeFinal
Field `_help` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/MoveReplicaGroup.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, description = "Prints help")
  private boolean _help = false;

  private ZKHelixAdmin _helix;
```

### FieldMayBeFinal
Field `_destHostsFile` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/MoveReplicaGroup.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-destHostsFile", "-d", "--dest"}, required = false,
      description = "File with destination servers list")
  private String _destHostsFile = "";

  @CommandLine.Option(names = {"-tableName", "-t", "-table"}, required = true,
```

### FieldMayBeFinal
Field `_exec` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/MoveReplicaGroup.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-exec"}, required = false,
      description = "Execute replica group move. dryRun(default) if not specified")
  private boolean _exec = false;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, description = "Prints help")
```

### FieldMayBeFinal
Field `_csvDelimiter` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/segment/converter/PinotSegmentConvertCommand.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-csvDelimiter"}, required = false, description = "CSV delimiter (default ',').")
  private char _csvDelimiter = ',';

  @CommandLine.Option(names = {"-csvListDelimiter"}, required = false,
```

### FieldMayBeFinal
Field `_csvListDelimiter` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/segment/converter/PinotSegmentConvertCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-csvListDelimiter"}, required = false,
      description = "CSV List delimiter for multi-value columns (default ';').")
  private char _csvListDelimiter = ';';

  @CommandLine.Option(names = {"-csvWithHeader"}, required = false, description = "Print CSV Header (default false).")
```

### FieldMayBeFinal
Field `_compressionType` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/segment/converter/DictionaryToRawIndexConverter.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-compressionType"}, required = false, description = "Compression Type")
  private String _compressionType = "Snappy";

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
```

### FieldMayBeFinal
Field `_tableName` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/segment/converter/DictionaryToRawIndexConverter.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-tableName"}, required = false,
      description = "New table name, if different from original")
  private String _tableName = null;

  @CommandLine.Option(names = {"-outputDir"}, required = true, description = "Output directory for writing results")
```

### FieldMayBeFinal
Field `_help` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/segment/converter/DictionaryToRawIndexConverter.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "print this message")
  private boolean _help = false;

  /**
```

### FieldMayBeFinal
Field `_numThreads` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/segment/converter/DictionaryToRawIndexConverter.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-numThreads"}, required = false,
      description = "Number of threads to launch for conversion")
  private int _numThreads = 4;

  @CommandLine.Option(names = {"-compressOutput"}, required = false,
```

### FieldMayBeFinal
Field `_compressOutput` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/segment/converter/DictionaryToRawIndexConverter.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-compressOutput"}, required = false,
      description = "Compress (tar + gzip) output segment")
  private boolean _compressOutput = false;

  @CommandLine.Option(names = {"-compressionType"}, required = false, description = "Compression Type")
```

### FieldMayBeFinal
Field `_pinotStream` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/streams/AirlineDataStream.java`
#### Snippet
```java
  final Integer _startTime = 16102;
  private StreamDataProducer _producer;
  private PinotRealtimeSource _pinotStream;

  public AirlineDataStream(Schema pinotSchema, TableConfig tableConfig, File avroFile, StreamDataProducer producer)
```

### FieldMayBeFinal
Field `_personalAccessToken` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/streams/githubevents/GitHubAPICaller.java`
#### Snippet
```java

  private final CloseableHttpClient _closeableHttpClient;
  private String _personalAccessToken;

  GitHubAPICaller(String personalAccessToken) {
```

### FieldMayBeFinal
Field `_pinotStream` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/streams/githubevents/PullRequestMergedEventsStream.java`
#### Snippet
```java
      "org.apache.pinot.plugin.stream.pulsar.server.PulsarDataProducer";

  private PinotRealtimeSource _pinotStream;

  public PullRequestMergedEventsStream(File schemaFile, String topicName, String personalAccessToken,
```

### FieldMayBeFinal
Field `_avroSchema` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/streams/githubevents/GithubPullRequestSourceGenerator.java`
#### Snippet
```java

  private GitHubAPICaller _gitHubAPICaller;
  private Schema _avroSchema;
  private String _etag = null;

```

### FieldMayBeFinal
Field `_gitHubAPICaller` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/streams/githubevents/GithubPullRequestSourceGenerator.java`
#### Snippet
```java
  private static final long SLEEP_MILLIS = 10_000;

  private GitHubAPICaller _gitHubAPICaller;
  private Schema _avroSchema;
  private String _etag = null;
```

### FieldMayBeFinal
Field `_help` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/filesystem/PinotFSBenchmarkRunner.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;

  @Override
```

### FieldMayBeFinal
Field `_baseDirectoryUri` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/filesystem/PinotFSBenchmarkDriver.java`
#### Snippet
```java
  private String _mode;
  private PinotFS _pinotFS;
  private URI _baseDirectoryUri;
  private File _localTempDir;
  private int _numSegmentsForListFilesTest;
```

### FieldMayBeFinal
Field `_numOps` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/filesystem/PinotFSBenchmarkDriver.java`
#### Snippet
```java
  private File _localTempDir;
  private int _numSegmentsForListFilesTest;
  private int _numOps;
  private int _dataSizeInMBsForCopyTest;

```

### FieldMayBeFinal
Field `_numSegmentsForListFilesTest` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/filesystem/PinotFSBenchmarkDriver.java`
#### Snippet
```java
  private URI _baseDirectoryUri;
  private File _localTempDir;
  private int _numSegmentsForListFilesTest;
  private int _numOps;
  private int _dataSizeInMBsForCopyTest;
```

### FieldMayBeFinal
Field `_localTempDir` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/filesystem/PinotFSBenchmarkDriver.java`
#### Snippet
```java
  private PinotFS _pinotFS;
  private URI _baseDirectoryUri;
  private File _localTempDir;
  private int _numSegmentsForListFilesTest;
  private int _numOps;
```

### FieldMayBeFinal
Field `_pinotFS` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/filesystem/PinotFSBenchmarkDriver.java`
#### Snippet
```java

  private String _mode;
  private PinotFS _pinotFS;
  private URI _baseDirectoryUri;
  private File _localTempDir;
```

### FieldMayBeFinal
Field `_dataSizeInMBsForCopyTest` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/filesystem/PinotFSBenchmarkDriver.java`
#### Snippet
```java
  private int _numSegmentsForListFilesTest;
  private int _numOps;
  private int _dataSizeInMBsForCopyTest;

  public PinotFSBenchmarkDriver(String mode, String configFilePath, String baseDirectoryUri, String localTempDir,
```

### FieldMayBeFinal
Field `_mode` may be 'final'
in `pinot-tools/src/main/java/org/apache/pinot/tools/filesystem/PinotFSBenchmarkDriver.java`
#### Snippet
```java
  private static final int DEFAULT_NUM_OPS = 5; // 5

  private String _mode;
  private PinotFS _pinotFS;
  private URI _baseDirectoryUri;
```

### FieldMayBeFinal
Field `_columnProperties` may be 'final'
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/creator/SegmentGeneratorConfig.java`
#### Snippet
```java

  // constructed from FieldConfig
  private Map<String, Map<String, String>> _columnProperties = new HashMap<>();

  private SegmentZKPropsConfig _segmentZKPropsConfig;
```

### FieldMayBeFinal
Field `_maxQpsTracker` may be 'final'
in `pinot-broker/src/main/java/org/apache/pinot/broker/queryquota/QueryQuotaEntity.java`
#### Snippet
```java
  private RateLimiter _rateLimiter;
  private HitCounter _qpsTracker;
  private MaxHitRateTracker _maxQpsTracker;
  private int _numOnlineBrokers;
  private double _overallRate;
```

### FieldMayBeFinal
Field `_qpsTracker` may be 'final'
in `pinot-broker/src/main/java/org/apache/pinot/broker/queryquota/QueryQuotaEntity.java`
#### Snippet
```java

  private RateLimiter _rateLimiter;
  private HitCounter _qpsTracker;
  private MaxHitRateTracker _maxQpsTracker;
  private int _numOnlineBrokers;
```

### FieldMayBeFinal
Field `_stageId` may be 'final'
in `pinot-query-runtime/src/main/java/org/apache/pinot/query/runtime/plan/DistributedStagePlan.java`
#### Snippet
```java
 */
public class DistributedStagePlan {
  private int _stageId;
  private VirtualServerAddress _server;
  private StageNode _stageRoot;
```

### FieldMayBeFinal
Field `_stageMetadataList` may be 'final'
in `pinot-query-runtime/src/main/java/org/apache/pinot/query/runtime/plan/DistributedStagePlan.java`
#### Snippet
```java
  private VirtualServerAddress _server;
  private StageNode _stageRoot;
  private List<StageMetadata> _stageMetadataList;

  public DistributedStagePlan(int stageId) {
```

### FieldMayBeFinal
Field `_rightKeySelector` may be 'final'
in `pinot-query-runtime/src/main/java/org/apache/pinot/query/runtime/operator/HashJoinOperator.java`
#### Snippet
```java
  private TransferableBlock _upstreamErrorBlock;
  private KeySelector<Object[], Object[]> _leftKeySelector;
  private KeySelector<Object[], Object[]> _rightKeySelector;

  public HashJoinOperator(OpChainExecutionContext context, MultiStageOperator leftTableOperator,
```

### FieldMayBeFinal
Field `_leftKeySelector` may be 'final'
in `pinot-query-runtime/src/main/java/org/apache/pinot/query/runtime/operator/HashJoinOperator.java`
#### Snippet
```java
  private boolean _isTerminated;
  private TransferableBlock _upstreamErrorBlock;
  private KeySelector<Object[], Object[]> _leftKeySelector;
  private KeySelector<Object[], Object[]> _rightKeySelector;

```

### FieldMayBeFinal
Field `_callback` may be 'final'
in `pinot-query-runtime/src/main/java/org/apache/pinot/query/service/dispatch/DispatchObserver.java`
#### Snippet
```java
  private int _stageId;
  private QueryServerInstance _virtualServer;
  private Consumer<AsyncQueryDispatchResponse> _callback;
  private Worker.QueryResponse _queryResponse;

```

### FieldMayBeFinal
Field `_stageId` may be 'final'
in `pinot-query-runtime/src/main/java/org/apache/pinot/query/service/dispatch/DispatchObserver.java`
#### Snippet
```java
 */
class DispatchObserver implements StreamObserver<Worker.QueryResponse> {
  private int _stageId;
  private QueryServerInstance _virtualServer;
  private Consumer<AsyncQueryDispatchResponse> _callback;
```

### FieldMayBeFinal
Field `_virtualServer` may be 'final'
in `pinot-query-runtime/src/main/java/org/apache/pinot/query/service/dispatch/DispatchObserver.java`
#### Snippet
```java
class DispatchObserver implements StreamObserver<Worker.QueryResponse> {
  private int _stageId;
  private QueryServerInstance _virtualServer;
  private Consumer<AsyncQueryDispatchResponse> _callback;
  private Worker.QueryResponse _queryResponse;
```

### FieldMayBeFinal
Field `_asyncSessionUpdateEnabled` may be 'final'
in `pinot-plugins/pinot-file-system/pinot-s3/src/main/java/org/apache/pinot/plugin/filesystem/S3Config.java`
#### Snippet
```java
  private String _externalId;
  private int _sessionDurationSeconds;
  private boolean _asyncSessionUpdateEnabled;
  private final long _minObjectSizeForMultiPartUpload;
  private final long _multiPartUploadPartSize;
```

### FieldMayBeFinal
Field `_roleArn` may be 'final'
in `pinot-plugins/pinot-file-system/pinot-s3/src/main/java/org/apache/pinot/plugin/filesystem/S3Config.java`
#### Snippet
```java

  private boolean _iamRoleBasedAccess;
  private String _roleArn;
  private String _roleSessionName;
  private String _externalId;
```

### FieldMayBeFinal
Field `_iamRoleBasedAccess` may be 'final'
in `pinot-plugins/pinot-file-system/pinot-s3/src/main/java/org/apache/pinot/plugin/filesystem/S3Config.java`
#### Snippet
```java
  private String _ssekmsEncryptionContext;

  private boolean _iamRoleBasedAccess;
  private String _roleArn;
  private String _roleSessionName;
```

### FieldMayBeFinal
Field `_ssekmsKeyId` may be 'final'
in `pinot-plugins/pinot-file-system/pinot-s3/src/main/java/org/apache/pinot/plugin/filesystem/S3Config.java`
#### Snippet
```java

  private final String _serverSideEncryption;
  private String _ssekmsKeyId;
  private String _ssekmsEncryptionContext;

```

### FieldMayBeFinal
Field `_externalId` may be 'final'
in `pinot-plugins/pinot-file-system/pinot-s3/src/main/java/org/apache/pinot/plugin/filesystem/S3Config.java`
#### Snippet
```java
  private String _roleArn;
  private String _roleSessionName;
  private String _externalId;
  private int _sessionDurationSeconds;
  private boolean _asyncSessionUpdateEnabled;
```

### FieldMayBeFinal
Field `_roleSessionName` may be 'final'
in `pinot-plugins/pinot-file-system/pinot-s3/src/main/java/org/apache/pinot/plugin/filesystem/S3Config.java`
#### Snippet
```java
  private boolean _iamRoleBasedAccess;
  private String _roleArn;
  private String _roleSessionName;
  private String _externalId;
  private int _sessionDurationSeconds;
```

### FieldMayBeFinal
Field `_ssekmsEncryptionContext` may be 'final'
in `pinot-plugins/pinot-file-system/pinot-s3/src/main/java/org/apache/pinot/plugin/filesystem/S3Config.java`
#### Snippet
```java
  private final String _serverSideEncryption;
  private String _ssekmsKeyId;
  private String _ssekmsEncryptionContext;

  private boolean _iamRoleBasedAccess;
```

### FieldMayBeFinal
Field `_sessionDurationSeconds` may be 'final'
in `pinot-plugins/pinot-file-system/pinot-s3/src/main/java/org/apache/pinot/plugin/filesystem/S3Config.java`
#### Snippet
```java
  private String _roleSessionName;
  private String _externalId;
  private int _sessionDurationSeconds;
  private boolean _asyncSessionUpdateEnabled;
  private final long _minObjectSizeForMultiPartUpload;
```

### FieldMayBeFinal
Field `_rawIndexColumn` may be 'final'
in `pinot-perf/src/main/java/org/apache/pinot/perf/RawIndexBenchmark.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-rawIndexColumn"}, required = false,
      description = "Name of column with raw index (no-dictionary")
  private String _rawIndexColumn = DEFAULT_RAW_INDEX_COLUMN;

  @CommandLine.Option(names = {"-dataFile"}, required = false,
```

### FieldMayBeFinal
Field `_dataFile` may be 'final'
in `pinot-perf/src/main/java/org/apache/pinot/perf/RawIndexBenchmark.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-dataFile"}, required = false,
      description = "File containing input data (one string per line)")
  private String _dataFile = null;

  @CommandLine.Option(names = {"-loadMode"}, required = false, description = "Load mode for data (mmap|heap")
```

### FieldMayBeFinal
Field `_help` may be 'final'
in `pinot-perf/src/main/java/org/apache/pinot/perf/RawIndexBenchmark.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, usageHelp = true,
      description = "print this message")
  private boolean _help = false;

  private int _numRows = 0;
```

### FieldMayBeFinal
Field `_numLookups` may be 'final'
in `pinot-perf/src/main/java/org/apache/pinot/perf/RawIndexBenchmark.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-numLookups"}, required = false,
      description = "Number of lookups to be performed for benchmark")
  private int _numLookups = DEFAULT_NUM_LOOKUP;

  @CommandLine.Option(names = {"-numConsecutiveLookups"}, required = false,
```

### FieldMayBeFinal
Field `_loadMode` may be 'final'
in `pinot-perf/src/main/java/org/apache/pinot/perf/RawIndexBenchmark.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-loadMode"}, required = false, description = "Load mode for data (mmap|heap")
  private String _loadMode = "heap";

  @CommandLine.Option(names = {"-numLookups"}, required = false,
```

### FieldMayBeFinal
Field `_fwdIndexColumn` may be 'final'
in `pinot-perf/src/main/java/org/apache/pinot/perf/RawIndexBenchmark.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-fwdIndexColumn"}, required = false,
      description = "Name of column with dictionary encoded index")
  private String _fwdIndexColumn = DEFAULT_FWD_INDEX_COLUMN;

  @CommandLine.Option(names = {"-rawIndexColumn"}, required = false,
```

### FieldMayBeFinal
Field `_numConsecutiveLookups` may be 'final'
in `pinot-perf/src/main/java/org/apache/pinot/perf/RawIndexBenchmark.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-numConsecutiveLookups"}, required = false,
      description = "Number of consecutive docIds to lookup")
  private int _numConsecutiveLookups = DEFAULT_NUM_CONSECUTIVE_LOOKUP;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, usageHelp = true,
```

### FieldMayBeFinal
Field `_segmentDir` may be 'final'
in `pinot-perf/src/main/java/org/apache/pinot/perf/RawIndexBenchmark.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-segmentDir"}, required = false, description = "Untarred segment")
  private String _segmentDir = null;

  @CommandLine.Option(names = {"-fwdIndexColumn"}, required = false,
```

### FieldMayBeFinal
Field `_query` may be 'final'
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkColumnValueSegmentPruner.java`
#### Snippet
```java
  private int _numSegments;

  private String _query = QUERY_1;
  String _scenario = "EXP(0.5)";
  private List<IndexSegment> _indexSegments;
```

### FieldMayBeFinal
Field `_dataBitSet` may be 'final'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/util/FixedBitIntReaderWriterV2.java`
#### Snippet
```java

public final class FixedBitIntReaderWriterV2 implements Closeable {
  private PinotDataBitSetV2 _dataBitSet;

  public FixedBitIntReaderWriterV2(PinotDataBuffer dataBuffer, int numValues, int numBitsPerValue) {
```

### FieldMayBeFinal
Field `_totalSize` may be 'final'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/writer/impl/FixedBitMVForwardIndexWriter.java`
#### Snippet
```java
  private int _bitsetSize;
  private long _rawDataSize;
  private long _totalSize;
  private int _docsPerChunk;

```

### FieldMayBeFinal
Field `_docsPerChunk` may be 'final'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/writer/impl/FixedBitMVForwardIndexWriter.java`
#### Snippet
```java
  private long _rawDataSize;
  private long _totalSize;
  private int _docsPerChunk;

  private int _nextDocId = 0;
```

### FieldMayBeFinal
Field `_indexDataBuffer` may be 'final'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/writer/impl/FixedBitMVForwardIndexWriter.java`
#### Snippet
```java
  private static final int PREFERRED_NUM_VALUES_PER_CHUNK = 2048;

  private PinotDataBuffer _indexDataBuffer;
  private PinotDataBuffer _chunkOffsetsBuffer;
  private PinotDataBuffer _bitsetBuffer;
```

### FieldMayBeFinal
Field `_rawDataSize` may be 'final'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/writer/impl/FixedBitMVForwardIndexWriter.java`
#### Snippet
```java
  private int _chunkOffsetHeaderSize;
  private int _bitsetSize;
  private long _rawDataSize;
  private long _totalSize;
  private int _docsPerChunk;
```

### FieldMayBeFinal
Field `_numChunks` may be 'final'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/writer/impl/FixedBitMVForwardIndexWriter.java`
#### Snippet
```java
  private PinotDataBitSet _customBitSet;
  private FixedBitIntReaderWriter _rawDataWriter;
  private int _numChunks;
  private int _prevRowStartIndex = 0;
  private int _prevRowLength = 0;
```

### FieldMayBeFinal
Field `_bitsetSize` may be 'final'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/writer/impl/FixedBitMVForwardIndexWriter.java`
#### Snippet
```java
  private int _prevRowLength = 0;
  private int _chunkOffsetHeaderSize;
  private int _bitsetSize;
  private long _rawDataSize;
  private long _totalSize;
```

### FieldMayBeFinal
Field `_chunkOffsetHeaderSize` may be 'final'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/writer/impl/FixedBitMVForwardIndexWriter.java`
#### Snippet
```java
  private int _prevRowStartIndex = 0;
  private int _prevRowLength = 0;
  private int _chunkOffsetHeaderSize;
  private int _bitsetSize;
  private long _rawDataSize;
```

### FieldMayBeFinal
Field `_numColumns` may be 'final'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/readerwriter/impl/FixedByteSingleValueMultiColumnReaderWriter.java`
#### Snippet
```java
  private final long _chunkSizeInBytes;
  private int _capacityInRows;
  private int _numColumns;

  /**
```

### FieldMayBeFinal
Field `_allocationContext` may be 'final'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/readerwriter/impl/FixedByteSingleValueMultiColumnReaderWriter.java`
#### Snippet
```java
  private final int[] _columnSizesInBytes;
  private final PinotDataBufferMemoryManager _memoryManager;
  private String _allocationContext;
  private final long _chunkSizeInBytes;
  private int _capacityInRows;
```

### FieldMayBeFinal
Field `_scratch` may be 'final'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/fst/FSTBuilder.java`
#### Snippet
```java
  public static final Logger LOGGER = LoggerFactory.getLogger(FSTBuilder.class);
  private Builder<Long> _builder = new Builder<>(FST.INPUT_TYPE.BYTE4, PositiveIntOutputs.getSingleton());
  private IntsRefBuilder _scratch = new IntsRefBuilder();

  public static FST buildFST(SortedMap<String, Integer> input)
```

### FieldMayBeFinal
Field `_builder` may be 'final'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/fst/FSTBuilder.java`
#### Snippet
```java
public class FSTBuilder {
  public static final Logger LOGGER = LoggerFactory.getLogger(FSTBuilder.class);
  private Builder<Long> _builder = new Builder<>(FST.INPUT_TYPE.BYTE4, PositiveIntOutputs.getSingleton());
  private IntsRefBuilder _scratch = new IntsRefBuilder();

```

### FieldMayBeFinal
Field `_outputSymbols` may be 'final'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/ConstantArcSizeFST.java`
#### Snippet
```java
  private final byte[] _data;

  private Map<Integer, Integer> _outputSymbols;

  /**
```

### FieldMayBeFinal
Field `_offsets` may be 'final'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/builder/FSTSerializerImpl.java`
#### Snippet
```java
   * A hash map of [state, offset] pairs.
   */
  private Int2IntOpenHashMap _offsets = new Int2IntOpenHashMap();

  /**
```

### FieldMayBeFinal
Field `_outputSymbols` may be 'final'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/builder/FSTSerializerImpl.java`
#### Snippet
```java
   * A hashmap of output symbols
   */
  private Map<Integer, Integer> _outputSymbols = new HashMap<>();

  /**
```

### FieldMayBeFinal
Field `_outputSymbols` may be 'final'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/builder/FSTBuilder.java`
#### Snippet
```java

  private byte[] _serialized = new byte[0];
  private Map<Integer, Integer> _outputSymbols = new HashMap<>();

  /**
```

### FieldMayBeFinal
Field `_epsilon` may be 'final'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/builder/FSTBuilder.java`
#### Snippet
```java
   * root or to the terminal state, indicating an empty automaton.
   */
  private int _epsilon;
  /**
   * Hash set of state addresses in {@link #_serialized}, hashed by
```

### FieldMayBeFinal
Field `_root` may be 'final'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/automaton/StringUnionOperations.java`
#### Snippet
```java
   * Root automaton state.
   */
  private StateWithTransitionLabels _root = new StateWithTransitionLabels();
  /**
   * Previous sequence added to the automaton in {@link #add(CharSequence)}.
```

### FieldMayBeFinal
Field `_nextState` may be 'final'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/mutablefst/MutableArc.java`
#### Snippet
```java

  private int _outputSymbol;
  private MutableState _nextState;

  /**
```

### FieldMayBeFinal
Field `_outputSymbol` may be 'final'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/mutablefst/MutableArc.java`
#### Snippet
```java
public class MutableArc {

  private int _outputSymbol;
  private MutableState _nextState;

```

### FieldMayBeFinal
Field `_labels` may be 'final'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/automaton/MinimizationOperations.java`
#### Snippet
```java
  static class LabelComparator implements Comparator<Integer> {

    private IntPair[] _labels;

    LabelComparator(IntPair[] labels) {
```

### FieldMayBeFinal
Field `_allowMutation` may be 'final'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/automaton/RegExp.java`
#### Snippet
```java
   */
  public static final int NONE = 0x0000;
  private static boolean _allowMutation = false;
  Kind _kind;
  RegExp _exp1;
```

### FieldMayBeFinal
Field `_numberValueBuffer` may be 'final'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/creator/impl/inv/RangeIndexCreator.java`
#### Snippet
```java
  private PinotDataBuffer _tempValueBuffer;
  //a simple wrapper over _tempValueBuffer to make it easy to read/write any Number (INT,LONG, FLOAT, DOUBLE)
  private NumberValueBuffer _numberValueBuffer;

  //File where the docId will be stored. Temp file that will be deleted at the end
```

### FieldMayBeFinal
Field `_docIdBuffer` may be 'final'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/creator/impl/inv/RangeIndexCreator.java`
#### Snippet
```java
  private PinotDataBuffer _docIdValueBuffer;
  //a simple wrapper over _docIdValueBuffer to make it easy to read/write any INT
  private IntValueBuffer _docIdBuffer;

  private final int _numValues;
```

### FieldMayBeFinal
Field `_totalStatsCollectorTime` may be 'final'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/creator/impl/SegmentIndexCreationDriverImpl.java`
#### Snippet
```java
  private long _totalRecordReadTime = 0;
  private long _totalIndexTime = 0;
  private long _totalStatsCollectorTime = 0;
  private boolean _continueOnError;

```

### FieldMayBeFinal
Field `_docIdValueBuffer` may be 'final'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/creator/impl/inv/RangeIndexCreator.java`
#### Snippet
```java
  private final File _tempDocIdBufferFile;
  //pinot data buffer MMapped - maps the content of _tempDocIdBufferFile
  private PinotDataBuffer _docIdValueBuffer;
  //a simple wrapper over _docIdValueBuffer to make it easy to read/write any INT
  private IntValueBuffer _docIdBuffer;
```

### FieldMayBeFinal
Field `_colNameToStats` may be 'final'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/realtime/impl/RealtimeSegmentStatsHistory.java`
#### Snippet
```java
    private int _numSeconds;        // Number of seconds taken to consume them
    private long _memUsedBytes;          // Memory used for consumption (bytes)
    private Map<String, ColumnStats> _colNameToStats = new HashMap();

    public int getNumRowsConsumed() {
```

### FieldMayBeFinal
Field `_historyFilePath` may be 'final'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/realtime/impl/RealtimeSegmentStatsHistory.java`
#### Snippet
```java
  private SegmentStats[] _entries;
  private boolean _isFull = false;
  private String _historyFilePath;

  // We return these values when we don't have any prior statistics.
```

### FieldMayBeFinal
Field `_heapFirst` may be 'final'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/realtime/impl/dictionary/BaseOffHeapMutableDictionary.java`
#### Snippet
```java
  // a threshold, and then the off-heap structures are allocated.
  @SuppressWarnings("FieldCanBeLocal")
  private static boolean _heapFirst = true;

  private final int _maxItemsInOverflowHash;
```

### FieldMayBeFinal
Field `_bits` may be 'final'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/customobject/QuantileDigest.java`
#### Snippet
```java
    private double _weightedCount;
    private int _level;
    private long _bits;
    private Node _left;
    private Node _right;
```

### FieldMayBeFinal
Field `_level` may be 'final'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/customobject/QuantileDigest.java`
#### Snippet
```java
  private static class Node {
    private double _weightedCount;
    private int _level;
    private long _bits;
    private Node _left;
```

### FieldMayBeFinal
Field `_mean` may be 'final'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/customobject/QuantileDigest.java`
#### Snippet
```java
  public static class Bucket {
    private double _count;
    private double _mean;

    public Bucket(double count, double mean) {
```

### FieldMayBeFinal
Field `_count` may be 'final'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/customobject/QuantileDigest.java`
#### Snippet
```java

  public static class Bucket {
    private double _count;
    private double _mean;

```

### FieldMayBeFinal
Field `_fieldIds` may be 'final'
in `pinot-plugins/pinot-input-format/pinot-thrift/src/main/java/org/apache/pinot/plugin/inputformat/thrift/ThriftRecordReader.java`
#### Snippet
```java
  private ThriftRecordExtractor _recordExtractor;
  private Class<?> _thriftClass;
  private Map<String, Integer> _fieldIds = new HashMap<>();

  private InputStream _inputStream;
```

## RuleId[id=CaughtExceptionImmediatelyRethrown]
### CaughtExceptionImmediatelyRethrown
Caught exception `ex` is immediately rethrown
in `pinot-plugins/pinot-file-system/pinot-adls/src/main/java/org/apache/pinot/plugin/filesystem/AzurePinotFS.java`
#### Snippet
```java
       */
      Files.copy(adlStream, dstFilePath);
    } catch (Exception ex) {
      throw ex;
    }
```

### CaughtExceptionImmediatelyRethrown
Caught exception `e` is immediately rethrown
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/IpAddressFunctions.java`
#### Snippet
```java
    try {
      return prefixAddr.toPrefixBlock();
    } catch (PrefixLenException e) {
      throw e;
    }
```

### CaughtExceptionImmediatelyRethrown
Caught exception `e` is immediately rethrown
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ImportDataCommand.java`
#### Snippet
```java
      LOGGER.info("Successfully load data from {} to Pinot.", _dataFilePath);
      return true;
    } catch (Exception e) {
      throw e;
    } finally {
```

### CaughtExceptionImmediatelyRethrown
Caught exception `e` is immediately rethrown
in `pinot-plugins/pinot-file-system/pinot-s3/src/main/java/org/apache/pinot/plugin/filesystem/S3PinotFS.java`
#### Snippet
```java

      return _s3Client.getObject(getObjectRequest);
    } catch (S3Exception e) {
      throw e;
    }
```

## RuleId[id=SynchronizationOnLocalVariableOrMethodParameter]
### SynchronizationOnLocalVariableOrMethodParameter
Synchronization on method parameter `instance`
in `pinot-tools/src/main/java/org/apache/pinot/tools/service/PinotServiceManager.java`
#### Snippet
```java
      return false;
    }
    synchronized (instance) {
      ServiceRole role = instance.getServiceRole();
      String instanceId = instance.getInstanceId();
```

## RuleId[id=UnnecessaryLocalVariable]
### UnnecessaryLocalVariable
Local variable `recordReaderConfig` is redundant
in `pinot-spi/src/main/java/org/apache/pinot/spi/data/readers/RecordReaderFactory.java`
#### Snippet
```java
      throws IOException, ClassNotFoundException {
    Class recordReaderConfigClass = PluginManager.get().loadClass(recordReaderConfigClassName);
    RecordReaderConfig recordReaderConfig =
        (RecordReaderConfig) JsonUtils.fileToObject(readerConfigFile, recordReaderConfigClass);
    return recordReaderConfig;
```

### UnnecessaryLocalVariable
Local variable `httpMethodBase` is redundant
in `pinot-common/src/main/java/org/apache/pinot/common/http/MultiHttpRequest.java`
#### Snippet
```java
          T httpMethod = httpMethodSupplier.apply(url);
          // Explicitly cast type downwards to workaround a bug in jdk8: https://bugs.openjdk.org/browse/JDK-8056984
          HttpMethodBase httpMethodBase = httpMethod;
          if (requestHeaders != null) {
            requestHeaders.forEach((k, v) -> httpMethodBase.setRequestHeader(k, v));
```

### UnnecessaryLocalVariable
Local variable `trustAllCerts` is redundant
in `pinot-common/src/main/java/org/apache/pinot/common/utils/ClientSSLContextGenerator.java`
#### Snippet
```java
    }
    // Server verification disabled. Trust all servers
    TrustManager[] trustAllCerts = new TrustManager[]{
        new X509TrustManager() {
          @Override
```

### UnnecessaryLocalVariable
Local variable `relativeOutputURI` is redundant
in `pinot-common/src/main/java/org/apache/pinot/common/segment/generation/SegmentGenerationUtils.java`
#### Snippet
```java
    String outputDirStr = sanitizeURIString(outputDir.toString());
    outputDir = !outputDirStr.endsWith("/") ? URI.create(outputDirStr.concat("/")) : outputDir;
    URI relativeOutputURI = outputDir.resolve(relativePath).resolve(".");
    return relativeOutputURI;
  }
```

### UnnecessaryLocalVariable
Local variable `millis` is redundant
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/DateTimeFunctions.java`
#### Snippet
```java
  public static long timestampAdd(String unit, long interval, long timestamp) {
    ISOChronology chronology = ISOChronology.getInstanceUTC();
    long millis = DateTimeUtils.getTimestampField(chronology, unit).add(timestamp, interval);
    return millis;
  }
```

### UnnecessaryLocalVariable
Local variable `decodedString` is redundant
in `pinot-core/src/main/java/org/apache/pinot/core/auth/BasicAuthUtils.java`
#### Snippet
```java
    String replacedAuth = StringUtils.replace(auth, "Basic ", "");
    byte[] decodedBytes = Base64.getDecoder().decode(replacedAuth);
    String decodedString = new String(decodedBytes);
    return decodedString;
  }
```

### UnnecessaryLocalVariable
Local variable `distinctAvg` is redundant
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/DistinctAvgMVAggregationFunction.java`
#### Snippet
```java
      distinctSum += ((Number) obj).doubleValue();
    }
    Double distinctAvg = distinctSum / intermediateResult.size();
    return distinctAvg;
  }
```

### UnnecessaryLocalVariable
Local variable `distinctAvg` is redundant
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/DistinctAvgAggregationFunction.java`
#### Snippet
```java
      distinctSum += ((Number) obj).doubleValue();
    }
    Double distinctAvg = distinctSum / intermediateResult.size();
    return distinctAvg;
  }
```

### UnnecessaryLocalVariable
Local variable `metadataExtractorClassName` is redundant
in `pinot-core/src/main/java/org/apache/pinot/core/metadata/MetadataExtractorFactory.java`
#### Snippet
```java

  public static MetadataExtractor create(String metadataClassName) {
    String metadataExtractorClassName = metadataClassName;
    try {
      LOGGER.info("Instantiating MetadataExtractor class {}", metadataExtractorClassName);
```

### UnnecessaryLocalVariable
Local variable `metadataExtractor` is redundant
in `pinot-core/src/main/java/org/apache/pinot/core/metadata/MetadataExtractorFactory.java`
#### Snippet
```java
    try {
      LOGGER.info("Instantiating MetadataExtractor class {}", metadataExtractorClassName);
      MetadataExtractor metadataExtractor = (MetadataExtractor) Class.forName(metadataExtractorClassName).newInstance();
      return metadataExtractor;
    } catch (Exception e) {
```

### UnnecessaryLocalVariable
Local variable `dateTime` is redundant
in `pinot-plugins/pinot-input-format/pinot-parquet/src/main/java/org/apache/pinot/plugin/inputformat/parquet/ParquetNativeRecordExtractor.java`
#### Snippet
```java
          Binary int96 = from.getInt96(fieldIndex, index);
          ByteBuffer buf = ByteBuffer.wrap(int96.getBytes()).order(ByteOrder.LITTLE_ENDIAN);
          long dateTime = (buf.getInt(8) - JULIAN_DAY_NUMBER_FOR_UNIX_EPOCH) * DateTimeConstants.MILLIS_PER_DAY
              + buf.getLong(0) / NANOS_PER_MILLISECOND;
          return dateTime;
```

### UnnecessaryLocalVariable
Local variable `in` is redundant
in `pinot-clients/pinot-jdbc-client/src/main/java/org/apache/pinot/client/PinotResultSet.java`
#### Snippet
```java
      throws SQLException {
    String value = getString(columnIndex);
    InputStream in = new ByteArrayInputStream(value.getBytes(StandardCharsets.US_ASCII));
    return in;
  }
```

### UnnecessaryLocalVariable
Local variable `reader` is redundant
in `pinot-clients/pinot-jdbc-client/src/main/java/org/apache/pinot/client/PinotResultSet.java`
#### Snippet
```java
      throws SQLException {
    InputStream in = getUnicodeStream(columnIndex);
    Reader reader = new InputStreamReader(in, StandardCharsets.UTF_8);
    return reader;
  }
```

### UnnecessaryLocalVariable
Local variable `hasNext` is redundant
in `pinot-clients/pinot-jdbc-client/src/main/java/org/apache/pinot/client/PinotResultSet.java`
#### Snippet
```java

    _currentRow++;
    boolean hasNext = _currentRow < _totalRows;
    return hasNext;
  }
```

### UnnecessaryLocalVariable
Local variable `in` is redundant
in `pinot-clients/pinot-jdbc-client/src/main/java/org/apache/pinot/client/PinotResultSet.java`
#### Snippet
```java
      throws SQLException {
    String value = getString(columnIndex);
    InputStream in = new ByteArrayInputStream(value.getBytes(StandardCharsets.UTF_8));
    return in;
  }
```

### UnnecessaryLocalVariable
Local variable `url` is redundant
in `pinot-clients/pinot-jdbc-client/src/main/java/org/apache/pinot/client/PinotResultSet.java`
#### Snippet
```java
      throws SQLException {
    try {
      URL url = new URL(getString(columnIndex));
      return url;
    } catch (Exception e) {
```

### UnnecessaryLocalVariable
Local variable `tableResponse` is redundant
in `pinot-clients/pinot-jdbc-client/src/main/java/org/apache/pinot/client/controller/response/TableResponse.java`
#### Snippet
```java
      try {
        JsonNode jsonResponse = JsonUtils.stringToJsonNode(response);
        TableResponse tableResponse = TableResponse.fromJson(jsonResponse);
        return tableResponse;
      } catch (IOException e) {
```

### UnnecessaryLocalVariable
Local variable `sqlTime` is redundant
in `pinot-clients/pinot-jdbc-client/src/main/java/org/apache/pinot/client/utils/DateTimeUtils.java`
#### Snippet
```java
    TIMESTAMP_FORMAT.setTimeZone(cal.getTimeZone());
    java.util.Date date = TIMESTAMP_FORMAT.parse(value);
    Time sqlTime = new Time(date.getTime());
    return sqlTime;
  }
```

### UnnecessaryLocalVariable
Local variable `sqlTime` is redundant
in `pinot-clients/pinot-jdbc-client/src/main/java/org/apache/pinot/client/utils/DateTimeUtils.java`
#### Snippet
```java
    TIMESTAMP_FORMAT.setTimeZone(cal.getTimeZone());
    java.util.Date date = TIMESTAMP_FORMAT.parse(value);
    Timestamp sqlTime = new Timestamp(date.getTime());
    return sqlTime;
  }
```

### UnnecessaryLocalVariable
Local variable `sqlDate` is redundant
in `pinot-clients/pinot-jdbc-client/src/main/java/org/apache/pinot/client/utils/DateTimeUtils.java`
#### Snippet
```java
    DATE_FORMAT.setTimeZone(cal.getTimeZone());
    java.util.Date date = DATE_FORMAT.parse(value);
    Date sqlDate = new Date(date.getTime());
    return sqlDate;
  }
```

### UnnecessaryLocalVariable
Local variable `sqlTime` is redundant
in `pinot-clients/pinot-jdbc-client/src/main/java/org/apache/pinot/client/utils/DateTimeUtils.java`
#### Snippet
```java

  public static Timestamp getTimestampFromLong(Long value) {
    Timestamp sqlTime = new Timestamp(value);
    return sqlTime;
  }
```

### UnnecessaryLocalVariable
Local variable `responseBody` is redundant
in `pinot-clients/pinot-jdbc-client/src/main/java/org/apache/pinot/client/controller/response/ControllerResponseFuture.java`
#### Snippet
```java
      }

      String responseBody = httpResponse.getResponseBody(StandardCharsets.UTF_8);

      return responseBody;
```

### UnnecessaryLocalVariable
Local variable `tableResponse` is redundant
in `pinot-clients/pinot-jdbc-client/src/main/java/org/apache/pinot/client/controller/response/ControllerTenantBrokerResponse.java`
#### Snippet
```java
      try {
        JsonNode jsonResponse = JsonUtils.stringToJsonNode(response);
        ControllerTenantBrokerResponse tableResponse = ControllerTenantBrokerResponse.fromJson(jsonResponse);
        return tableResponse;
      } catch (IOException e) {
```

### UnnecessaryLocalVariable
Local variable `controllerUrl` is redundant
in `pinot-clients/pinot-jdbc-client/src/main/java/org/apache/pinot/client/utils/DriverUtils.java`
#### Snippet
```java
    }
    URI uri = URI.create(url);
    String controllerUrl = String.format("%s:%d", uri.getHost(), uri.getPort());
    return controllerUrl;
  }
```

### UnnecessaryLocalVariable
Local variable `brokerList` is redundant
in `pinot-clients/pinot-jdbc-client/src/main/java/org/apache/pinot/client/utils/DriverUtils.java`
#### Snippet
```java
  public static List<String> getBrokersFromURI(URI uri) {
    String brokerUrl = String.format("%s:%d", uri.getHost(), uri.getPort());
    List<String> brokerList = Collections.singletonList(brokerUrl);
    return brokerList;
  }
```

### UnnecessaryLocalVariable
Local variable `tenantBrokers` is redundant
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotBrokerRestletResource.java`
#### Snippet
```java
  public List<String> getBrokersForTenant(String tenantName, String state) {
    List<InstanceInfo> instanceInfoList = getBrokersForTenantV2(tenantName, state);
    List<String> tenantBrokers =
        instanceInfoList.stream().map(InstanceInfo::getInstanceName).collect(Collectors.toList());
    return tenantBrokers;
```

### UnnecessaryLocalVariable
Local variable `string` is redundant
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotQueryResource.java`
#### Snippet
```java
      conn.setRequestProperty("Accept-Encoding", "gzip");

      final String string = requestStr;
      final byte[] requestBytes = string.getBytes(StandardCharsets.UTF_8);
      conn.setRequestProperty("Content-Length", String.valueOf(requestBytes.length));
```

### UnnecessaryLocalVariable
Local variable `output` is redundant
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotQueryResource.java`
#### Snippet
```java
      final byte[] bytes = drain(new BufferedInputStream(conn.getInputStream()));

      final String output = new String(bytes, StandardCharsets.UTF_8);
      /*if (LOG.isDebugEnabled()){
        LOGGER.debug("The response from the server is - " + output);
```

### UnnecessaryLocalVariable
Local variable `statemodelDefinition` is redundant
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/PinotHelixSegmentOnlineOfflineStateModelGenerator.java`
#### Snippet
```java
    builder.dynamicUpperBound(CONSUMING_STATE, "R");

    StateModelDefinition statemodelDefinition = builder.build();
    return statemodelDefinition;
  }
```

### UnnecessaryLocalVariable
Local variable `replicas` is redundant
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/PinotTableIdealStateBuilder.java`
#### Snippet
```java
  public static IdealState buildEmptyIdealStateFor(String tableName, int numCopies, boolean enableBatchMessageMode) {
    final CustomModeISBuilder customModeIdealStateBuilder = new CustomModeISBuilder(tableName);
    final int replicas = numCopies;
    customModeIdealStateBuilder
        .setStateModel(PinotHelixSegmentOnlineOfflineStateModelGenerator.PINOT_SEGMENT_ONLINE_OFFLINE_STATE_MODEL)
```

### UnnecessaryLocalVariable
Local variable `n` is redundant
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/rules/utils/QueryInvertedSortedIndexRecommender.java`
#### Snippet
```java
  public static double percentSelected(Boolean invertSelection, double cardinality, int numSelectedValues,
      double numEntriesPerDoc) {
    double n = cardinality;
    double r = numEntriesPerDoc;
    int k = numSelectedValues;
```

### UnnecessaryLocalVariable
Local variable `r` is redundant
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/rules/utils/QueryInvertedSortedIndexRecommender.java`
#### Snippet
```java
      double numEntriesPerDoc) {
    double n = cardinality;
    double r = numEntriesPerDoc;
    int k = numSelectedValues;
    double pInverted;
```

### UnnecessaryLocalVariable
Local variable `k` is redundant
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/rules/utils/QueryInvertedSortedIndexRecommender.java`
#### Snippet
```java
    double n = cardinality;
    double r = numEntriesPerDoc;
    int k = numSelectedValues;
    double pInverted;
    if (k + r <= n) {
```

### UnnecessaryLocalVariable
Local variable `kinesisPort` is redundant
in `pinot-tools/src/main/java/org/apache/pinot/tools/utils/KinesisStarterUtils.java`
#### Snippet
```java
    StreamDataServerStartable kinesisStarter;
    Properties configuration = new Properties(baseConf);
    int kinesisPort = port;
    try {
      configuration.put(KinesisStarterUtils.PORT, kinesisPort);
```

### UnnecessaryLocalVariable
Local variable `retString` is redundant
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/MoveReplicaGroup.java`
#### Snippet
```java

  public String toString() {
    String retString =
        "MoveReplicaGroup -srcHosts " + _srcHosts + " -tableName " + _tableName + " -zkHost " + _zkHost + " -zkPath "
            + _zkPath + (_exec ? " -exec" : "");
```

### UnnecessaryLocalVariable
Local variable `status` is redundant
in `pinot-tools/src/main/java/org/apache/pinot/tools/service/PinotServiceManager.java`
#### Snippet
```java
      return null;
    }
    PinotInstanceStatus status =
        new PinotInstanceStatus(serviceStartable.getServiceRole(), serviceStartable.getInstanceId(),
            serviceStartable.getConfig(), ServiceStatus.getServiceStatus(instanceName),
```

### UnnecessaryLocalVariable
Local variable `commitAsJsonNode` is redundant
in `pinot-tools/src/main/java/org/apache/pinot/tools/streams/githubevents/PullRequestMergedEvent.java`
#### Snippet
```java
      authors = new HashSet<>();
      for (JsonNode commit : _commitsArray) {
        JsonNode commitAsJsonNode = commit;
        JsonNode author = commitAsJsonNode.get("author");
        if (author.isEmpty()) {
```

### UnnecessaryLocalVariable
Local variable `commitAsJsonNode` is redundant
in `pinot-tools/src/main/java/org/apache/pinot/tools/streams/githubevents/PullRequestMergedEvent.java`
#### Snippet
```java
      committers = new HashSet<>();
      for (JsonNode commit : _commitsArray) {
        JsonNode commitAsJsonNode = commit;
        JsonNode committer = commitAsJsonNode.get("committer");
        if (committer.isEmpty()) {
```

### UnnecessaryLocalVariable
Local variable `principalOpt` is redundant
in `pinot-broker/src/main/java/org/apache/pinot/broker/broker/ZkBasicAuthAccessControlFactory.java`
#### Snippet
```java
                .collect(Collectors.toMap(name2password::get, _name2principal::get));

            Optional<ZkBasicAuthPrincipal> principalOpt =
                password2principal.entrySet().stream()
                    .filter(entry -> BcryptUtils.checkpw(entry.getKey(), entry.getValue().getPassword()))
```

### UnnecessaryLocalVariable
Local variable `principalOpt` is redundant
in `pinot-broker/src/main/java/org/apache/pinot/broker/broker/BasicAuthAccessControlFactory.java`
#### Snippet
```java

      Collection<String> tokens = identity.getHttpHeaders().get(HEADER_AUTHORIZATION);
      Optional<BasicAuthPrincipal> principalOpt =
          tokens.stream().map(BasicAuthUtils::normalizeBase64Token).map(_token2principal::get).filter(Objects::nonNull)
              .findFirst();
```

### UnnecessaryLocalVariable
Local variable `val` is redundant
in `pinot-broker/src/main/java/org/apache/pinot/broker/routing/adaptiveserverselector/HybridSelector.java`
#### Snippet
```java
    Collections.shuffle(pairList);
    Collections.sort(pairList, (o1, o2) -> {
      int val = Double.compare(o1.getRight(), o2.getRight());
      return val;
    });
```

### UnnecessaryLocalVariable
Local variable `val` is redundant
in `pinot-broker/src/main/java/org/apache/pinot/broker/routing/adaptiveserverselector/HybridSelector.java`
#### Snippet
```java
    Collections.shuffle(pairList);
    Collections.sort(pairList, (o1, o2) -> {
      int val = Double.compare(o1.getRight(), o2.getRight());
      return val;
    });
```

### UnnecessaryLocalVariable
Local variable `val` is redundant
in `pinot-broker/src/main/java/org/apache/pinot/broker/routing/adaptiveserverselector/NumInFlightReqSelector.java`
#### Snippet
```java
    Collections.shuffle(pairList);
    Collections.sort(pairList, (o1, o2) -> {
      int val = Double.compare(o1.getRight(), o2.getRight());
      return val;
    });
```

### UnnecessaryLocalVariable
Local variable `val` is redundant
in `pinot-broker/src/main/java/org/apache/pinot/broker/routing/adaptiveserverselector/NumInFlightReqSelector.java`
#### Snippet
```java
    Collections.shuffle(pairList);
    Collections.sort(pairList, (o1, o2) -> {
      int val = Double.compare(o1.getRight(), o2.getRight());
      return val;
    });
```

### UnnecessaryLocalVariable
Local variable `val` is redundant
in `pinot-broker/src/main/java/org/apache/pinot/broker/routing/adaptiveserverselector/LatencySelector.java`
#### Snippet
```java
    Collections.shuffle(pairList);
    Collections.sort(pairList, (o1, o2) -> {
      int val = Double.compare(o1.getRight(), o2.getRight());
      return val;
    });
```

### UnnecessaryLocalVariable
Local variable `val` is redundant
in `pinot-broker/src/main/java/org/apache/pinot/broker/routing/adaptiveserverselector/LatencySelector.java`
#### Snippet
```java
    Collections.shuffle(pairList);
    Collections.sort(pairList, (o1, o2) -> {
      int val = Double.compare(o1.getRight(), o2.getRight());
      return val;
    });
```

### UnnecessaryLocalVariable
Local variable `size` is redundant
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryStringCompression.java`
#### Snippet
```java
  public int benchmarkSnappyStringDecompression(BenchmarkNoDictionaryStringCompressionState state)
      throws IOException {
    int size = Snappy.uncompress(state._snappyCompressedStringInput, state._snappyStringDecompressed);
    return size;
  }
```

### UnnecessaryLocalVariable
Local variable `size` is redundant
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryStringCompression.java`
#### Snippet
```java
  public int benchmarkSnappyStringCompression(BenchmarkNoDictionaryStringCompressionState state)
      throws IOException {
    int size = Snappy.compress(state._uncompressedString, state._snappyCompressedStringOutput);
    return size;
  }
```

### UnnecessaryLocalVariable
Local variable `size` is redundant
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryStringCompression.java`
#### Snippet
```java
  public int benchmarkZstandardStringDecompression(BenchmarkNoDictionaryStringCompressionState state)
      throws IOException {
    int size = Zstd.decompress(state._zstandardStringDecompressed, state._zstandardCompressedStringInput);
    return size;
  }
```

### UnnecessaryLocalVariable
Local variable `size` is redundant
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryStringCompression.java`
#### Snippet
```java
  public int benchmarkZstandardStringCompression(BenchmarkNoDictionaryStringCompressionState state)
      throws IOException {
    int size = Zstd.compress(state._zstandardCompressedStringOutput, state._uncompressedString);
    return size;
  }
```

### UnnecessaryLocalVariable
Local variable `size` is redundant
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryIntegerCompression.java`
#### Snippet
```java
  public int benchmarkZstandardIntegerCompression(BenchmarkNoDictionaryIntegerCompressionState state)
      throws IOException {
    int size = Zstd.compress(state._zstdCompressedIntegerOutput, state._uncompressedInt);
    return size;
  }
```

### UnnecessaryLocalVariable
Local variable `size` is redundant
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryIntegerCompression.java`
#### Snippet
```java
  public int benchmarkSnappyIntegerDecompression(BenchmarkNoDictionaryIntegerCompressionState state)
      throws IOException {
    int size = Snappy.uncompress(state._snappyCompressedIntegerInput, state._snappyIntegerDecompressed);
    return size;
  }
```

### UnnecessaryLocalVariable
Local variable `size` is redundant
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryIntegerCompression.java`
#### Snippet
```java
  public int benchmarkZstandardIntegerDecompression(BenchmarkNoDictionaryIntegerCompressionState state)
      throws IOException {
    int size = Zstd.decompress(state._zstdIntegerDecompressed, state._zstandardCompressedIntegerInput);
    return size;
  }
```

### UnnecessaryLocalVariable
Local variable `size` is redundant
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryIntegerCompression.java`
#### Snippet
```java
  public int benchmarkSnappyIntegerCompression(BenchmarkNoDictionaryIntegerCompressionState state)
      throws IOException {
    int size = Snappy.compress(state._uncompressedInt, state._snappyCompressedIntegerOutput);
    return size;
  }
```

### UnnecessaryLocalVariable
Local variable `size` is redundant
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryLongCompression.java`
#### Snippet
```java
  public int benchmarkZstandardLongCompression(BenchmarkNoDictionaryLongCompressionState state)
      throws IOException {
    int size = Zstd.compress(state._zstandardCompressedLongOutput, state._uncompressedLong);
    return size;
  }
```

### UnnecessaryLocalVariable
Local variable `size` is redundant
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryLongCompression.java`
#### Snippet
```java
  public int benchmarkSnappyLongCompression(BenchmarkNoDictionaryLongCompressionState state)
      throws IOException {
    int size = Snappy.compress(state._uncompressedLong, state._snappyCompressedLongOutput);
    return size;
  }
```

### UnnecessaryLocalVariable
Local variable `size` is redundant
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryLongCompression.java`
#### Snippet
```java
  public int benchmarkZstandardLongDecompression(BenchmarkNoDictionaryLongCompressionState state)
      throws IOException {
    int size = Zstd.decompress(state._zstandardLongDecompressedOutput, state._zstandardCompressedLongInput);
    return size;
  }
```

### UnnecessaryLocalVariable
Local variable `size` is redundant
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNoDictionaryLongCompression.java`
#### Snippet
```java
  public int benchmarkSnappyLongDecompression(BenchmarkNoDictionaryLongCompressionState state)
      throws IOException {
    int size = Snappy.uncompress(state._snappyCompressedLongInput, state._snappyLongDecompressedOutput);
    return size;
  }
```

### UnnecessaryLocalVariable
Local variable `offset` is redundant
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/reader/impl/FixedByteSingleValueMultiColReader.java`
#### Snippet
```java
   */
  private int computeOffset(int row, int col) {
    final int offset = row * _rowSize + _columnOffSets[col];
    return offset;
  }
```

### UnnecessaryLocalVariable
Local variable `result` is redundant
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/fst/FSTBuilder.java`
#### Snippet
```java
      builder.add(Util.toUTF16(entry.getKey(), scratch), entry.getValue().longValue());
    }
    FST<Long> result = builder.finish();
    return result;
  }
```

### UnnecessaryLocalVariable
Local variable `geometry` is redundant
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/GeometrySerializer.java`
#### Snippet
```java
    GeometryType type = readGeometryType(typeByte);
    GeometryFactory factory = getGeometryFactory(typeByte);
    Geometry geometry = readGeometry(byteBuffer, type, factory);
    return geometry;
  }
```

### UnnecessaryLocalVariable
Local variable `metadataTarGzFilePath` is redundant
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/SegmentPushUtils.java`
#### Snippet
```java
      throws URISyntaxException {
    URI segmentTarURI = URI.create(segmentTarPath);
    URI metadataTarGzFilePath = new URI(
        segmentTarURI.getScheme(),
        segmentTarURI.getUserInfo(),
```

### UnnecessaryLocalVariable
Local variable `v3TempDirectory` is redundant
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/converter/SegmentV1V2ToV3FormatConverter.java`
#### Snippet
```java
  public File v3ConversionTempDirectory(File v2SegmentDirectory)
      throws IOException {
    File v3TempDirectory =
        Files.createTempDirectory(v2SegmentDirectory.toPath(), v2SegmentDirectory.getName() + V3_TEMP_DIR_SUFFIX)
            .toFile();
```

### UnnecessaryLocalVariable
Local variable `boundary` is redundant
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/creator/impl/inv/RangeIndexCreator.java`
#### Snippet
```java
    List<Pair<Integer, Integer>> ranges = new ArrayList<>();

    int boundary = _numValuesPerRange;
    int start = 0;
    for (int i = 0; i < _numValues; i++) {
```

### UnnecessaryLocalVariable
Local variable `data` is redundant
in `contrib/pinot-fmpp-maven-plugin/src/main/java/org/apache/pinot/fmpp/MavenDataLoader.java`
#### Snippet
```java
    }

    MavenData data = (MavenData) e.getAttribute(MAVEN_DATA_ATTRIBUTE);
    return data;
  }
```

## RuleId[id=BusyWait]
### BusyWait
Call to `Thread.sleep()` in a loop, probably busy-waiting
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-hadoop/src/main/java/org/apache/pinot/plugin/ingestion/batch/hadoop/HadoopSegmentCreationMapper.java`
#### Snippet
```java
      while (true) {
        try {
          Thread.sleep(PROGRESS_REPORTER_INTERVAL_MS);
          LOGGER.info("============== Reporting progress ==============");
          _context.progress();
```

### BusyWait
Call to `Thread.sleep()` in a loop, probably busy-waiting
in `pinot-plugins/pinot-stream-ingestion/pinot-kafka-2.0/src/main/java/org/apache/pinot/plugin/stream/kafka20/server/KafkaDataServerStartable.java`
#### Snippet
```java
          return;
        }
        Thread.sleep(checkIntervalMs);
      } catch (Exception e) {
        LOGGER.error("Caught exception while checking the condition" + errorMessageSuffix, e);
```

### BusyWait
Call to `Thread.sleep()` in a loop, probably busy-waiting
in `pinot-plugins/pinot-stream-ingestion/pinot-kinesis/src/main/java/org/apache/pinot/plugin/stream/kinesis/server/KinesisDataServerStartable.java`
#### Snippet
```java
          return;
        }
        Thread.sleep(checkIntervalMs);
      } catch (Exception e) {
        LOGGER.error("Caught exception while checking the condition" + errorMessageSuffix, e);
```

### BusyWait
Call to `Thread.sleep()` in a loop, probably busy-waiting
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/rebalance/TableRebalancer.java`
#### Snippet
```java
      }
      LOGGER.debug("ExternalView has not converged to IdealStates. Retry after: {}ms", externalViewCheckIntervalInMs);
      Thread.sleep(externalViewCheckIntervalInMs);
    } while (System.currentTimeMillis() < endTimeMs);

```

### BusyWait
Call to `Thread.sleep()` in a loop, probably busy-waiting
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/PinotHelixResourceManager.java`
#### Snippet
```java

      try {
        Thread.sleep(intervalWaitTimeMs);
      } catch (InterruptedException e) {
        LOGGER.warn("Got interrupted when sleeping for {}ms to wait until the current state matched for instance: {}",
```

### BusyWait
Call to `Thread.sleep()` in a loop, probably busy-waiting
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/PinotHelixResourceManager.java`
#### Snippet
```java
        return true;
      }
      Thread.sleep(EXTERNAL_VIEW_CHECK_INTERVAL_MS);
    } while (System.currentTimeMillis() < endTimeMs);
    LOGGER.warn("Timed out while waiting for segment: {} to become ONLINE for table: {}", segmentNotOnline,
```

### BusyWait
Call to `Thread.sleep()` in a loop, probably busy-waiting
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/realtime/PinotLLCRealtimeSegmentManager.java`
#### Snippet
```java
          thisWait = millisToWait;
        }
        Thread.sleep(thisWait);
        millisToWait -= thisWait;
      } catch (InterruptedException e) {
```

### BusyWait
Call to `Thread.sleep()` in a loop, probably busy-waiting
in `pinot-server/src/main/java/org/apache/pinot/server/starter/helix/BaseServerStarter.java`
#### Snippet
```java
          LOGGER.info("Sleep for {}ms as some resources [{}, ...] are still ONLINE", sleepTimeMs, currentResource);
          try {
            Thread.sleep(sleepTimeMs);
          } catch (InterruptedException e) {
            LOGGER.warn("Got interrupted while waiting for all resources OFFLINE", e);
```

### BusyWait
Call to `Thread.sleep()` in a loop, probably busy-waiting
in `pinot-server/src/main/java/org/apache/pinot/server/starter/helix/BaseServerStarter.java`
#### Snippet
```java
              + "{}ms)", sleepTimeMs, noQueryTimeMs, noQueryThresholdMs);
      try {
        Thread.sleep(sleepTimeMs);
      } catch (InterruptedException e) {
        LOGGER.warn("Got interrupted while waiting for no incoming queries", e);
```

### BusyWait
Call to `Thread.sleep()` in a loop, probably busy-waiting
in `pinot-server/src/main/java/org/apache/pinot/server/starter/helix/BaseServerStarter.java`
#### Snippet
```java
            ServiceStatus.getStatusDescription());
        try {
          Thread.sleep(sleepTimeMs);
        } catch (InterruptedException e) {
          LOGGER.warn("Got interrupted while checking service status", e);
```

### BusyWait
Call to `Thread.sleep()` in a loop, probably busy-waiting
in `pinot-compatibility-verifier/src/main/java/org/apache/pinot/compat/SegmentOp.java`
#### Snippet
```java
      LOGGER.warn("Delete segment verification count greater than zero, will retry after {} ms.",
          DEFAULT_SLEEP_INTERVAL_MS);
      Thread.sleep(DEFAULT_SLEEP_INTERVAL_MS);
    }

```

### BusyWait
Call to `Thread.sleep()` in a loop, probably busy-waiting
in `pinot-compatibility-verifier/src/main/java/org/apache/pinot/compat/SegmentOp.java`
#### Snippet
```java
      }
      LOGGER.warn("Routing table has not been updated yet, will retry after {} ms.", DEFAULT_SLEEP_INTERVAL_MS);
      Thread.sleep(DEFAULT_SLEEP_INTERVAL_MS);
      result = Utils.postSqlQuery(query, clusterDescriptor.getBrokerUrl());
    }
```

### BusyWait
Call to `Thread.sleep()` in a loop, probably busy-waiting
in `pinot-compatibility-verifier/src/main/java/org/apache/pinot/compat/SegmentOp.java`
#### Snippet
```java
      }
      LOGGER.warn("Upload segment verification count is zero, will retry after {} ms.", DEFAULT_SLEEP_INTERVAL_MS);
      Thread.sleep(DEFAULT_SLEEP_INTERVAL_MS);
    }

```

### BusyWait
Call to `Thread.sleep()` in a loop, probably busy-waiting
in `pinot-server/src/main/java/org/apache/pinot/server/starter/helix/HelixInstanceDataManager.java`
#### Snippet
```java
        return;
      }
      Thread.sleep(_externalViewDroppedCheckInternalMs);
    } while (System.currentTimeMillis() < endTimeMs);
    throw new TimeoutException(
```

### BusyWait
Call to `Thread.sleep()` in a loop, probably busy-waiting
in `pinot-tools/src/main/java/org/apache/pinot/tools/BootstrapTableTool.java`
#### Snippet
```java
    while (System.currentTimeMillis() - startTime < timeoutInMillis) {
      try {
        Thread.sleep(500L);
      } catch (InterruptedException e) {
        // Swallow the exception
```

### BusyWait
Call to `Thread.sleep()` in a loop, probably busy-waiting
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/QueryRunner.java`
#### Snippet
```java
        }
        while (!queryQueue.offer(query)) {
          Thread.sleep(1);
        }

```

### BusyWait
Call to `Thread.sleep()` in a loop, probably busy-waiting
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/QueryRunner.java`
#### Snippet
```java
    // Wait for all queries getting executed.
    while (!queryQueue.isEmpty()) {
      Thread.sleep(1);
    }
    executorService.shutdownNow();
```

### BusyWait
Call to `Thread.sleep()` in a loop, probably busy-waiting
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/QueryRunner.java`
#### Snippet
```java
    executorService.shutdownNow();
    while (!executorService.isTerminated()) {
      Thread.sleep(1);
    }

```

### BusyWait
Call to `Thread.sleep()` in a loop, probably busy-waiting
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/QueryRunner.java`
#### Snippet
```java

        while (!queryQueue.offer(query)) {
          Thread.sleep(1);
        }

```

### BusyWait
Call to `Thread.sleep()` in a loop, probably busy-waiting
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/QueryRunner.java`
#### Snippet
```java
    // Wait for all queries getting executed.
    while (!queryQueue.isEmpty()) {
      Thread.sleep(1);
    }
    executorService.shutdownNow();
```

### BusyWait
Call to `Thread.sleep()` in a loop, probably busy-waiting
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/QueryRunner.java`
#### Snippet
```java
    executorService.shutdownNow();
    while (!executorService.isTerminated()) {
      Thread.sleep(1);
    }

```

### BusyWait
Call to `Thread.sleep()` in a loop, probably busy-waiting
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/QueryRunner.java`
#### Snippet
```java
        if (query == null) {
          try {
            Thread.sleep(1);
            continue;
          } catch (InterruptedException e) {
```

### BusyWait
Call to `Thread.sleep()` in a loop, probably busy-waiting
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/QueryRunner.java`
#### Snippet
```java

        while (!queryQueue.offer(query)) {
          Thread.sleep(1);
        }

```

### BusyWait
Call to `Thread.sleep()` in a loop, probably busy-waiting
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/QueryRunner.java`
#### Snippet
```java
    // Wait for all queries getting executed.
    while (!queryQueue.isEmpty()) {
      Thread.sleep(1);
    }
    executorService.shutdownNow();
```

### BusyWait
Call to `Thread.sleep()` in a loop, probably busy-waiting
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/QueryRunner.java`
#### Snippet
```java
    executorService.shutdownNow();
    while (!executorService.isTerminated()) {
      Thread.sleep(1);
    }

```

### BusyWait
Call to `Thread.sleep()` in a loop, probably busy-waiting
in `pinot-tools/src/main/java/org/apache/pinot/tools/streams/PinotRealtimeSource.java`
#### Snippet
```java
        if (rows.isEmpty()) {
          try {
            Thread.sleep(DEFAULT_EMPTY_SOURCE_SLEEP_MS);
          } catch (InterruptedException ex) {
            LOGGER.warn("Interrupted from sleep, will check shutdown flag later", ex);
```

### BusyWait
Call to `Thread.sleep()` in a loop, probably busy-waiting
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/realtime/impl/invertedindex/RealtimeLuceneIndexReaderRefreshThread.java`
#### Snippet
```java

      try {
        Thread.sleep(DELAY_BETWEEN_SUCCESSIVE_EXECUTION_MS_DEFAULT);
      } catch (Exception e) {
        LOGGER.warn("Realtime lucene reader refresh thread got interrupted while sleeping: ", e);
```

## RuleId[id=ArraysAsListWithZeroOrOneArgument]
### ArraysAsListWithZeroOrOneArgument
Call to `asList()` with only one argument
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-spark-3.2/src/main/java/org/apache/pinot/plugin/ingestion/batch/spark3/SparkSegmentTarPushJobRunner.java`
#### Snippet
```java
          try {
            SegmentPushUtils.pushSegments(_spec, PinotFSFactory.create(finalOutputDirURI.getScheme()),
                Arrays.asList(segmentTarPath));
          } catch (RetriableOperationException | AttemptsExceededException e) {
            throw new RuntimeException(e);
```

### ArraysAsListWithZeroOrOneArgument
Call to `asList()` with only one argument
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-spark-3.2/src/main/java/org/apache/pinot/plugin/ingestion/batch/spark3/SparkSegmentUriPushJobRunner.java`
#### Snippet
```java
                  .register(pinotFSSpec.getScheme(), pinotFSSpec.getClassName(), new PinotConfiguration(pinotFSSpec));
            }
            SegmentPushUtils.sendSegmentUris(_spec, Arrays.asList(segmentUri));
          } catch (RetriableOperationException | AttemptsExceededException e) {
            throw new RuntimeException(e);
```

### ArraysAsListWithZeroOrOneArgument
Call to `asList()` with only one argument
in `pinot-spi/src/main/java/org/apache/pinot/spi/metrics/PinotMetricUtils.java`
#### Snippet
```java
    synchronized (PinotMetricUtils.class) {
      List<String> listenerClassNames = configuration.getProperty("metricsRegistryRegistrationListeners",
          Arrays.asList(JmxReporterMetricsRegistryRegistrationListener.class.getName()));

      // Build each listener using their default constructor and add them
```

### ArraysAsListWithZeroOrOneArgument
Call to `asList()` with only one argument
in `pinot-plugins/pinot-minion-tasks/pinot-minion-builtin-tasks/src/main/java/org/apache/pinot/plugin/minion/tasks/segmentgenerationandpush/SegmentGenerationAndPushTaskExecutor.java`
#### Snippet
```java
        case TAR:
          try (PinotFS pinotFS = MinionTaskUtils.getLocalPinotFs()) {
            SegmentPushUtils.pushSegments(spec, pinotFS, Arrays.asList(outputSegmentTarURI.toString()));
          } catch (RetriableOperationException | AttemptsExceededException e) {
            throw new RuntimeException(e);
```

### ArraysAsListWithZeroOrOneArgument
Call to `asList()` with only one argument
in `pinot-plugins/pinot-stream-ingestion/pinot-kafka-2.0/src/main/java/org/apache/pinot/plugin/stream/kafka20/server/KafkaDataServerStartable.java`
#### Snippet
```java
  public void createTopic(String topic, Properties props) {
    int partition = (Integer) props.get("partition");
    Collection<NewTopic> topicList = Arrays.asList(new NewTopic(topic, partition, (short) 1));
    _adminClient.createTopics(topicList);
    waitForCondition(new Function<Void, Boolean>() {
```

### ArraysAsListWithZeroOrOneArgument
Call to `asList()` with only one argument
in `pinot-common/src/main/java/org/apache/pinot/sql/parsers/rewriter/OrdinalsUpdater.java`
#### Snippet
```java
        final int ordinal = (int) orderByExpr.getLiteral().getLongValue();
        pinotQuery.getOrderByList().get(i).getFunctionCall()
            .setOperands(Arrays.asList(getExpressionFromOrdinal(pinotQuery.getSelectList(), ordinal)));
      }
    }
```

### ArraysAsListWithZeroOrOneArgument
Call to `asList()` with only one argument
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
      tableTypes = Arrays.asList(TableType.OFFLINE.toString(), TableType.REALTIME.toString());
    } else {
      tableTypes = Arrays.asList(tableType.toString());
    }
    ControllerRequestURLBuilder controllerRequestURLBuilder =
```

### ArraysAsListWithZeroOrOneArgument
Call to `asList()` with only one argument
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
    // Add table name as a request parameter
    NameValuePair tableNameValuePair = new BasicNameValuePair(QueryParameters.TABLE_NAME, rawTableName);
    List<NameValuePair> parameters = Arrays.asList(tableNameValuePair);
    return uploadSegment(uri, segmentName, inputStream, null, parameters, HttpClient.DEFAULT_SOCKET_TIMEOUT_MS);
  }
```

### ArraysAsListWithZeroOrOneArgument
Call to `asList()` with only one argument
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
    // Add table name as a request parameter
    NameValuePair tableNameValuePair = new BasicNameValuePair(QueryParameters.TABLE_NAME, rawTableName);
    List<NameValuePair> parameters = Arrays.asList(tableNameValuePair);
    return sendSegmentUri(uri, downloadUri, null, parameters, HttpClient.DEFAULT_SOCKET_TIMEOUT_MS);
  }
```

### ArraysAsListWithZeroOrOneArgument
Call to `asList()` with only one argument
in `pinot-core/src/main/java/org/apache/pinot/core/util/SegmentProcessorAvroUtils.java`
#### Snippet
```java
      Object value = genericRow.getValue(field);
      if (value instanceof Object[]) {
        reusableRecord.put(field, Arrays.asList((Object[]) value));
      } else {
        if (value instanceof byte[]) {
```

### ArraysAsListWithZeroOrOneArgument
Call to `asList()` with only one argument
in `pinot-controller/src/main/java/org/apache/pinot/controller/ControllerConf.java`
#### Snippet
```java
  public List<String> getControllerAccessProtocols() {
    return getProperty(CONTROLLER_ACCESS_PROTOCOLS,
        getControllerPort() == null ? Arrays.asList("http") : Arrays.asList());
  }

```

### ArraysAsListWithZeroOrOneArgument
Call to `asList()` to create an empty List
in `pinot-controller/src/main/java/org/apache/pinot/controller/ControllerConf.java`
#### Snippet
```java
  public List<String> getControllerAccessProtocols() {
    return getProperty(CONTROLLER_ACCESS_PROTOCOLS,
        getControllerPort() == null ? Arrays.asList("http") : Arrays.asList());
  }

```

### ArraysAsListWithZeroOrOneArgument
Call to `asList()` with only one argument
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotSegmentRestletResource.java`
#### Snippet
```java
      // No need to query servers where this segment is not supposed to be hosted
      serverToSegments = new HashMap<>();
      List<String> segmentList = Arrays.asList(singleSegmentName);
      _pinotHelixResourceManager.getServers(tableNameWithType, singleSegmentName).forEach(server -> {
        serverToSegments.put(server, segmentList);
```

### ArraysAsListWithZeroOrOneArgument
Call to `asList()` with only one argument
in `pinot-tools/src/main/java/org/apache/pinot/tools/GenericQuickstart.java`
#### Snippet
```java
  @Override
  public List<String> types() {
    return Arrays.asList("GENERIC");
  }

```

### ArraysAsListWithZeroOrOneArgument
Call to `asList()` with only one argument
in `pinot-tools/src/main/java/org/apache/pinot/tools/segment/converter/PinotSegmentToAvroConverter.java`
#### Snippet
```java
            Object value = entry.getValue();
            if (value instanceof Object[]) {
              record.put(field, Arrays.asList((Object[]) value));
            } else if (value instanceof byte[]) {
              record.put(field, ByteBuffer.wrap((byte[]) value));
```

### ArraysAsListWithZeroOrOneArgument
Call to `asList()` with only one argument
in `pinot-tools/src/main/java/org/apache/pinot/tools/anonymizer/PinotDataAndQueryAnonymizer.java`
#### Snippet
```java
          avroRow.put(derivedColumnName, origValue);
        } else {
          avroRow.put(derivedColumnName, Arrays.asList((Object[]) origValue));
        }
      } else if (_globalDictionaryColumns.containsKey(columnName)) {
```

### ArraysAsListWithZeroOrOneArgument
Call to `asList()` with only one argument
in `pinot-tools/src/main/java/org/apache/pinot/tools/anonymizer/PinotDataAndQueryAnonymizer.java`
#### Snippet
```java
            Object[] derivedMultiValues =
                _globalDictionaries.getDerivedValuesForOrigValuesMV(columnName, origMultiValues);
            avroRow.put(derivedColumnName, Arrays.asList(derivedMultiValues));
          }
        }
```

### ArraysAsListWithZeroOrOneArgument
Call to `asList()` with only one argument
in `pinot-tools/src/main/java/org/apache/pinot/tools/anonymizer/PinotDataAndQueryAnonymizer.java`
#### Snippet
```java
          avroRow.put(derivedColumnName, derivedValue);
        } else {
          avroRow.put(derivedColumnName, Arrays.asList((Object[]) derivedValue));
        }
      }
```

### ArraysAsListWithZeroOrOneArgument
Call to `asList()` with only one argument
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-spark-2.4/src/main/java/org/apache/pinot/plugin/ingestion/batch/spark/SparkSegmentTarPushJobRunner.java`
#### Snippet
```java
          try {
            SegmentPushUtils.pushSegments(_spec, PinotFSFactory.create(finalOutputDirURI.getScheme()),
                Arrays.asList(segmentTarPath));
          } catch (RetriableOperationException | AttemptsExceededException e) {
            throw new RuntimeException(e);
```

### ArraysAsListWithZeroOrOneArgument
Call to `asList()` with only one argument
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-spark-2.4/src/main/java/org/apache/pinot/plugin/ingestion/batch/spark/SparkSegmentUriPushJobRunner.java`
#### Snippet
```java
                  .register(pinotFSSpec.getScheme(), pinotFSSpec.getClassName(), new PinotConfiguration(pinotFSSpec));
            }
            SegmentPushUtils.sendSegmentUris(_spec, Arrays.asList(segmentUri));
          } catch (RetriableOperationException | AttemptsExceededException e) {
            throw new RuntimeException(e);
```

### ArraysAsListWithZeroOrOneArgument
Call to `asList()` with only one argument
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkNativeVsLuceneTextIndex.java`
#### Snippet
```java

    TableConfig tableConfig = new TableConfigBuilder(TableType.OFFLINE).setTableName(TABLE_NAME)
        .setInvertedIndexColumns(Arrays.asList(DOMAIN_NAMES_COL)).setFieldConfigList(fieldConfigs).build();
    Schema schema = new Schema.SchemaBuilder().setSchemaName(TABLE_NAME)
        .addSingleValueDimension(DOMAIN_NAMES_COL, FieldSpec.DataType.STRING)
```

## RuleId[id=RedundantFileCreation]
### RedundantFileCreation
`new File` is redundant
in `pinot-common/src/main/java/org/apache/pinot/common/utils/ClientSSLContextGenerator.java`
#### Snippet
```java
    if (_serverCACertFile != null) {
      LOGGER.info("Initializing trust store from {}", _serverCACertFile);
      FileInputStream is = new FileInputStream(new File(_serverCACertFile));
      KeyStore trustStore = KeyStore.getInstance(KeyStore.getDefaultType());
      trustStore.load(null);
```

### RedundantFileCreation
`new File` is redundant
in `pinot-common/src/main/java/org/apache/pinot/common/utils/ClientSSLContextGenerator.java`
#### Snippet
```java
      KeyStore keyStore = KeyStore.getInstance(KEYSTORE_TYPE);
      LOGGER.info("Setting up keystore with file {}", _keyStoreFile);
      keyStore.load(new FileInputStream(new File(_keyStoreFile)), _keyStorePassword.toCharArray());
      KeyManagerFactory kmf = KeyManagerFactory.getInstance(KEYMANAGER_FACTORY_ALGORITHM);
      kmf.init(keyStore, _keyStorePassword.toCharArray());
```

### RedundantFileCreation
`new File` is redundant
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/RealtimeProvisioningHelperCommand.java`
#### Snippet
```java

    TableConfig tableConfig;
    try (FileInputStream fis = new FileInputStream(new File(_tableConfigFile))) {
      String tableConfigString = IOUtils.toString(fis);
      tableConfig = JsonUtils.stringToObject(tableConfigString, TableConfig.class);
```

### RedundantFileCreation
`new File` is redundant
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/realtime/impl/RealtimeSegmentStatsHistory.java`
#### Snippet
```java

  private void save() {
    try (OutputStream os = new FileOutputStream(new File(_historyFilePath));
        ObjectOutputStream obos = new ObjectOutputStream(os)) {
      obos.writeObject(this);
```

## RuleId[id=IntegerDivisionInFloatingPointContext]
### IntegerDivisionInFloatingPointContext
`Math.round(Double.valueOf(jsonArray.get(k).asText()) * 100) / 100`: integer division in floating-point context
in `pinot-common/src/main/java/org/apache/pinot/common/utils/SqlResultComparator.java`
#### Snippet
```java
          List<String> arrayStr = new ArrayList<>();
          for (int k = 0; k < jsonArray.size(); k++) {
            double round = Math.round(Double.valueOf(jsonArray.get(k).asText()) * 100) / 100;
            arrayStr.add(String.valueOf(round));
          }
```

### IntegerDivisionInFloatingPointContext
`sizeInBytes / (1024 * 1024)`: integer division in floating-point context
in `pinot-perf/src/main/java/org/apache/pinot/perf/RawIndexBenchmark.java`
#### Snippet
```java
   */
  private double toMegaBytes(long sizeInBytes) {
    return sizeInBytes / (1024 * 1024);
  }

```

### IntegerDivisionInFloatingPointContext
`totalNumValues / numDocs`: integer division in floating-point context
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/writer/impl/FixedBitMVForwardIndexWriter.java`
#### Snippet
```java
  public FixedBitMVForwardIndexWriter(File file, int numDocs, int totalNumValues, int numBitsPerValue)
      throws Exception {
    float averageValuesPerDoc = totalNumValues / numDocs;
    _docsPerChunk = (int) (Math.ceil(PREFERRED_NUM_VALUES_PER_CHUNK / averageValuesPerDoc));
    _numChunks = (numDocs + _docsPerChunk - 1) / _docsPerChunk;
```

### IntegerDivisionInFloatingPointContext
`numValues / numDocs`: integer division in floating-point context
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/readers/forward/FixedBitMVForwardIndexReader.java`
#### Snippet
```java
    _numDocs = numDocs;
    _numValues = numValues;
    _numDocsPerChunk = (int) (Math.ceil((float) PREFERRED_NUM_VALUES_PER_CHUNK / (numValues / numDocs)));
    int numChunks = (numDocs + _numDocsPerChunk - 1) / _numDocsPerChunk;
    long endOffset = numChunks * Integer.BYTES;
```

## RuleId[id=UseBulkOperation]
### UseBulkOperation
Iteration can be replaced with bulk 'Map.putAll()' call
in `pinot-server/src/main/java/org/apache/pinot/server/starter/helix/BaseServerStarter.java`
#### Snippet
```java
        // we need to preserve those KV pairs and only update the different values.
        for (Map.Entry<String, String> entry : newSystemResourceInfoMap.entrySet()) {
          existingSystemResourceInfoMap.put(entry.getKey(), entry.getValue());
        }
      }
```

### UseBulkOperation
Iteration can be replaced with bulk 'Collection.addAll()' call
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/MoveReplicaGroup.java`
#### Snippet
```java
    }
    for (ServerInstance removedServer : removedServers) {
      destinationServers.add(removedServer);
    }
    return selectedServer;
```

### UseBulkOperation
Iteration can be replaced with bulk 'Map.putAll()' call
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/MoveReplicaGroup.java`
#### Snippet
```java
      Map<String, String> instanceCopy = new HashMap<>(segmentEntry.getValue().size());
      for (Map.Entry<String, String> instanceEntry : segmentEntry.getValue().entrySet()) {
        instanceCopy.put(instanceEntry.getKey(), instanceEntry.getValue());
      }
      copy.put(segmentEntry.getKey(), instanceCopy);
```

### UseBulkOperation
Iteration can be replaced with bulk 'Map.putAll()' call
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/MoveReplicaGroup.java`
#### Snippet
```java

        for (Map.Entry<String, Map<String, String>> segmentEntry : proposedIdealState.entrySet()) {
          existingMapField.put(segmentEntry.getKey(), segmentEntry.getValue());
        }
        return input;
```

### UseBulkOperation
Iteration can be replaced with bulk 'Collection.addAll()' call
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/upsert/merger/UnionMerger.java`
#### Snippet
```java
    Set<Object> union = new TreeSet<>();
    for (Object value : a) {
      union.add(value);
    }
    for (Object value : b) {
```

### UseBulkOperation
Iteration can be replaced with bulk 'Collection.addAll()' call
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/upsert/merger/UnionMerger.java`
#### Snippet
```java
    }
    for (Object value : b) {
      union.add(value);
    }
    return union.toArray();
```

### UseBulkOperation
Iteration can be replaced with bulk 'Collection.addAll()' call
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/realtime/impl/dictionary/BaseOffHeapMutableDictionary.java`
#### Snippet
```java
    List<IntBuffer> newList = new ArrayList<>(oldList.size() + 1);
    for (IntBuffer iBuf : oldList) {
      newList.add(iBuf);
    }
    LOGGER.info("Allocating {} bytes for: {}", bbSize, _allocationContext);
```

## RuleId[id=UnstableApiUsage]
### UnstableApiUsage
'com.google.common.net.InetAddresses' is marked unstable with @Beta
in `pinot-plugins/pinot-minion-tasks/pinot-minion-builtin-tasks/src/main/java/org/apache/pinot/plugin/minion/tasks/SegmentConversionUtils.java`
#### Snippet
```java
        // request. Otherwise, if the upload address is a LB address, when the LB be configured as "disallow direct
        // access by IP address", upload will fail.
        if (!InetAddresses.isInetAddress(hostName)) {
          httpHeaders.add(new BasicHeader(HttpHeaders.HOST, hostName + ":" + hostPort));
        }
```

### UnstableApiUsage
'isInetAddress(java.lang.String)' is declared in unstable class 'com.google.common.net.InetAddresses' marked with @Beta
in `pinot-plugins/pinot-minion-tasks/pinot-minion-builtin-tasks/src/main/java/org/apache/pinot/plugin/minion/tasks/SegmentConversionUtils.java`
#### Snippet
```java
        // request. Otherwise, if the upload address is a LB address, when the LB be configured as "disallow direct
        // access by IP address", upload will fail.
        if (!InetAddresses.isInetAddress(hostName)) {
          httpHeaders.add(new BasicHeader(HttpHeaders.HOST, hostName + ":" + hostPort));
        }
```

### UnstableApiUsage
'com.google.common.util.concurrent.Uninterruptibles' is marked unstable with @Beta
in `pinot-plugins/pinot-stream-ingestion/pinot-kafka-2.0/src/main/java/org/apache/pinot/plugin/stream/kafka20/KafkaStreamLevelConsumerManager.java`
#### Snippet
```java
          try {
            // Await the shutdown time
            Uninterruptibles.sleepUninterruptibly(CONSUMER_SHUTDOWN_DELAY_MILLIS, TimeUnit.MILLISECONDS);

            // Shutdown all consumers that have not been re-acquired
```

### UnstableApiUsage
'sleepUninterruptibly(long, java.util.concurrent.TimeUnit)' is declared in unstable class 'com.google.common.util.concurrent.Uninterruptibles' marked with @Beta
in `pinot-plugins/pinot-stream-ingestion/pinot-kafka-2.0/src/main/java/org/apache/pinot/plugin/stream/kafka20/KafkaStreamLevelConsumerManager.java`
#### Snippet
```java
          try {
            // Await the shutdown time
            Uninterruptibles.sleepUninterruptibly(CONSUMER_SHUTDOWN_DELAY_MILLIS, TimeUnit.MILLISECONDS);

            // Shutdown all consumers that have not been re-acquired
```

### UnstableApiUsage
'com.google.common.net.InetAddresses' is marked unstable with @Beta
in `pinot-common/src/main/java/org/apache/pinot/common/utils/RoundRobinURIProvider.java`
#### Snippet
```java
      throws UnknownHostException, URISyntaxException {
    String hostName = originalUri.getHost();
    if (InetAddresses.isInetAddress(hostName)) {
      _uris = new URI[]{originalUri};
    } else {
```

### UnstableApiUsage
'isInetAddress(java.lang.String)' is declared in unstable class 'com.google.common.net.InetAddresses' marked with @Beta
in `pinot-common/src/main/java/org/apache/pinot/common/utils/RoundRobinURIProvider.java`
#### Snippet
```java
      throws UnknownHostException, URISyntaxException {
    String hostName = originalUri.getHost();
    if (InetAddresses.isInetAddress(hostName)) {
      _uris = new URI[]{originalUri};
    } else {
```

### UnstableApiUsage
'com.google.common.util.concurrent.RateLimiter' is marked unstable with @Beta
in `pinot-common/src/main/java/org/apache/pinot/common/utils/TarGzCompressionUtils.java`
#### Snippet
```java
      }
    } else {
      RateLimiter rateLimiter = RateLimiter.create(maxStreamRateInByte);
      for (count = 0L; -1 != (n = inputStream.read(buffer)); count += (long) n) {
        rateLimiter.acquire(n);
```

### UnstableApiUsage
'com.google.common.util.concurrent.RateLimiter' is marked unstable with @Beta
in `pinot-common/src/main/java/org/apache/pinot/common/utils/TarGzCompressionUtils.java`
#### Snippet
```java
      }
    } else {
      RateLimiter rateLimiter = RateLimiter.create(maxStreamRateInByte);
      for (count = 0L; -1 != (n = inputStream.read(buffer)); count += (long) n) {
        rateLimiter.acquire(n);
```

### UnstableApiUsage
'create(double)' is declared in unstable class 'com.google.common.util.concurrent.RateLimiter' marked with @Beta
in `pinot-common/src/main/java/org/apache/pinot/common/utils/TarGzCompressionUtils.java`
#### Snippet
```java
      }
    } else {
      RateLimiter rateLimiter = RateLimiter.create(maxStreamRateInByte);
      for (count = 0L; -1 != (n = inputStream.read(buffer)); count += (long) n) {
        rateLimiter.acquire(n);
```

### UnstableApiUsage
'acquire(int)' is declared in unstable class 'com.google.common.util.concurrent.RateLimiter' marked with @Beta
in `pinot-common/src/main/java/org/apache/pinot/common/utils/TarGzCompressionUtils.java`
#### Snippet
```java
      RateLimiter rateLimiter = RateLimiter.create(maxStreamRateInByte);
      for (count = 0L; -1 != (n = inputStream.read(buffer)); count += (long) n) {
        rateLimiter.acquire(n);
        outputStream.write(buffer, 0, n);
        fd.sync();
```

### UnstableApiUsage
'com.google.common.net.InetAddresses' is marked unstable with @Beta
in `pinot-common/src/main/java/org/apache/pinot/common/utils/fetcher/HttpSegmentFetcher.java`
#### Snippet
```java
        // access by IP address", downloading will fail.
        List<Header> httpHeaders = new LinkedList<>();
        if (!InetAddresses.isInetAddress(hostName)) {
          httpHeaders.add(new BasicHeader(HttpHeaders.HOST, hostName + ":" + port));
        }
```

### UnstableApiUsage
'isInetAddress(java.lang.String)' is declared in unstable class 'com.google.common.net.InetAddresses' marked with @Beta
in `pinot-common/src/main/java/org/apache/pinot/common/utils/fetcher/HttpSegmentFetcher.java`
#### Snippet
```java
        // access by IP address", downloading will fail.
        List<Header> httpHeaders = new LinkedList<>();
        if (!InetAddresses.isInetAddress(hostName)) {
          httpHeaders.add(new BasicHeader(HttpHeaders.HOST, hostName + ":" + port));
        }
```

### UnstableApiUsage
'com.google.common.net.InetAddresses' is marked unstable with @Beta
in `pinot-common/src/main/java/org/apache/pinot/common/utils/fetcher/HttpSegmentFetcher.java`
#### Snippet
```java
        // access by IP address", downloading will fail.
        List<Header> httpHeaders = new LinkedList<>();
        if (!InetAddresses.isInetAddress(hostName)) {
          httpHeaders.add(new BasicHeader(HttpHeaders.HOST, hostName + ":" + port));
        }
```

### UnstableApiUsage
'isInetAddress(java.lang.String)' is declared in unstable class 'com.google.common.net.InetAddresses' marked with @Beta
in `pinot-common/src/main/java/org/apache/pinot/common/utils/fetcher/HttpSegmentFetcher.java`
#### Snippet
```java
        // access by IP address", downloading will fail.
        List<Header> httpHeaders = new LinkedList<>();
        if (!InetAddresses.isInetAddress(hostName)) {
          httpHeaders.add(new BasicHeader(HttpHeaders.HOST, hostName + ":" + port));
        }
```

### UnstableApiUsage
'withKeyValueSeparator(char)' is marked unstable with @Beta
in `pinot-common/src/main/java/org/apache/pinot/common/utils/request/RequestUtils.java`
#### Snippet
```java

  public static Map<String, String> getOptionsFromString(String optionStr) {
    return Splitter.on(';').omitEmptyStrings().trimResults().withKeyValueSeparator('=').split(optionStr);
  }
}
```

### UnstableApiUsage
'split(java.lang.CharSequence)' is declared in unstable class 'com.google.common.base.Splitter.MapSplitter' marked with @Beta
in `pinot-common/src/main/java/org/apache/pinot/common/utils/request/RequestUtils.java`
#### Snippet
```java

  public static Map<String, String> getOptionsFromString(String optionStr) {
    return Splitter.on(';').omitEmptyStrings().trimResults().withKeyValueSeparator('=').split(optionStr);
  }
}
```

### UnstableApiUsage
'com.google.common.util.concurrent.Uninterruptibles' is marked unstable with @Beta
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/SegmentBuildTimeLeaseExtender.java`
#### Snippet
```java
        }
        if (status != SegmentCompletionProtocol.ControllerResponseStatus.PROCESSED) {
          Uninterruptibles.sleepUninterruptibly(2, TimeUnit.SECONDS);
          LOGGER.warn("Retrying lease extension for {} because controller status {}", segmentId, status.toString());
          nAttempts++;
```

### UnstableApiUsage
'sleepUninterruptibly(long, java.util.concurrent.TimeUnit)' is declared in unstable class 'com.google.common.util.concurrent.Uninterruptibles' marked with @Beta
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/SegmentBuildTimeLeaseExtender.java`
#### Snippet
```java
        }
        if (status != SegmentCompletionProtocol.ControllerResponseStatus.PROCESSED) {
          Uninterruptibles.sleepUninterruptibly(2, TimeUnit.SECONDS);
          LOGGER.warn("Retrying lease extension for {} because controller status {}", segmentId, status.toString());
          nAttempts++;
```

### UnstableApiUsage
'acquire(int)' is declared in unstable class 'com.google.common.util.concurrent.RateLimiter' marked with @Beta
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/RealtimeConsumptionRateManager.java`
#### Snippet
```java
      _metricEmitter.emitMetric(numMsgs, _rate, Clock.systemUTC().instant());
      if (InstanceHolder.INSTANCE._isThrottlingAllowed && numMsgs > 0) {
        _rateLimiter.acquire(numMsgs);
      }
    }
```

### UnstableApiUsage
'com.google.common.util.concurrent.RateLimiter' is marked unstable with @Beta
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/RealtimeConsumptionRateManager.java`
#### Snippet
```java
    private RateLimiterImpl(double rate, MetricEmitter metricEmitter) {
      _rate = rate;
      _rateLimiter = RateLimiter.create(rate);
      _metricEmitter = metricEmitter;
    }
```

### UnstableApiUsage
'create(double)' is declared in unstable class 'com.google.common.util.concurrent.RateLimiter' marked with @Beta
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/RealtimeConsumptionRateManager.java`
#### Snippet
```java
    private RateLimiterImpl(double rate, MetricEmitter metricEmitter) {
      _rate = rate;
      _rateLimiter = RateLimiter.create(rate);
      _metricEmitter = metricEmitter;
    }
```

### UnstableApiUsage
'com.google.common.util.concurrent.RateLimiter' is marked unstable with @Beta
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/RealtimeConsumptionRateManager.java`
#### Snippet
```java
  static class RateLimiterImpl implements ConsumptionRateLimiter {
    private final double _rate;
    private final RateLimiter _rateLimiter;
    private MetricEmitter _metricEmitter;

```

### UnstableApiUsage
'com.google.common.util.concurrent.Futures' is marked unstable with @Beta
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/RealtimeConsumptionRateManager.java`
#### Snippet
```java
            // if partition count fetcher cannot fetch the value, old value is returned
            Integer count = partitionCountFetcher.fetch(key);
            return Futures.immediateFuture(count != null ? count : oldValue);
          }
        });
```

### UnstableApiUsage
'immediateFuture(V)' is declared in unstable class 'com.google.common.util.concurrent.Futures' marked with @Beta
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/RealtimeConsumptionRateManager.java`
#### Snippet
```java
            // if partition count fetcher cannot fetch the value, old value is returned
            Integer count = partitionCountFetcher.fetch(key);
            return Futures.immediateFuture(count != null ? count : oldValue);
          }
        });
```

### UnstableApiUsage
'com.google.common.util.concurrent.Uninterruptibles' is marked unstable with @Beta
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/HLRealtimeSegmentDataManager.java`
#### Snippet
```java

              // Sleep for a short time as to avoid filling the logs with exceptions too quickly
              Uninterruptibles.sleepUninterruptibly(exceptionSleepMillis, TimeUnit.MILLISECONDS);
              exceptionSleepMillis = Math.min(60000L, exceptionSleepMillis * 2);
              continue;
```

### UnstableApiUsage
'sleepUninterruptibly(long, java.util.concurrent.TimeUnit)' is declared in unstable class 'com.google.common.util.concurrent.Uninterruptibles' marked with @Beta
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/HLRealtimeSegmentDataManager.java`
#### Snippet
```java

              // Sleep for a short time as to avoid filling the logs with exceptions too quickly
              Uninterruptibles.sleepUninterruptibly(exceptionSleepMillis, TimeUnit.MILLISECONDS);
              exceptionSleepMillis = Math.min(60000L, exceptionSleepMillis * 2);
              continue;
```

### UnstableApiUsage
'com.google.common.util.concurrent.Uninterruptibles' is marked unstable with @Beta
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/HLRealtimeSegmentDataManager.java`
#### Snippet
```java

                // Sleep for a short time as to avoid filling the logs with exceptions too quickly
                Uninterruptibles.sleepUninterruptibly(exceptionSleepMillis, TimeUnit.MILLISECONDS);
                exceptionSleepMillis = Math.min(60000L, exceptionSleepMillis * 2);
              }
```

### UnstableApiUsage
'sleepUninterruptibly(long, java.util.concurrent.TimeUnit)' is declared in unstable class 'com.google.common.util.concurrent.Uninterruptibles' marked with @Beta
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/HLRealtimeSegmentDataManager.java`
#### Snippet
```java

                // Sleep for a short time as to avoid filling the logs with exceptions too quickly
                Uninterruptibles.sleepUninterruptibly(exceptionSleepMillis, TimeUnit.MILLISECONDS);
                exceptionSleepMillis = Math.min(60000L, exceptionSleepMillis * 2);
              }
```

### UnstableApiUsage
'com.google.common.util.concurrent.Uninterruptibles' is marked unstable with @Beta
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/LLRealtimeSegmentDataManager.java`
#### Snippet
```java
        break;
      }
      Uninterruptibles.sleepUninterruptibly(10, TimeUnit.SECONDS);
      _segmentLogger.info("Retrying after response {}", response.toJsonString());
    } while (!_shouldStop);
```

### UnstableApiUsage
'sleepUninterruptibly(long, java.util.concurrent.TimeUnit)' is declared in unstable class 'com.google.common.util.concurrent.Uninterruptibles' marked with @Beta
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/LLRealtimeSegmentDataManager.java`
#### Snippet
```java
        break;
      }
      Uninterruptibles.sleepUninterruptibly(10, TimeUnit.SECONDS);
      _segmentLogger.info("Retrying after response {}", response.toJsonString());
    } while (!_shouldStop);
```

### UnstableApiUsage
'com.google.common.util.concurrent.Uninterruptibles' is marked unstable with @Beta
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/LLRealtimeSegmentDataManager.java`
#### Snippet
```java
      _segmentLogger
          .warn("Stream transient exception when fetching messages, retrying (count={})", _consecutiveErrorCount, e);
      Uninterruptibles.sleepUninterruptibly(1, TimeUnit.SECONDS);
      recreateStreamConsumer("Too many transient errors");
    }
```

### UnstableApiUsage
'sleepUninterruptibly(long, java.util.concurrent.TimeUnit)' is declared in unstable class 'com.google.common.util.concurrent.Uninterruptibles' marked with @Beta
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/LLRealtimeSegmentDataManager.java`
#### Snippet
```java
      _segmentLogger
          .warn("Stream transient exception when fetching messages, retrying (count={})", _consecutiveErrorCount, e);
      Uninterruptibles.sleepUninterruptibly(1, TimeUnit.SECONDS);
      recreateStreamConsumer("Too many transient errors");
    }
```

### UnstableApiUsage
'com.google.common.util.concurrent.Uninterruptibles' is marked unstable with @Beta
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/LLRealtimeSegmentDataManager.java`
#### Snippet
```java
      }
      // If there were no messages to be fetched from stream, wait for a little bit as to avoid hammering the stream
      Uninterruptibles.sleepUninterruptibly(idlePipeSleepTimeMillis, TimeUnit.MILLISECONDS);
    }
    return prematureExit;
```

### UnstableApiUsage
'sleepUninterruptibly(long, java.util.concurrent.TimeUnit)' is declared in unstable class 'com.google.common.util.concurrent.Uninterruptibles' marked with @Beta
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/LLRealtimeSegmentDataManager.java`
#### Snippet
```java
      }
      // If there were no messages to be fetched from stream, wait for a little bit as to avoid hammering the stream
      Uninterruptibles.sleepUninterruptibly(idlePipeSleepTimeMillis, TimeUnit.MILLISECONDS);
    }
    return prematureExit;
```

### UnstableApiUsage
'com.google.common.util.concurrent.Uninterruptibles' is marked unstable with @Beta
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/LLRealtimeSegmentDataManager.java`
#### Snippet
```java
    // one. In the latter case, we don't want to call join.
    if (Thread.currentThread() != _consumerThread) {
      Uninterruptibles.joinUninterruptibly(_consumerThread, 10, TimeUnit.MINUTES);

      if (_consumerThread.isAlive()) {
```

### UnstableApiUsage
'joinUninterruptibly(java.lang.Thread, long, java.util.concurrent.TimeUnit)' is declared in unstable class 'com.google.common.util.concurrent.Uninterruptibles' marked with @Beta
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/LLRealtimeSegmentDataManager.java`
#### Snippet
```java
    // one. In the latter case, we don't want to call join.
    if (Thread.currentThread() != _consumerThread) {
      Uninterruptibles.joinUninterruptibly(_consumerThread, 10, TimeUnit.MINUTES);

      if (_consumerThread.isAlive()) {
```

### UnstableApiUsage
'setFuture(com.google.common.util.concurrent.ListenableFuture)' is marked unstable with @Beta
in `pinot-core/src/main/java/org/apache/pinot/core/query/scheduler/SchedulerQueryContext.java`
#### Snippet
```java

  public void setResultFuture(ListenableFuture<byte[]> f) {
    _resultFuture.setFuture(f);
  }

```

### UnstableApiUsage
'com.google.common.net.InternetDomainName' is marked unstable with @Beta
in `pinot-core/src/main/java/org/apache/pinot/core/transport/ServerRoutingInstance.java`
#### Snippet
```java
    String shortHostname = SHORT_HOSTNAME_MAP.computeIfAbsent(_hostname, hostname -> {
      try {
        InternetDomainName domainName = InternetDomainName.from(hostname);
        return domainName.parts().get(0);
      } catch (Exception e) {
```

### UnstableApiUsage
'com.google.common.net.InternetDomainName' is marked unstable with @Beta
in `pinot-core/src/main/java/org/apache/pinot/core/transport/ServerRoutingInstance.java`
#### Snippet
```java
    String shortHostname = SHORT_HOSTNAME_MAP.computeIfAbsent(_hostname, hostname -> {
      try {
        InternetDomainName domainName = InternetDomainName.from(hostname);
        return domainName.parts().get(0);
      } catch (Exception e) {
```

### UnstableApiUsage
'from(java.lang.String)' is declared in unstable class 'com.google.common.net.InternetDomainName' marked with @Beta
in `pinot-core/src/main/java/org/apache/pinot/core/transport/ServerRoutingInstance.java`
#### Snippet
```java
    String shortHostname = SHORT_HOSTNAME_MAP.computeIfAbsent(_hostname, hostname -> {
      try {
        InternetDomainName domainName = InternetDomainName.from(hostname);
        return domainName.parts().get(0);
      } catch (Exception e) {
```

### UnstableApiUsage
'parts()' is declared in unstable class 'com.google.common.net.InternetDomainName' marked with @Beta
in `pinot-core/src/main/java/org/apache/pinot/core/transport/ServerRoutingInstance.java`
#### Snippet
```java
      try {
        InternetDomainName domainName = InternetDomainName.from(hostname);
        return domainName.parts().get(0);
      } catch (Exception e) {
        return hostname;
```

### UnstableApiUsage
'com.google.common.util.concurrent.Futures' is marked unstable with @Beta
in `pinot-core/src/main/java/org/apache/pinot/core/transport/InstanceRequestHandler.java`
#### Snippet
```java
      _queryFuturesById.put(queryId, future);
    }
    Futures.addCallback(future,
        createCallback(ctx, tableNameWithType, queryArrivalTimeMs, instanceRequest, queryRequest),
        MoreExecutors.directExecutor());
```

### UnstableApiUsage
'addCallback(com.google.common.util.concurrent.ListenableFuture, com.google.common.util.concurrent.FutureCallback, java.util.concurrent.Executor)' is declared in unstable class 'com.google.common.util.concurrent.Futures' marked with @Beta
in `pinot-core/src/main/java/org/apache/pinot/core/transport/InstanceRequestHandler.java`
#### Snippet
```java
      _queryFuturesById.put(queryId, future);
    }
    Futures.addCallback(future,
        createCallback(ctx, tableNameWithType, queryArrivalTimeMs, instanceRequest, queryRequest),
        MoreExecutors.directExecutor());
```

### UnstableApiUsage
'com.google.common.util.concurrent.Uninterruptibles' is marked unstable with @Beta
in `pinot-plugins/pinot-stream-ingestion/pinot-pulsar/src/main/java/org/apache/pinot/plugin/stream/pulsar/PulsarStreamLevelConsumerManager.java`
#### Snippet
```java
          try {
            // Await the shutdown time
            Uninterruptibles.sleepUninterruptibly(CONSUMER_SHUTDOWN_DELAY_MILLIS, TimeUnit.MILLISECONDS);

            // Shutdown all consumers that have not been re-acquired
```

### UnstableApiUsage
'sleepUninterruptibly(long, java.util.concurrent.TimeUnit)' is declared in unstable class 'com.google.common.util.concurrent.Uninterruptibles' marked with @Beta
in `pinot-plugins/pinot-stream-ingestion/pinot-pulsar/src/main/java/org/apache/pinot/plugin/stream/pulsar/PulsarStreamLevelConsumerManager.java`
#### Snippet
```java
          try {
            // Await the shutdown time
            Uninterruptibles.sleepUninterruptibly(CONSUMER_SHUTDOWN_DELAY_MILLIS, TimeUnit.MILLISECONDS);

            // Shutdown all consumers that have not been re-acquired
```

### UnstableApiUsage
'com.google.common.util.concurrent.Uninterruptibles' is marked unstable with @Beta
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/minion/PinotHelixTaskResourceManager.java`
#### Snippet
```java
    // Wait until task queue context shows up
    while (_taskDriver.getWorkflowContext(helixJobQueueName) == null) {
      Uninterruptibles.sleepUninterruptibly(100, TimeUnit.MILLISECONDS);
    }
  }
```

### UnstableApiUsage
'sleepUninterruptibly(long, java.util.concurrent.TimeUnit)' is declared in unstable class 'com.google.common.util.concurrent.Uninterruptibles' marked with @Beta
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/minion/PinotHelixTaskResourceManager.java`
#### Snippet
```java
    // Wait until task queue context shows up
    while (_taskDriver.getWorkflowContext(helixJobQueueName) == null) {
      Uninterruptibles.sleepUninterruptibly(100, TimeUnit.MILLISECONDS);
    }
  }
```

### UnstableApiUsage
'com.google.common.util.concurrent.Uninterruptibles' is marked unstable with @Beta
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/minion/PinotHelixTaskResourceManager.java`
#### Snippet
```java
    // Wait until task state is available
    while (getTaskState(parentTaskName) == null) {
      Uninterruptibles.sleepUninterruptibly(100, TimeUnit.MILLISECONDS);
    }

```

### UnstableApiUsage
'sleepUninterruptibly(long, java.util.concurrent.TimeUnit)' is declared in unstable class 'com.google.common.util.concurrent.Uninterruptibles' marked with @Beta
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/minion/PinotHelixTaskResourceManager.java`
#### Snippet
```java
    // Wait until task state is available
    while (getTaskState(parentTaskName) == null) {
      Uninterruptibles.sleepUninterruptibly(100, TimeUnit.MILLISECONDS);
    }

```

### UnstableApiUsage
'com.google.common.io.Files' is marked unstable with @Beta
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/rules/impl/SegmentSizeRule.java`
#### Snippet
```java

      // generate a segment
      File workingDir = Files.createTempDir();
      try {
        TableConfig tableConfig = createTableConfig(_input.getSchema());
```

### UnstableApiUsage
'createTempDir()' is declared in unstable class 'com.google.common.io.Files' marked with @Beta
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/rules/impl/SegmentSizeRule.java`
#### Snippet
```java

      // generate a segment
      File workingDir = Files.createTempDir();
      try {
        TableConfig tableConfig = createTableConfig(_input.getSchema());
```

### UnstableApiUsage
'com.google.common.io.Files' is marked unstable with @Beta
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/rules/impl/RealtimeProvisioningRule.java`
#### Snippet
```java
    int[] numHours = _params.getNumHours();

    File workingDir = Files.createTempDir();
    MemoryEstimator memoryEstimator =
        new MemoryEstimator(tableConfig, _input.getSchema(), _input.getSchemaWithMetadata(),
```

### UnstableApiUsage
'createTempDir()' is declared in unstable class 'com.google.common.io.Files' marked with @Beta
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/rules/impl/RealtimeProvisioningRule.java`
#### Snippet
```java
    int[] numHours = _params.getNumHours();

    File workingDir = Files.createTempDir();
    MemoryEstimator memoryEstimator =
        new MemoryEstimator(tableConfig, _input.getSchema(), _input.getSchemaWithMetadata(),
```

### UnstableApiUsage
'com.google.common.io.Files' is marked unstable with @Beta
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/RealtimeProvisioningHelperCommand.java`
#### Snippet
```java
    long maxUsableHostMemBytes = DataSizeUtils.toBytes(_maxUsableHostMemory);

    File workingDir = Files.createTempDir();
    MemoryEstimator memoryEstimator;
    if (segmentProvided) {
```

### UnstableApiUsage
'createTempDir()' is declared in unstable class 'com.google.common.io.Files' marked with @Beta
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/RealtimeProvisioningHelperCommand.java`
#### Snippet
```java
    long maxUsableHostMemBytes = DataSizeUtils.toBytes(_maxUsableHostMemory);

    File workingDir = Files.createTempDir();
    MemoryEstimator memoryEstimator;
    if (segmentProvided) {
```

### UnstableApiUsage
'com.google.common.util.concurrent.Uninterruptibles' is marked unstable with @Beta
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StreamAvroIntoKafkaCommand.java`
#### Snippet
```java
        // Sleep between messages
        if (sleepRequired) {
          Uninterruptibles.sleepUninterruptibly(messageDelayMillis, TimeUnit.MILLISECONDS);
        }
      }
```

### UnstableApiUsage
'sleepUninterruptibly(long, java.util.concurrent.TimeUnit)' is declared in unstable class 'com.google.common.util.concurrent.Uninterruptibles' marked with @Beta
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StreamAvroIntoKafkaCommand.java`
#### Snippet
```java
        // Sleep between messages
        if (sleepRequired) {
          Uninterruptibles.sleepUninterruptibly(messageDelayMillis, TimeUnit.MILLISECONDS);
        }
      }
```

### UnstableApiUsage
'com.google.common.util.concurrent.RateLimiter' is marked unstable with @Beta
in `pinot-tools/src/main/java/org/apache/pinot/tools/streams/PinotRealtimeSource.java`
#### Snippet
```java
   */
  private static class GuavaRateLimiter implements PinotStreamRateLimiter {
    private final RateLimiter _rateLimiter;
    public GuavaRateLimiter(long maxQps) {
      _rateLimiter = RateLimiter.create(maxQps);
```

### UnstableApiUsage
'acquire()' is declared in unstable class 'com.google.common.util.concurrent.RateLimiter' marked with @Beta
in `pinot-tools/src/main/java/org/apache/pinot/tools/streams/PinotRealtimeSource.java`
#### Snippet
```java
    @Override
    public void acquire(int permits) {
      _rateLimiter.acquire();
    }
  }
```

### UnstableApiUsage
'com.google.common.util.concurrent.RateLimiter' is marked unstable with @Beta
in `pinot-tools/src/main/java/org/apache/pinot/tools/streams/PinotRealtimeSource.java`
#### Snippet
```java
    private final RateLimiter _rateLimiter;
    public GuavaRateLimiter(long maxQps) {
      _rateLimiter = RateLimiter.create(maxQps);
    }
    @Override
```

### UnstableApiUsage
'create(double)' is declared in unstable class 'com.google.common.util.concurrent.RateLimiter' marked with @Beta
in `pinot-tools/src/main/java/org/apache/pinot/tools/streams/PinotRealtimeSource.java`
#### Snippet
```java
    private final RateLimiter _rateLimiter;
    public GuavaRateLimiter(long maxQps) {
      _rateLimiter = RateLimiter.create(maxQps);
    }
    @Override
```

### UnstableApiUsage
'com.google.common.util.concurrent.RateLimiter' is marked unstable with @Beta
in `pinot-broker/src/main/java/org/apache/pinot/broker/queryquota/QueryQuotaEntity.java`
#### Snippet
```java
public class QueryQuotaEntity {

  private RateLimiter _rateLimiter;
  private HitCounter _qpsTracker;
  private MaxHitRateTracker _maxQpsTracker;
```

### UnstableApiUsage
'com.google.common.util.concurrent.RateLimiter' is marked unstable with @Beta
in `pinot-broker/src/main/java/org/apache/pinot/broker/queryquota/QueryQuotaEntity.java`
#### Snippet
```java
  }

  public void setRateLimiter(RateLimiter rateLimiter) {
    _rateLimiter = rateLimiter;
  }
```

### UnstableApiUsage
'com.google.common.util.concurrent.RateLimiter' is marked unstable with @Beta
in `pinot-broker/src/main/java/org/apache/pinot/broker/queryquota/QueryQuotaEntity.java`
#### Snippet
```java
  private int _tableConfigStatVersion;

  public QueryQuotaEntity(RateLimiter rateLimiter, HitCounter qpsTracker, MaxHitRateTracker maxQpsTracker,
      int numOnlineBrokers, double overallRate, int tableConfigStatVersion) {
    _rateLimiter = rateLimiter;
```

### UnstableApiUsage
'com.google.common.util.concurrent.RateLimiter' is marked unstable with @Beta
in `pinot-broker/src/main/java/org/apache/pinot/broker/queryquota/QueryQuotaEntity.java`
#### Snippet
```java
  }

  public RateLimiter getRateLimiter() {
    return _rateLimiter;
  }
```

### UnstableApiUsage
'com.google.common.util.concurrent.RateLimiter' is marked unstable with @Beta
in `pinot-broker/src/main/java/org/apache/pinot/broker/queryquota/HelixExternalViewBasedQueryQuotaManager.java`
#### Snippet
```java
    queryQuotaEntity.getMaxQpsTracker().hit();

    RateLimiter rateLimiter = queryQuotaEntity.getRateLimiter();
    // Return true if no rate limiter is initialized.
    if (rateLimiter == null) {
```

### UnstableApiUsage
'getRate()' is declared in unstable class 'com.google.common.util.concurrent.RateLimiter' marked with @Beta
in `pinot-broker/src/main/java/org/apache/pinot/broker/queryquota/HelixExternalViewBasedQueryQuotaManager.java`
#### Snippet
```java
      return true;
    }
    double perBrokerRate = rateLimiter.getRate();

    // Emit the qps capacity utilization rate.
```

### UnstableApiUsage
'tryAcquire()' is declared in unstable class 'com.google.common.util.concurrent.RateLimiter' marked with @Beta
in `pinot-broker/src/main/java/org/apache/pinot/broker/queryquota/HelixExternalViewBasedQueryQuotaManager.java`
#### Snippet
```java
    }

    if (!rateLimiter.tryAcquire()) {
      LOGGER.info("Quota is exceeded for table: {}. Per-broker rate: {}. Current qps: {}", tableNameWithType,
          perBrokerRate, numHits);
```

### UnstableApiUsage
'getRate()' is declared in unstable class 'com.google.common.util.concurrent.RateLimiter' marked with @Beta
in `pinot-broker/src/main/java/org/apache/pinot/broker/queryquota/HelixExternalViewBasedQueryQuotaManager.java`
#### Snippet
```java
      }
      double latestRate = overallRate / onlineBrokerCount;
      double previousRate = queryQuotaEntity.getRateLimiter().getRate();
      if (Math.abs(latestRate - previousRate) > 0.001) {
        queryQuotaEntity.getRateLimiter().setRate(latestRate);
```

### UnstableApiUsage
'setRate(double)' is declared in unstable class 'com.google.common.util.concurrent.RateLimiter' marked with @Beta
in `pinot-broker/src/main/java/org/apache/pinot/broker/queryquota/HelixExternalViewBasedQueryQuotaManager.java`
#### Snippet
```java
      double previousRate = queryQuotaEntity.getRateLimiter().getRate();
      if (Math.abs(latestRate - previousRate) > 0.001) {
        queryQuotaEntity.getRateLimiter().setRate(latestRate);
        queryQuotaEntity.setNumOnlineBrokers(onlineBrokerCount);
        queryQuotaEntity.setOverallRate(overallRate);
```

### UnstableApiUsage
'com.google.common.util.concurrent.RateLimiter' is marked unstable with @Beta
in `pinot-broker/src/main/java/org/apache/pinot/broker/queryquota/HelixExternalViewBasedQueryQuotaManager.java`
#### Snippet
```java
    if (queryQuotaEntity == null) {
      queryQuotaEntity =
          new QueryQuotaEntity(RateLimiter.create(perBrokerRate), new HitCounter(ONE_SECOND_TIME_RANGE_IN_SECOND),
              new MaxHitRateTracker(ONE_MINUTE_TIME_RANGE_IN_SECOND), onlineCount, overallRate, stat.getVersion());
      _rateLimiterMap.put(tableNameWithType, queryQuotaEntity);
```

### UnstableApiUsage
'create(double)' is declared in unstable class 'com.google.common.util.concurrent.RateLimiter' marked with @Beta
in `pinot-broker/src/main/java/org/apache/pinot/broker/queryquota/HelixExternalViewBasedQueryQuotaManager.java`
#### Snippet
```java
    if (queryQuotaEntity == null) {
      queryQuotaEntity =
          new QueryQuotaEntity(RateLimiter.create(perBrokerRate), new HitCounter(ONE_SECOND_TIME_RANGE_IN_SECOND),
              new MaxHitRateTracker(ONE_MINUTE_TIME_RANGE_IN_SECOND), onlineCount, overallRate, stat.getVersion());
      _rateLimiterMap.put(tableNameWithType, queryQuotaEntity);
```

### UnstableApiUsage
'com.google.common.util.concurrent.RateLimiter' is marked unstable with @Beta
in `pinot-broker/src/main/java/org/apache/pinot/broker/queryquota/HelixExternalViewBasedQueryQuotaManager.java`
#### Snippet
```java
          onlineCount, stat.getVersion());
    } else {
      RateLimiter rateLimiter = queryQuotaEntity.getRateLimiter();
      double previousRate = -1;
      if (rateLimiter == null) {
```

### UnstableApiUsage
'com.google.common.util.concurrent.RateLimiter' is marked unstable with @Beta
in `pinot-broker/src/main/java/org/apache/pinot/broker/queryquota/HelixExternalViewBasedQueryQuotaManager.java`
#### Snippet
```java
      if (rateLimiter == null) {
        // Query quota is just added to the table.
        rateLimiter = RateLimiter.create(perBrokerRate);
        queryQuotaEntity.setRateLimiter(rateLimiter);
      } else {
```

### UnstableApiUsage
'create(double)' is declared in unstable class 'com.google.common.util.concurrent.RateLimiter' marked with @Beta
in `pinot-broker/src/main/java/org/apache/pinot/broker/queryquota/HelixExternalViewBasedQueryQuotaManager.java`
#### Snippet
```java
      if (rateLimiter == null) {
        // Query quota is just added to the table.
        rateLimiter = RateLimiter.create(perBrokerRate);
        queryQuotaEntity.setRateLimiter(rateLimiter);
      } else {
```

### UnstableApiUsage
'getRate()' is declared in unstable class 'com.google.common.util.concurrent.RateLimiter' marked with @Beta
in `pinot-broker/src/main/java/org/apache/pinot/broker/queryquota/HelixExternalViewBasedQueryQuotaManager.java`
#### Snippet
```java
      } else {
        // Query quota gets updated to a new value.
        previousRate = rateLimiter.getRate();
        rateLimiter.setRate(perBrokerRate);
      }
```

### UnstableApiUsage
'setRate(double)' is declared in unstable class 'com.google.common.util.concurrent.RateLimiter' marked with @Beta
in `pinot-broker/src/main/java/org/apache/pinot/broker/queryquota/HelixExternalViewBasedQueryQuotaManager.java`
#### Snippet
```java
        // Query quota gets updated to a new value.
        previousRate = rateLimiter.getRate();
        rateLimiter.setRate(perBrokerRate);
      }
      queryQuotaEntity.setNumOnlineBrokers(onlineCount);
```

### UnstableApiUsage
'stopAsync()' is declared in unstable class 'com.google.common.util.concurrent.AbstractExecutionThreadService' marked with @Beta
in `pinot-query-runtime/src/main/java/org/apache/pinot/query/runtime/QueryRunner.java`
#### Snippet
```java
    _serverExecutor.shutDown();
    _mailboxService.shutdown();
    _scheduler.stopAsync().awaitTerminated(30, TimeUnit.SECONDS);
  }

```

### UnstableApiUsage
'awaitTerminated(long, java.util.concurrent.TimeUnit)' is declared in unstable interface 'com.google.common.util.concurrent.Service' marked with @Beta
in `pinot-query-runtime/src/main/java/org/apache/pinot/query/runtime/QueryRunner.java`
#### Snippet
```java
    _serverExecutor.shutDown();
    _mailboxService.shutdown();
    _scheduler.stopAsync().awaitTerminated(30, TimeUnit.SECONDS);
  }

```

### UnstableApiUsage
'startAsync()' is declared in unstable class 'com.google.common.util.concurrent.AbstractExecutionThreadService' marked with @Beta
in `pinot-query-runtime/src/main/java/org/apache/pinot/query/runtime/QueryRunner.java`
#### Snippet
```java
    _mailboxService.start();
    _serverExecutor.start();
    _scheduler.startAsync().awaitRunning(30, TimeUnit.SECONDS);
  }

```

### UnstableApiUsage
'awaitRunning(long, java.util.concurrent.TimeUnit)' is declared in unstable interface 'com.google.common.util.concurrent.Service' marked with @Beta
in `pinot-query-runtime/src/main/java/org/apache/pinot/query/runtime/QueryRunner.java`
#### Snippet
```java
    _mailboxService.start();
    _serverExecutor.start();
    _scheduler.startAsync().awaitRunning(30, TimeUnit.SECONDS);
  }

```

### UnstableApiUsage
'com.google.common.io.Resources' is marked unstable with @Beta
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkGeospatialSerde.java`
#### Snippet
```java
    public static String readResource(String resource) {
      try {
        return Resources.toString(Resources.getResource(resource), UTF_8);
      } catch (IOException e) {
        throw new UncheckedIOException(e);
```

### UnstableApiUsage
'toString(java.net.URL, java.nio.charset.Charset)' is declared in unstable class 'com.google.common.io.Resources' marked with @Beta
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkGeospatialSerde.java`
#### Snippet
```java
    public static String readResource(String resource) {
      try {
        return Resources.toString(Resources.getResource(resource), UTF_8);
      } catch (IOException e) {
        throw new UncheckedIOException(e);
```

### UnstableApiUsage
'com.google.common.io.Resources' is marked unstable with @Beta
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkGeospatialSerde.java`
#### Snippet
```java
    public static String readResource(String resource) {
      try {
        return Resources.toString(Resources.getResource(resource), UTF_8);
      } catch (IOException e) {
        throw new UncheckedIOException(e);
```

### UnstableApiUsage
'getResource(java.lang.String)' is declared in unstable class 'com.google.common.io.Resources' marked with @Beta
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkGeospatialSerde.java`
#### Snippet
```java
    public static String readResource(String resource) {
      try {
        return Resources.toString(Resources.getResource(resource), UTF_8);
      } catch (IOException e) {
        throw new UncheckedIOException(e);
```

### UnstableApiUsage
'com.google.common.hash.BloomFilter' is marked unstable with @Beta
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkBloomFilter.java`
#### Snippet
```java

    double fpp = Math.max(0.01d, GuavaBloomFilterReaderUtils.computeFPP(_maxSizeInBytes, _cardinality));
    BloomFilter<CharSequence> bloomFilter = BloomFilter.create(
        Funnels.stringFunnel(StandardCharsets.UTF_8), _cardinality, fpp);
    words.forEach(bloomFilter::put);
```

### UnstableApiUsage
'com.google.common.hash.BloomFilter' is marked unstable with @Beta
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkBloomFilter.java`
#### Snippet
```java

    double fpp = Math.max(0.01d, GuavaBloomFilterReaderUtils.computeFPP(_maxSizeInBytes, _cardinality));
    BloomFilter<CharSequence> bloomFilter = BloomFilter.create(
        Funnels.stringFunnel(StandardCharsets.UTF_8), _cardinality, fpp);
    words.forEach(bloomFilter::put);
```

### UnstableApiUsage
'create(com.google.common.hash.Funnel, int, double)' is declared in unstable class 'com.google.common.hash.BloomFilter' marked with @Beta
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkBloomFilter.java`
#### Snippet
```java

    double fpp = Math.max(0.01d, GuavaBloomFilterReaderUtils.computeFPP(_maxSizeInBytes, _cardinality));
    BloomFilter<CharSequence> bloomFilter = BloomFilter.create(
        Funnels.stringFunnel(StandardCharsets.UTF_8), _cardinality, fpp);
    words.forEach(bloomFilter::put);
```

### UnstableApiUsage
'com.google.common.hash.Funnels' is marked unstable with @Beta
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkBloomFilter.java`
#### Snippet
```java
    double fpp = Math.max(0.01d, GuavaBloomFilterReaderUtils.computeFPP(_maxSizeInBytes, _cardinality));
    BloomFilter<CharSequence> bloomFilter = BloomFilter.create(
        Funnels.stringFunnel(StandardCharsets.UTF_8), _cardinality, fpp);
    words.forEach(bloomFilter::put);

```

### UnstableApiUsage
'stringFunnel(java.nio.charset.Charset)' is declared in unstable class 'com.google.common.hash.Funnels' marked with @Beta
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkBloomFilter.java`
#### Snippet
```java
    double fpp = Math.max(0.01d, GuavaBloomFilterReaderUtils.computeFPP(_maxSizeInBytes, _cardinality));
    BloomFilter<CharSequence> bloomFilter = BloomFilter.create(
        Funnels.stringFunnel(StandardCharsets.UTF_8), _cardinality, fpp);
    words.forEach(bloomFilter::put);

```

### UnstableApiUsage
'put(T)' is declared in unstable class 'com.google.common.hash.BloomFilter' marked with @Beta
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkBloomFilter.java`
#### Snippet
```java
    BloomFilter<CharSequence> bloomFilter = BloomFilter.create(
        Funnels.stringFunnel(StandardCharsets.UTF_8), _cardinality, fpp);
    words.forEach(bloomFilter::put);

    _actualReader = loadReader(bloomFilter);
```

### UnstableApiUsage
'com.google.common.hash.BloomFilter' is marked unstable with @Beta
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkBloomFilter.java`
#### Snippet
```java
  public static final String OFF_HEAP = "offHeap";

  private BaseGuavaBloomFilterReader loadReader(BloomFilter<CharSequence> bloomFilter)
      throws IOException {

```

### UnstableApiUsage
'writeTo(java.io.OutputStream)' is declared in unstable class 'com.google.common.hash.BloomFilter' marked with @Beta
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkBloomFilter.java`
#### Snippet
```java
    file.deleteOnExit();
    try (FileOutputStream fos = new FileOutputStream(file)) {
      bloomFilter.writeTo(fos);
    }

```

### UnstableApiUsage
'com.google.common.util.concurrent.Uninterruptibles' is marked unstable with @Beta
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkQueryEngine.java`
#### Snippet
```java
    while (true) {
      System.out.println("record = " + record);
      Uninterruptibles.sleepUninterruptibly(10, TimeUnit.SECONDS);

      int onlineSegmentCount = 0;
```

### UnstableApiUsage
'sleepUninterruptibly(long, java.util.concurrent.TimeUnit)' is declared in unstable class 'com.google.common.util.concurrent.Uninterruptibles' marked with @Beta
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkQueryEngine.java`
#### Snippet
```java
    while (true) {
      System.out.println("record = " + record);
      Uninterruptibles.sleepUninterruptibly(10, TimeUnit.SECONDS);

      int onlineSegmentCount = 0;
```

### UnstableApiUsage
'com.google.common.hash.Hashing' is marked unstable with @Beta
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/HashUtils.java`
#### Snippet
```java

  public static byte[] hashMD5(byte[] bytes) {
    return Hashing.md5().hashBytes(bytes).asBytes();
  }

```

### UnstableApiUsage
'md5()' is declared in unstable class 'com.google.common.hash.Hashing' marked with @Beta
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/HashUtils.java`
#### Snippet
```java

  public static byte[] hashMD5(byte[] bytes) {
    return Hashing.md5().hashBytes(bytes).asBytes();
  }

```

### UnstableApiUsage
'hashBytes(byte\[\])' is declared in unstable interface 'com.google.common.hash.HashFunction' marked with @Beta
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/HashUtils.java`
#### Snippet
```java

  public static byte[] hashMD5(byte[] bytes) {
    return Hashing.md5().hashBytes(bytes).asBytes();
  }

```

### UnstableApiUsage
'asBytes()' is declared in unstable class 'com.google.common.hash.HashCode' marked with @Beta
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/HashUtils.java`
#### Snippet
```java

  public static byte[] hashMD5(byte[] bytes) {
    return Hashing.md5().hashBytes(bytes).asBytes();
  }

```

### UnstableApiUsage
'com.google.common.hash.Hashing' is marked unstable with @Beta
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/HashUtils.java`
#### Snippet
```java

  public static byte[] hashMurmur3(byte[] bytes) {
    return Hashing.murmur3_128().hashBytes(bytes).asBytes();
  }

```

### UnstableApiUsage
'murmur3_128()' is declared in unstable class 'com.google.common.hash.Hashing' marked with @Beta
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/HashUtils.java`
#### Snippet
```java

  public static byte[] hashMurmur3(byte[] bytes) {
    return Hashing.murmur3_128().hashBytes(bytes).asBytes();
  }

```

### UnstableApiUsage
'hashBytes(byte\[\])' is declared in unstable interface 'com.google.common.hash.HashFunction' marked with @Beta
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/HashUtils.java`
#### Snippet
```java

  public static byte[] hashMurmur3(byte[] bytes) {
    return Hashing.murmur3_128().hashBytes(bytes).asBytes();
  }

```

### UnstableApiUsage
'asBytes()' is declared in unstable class 'com.google.common.hash.HashCode' marked with @Beta
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/HashUtils.java`
#### Snippet
```java

  public static byte[] hashMurmur3(byte[] bytes) {
    return Hashing.murmur3_128().hashBytes(bytes).asBytes();
  }

```

### UnstableApiUsage
'splitToList(java.lang.CharSequence)' is marked unstable with @Beta
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/function/GroovyFunctionEvaluator.java`
#### Snippet
```java
    String arguments = matcher.group(ARGUMENTS_GROUP_NAME);
    if (arguments != null) {
      _arguments = Splitter.on(ARGUMENTS_SEPARATOR).trimResults().splitToList(arguments);
    } else {
      _arguments = Collections.emptyList();
```

### UnstableApiUsage
'com.google.common.base.Ticker' is marked unstable with @Beta
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/customobject/QuantileDigest.java`
#### Snippet
```java

  @VisibleForTesting
  QuantileDigest(double maxError, double alpha, Ticker ticker, boolean compressAutomatically) {
    checkArgument(maxError >= 0 && maxError <= 1, "maxError must be in range [0, 1]");
    checkArgument(alpha >= 0 && alpha < 1, "alpha must be in range [0, 1)");
```

### UnstableApiUsage
'read()' is declared in unstable class 'com.google.common.base.Ticker' marked with @Beta
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/customobject/QuantileDigest.java`
#### Snippet
```java
    _compressAutomatically = compressAutomatically;

    _landmarkInSeconds = TimeUnit.NANOSECONDS.toSeconds(ticker.read());
  }

```

### UnstableApiUsage
'com.google.common.base.Ticker' is marked unstable with @Beta
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/customobject/QuantileDigest.java`
#### Snippet
```java

  private final double _maxError;
  private final Ticker _ticker;
  private final double _alpha;
  private final boolean _compressAutomatically;
```

### UnstableApiUsage
'com.google.common.base.Ticker' is marked unstable with @Beta
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/customobject/QuantileDigest.java`
#### Snippet
```java
   */
  public QuantileDigest(double maxError, double alpha) {
    this(maxError, alpha, Ticker.systemTicker(), true);
  }

```

### UnstableApiUsage
'systemTicker()' is declared in unstable class 'com.google.common.base.Ticker' marked with @Beta
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/customobject/QuantileDigest.java`
#### Snippet
```java
   */
  public QuantileDigest(double maxError, double alpha) {
    this(maxError, alpha, Ticker.systemTicker(), true);
  }

```

### UnstableApiUsage
'read()' is declared in unstable class 'com.google.common.base.Ticker' marked with @Beta
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/customobject/QuantileDigest.java`
#### Snippet
```java

  private void rescaleToCommonLandmark(QuantileDigest one, QuantileDigest two) {
    long nowInSeconds = TimeUnit.NANOSECONDS.toSeconds(_ticker.read());

    // 1. rescale this and other to common landmark
```

### UnstableApiUsage
'read()' is declared in unstable class 'com.google.common.base.Ticker' marked with @Beta
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/customobject/QuantileDigest.java`
#### Snippet
```java
    final AtomicDouble bucketWeightedSum = new AtomicDouble();

    final double normalizationFactor = weight(TimeUnit.NANOSECONDS.toSeconds(_ticker.read()));

    postOrderTraversal(_root, new Callback() {
```

### UnstableApiUsage
'read()' is declared in unstable class 'com.google.common.base.Ticker' marked with @Beta
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/customobject/QuantileDigest.java`
#### Snippet
```java
   */
  public double getCount() {
    return _weightedCount / weight(TimeUnit.NANOSECONDS.toSeconds(_ticker.read()));
  }

```

### UnstableApiUsage
'read()' is declared in unstable class 'com.google.common.base.Ticker' marked with @Beta
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/customobject/QuantileDigest.java`
#### Snippet
```java
    checkArgument(count > 0, "count must be > 0");

    long nowInSeconds = TimeUnit.NANOSECONDS.toSeconds(_ticker.read());

    int maxExpectedNodeCount = 3 * calculateCompressionFactor();
```

### UnstableApiUsage
'read()' is declared in unstable class 'com.google.common.base.Ticker' marked with @Beta
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/customobject/QuantileDigest.java`
#### Snippet
```java
    }

    double weight = weight(TimeUnit.NANOSECONDS.toSeconds(_ticker.read())) * count;

    _max = Math.max(_max, value);
```

## RuleId[id=StringEquality]
### StringEquality
String values are compared using `!=`, not 'equals()'
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/rebalance/ZkBasedTableRebalanceObserver.java`
#### Snippet
```java
  @Override
  public void onSuccess(String msg) {
    Preconditions.checkState(_tableRebalanceProgressStats.getStatus() != RebalanceResult.Status.DONE.toString(),
        "Table Rebalance already completed");
    long timeToFinishInSeconds =
```

### StringEquality
String values are compared using `!=`, not 'equals()'
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/rebalance/ZkBasedTableRebalanceObserver.java`
#### Snippet
```java
  private void updateOnStart(Map<String, Map<String, String>> currentState,
      Map<String, Map<String, String>> targetState) {
    Preconditions.checkState(_tableRebalanceProgressStats.getStatus() != RebalanceResult.Status.IN_PROGRESS.toString(),
        "Rebalance Observer onStart called multiple times");
    _tableRebalanceProgressStats.setStatus(RebalanceResult.Status.IN_PROGRESS.toString());
```

## RuleId[id=ConditionalBreakInInfiniteLoop]
### ConditionalBreakInInfiniteLoop
Conditional break inside loop
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/GeometrySerializer.java`
#### Snippet
```java
  private static Geometry readGeometryCollection(ByteBuffer byteBuffer, GeometryFactory factory) {
    List<Geometry> geometries = new ArrayList<>();
    while (true) {
      if (!byteBuffer.hasRemaining()) {
        break;
```

## RuleId[id=LoopStatementsThatDontLoop]
### LoopStatementsThatDontLoop
`while` statement does not loop
in `pinot-core/src/main/java/org/apache/pinot/core/query/scheduler/MultiLevelPriorityQueue.java`
#### Snippet
```java
    _queueLock.lock();
    try {
      while (true) {
        SchedulerQueryContext schedulerQueryContext;
        while ((schedulerQueryContext = takeNextInternal()) == null) {
```

## RuleId[id=ManualArrayCopy]
### ManualArrayCopy
Manual array copy
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/realtime/impl/RealtimeSegmentStatsHistory.java`
#### Snippet
```java
    _entries = new SegmentStats[_maxNumEntries];

    for (int i = 0; i < toCopy; i++) {
      _entries[i] = tmp[i];
    }
```

## RuleId[id=AssertWithSideEffects]
### AssertWithSideEffects
`assert` has side effects: call to 'setPrevious()' mutates field '_previous'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/builder/FSTBuilder.java`
#### Snippet
```java
        : "Input must be sorted: " + Arrays.toString(Arrays.copyOf(_previous, _previousLength)) + " >= "
            + Arrays.toString(Arrays.copyOfRange(sequence, start, len));
    assert setPrevious(sequence, start, len);

    // Determine common prefix length.
```

### AssertWithSideEffects
`assert` has side effects: call to 'setPrevious()' mutates field '_previous'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/automaton/StringUnionOperations.java`
#### Snippet
```java
        _previous == null || LEXICOGRAPHIC_ORDER.compare(_previous, current) <= 0
        : "Input must be sorted: " + _previous + " >= " + current;
    assert setPrevious(current);

    // Descend in the automaton (find matching prefix).
```

## RuleId[id=RefusedBequest]
### RefusedBequest
Method `clone()` does not call 'super.clone()'
in `pinot-spi/src/main/java/org/apache/pinot/spi/data/Schema.java`
#### Snippet
```java
  }

  public Schema clone() {
    Schema cloned = new SchemaBuilder()
        .setSchemaName(getSchemaName())
```

### RefusedBequest
Method `clone()` does not call 'super.clone()'
in `pinot-spi/src/main/java/org/apache/pinot/spi/env/PinotConfiguration.java`
#### Snippet
```java
   *  @return a new {@link PinotConfiguration} instance with a cloned {@link CompositeConfiguration}.
   */
  public PinotConfiguration clone() {
    return new PinotConfiguration(_configuration);
  }
```

### RefusedBequest
Method `clone()` does not call 'super.clone()'
in `pinot-spi/src/main/java/org/apache/pinot/spi/utils/FixedIntArray.java`
#### Snippet
```java
  }

  public FixedIntArray clone() {
    return new FixedIntArray(Arrays.copyOf(_value, _value.length));
  }
```

## RuleId[id=RedundantArrayCreation]
### RedundantArrayCreation
Redundant array creation for calling varargs method
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/ZookeeperResource.java`
#### Snippet
```java

    MAPPER.enable(SerializationFeature.INDENT_OUTPUT);
    MAPPER.enable(new MapperFeature[]{MapperFeature.AUTO_DETECT_FIELDS});
    MAPPER.enable(new MapperFeature[]{MapperFeature.CAN_OVERRIDE_ACCESS_MODIFIERS});
    MAPPER.enable(new MapperFeature[]{MapperFeature.AUTO_DETECT_SETTERS});
```

### RedundantArrayCreation
Redundant array creation for calling varargs method
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/ZookeeperResource.java`
#### Snippet
```java
    MAPPER.enable(SerializationFeature.INDENT_OUTPUT);
    MAPPER.enable(new MapperFeature[]{MapperFeature.AUTO_DETECT_FIELDS});
    MAPPER.enable(new MapperFeature[]{MapperFeature.CAN_OVERRIDE_ACCESS_MODIFIERS});
    MAPPER.enable(new MapperFeature[]{MapperFeature.AUTO_DETECT_SETTERS});
    MAPPER.enable(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES);
```

### RedundantArrayCreation
Redundant array creation for calling varargs method
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/ZookeeperResource.java`
#### Snippet
```java
    MAPPER.enable(new MapperFeature[]{MapperFeature.AUTO_DETECT_FIELDS});
    MAPPER.enable(new MapperFeature[]{MapperFeature.CAN_OVERRIDE_ACCESS_MODIFIERS});
    MAPPER.enable(new MapperFeature[]{MapperFeature.AUTO_DETECT_SETTERS});
    MAPPER.enable(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES);
  }
```

## RuleId[id=DuplicateBranchesInSwitch]
### DuplicateBranchesInSwitch
Branch in 'switch' is a duplicate of the default branch
in `pinot-common/src/main/java/org/apache/pinot/common/datatable/DataTableUtils.java`
#### Snippet
```java
          break;
        case LONG:
          rowSizeInBytes += 8;
          break;
        case FLOAT:
```

### DuplicateBranchesInSwitch
Branch in 'switch' is a duplicate of the default branch
in `pinot-common/src/main/java/org/apache/pinot/common/datatable/DataTableUtils.java`
#### Snippet
```java
          break;
        case DOUBLE:
          rowSizeInBytes += 8;
          break;
        case STRING:
```

### DuplicateBranchesInSwitch
Duplicate branch in 'switch'
in `pinot-common/src/main/java/org/apache/pinot/common/datatable/DataTableUtils.java`
#### Snippet
```java
          break;
        case STRING:
          rowSizeInBytes += 4;
          break;
        // Object and array. (POSITION|LENGTH)
```

### DuplicateBranchesInSwitch
Branch in 'switch' is a duplicate of the default branch
in `pinot-common/src/main/java/org/apache/pinot/common/datablock/DataBlockUtils.java`
#### Snippet
```java
          break;
        case LONG:
          rowSizeInBytes += 8;
          break;
        case FLOAT:
```

### DuplicateBranchesInSwitch
Duplicate branch in 'switch'
in `pinot-common/src/main/java/org/apache/pinot/common/datablock/DataBlockUtils.java`
#### Snippet
```java
          break;
        case FLOAT:
          rowSizeInBytes += 4;
          break;
        case DOUBLE:
```

### DuplicateBranchesInSwitch
Branch in 'switch' is a duplicate of the default branch
in `pinot-common/src/main/java/org/apache/pinot/common/datablock/DataBlockUtils.java`
#### Snippet
```java
          break;
        case DOUBLE:
          rowSizeInBytes += 8;
          break;
        case STRING:
```

### DuplicateBranchesInSwitch
Duplicate branch in 'switch'
in `pinot-common/src/main/java/org/apache/pinot/common/datablock/DataBlockUtils.java`
#### Snippet
```java
          break;
        case STRING:
          rowSizeInBytes += 4;
          break;
        // Object and array. (POSITION|LENGTH)
```

### DuplicateBranchesInSwitch
Branch in 'switch' is a duplicate of the default branch
in `pinot-common/src/main/java/org/apache/pinot/common/datablock/DataBlockUtils.java`
#### Snippet
```java
          break;
        case LONG:
          columnSizes[i] = 8;
          break;
        case FLOAT:
```

### DuplicateBranchesInSwitch
Duplicate branch in 'switch'
in `pinot-common/src/main/java/org/apache/pinot/common/datablock/DataBlockUtils.java`
#### Snippet
```java
          break;
        case FLOAT:
          columnSizes[i] = 4;
          break;
        case DOUBLE:
```

### DuplicateBranchesInSwitch
Branch in 'switch' is a duplicate of the default branch
in `pinot-common/src/main/java/org/apache/pinot/common/datablock/DataBlockUtils.java`
#### Snippet
```java
          break;
        case DOUBLE:
          columnSizes[i] = 8;
          break;
        case STRING:
```

### DuplicateBranchesInSwitch
Duplicate branch in 'switch'
in `pinot-common/src/main/java/org/apache/pinot/common/datablock/DataBlockUtils.java`
#### Snippet
```java
          break;
        case STRING:
          columnSizes[i] = 4;
          break;
        // Object and array. (POSITION|LENGTH)
```

### DuplicateBranchesInSwitch
Branch in 'switch' is a duplicate of the default branch
in `pinot-core/src/main/java/org/apache/pinot/core/query/optimizer/statement/JsonStatementOptimizer.java`
#### Snippet
```java
        return DataSchema.ColumnDataType.DOUBLE;
      case STRING_VALUE:
        return DataSchema.ColumnDataType.STRING;
      case BYTE_VALUE:
      case BINARY_VALUE:
```

### DuplicateBranchesInSwitch
Duplicate branch in 'switch'
in `pinot-clients/pinot-jdbc-client/src/main/java/org/apache/pinot/client/utils/DriverUtils.java`
#### Snippet
```java
        break;
      case "LONG":
        columnsSQLDataType = Types.INTEGER;
        break;
      case "FLOAT":
```

### DuplicateBranchesInSwitch
Branch in 'switch' is a duplicate of the default branch
in `pinot-clients/pinot-jdbc-client/src/main/java/org/apache/pinot/client/utils/DriverUtils.java`
#### Snippet
```java
    switch (columnDataType) {
      case "STRING":
        columnsJavaClassName = String.class.getTypeName();
        break;
      case "INT":
```

### DuplicateBranchesInSwitch
Branch in 'switch' is a duplicate of the default branch
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/realtime/SegmentCompletionManager.java`
#### Snippet
```java
          case HOLDING:
          case COMMITTER_DECIDED:
            return fail(instanceId, offset);
          case COMMITTER_NOTIFIED:
            return committerNotifiedExtendBuildTime(instanceId, offset, extTimeSec, now);
```

## RuleId[id=RegExpSimplifiable]
### RegExpSimplifiable
`[ ]` can be simplified to ' '
in `pinot-spi/src/main/java/org/apache/pinot/spi/data/DateTimeFormatPatternSpec.java`
#### Snippet
```java

  /** eg: yyyyMMdd tz(CST) or yyyyMMdd HH tz(GMT+0700) or yyyyMMddHH tz(America/Chicago) **/
  private static final Pattern SDF_PATTERN_WITH_TIMEZONE = Pattern.compile("^(.+)( tz[ ]*\\((.+)\\))[ ]*");
  private static final int SDF_PATTERN_GROUP = 1;
  private static final int TIME_ZONE_GROUP = 3;
```

### RegExpSimplifiable
`[ ]` can be simplified to ' '
in `pinot-spi/src/main/java/org/apache/pinot/spi/data/DateTimeFormatPatternSpec.java`
#### Snippet
```java

  /** eg: yyyyMMdd tz(CST) or yyyyMMdd HH tz(GMT+0700) or yyyyMMddHH tz(America/Chicago) **/
  private static final Pattern SDF_PATTERN_WITH_TIMEZONE = Pattern.compile("^(.+)( tz[ ]*\\((.+)\\))[ ]*");
  private static final int SDF_PATTERN_GROUP = 1;
  private static final int TIME_ZONE_GROUP = 3;
```

### RegExpSimplifiable
`[\\t]` can be simplified to '\\t'
in `pinot-common/src/main/java/org/apache/pinot/common/exception/QueryException.java`
#### Snippet
```java
   * The 2 regexp below must conform with JDK's internal implementation in {@link Throwable#printStackTrace()}.
   */
  private static final Pattern CAUSE_CAPTION_REGEXP = Pattern.compile("^([\\t]*)Caused by: ");
  private static final Pattern SUPPRESSED_CAPTION_REGEXP = Pattern.compile("^([\\t]*)Suppressed: ");

```

### RegExpSimplifiable
`[\\t]` can be simplified to '\\t'
in `pinot-common/src/main/java/org/apache/pinot/common/exception/QueryException.java`
#### Snippet
```java
   */
  private static final Pattern CAUSE_CAPTION_REGEXP = Pattern.compile("^([\\t]*)Caused by: ");
  private static final Pattern SUPPRESSED_CAPTION_REGEXP = Pattern.compile("^([\\t]*)Suppressed: ");

  private static final String OMITTED_SIGNAL = "...";
```

### RegExpSimplifiable
`[/]` can be simplified to '/'
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/creator/name/InputFileSegmentNameGenerator.java`
#### Snippet
```java
  private String safeConvertPathToFilename(String inputFilePath) {
    // Strip of leading '/' characters
    inputFilePath = inputFilePath.replaceFirst("^[/]+", "");
    // Try to create a valid filename by removing any '/' or '.' chars with '_'
    return inputFilePath.replaceAll("[/\\.]", "_");
```

## RuleId[id=DuplicateExpressions]
### DuplicateExpressions
Multiple occurrences of `Paths.get(file)`
in `pinot-plugins/pinot-minion-tasks/pinot-minion-builtin-tasks/src/main/java/org/apache/pinot/plugin/minion/tasks/segmentgenerationandpush/SegmentGenerationAndPushTaskGenerator.java`
#### Snippet
```java
        LOGGER.debug("Processing file: {}", file);
        if (includeFilePathMatcher != null) {
          if (!includeFilePathMatcher.matches(Paths.get(file))) {
            LOGGER.debug("Exclude file {} as it's not matching includeFilePathMatcher: {}",
                file, includeFileNamePattern);
```

### DuplicateExpressions
Multiple occurrences of `Paths.get(file)`
in `pinot-plugins/pinot-minion-tasks/pinot-minion-builtin-tasks/src/main/java/org/apache/pinot/plugin/minion/tasks/segmentgenerationandpush/SegmentGenerationAndPushTaskGenerator.java`
#### Snippet
```java
        }
        if (excludeFilePathMatcher != null) {
          if (excludeFilePathMatcher.matches(Paths.get(file))) {
            LOGGER.debug("Exclude file {} as it's matching excludeFilePathMatcher: {}", file, excludeFileNamePattern);
            continue;
```

### DuplicateExpressions
Multiple occurrences of `Paths.get(file)`
in `pinot-common/src/main/java/org/apache/pinot/common/segment/generation/SegmentGenerationUtils.java`
#### Snippet
```java
    for (String file : files) {
      if (includeFilePathMatcher != null) {
        if (!includeFilePathMatcher.matches(Paths.get(file))) {
          continue;
        }
```

### DuplicateExpressions
Multiple occurrences of `Paths.get(file)`
in `pinot-common/src/main/java/org/apache/pinot/common/segment/generation/SegmentGenerationUtils.java`
#### Snippet
```java
      }
      if (excludeFilePathMatcher != null) {
        if (excludeFilePathMatcher.matches(Paths.get(file))) {
          continue;
        }
```

## RuleId[id=StringBufferReplaceableByString]
### StringBufferReplaceableByString
`StringBuilder stringBuilder` can be replaced with 'String'
in `pinot-common/src/main/java/org/apache/pinot/common/datablock/BaseDataBlock.java`
#### Snippet
```java
      return _metadata.toString();
    } else {
      StringBuilder stringBuilder = new StringBuilder();
      stringBuilder.append("resultSchema:").append('\n');
      stringBuilder.append(_dataSchema).append('\n');
```

### StringBufferReplaceableByString
`StringBuilder stringBuilder` can be replaced with 'String'
in `pinot-common/src/main/java/org/apache/pinot/common/datatable/BaseDataTable.java`
#### Snippet
```java
      return _metadata.toString();
    } else {
      StringBuilder stringBuilder = new StringBuilder();
      stringBuilder.append("resultSchema:").append('\n');
      stringBuilder.append(_dataSchema).append('\n');
```

### StringBufferReplaceableByString
`StringBuilder stringBuilder` can be replaced with 'String'
in `pinot-common/src/main/java/org/apache/pinot/common/datatable/DataTableImplV4.java`
#### Snippet
```java
      return _metadata.toString();
    } else {
      StringBuilder stringBuilder = new StringBuilder();
      stringBuilder.append("resultSchema:").append('\n');
      stringBuilder.append(_dataSchema).append('\n');
```

### StringBufferReplaceableByString
`StringBuilder stringBuilder` can be replaced with 'String'
in `pinot-core/src/main/java/org/apache/pinot/core/operator/filter/TextContainsFilterOperator.java`
#### Snippet
```java
  @Override
  public String toExplainString() {
    StringBuilder stringBuilder = new StringBuilder(EXPLAIN_NAME).append("(indexLookUp:text_index");
    stringBuilder.append(",operator:").append(_predicate.getType());
    stringBuilder.append(",predicate:").append(_predicate.toString());
```

### StringBufferReplaceableByString
`StringBuilder stringBuilder` can be replaced with 'String'
in `pinot-core/src/main/java/org/apache/pinot/core/operator/filter/TextMatchFilterOperator.java`
#### Snippet
```java
  @Override
  public String toExplainString() {
    StringBuilder stringBuilder = new StringBuilder(EXPLAIN_NAME).append("(indexLookUp:text_index");
    stringBuilder.append(",operator:").append(_predicate.getType());
    stringBuilder.append(",predicate:").append(_predicate.toString());
```

### StringBufferReplaceableByString
`StringBuilder stringBuilder` can be replaced with 'String'
in `pinot-core/src/main/java/org/apache/pinot/core/operator/filter/JsonMatchFilterOperator.java`
#### Snippet
```java
  @Override
  public String toExplainString() {
    StringBuilder stringBuilder = new StringBuilder(EXPLAIN_NAME).append("(indexLookUp:json_index");
    stringBuilder.append(",operator:").append(_predicate.getType());
    stringBuilder.append(",predicate:").append(_predicate.toString());
```

### StringBufferReplaceableByString
`StringBuilder` can be replaced with 'String'
in `pinot-core/src/main/java/org/apache/pinot/core/operator/filter/MatchAllFilterOperator.java`
#### Snippet
```java
  @Override
  public String toExplainString() {
    return new StringBuilder(EXPLAIN_NAME).append("(docs:").append(_numDocs).append(')').toString();
  }

```

### StringBufferReplaceableByString
`StringBuilder stringBuilder` can be replaced with 'String'
in `pinot-core/src/main/java/org/apache/pinot/core/operator/filter/H3InclusionIndexFilterOperator.java`
#### Snippet
```java
  @Override
  public String toExplainString() {
    StringBuilder stringBuilder = new StringBuilder(EXPLAIN_NAME).append("(inclusionIndex:h3_index");
    stringBuilder.append(",operator:").append(_predicate.getType());
    stringBuilder.append(",predicate:").append(_predicate.toString());
```

### StringBufferReplaceableByString
`StringBuilder stringBuilder` can be replaced with 'String'
in `pinot-core/src/main/java/org/apache/pinot/core/operator/filter/SortedIndexBasedFilterOperator.java`
#### Snippet
```java
  @Override
  public String toExplainString() {
    StringBuilder stringBuilder = new StringBuilder(EXPLAIN_NAME).append("(indexLookUp:sorted_index");
    stringBuilder.append(",operator:").append(_predicateEvaluator.getPredicateType());
    stringBuilder.append(",predicate:").append(_predicateEvaluator.getPredicate().toString());
```

### StringBufferReplaceableByString
`StringBuilder stringBuilder` can be replaced with 'String'
in `pinot-core/src/main/java/org/apache/pinot/core/operator/filter/H3IndexFilterOperator.java`
#### Snippet
```java
  @Override
  public String toExplainString() {
    StringBuilder stringBuilder = new StringBuilder(EXPLAIN_NAME).append("(indexLookUp:h3_index");
    stringBuilder.append(",operator:").append(_predicate.getType());
    stringBuilder.append(",predicate:").append(_predicate.toString());
```

### StringBufferReplaceableByString
`StringBuilder builder` can be replaced with 'String'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/RealtimeProvisioningHelperCommand.java`
#### Snippet
```java
  @Override
  public void printExamples() {
    StringBuilder builder = new StringBuilder();
    builder.append("\n\nThis command allows you to estimate the capacity needed for provisioning realtime hosts. ")
        .append("It assumes that there is no upper limit to the amount of memory you can mmap").append(
```

### StringBufferReplaceableByString
`StringBuilder usage` can be replaced with 'String'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AnonymizeDataCommand.java`
#### Snippet
```java
  @Override
  public void printExamples() {
    StringBuilder usage = new StringBuilder();

    usage.append("\n*******Usage Notes******").append(
```

## RuleId[id=UnnecessaryReturn]
### UnnecessaryReturn
`return` is unnecessary as the last statement in a 'void' method
in `pinot-spi/src/main/java/org/apache/pinot/spi/utils/JsonUtils.java`
#### Snippet
```java
    if (jsonNode.isNull()) {
      // do nothing
      return;
    } else if (jsonNode.isValueNode()) {
      DataType dataType = valueOf(jsonNode);
```

### UnnecessaryReturn
`return` is unnecessary as the last statement in a 'void' method
in `pinot-spi/src/main/java/org/apache/pinot/spi/plugin/PluginManager.java`
#### Snippet
```java
      LOGGER.info("Env variable '{}' is not specified. Set this env variable to load additional plugins.",
          PLUGINS_DIR_PROPERTY_NAME);
      return;
    } else {
      try {
```

## RuleId[id=ManualMinMaxCalculation]
### ManualMinMaxCalculation
Can be replaced with 'Math.min()' call
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/data/generator/RangeIntGenerator.java`
#### Snippet
```java

  public RangeIntGenerator(int r1, int r2) {
    _start = (r1 < r2) ? r1 : r2;
    _end = (r1 > r2) ? r1 : r2;

```

### ManualMinMaxCalculation
Can be replaced with 'Math.max()' call
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/data/generator/RangeIntGenerator.java`
#### Snippet
```java
  public RangeIntGenerator(int r1, int r2) {
    _start = (r1 < r2) ? r1 : r2;
    _end = (r1 > r2) ? r1 : r2;

    _delta = _end - _start;
```

### ManualMinMaxCalculation
Can be replaced with 'Math.min()' call
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/data/generator/RangeLongGenerator.java`
#### Snippet
```java

  public RangeLongGenerator(long r1, long r2) {
    _start = (r1 < r2) ? r1 : r2;
    _end = (r1 > r2) ? r1 : r2;

```

### ManualMinMaxCalculation
Can be replaced with 'Math.max()' call
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/data/generator/RangeLongGenerator.java`
#### Snippet
```java
  public RangeLongGenerator(long r1, long r2) {
    _start = (r1 < r2) ? r1 : r2;
    _end = (r1 > r2) ? r1 : r2;

    _delta = _end - _start;
```

### ManualMinMaxCalculation
Can be replaced with 'Math.min()' call
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/data/generator/RangeFloatGenerator.java`
#### Snippet
```java

  public RangeFloatGenerator(float r1, float r2) {
    _start = (r1 < r2) ? r1 : r2;
    _end = (r1 > r2) ? r1 : r2;

```

### ManualMinMaxCalculation
Can be replaced with 'Math.max()' call
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/data/generator/RangeFloatGenerator.java`
#### Snippet
```java
  public RangeFloatGenerator(float r1, float r2) {
    _start = (r1 < r2) ? r1 : r2;
    _end = (r1 > r2) ? r1 : r2;

    _delta = _end - _start;
```

### ManualMinMaxCalculation
Can be replaced with 'Math.min()' call
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/data/generator/RangeDoubleGenerator.java`
#### Snippet
```java

  public RangeDoubleGenerator(double r1, double r2) {
    _start = (r1 < r2) ? r1 : r2;
    _end = (r1 > r2) ? r1 : r2;

```

### ManualMinMaxCalculation
Can be replaced with 'Math.max()' call
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/data/generator/RangeDoubleGenerator.java`
#### Snippet
```java
  public RangeDoubleGenerator(double r1, double r2) {
    _start = (r1 < r2) ? r1 : r2;
    _end = (r1 > r2) ? r1 : r2;

    _delta = _end - _start;
```

## RuleId[id=SimplifiableConditionalExpression]
### SimplifiableConditionalExpression
`value == null ? false : Boolean.parseBoolean(value)` can be simplified to 'value!=null \&\& Boolean.parseBoolean(value)'
in `pinot-clients/pinot-jdbc-client/src/main/java/org/apache/pinot/client/PinotResultSet.java`
#### Snippet
```java
    validateColumn(columnIndex);
    String value = getString(columnIndex);
    return value == null ? false : Boolean.parseBoolean(value);
  }

```

### SimplifiableConditionalExpression
`StateType.ENABLE.name().equalsIgnoreCase(stateStr) ? true : false` can be simplified to 'StateType.ENABLE.name().equalsIgnoreCase(stateStr)'
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotTenantRestletResource.java`
#### Snippet
```java
    }

    boolean enable = StateType.ENABLE.name().equalsIgnoreCase(stateStr) ? true : false;
    for (String instance : allInstances) {
      if (enable) {
```

### SimplifiableConditionalExpression
`StateType.ENABLE.name().equalsIgnoreCase(state) ? true : false` can be simplified to 'StateType.ENABLE.name().equalsIgnoreCase(state)'
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotTenantRestletResource.java`
#### Snippet
```java
    }

    boolean enable = StateType.ENABLE.name().equalsIgnoreCase(state) ? true : false;
    ObjectNode instanceResult = JsonUtils.newObjectNode();
    String instance = null;
```

## RuleId[id=JavadocLinkAsPlainText]
### JavadocLinkAsPlainText
Link specified as plain text
in `pinot-spi/src/main/java/org/apache/pinot/spi/data/TimeFieldSpec.java`
#### Snippet
```java
 * This should only be used in 1) tests 2) wherever required for backward compatible handling of schemas with
 * TimeFieldSpec
 * https://github.com/apache/pinot/issues/2756
 */
@JsonIgnoreProperties(ignoreUnknown = true)
```

### JavadocLinkAsPlainText
Link specified as plain text
in `pinot-spi/src/main/java/org/apache/pinot/spi/ingestion/batch/spec/PinotClusterSpec.java`
#### Snippet
```java
  /**
   * Controller URI is used to fetch table/schema information and data push.
   * E.g. http://localhost:9000
   */
  private String _controllerURI;
```

### JavadocLinkAsPlainText
Link specified as plain text
in `pinot-spi/src/main/java/org/apache/pinot/spi/ingestion/batch/spec/PinotClusterSpec.java`
#### Snippet
```java
  /**
   * Controller URI is used to fetch table/schema information and data push.
   * E.g. http://localhost:9000
   *
   * @param controllerURI
```

### JavadocLinkAsPlainText
Link specified as plain text
in `pinot-spi/src/main/java/org/apache/pinot/spi/ingestion/batch/spec/TableSpec.java`
#### Snippet
```java
   * Supports using PinotFS or HTTP.
   * E.g. hdfs://path/to/table_config.json
   *      http://localhost:9000/tables/myTable
   * Note that the API to read Pinot table config directly from pinot controller contains a JSON wrapper.
   * The real table config is the object under the field 'OFFLINE'.
```

### JavadocLinkAsPlainText
Link specified as plain text
in `pinot-spi/src/main/java/org/apache/pinot/spi/ingestion/batch/spec/TableSpec.java`
#### Snippet
```java
   * Supports using PinotFS or HTTP.
   * E.g. hdfs://path/to/table_schema.json
   *      http://localhost:9000/tables/myTable/schema
   */
  String _schemaURI;
```

### JavadocLinkAsPlainText
Link specified as plain text
in `pinot-spi/src/main/java/org/apache/pinot/spi/utils/CommonConstants.java`
#### Snippet
```java
       *                   4. HYBRID: Picks the best server by computing a custom hybrid score based on both latency
       *                   and # inflight requests. This is based on the approach described in the paper
       *                   https://www.usenix.org/system/files/conference/nsdi15/nsdi15-paper-suresh.pdf. Requires Stats
       *                   Collection to be enabled.
       */
```

### JavadocLinkAsPlainText
Link specified as plain text
in `pinot-common/src/main/java/org/apache/pinot/common/utils/ExponentialMovingAverage.java`
#### Snippet
```java
/**
 * The {@code ExponentialMovingAverage} is the implementation of the utility Exponential Weighted Moving Average
 * which is a statistical measure used to model time series data. Refer https://en.wikipedia.org/wiki/Moving_average
 * for more details.
 */
```

### JavadocLinkAsPlainText
Link specified as plain text
in `pinot-common/src/main/java/org/apache/pinot/common/utils/TlsUtils.java`
#### Snippet
```java

  /**
   * Adapted from: https://svn.apache.org/viewvc/httpcomponents/oac
   * .hc3x/trunk/src/contrib/org/apache/commons/httpclient/contrib/ssl/AuthSSLProtocolSocketFactory.java?view=markup
   */
```

### JavadocLinkAsPlainText
Link specified as plain text
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * Returns a map from a given tableType to a list of segments for that given tableType (OFFLINE or REALTIME)
   * If tableType is left unspecified, both OFFLINE and REALTIME segments will be returned in the map.
   * @param controllerBaseUri the base controller URI, e.g., https://example.com:8000
   * @param rawTableName the raw table name without table type
   * @param tableType the table type (OFFLINE or REALTIME)
```

### JavadocLinkAsPlainText
Link specified as plain text
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * Returns a map from a given tableType to a list of segments for that given tableType (OFFLINE or REALTIME)
   * If tableType is left unspecified, both OFFLINE and REALTIME segments will be returned in the map.
   * @param controllerBaseUri the base controller URI, e.g., https://example.com:8000
   * @param rawTableName the raw table name without table type
   * @param tableType the table type (OFFLINE or REALTIME)
```

### JavadocLinkAsPlainText
Link specified as plain text
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   * Returns a map from a given tableType to a list of segments for that given tableType (OFFLINE or REALTIME)
   * If tableType is left unspecified, both OFFLINE and REALTIME segments will be returned in the map.
   * @param controllerBaseUri the base controller URI, e.g., https://example.com:8000
   * @param rawTableName the raw table name without table type
   * @param tableType the table type (OFFLINE or REALTIME)
```

### JavadocLinkAsPlainText
Link specified as plain text
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java

  /**
   * Extracts base URI from a URI, e.g., http://example.com:8000/a/b -> http://example.com:8000
   * @param fullURI a full URI with
   * @return a URI
```

### JavadocLinkAsPlainText
Link specified as plain text
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java

  /**
   * Extracts base URI from a URI, e.g., http://example.com:8000/a/b -> http://example.com:8000
   * @param fullURI a full URI with
   * @return a URI
```

### JavadocLinkAsPlainText
Link specified as plain text
in `pinot-core/src/main/java/org/apache/pinot/core/api/ServiceAutoDiscoveryFeature.java`
#### Snippet
```java
 * Auto scan and discovery classes annotated with Service tags. This enables the feature similar to Spring's
 * auto-discovery, that if a class is annotated with some tags like @Service, the class will be auto-loaded
 * The code are mostly from https://mkyong.com/webservices/jax-rs/jersey-and-hk2-dependency-injection-auto-scanning/
 * <p>
 * To make a class auto-loaded, what we need to do is to add the below dependency into project:
```

### JavadocLinkAsPlainText
Link specified as plain text
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/VarianceAggregationFunction.java`
#### Snippet
```java
 * The algorithm to compute variance is based on "Updating Formulae and a Pairwise Algorithm for Computing
 * Sample Variances" by Chan et al. Please refer to the "Parallel Algorithm" section from the following wiki:
 * - https://en.wikipedia.org/wiki/Algorithms_for_calculating_variance#Parallel_algorithm
 */
public class VarianceAggregationFunction extends BaseSingleInputAggregationFunction<VarianceTuple, Double> {
```

### JavadocLinkAsPlainText
Link specified as plain text
in `pinot-core/src/main/java/org/apache/pinot/core/transport/server/routing/stats/ServerRoutingStatsManager.java`
#### Snippet
```java
  /**
   * Returns a list containing each server and the corresponding Hybrid score for each server. The Hybrid score is
   * calculated based on https://www.usenix.org/system/files/conference/nsdi15/nsdi15-paper-suresh.pdf.
   */
  public List<Pair<String, Double>> fetchHybridScoreForAllServers() {
```

### JavadocLinkAsPlainText
Link specified as plain text
in `pinot-core/src/main/java/org/apache/pinot/core/geospatial/transform/function/StDistanceFunction.java`
#### Snippet
```java
   * Calculate the distance between two points on Earth.
   * <p>
   * This assumes a spherical Earth, and uses the Vincenty formula. (https://en.wikipedia
   * .org/wiki/Great-circle_distance)
   */
```

### JavadocLinkAsPlainText
Link specified as plain text
in `pinot-core/src/main/java/org/apache/pinot/core/accounting/PerQueryCPUMemAccountantFactory.java`
#### Snippet
```java
 * Accounting mechanism for thread task execution status and thread resource usage sampling
 * Design and algorithm see
 * https://docs.google.com/document/d/1Z9DYAfKznHQI9Wn8BjTWZYTcNRVGiPP0B8aEP3w_1jQ
 */
public class PerQueryCPUMemAccountantFactory implements ThreadAccountantFactory {
```

### JavadocLinkAsPlainText
Link specified as plain text
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotTenantRestletResource.java`
#### Snippet
```java
 *     "numberOfInstances : "5",
 *     "name" : "brokerOne"
 *   }' http://localhost:1234/tenants
 *
 *   <li>Sample curl call to create server tenant</li>
```

### JavadocLinkAsPlainText
Link specified as plain text
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotTenantRestletResource.java`
#### Snippet
```java
 *     "offlineInstances" : "3",
 *     "realtimeInstances" : "2"
 *   }' http://localhost:1234/tenants
 * </ul>
 */
```

### JavadocLinkAsPlainText
Link specified as plain text
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/realtime/SegmentCompletionManager.java`
#### Snippet
```java
   * segmentConsumed() message every so often (SegmentCompletionProtocol.MAX_HOLD_TIME_MS).
   *
   * See https://github.com/linkedin/pinot/wiki/Low-level-kafka-consumers
   */
  private static class SegmentCompletionFSM {
```

### JavadocLinkAsPlainText
Link specified as plain text
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/assignment/instance/FDAwareInstancePartitionSelector.java`
#### Snippet
```java
 * partition, with each fault-domain mapping 1:1 to a server pool
 * Algorithm details and proof see
 * https://docs.google.com/document/d/1KmJ1DsYXVdzrojj_JYBHRJ2gRMQ5y-o63YqPs7ei7nI/edit#heading=h.nrxxvujq7ael
 */
public class FDAwareInstancePartitionSelector extends InstancePartitionSelector {
```

### JavadocLinkAsPlainText
Link specified as plain text
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/rules/impl/InvertedSortedIndexJointRule.java`
#### Snippet
```java
 * Recommend one sorted index and inverted indices
 * See details in
 * https://cwiki.apache.org/confluence/display/PINOT/Automated+Inverted+Index+Recommendation+for+Pinot
 * #AutomatedInvertedIndexRecommendationforPinot-3.Parser-basedEstimation:
 */
```

### JavadocLinkAsPlainText
Link specified as plain text
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/index/reader/H3IndexResolution.java`
#### Snippet
```java
/**
 * Stores the resolutions for an index. There are in total of H3 resolutions
 * https://h3geo.org/#/documentation/core-library/resolution-table
 * To efficiently serialize the resolutions, we use two bytes for encoding th enabled resolutions. The resolution level
 * maps to the corresponding bit.
```

### JavadocLinkAsPlainText
Link specified as plain text
in `pinot-broker/src/main/java/org/apache/pinot/broker/routing/adaptiveserverselector/HybridSelector.java`
#### Snippet
```java
 * 3. EMA of latencies (C)
 * This selector implementation is based on the ideas suggested in the paper -
 * https://www.usenix.org/system/files/conference/nsdi15/nsdi15-paper-suresh.pdf
 *
 * The Hybrid score for each server is calculated as follows. The server with the lowest Hybrid score is picked.
```

### JavadocLinkAsPlainText
Link specified as plain text
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/GeometryUtils.java`
#### Snippet
```java

  /**
   * Coordinate system of lat/lng per https://epsg.io/4326
   */
  public static final int GEOGRAPHY_SRID = 4326;
```

### JavadocLinkAsPlainText
Link specified as plain text
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/GeometrySerializer.java`
#### Snippet
```java
 * Provides methods to efficiently serialize and deserialize geometry types.
 *
 * This serialization is similar to Presto's https://github
 * .com/prestodb/presto/blob/master/presto-geospatial-toolkit/src/main/java/com/facebook/presto/geospatial/serde
 * /JtsGeometrySerde.java,
```

### JavadocLinkAsPlainText
Link specified as plain text
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/indexsegment/mutable/MutableSegmentImpl.java`
#### Snippet
```java
     * When the realtime segment is converted to offline segment, the offline segment creates a noDict column.
     * MultiValueVarByteRawIndexCreator requires the maxRowLengthInBytes. Refer to OSS issue
     * https://github.com/apache/pinot/issues/10127 for more details.
     */
    void updateVarByteMVMaxRowLengthInBytes(Object entry, DataType dataType) {
```

### JavadocLinkAsPlainText
Link specified as plain text
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/indexsegment/mutable/MutableSegmentImpl.java`
#### Snippet
```java
   *        is used as key for dimensions to record Id map. </li>
   *   <li> None of the metrics are dictionary encoded. </li>
   *   <li> All columns should be single-valued (see https://github.com/apache/pinot/issues/3867)</li>
   * </ul>
   *
```

## RuleId[id=FieldCanBeLocal]
### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-query-planner/src/main/java/org/apache/pinot/query/QueryEnvironment.java`
#### Snippet
```java

  // Calcite extension/plugins
  private final CalciteSchema _rootSchema;
  private final Prepare.CatalogReader _catalogReader;
  private final RelDataTypeFactory _typeFactory;
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-spi/src/main/java/org/apache/pinot/spi/plugin/PluginManager.java`
#### Snippet
```java
  private Map<Plugin, PluginClassLoader> _registry = new HashMap<>();
  private String _pluginsDirectories;
  private String _pluginsInclude;
  private boolean _initialized = false;

```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/BrokerCacheUpdaterPeriodic.java`
#### Snippet
```java
  private final ScheduledExecutorService _scheduledExecutorService;
  private final long _brokerUpdateFreqInMillis;
  private final Properties _properties;

  private static final Logger LOGGER = LoggerFactory.getLogger(BrokerCacheUpdaterPeriodic.class);
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/BrokerCache.java`
#### Snippet
```java
  private final String _address;
  private final Map<String, String> _headers;
  private final Properties _properties;
  private volatile BrokerData _brokerData;

```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-plugins/pinot-stream-ingestion/pinot-kafka-2.0/src/main/java/org/apache/pinot/plugin/stream/kafka20/KafkaPartitionLevelStreamConfig.java`
#### Snippet
```java
  private final String _kafkaIsolationLevel;
  private final boolean _populateMetadata;
  private final Map<String, String> _streamConfigMap;

  /**
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-plugins/pinot-stream-ingestion/pinot-kafka-2.0/src/main/java/org/apache/pinot/plugin/stream/kafka20/KafkaStreamLevelConsumer.java`
#### Snippet
```java

  private KafkaConsumer<Bytes, Bytes> _consumer;
  private ConsumerRecords<Bytes, Bytes> _consumerRecords;
  private Iterator<ConsumerRecord<Bytes, Bytes>> _kafkaIterator;
  private Map<Integer, Long> _consumerOffsets = new HashMap<>(); // tracking current consumed records offsets.
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-plugins/pinot-stream-ingestion/pinot-kafka-2.0/src/main/java/org/apache/pinot/plugin/stream/kafka20/server/KafkaDataServerStartable.java`
#### Snippet
```java
  private int _port;
  private String _zkStr;
  private String _logDirPath;
  private AdminClient _adminClient;

```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-plugins/pinot-stream-ingestion/pinot-kafka-2.0/src/main/java/org/apache/pinot/plugin/stream/kafka20/server/KafkaDataServerStartable.java`
#### Snippet
```java
  private KafkaServer _serverStartable;
  private int _port;
  private String _zkStr;
  private String _logDirPath;
  private AdminClient _adminClient;
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-common/src/main/java/org/apache/pinot/common/utils/BcryptUtils.java`
#### Snippet
```java

    private static final int DEFALUT_LOG_ROUNDS = 10;
    private static String _bcryptPassword = null;

    private BcryptUtils() {
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-common/src/main/java/org/apache/pinot/common/datablock/DataBlock.java`
#### Snippet
```java
    METADATA(2);

    private final int _ordinal;

    Type(int ordinal) {
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/HLRealtimeSegmentDataManager.java`
#### Snippet
```java
  private final ServerMetrics _serverMetrics;
  private final RealtimeTableDataManager _notifier;
  private Thread _indexingThread;

  private final String _sortedColumn;
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/HLRealtimeSegmentDataManager.java`
#### Snippet
```java
  private final String _tableNameWithType;
  private final String _segmentName;
  private final String _timeColumnName;
  private final TimeUnit _timeType;
  private final RecordTransformer _recordTransformer;
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-core/src/main/java/org/apache/pinot/core/query/reduce/GroupByDataTableReducer.java`
#### Snippet
```java
  private final AggregationFunction[] _aggregationFunctions;
  private final int _numAggregationFunctions;
  private final List<ExpressionContext> _groupByExpressions;
  private final int _numGroupByExpressions;
  private final int _numColumns;
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-core/src/main/java/org/apache/pinot/core/query/selection/SelectionOperatorService.java`
#### Snippet
```java
 */
public class SelectionOperatorService {
  private final QueryContext _queryContext;
  private final List<String> _selectionColumns;
  private final DataSchema _dataSchema;
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-core/src/main/java/org/apache/pinot/core/common/datablock/DataBlockBuilder.java`
#### Snippet
```java
  private int[] _columnOffsets;
  private int _rowSizeInBytes;
  private int[] _cumulativeColumnOffsetSizeInBytes;
  private int[] _columnSizeInBytes;

```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-core/src/main/java/org/apache/pinot/core/common/datablock/DataBlockBuilder.java`
#### Snippet
```java
  private final DataSchema.ColumnDataType[] _columnDataTypes;

  private int[] _columnOffsets;
  private int _rowSizeInBytes;
  private int[] _cumulativeColumnOffsetSizeInBytes;
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-core/src/main/java/org/apache/pinot/core/common/datablock/DataBlockBuilder.java`
#### Snippet
```java
public class DataBlockBuilder {
  private final DataSchema _dataSchema;
  private final DataBlock.Type _blockType;
  private final DataSchema.ColumnDataType[] _columnDataTypes;

```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-core/src/main/java/org/apache/pinot/core/operator/blocks/results/DistinctResultsBlock.java`
#### Snippet
```java
 */
public class DistinctResultsBlock extends BaseResultsBlock {
  private final DistinctAggregationFunction _distinctFunction;
  private DistinctTable _distinctTable;

```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-core/src/main/java/org/apache/pinot/core/operator/transform/transformer/datetime/BaseDateTimeTransformer.java`
#### Snippet
```java
  private final DateTimeTransformUnit _outputTimeUnit;
  private final DateTimeFormatter _outputDateTimeFormatter;
  private final DateTimeGranularitySpec _outputGranularity;
  private final long _outputGranularityMillis;
  private final SDFDateTimeTruncate _dateTimeTruncate;
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-plugins/pinot-input-format/pinot-parquet/src/main/java/org/apache/pinot/plugin/inputformat/parquet/ParquetNativeRecordReader.java`
#### Snippet
```java
  private MessageType _schema;
  private ParquetFileReader _parquetFileReader;
  private Group _nextRecord;
  private PageReadStore _pageReadStore;
  private MessageColumnIO _columnIO;
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-core/src/main/java/org/apache/pinot/server/access/ZkBasicAuthAccessFactory.java`
#### Snippet
```java
     */
    private static class BasicAuthAccessControl implements AccessControl {
        private Map<String, ZkBasicAuthPrincipal> _name2principal;
        private AccessControlUserCache _userCache;
        private HelixManager _innerHelixManager;
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-plugins/pinot-stream-ingestion/pinot-pulsar/src/main/java/org/apache/pinot/plugin/stream/pulsar/MessageIdStreamOffsetFactory.java`
#### Snippet
```java
 */
public class MessageIdStreamOffsetFactory implements StreamPartitionMsgOffsetFactory {
  private StreamConfig _streamConfig;

  @Override
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/CallableHttpGet.java`
#### Snippet
```java
  private static final Logger LOGGER = LoggerFactory.getLogger(CallableHttpGet.class);
  private HttpClient _client;
  private GetMethod _getMethod;

  CallableHttpGet(HttpClient client, GetMethod getMethod) {
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/CallableHttpGet.java`
#### Snippet
```java
public class CallableHttpGet {
  private static final Logger LOGGER = LoggerFactory.getLogger(CallableHttpGet.class);
  private HttpClient _client;
  private GetMethod _getMethod;

```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/access/ZkBasicAuthAccessControlFactory.java`
#### Snippet
```java
     */
    private static class BasicAuthAccessControl implements AccessControl {
        private Map<String, ZkBasicAuthPrincipal> _name2principal;
        private final AccessControlUserCache _userCache;

```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/minion/PinotTaskManager.java`
#### Snippet
```java
  private final Map<TaskState, Integer> _taskStateToCountMap = new ConcurrentHashMap<>();

  private final ZkTableConfigChangeListener _zkTableConfigChangeListener = new ZkTableConfigChangeListener();

  private final TaskManagerStatusCache<TaskGeneratorMostRecentRunInfo> _taskManagerStatusCache;
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/assignment/segment/strategy/AllServersSegmentAssignmentStrategy.java`
#### Snippet
```java

  private HelixManager _helixManager;
  private String _offlineTableName;
  private TenantConfig _tenantConfig;

```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/assignment/segment/strategy/BalancedNumSegmentAssignmentStrategy.java`
#### Snippet
```java
  private static final Logger LOGGER = LoggerFactory.getLogger(BalancedNumSegmentAssignmentStrategy.class);

  private String _tableNameWithType;
  private int _replication;

```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/data/generator/RangeIntGenerator.java`
#### Snippet
```java
public class RangeIntGenerator implements Generator {
  private final int _start;
  private final int _end;
  private final int _delta;

```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/data/generator/RangeLongGenerator.java`
#### Snippet
```java
public class RangeLongGenerator implements Generator {
  private final long _start;
  private final long _end;
  private final long _delta;

```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/data/generator/RangeFloatGenerator.java`
#### Snippet
```java
public class RangeFloatGenerator implements Generator {
  private final float _start;
  private final float _end;
  private final float _delta;

```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/data/generator/RangeDoubleGenerator.java`
#### Snippet
```java
public class RangeDoubleGenerator implements Generator {
  private final double _start;
  private final double _end;
  private final double _delta;

```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-server/src/main/java/org/apache/pinot/server/worker/WorkerQueryServer.java`
#### Snippet
```java
  private final int _queryServicePort;
  private final PinotConfiguration _configuration;
  private final HelixManager _helixManager;

  private QueryServer _queryWorkerService;
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-server/src/main/java/org/apache/pinot/server/worker/WorkerQueryServer.java`
#### Snippet
```java
  private final ExecutorService _executor;
  private final int _queryServicePort;
  private final PinotConfiguration _configuration;
  private final HelixManager _helixManager;

```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-server/src/main/java/org/apache/pinot/server/worker/WorkerQueryServer.java`
#### Snippet
```java

  private QueryServer _queryWorkerService;
  private QueryRunner _queryRunner;
  private InstanceDataManager _instanceDataManager;
  private ServerMetrics _serverMetrics;
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-server/src/main/java/org/apache/pinot/server/worker/WorkerQueryServer.java`
#### Snippet
```java
  private QueryRunner _queryRunner;
  private InstanceDataManager _instanceDataManager;
  private ServerMetrics _serverMetrics;

  public WorkerQueryServer(PinotConfiguration configuration, InstanceDataManager instanceDataManager,
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-server/src/main/java/org/apache/pinot/server/worker/WorkerQueryServer.java`
#### Snippet
```java
  private QueryServer _queryWorkerService;
  private QueryRunner _queryRunner;
  private InstanceDataManager _instanceDataManager;
  private ServerMetrics _serverMetrics;

```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-server/src/main/java/org/apache/pinot/server/starter/ServerInstance.java`
#### Snippet
```java
  private final QueryServer _nettyTlsQueryServer;
  private final GrpcQueryServer _grpcQueryServer;
  private final AccessControl _accessControl;
  private final HelixManager _helixManager;

```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/realtime/provisioning/MemoryEstimator.java`
#### Snippet
```java
  private static final String STATS_FILE_COPY_NAME = "stats.copy.ser";

  private final TableConfig _tableConfig;
  private final String _tableNameWithType;
  private final File _sampleCompletedSegment;
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-compatibility-verifier/src/main/java/org/apache/pinot/compat/CompatibilityOpsRunner.java`
#### Snippet
```java
  private static final Logger LOGGER = LoggerFactory.getLogger(CompatibilityOpsRunner.class);

  private String _parentDir;
  private final String _configFileName;
  private int _generationNumber;
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/PinotIdealstateChanger.java`
#### Snippet
```java

  private final String _tableNameWithType;
  private final boolean _dryRun;

  public PinotIdealstateChanger(String zkAddress, String clusterName, String tableNameWithType, boolean dryRun) {
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/SegmentDumpTool.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, usageHelp = true,
      description = "Print this message.")
  private boolean _help = false;

  private void dump()
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/SegmentDumpTool.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-dumpStarTree"})
  private boolean _dumpStarTree = false;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, usageHelp = true,
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/UpdateSegmentState.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, usageHelp = true,
      description = "Print this message.")
  private boolean _help = false;

  public UpdateSegmentState() {
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/BootstrapTableCommand.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-controllerPort"}, required = false, description = "http port for broker.")
  private String _controllerPort = DEFAULT_CONTROLLER_PORT;

  @CommandLine.Option(names = {"-controllerProtocol"}, required = false, description = "protocol for controller.")
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/BootstrapTableCommand.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-controllerProtocol"}, required = false, description = "protocol for controller.")
  private String _controllerProtocol = CommonConstants.HTTP_PROTOCOL;

  @CommandLine.Option(names = {"-dir", "-d", "-directory"}, required = false,
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/BootstrapTableCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;

  private AuthProvider _authProvider;
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/PinotAdministrator.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-version", "-v", "--v", "--version"}, required = false,
      description = "Print the version of Pinot package.")
  private boolean _version = false;

  private int _status = 1;
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/PinotAdministrator.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false,
      description = "Print this message.")
  private boolean _help = false;

  @CommandLine.Option(names = {"-version", "-v", "--v", "--version"}, required = false,
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/PerfBenchmarkDriver.java`
#### Snippet
```java

  // TODO: read from configuration.
  private final int _numReplicas = 1;
  private final String _segmentAssignmentStrategy = "BalanceNumSegmentAssignmentStrategy";
  private final String _brokerTenantName = "DefaultTenant";
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/PerfBenchmarkDriver.java`
#### Snippet
```java
  // TODO: read from configuration.
  private final int _numReplicas = 1;
  private final String _segmentAssignmentStrategy = "BalanceNumSegmentAssignmentStrategy";
  private final String _brokerTenantName = "DefaultTenant";
  private final String _serverTenantName = "DefaultTenant";
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/QuickStartCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false,
      description = "Print this message.")
  private boolean _help = false;

  @Override
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/DeleteTableCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true, description = "Print "
      + "this message.")
  private boolean _help = false;

  private String _controllerAddress;
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartControllerCommand.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, description = "Print this message.")
  private boolean _help = false;

  @CommandLine.Option(names = {"-controllerHost"}, required = false, description = "host name for controller.")
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AddTableCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true, description = "Print "
      + "this message.")
  private boolean _help = false;

  private String _controllerAddress;
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AddTableCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-update"}, required = false,
      description = "Update the existing table instead of creating new one")
  private boolean _update = false;

  @CommandLine.Option(names = {"-exec"}, required = false, description = "Execute the command.")
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ChangeTableState.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;

  private AuthProvider _authProvider;
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/GitHubEventsQuickStartCommand.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, help = true, description = "Print this message.")
  private boolean _help = false;

  public void setPersonalAccessToken(String personalAccessToken) {
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ChangeNumReplicasCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;

  public boolean getHelp() {
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ChangeNumReplicasCommand.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-zkAddress"}, required = false, description = "HTTP address of Zookeeper.")
  private String _zkAddress = DEFAULT_ZK_ADDRESS;

  @CommandLine.Option(names = {"-clusterName"}, required = false, description = "Pinot cluster name.")
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ChangeNumReplicasCommand.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-clusterName"}, required = false, description = "Pinot cluster name.")
  private String _clusterName = "PinotCluster";

  @CommandLine.Option(names = {"-tableName"}, required = true,
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/VerifyClusterStateCommand.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-clusterName"}, required = false, description = "Pinot cluster name.")
  private String _clusterName = "PinotCluster";

  @CommandLine.Option(names = {"-tableName"}, required = false,
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/VerifyClusterStateCommand.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-zkAddress"}, required = false, description = "HTTP address of Zookeeper.")
  private String _zkAddress = DEFAULT_ZK_ADDRESS;

  @CommandLine.Option(names = {"-clusterName"}, required = false, description = "Pinot cluster name.")
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/VerifyClusterStateCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;

  @Override
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/VerifyClusterStateCommand.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-timeoutSec"}, required = false, description = "Maximum timeout in second.")
  private long _timeoutSec = 300L;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/DeleteSchemaCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true, description = "Print "
      + "this message.")
  private boolean _help = false;

  private AuthProvider _authProvider;
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/VerifySegmentState.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;

  public boolean getHelp() {
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/OfflineSegmentIntervalCheckerCommand.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, help = true, description = "Print this message.")
  private boolean _help = false;

  @Override
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ShowClusterInfoCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;

  @Override
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/SegmentProcessorFrameworkCommand.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, help = true, description = "Print this message.")
  private boolean _help = false;

  @Override
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartMinionCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;
  @CommandLine.Option(names = {"-minionHost"}, required = false, description = "Host name for minion.")
  private String _minionHost;
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/RealtimeProvisioningHelperCommand.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, usageHelp = true)
  private boolean _help = false;

  public RealtimeProvisioningHelperCommand setTableConfigFile(String tableConfigFile) {
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/PostQueryCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true, description = "Print "
      + "this message.")
  private boolean _help = false;

  @CommandLine.Option(names = {"-o", "-option"}, required = false, description = "Additional options '-o key=value'")
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/LaunchSparkDataIngestionJobCommand.java`
#### Snippet
```java
  private String[] _unmatchedArgs;

  private AuthProvider _authProvider;

  public String getJobSpecFile() {
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/UploadSegmentCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;

  private AuthProvider _authProvider;
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartZookeeperCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;

  @Override
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartBrokerCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;

  @CommandLine.Option(names = {"-brokerHost"}, required = false, description = "host name for broker.")
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AddSchemaCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;

  private AuthProvider _authProvider;
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StreamAvroIntoKafkaCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;

  @CommandLine.Option(names = {"-kafkaBrokerList"}, required = false, description = "Kafka broker list.")
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StreamAvroIntoKafkaCommand.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-zkAddress"}, required = false, description = "Address of Zookeeper.")
  private String _zkAddress = "localhost:2181";

  @CommandLine.Option(names = {"-outputFormat"}, required = false,
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/OperateClusterConfigCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;

  private AuthProvider _authProvider;
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/GenerateDataCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-format"}, required = false, help = true,
      description = "Output format ('AVRO' or 'CSV').")
  private String _format = FORMAT_AVRO;

  @Override
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/GenerateDataCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;

  @CommandLine.Option(names = {"-format"}, required = false, help = true,
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AddTenantCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;

  private String _controllerAddress;
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/DeleteClusterCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;

  @Override
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartKafkaCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-zkAddress"}, required = false, description = "Address of Zookeeper.")
  private String _zkAddress = KafkaStarterUtils.getDefaultKafkaZKAddress();
  private StreamDataServerStartable _kafkaStarter;

  @Override
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartKafkaCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;

  @CommandLine.Option(names = {"-brokerId"}, required = false, description = "Kafka broker ID.")
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StreamGitHubEventsCommand.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, help = true, description = "Print this message.")
  private boolean _help = false;

  public void setPersonalAccessToken(String personalAccessToken) {
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StreamGitHubEventsCommand.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-awsRegion"}, description = "AWS Region in which Kinesis is located")
  private String _awsRegion = "us-east-1";

  @CommandLine.Option(names = {"-awsAccessKey"}, description = "AccessKey for AWS Account")
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartServerCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;

  @CommandLine.Option(names = {"-serverHost"}, required = false, description = "Host name for server.")
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StopProcessCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Stop the PinotServer.")
  private boolean _help = false;

  public StopProcessCommand() {
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/MoveReplicaGroup.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-maxSegmentsToMove", "-m", "--max"}, required = false,
      description = "MaxSegmentsToMove")
  private int _maxSegmentsToMove = Integer.MAX_VALUE;

  @CommandLine.Option(names = {"-zkHost", "--zk", "-z"}, required = true,
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/MoveReplicaGroup.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, description = "Prints help")
  private boolean _help = false;

  private ZKHelixAdmin _helix;
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/MoveReplicaGroup.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-destHostsFile", "-d", "--dest"}, required = false,
      description = "File with destination servers list")
  private String _destHostsFile = "";

  @CommandLine.Option(names = {"-tableName", "-t", "-table"}, required = true,
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-tools/src/main/java/org/apache/pinot/tools/filesystem/PinotFSBenchmarkRunner.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;

  @Override
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-broker/src/main/java/org/apache/pinot/broker/broker/ZkBasicAuthAccessControlFactory.java`
#### Snippet
```java
     */
    private static class BasicAuthAccessControl implements AccessControl {
        private Map<String, ZkBasicAuthPrincipal> _name2principal;
        private final AccessControlUserCache _userCache;

```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-broker/src/main/java/org/apache/pinot/broker/routing/segmentmetadata/SegmentZkMetadataFetcher.java`
#### Snippet
```java
 */
public class SegmentZkMetadataFetcher {
  private final String _tableNameWithType;
  private final ZkHelixPropertyStore<ZNRecord> _propertyStore;
  private final String _segmentZKMetadataPathPrefix;
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-broker/src/main/java/org/apache/pinot/broker/requesthandler/GrpcBrokerRequestHandler.java`
#### Snippet
```java
  private static final Logger LOGGER = LoggerFactory.getLogger(GrpcBrokerRequestHandler.class);

  private final GrpcConfig _grpcConfig;
  private final StreamingReduceService _streamingReduceService;
  private final PinotStreamingQueryClient _streamingQueryClient;
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-broker/src/main/java/org/apache/pinot/broker/requesthandler/MultiStageBrokerRequestHandler.java`
#### Snippet
```java
public class MultiStageBrokerRequestHandler extends BaseBrokerRequestHandler {
  private static final Logger LOGGER = LoggerFactory.getLogger(MultiStageBrokerRequestHandler.class);
  private final String _reducerHostname;
  private final int _reducerPort;
  private final long _defaultBrokerTimeoutMs;
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-broker/src/main/java/org/apache/pinot/broker/requesthandler/MultiStageBrokerRequestHandler.java`
#### Snippet
```java
  private static final Logger LOGGER = LoggerFactory.getLogger(MultiStageBrokerRequestHandler.class);
  private final String _reducerHostname;
  private final int _reducerPort;
  private final long _defaultBrokerTimeoutMs;

```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-query-runtime/src/main/java/org/apache/pinot/query/runtime/QueryRunner.java`
#### Snippet
```java
  private String _hostname;
  private int _port;
  private VirtualServerAddress _rootServer;
  // Query worker threads are used for (1) running intermediate stage operators (2) running segment level operators
  /**
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-query-runtime/src/main/java/org/apache/pinot/query/runtime/QueryRunner.java`
#### Snippet
```java
  private MailboxService _mailboxService;
  private String _hostname;
  private int _port;
  private VirtualServerAddress _rootServer;
  // Query worker threads are used for (1) running intermediate stage operators (2) running segment level operators
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-query-runtime/src/main/java/org/apache/pinot/query/runtime/QueryRunner.java`
#### Snippet
```java
  private ZkHelixPropertyStore<ZNRecord> _helixPropertyStore;
  private MailboxService _mailboxService;
  private String _hostname;
  private int _port;
  private VirtualServerAddress _rootServer;
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-query-runtime/src/main/java/org/apache/pinot/query/runtime/operator/SortedMailboxReceiveOperator.java`
#### Snippet
```java
  private final List<RexExpression> _collationKeys;
  private final List<RelFieldCollation.Direction> _collationDirections;
  private final boolean _isSortOnSender;
  private final List<Object[]> _rows = new ArrayList<>();

```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-query-runtime/src/main/java/org/apache/pinot/query/runtime/operator/MailboxSendOperator.java`
#### Snippet
```java
  private final MultiStageOperator _sourceOperator;
  private final BlockExchange _exchange;
  private final List<RexExpression> _collationKeys;
  private final List<RelFieldCollation.Direction> _collationDirections;
  private final boolean _isSortOnSender;
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-query-runtime/src/main/java/org/apache/pinot/query/runtime/operator/MailboxSendOperator.java`
#### Snippet
```java
  private final BlockExchange _exchange;
  private final List<RexExpression> _collationKeys;
  private final List<RelFieldCollation.Direction> _collationDirections;
  private final boolean _isSortOnSender;

```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-query-runtime/src/main/java/org/apache/pinot/query/runtime/operator/MailboxSendOperator.java`
#### Snippet
```java
  private final List<RexExpression> _collationKeys;
  private final List<RelFieldCollation.Direction> _collationDirections;
  private final boolean _isSortOnSender;

  public MailboxSendOperator(OpChainExecutionContext context, MultiStageOperator sourceOperator,
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-query-runtime/src/main/java/org/apache/pinot/query/runtime/operator/SortOperator.java`
#### Snippet
```java

  private final MultiStageOperator _upstreamOperator;
  private final int _fetch;
  private final int _offset;
  private final DataSchema _dataSchema;
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-query-runtime/src/main/java/org/apache/pinot/query/runtime/operator/SetOperator.java`
#### Snippet
```java
  private final DataSchema _dataSchema;
  private TransferableBlock _currentLeftBlock;
  private Iterator<Object[]> _currentLeftIterator;

  private boolean _isRightBlockConsumed;
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-query-runtime/src/main/java/org/apache/pinot/query/runtime/operator/WindowAggregateOperator.java`
#### Snippet
```java
  private final WindowFrame _windowFrame;
  private final List<RexExpression.FunctionCall> _aggCalls;
  private final List<RexExpression> _constants;
  private final DataSchema _resultSchema;
  private final WindowAggregateAccumulator[] _windowAccumulators;
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkColumnValueSegmentPruner.java`
#### Snippet
```java
  private int _numSegments;

  private String _query = QUERY_1;
  String _scenario = "EXP(0.5)";
  private List<IndexSegment> _indexSegments;
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkGroovyExpressionEvaluation.java`
#### Snippet
```java
  private String _concatScriptText;
  private GroovyCodeSource _concatCodeSource;
  private String _maxScriptText;
  private GroovyCodeSource _maxCodeSource;

```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkGroovyExpressionEvaluation.java`
#### Snippet
```java

  private String _concatScriptText;
  private GroovyCodeSource _concatCodeSource;
  private String _maxScriptText;
  private GroovyCodeSource _maxCodeSource;
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkGroovyExpressionEvaluation.java`
#### Snippet
```java
  private GroovyCodeSource _concatCodeSource;
  private String _maxScriptText;
  private GroovyCodeSource _maxCodeSource;

  private Binding _concatBinding;
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkGroovyExpressionEvaluation.java`
#### Snippet
```java
  private final Random _random = new Random();

  private String _concatScriptText;
  private GroovyCodeSource _concatCodeSource;
  private String _maxScriptText;
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/fst/RegexpMatcher.java`
#### Snippet
```java
  public static final Logger LOGGER = LoggerFactory.getLogger(FSTBuilder.class);

  private final String _regexQuery;
  private final FST<Long> _fst;
  private final Automaton _automaton;
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/utils/RegexpMatcher.java`
#### Snippet
```java
 */
public class RegexpMatcher {
  private final String _regexQuery;
  private final FST _fst;
  private final Automaton _automaton;
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/utils/RealTimeRegexpMatcher.java`
#### Snippet
```java

public class RealTimeRegexpMatcher {
  private final String _regexQuery;
  private final MutableFST _fst;
  private final Automaton _automaton;
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/builder/FSTBuilder.java`
#### Snippet
```java
   * Information about the automaton and its compilation.
   */
  private TreeMap<InfoEntry, Object> _info;
  /**
   * {@link #_previous} sequence's length, used in assertions only.
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/automaton/RegExp.java`
#### Snippet
```java
   */
  public static final int NONE = 0x0000;
  private static boolean _allowMutation = false;
  Kind _kind;
  RegExp _exp1;
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/loader/defaultcolumn/DefaultColumnStatistics.java`
#### Snippet
```java
  private final Object _uniqueValuesSet;
  private final int _cardinality = 1;
  private final int _lengthOfShortestElement = -1;
  private final int _lengthOfLargestElement = -1;
  private final boolean _isSorted;
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/loader/defaultcolumn/DefaultColumnStatistics.java`
#### Snippet
```java
  private final Object _maxValue;
  private final Object _uniqueValuesSet;
  private final int _cardinality = 1;
  private final int _lengthOfShortestElement = -1;
  private final int _lengthOfLargestElement = -1;
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/loader/defaultcolumn/DefaultColumnStatistics.java`
#### Snippet
```java
  private final int _cardinality = 1;
  private final int _lengthOfShortestElement = -1;
  private final int _lengthOfLargestElement = -1;
  private final boolean _isSorted;
  private final int _totalNumberOfEntries;
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/readers/LuceneFSTIndexReader.java`
#### Snippet
```java
  public static final Logger LOGGER = LoggerFactory.getLogger(LuceneFSTIndexReader.class);

  private final PinotDataBuffer _dataBuffer;
  private final PinotBufferIndexInput _dataBufferIndexInput;
  private final FST<Long> _readFST;
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/readers/LuceneFSTIndexReader.java`
#### Snippet
```java

  private final PinotDataBuffer _dataBuffer;
  private final PinotBufferIndexInput _dataBufferIndexInput;
  private final FST<Long> _readFST;

```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/readers/RangeIndexReaderImpl.java`
#### Snippet
```java

  private final PinotDataBuffer _dataBuffer;
  private final DataType _valueType;
  private final int _numRanges;
  final long _bitmapIndexOffset;
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/readers/RangeIndexReaderImpl.java`
#### Snippet
```java
  private final PinotDataBuffer _dataBuffer;
  private final DataType _valueType;
  private final int _numRanges;
  final long _bitmapIndexOffset;
  private final Number[] _rangeStartArray;
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/creator/impl/SegmentIndexCreationDriverImpl.java`
#### Snippet
```java
  private long _totalRecordReadTime = 0;
  private long _totalIndexTime = 0;
  private long _totalStatsCollectorTime = 0;
  private boolean _continueOnError;

```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/function/TimeSpecFunctionEvaluator.java`
#### Snippet
```java
public class TimeSpecFunctionEvaluator implements FunctionEvaluator {
  private final String _incomingTimeColumn;
  private final String _outgoingTimeColumn;
  private final TimeConverter _incomingTimeConverter;
  private final TimeConverter _outgoingTimeConverter;
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/realtime/impl/invertedindex/NativeMutableFSTIndex.java`
#### Snippet
```java

public class NativeMutableFSTIndex implements MutableTextIndex {
  private final String _column;
  private final MutableFST _fst;
  private final ReentrantReadWriteLock.ReadLock _readLock;
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/realtime/impl/invertedindex/RealtimeLuceneTextIndex.java`
#### Snippet
```java
  private final StandardAnalyzer _analyzer = new StandardAnalyzer();
  private final String _column;
  private final String _segmentName;

  /**
```

### FieldCanBeLocal
Field can be converted to a local variable
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/indexsegment/mutable/MutableSegmentImpl.java`
#### Snippet
```java
  private final Collection<String> _physicalTimeColumnNames;

  private final List<FieldConfig> _fieldConfigList;

  // default message metadata
```

## RuleId[id=DefaultAnnotationParam]
### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/TableViews.java`
#### Snippet
```java
  public TableView getIdealState(
      @ApiParam(value = "Name of the table", required = true) @PathParam("tableName") String tableName,
      @ApiParam(value = "realtime|offline", required = false) @QueryParam("tableType") String tableTypeStr) {
    TableType tableType = validateTableType(tableTypeStr);
    return getTableState(tableName, IDEALSTATE, tableType);
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/TableViews.java`
#### Snippet
```java
  public TableView getExternalView(
      @ApiParam(value = "Name of the table", required = true) @PathParam("tableName") String tableName,
      @ApiParam(value = "realtime|offline", required = false) @QueryParam("tableType") String tableTypeStr) {
    TableType tableType = validateTableType(tableTypeStr);
    return getTableState(tableName, EXTERNALVIEW, tableType);
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotSegmentUploadDownloadRestletResource.java`
#### Snippet
```java
      @ApiParam(value = "Force revert in case the user knows that the lineage entry is interrupted")
      @QueryParam("forceRevert") @DefaultValue("false") boolean forceRevert,
      @ApiParam(value = "Fields belonging to revert replace segment request", required = false)
          RevertReplaceSegmentsRequest revertReplaceSegmentsRequest) {
    TableType tableType = Constants.validateTableType(tableTypeStr);
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotSegmentUploadDownloadRestletResource.java`
#### Snippet
```java
      @ApiParam(value = "Segment lineage entry id returned by startReplaceSegments API", required = true)
      @QueryParam("segmentLineageEntryId") String segmentLineageEntryId,
      @ApiParam(value = "Fields belonging to end replace segment request", required = false)
          EndReplaceSegmentsRequest endReplaceSegmentsRequest) {
    TableType tableType = Constants.validateTableType(tableTypeStr);
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotTenantRestletResource.java`
#### Snippet
```java
  public TenantMetadata getTenantMetadata(
      @ApiParam(value = "Tenant name", required = true) @PathParam("tenantName") String tenantName,
      @ApiParam(value = "tenant type", required = false, defaultValue = "", allowableValues = "SERVER, BROKER")
      @QueryParam("type") @DefaultValue("") String type) {

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotTenantRestletResource.java`
#### Snippet
```java
  public TenantMetadata getTenantMetadata(
      @ApiParam(value = "Tenant name", required = true) @PathParam("tenantName") String tenantName,
      @ApiParam(value = "tenant type", required = false, defaultValue = "", allowableValues = "SERVER, BROKER")
      @QueryParam("type") @DefaultValue("") String type) {

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotTenantRestletResource.java`
#### Snippet
```java
  public String changeTenantState(
      @ApiParam(value = "Tenant name", required = true) @PathParam("tenantName") String tenantName,
      @ApiParam(value = "tenant type", required = false, defaultValue = "", allowableValues = "SERVER, BROKER")
      @QueryParam("type") String type,
      @ApiParam(value = "state", required = true, defaultValue = "", allowableValues = "enable, disable, drop")
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotTenantRestletResource.java`
#### Snippet
```java
  public String changeTenantState(
      @ApiParam(value = "Tenant name", required = true) @PathParam("tenantName") String tenantName,
      @ApiParam(value = "tenant type", required = false, defaultValue = "", allowableValues = "SERVER, BROKER")
      @QueryParam("type") String type,
      @ApiParam(value = "state", required = true, defaultValue = "", allowableValues = "enable, disable, drop")
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotTenantRestletResource.java`
#### Snippet
```java
      @ApiParam(value = "tenant type", required = false, defaultValue = "", allowableValues = "SERVER, BROKER")
      @QueryParam("type") String type,
      @ApiParam(value = "state", required = true, defaultValue = "", allowableValues = "enable, disable, drop")
      @QueryParam("state") @DefaultValue("") String state) {
    TenantMetadata tenantMetadata = getTenantMetadata(tenantName, type);
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotTenantRestletResource.java`
#### Snippet
```java
  })
  public TenantsList getAllTenants(
      @ApiParam(value = "Tenant type", required = false, allowableValues = "BROKER, SERVER", defaultValue = "")
      @QueryParam("type") @DefaultValue("") String type) {
    TenantsList tenants = new TenantsList();
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotTenantRestletResource.java`
#### Snippet
```java
  })
  public TenantsList getAllTenants(
      @ApiParam(value = "Tenant type", required = false, allowableValues = "BROKER, SERVER", defaultValue = "")
      @QueryParam("type") @DefaultValue("") String type) {
    TenantsList tenants = new TenantsList();
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/TableSize.java`
#### Snippet
```java
      @ApiParam(value = "Table name without type", required = true, example = "myTable | myTable_OFFLINE")
      @PathParam("tableName") String tableName,
      @ApiParam(value = "Get detailed information", required = false) @DefaultValue("true") @QueryParam("detailed")
          boolean detailed) {
    TableSizeReader tableSizeReader =
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-compatibility-verifier/src/main/java/org/apache/pinot/compat/BaseOp.java`
#### Snippet
```java


@JsonTypeInfo(use = JsonTypeInfo.Id.NAME, include = JsonTypeInfo.As.PROPERTY, property = "type")
@JsonSubTypes({
    @JsonSubTypes.Type(value = SegmentOp.class, name = "segmentOp"),
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/ValidateTableRetention.java`
#### Snippet
```java
  private String _tableNamePattern = null;

  @CommandLine.Option(names = {"-durationInDaysThreshold"}, required = false,
      description = "Optional duration in days threshold to log a warning for table with too large retention time,"
          + " default: " + TableRetentionValidator.DEFAULT_DURATION_IN_DAYS_THRESHOLD)
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/ValidateTableRetention.java`
#### Snippet
```java
  private long _durationInDaysThreshold = TableRetentionValidator.DEFAULT_DURATION_IN_DAYS_THRESHOLD;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, usageHelp = true,
      description = "Print this message.")
  private boolean _help = false;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/ValidateTableRetention.java`
#### Snippet
```java
  private String _clusterName;

  @CommandLine.Option(names = {"-tableNamePattern"}, required = false,
      description = "Optional table name pattern trigger to add inverted index, default: null (match any table name)")
  private String _tableNamePattern = null;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/AutoAddInvertedIndexTool.java`
#### Snippet
```java
  private long _tableSizeThreshold = AutoAddInvertedIndex.DEFAULT_TABLE_SIZE_THRESHOLD;

  @CommandLine.Option(names = {"-cardinalityThreshold"}, required = false,
      description = "Optional cardinality threshold to trigger adding inverted index, default: "
          + AutoAddInvertedIndex.DEFAULT_CARDINALITY_THRESHOLD)
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/AutoAddInvertedIndexTool.java`
#### Snippet
```java
  private String _brokerAddress;

  @CommandLine.Option(names = {"-strategy"}, required = false,
      description = "Strategy to add inverted index (QUERY), default: QUERY")
  private AutoAddInvertedIndex.Strategy _strategy = AutoAddInvertedIndex.Strategy.QUERY;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/AutoAddInvertedIndexTool.java`
#### Snippet
```java
  private int _maxNumInvertedIndex = AutoAddInvertedIndex.DEFAULT_MAX_NUM_INVERTED_INDEX_ADDED;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, usageHelp = true,
      description = "Print this message.")
  private boolean _help = false;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/AutoAddInvertedIndexTool.java`
#### Snippet
```java
  private String _tableNamePattern = null;

  @CommandLine.Option(names = {"-tableSizeThreshold"}, required = false,
      description = "Optional table size threshold to trigger adding inverted index, default: "
          + AutoAddInvertedIndex.DEFAULT_TABLE_SIZE_THRESHOLD)
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/AutoAddInvertedIndexTool.java`
#### Snippet
```java
  private long _cardinalityThreshold = AutoAddInvertedIndex.DEFAULT_CARDINALITY_THRESHOLD;

  @CommandLine.Option(names = {"-maxNumInvertedIndex"}, required = false,
      description = "Optional max number of inverted index added, default: "
          + AutoAddInvertedIndex.DEFAULT_MAX_NUM_INVERTED_INDEX_ADDED)
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/AutoAddInvertedIndexTool.java`
#### Snippet
```java
  private AutoAddInvertedIndex.Mode _mode = AutoAddInvertedIndex.Mode.NEW;

  @CommandLine.Option(names = {"-tableNamePattern"}, required = false,
      description = "Optional table name pattern trigger to add inverted index, default: null (match any table name)")
  private String _tableNamePattern = null;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/AutoAddInvertedIndexTool.java`
#### Snippet
```java
  private AutoAddInvertedIndex.Strategy _strategy = AutoAddInvertedIndex.Strategy.QUERY;

  @CommandLine.Option(names = {"-mode"}, required = false,
      description = "Mode to add inverted index (NEW|REMOVE|REFRESH|APPEND), default: NEW")
  private AutoAddInvertedIndex.Mode _mode = AutoAddInvertedIndex.Mode.NEW;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/SegmentDumpTool.java`
#### Snippet
```java
  private boolean _dumpStarTree = false;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, usageHelp = true,
      description = "Print this message.")
  private boolean _help = false;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/PinotToolLauncher.java`
#### Snippet
```java
  }

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, usageHelp = true,
      description = "Print this message.")
  boolean _help = false;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/UpdateSegmentState.java`
#### Snippet
```java
  static final String DEFAULT_CLUSTER_NAME = "PinotCluster";

  @CommandLine.Option(names = {"-zkAddress"}, required = false, description = "Http address of Zookeeper.")
  private String _zkAddress = DEFAULT_ZK_ADDRESS;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/UpdateSegmentState.java`
#### Snippet
```java
  private String _tableName;

  @CommandLine.Option(names = {"-fix"}, required = false, description = "Update IDEALSTATE values (OFFLINE->ONLINE).")
  private boolean _fix = false;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/UpdateSegmentState.java`
#### Snippet
```java
  private String _tenantName;

  @CommandLine.Option(names = {"-tableName"}, required = false,
      description = "Name of the table (e.g. foo_table_OFFLINE).")
  private String _tableName;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/UpdateSegmentState.java`
#### Snippet
```java
  private String _zkAddress = DEFAULT_ZK_ADDRESS;

  @CommandLine.Option(names = {"-clusterName"}, required = false, description = "Pinot cluster name.")
  private String _clusterName = DEFAULT_CLUSTER_NAME;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/UpdateSegmentState.java`
#### Snippet
```java
  private String _clusterName = DEFAULT_CLUSTER_NAME;

  @CommandLine.Option(names = {"-tenantName"}, required = false, description = "Name of tenant.")
  private String _tenantName;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/UpdateSegmentState.java`
#### Snippet
```java
  private boolean _fix = false;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, usageHelp = true,
      description = "Print this message.")
  private boolean _help = false;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/PerfBenchmarkRunner.java`
#### Snippet
```java
  private String _loadMode = "HEAP";

  @CommandLine.Option(names = {"-segmentFormatVersion"}, required = false,
      description = "Segment format version to be loaded (v1|v3).")
  private String _segmentFormatVersion;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/PerfBenchmarkRunner.java`
#### Snippet
```java
  private String _invertedIndexColumns;

  @CommandLine.Option(names = {"-bloomFilterColumns"}, required = false,
      description = "Comma separated bloom filter columns to be created (non-batch load).")
  private String _bloomFilterColumns;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/PerfBenchmarkRunner.java`
#### Snippet
```java
  private String _dataDir;

  @CommandLine.Option(names = {"-tempDir"}, required = false,
      description = "Path to temporary directory to start the cluster")
  private String _tempDir = "/tmp/";
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/PerfBenchmarkRunner.java`
#### Snippet
```java
  private String _tableNames;

  @CommandLine.Option(names = {"-invertedIndexColumns"}, required = false,
      description = "Comma separated inverted index columns to be created (non-batch load).")
  private String _invertedIndexColumns;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/PerfBenchmarkRunner.java`
#### Snippet
```java
  private String _mode;

  @CommandLine.Option(names = {"-dataDir"}, required = false,
      description = "Path to directory containing un-tarred segments.")
  private String _dataDir;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/PerfBenchmarkRunner.java`
#### Snippet
```java
  private String _bloomFilterColumns;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, usageHelp = true,
      description = "Print this message.")
  private boolean _help = false;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/PerfBenchmarkRunner.java`
#### Snippet
```java
  private String _segmentFormatVersion;

  @CommandLine.Option(names = {"-batchLoad"}, required = false, description = "Batch load multiple tables.")
  private boolean _isBatchLoad;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/PerfBenchmarkRunner.java`
#### Snippet
```java
  private String _tempDir = "/tmp/";

  @CommandLine.Option(names = {"-loadMode"}, required = false, description = "Load mode of the segments (HEAP|MMAP).")
  private String _loadMode = "HEAP";

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/PerfBenchmarkRunner.java`
#### Snippet
```java
  private int _timeoutInSeconds = 60;

  @CommandLine.Option(names = {"-tableNames"}, required = false,
      description = "Comma separated table names with types to be loaded (non-batch load).")
  private String _tableNames;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/PerfBenchmarkRunner.java`
#### Snippet
```java
  private boolean _isBatchLoad;

  @CommandLine.Option(names = {"-numThreads"}, required = false,
      description = "Number of threads for batch load (default 10).")
  private int _numThreads = 10;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/PerfBenchmarkRunner.java`
#### Snippet
```java
  private int _numThreads = 10;

  @CommandLine.Option(names = {"-timeoutInSeconds"}, required = false,
      description = "Timeout in seconds for batch load (default 60).")
  private int _timeoutInSeconds = 60;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/BootstrapTableCommand.java`
#### Snippet
```java
  private static final Logger LOGGER = LoggerFactory.getLogger(BootstrapTableCommand.class.getName());

  @CommandLine.Option(names = {"-controllerHost"}, required = false, description = "host name for controller.")
  private String _controllerHost;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/BootstrapTableCommand.java`
#### Snippet
```java
  private String _password;

  @CommandLine.Option(names = {"-authToken"}, required = false, description = "Http auth token.")
  private String _authToken;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/BootstrapTableCommand.java`
#### Snippet
```java
  private String _dir;

  @CommandLine.Option(names = {"-user"}, required = false, description = "Username for basic auth.")
  private String _user;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/BootstrapTableCommand.java`
#### Snippet
```java
  private String _controllerProtocol = CommonConstants.HTTP_PROTOCOL;

  @CommandLine.Option(names = {"-dir", "-d", "-directory"}, required = false,
      description = "The directory contains all the configs and data to bootstrap a table")
  private String _dir;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/BootstrapTableCommand.java`
#### Snippet
```java
  private String _controllerHost;

  @CommandLine.Option(names = {"-controllerPort"}, required = false, description = "http port for broker.")
  private String _controllerPort = DEFAULT_CONTROLLER_PORT;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/BootstrapTableCommand.java`
#### Snippet
```java
  private String _user;

  @CommandLine.Option(names = {"-password"}, required = false, description = "Password for basic auth.")
  private String _password;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/BootstrapTableCommand.java`
#### Snippet
```java
  private String _controllerPort = DEFAULT_CONTROLLER_PORT;

  @CommandLine.Option(names = {"-controllerProtocol"}, required = false, description = "protocol for controller.")
  private String _controllerProtocol = CommonConstants.HTTP_PROTOCOL;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/BootstrapTableCommand.java`
#### Snippet
```java
  private String _authTokenUrl;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/BootstrapTableCommand.java`
#### Snippet
```java
  private String _authToken;

  @CommandLine.Option(names = {"-authTokenUrl"}, required = false, description = "Http auth token url.")
  private String _authTokenUrl;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ValidateConfigCommand.java`
#### Snippet
```java
  private boolean _validateSchema;

  @CommandLine.Option(names = {"-schemaNames"}, required = false,
      description = "Space separated schema names to be validated (default to validate ALL)")
  private String _schemaNames;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ValidateConfigCommand.java`
#### Snippet
```java
  private String _schemaNames;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ValidateConfigCommand.java`
#### Snippet
```java
  private String _tableNames;

  @CommandLine.Option(names = {"-schema"}, required = false, description = "Validate the schema")
  private boolean _validateSchema;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ValidateConfigCommand.java`
#### Snippet
```java
  private String _clusterName;

  @CommandLine.Option(names = {"-tableConfig"}, required = false, description = "Validate the table config")
  private boolean _validateTableConfig;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ValidateConfigCommand.java`
#### Snippet
```java
  private boolean _validateTableConfig;

  @CommandLine.Option(names = {"-tableNames"}, required = false,
      description = "Space separated table names to be validated (default to validate ALL)")
  private String _tableNames;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/PinotAdministrator.java`
#### Snippet
```java
  private boolean _help = false;

  @CommandLine.Option(names = {"-version", "-v", "--v", "--version"}, required = false,
      description = "Print the version of Pinot package.")
  private boolean _version = false;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/PinotAdministrator.java`
#### Snippet
```java
  }

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false,
      description = "Print this message.")
  private boolean _help = false;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/QuickStartCommand.java`
#### Snippet
```java
  private static final Logger LOGGER = LoggerFactory.getLogger(QuickStartCommand.class.getName());

  @CommandLine.Option(names = "-type", required = false,
      description = "Type of quickstart, supported: STREAM/BATCH/HYBRID")
  private String _type;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/QuickStartCommand.java`
#### Snippet
```java
  private String _configFilePath;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false,
      description = "Print this message.")
  private boolean _help = false;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/QuickStartCommand.java`
#### Snippet
```java
  private String _tmpDir;

  @CommandLine.Option(names = {"-zkAddress", "-zkUrl", "-zkExternalAddress"}, required = false,
      description = "URL for an external Zookeeper instance instead of using the default embedded instance")
  private String _zkExternalAddress;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/QuickStartCommand.java`
#### Snippet
```java
  private String _zkExternalAddress;

  @CommandLine.Option(names = {"-configFile", "-configFilePath"}, required = false,
      description = "Config file path to override default pinot configs")
  private String _configFilePath;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/QuickStartCommand.java`
#### Snippet
```java
  private String[] _bootstrapTableDirs;

  @CommandLine.Option(names = {"-tmpDir", "-quickstartDir", "-dataDir"}, required = false,
      description = "Temp Directory to host quickstart data")
  private String _tmpDir;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/QuickStartCommand.java`
#### Snippet
```java
  private String _type;

  @CommandLine.Option(names = {"-bootstrapTableDir"}, required = false, arity = "1..*",
      description = "A list of Directories, each directory containing table schema, config, and data.")
  private String[] _bootstrapTableDirs;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/DeleteTableCommand.java`
#### Snippet
```java
  private String _user;

  @CommandLine.Option(names = {"-password"}, required = false, description = "Password for basic auth.")
  private String _password;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/DeleteTableCommand.java`
#### Snippet
```java
  private String _controllerHost;

  @CommandLine.Option(names = {"-controllerPort"}, required = false, description = "Port number to start the "
      + "controller at.")
  private String _controllerPort = DEFAULT_CONTROLLER_PORT;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/DeleteTableCommand.java`
#### Snippet
```java
  private boolean _exec;

  @CommandLine.Option(names = {"-user"}, required = false, description = "Username for basic auth.")
  private String _user;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/DeleteTableCommand.java`
#### Snippet
```java
  private String _password;

  @CommandLine.Option(names = {"-authToken"}, required = false, description = "Http auth token.")
  private String _authToken;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/DeleteTableCommand.java`
#### Snippet
```java
  private String _type;

  @CommandLine.Option(names = {"-retention"}, required = false, description = "Retention period for the table "
      + "segments (e.g. 12h, 3d); If not set, the retention period will default to the first config that's not null: "
      + "the cluster setting, then '7d'. Using 0d or -1d will instantly delete segments without retention.")
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/DeleteTableCommand.java`
#### Snippet
```java
  private String _controllerProtocol = CommonConstants.HTTP_PROTOCOL;

  @CommandLine.Option(names = {"-exec"}, required = false, description = "Execute the command.")
  private boolean _exec;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/DeleteTableCommand.java`
#### Snippet
```java
  private String _controllerPort = DEFAULT_CONTROLLER_PORT;

  @CommandLine.Option(names = {"-controllerProtocol"}, required = false, description = "protocol for controller.")
  private String _controllerProtocol = CommonConstants.HTTP_PROTOCOL;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/DeleteTableCommand.java`
#### Snippet
```java
  private String _tableName;

  @CommandLine.Option(names = {"-type"}, required = false, description = "realtime|offline.")
  private String _type;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/DeleteTableCommand.java`
#### Snippet
```java
  private String _authToken;

  @CommandLine.Option(names = {"-authTokenUrl"}, required = false, description = "Http auth token url.")
  private String _authTokenUrl;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/DeleteTableCommand.java`
#### Snippet
```java
  private String _authTokenUrl;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true, description = "Print "
      + "this message.")
  private boolean _help = false;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/DeleteTableCommand.java`
#### Snippet
```java
  private String _retention;

  @CommandLine.Option(names = {"-controllerHost"}, required = false, description = "host name for controller.")
  private String _controllerHost;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartControllerCommand.java`
#### Snippet
```java
  private boolean _tenantIsolation = true;

  @CommandLine.Option(names = {"-configOverride"}, required = false, split = ",")
  private Map<String, Object> _configOverrides = new HashMap<>();

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartControllerCommand.java`
#### Snippet
```java
  private String _controllerHost;

  @CommandLine.Option(names = {"-controllerPort"}, required = false,
      description = "Port number to start the controller at.")
  private String _controllerPort = DEFAULT_CONTROLLER_PORT;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartControllerCommand.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-configFileName", "-config", "-configFile", "-controllerConfig", "-controllerConf"},
      required = false, description = "Controller Starter config file")
      // TODO support:
      // forbids = {"-controllerHost", "-controllerPort", "-dataDir", "-zkAddress", "-clusterName", "-controllerMode"})
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartControllerCommand.java`
#### Snippet
```java
  private boolean _help = false;

  @CommandLine.Option(names = {"-controllerHost"}, required = false, description = "host name for controller.")
  private String _controllerHost;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AddTableCommand.java`
#### Snippet
```java
  private boolean _update = false;

  @CommandLine.Option(names = {"-exec"}, required = false, description = "Execute the command.")
  private boolean _exec;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AddTableCommand.java`
#### Snippet
```java
  private String _controllerPort = DEFAULT_CONTROLLER_PORT;

  @CommandLine.Option(names = {"-controllerProtocol"}, required = false, description = "protocol for controller.")
  private String _controllerProtocol = CommonConstants.HTTP_PROTOCOL;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AddTableCommand.java`
#### Snippet
```java
  private String _controllerHost;

  @CommandLine.Option(names = {"-controllerPort"}, required = false, description = "Port number to start the "
      + "controller at.")
  private String _controllerPort = DEFAULT_CONTROLLER_PORT;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AddTableCommand.java`
#### Snippet
```java
  private String _user;

  @CommandLine.Option(names = {"-password"}, required = false, description = "Password for basic auth.")
  private String _password;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AddTableCommand.java`
#### Snippet
```java
  private String _authTokenUrl;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true, description = "Print "
      + "this message.")
  private boolean _help = false;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AddTableCommand.java`
#### Snippet
```java
  private String _password;

  @CommandLine.Option(names = {"-authToken"}, required = false, description = "Http auth token.")
  private String _authToken;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AddTableCommand.java`
#### Snippet
```java
  private String _schemaFile = null;

  @CommandLine.Option(names = {"-controllerHost"}, required = false, description = "host name for controller.")
  private String _controllerHost;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartControllerCommand.java`
#### Snippet
```java
  private String _controllerPort = DEFAULT_CONTROLLER_PORT;

  @CommandLine.Option(names = {"-dataDir"}, required = false, description = "Path to directory containging data.")
  private String _dataDir = PinotConfigUtils.TMP_DIR + "data/PinotController";

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartControllerCommand.java`
#### Snippet
```java
  private String _zkAddress = DEFAULT_ZK_ADDRESS;

  @CommandLine.Option(names = {"-clusterName"}, required = false, description = "Pinot cluster name.")
  private String _clusterName = DEFAULT_CLUSTER_NAME;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartControllerCommand.java`
#### Snippet
```java
  private String _dataDir = PinotConfigUtils.TMP_DIR + "data/PinotController";

  @CommandLine.Option(names = {"-zkAddress"}, required = false, description = "Http address of Zookeeper.")
  private String _zkAddress = DEFAULT_ZK_ADDRESS;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AddTableCommand.java`
#### Snippet
```java
  private String _realtimeTableConfigFile;

  @CommandLine.Option(names = {"-schemaFile", "-schemaFileName", "-schema"}, required = false, description = "Path to"
      + " table schema file.")
  private String _schemaFile = null;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AddTableCommand.java`
#### Snippet
```java
  private String _authToken;

  @CommandLine.Option(names = {"-authTokenUrl"}, required = false, description = "Http auth token url.")
  private String _authTokenUrl;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AddTableCommand.java`
#### Snippet
```java
  private String _controllerProtocol = CommonConstants.HTTP_PROTOCOL;

  @CommandLine.Option(names = {"-update"}, required = false,
      description = "Update the existing table instead of creating new one")
  private boolean _update = false;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AddTableCommand.java`
#### Snippet
```java
  private boolean _exec;

  @CommandLine.Option(names = {"-user"}, required = false, description = "Username for basic auth.")
  private String _user;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ChangeTableState.java`
#### Snippet
```java
  private String _controllerHost;

  @CommandLine.Option(names = {"-controllerPort"}, required = false, description = "Port number for controller.")
  private String _controllerPort = DEFAULT_CONTROLLER_PORT;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ChangeTableState.java`
#### Snippet
```java
  private String _authToken;

  @CommandLine.Option(names = {"-authTokenUrl"}, required = false, description = "Http auth token url.")
  private String _authTokenUrl;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ChangeTableState.java`
#### Snippet
```java
  private String _state;

  @CommandLine.Option(names = {"-user"}, required = false, description = "Username for basic auth.")
  private String _user;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ChangeTableState.java`
#### Snippet
```java
  private String _controllerPort = DEFAULT_CONTROLLER_PORT;

  @CommandLine.Option(names = {"-controllerProtocol"}, required = false, description = "protocol for controller.")
  private String _controllerProtocol = CommonConstants.HTTP_PROTOCOL;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ChangeTableState.java`
#### Snippet
```java
  private static final Logger LOGGER = LoggerFactory.getLogger(ChangeTableState.class);

  @CommandLine.Option(names = {"-controllerHost"}, required = false, description = "host name for controller")
  private String _controllerHost;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ChangeTableState.java`
#### Snippet
```java
  private String _authTokenUrl;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ChangeTableState.java`
#### Snippet
```java
  private String _password;

  @CommandLine.Option(names = {"-authToken"}, required = false, description = "Http auth token.")
  private String _authToken;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ChangeTableState.java`
#### Snippet
```java
  private String _user;

  @CommandLine.Option(names = {"-password"}, required = false, description = "Password for basic auth.")
  private String _password;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ImportDataCommand.java`
#### Snippet
```java
  private String _password;

  @CommandLine.Option(names = {"-authToken"}, required = false, description = "Http auth token.")
  private String _authToken;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ImportDataCommand.java`
#### Snippet
```java
  private String _user;

  @CommandLine.Option(names = {"-password"}, required = false, description = "Password for basic auth.")
  private String _password;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ImportDataCommand.java`
#### Snippet
```java
  private String _controllerURI = "http://localhost:9000";

  @CommandLine.Option(names = {"-user"}, required = false, description = "Username for basic auth.")
  private String _user;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ImportDataCommand.java`
#### Snippet
```java
  private String _authToken;

  @CommandLine.Option(names = {"-authTokenUrl"}, required = false, description = "Http auth token url.")
  private String _authTokenUrl;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ChangeNumReplicasCommand.java`
#### Snippet
```java
  private String _tableName;

  @CommandLine.Option(names = {"-exec"}, required = false, description = "Execute command (Run the replica changer)")
  private boolean _exec;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ChangeNumReplicasCommand.java`
#### Snippet
```java
  private boolean _exec;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ChangeNumReplicasCommand.java`
#### Snippet
```java
  private static final Logger LOGGER = LoggerFactory.getLogger(StartBrokerCommand.class);

  @CommandLine.Option(names = {"-zkAddress"}, required = false, description = "HTTP address of Zookeeper.")
  private String _zkAddress = DEFAULT_ZK_ADDRESS;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ChangeNumReplicasCommand.java`
#### Snippet
```java
  private String _zkAddress = DEFAULT_ZK_ADDRESS;

  @CommandLine.Option(names = {"-clusterName"}, required = false, description = "Pinot cluster name.")
  private String _clusterName = "PinotCluster";

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/DeleteSchemaCommand.java`
#### Snippet
```java
  private String _controllerPort = DEFAULT_CONTROLLER_PORT;

  @CommandLine.Option(names = {"-controllerProtocol"}, required = false, description = "protocol for controller.")
  private String _controllerProtocol = CommonConstants.HTTP_PROTOCOL;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/VerifyClusterStateCommand.java`
#### Snippet
```java
  private String _clusterName = "PinotCluster";

  @CommandLine.Option(names = {"-tableName"}, required = false,
      description = "Table name to check the state (e.g. myTable_OFFLINE).")
  private String _tableName;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/DeleteSchemaCommand.java`
#### Snippet
```java
  private String _user;

  @CommandLine.Option(names = {"-password"}, required = false, description = "Password for basic auth.")
  private String _password;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/VerifyClusterStateCommand.java`
#### Snippet
```java
  private String _zkAddress = DEFAULT_ZK_ADDRESS;

  @CommandLine.Option(names = {"-clusterName"}, required = false, description = "Pinot cluster name.")
  private String _clusterName = "PinotCluster";

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/DeleteSchemaCommand.java`
#### Snippet
```java
  private boolean _exec;

  @CommandLine.Option(names = {"-user"}, required = false, description = "Username for basic auth.")
  private String _user;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/VerifyClusterStateCommand.java`
#### Snippet
```java
  private static final Logger LOGGER = LoggerFactory.getLogger(VerifyClusterStateCommand.class);

  @CommandLine.Option(names = {"-zkAddress"}, required = false, description = "HTTP address of Zookeeper.")
  private String _zkAddress = DEFAULT_ZK_ADDRESS;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/DeleteSchemaCommand.java`
#### Snippet
```java
  private String _controllerHost;

  @CommandLine.Option(names = {"-controllerPort"}, required = false, description = "port name for controller.")
  private String _controllerPort = DEFAULT_CONTROLLER_PORT;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/VerifyClusterStateCommand.java`
#### Snippet
```java
  private long _timeoutSec = 300L;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/DeleteSchemaCommand.java`
#### Snippet
```java
  private String _password;

  @CommandLine.Option(names = {"-authToken"}, required = false, description = "Http auth token.")
  private String _authToken;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/VerifyClusterStateCommand.java`
#### Snippet
```java
  private String _tableName;

  @CommandLine.Option(names = {"-timeoutSec"}, required = false, description = "Maximum timeout in second.")
  private long _timeoutSec = 300L;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/DeleteSchemaCommand.java`
#### Snippet
```java
  private String _authTokenUrl;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true, description = "Print "
      + "this message.")
  private boolean _help = false;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/DeleteSchemaCommand.java`
#### Snippet
```java
  private static final Logger LOGGER = LoggerFactory.getLogger(DeleteSchemaCommand.class);

  @CommandLine.Option(names = {"-controllerHost"}, required = false, description = "host name for controller.")
  private String _controllerHost;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/DeleteSchemaCommand.java`
#### Snippet
```java
  private String _authToken;

  @CommandLine.Option(names = {"-authTokenUrl"}, required = false, description = "Http auth token url.")
  private String _authTokenUrl;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/DeleteSchemaCommand.java`
#### Snippet
```java
  private String _schemaName = null;

  @CommandLine.Option(names = {"-exec"}, required = false, description = "Execute the command.")
  private boolean _exec;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartServiceManagerCommand.java`
#### Snippet
```java
      // TODO: support forbids = {"-zkAddress", "-clusterName", "-port", "-bootstrapServices"})
  private String[] _bootstrapConfigPaths;
  @CommandLine.Option(names = {"-bootstrapServices"}, required = false, arity = "1..*",
      description = "A list of Pinot service roles to start with default config. E.g. CONTROLLER/BROKER/SERVER")
      // TODO: support forbids = {"-zkAddress", "-clusterName", "-port", "-bootstrapConfigPaths"})
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartServiceManagerCommand.java`
#### Snippet
```java
      // TODO: support forbids = {"-bootstrapConfigPaths", "-bootstrapServices"})
  private String _clusterName = DEFAULT_CLUSTER_NAME;
  @CommandLine.Option(names = {"-port"}, required = false,
      description = "Pinot service manager admin port, -1 means disable, 0 means a random available port.")
      // TODO: support forbids = {"-bootstrapConfigPaths", "-bootstrapServices"})
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartServiceManagerCommand.java`
#### Snippet
```java
  private final List<Entry<ServiceRole, Map<String, Object>>> _bootstrapConfigurations = new ArrayList<>();

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartServiceManagerCommand.java`
#### Snippet
```java
      // TODO: support forbids = {"-bootstrapConfigPaths", "-bootstrapServices"})
  private int _port = -1;
  @CommandLine.Option(names = {"-bootstrapConfigPaths"}, required = false, arity = "1..*",
      description = "A list of Pinot service config file paths. Each config file requires an extra config:"
          + " 'pinot.service.role' to indicate which service to start.")
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartServiceManagerCommand.java`
#### Snippet
```java
      description = "Print this message.")
  private boolean _help;
  @CommandLine.Option(names = {"-zkAddress"}, required = false, description = "Http address of Zookeeper.")
  // TODO: support forbids = {"-bootstrapConfigPaths", "-bootstrapServices"})
  private String _zkAddress = DEFAULT_ZK_ADDRESS;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartServiceManagerCommand.java`
#### Snippet
```java
  // TODO: support forbids = {"-bootstrapConfigPaths", "-bootstrapServices"})
  private String _zkAddress = DEFAULT_ZK_ADDRESS;
  @CommandLine.Option(names = {"-clusterName"}, required = false, description = "Pinot cluster name.")
      // TODO: support forbids = {"-bootstrapConfigPaths", "-bootstrapServices"})
  private String _clusterName = DEFAULT_CLUSTER_NAME;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/VerifySegmentState.java`
#### Snippet
```java
  String _tablePrefix = "";

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/VerifySegmentState.java`
#### Snippet
```java
  String _clusterName;

  @CommandLine.Option(names = {"-tablePrefix"}, required = false,
      description = "Table name prefix. (Ex: myTable, my or myTable_OFFLINE)")
  String _tablePrefix = "";
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ShowClusterInfoCommand.java`
#### Snippet
```java
  private String _zkAddress = DEFAULT_ZK_ADDRESS;

  @CommandLine.Option(names = {"-clusterName"}, required = false, description = "Pinot cluster clusterName.")
  private String _clusterName = DEFAULT_CLUSTER_NAME;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ShowClusterInfoCommand.java`
#### Snippet
```java
  private String _tables = "";

  @CommandLine.Option(names = {"-tags"}, required = false, description = "Commaa separated tag names.")
  private String _tags = "";

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ShowClusterInfoCommand.java`
#### Snippet
```java
  private static final Logger LOGGER = LoggerFactory.getLogger(ShowClusterInfoCommand.class.getName());

  @CommandLine.Option(names = {"-zkAddress"}, required = false, description = "HTTP address of Zookeeper.")
  private String _zkAddress = DEFAULT_ZK_ADDRESS;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ShowClusterInfoCommand.java`
#### Snippet
```java
  private String _clusterName = DEFAULT_CLUSTER_NAME;

  @CommandLine.Option(names = {"-tables"}, required = false, description = "Comma separated table names.")
  private String _tables = "";

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ShowClusterInfoCommand.java`
#### Snippet
```java
  private String _tags = "";

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/QueryRunner.java`
#### Snippet
```java
      + "intervals to increase QPS for increasingQPS mode (default 10).")
  private int _numIntervalsToIncreaseQPS = 10;
  @CommandLine.Option(names = {"-brokerHost"}, required = false, description = "Broker host name (default localhost).")
  private String _brokerHost = "localhost";
  @CommandLine.Option(names = {"-brokerPort"}, required = false, description = "Broker port number (default 8099).")
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/QueryRunner.java`
#### Snippet
```java
      + " all).")
  private int _queryCount = 0;
  @CommandLine.Option(names = {"-numTimesToRunQueries"}, required = false, description = "Number of times to run all "
      + "queries in the query file, 0 means infinite times (default 1).")
  private int _numTimesToRunQueries = 1;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/QueryRunner.java`
#### Snippet
```java
          + "This can be used to simulate multiple clients sending queries concurrently.")
  private int _numThreads = 5;
  @CommandLine.Option(names = {"-startQPS"}, required = false, description = "Start QPS for targetQPS and "
      + "increasingQPS mode")
  private double _startQPS;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/QueryRunner.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-brokerHost"}, required = false, description = "Broker host name (default localhost).")
  private String _brokerHost = "localhost";
  @CommandLine.Option(names = {"-brokerPort"}, required = false, description = "Broker port number (default 8099).")
  private int _brokerPort = 8099;
  @CommandLine.Option(names = {"-brokerURL"}, required = false, description = "Broker URL (no default, uses "
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/QueryRunner.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-deltaQPS"}, required = false, description = "Delta QPS for increasingQPS mode.")
  private double _deltaQPS;
  @CommandLine.Option(names = {"-numIntervalsToIncreaseQPS"}, required = false, description = "Number of report "
      + "intervals to increase QPS for increasingQPS mode (default 10).")
  private int _numIntervalsToIncreaseQPS = 10;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/QueryRunner.java`
#### Snippet
```java
      + "false).")
  private boolean _verbose = false;
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true, description = "Print "
      + "this message.")
  private boolean _help;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/QueryRunner.java`
#### Snippet
```java
      + "(full|resample).")
  private String _queryMode = QueryMode.FULL.toString();
  @CommandLine.Option(names = {"-queryCount"}, required = false, description = "Number of queries to run (default 0 ="
      + " all).")
  private int _queryCount = 0;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/QueryRunner.java`
#### Snippet
```java
      + "increasingQPS mode")
  private double _startQPS;
  @CommandLine.Option(names = {"-deltaQPS"}, required = false, description = "Delta QPS for increasingQPS mode.")
  private double _deltaQPS;
  @CommandLine.Option(names = {"-numIntervalsToIncreaseQPS"}, required = false, description = "Number of report "
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/QueryRunner.java`
#### Snippet
```java
      + "queries in the query file, 0 means infinite times (default 1).")
  private int _numTimesToRunQueries = 1;
  @CommandLine.Option(names = {"-reportIntervalMs"}, required = false, description = "Interval in milliseconds to "
      + "report simple statistics (default 3000).")
  private int _reportIntervalMs = 3000;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/QueryRunner.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-queryFile"}, required = true, description = "Path to query file.")
  private String _queryFile;
  @CommandLine.Option(names = {"-queryMode"}, required = false, description = "Mode of query generator "
      + "(full|resample).")
  private String _queryMode = QueryMode.FULL.toString();
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/QueryRunner.java`
#### Snippet
```java
      + "all queries (default: unlimited).")
  private long _timeout = 0;
  @CommandLine.Option(names = {"-verbose"}, required = false, description = "Enable verbose query logging (default: "
      + "false).")
  private boolean _verbose = false;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/QueryRunner.java`
#### Snippet
```java
      "Number of report intervals to report detailed statistics and clear them," + " 0 means never (default 10).")
  private int _numIntervalsToReportAndClearStatistics = 10;
  @CommandLine.Option(names = {"-numThreads"}, required = false, description =
      "Number of threads sending queries for multiThreads, targetQPS and increasingQPS mode (default 5). "
          + "This can be used to simulate multiple clients sending queries concurrently.")
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/QueryRunner.java`
#### Snippet
```java
      + "report simple statistics (default 3000).")
  private int _reportIntervalMs = 3000;
  @CommandLine.Option(names = {"-numIntervalsToReportAndClearStatistics"}, required = false, description =
      "Number of report intervals to report detailed statistics and clear them," + " 0 means never (default 10).")
  private int _numIntervalsToReportAndClearStatistics = 10;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/QueryRunner.java`
#### Snippet
```java
      + "brokerHost:brokerPort by default.")
  private String _brokerURL;
  @CommandLine.Option(names = {"-queueDepth"}, required = false, description = "Queue size limit for multi-threaded "
      + "execution (default 64).")
  private int _queueDepth = 64;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/QueryRunner.java`
#### Snippet
```java
      + "execution (default 64).")
  private int _queueDepth = 64;
  @CommandLine.Option(names = {"-timeout"}, required = false, description = "Timeout in milliseconds for completing "
      + "all queries (default: unlimited).")
  private long _timeout = 0;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/perf/QueryRunner.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-brokerPort"}, required = false, description = "Broker port number (default 8099).")
  private int _brokerPort = 8099;
  @CommandLine.Option(names = {"-brokerURL"}, required = false, description = "Broker URL (no default, uses "
      + "brokerHost:brokerPort by default.")
  private String _brokerURL;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartMinionCommand.java`
#### Snippet
```java
public class StartMinionCommand extends AbstractBaseAdminCommand implements Command {
  private static final Logger LOGGER = LoggerFactory.getLogger(StartMinionCommand.class);
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartMinionCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-clusterName"}, required = false, description = "Pinot cluster name.")
  private String _clusterName = "PinotCluster";
  @CommandLine.Option(names = {"-configFileName"}, required = false,
      description = "Minion Starter Config file.")
      // TODO: support forbids = {"-minionHost", "-minionPort"}
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartMinionCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-minionPort"}, required = false, description = "Port number to start the minion at.")
  private int _minionPort = CommonConstants.Minion.DEFAULT_HELIX_PORT;
  @CommandLine.Option(names = {"-zkAddress"}, required = false, description = "HTTP address of Zookeeper.")
  private String _zkAddress = DEFAULT_ZK_ADDRESS;
  @CommandLine.Option(names = {"-clusterName"}, required = false, description = "Pinot cluster name.")
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartMinionCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-minionHost"}, required = false, description = "Host name for minion.")
  private String _minionHost;
  @CommandLine.Option(names = {"-minionPort"}, required = false, description = "Port number to start the minion at.")
  private int _minionPort = CommonConstants.Minion.DEFAULT_HELIX_PORT;
  @CommandLine.Option(names = {"-zkAddress"}, required = false, description = "HTTP address of Zookeeper.")
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartMinionCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-zkAddress"}, required = false, description = "HTTP address of Zookeeper.")
  private String _zkAddress = DEFAULT_ZK_ADDRESS;
  @CommandLine.Option(names = {"-clusterName"}, required = false, description = "Pinot cluster name.")
  private String _clusterName = "PinotCluster";
  @CommandLine.Option(names = {"-configFileName"}, required = false,
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartMinionCommand.java`
#### Snippet
```java
      description = "Print this message.")
  private boolean _help = false;
  @CommandLine.Option(names = {"-minionHost"}, required = false, description = "Host name for minion.")
  private String _minionHost;
  @CommandLine.Option(names = {"-minionPort"}, required = false, description = "Port number to start the minion at.")
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/RealtimeProvisioningHelperCommand.java`
#### Snippet
```java
  private String _numHours = "2,3,4,5,6,7,8,9,10,11,12";

  @CommandLine.Option(names = {"-sampleCompletedSegmentDir"}, required = false,
      description = "Consume from the topic for n hours and provide the path of the segment dir after it completes")
  private String _sampleCompletedSegmentDir;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/RealtimeProvisioningHelperCommand.java`
#### Snippet
```java
  private int _ingestionRate;

  @CommandLine.Option(names = {"-maxUsableHostMemory"}, required = false,
      description = "Maximum memory per host that can be used for pinot data (e.g. 250G, 100M). Default 48g")
  private String _maxUsableHostMemory = "48G";
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/RealtimeProvisioningHelperCommand.java`
#### Snippet
```java
  private String _schemaWithMetadataFile;

  @CommandLine.Option(names = {"-numRows"}, required = false,
      description = "Number of rows to be generated based on schema with metadata file")
  private int _numRows;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/RealtimeProvisioningHelperCommand.java`
#### Snippet
```java
  private String _sampleCompletedSegmentDir;

  @CommandLine.Option(names = {"-schemaWithMetadataFile"}, required = false,
      description = "Schema file with extra information on each column describing characteristics of data")
  private String _schemaWithMetadataFile;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/LaunchSparkDataIngestionJobCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-master"}, required = false, defaultValue = "local", description = "Spark Master")
  private String _sparkMaster;
  @CommandLine.Option(names = {"-sparkVersion"}, required = false, defaultValue = "SPARK_3", description = "Spark "
      + "plugin to use - can be one of Spark_2 or Spark_3")
  private SparkType _sparkVersion;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/LaunchSparkDataIngestionJobCommand.java`
#### Snippet
```java
      + " job spec template")
  private List<String> _values;
  @CommandLine.Option(names = {"-propertyFile"}, required = false, description = "A property file contains context "
      + "values to set the job spec template")
  private String _propertyFile;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/LaunchSparkDataIngestionJobCommand.java`
#### Snippet
```java
      + "logging from launcher")
  private boolean _verbose;
  @CommandLine.Option(names = {"-sparkConf"}, required = false, split = ":", mapFallbackValue = "", description =
      "Additional Spark configuration values as key value pairs separated by : e.g. -sparkConf spark.executor"
          + ".cores=2:num-executors=3")
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/LaunchSparkDataIngestionJobCommand.java`
#### Snippet
```java
      + "values to set the job spec template")
  private String _propertyFile;
  @CommandLine.Option(names = {"-pluginsToLoad"}, required = false, arity = "1..*", split = ":", description = "List "
      + "of plugin name separated by : to load at runtime. e.g. pinto-s3:pinot-parquet")
  private List<String> _pluginsToLoad;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/LaunchSparkDataIngestionJobCommand.java`
#### Snippet
```java
      + "plugin to use - can be one of Spark_2 or Spark_3")
  private SparkType _sparkVersion;
  @CommandLine.Option(names = {"-verbose"}, required = false, defaultValue = "true", description = "Enable verbose "
      + "logging from launcher")
  private boolean _verbose;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/LaunchSparkDataIngestionJobCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-deployMode"}, required = false, description = "Spark Deploy Mode")
  private String _deployMode;
  @CommandLine.Option(names = {"-master"}, required = false, defaultValue = "local", description = "Spark Master")
  private String _sparkMaster;
  @CommandLine.Option(names = {"-sparkVersion"}, required = false, defaultValue = "SPARK_3", description = "Spark "
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/LaunchSparkDataIngestionJobCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-jobSpecFile", "-jobSpec"}, required = true, description = "Ingestion job spec file")
  private String _jobSpecFile;
  @CommandLine.Option(names = {"-values"}, required = false, arity = "1..*", description = "Context values set to the"
      + " job spec template")
  private List<String> _values;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/PostQueryCommand.java`
#### Snippet
```java
  private String _brokerPort = Integer.toString(CommonConstants.Helix.DEFAULT_BROKER_QUERY_PORT);

  @CommandLine.Option(names = {"-brokerProtocol"}, required = false, description = "protocol for broker.")
  private String _brokerProtocol = "http";

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/PostQueryCommand.java`
#### Snippet
```java
  private String _query;

  @CommandLine.Option(names = {"-user"}, required = false, description = "Username for basic auth.")
  private String _user;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/PostQueryCommand.java`
#### Snippet
```java
  private String _authTokenUrl;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true, description = "Print "
      + "this message.")
  private boolean _help = false;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/PostQueryCommand.java`
#### Snippet
```java
  private String _user;

  @CommandLine.Option(names = {"-password"}, required = false, description = "Password for basic auth.")
  private String _password;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/PostQueryCommand.java`
#### Snippet
```java
  private String _authToken;

  @CommandLine.Option(names = {"-authTokenUrl"}, required = false, description = "Http auth token url.")
  private String _authTokenUrl;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/PostQueryCommand.java`
#### Snippet
```java
  private String _password;

  @CommandLine.Option(names = {"-authToken"}, required = false, description = "Http auth token.")
  private String _authToken;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/PostQueryCommand.java`
#### Snippet
```java
  private String _brokerHost;

  @CommandLine.Option(names = {"-brokerPort"}, required = false, description = "http port for broker.")
  private String _brokerPort = Integer.toString(CommonConstants.Helix.DEFAULT_BROKER_QUERY_PORT);

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/PostQueryCommand.java`
#### Snippet
```java
  private static final Logger LOGGER = LoggerFactory.getLogger(PostQueryCommand.class.getName());

  @CommandLine.Option(names = {"-brokerHost"}, required = false, description = "host name for broker.")
  private String _brokerHost;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/PostQueryCommand.java`
#### Snippet
```java
  private boolean _help = false;

  @CommandLine.Option(names = {"-o", "-option"}, required = false, description = "Additional options '-o key=value'")
  private Map<String, String> _additionalOptions = new HashMap<>();

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/LaunchSparkDataIngestionJobCommand.java`
#### Snippet
```java
      "List " + "of plugin name separated by : to not load at runtime. e.g. pinto-s3:pinot-parquet")
  private List<String> _pluginsToExclude;
  @CommandLine.Option(names = {"-pinotBaseDir"}, required = false, description = "Pinot binary installation directory")
  private String _pinotBaseDir;
  @CommandLine.Option(names = {"-deployMode"}, required = false, description = "Spark Deploy Mode")
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/LaunchSparkDataIngestionJobCommand.java`
#### Snippet
```java
  // It is also fine to exclude Kafka plugins as they are not going to be used in batch ingestion in any case
  @CommandLine.Option(names = {"-pluginsToExclude"}, defaultValue = "pinot-kafka-0.9:pinot-kafka-2.0", required =
      false, arity = "1..*", split = ":", description =
      "List " + "of plugin name separated by : to not load at runtime. e.g. pinto-s3:pinot-parquet")
  private List<String> _pluginsToExclude;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/LaunchSparkDataIngestionJobCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-pinotBaseDir"}, required = false, description = "Pinot binary installation directory")
  private String _pinotBaseDir;
  @CommandLine.Option(names = {"-deployMode"}, required = false, description = "Spark Deploy Mode")
  private String _deployMode;
  @CommandLine.Option(names = {"-master"}, required = false, defaultValue = "local", description = "Spark Master")
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/LaunchSparkDataIngestionJobCommand.java`
#### Snippet
```java
  public static final String PINOT_MAIN_JAR_PREFIX = "pinot-all";

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true, description = "Print "
      + "this message.")
  private boolean _help = false;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/LaunchDataIngestionJobCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-authToken"}, required = false, description = "Http auth token.")
  private String _authToken;
  @CommandLine.Option(names = {"-authTokenUrl"}, required = false, description = "Http auth token url.")
  private String _authTokenUrl;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/LaunchDataIngestionJobCommand.java`
#### Snippet
```java
public class LaunchDataIngestionJobCommand extends AbstractBaseAdminCommand implements Command {
  private static final Logger LOGGER = LoggerFactory.getLogger(LaunchDataIngestionJobCommand.class);
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/LaunchDataIngestionJobCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-password"}, required = false, description = "Password for basic auth.")
  private String _password;
  @CommandLine.Option(names = {"-authToken"}, required = false, description = "Http auth token.")
  private String _authToken;
  @CommandLine.Option(names = {"-authTokenUrl"}, required = false, description = "Http auth token url.")
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/LaunchDataIngestionJobCommand.java`
#### Snippet
```java
      description = "A property file contains context values to set the job spec template")
  private String _propertyFile;
  @CommandLine.Option(names = {"-user"}, required = false, description = "Username for basic auth.")
  private String _user;
  @CommandLine.Option(names = {"-password"}, required = false, description = "Password for basic auth.")
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/LaunchDataIngestionJobCommand.java`
#### Snippet
```java
      description = "Context values set to the job spec template")
  private List<String> _values;
  @CommandLine.Option(names = {"-propertyFile"}, required = false,
      description = "A property file contains context values to set the job spec template")
  private String _propertyFile;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/LaunchDataIngestionJobCommand.java`
#### Snippet
```java
      description = "Ingestion job spec file")
  private String _jobSpecFile;
  @CommandLine.Option(names = {"-values"}, required = false, arity = "1..*",
      description = "Context values set to the job spec template")
  private List<String> _values;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/LaunchDataIngestionJobCommand.java`
#### Snippet
```java
  @CommandLine.Option(names = {"-user"}, required = false, description = "Username for basic auth.")
  private String _user;
  @CommandLine.Option(names = {"-password"}, required = false, description = "Password for basic auth.")
  private String _password;
  @CommandLine.Option(names = {"-authToken"}, required = false, description = "Http auth token.")
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/UploadSegmentCommand.java`
#### Snippet
```java
  private String _tableName = null;

  @CommandLine.Option(names = {"-tableType"}, required = false,
      description = "Table type to upload. Can be OFFLINE or REALTIME")
  private TableType _tableType = TableType.OFFLINE;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/UploadSegmentCommand.java`
#### Snippet
```java
  private String _segmentDir = null;

  @CommandLine.Option(names = {"-tableName"}, required = false, description = "Table name to upload")
  private String _tableName = null;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/UploadSegmentCommand.java`
#### Snippet
```java
  private String _user;

  @CommandLine.Option(names = {"-password"}, required = false, description = "Password for basic auth.")
  private String _password;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/UploadSegmentCommand.java`
#### Snippet
```java
  private String _authToken;

  @CommandLine.Option(names = {"-authTokenUrl"}, required = false, description = "Http auth token url.")
  private String _authTokenUrl;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/UploadSegmentCommand.java`
#### Snippet
```java
  private String _controllerProtocol = CommonConstants.HTTP_PROTOCOL;

  @CommandLine.Option(names = {"-user"}, required = false, description = "Username for basic auth.")
  private String _user;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/UploadSegmentCommand.java`
#### Snippet
```java
  private TableType _tableType = TableType.OFFLINE;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/UploadSegmentCommand.java`
#### Snippet
```java
  private String _password;

  @CommandLine.Option(names = {"-authToken"}, required = false, description = "Http auth token.")
  private String _authToken;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/UploadSegmentCommand.java`
#### Snippet
```java
  private String _controllerPort = DEFAULT_CONTROLLER_PORT;

  @CommandLine.Option(names = {"-controllerProtocol"}, required = false, description = "protocol for controller.")
  private String _controllerProtocol = CommonConstants.HTTP_PROTOCOL;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/UploadSegmentCommand.java`
#### Snippet
```java
  private static final String SEGMENT_UPLOADER = "segmentUploader";

  @CommandLine.Option(names = {"-controllerHost"}, required = false, description = "host name for controller.")
  private String _controllerHost;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/UploadSegmentCommand.java`
#### Snippet
```java
  private String _controllerHost;

  @CommandLine.Option(names = {"-controllerPort"}, required = false, description = "Port number for controller.")
  private String _controllerPort = DEFAULT_CONTROLLER_PORT;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartZookeeperCommand.java`
#### Snippet
```java
  private int _zkPort = 2181;

  @CommandLine.Option(names = {"-dataDir"}, required = false, description = "Directory for zookeper data.")
  private String _dataDir = PinotConfigUtils.TMP_DIR + "PinotAdmin/zkData";

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartZookeeperCommand.java`
#### Snippet
```java
  private static final Logger LOGGER = LoggerFactory.getLogger(StartZookeeperCommand.class);

  @CommandLine.Option(names = {"-zkPort"}, required = false, description = "Port to start zookeeper server on.")
  private int _zkPort = 2181;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartZookeeperCommand.java`
#### Snippet
```java
  private String _dataDir = PinotConfigUtils.TMP_DIR + "PinotAdmin/zkData";

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartBrokerCommand.java`
#### Snippet
```java
  private String _zkAddress = DEFAULT_ZK_ADDRESS;

  @CommandLine.Option(names = {"-clusterName"}, required = false, description = "Pinot cluster name.")
  private String _clusterName = "PinotCluster";

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartBrokerCommand.java`
#### Snippet
```java
  private int _brokerMultiStageRunnerPort = QueryConfig.DEFAULT_QUERY_RUNNER_PORT;

  @CommandLine.Option(names = {"-zkAddress"}, required = false, description = "HTTP address of Zookeeper.")
  private String _zkAddress = DEFAULT_ZK_ADDRESS;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartBrokerCommand.java`
#### Snippet
```java
public class StartBrokerCommand extends AbstractBaseAdminCommand implements Command {
  private static final Logger LOGGER = LoggerFactory.getLogger(StartBrokerCommand.class);
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartBrokerCommand.java`
#### Snippet
```java
  private String _configFileName;

  @CommandLine.Option(names = {"-configOverrides"}, required = false, split = ",",
      description = "Proxy config overrides")
  private Map<String, Object> _configOverrides = new HashMap<>();
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartBrokerCommand.java`
#### Snippet
```java
  private boolean _help = false;

  @CommandLine.Option(names = {"-brokerHost"}, required = false, description = "host name for broker.")
  private String _brokerHost;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartBrokerCommand.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-configFileName", "-config", "-configFile", "-brokerConfig", "-brokerConf"},
      required = false, description = "Broker Starter Config file.")
      // TODO: support forbids = {"-brokerHost", "-brokerPort"})
  private String _configFileName;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartBrokerCommand.java`
#### Snippet
```java
  private int _brokerPort = CommonConstants.Helix.DEFAULT_BROKER_QUERY_PORT;

  @CommandLine.Option(names = {"-brokerMultiStageRunnerPort"}, required = false,
      description = "Broker port number to use for query.")
  private int _brokerMultiStageRunnerPort = QueryConfig.DEFAULT_QUERY_RUNNER_PORT;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartBrokerCommand.java`
#### Snippet
```java
  private String _brokerHost;

  @CommandLine.Option(names = {"-brokerPort"}, required = false, description = "Broker port number to use for query.")
  private int _brokerPort = CommonConstants.Helix.DEFAULT_BROKER_QUERY_PORT;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AddSchemaCommand.java`
#### Snippet
```java
  private String _authToken;

  @CommandLine.Option(names = {"-authTokenUrl"}, required = false, description = "Http auth token url.")
  private String _authTokenUrl;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AddSchemaCommand.java`
#### Snippet
```java
  private boolean _exec;

  @CommandLine.Option(names = {"-user"}, required = false, description = "Username for basic auth.")
  private String _user;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AddSchemaCommand.java`
#### Snippet
```java
  private String _user;

  @CommandLine.Option(names = {"-password"}, required = false, description = "Password for basic auth.")
  private String _password;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AddSchemaCommand.java`
#### Snippet
```java
  private String _schemaFile = null;

  @CommandLine.Option(names = {"-exec"}, required = false, description = "Execute the command.")
  private boolean _exec;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AddSchemaCommand.java`
#### Snippet
```java
  private String _controllerHost;

  @CommandLine.Option(names = {"-controllerPort"}, required = false, description = "port name for controller.")
  private String _controllerPort = DEFAULT_CONTROLLER_PORT;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AddSchemaCommand.java`
#### Snippet
```java
  private String _authTokenUrl;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AddSchemaCommand.java`
#### Snippet
```java
  private static final Logger LOGGER = LoggerFactory.getLogger(AddSchemaCommand.class);

  @CommandLine.Option(names = {"-controllerHost"}, required = false, description = "host name for controller.")
  private String _controllerHost;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AddSchemaCommand.java`
#### Snippet
```java
  private String _password;

  @CommandLine.Option(names = {"-authToken"}, required = false, description = "Http auth token.")
  private String _authToken;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AddSchemaCommand.java`
#### Snippet
```java
  private String _controllerPort = DEFAULT_CONTROLLER_PORT;

  @CommandLine.Option(names = {"-controllerProtocol"}, required = false, description = "protocol for controller.")
  private String _controllerProtocol = CommonConstants.HTTP_PROTOCOL;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StreamAvroIntoKafkaCommand.java`
#### Snippet
```java
  private String _avroFile = null;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StreamAvroIntoKafkaCommand.java`
#### Snippet
```java
  private String _outputFormat = "json";

  @CommandLine.Option(names = {"-millisBetweenMessages"}, required = false,
      description = "Delay in milliseconds between messages (default 1000 ms)")
  private String _millisBetweenMessages = "1000";
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StreamAvroIntoKafkaCommand.java`
#### Snippet
```java
  private String _kafkaTopic = null;

  @CommandLine.Option(names = {"-zkAddress"}, required = false, description = "Address of Zookeeper.")
  private String _zkAddress = "localhost:2181";

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StreamAvroIntoKafkaCommand.java`
#### Snippet
```java
  private boolean _help = false;

  @CommandLine.Option(names = {"-kafkaBrokerList"}, required = false, description = "Kafka broker list.")
  private String _kafkaBrokerList = KafkaStarterUtils.DEFAULT_KAFKA_BROKER;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StreamAvroIntoKafkaCommand.java`
#### Snippet
```java
  private String _zkAddress = "localhost:2181";

  @CommandLine.Option(names = {"-outputFormat"}, required = false,
      description = "Data format to produce to Kafka, supported: json(default) and avro")
  private String _outputFormat = "json";
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/OperateClusterConfigCommand.java`
#### Snippet
```java
  private String _authToken;

  @CommandLine.Option(names = {"-authTokenUrl"}, required = false, description = "Http auth token url.")
  private String _authTokenUrl;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/OperateClusterConfigCommand.java`
#### Snippet
```java
  private String _user;

  @CommandLine.Option(names = {"-password"}, required = false, description = "Password for basic auth.")
  private String _password;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/OperateClusterConfigCommand.java`
#### Snippet
```java
  private static final Logger LOGGER = LoggerFactory.getLogger(OperateClusterConfigCommand.class.getName());

  @CommandLine.Option(names = {"-controllerHost"}, required = false, description = "host name for controller.")
  private String _controllerHost;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/OperateClusterConfigCommand.java`
#### Snippet
```java
  private String _controllerHost;

  @CommandLine.Option(names = {"-controllerPort"}, required = false, description = "http port for controller.")
  private String _controllerPort = DEFAULT_CONTROLLER_PORT;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/OperateClusterConfigCommand.java`
#### Snippet
```java
  private String _operation;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/OperateClusterConfigCommand.java`
#### Snippet
```java
  private String _controllerProtocol = CommonConstants.HTTP_PROTOCOL;

  @CommandLine.Option(names = {"-user"}, required = false, description = "Username for basic auth.")
  private String _user;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/OperateClusterConfigCommand.java`
#### Snippet
```java
  private String _controllerPort = DEFAULT_CONTROLLER_PORT;

  @CommandLine.Option(names = {"-controllerProtocol"}, required = false, description = "protocol for controller.")
  private String _controllerProtocol = CommonConstants.HTTP_PROTOCOL;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/OperateClusterConfigCommand.java`
#### Snippet
```java
  private String _password;

  @CommandLine.Option(names = {"-authToken"}, required = false, description = "Http auth token.")
  private String _authToken;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/GenerateDataCommand.java`
#### Snippet
```java
  private String _schemaFile = null;

  @CommandLine.Option(names = {"-schemaAnnotationFile"}, required = false,
      description = "File containing dim/metrics for columns.")
  private String _schemaAnnFile;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/GenerateDataCommand.java`
#### Snippet
```java
  private boolean _help = false;

  @CommandLine.Option(names = {"-format"}, required = false, help = true,
      description = "Output format ('AVRO' or 'CSV').")
  private String _format = FORMAT_AVRO;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/GenerateDataCommand.java`
#### Snippet
```java
  boolean _overwrite;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/GenerateDataCommand.java`
#### Snippet
```java
  private String _outDir = null;

  @CommandLine.Option(names = {"-overwrite"}, required = false, description = "Overwrite, if directory exists")
  boolean _overwrite;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AddTenantCommand.java`
#### Snippet
```java
  private static final Logger LOGGER = LoggerFactory.getLogger(AddTenantCommand.class);

  @CommandLine.Option(names = {"-controllerHost"}, required = false, description = "host name for controller.")
  private String _controllerHost;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AddTenantCommand.java`
#### Snippet
```java
  private String _authToken;

  @CommandLine.Option(names = {"-authTokenUrl"}, required = false, description = "Http auth token url.")
  private String _authTokenUrl;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AddTenantCommand.java`
#### Snippet
```java
  private String _user;

  @CommandLine.Option(names = {"-password"}, required = false, description = "Password for basic auth.")
  private String _password;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AddTenantCommand.java`
#### Snippet
```java
  private String _controllerPort = DEFAULT_CONTROLLER_PORT;

  @CommandLine.Option(names = {"-controllerProtocol"}, required = false, description = "protocol for controller.")
  private String _controllerProtocol = CommonConstants.HTTP_PROTOCOL;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AddTenantCommand.java`
#### Snippet
```java
  private String _password;

  @CommandLine.Option(names = {"-authToken"}, required = false, description = "Http auth token.")
  private String _authToken;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AddTenantCommand.java`
#### Snippet
```java
  private String _controllerHost;

  @CommandLine.Option(names = {"-controllerPort"}, required = false,
      description = "Port number to start the controller at.")
  private String _controllerPort = DEFAULT_CONTROLLER_PORT;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AddTenantCommand.java`
#### Snippet
```java
  private int _realtimeInstanceCount;

  @CommandLine.Option(names = {"-exec"}, required = false, description = "Execute the command.")
  private boolean _exec;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AddTenantCommand.java`
#### Snippet
```java
  private boolean _exec;

  @CommandLine.Option(names = {"-user"}, required = false, description = "Username for basic auth.")
  private String _user;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AddTenantCommand.java`
#### Snippet
```java
  private String _authTokenUrl;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/DeleteClusterCommand.java`
#### Snippet
```java
  private String _zkAddress = DEFAULT_ZK_ADDRESS;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/DeleteClusterCommand.java`
#### Snippet
```java
  private String _clusterName = "PinotCluster";

  @CommandLine.Option(names = {"-zkAddress"}, required = false, description = "Http address of Zookeeper.")
  private String _zkAddress = DEFAULT_ZK_ADDRESS;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartKafkaCommand.java`
#### Snippet
```java
  private int _brokerId = KafkaStarterUtils.DEFAULT_BROKER_ID;

  @CommandLine.Option(names = {"-zkAddress"}, required = false, description = "Address of Zookeeper.")
  private String _zkAddress = KafkaStarterUtils.getDefaultKafkaZKAddress();
  private StreamDataServerStartable _kafkaStarter;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartKafkaCommand.java`
#### Snippet
```java
  private boolean _help = false;

  @CommandLine.Option(names = {"-brokerId"}, required = false, description = "Kafka broker ID.")
  private int _brokerId = KafkaStarterUtils.DEFAULT_BROKER_ID;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartKafkaCommand.java`
#### Snippet
```java
  private static final Logger LOGGER = LoggerFactory.getLogger(StartKafkaCommand.class);

  @CommandLine.Option(names = {"-port"}, required = false, description = "Port to start Kafka server on.")
  private int _port = KafkaStarterUtils.DEFAULT_KAFKA_PORT;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartKafkaCommand.java`
#### Snippet
```java
  private int _port = KafkaStarterUtils.DEFAULT_KAFKA_PORT;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartServerCommand.java`
#### Snippet
```java
  private int _serverMultiStageServerPort = QueryConfig.DEFAULT_QUERY_SERVER_PORT;

  @CommandLine.Option(names = {"-serverMultiStageRunnerPort"}, required = false,
      description = "Port number to multi-stage query engine runner communication.")
  private int _serverMultiStageRunnerPort = QueryConfig.DEFAULT_QUERY_RUNNER_PORT;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartServerCommand.java`
#### Snippet
```java
  private String _segmentDir = PinotConfigUtils.TMP_DIR + "data/pinotSegments";

  @CommandLine.Option(names = {"-zkAddress"}, required = false, description = "Http address of Zookeeper.")
  private String _zkAddress = DEFAULT_ZK_ADDRESS;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartServerCommand.java`
#### Snippet
```java
  private int _serverGrpcPort = CommonConstants.Server.DEFAULT_GRPC_PORT;

  @CommandLine.Option(names = {"-serverMultiStageServerPort"}, required = false,
      description = "Port number to multi-stage query engine service entrypoint.")
  private int _serverMultiStageServerPort = QueryConfig.DEFAULT_QUERY_SERVER_PORT;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartServerCommand.java`
#### Snippet
```java
  private boolean _help = false;

  @CommandLine.Option(names = {"-serverHost"}, required = false, description = "Host name for server.")
  private String _serverHost;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartServerCommand.java`
#### Snippet
```java
  private String _configFileName;

  @CommandLine.Option(names = {"-configOverride"}, required = false, split = ",")
  private Map<String, Object> _configOverrides = new HashMap<>();

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartServerCommand.java`
#### Snippet
```java
  private String _serverHost;

  @CommandLine.Option(names = {"-serverPort"}, required = false, description = "Port number to start the server at.")
  private int _serverPort = CommonConstants.Helix.DEFAULT_SERVER_NETTY_PORT;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartServerCommand.java`
#### Snippet
```java
  private int _serverPort = CommonConstants.Helix.DEFAULT_SERVER_NETTY_PORT;

  @CommandLine.Option(names = {"-serverAdminPort"}, required = false,
      description = "Port number to serve the server admin API at.")
  private int _serverAdminPort = CommonConstants.Server.DEFAULT_ADMIN_API_PORT;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartServerCommand.java`
#### Snippet
```java
  private int _serverMultiStageRunnerPort = QueryConfig.DEFAULT_QUERY_RUNNER_PORT;

  @CommandLine.Option(names = {"-dataDir"}, required = false, description = "Path to directory containing data.")
  private String _dataDir = PinotConfigUtils.TMP_DIR + "data/pinotServerData";

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartServerCommand.java`
#### Snippet
```java
public class StartServerCommand extends AbstractBaseAdminCommand implements Command {
  private static final Logger LOGGER = LoggerFactory.getLogger(StartServerCommand.class);
  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartServerCommand.java`
#### Snippet
```java
  private int _serverAdminPort = CommonConstants.Server.DEFAULT_ADMIN_API_PORT;

  @CommandLine.Option(names = {"-serverGrpcPort"}, required = false,
      description = "Port number to serve the grpc query.")
  private int _serverGrpcPort = CommonConstants.Server.DEFAULT_GRPC_PORT;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartServerCommand.java`
#### Snippet
```java
  private String _dataDir = PinotConfigUtils.TMP_DIR + "data/pinotServerData";

  @CommandLine.Option(names = {"-segmentDir"}, required = false,
      description = "Path to directory containing segments.")
  private String _segmentDir = PinotConfigUtils.TMP_DIR + "data/pinotSegments";
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartServerCommand.java`
#### Snippet
```java

  @CommandLine.Option(names = {"-configFileName", "-config", "-configFile", "-serverConfig", "-serverConf"},
      required = false, description = "Server Starter Config file.")
  // TODO support forbids = {"-serverHost", "-serverPort", "-dataDir", "-segmentDir"}
  private String _configFileName;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartServerCommand.java`
#### Snippet
```java
  private String _zkAddress = DEFAULT_ZK_ADDRESS;

  @CommandLine.Option(names = {"-clusterName"}, required = false, description = "Pinot cluster name.")
  private String _clusterName = "PinotCluster";

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StopProcessCommand.java`
#### Snippet
```java
  private boolean _zooKeeper = false;

  @CommandLine.Option(names = {"-kafka"}, required = false, description = "Stop the Kafka process.")
  private boolean _kafka = false;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StopProcessCommand.java`
#### Snippet
```java
  private boolean _controller = false;

  @CommandLine.Option(names = {"-server"}, required = false, description = "Stop the PinotServer process.")
  private boolean _server = false;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StopProcessCommand.java`
#### Snippet
```java
  private boolean _server = false;

  @CommandLine.Option(names = {"-broker"}, required = false, description = "Stop the PinotBroker process.")
  private boolean _broker = false;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StopProcessCommand.java`
#### Snippet
```java
  private boolean _broker = false;

  @CommandLine.Option(names = {"-zooKeeper"}, required = false, description = "Stop the ZooKeeper process.")
  private boolean _zooKeeper = false;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StopProcessCommand.java`
#### Snippet
```java
  private boolean _kafka = false;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Stop the PinotServer.")
  private boolean _help = false;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StopProcessCommand.java`
#### Snippet
```java
  private static final Logger LOGGER = LoggerFactory.getLogger(StopProcessCommand.class);

  @CommandLine.Option(names = {"-controller"}, required = false, description = "Stop the PinotController process.")
  private boolean _controller = false;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/MoveReplicaGroup.java`
#### Snippet
```java
  private String _tableName;

  @CommandLine.Option(names = {"-maxSegmentsToMove", "-m", "--max"}, required = false,
      description = "MaxSegmentsToMove")
  private int _maxSegmentsToMove = Integer.MAX_VALUE;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/MoveReplicaGroup.java`
#### Snippet
```java
  private boolean _exec = false;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, description = "Prints help")
  private boolean _help = false;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/MoveReplicaGroup.java`
#### Snippet
```java
  private String _srcHosts;

  @CommandLine.Option(names = {"-destHostsFile", "-d", "--dest"}, required = false,
      description = "File with destination servers list")
  private String _destHostsFile = "";
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/MoveReplicaGroup.java`
#### Snippet
```java
  private String _zkPath;

  @CommandLine.Option(names = {"-exec"}, required = false,
      description = "Execute replica group move. dryRun(default) if not specified")
  private boolean _exec = false;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/segment/converter/PinotSegmentConvertCommand.java`
#### Snippet
```java
  private boolean _overwrite;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/segment/converter/PinotSegmentConvertCommand.java`
#### Snippet
```java
  private char _csvListDelimiter = ';';

  @CommandLine.Option(names = {"-csvWithHeader"}, required = false, description = "Print CSV Header (default false).")
  private boolean _csvWithHeader;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/segment/converter/PinotSegmentConvertCommand.java`
#### Snippet
```java
  private String _outputFormat;

  @CommandLine.Option(names = {"-csvDelimiter"}, required = false, description = "CSV delimiter (default ',').")
  private char _csvDelimiter = ',';

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/segment/converter/PinotSegmentConvertCommand.java`
#### Snippet
```java
  private boolean _csvWithHeader;

  @CommandLine.Option(names = {"-overwrite"}, required = false,
      description = "Overwrite the existing file (default false).")
  private boolean _overwrite;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/segment/converter/PinotSegmentConvertCommand.java`
#### Snippet
```java
  private char _csvDelimiter = ',';

  @CommandLine.Option(names = {"-csvListDelimiter"}, required = false,
      description = "CSV List delimiter for multi-value columns (default ';').")
  private char _csvListDelimiter = ';';
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/segment/converter/DictionaryToRawIndexConverter.java`
#### Snippet
```java
  private boolean _compressOutput = false;

  @CommandLine.Option(names = {"-compressionType"}, required = false, description = "Compression Type")
  private String _compressionType = "Snappy";

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/segment/converter/DictionaryToRawIndexConverter.java`
#### Snippet
```java
  private String _columns = null;

  @CommandLine.Option(names = {"-tableName"}, required = false,
      description = "New table name, if different from original")
  private String _tableName = null;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/segment/converter/DictionaryToRawIndexConverter.java`
#### Snippet
```java
  private String _compressionType = "Snappy";

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "print this message")
  private boolean _help = false;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/segment/converter/DictionaryToRawIndexConverter.java`
#### Snippet
```java
  private boolean _overwrite = false;

  @CommandLine.Option(names = {"-numThreads"}, required = false,
      description = "Number of threads to launch for conversion")
  private int _numThreads = 4;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/segment/converter/DictionaryToRawIndexConverter.java`
#### Snippet
```java
  private String _outputDir = null;

  @CommandLine.Option(names = {"-overwrite"}, required = false, description = "Overwrite output directory")
  private boolean _overwrite = false;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/segment/converter/DictionaryToRawIndexConverter.java`
#### Snippet
```java
  private int _numThreads = 4;

  @CommandLine.Option(names = {"-compressOutput"}, required = false,
      description = "Compress (tar + gzip) output segment")
  private boolean _compressOutput = false;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/filesystem/PinotFSBenchmarkRunner.java`
#### Snippet
```java
  private Integer _numSegmentsForListTest;

  @CommandLine.Option(names = {"-dataSizeInMBsForCopyTest"}, required = false,
      description = "Data size in MB for copy test. (e.g. 1024 = 1GB)")
  private Integer _dataSizeInMBsForCopyTest;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/filesystem/PinotFSBenchmarkRunner.java`
#### Snippet
```java
  private String _localTempDir;

  @CommandLine.Option(names = {"-numSegmentsForListTest"}, required = false,
      description = "The number of segments to create before running listFiles test.")
  private Integer _numSegmentsForListTest;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/filesystem/PinotFSBenchmarkRunner.java`
#### Snippet
```java
  private Integer _numOps;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, help = true,
      description = "Print this message.")
  private boolean _help = false;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/filesystem/PinotFSBenchmarkRunner.java`
#### Snippet
```java
  private Integer _dataSizeInMBsForCopyTest;

  @CommandLine.Option(names = {"-numOps"}, required = false,
      description = "The number of trials of operations when running a benchmark.")
  private Integer _numOps;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-tools/src/main/java/org/apache/pinot/tools/filesystem/PinotFSBenchmarkRunner.java`
#### Snippet
```java
  private String _baseDirectoryUri;

  @CommandLine.Option(names = {"-localTempDir"}, required = false, description = "Local temp directory for benchmark.")
  private String _localTempDir;

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-perf/src/main/java/org/apache/pinot/perf/RawIndexBenchmark.java`
#### Snippet
```java
  private String _fwdIndexColumn = DEFAULT_FWD_INDEX_COLUMN;

  @CommandLine.Option(names = {"-rawIndexColumn"}, required = false,
      description = "Name of column with raw index (no-dictionary")
  private String _rawIndexColumn = DEFAULT_RAW_INDEX_COLUMN;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-perf/src/main/java/org/apache/pinot/perf/RawIndexBenchmark.java`
#### Snippet
```java
  private String _rawIndexColumn = DEFAULT_RAW_INDEX_COLUMN;

  @CommandLine.Option(names = {"-dataFile"}, required = false,
      description = "File containing input data (one string per line)")
  private String _dataFile = null;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-perf/src/main/java/org/apache/pinot/perf/RawIndexBenchmark.java`
#### Snippet
```java
  private int _numConsecutiveLookups = DEFAULT_NUM_CONSECUTIVE_LOOKUP;

  @CommandLine.Option(names = {"-help", "-h", "--h", "--help"}, required = false, usageHelp = true,
      description = "print this message")
  private boolean _help = false;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-perf/src/main/java/org/apache/pinot/perf/RawIndexBenchmark.java`
#### Snippet
```java
  private String _loadMode = "heap";

  @CommandLine.Option(names = {"-numLookups"}, required = false,
      description = "Number of lookups to be performed for benchmark")
  private int _numLookups = DEFAULT_NUM_LOOKUP;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-perf/src/main/java/org/apache/pinot/perf/RawIndexBenchmark.java`
#### Snippet
```java
  private String _dataFile = null;

  @CommandLine.Option(names = {"-loadMode"}, required = false, description = "Load mode for data (mmap|heap")
  private String _loadMode = "heap";

```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-perf/src/main/java/org/apache/pinot/perf/RawIndexBenchmark.java`
#### Snippet
```java
  private String _segmentDir = null;

  @CommandLine.Option(names = {"-fwdIndexColumn"}, required = false,
      description = "Name of column with dictionary encoded index")
  private String _fwdIndexColumn = DEFAULT_FWD_INDEX_COLUMN;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-perf/src/main/java/org/apache/pinot/perf/RawIndexBenchmark.java`
#### Snippet
```java
  private int _numLookups = DEFAULT_NUM_LOOKUP;

  @CommandLine.Option(names = {"-numConsecutiveLookups"}, required = false,
      description = "Number of consecutive docIds to lookup")
  private int _numConsecutiveLookups = DEFAULT_NUM_CONSECUTIVE_LOOKUP;
```

### DefaultAnnotationParam
Redundant default parameter value assignment
in `pinot-perf/src/main/java/org/apache/pinot/perf/RawIndexBenchmark.java`
#### Snippet
```java
  private static final int DEFAULT_NUM_CONSECUTIVE_LOOKUP = 50;

  @CommandLine.Option(names = {"-segmentDir"}, required = false, description = "Untarred segment")
  private String _segmentDir = null;

```

## RuleId[id=MalformedFormatString]
### MalformedFormatString
Too many arguments for format string (found: 1, expected: 0)
in `pinot-spi/src/main/java/org/apache/pinot/spi/utils/JsonUtils.java`
#### Snippet
```java
      }
    } else {
      throw new IllegalArgumentException(String.format("Unsupported json node type", jsonNode.getClass()));
    }
  }
```

### MalformedFormatString
Too many arguments for format string (found: 1, expected: 0)
in `pinot-spi/src/main/java/org/apache/pinot/spi/plugin/PluginManager.java`
#### Snippet
```java
    for (String pluginsDirectory : directories) {
      if (!new File(pluginsDirectory).exists()) {
        throw new IllegalArgumentException(String.format("Plugins dir [{}] doesn't exist.", pluginsDirectory));
      }

```

## RuleId[id=IfStatementWithIdenticalBranches]
### IfStatementWithIdenticalBranches
Common part can be extracted from 'if'
in `pinot-core/src/main/java/org/apache/pinot/core/plan/FilterPlanNode.java`
#### Snippet
```java
    }
    // TODO: handle nested geography/geometry conversion functions
    if (functionName.equals("stwithin")) {
      if (arguments.get(0).getType() == ExpressionContext.Type.IDENTIFIER
          && arguments.get(1).getType() == ExpressionContext.Type.LITERAL) {
```

### IfStatementWithIdenticalBranches
Common parts with variables can be extracted from 'if'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/ByteSequenceIterator.java`
#### Snippet
```java
  @Override
  public ByteBuffer next() {
    if (_nextElement != null) {
      final ByteBuffer cache = _nextElement;
      _nextElement = null;
```

### IfStatementWithIdenticalBranches
Common part can be extracted from 'if'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/realtime/impl/dictionary/OffHeapMutableBytesStore.java`
#### Snippet
```java
    // Value length matches, check value
    PinotDataBuffer valueBuffer = _valueBuffers.get(valueBufferIndex);
    if (inputValueLength <= PinotDataBuffer.BULK_BYTES_PROCESSING_THRESHOLD) {
      for (int i = 0; i < inputValueLength; i++) {
        if (valueToCompare[i] != valueBuffer.getByte(startOffsetInValueBuffer + i)) {
```

## RuleId[id=SimplifyOptionalCallChains]
### SimplifyOptionalCallChains
Can be replaced with 'isEmpty()'
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/RealtimeConsumptionRateManager.java`
#### Snippet
```java
  public ConsumptionRateLimiter createRateLimiter(StreamConfig streamConfig, String tableName,
      ServerMetrics serverMetrics, String metricKeyName) {
    if (!streamConfig.getTopicConsumptionRateLimit().isPresent()) {
      return NOOP_RATE_LIMITER;
    }
```

### SimplifyOptionalCallChains
Can be replaced with 'isEmpty()'
in `pinot-core/src/main/java/org/apache/pinot/core/util/ListenerConfigUtil.java`
#### Snippet
```java
    Optional<String> optProtocol =
        Optional.ofNullable(configuredProtocol).map(String::trim).filter(protocol -> !protocol.isEmpty());
    if (!optProtocol.isPresent()) {
      return Optional.of(listenerName).filter(SUPPORTED_PROTOCOLS::contains).orElseThrow(
          () -> new IllegalArgumentException("No protocol set for listener" + listenerName + " and '" + listenerName
```

### SimplifyOptionalCallChains
Can be replaced with 'isEmpty()'
in `pinot-broker/src/main/java/org/apache/pinot/broker/broker/BasicAuthAccessControlFactory.java`
#### Snippet
```java
      Optional<BasicAuthPrincipal> principalOpt = getPrincipalOpt(requesterIdentity);

      if (!principalOpt.isPresent()) {
        // no matching token? reject
        return false;
```

### SimplifyOptionalCallChains
Can be replaced with 'isEmpty()'
in `pinot-broker/src/main/java/org/apache/pinot/broker/broker/BasicAuthAccessControlFactory.java`
#### Snippet
```java
      Optional<BasicAuthPrincipal> principalOpt = getPrincipalOpt(requesterIdentity);

      if (!principalOpt.isPresent()) {
        // no matching token? reject
        return false;
```

### SimplifyOptionalCallChains
Can be replaced with 'isEmpty()'
in `pinot-broker/src/main/java/org/apache/pinot/broker/broker/ZkBasicAuthAccessControlFactory.java`
#### Snippet
```java
        public boolean hasAccess(RequesterIdentity requesterIdentity, Set<String> tables) {
            Optional<ZkBasicAuthPrincipal> principalOpt = getPrincipalAuth(requesterIdentity);
            if (!principalOpt.isPresent()) {
                // no matching token? reject
                return false;
```

## RuleId[id=SlowListContainsAll]
### SlowListContainsAll
Call to 'list.containsAll(collection)' may have poor performance
in `pinot-common/src/main/java/org/apache/pinot/common/utils/SqlResultComparator.java`
#### Snippet
```java
  private static boolean areElementsSubset(List<String> actualElementsSerialized,
      List<String> expectedElementsSerialized) {
    boolean result = expectedElementsSerialized.containsAll(actualElementsSerialized);
    if (!result) {
      LOGGER.error("Actual result '{}' is not a subset of '{}'", actualElementsSerialized, expectedElementsSerialized);
```

### SlowListContainsAll
Call to 'list.containsAll(collection)' may have poor performance
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/startree/v2/builder/StarTreeV2BuilderConfig.java`
#### Snippet
```java
    if (indexConfig.getSkipStarNodeCreationForDimensions() != null) {
      skipStarNodeCreationForDimensions = new TreeSet<>(indexConfig.getSkipStarNodeCreationForDimensions());
      Preconditions.checkArgument(dimensionsSplitOrder.containsAll(skipStarNodeCreationForDimensions),
          "Can not skip star-node creation for dimensions not in the split order, dimensionsSplitOrder: %s, "
              + "skipStarNodeCreationForDimensions: %s",
```

## RuleId[id=InfiniteLoopStatement]
### InfiniteLoopStatement
`while` statement cannot complete without throwing an exception
in `pinot-core/src/main/java/org/apache/pinot/core/accounting/PerQueryCPUMemAccountantFactory.java`
#### Snippet
```java
            _isCPUTimeBasedKillingEnabled, _cpuTimeBasedKillingThresholdNS);

        while (true) {
          LOGGER.debug("Running timed task for PerQueryCPUMemAccountant.");
          _triggeringLevel = TriggeringLevel.Normal;
```

### InfiniteLoopStatement
`while` statement cannot complete without throwing an exception
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/relocation/SegmentRelocator.java`
#### Snippet
```java
        try {
          // Keep checking any table waiting to rebalance.
          while (true) {
            rebalanceWaitingTable(this::rebalanceTable);
          }
```

## RuleId[id=SlowAbstractSetRemoveAll]
### SlowAbstractSetRemoveAll
Call to 'set.removeAll(list)' may work slowly
in `pinot-common/src/main/java/org/apache/pinot/common/utils/helix/HelixHelper.java`
#### Snippet
```java
        Set<String> partitionSet = idealState.getPartitionSet();
        if (partitionSet != null) {
          partitionSet.removeAll(segments);
        }
        return idealState;
```

### SlowAbstractSetRemoveAll
Call to 'set.removeAll(list)' may work slowly
in `pinot-core/src/main/java/org/apache/pinot/core/operator/filter/H3IndexFilterOperator.java`
#### Snippet
```java
        List<Long> fullMatchH3Ids = getAlwaysMatchH3Ids(_upperBound);
        HashSet<Long> partialMatchH3Ids = new HashSet<>(getPossibleMatchH3Ids(_upperBound));
        partialMatchH3Ids.removeAll(fullMatchH3Ids);

        MutableRoaringBitmap fullMatchDocIds = new MutableRoaringBitmap();
```

### SlowAbstractSetRemoveAll
Call to 'set.removeAll(list)' may work slowly
in `pinot-core/src/main/java/org/apache/pinot/core/operator/filter/H3IndexFilterOperator.java`
#### Snippet
```java

        // Remove the always not match H3 ids from possible not match H3 ids to get the partial match H3 ids
        possibleNotMatchH3Ids.removeAll(alwaysNotMatchH3Ids);
        MutableRoaringBitmap partialMatchDocIds = new MutableRoaringBitmap();
        for (long partialMatchH3Id : possibleNotMatchH3Ids) {
```

### SlowAbstractSetRemoveAll
Call to 'set.removeAll(list)' may work slowly
in `pinot-core/src/main/java/org/apache/pinot/core/operator/filter/H3IndexFilterOperator.java`
#### Snippet
```java
      if (upperAlwaysMatchH3Ids.size() > lowerPossibleMatchH3Ids.size()) {
        fullMatchH3Ids = new HashSet<>(upperAlwaysMatchH3Ids);
        fullMatchH3Ids.removeAll(lowerPossibleMatchH3Ids);
      } else {
        fullMatchH3Ids = Collections.emptySet();
```

### SlowAbstractSetRemoveAll
Call to 'set.removeAll(list)' may work slowly
in `pinot-core/src/main/java/org/apache/pinot/core/operator/filter/H3IndexFilterOperator.java`
#### Snippet
```java
      // possible match H3 ids for the upper bound to get the partial match H3 ids
      Set<Long> partialMatchH3Ids = new HashSet<>(upperPossibleMatchH3Ids);
      partialMatchH3Ids.removeAll(lowerAlwaysMatchH3Ids);
      partialMatchH3Ids.removeAll(fullMatchH3Ids);
      MutableRoaringBitmap partialMatchDocIds = new MutableRoaringBitmap();
```

## RuleId[id=RedundantStringFormatCall]
### RedundantStringFormatCall
Redundant call to `format()`
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/RealtimeProvisioningHelperCommand.java`
#### Snippet
```java

    for (int r = 0; r < outputValues.length; r++) {
      System.out.print(String.format("%2d", numHours[r]));
      System.out.print(" --------> ");
      for (int c = 0; c < outputValues[r].length; c++) {
```

### RedundantStringFormatCall
Redundant call to `format()`
in `pinot-tools/src/main/java/org/apache/pinot/tools/segment/converter/DictionaryToRawIndexConverter.java`
#### Snippet
```java
        CommandLine.Option option = field.getAnnotation(CommandLine.Option.class);
        System.out
            .println(String.format("\t%-15s: %s (required=%s)",
                Arrays.toString(option.names()), Arrays.toString(option.description()), option.required()));
      }
```

### RedundantStringFormatCall
Redundant call to `format()`
in `pinot-perf/src/main/java/org/apache/pinot/perf/DictionaryDumper.java`
#### Snippet
```java
        int id = Integer.valueOf(strId);
        String s = colDictionary.getStringValue(id);
        System.out.println(String.format("%d -> %s", id, s));
      }
    }
```

## RuleId[id=FuseStreamOperations]
### FuseStreamOperations
Stream may be extended replacing HashSet
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/physical/colocated/GreedyShuffleRewriteVisitor.java`
#### Snippet
```java
      int numPartitions = _dispatchablePlanMetadataMap.get(node.getStageId()).getServerInstanceToWorkerIdMap().size();
      List<ColocationKey> colocationKeys = ((FieldSelectionKeySelector) selector).getColumnIndices().stream()
          .map(x -> new ColocationKey(x, numPartitions, selector.hashAlgorithm())).collect(Collectors.toList());
      return new HashSet<>(colocationKeys);
    }
```

### FuseStreamOperations
Stream may be extended replacing HashSet
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/physical/colocated/GreedyShuffleRewriteVisitor.java`
#### Snippet
```java
    int numPartitions = _dispatchablePlanMetadataMap.get(node.getStageId()).getServerInstanceToWorkerIdMap().size();
    List<ColocationKey> colocationKeys = ((FieldSelectionKeySelector) selector).getColumnIndices().stream()
        .map(x -> new ColocationKey(x, numPartitions, selector.hashAlgorithm())).collect(Collectors.toList());
    return new HashSet<>(colocationKeys);
  }
```

### FuseStreamOperations
Stream may be extended replacing 'sort'
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotTableRestletResource.java`
#### Snippet
```java
        if (tableType == null && StringUtils.isBlank(taskType)) {
          List<String> rawTableNames = tableNamesWithType.stream().map(TableNameBuilder::extractRawTableName).distinct()
              .collect(Collectors.toList());
          rawTableNames.sort(sortAsc ? null : Comparator.reverseOrder());
          tableNames = rawTableNames;
```

## RuleId[id=PointlessNullCheck]
### PointlessNullCheck
Unnecessary 'null' check before 'equals()' call
in `pinot-query-runtime/src/main/java/org/apache/pinot/query/runtime/operator/WindowAggregateOperator.java`
#### Snippet
```java
        Object previousRowOutputValue) {
      Object value = _inputRef == -1 ? _literal : row[_inputRef];
      if (previousPartitionKey == null || !currentPartitionKey.equals(previousPartitionKey)) {
        return _merger.initialize(currentPartitionKey, _dataType);
      } else {
```

## RuleId[id=InfiniteRecursion]
### InfiniteRecursion
Method `getShort()` recurses infinitely, and can only end by throwing an exception
in `pinot-clients/pinot-jdbc-client/src/main/java/org/apache/pinot/client/base/AbstractBaseResultSet.java`
#### Snippet
```java

  @Override
  public short getShort(String columnLabel)
      throws SQLException {
    return getShort(columnLabel);
```

### InfiniteRecursion
Method `newStartState()` recurses infinitely, and can only end by throwing an exception
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/mutablefst/MutableFSTImpl.java`
#### Snippet
```java
  }

  public MutableState newStartState() {
    return newStartState();
  }
```

### InfiniteRecursion
Method `getBytesValue()` recurses infinitely, and can only end by throwing an exception
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/realtime/impl/dictionary/BigDecimalOnHeapMutableDictionary.java`
#### Snippet
```java

  @Override
  public byte[] getBytesValue(int dictId) {
    return getBytesValue(dictId);
  }
```

## RuleId[id=TypeParameterExtendsObject]
### TypeParameterExtendsObject
Type parameter `C` explicitly extends 'java.lang.Object'
in `pinot-query-planner/src/main/java/org/apache/calcite/prepare/PinotCalciteCatalogReader.java`
#### Snippet
```java
  }

  @Override public <C extends Object> @Nullable C unwrap(Class<C> aClass) {
    if (aClass.isInstance(this)) {
      return aClass.cast(this);
```

## RuleId[id=OptionalGetWithoutIsPresent]
### OptionalGetWithoutIsPresent
`Optional.get()` without 'isPresent()' check
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/rules/impl/InvertedSortedIndexJointRule.java`
#### Snippet
```java
                    -> optimalCombination.getCandidateDims().contains(predicateParseResult.getCandidateDims()))
                .min(Comparator.comparing(PredicateParseResult::getnESIWithIdx))
                .get()) // The selected result in findOptimalCombination process
            .collect(Collectors.toList());

```

## RuleId[id=ConstantValue]
### ConstantValue
Condition `!CollectionUtils.isEmpty(fieldCollations) && isSortOnSender` is always `false`
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/stage/MailboxSendNode.java`
#### Snippet
```java
    // TODO: Support ordering here if the 'fieldCollations' aren't empty and 'sortOnSender' is true
    Preconditions.checkState(!isSortOnSender, "Ordering is not yet supported on Mailbox Send");
    if (!CollectionUtils.isEmpty(fieldCollations) && isSortOnSender) {
      _collationKeys = new ArrayList<>(fieldCollations.size());
      _collationDirections = new ArrayList<>(fieldCollations.size());
```

### ConstantValue
Condition `isSortOnSender` is always `false` when reached
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/stage/MailboxSendNode.java`
#### Snippet
```java
    // TODO: Support ordering here if the 'fieldCollations' aren't empty and 'sortOnSender' is true
    Preconditions.checkState(!isSortOnSender, "Ordering is not yet supported on Mailbox Send");
    if (!CollectionUtils.isEmpty(fieldCollations) && isSortOnSender) {
      _collationKeys = new ArrayList<>(fieldCollations.size());
      _collationDirections = new ArrayList<>(fieldCollations.size());
```

### ConstantValue
Value `isSortOnSender` is always 'false'
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/stage/MailboxSendNode.java`
#### Snippet
```java
      _collationDirections = Collections.emptyList();
    }
    _isSortOnSender = isSortOnSender;
  }

```

### ConstantValue
Value `setOp` is always 'null'
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/stage/SetOpNode.java`
#### Snippet
```java
        return UNION;
      }
      if (setOp instanceof LogicalIntersect) {
        return INTERSECT;
      }
```

### ConstantValue
Value `setOp` is always 'null'
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/stage/SetOpNode.java`
#### Snippet
```java
        return INTERSECT;
      }
      if (setOp instanceof LogicalMinus) {
        return MINUS;
      }
```

### ConstantValue
Condition `_traitDefs.add(relTraitDef)` is always `true` when reached
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/logical/LogicalPlanner.java`
#### Snippet
```java
  @Override
  public boolean addRelTraitDef(RelTraitDef relTraitDef) {
    return !_traitDefs.contains(relTraitDef) && _traitDefs.add(relTraitDef);
  }

```

### ConstantValue
Value `node` is always 'null'
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/logical/RelToStageConverter.java`
#### Snippet
```java
    if (node instanceof LogicalTableScan) {
      return convertLogicalTableScan((LogicalTableScan) node, currentStageId);
    } else if (node instanceof LogicalJoin) {
      return convertLogicalJoin((LogicalJoin) node, currentStageId);
    } else if (node instanceof LogicalProject) {
```

### ConstantValue
Value `node` is always 'null'
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/logical/RelToStageConverter.java`
#### Snippet
```java
    } else if (node instanceof LogicalJoin) {
      return convertLogicalJoin((LogicalJoin) node, currentStageId);
    } else if (node instanceof LogicalProject) {
      return convertLogicalProject((LogicalProject) node, currentStageId);
    } else if (node instanceof LogicalFilter) {
```

### ConstantValue
Value `node` is always 'null'
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/logical/RelToStageConverter.java`
#### Snippet
```java
    } else if (node instanceof LogicalProject) {
      return convertLogicalProject((LogicalProject) node, currentStageId);
    } else if (node instanceof LogicalFilter) {
      return convertLogicalFilter((LogicalFilter) node, currentStageId);
    } else if (node instanceof LogicalAggregate) {
```

### ConstantValue
Value `node` is always 'null'
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/logical/RelToStageConverter.java`
#### Snippet
```java
    } else if (node instanceof LogicalFilter) {
      return convertLogicalFilter((LogicalFilter) node, currentStageId);
    } else if (node instanceof LogicalAggregate) {
      return convertLogicalAggregate((LogicalAggregate) node, currentStageId);
    } else if (node instanceof LogicalSort) {
```

### ConstantValue
Value `node` is always 'null'
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/logical/RelToStageConverter.java`
#### Snippet
```java
    } else if (node instanceof LogicalAggregate) {
      return convertLogicalAggregate((LogicalAggregate) node, currentStageId);
    } else if (node instanceof LogicalSort) {
      return convertLogicalSort((LogicalSort) node, currentStageId);
    } else if (node instanceof LogicalValues) {
```

### ConstantValue
Value `node` is always 'null'
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/logical/RelToStageConverter.java`
#### Snippet
```java
    } else if (node instanceof LogicalSort) {
      return convertLogicalSort((LogicalSort) node, currentStageId);
    } else if (node instanceof LogicalValues) {
      return convertLogicalValues((LogicalValues) node, currentStageId);
    } else if (node instanceof LogicalWindow) {
```

### ConstantValue
Value `node` is always 'null'
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/logical/RelToStageConverter.java`
#### Snippet
```java
    } else if (node instanceof LogicalValues) {
      return convertLogicalValues((LogicalValues) node, currentStageId);
    } else if (node instanceof LogicalWindow) {
      return convertLogicalWindow((LogicalWindow) node, currentStageId);
    } else if (node instanceof SetOp) {
```

### ConstantValue
Value `node` is always 'null'
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/logical/RelToStageConverter.java`
#### Snippet
```java
    } else if (node instanceof LogicalWindow) {
      return convertLogicalWindow((LogicalWindow) node, currentStageId);
    } else if (node instanceof SetOp) {
      return convertLogicalSetOp((SetOp) node, currentStageId);
    } else {
```

### ConstantValue
Value `node` is always 'null'
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/logical/RelToStageConverter.java`
#### Snippet
```java
      return convertLogicalSetOp((SetOp) node, currentStageId);
    } else {
      throw new UnsupportedOperationException("Unsupported logical plan node: " + node);
    }
  }
```

### ConstantValue
Value `rowType` is always 'null'
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/logical/RelToStageConverter.java`
#### Snippet
```java
      return new DataSchema(columnNames, columnDataTypes);
    } else {
      throw new IllegalArgumentException("Unsupported RelDataType: " + rowType);
    }
  }
```

### ConstantValue
Value `rexNode` is always 'null'
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/logical/RexExpression.java`
#### Snippet
```java
    if (rexNode instanceof RexInputRef) {
      return new RexExpression.InputRef(((RexInputRef) rexNode).getIndex());
    } else if (rexNode instanceof RexLiteral) {
      RexLiteral rexLiteral = ((RexLiteral) rexNode);
      FieldSpec.DataType dataType = RelToStageConverter.convertToFieldSpecDataType(rexLiteral.getType());
```

### ConstantValue
Value `rexNode` is always 'null'
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/logical/RexExpression.java`
#### Snippet
```java
      FieldSpec.DataType dataType = RelToStageConverter.convertToFieldSpecDataType(rexLiteral.getType());
      return new RexExpression.Literal(dataType, toRexValue(dataType, rexLiteral.getValue()));
    } else if (rexNode instanceof RexCall) {
      RexCall rexCall = (RexCall) rexNode;
      return toRexExpression(rexCall);
```

### ConstantValue
Condition `e instanceof SerializationException` is always `true`
in `pinot-plugins/pinot-input-format/pinot-confluent-avro/src/main/java/org/apache/pinot/plugin/inputformat/avro/confluent/KafkaConfluentSchemaRegistryAvroMessageDecoder.java`
#### Snippet
```java

  private boolean isUnknownMagicByte(Throwable e) {
    return e != null && e instanceof SerializationException && e.getMessage() != null && e.getMessage().toLowerCase()
        .contains("unknown magic byte");
  }
```

### ConstantValue
Condition `value instanceof GenericFixed` is always `false`
in `pinot-plugins/pinot-input-format/pinot-avro-base/src/main/java/org/apache/pinot/plugin/inputformat/avro/AvroRecordExtractor.java`
#### Snippet
```java
      return Timestamp.from((Instant) value);
    }
    if (value instanceof GenericFixed) {
      return ((GenericFixed) value).bytes();
    }
```

### ConstantValue
Value `function` is always 'null'
in `pinot-query-planner/src/main/java/org/apache/calcite/prepare/PinotCalciteCatalogReader.java`
#### Snippet
```java
      return new SqlUserDefinedFunction(name, kind, returnTypeInference,
          operandTypeInference, operandMetadata, function);
    } else if (function instanceof AggregateFunction) {
      final SqlReturnTypeInference returnTypeInference =
          infer((AggregateFunction) function);
```

### ConstantValue
Value `function` is always 'null'
in `pinot-query-planner/src/main/java/org/apache/calcite/prepare/PinotCalciteCatalogReader.java`
#### Snippet
```java
          operandMetadata, (AggregateFunction) function, false, false,
          Optionality.FORBIDDEN);
    } else if (function instanceof TableMacro) {
      return new SqlUserDefinedTableMacro(name, kind, ReturnTypes.CURSOR,
          operandTypeInference, operandMetadata, (TableMacro) function);
```

### ConstantValue
Value `function` is always 'null'
in `pinot-query-planner/src/main/java/org/apache/calcite/prepare/PinotCalciteCatalogReader.java`
#### Snippet
```java
      return new SqlUserDefinedTableMacro(name, kind, ReturnTypes.CURSOR,
          operandTypeInference, operandMetadata, (TableMacro) function);
    } else if (function instanceof TableFunction) {
      return new SqlUserDefinedTableFunction(name, kind, ReturnTypes.CURSOR,
          operandTypeInference, operandMetadata, (TableFunction) function);
```

### ConstantValue
Value `function` is always 'null'
in `pinot-query-planner/src/main/java/org/apache/calcite/prepare/PinotCalciteCatalogReader.java`
#### Snippet
```java
          operandTypeInference, operandMetadata, (TableFunction) function);
    } else {
      throw new AssertionError("unknown function type " + function);
    }
  }
```

### ConstantValue
Value `function` is always 'null'
in `pinot-query-planner/src/main/java/org/apache/calcite/prepare/PinotCalciteCatalogReader.java`
#### Snippet
```java
      predicate = function ->
          function instanceof TableMacro
              || function instanceof TableFunction;
    } else {
      predicate = function ->
```

### ConstantValue
Value `function` is always 'null'
in `pinot-query-planner/src/main/java/org/apache/calcite/prepare/PinotCalciteCatalogReader.java`
#### Snippet
```java
      predicate = function ->
          !(function instanceof TableMacro
              || function instanceof TableFunction);
    }
    getFunctionsFrom(opName.names)
```

### ConstantValue
Condition `tsLastPurge != null` is always `true`
in `pinot-plugins/pinot-minion-tasks/pinot-minion-builtin-tasks/src/main/java/org/apache/pinot/plugin/minion/tasks/purge/PurgeTaskGenerator.java`
#### Snippet
```java
          continue;
        }
        if ((tsLastPurge != null) && ((System.currentTimeMillis() - tsLastPurge) < purgeDeltaMs)) {
          //skip if purge delay is not reached
          continue;
```

### ConstantValue
Value `sqlNode` is always 'null'
in `pinot-common/src/main/java/org/apache/pinot/sql/parsers/CalciteSqlParser.java`
#### Snippet
```java
      selectNode.setOffset(orderByNode.offset);
    } else {
      selectNode = (SqlSelect) sqlNode;
    }

```

### ConstantValue
Value `left` is always 'null'
in `pinot-common/src/main/java/org/apache/pinot/sql/parsers/CalciteSqlParser.java`
#### Snippet
```java
          tableNames.addAll(((SqlIdentifier) left).names);
        } else {
          tableNames.addAll(extractTableNamesFromNode(left));
        }
        if (right instanceof SqlIdentifier) {
```

### ConstantValue
Value `right` is always 'null'
in `pinot-common/src/main/java/org/apache/pinot/sql/parsers/CalciteSqlParser.java`
#### Snippet
```java
          tableNames.addAll(((SqlIdentifier) right).names);
        } else {
          tableNames.addAll(extractTableNamesFromNode(right));
        }
      } else if ((fromNode instanceof SqlBasicCall)
```

### ConstantValue
Condition `(fromNode instanceof SqlBasicCall) && (((SqlBasicCall) fromNode).getOperator() instanceof ...` is always `false`
in `pinot-common/src/main/java/org/apache/pinot/sql/parsers/CalciteSqlParser.java`
#### Snippet
```java
          tableNames.addAll(extractTableNamesFromNode(right));
        }
      } else if ((fromNode instanceof SqlBasicCall)
          && (((SqlBasicCall) fromNode).getOperator() instanceof SqlAsOperator)) {
        tableNames.addAll(extractTableNamesFromNode(((SqlBasicCall) fromNode).getOperandList().get(0)));
      } else {
```

### ConstantValue
Value `fromNode` is always 'null'
in `pinot-common/src/main/java/org/apache/pinot/sql/parsers/CalciteSqlParser.java`
#### Snippet
```java
          tableNames.addAll(extractTableNamesFromNode(right));
        }
      } else if ((fromNode instanceof SqlBasicCall)
          && (((SqlBasicCall) fromNode).getOperator() instanceof SqlAsOperator)) {
        tableNames.addAll(extractTableNamesFromNode(((SqlBasicCall) fromNode).getOperandList().get(0)));
```

### ConstantValue
Value `fromNode` is always 'null'
in `pinot-common/src/main/java/org/apache/pinot/sql/parsers/CalciteSqlParser.java`
#### Snippet
```java
        tableNames.addAll(extractTableNamesFromNode(((SqlBasicCall) fromNode).getOperandList().get(0)));
      } else {
        tableNames.addAll(((SqlIdentifier) fromNode).names);
        tableNames.addAll(extractTableNamesFromNode(((SqlSelect) sqlNode).getWhere()));
      }
```

### ConstantValue
Value `sqlNode` is always 'null'
in `pinot-common/src/main/java/org/apache/pinot/sql/parsers/CalciteSqlParser.java`
#### Snippet
```java
        tableNames.addAll(extractTableNamesFromNode(((SqlSelect) sqlNode).getWhere()));
      }
    } else if (sqlNode instanceof SqlOrderBy) {
      for (SqlNode node : ((SqlOrderBy) sqlNode).getOperandList()) {
        tableNames.addAll(extractTableNamesFromNode(node));
```

### ConstantValue
Value `sqlNode` is always 'null'
in `pinot-common/src/main/java/org/apache/pinot/sql/parsers/CalciteSqlParser.java`
#### Snippet
```java
        tableNames.addAll(extractTableNamesFromNode(node));
      }
    } else if (sqlNode instanceof SqlBasicCall) {
      if (((SqlBasicCall) sqlNode).getOperator() instanceof SqlAsOperator) {
        SqlNode firstOperand = ((SqlBasicCall) sqlNode).getOperandList().get(0);
```

### ConstantValue
Value `sqlNode` is always 'null'
in `pinot-common/src/main/java/org/apache/pinot/sql/parsers/CalciteSqlParser.java`
#### Snippet
```java
        }
      }
    } else if (sqlNode instanceof SqlWith) {
      List<SqlNode> withList = ((SqlWith) sqlNode).withList;
      Set<String> aliases = new HashSet<>();
```

### ConstantValue
Value `sqlNode` is always 'null'
in `pinot-common/src/main/java/org/apache/pinot/sql/parsers/CalciteSqlParser.java`
#### Snippet
```java
      tableNames.addAll(extractTableNamesFromNode(((SqlWith) sqlNode).body));
      tableNames.removeAll(aliases);
    } else if (sqlNode instanceof SqlSetOption) {
      for (SqlNode node : ((SqlSetOption) sqlNode).getOperandList()) {
        tableNames.addAll(extractTableNamesFromNode(node));
```

### ConstantValue
Value `sqlNode` is always 'null'
in `pinot-common/src/main/java/org/apache/pinot/sql/parsers/CalciteSqlParser.java`
#### Snippet
```java
        tableNames.addAll(extractTableNamesFromNode(node));
      }
    } else if (sqlNode instanceof SqlExplain) {
      SqlExplain explain = (SqlExplain) sqlNode;
      tableNames.addAll(extractTableNamesFromNode(explain.getExplicandum()));
```

### ConstantValue
Value `childNode` is always 'null'
in `pinot-common/src/main/java/org/apache/pinot/sql/parsers/CalciteSqlParser.java`
#### Snippet
```java
        }
      } else {
        operands.add(toExpression(childNode));
      }
    }
```

### ConstantValue
Value `sqlNode` is always 'null'
in `pinot-common/src/main/java/org/apache/pinot/sql/parsers/CalciteSqlParser.java`
#### Snippet
```java
          throw new SqlCompilationException("SqlNode with executable statement already exist with type: " + sqlType);
        }
      } else if (sqlNode instanceof SqlSetOption) {
        // extract options, these are non-execution statements
        List<SqlNode> operandList = ((SqlSetOption) sqlNode).getOperandList();
```

### ConstantValue
Value `sqlNode` is always 'null'
in `pinot-common/src/main/java/org/apache/pinot/sql/parsers/CalciteSqlParser.java`
#### Snippet
```java
        if (sqlType == null) {
          sqlType = PinotSqlType.DQL;
          statementNode = sqlNode;
        } else {
          throw new SqlCompilationException("SqlNode with executable statement already exist with type: " + sqlType);
```

### ConstantValue
Value `sqlNode` is always 'null'
in `pinot-common/src/main/java/org/apache/pinot/common/utils/SqlResultComparator.java`
#### Snippet
```java
        selectNode.setOffset(orderByNode.offset);
      } else {
        selectNode = (SqlSelect) sqlNode;
      }
      return selectNode;
```

### ConstantValue
Value `idealState` is always 'null'
in `pinot-common/src/main/java/org/apache/pinot/common/utils/helix/HelixHelper.java`
#### Snippet
```java
      public IdealState apply(IdealState idealState) {
        if (idealState == null) {
          return idealState;
        }
        // partitionSet is never null but let's be defensive anyway
```

### ConstantValue
Value `idealState` is always 'null'
in `pinot-common/src/main/java/org/apache/pinot/common/utils/helix/HelixHelper.java`
#### Snippet
```java
      public IdealState apply(@Nullable IdealState idealState) {
        if (idealState == null) {
          return idealState;
        }
        // partitionSet is never null but let's be defensive anyway
```

### ConstantValue
Condition `zoneId .equals("ut")` is always `false`
in `pinot-common/src/main/java/org/apache/pinot/common/function/TimeZoneKey.java`
#### Snippet
```java

  private static boolean isUtcEquivalentName(String zoneId) {
    return zoneId.equals("utc") || zoneId.equals("z") || zoneId.equals("ut") || zoneId.equals("uct") || zoneId
        .equals("ut") || zoneId.equals("gmt") || zoneId.equals("gmt0") || zoneId.equals("greenwich") || zoneId
        .equals("universal") || zoneId.equals("zulu");
  }
```

### ConstantValue
Result of `Type.ROW.ordinal() << DataBlockUtils.VERSION_TYPE_SHIFT` is always '0'
in `pinot-common/src/main/java/org/apache/pinot/common/datablock/RowDataBlock.java`
#### Snippet
```java
  @Override
  protected int getDataBlockVersionType() {
    return VERSION + (Type.ROW.ordinal() << DataBlockUtils.VERSION_TYPE_SHIFT);
  }

```

### ConstantValue
Condition `e instanceof ProcessingException` is always `false`
in `pinot-common/src/main/java/org/apache/pinot/common/datablock/DataBlockUtils.java`
#### Snippet
```java

  public static MetadataBlock getErrorDataBlock(Exception e) {
    if (e instanceof ProcessingException) {
      return getErrorDataBlock(Collections.singletonMap(((ProcessingException) e).getErrorCode(), extractErrorMsg(e)));
    } else {
```

### ConstantValue
Condition `!found` is always `true`
in `pinot-core/src/main/java/org/apache/pinot/core/util/SortedRangeIntersection.java`
#### Snippet
```java
        }
        boolean found = false;
        while (!found && currentRangeSetIndex[j] < sortedRangeSetList.get(j).size()) {
          IntPair range = sortedRangeSetList.get(j).get(currentRangeSetIndex[j]);
          if (maxHead >= range.getLeft() && maxHead <= range.getRight()) {
```

### ConstantValue
Value `gapfillType` is always 'null'
in `pinot-core/src/main/java/org/apache/pinot/core/util/GapfillUtils.java`
#### Snippet
```java

    if (gapfillType == null) {
      return gapfillType;
    }

```

### ConstantValue
Condition `comparison >= 0` is always `true`
in `pinot-core/src/main/java/org/apache/pinot/core/query/scheduler/MultiLevelPriorityQueue.java`
#### Snippet
```java
        continue;
      }
      if (comparison >= 0) {
        if (group.totalReservedThreads() < _resourceManager.getTableThreadsSoftLimit()
            || group.totalReservedThreads() < currentWinnerGroup.totalReservedThreads()) {
```

### ConstantValue
Condition `spareThreads >= 1` is always `true`
in `pinot-core/src/main/java/org/apache/pinot/core/query/scheduler/resources/PolicyBasedResourceManager.java`
#### Snippet
```java
      spareThreads = Math.min(spareThreads, queryThreadLimit);
    }
    Preconditions.checkState(spareThreads >= 1);
    // We do not bound number of threads here by total available threads. We can potentially
    // over-provision number of threads here. That is intentional and (potentially) good solution.
```

### ConstantValue
Condition `result instanceof Collection` is always `false`
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/SegmentPartitionedDistinctCountAggregationFunction.java`
#### Snippet
```java
      return ((RoaringBitmap) result).getLongCardinality();
    }
    assert result instanceof Collection;
    return ((Collection<?>) result).size();
  }
```

### ConstantValue
Value `docIds` is always 'null'
in `pinot-core/src/main/java/org/apache/pinot/core/operator/filter/BitmapBasedFilterOperator.java`
#### Snippet
```java
          return new FilterBlock(new BitmapDocIdSet(mutableRoaringBitmap, _numDocs));
        } else {
          return new FilterBlock(new BitmapDocIdSet(ImmutableRoaringBitmap.flip(docIds, 0L, _numDocs), _numDocs));
        }
      } else {
```

### ConstantValue
Condition `rows instanceof List` is always `true`
in `pinot-core/src/main/java/org/apache/pinot/core/operator/combine/MinMaxValueBasedSelectionOrderByCombineOperator.java`
#### Snippet
```java
        } else {
          // Results from LinearSelectionOrderByOperator
          assert rows instanceof List;
          segmentBoundaryValue = (Comparable) ((List<Object[]>) rows).get(rows.size() - 1)[0];
        }
```

### ConstantValue
Condition `value instanceof Sketch` is always `false`
in `pinot-core/src/main/java/org/apache/pinot/core/common/ObjectSerDeUtils.java`
#### Snippet
```java
      } else if (value instanceof DistinctTable) {
        return ObjectType.DistinctTable;
      } else if (value instanceof Sketch) {
        return ObjectType.DataSketch;
      } else if (value instanceof Geometry) {
```

### ConstantValue
Condition `value instanceof Geometry` is always `false`
in `pinot-core/src/main/java/org/apache/pinot/core/common/ObjectSerDeUtils.java`
#### Snippet
```java
      } else if (value instanceof Sketch) {
        return ObjectType.DataSketch;
      } else if (value instanceof Geometry) {
        return ObjectType.Geometry;
      } else if (value instanceof RoaringBitmap) {
```

### ConstantValue
Condition `value instanceof RoaringBitmap` is always `false`
in `pinot-core/src/main/java/org/apache/pinot/core/common/ObjectSerDeUtils.java`
#### Snippet
```java
      } else if (value instanceof Geometry) {
        return ObjectType.Geometry;
      } else if (value instanceof RoaringBitmap) {
        return ObjectType.RoaringBitmap;
      } else if (value instanceof LongSet) {
```

### ConstantValue
Condition `bitmap != null` is always `true`
in `pinot-core/src/main/java/org/apache/pinot/core/operator/transform/function/ScalarTransformFunctionWrapper.java`
#### Snippet
```java
      }
    }
    if (bitmap != null && bitmap.isEmpty()) {
      return null;
    }
```

### ConstantValue
Condition `e instanceof TException` is always `true`
in `pinot-core/src/main/java/org/apache/pinot/core/transport/InstanceRequestHandler.java`
#### Snippet
```java
      submitQuery(queryRequest, ctx, tableNameWithType, queryArrivalTimeMs, instanceRequest);
    } catch (Exception e) {
      if (e instanceof TException) {
        // Deserialization exception
        _serverMetrics.addMeteredGlobalValue(ServerMeter.REQUEST_DESERIALIZATION_EXCEPTIONS, 1);
```

### ConstantValue
Condition `e instanceof SerializationException` is always `true`
in `pinot-plugins/pinot-input-format/pinot-protobuf/src/main/java/org/apache/pinot/plugin/inputformat/protobuf/KafkaConfluentSchemaRegistryProtoBufMessageDecoder.java`
#### Snippet
```java

  private boolean isUnknownMagicByte(Throwable e) {
    return e != null && e instanceof SerializationException && e.getMessage() != null && e.getMessage().toLowerCase()
        .contains("unknown magic byte");
  }
```

### ConstantValue
Value `iOException` is always 'null'
in `pinot-plugins/pinot-environment/pinot-azure/src/main/java/org/apache/pinot/plugin/provider/AzureEnvironmentProvider.java`
#### Snippet
```java
    final HttpRequestRetryHandler httpRequestRetryHandler =
        (iOException, executionCount, httpContext) -> !(executionCount >= _maxRetry
            || iOException instanceof InterruptedIOException || iOException instanceof UnknownHostException
            || iOException instanceof SSLException || HttpClientContext.adapt(httpContext)
            .getRequest() instanceof HttpEntityEnclosingRequest);
```

### ConstantValue
Value `iOException` is always 'null'
in `pinot-plugins/pinot-environment/pinot-azure/src/main/java/org/apache/pinot/plugin/provider/AzureEnvironmentProvider.java`
#### Snippet
```java
        (iOException, executionCount, httpContext) -> !(executionCount >= _maxRetry
            || iOException instanceof InterruptedIOException || iOException instanceof UnknownHostException
            || iOException instanceof SSLException || HttpClientContext.adapt(httpContext)
            .getRequest() instanceof HttpEntityEnclosingRequest);

```

### ConstantValue
Condition `numVal != null` is always `true`
in `pinot-clients/pinot-jdbc-client/src/main/java/org/apache/pinot/client/PinotConnection.java`
#### Snippet
```java
      try {
        Long numVal = Long.valueOf(str);
        if (numVal != null) {
            return numVal;
        }
```

### ConstantValue
Condition `numVal != null` is always `true`
in `pinot-clients/pinot-jdbc-client/src/main/java/org/apache/pinot/client/PinotConnection.java`
#### Snippet
```java
      try {
          Double numVal = Double.valueOf(str);
          if (numVal != null) {
              return numVal;
          }
```

### ConstantValue
Condition `boolVal != null` is always `true`
in `pinot-clients/pinot-jdbc-client/src/main/java/org/apache/pinot/client/PinotConnection.java`
#### Snippet
```java

      Boolean boolVal = Boolean.valueOf(str.toLowerCase());
      if (boolVal != null) {
          return boolVal;
      }
```

### ConstantValue
Condition `value == null` is always `false`
in `pinot-clients/pinot-jdbc-client/src/main/java/org/apache/pinot/client/PinotResultSet.java`
#### Snippet
```java
      throws SQLException {
    Integer value = getInt(columnIndex);
    return value == null ? null : value.shortValue();
  }

```

### ConstantValue
Value `trigger` is always 'null'
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotTaskRestletResource.java`
#### Snippet
```java
          triggerMap.put("NextFireTime", simpleTrigger.getNextFireTime());
          triggerMap.put("PreviousFireTime", simpleTrigger.getPreviousFireTime());
        } else if (trigger instanceof CronTrigger) {
          CronTrigger cronTrigger = (CronTrigger) trigger;
          triggerMap.put("TriggerType", CronTrigger.class.getSimpleName());
```

### ConstantValue
Condition `!tableRebalanceProgressStats.getStatus().equals(RebalanceResult.Status.DONE)` is always `true`
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotTableRestletResource.java`
#### Snippet
```java
            TableRebalanceProgressStats.class);
    long timeSinceStartInSecs = 0L;
    if (!tableRebalanceProgressStats.getStatus().equals(RebalanceResult.Status.DONE)) {
      timeSinceStartInSecs =
          (System.currentTimeMillis() - tableRebalanceProgressStats.getStartTimeMs()) / 1000;
```

### ConstantValue
Value `dryRun` is always 'false'
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/rebalance/TableRebalancer.java`
#### Snippet
```java
            instancePartitionsMap = getInstancePartitionsMap(tableConfig, reassignInstances, bootstrap, false);
            tierToInstancePartitionsMap =
                getTierToInstancePartitionsMap(tableConfig, sortedTiers, reassignInstances, bootstrap, dryRun);
            targetAssignment = segmentAssignment.rebalanceTable(currentAssignment, instancePartitionsMap, sortedTiers,
                tierToInstancePartitionsMap, rebalanceConfig);
```

### ConstantValue
Condition `predicateParseResult == null` is always `false`
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/rules/utils/QueryInvertedSortedIndexRecommender.java`
#### Snippet
```java
      PredicateParseResult predicateParseResult = parseLeafPredicate(filterContextTopLevel, NESTED_TOP_LEVEL);
      ArrayList<PredicateParseResult> ret = new ArrayList<>();
      if (predicateParseResult == null) {
        return EMPTY_PARSE_RESULT;
      } else {
```

### ConstantValue
Condition `newNumReplicas < currentNumReplicas` is always `true`
in `pinot-tools/src/main/java/org/apache/pinot/tools/PinotNumReplicaChanger.java`
#### Snippet
```java
      LOGGER.info("Number of replicas ({}) match in table definition and Idealstate. Nothing to do for {}",
          newNumReplicas, offlineTableName);
    } else if (newNumReplicas < currentNumReplicas) {
      if (_dryRun) {
        IdealState newIdealState = updateIdealState(currentIdealState, newNumReplicas);
```

### ConstantValue
Condition `dryRun` is always `true`
in `pinot-tools/src/main/java/org/apache/pinot/tools/PinotNumReplicaChanger.java`
#### Snippet
```java
    replicaChanger.changeNumReplicas(tableName);

    if (dryRun) {
      System.out.println("That was a dryrun");
    }
```

### ConstantValue
Value `_buffer` is always 'null'
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/memory/BasePinotLBuffer.java`
#### Snippet
```java
    if (_buffer instanceof LBuffer) {
      _buffer.release();
    } else if (_buffer instanceof MMapBuffer) {
      ((MMapBuffer) _buffer).close();
    }
```

### ConstantValue
Result of `hasAccess(requesterIdentity, (BrokerRequest) null)` is always 'true'
in `pinot-broker/src/main/java/org/apache/pinot/broker/broker/ZkBasicAuthAccessControlFactory.java`
#### Snippet
```java
        @Override
        public boolean hasAccess(RequesterIdentity requesterIdentity) {
            return hasAccess(requesterIdentity, (BrokerRequest) null);
        }

```

### ConstantValue
Value `result` is always 'true'
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkBloomFilter.java`
#### Snippet
```java
    Preconditions.checkArgument(result);

    return result;
  }
}
```

### ConstantValue
Value `result` is always 'true'
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkBloomFilter.java`
#### Snippet
```java
    Preconditions.checkArgument(result);

    return result;
  }

```

### ConstantValue
Value `geometry` is always 'null'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/H3Utils.java`
#### Snippet
```java
      potentialCover.add(H3_CORE.geoToH3(geometry.getCoordinate().y, geometry.getCoordinate().x, resolution));
      return Pair.of(new LongOpenHashSet(), potentialCover);
    } else if (geometry instanceof LineString) {
      LongSet potentialCover = new LongOpenHashSet();
      potentialCover.addAll(coverLineInH3(((LineString) geometry), resolution));
```

### ConstantValue
Value `geometry` is always 'null'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/H3Utils.java`
#### Snippet
```java
      potentialCover.addAll(coverLineInH3(((LineString) geometry), resolution));
      return Pair.of(new LongOpenHashSet(), potentialCover);
    } else if (geometry instanceof Polygon) {
      return coverPolygonInH3(((Polygon) geometry), resolution);
    } else if (geometry instanceof GeometryCollection) {
```

### ConstantValue
Value `geometry` is always 'null'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/H3Utils.java`
#### Snippet
```java
    } else if (geometry instanceof Polygon) {
      return coverPolygonInH3(((Polygon) geometry), resolution);
    } else if (geometry instanceof GeometryCollection) {
      LongOpenHashSet fullCover = new LongOpenHashSet();
      LongOpenHashSet potentialCover = new LongOpenHashSet();
```

### ConstantValue
Result of `temp ^ (temp >>> 32)` is always '0'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/mutablefst/MutableState.java`
#### Snippet
```java
    int result = _label;
    long temp = 0;
    result = 31 * result * ((int) (temp ^ (temp >>> 32)));
    result = 31 * result + (_arcs != null ? _arcs.hashCode() : 0);
    return result;
```

### ConstantValue
Result of `temp >>> 32` is always '0'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/mutablefst/MutableState.java`
#### Snippet
```java
    int result = _label;
    long temp = 0;
    result = 31 * result * ((int) (temp ^ (temp >>> 32)));
    result = 31 * result + (_arcs != null ? _arcs.hashCode() : 0);
    return result;
```

### ConstantValue
Value `createDictionary` is always 'false'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/creator/impl/SegmentColumnarIndexCreator.java`
#### Snippet
```java
    if (config.getRawIndexCreationColumns().contains(column) || config.getRawIndexCompressionType()
        .containsKey(column)) {
      return createDictionary;
    }

```

## RuleId[id=NonAtomicOperationOnVolatileField]
### NonAtomicOperationOnVolatileField
Non-atomic operation on volatile field `_currentOffset`
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/LLRealtimeSegmentDataManager.java`
#### Snippet
```java
  private void recreateStreamConsumer(String reason) {
    _segmentLogger.warn("Recreating stream consumer for topic partition {}, reason: {}", _clientId, reason);
    _currentOffset = _partitionGroupConsumer.checkpoint(_currentOffset);
    closePartitionGroupConsumer();
    _partitionGroupConsumer =
```

### NonAtomicOperationOnVolatileField
Non-atomic operation on volatile field `_consecutiveErrorCount`
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/LLRealtimeSegmentDataManager.java`
#### Snippet
```java
  private void handleTransientStreamErrors(Exception e)
      throws Exception {
    _consecutiveErrorCount++;
    _serverMetrics.addMeteredGlobalValue(ServerMeter.REALTIME_CONSUMPTION_EXCEPTIONS, 1L);
    _serverMetrics.addMeteredTableValue(_tableStreamName, ServerMeter.REALTIME_CONSUMPTION_EXCEPTIONS,
```

### NonAtomicOperationOnVolatileField
Non-atomic operation on volatile field `_consumeEndTime`
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/LLRealtimeSegmentDataManager.java`
#### Snippet
```java
          if (!_hasMessagesFetched) {
            _segmentLogger.info("No events came in, extending time by {} hours", TIME_EXTENSION_ON_EMPTY_SEGMENT_HOURS);
            _consumeEndTime += TimeUnit.HOURS.toMillis(TIME_EXTENSION_ON_EMPTY_SEGMENT_HOURS);
            return false;
          }
```

### NonAtomicOperationOnVolatileField
Non-atomic operation on volatile field `_numRowsErrored`
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/LLRealtimeSegmentDataManager.java`
#### Snippet
```java
            _serverMetrics.addMeteredTableValue(_clientId, ServerMeter.INVALID_REALTIME_ROWS_DROPPED, 1,
                realtimeRowsDroppedMeter);
        _numRowsErrored++;
      } else {
        try {
```

### NonAtomicOperationOnVolatileField
Non-atomic operation on volatile field `_numRowsErrored`
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/LLRealtimeSegmentDataManager.java`
#### Snippet
```java
          _transformPipeline.processRow(decodedRow.getResult(), reusedResult);
        } catch (Exception e) {
          _numRowsErrored++;
          // when exception happens we prefer abandoning the whole batch and not partially indexing some rows
          reusedResult.getTransformedRows().clear();
```

### NonAtomicOperationOnVolatileField
Non-atomic operation on volatile field `_numRowsErrored`
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/LLRealtimeSegmentDataManager.java`
#### Snippet
```java
                    realtimeRowsConsumedMeter);
          } catch (Exception e) {
            _numRowsErrored++;
            String errorMessage = String.format("Caught exception while indexing the record: %s", transformedRow);
            _segmentLogger.error(errorMessage, e);
```

### NonAtomicOperationOnVolatileField
Non-atomic operation on volatile field `_numRowsConsumed`
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/LLRealtimeSegmentDataManager.java`
#### Snippet
```java
      _currentOffset = messagesAndOffsets.getNextStreamPartitionMsgOffsetAtIndex(index);
      _numRowsIndexed = _realtimeSegment.getNumDocsIndexed();
      _numRowsConsumed++;
      streamMessageCount++;
    }
```

### NonAtomicOperationOnVolatileField
Non-atomic operation on volatile field `_currentOffset`
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/LLRealtimeSegmentDataManager.java`
#### Snippet
```java
            case COMMIT:
              _state = State.COMMITTING;
              _currentOffset = _partitionGroupConsumer.checkpoint(_currentOffset);
              long buildTimeSeconds = response.getBuildTimeSeconds();
              buildSegmentForCommit(buildTimeSeconds * 1000L);
```

### NonAtomicOperationOnVolatileField
Non-atomic operation on volatile field `_numInFlightRequests`
in `pinot-core/src/main/java/org/apache/pinot/core/transport/server/routing/stats/ServerRoutingStatsEntry.java`
#### Snippet
```java

  public void updateNumInFlightRequestsForQuerySubmission() {
    ++_numInFlightRequests;
    _inFlighRequestsEMA.compute(_numInFlightRequests);
  }
```

### NonAtomicOperationOnVolatileField
Non-atomic operation on volatile field `_numInFlightRequests`
in `pinot-core/src/main/java/org/apache/pinot/core/transport/server/routing/stats/ServerRoutingStatsEntry.java`
#### Snippet
```java

  public void updateNumInFlightRequestsForResponseArrival() {
    --_numInFlightRequests;
  }

```

### NonAtomicOperationOnVolatileField
Non-atomic operation on volatile field `_numFiles`
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/writer/impl/MmapMemoryManager.java`
#### Snippet
```java
      return;
    }
    String thisContext = getFilePrefix() + _numFiles++;
    String filePath;
    filePath = _dirPathName + "/" + thisContext;
```

### NonAtomicOperationOnVolatileField
Non-atomic operation on volatile field `_numValues`
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/column/NumValuesInfo.java`
#### Snippet
```java

  public void updateSVEntry() {
    _numValues++;
  }

```

### NonAtomicOperationOnVolatileField
Non-atomic operation on volatile field `_numValues`
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/column/NumValuesInfo.java`
#### Snippet
```java

  public void updateMVEntry(int numValuesInMVEntry) {
    _numValues += numValuesInMVEntry;
    _maxNumValuesPerMVEntry = Math.max(_maxNumValuesPerMVEntry, numValuesInMVEntry);
  }
```

### NonAtomicOperationOnVolatileField
Non-atomic operation on volatile field `_maxNumValuesPerMVEntry`
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/column/NumValuesInfo.java`
#### Snippet
```java
  public void updateMVEntry(int numValuesInMVEntry) {
    _numValues += numValuesInMVEntry;
    _maxNumValuesPerMVEntry = Math.max(_maxNumValuesPerMVEntry, numValuesInMVEntry);
  }

```

### NonAtomicOperationOnVolatileField
Non-atomic operation on volatile field `_latestIngestionTimeMs`
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/indexsegment/mutable/MutableSegmentImpl.java`
#### Snippet
```java
    _lastIndexedTimeMs = System.currentTimeMillis();
    if (rowMetadata != null) {
      _latestIngestionTimeMs = Math.max(_latestIngestionTimeMs, rowMetadata.getRecordIngestionTimeMs());
    }

```

## RuleId[id=StringConcatenationInsideStringBufferAppend]
### StringConcatenationInsideStringBufferAppend
String concatenation as argument to `StringBuilder.append()` call
in `pinot-spi/src/main/java/org/apache/pinot/spi/utils/builder/ControllerRequestURLBuilder.java`
#### Snippet
```java
    StringBuilder params = new StringBuilder();
    if (tableType != null) {
      params.append("?type=" + tableType);
    }
    if (state != null) {
```

### StringConcatenationInsideStringBufferAppend
String concatenation as argument to `StringBuilder.append()` call
in `pinot-spi/src/main/java/org/apache/pinot/spi/utils/builder/ControllerRequestURLBuilder.java`
#### Snippet
```java
        params.append("&");
      }
      params.append("?state=" + state);
    }
    return StringUtil.join("/", _baseUrl, "brokers", "tables", table, params.toString());
```

### StringConcatenationInsideStringBufferAppend
String concatenation as argument to `StringBuilder.append()` call
in `pinot-spi/src/main/java/org/apache/pinot/spi/utils/builder/ControllerRequestURLBuilder.java`
#### Snippet
```java
    StringBuilder params = new StringBuilder();
    if (StringUtils.isNotBlank(username)) {
      params.append("?component=" + componentTypeStr);
    }
    return StringUtil.join("/", _baseUrl, "users", username, params.toString());
```

### StringConcatenationInsideStringBufferAppend
String concatenation as argument to `StringBuilder.append()` call
in `pinot-spi/src/main/java/org/apache/pinot/spi/utils/builder/ControllerRequestURLBuilder.java`
#### Snippet
```java
    StringBuilder params = new StringBuilder();
    if (StringUtils.isNotBlank(username)) {
      params.append("?component=" + componentTypeStr);
    }
    params.append(String.format("&&passwordChanged=%s", passwordChanged));
```

### StringConcatenationInsideStringBufferAppend
String concatenation as argument to `StringBuffer.append()` call
in `pinot-core/src/main/java/org/apache/pinot/core/query/optimizer/statement/JsonStatementOptimizer.java`
#### Snippet
```java
        break;
      case STRING_VALUE:
        result.append("'" + literal.getStringValue() + "'");
        break;
      case BINARY_VALUE:
```

### StringConcatenationInsideStringBufferAppend
String concatenation as argument to `StringBuilder.append()` call
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/data/generator/DataGeneratorSpec.java`
#### Snippet
```java
    for (final String column : _columns) {
      if (_cardinalityMap.get(column) != null) {
        builder.append(column + " : " + _cardinalityMap.get(column) + " : " + _dataTypeMap.get(column));
      } else if (_rangeMap.get(column) != null) {
        builder.append(column + " : " + _rangeMap.get(column) + " : " + _dataTypeMap.get(column));
```

### StringConcatenationInsideStringBufferAppend
String concatenation as argument to `StringBuilder.append()` call
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/data/generator/DataGeneratorSpec.java`
#### Snippet
```java
        builder.append(column + " : " + _cardinalityMap.get(column) + " : " + _dataTypeMap.get(column));
      } else if (_rangeMap.get(column) != null) {
        builder.append(column + " : " + _rangeMap.get(column) + " : " + _dataTypeMap.get(column));
      } else {
        builder.append(column + " : " + _patternMap.get(column));
```

### StringConcatenationInsideStringBufferAppend
String concatenation as argument to `StringBuilder.append()` call
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/data/generator/DataGeneratorSpec.java`
#### Snippet
```java
        builder.append(column + " : " + _rangeMap.get(column) + " : " + _dataTypeMap.get(column));
      } else {
        builder.append(column + " : " + _patternMap.get(column));
      }
      builder.append(", ");
```

### StringConcatenationInsideStringBufferAppend
String concatenation as argument to `StringBuilder.append()` call
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/data/generator/DataGeneratorSpec.java`
#### Snippet
```java
      builder.append(", ");
    }
    builder.append("output file format : " + _outputFileFormat);
    builder.append(", output dir : " + _outputDir);
    return builder.toString();
```

### StringConcatenationInsideStringBufferAppend
String concatenation as argument to `StringBuilder.append()` call
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/data/generator/DataGeneratorSpec.java`
#### Snippet
```java
    }
    builder.append("output file format : " + _outputFileFormat);
    builder.append(", output dir : " + _outputDir);
    return builder.toString();
  }
```

### StringConcatenationInsideStringBufferAppend
String concatenation as argument to `StringBuilder.append()` call
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartServiceManagerCommand.java`
#### Snippet
```java
  public String toString() {
    StringBuilder sb = new StringBuilder()
        .append("StartServiceManager -clusterName " + _clusterName + " -zkAddress " + _zkAddress + " -port " + _port);
    if (_bootstrapConfigPaths != null) {
      sb.append(" -bootstrapConfigPaths " + Arrays.toString(_bootstrapConfigPaths));
```

### StringConcatenationInsideStringBufferAppend
String concatenation as argument to `StringBuilder.append()` call
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartServiceManagerCommand.java`
#### Snippet
```java
        .append("StartServiceManager -clusterName " + _clusterName + " -zkAddress " + _zkAddress + " -port " + _port);
    if (_bootstrapConfigPaths != null) {
      sb.append(" -bootstrapConfigPaths " + Arrays.toString(_bootstrapConfigPaths));
    } else if (_bootstrapServices != null) {
      sb.append(" -bootstrapServices " + Arrays.toString(_bootstrapServices));
```

### StringConcatenationInsideStringBufferAppend
String concatenation as argument to `StringBuilder.append()` call
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartServiceManagerCommand.java`
#### Snippet
```java
      sb.append(" -bootstrapConfigPaths " + Arrays.toString(_bootstrapConfigPaths));
    } else if (_bootstrapServices != null) {
      sb.append(" -bootstrapServices " + Arrays.toString(_bootstrapServices));
    }

```

### StringConcatenationInsideStringBufferAppend
String concatenation as argument to `StringBuilder.append()` call
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/FST.java`
#### Snippet
```java

    fst.visitInPreOrder(state -> {
      b.append("state : " + state).append("\n");
      for (int arc = fst.getFirstArc(state); arc != 0; arc = fst.getNextArc(arc)) {
        b.append(
```

### StringConcatenationInsideStringBufferAppend
String concatenation as argument to `StringBuilder.append()` call
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/FST.java`
#### Snippet
```java
      b.append("state : " + state).append("\n");
      for (int arc = fst.getFirstArc(state); arc != 0; arc = fst.getNextArc(arc)) {
        b.append(
            " { arc: " + arc + " targetNode: " + (fst.isArcFinal(arc) ? "final arc" : fst.getEndNode(arc)) + " label: "
                + (char) fst.getArcLabel(arc) + " }");
```

### StringConcatenationInsideStringBufferAppend
String concatenation as argument to `StringBuilder.append()` call
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/creator/impl/inv/RangeIndexCreator.java`
#### Snippet
```java
    StringBuilder docIdAsString = new StringBuilder("DocIdBuffer  [ ");
    for (int i = 0; i < _numValues; i++) {
      docIdAsString.append(_docIdBuffer.get(i) + ", ");
    }
    docIdAsString.append("]");
```

### StringConcatenationInsideStringBufferAppend
String concatenation as argument to `StringBuilder.append()` call
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/creator/impl/inv/RangeIndexCreator.java`
#### Snippet
```java
    StringBuilder valuesAsString = new StringBuilder("ValueBuffer  [ ");
    for (int i = 0; i < _numValues; i++) {
      valuesAsString.append(_numberValueBuffer.get(i) + ", ");
    }
    valuesAsString.append("] ");
```

### StringConcatenationInsideStringBufferAppend
String concatenation as argument to `StringBuilder.append()` call
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/realtime/impl/RealtimeSegmentStatsHistory.java`
#### Snippet
```java
    public String toString() {
      StringBuilder sb = new StringBuilder();
      sb.append("nRows=" + getNumRowsConsumed()).append(",nMinutes=" + getNumSeconds())
          .append(",memUsed=" + getMemUsedBytes());

```

### StringConcatenationInsideStringBufferAppend
String concatenation as argument to `StringBuilder.append()` call
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/realtime/impl/RealtimeSegmentStatsHistory.java`
#### Snippet
```java
    public String toString() {
      StringBuilder sb = new StringBuilder();
      sb.append("nRows=" + getNumRowsConsumed()).append(",nMinutes=" + getNumSeconds())
          .append(",memUsed=" + getMemUsedBytes());

```

### StringConcatenationInsideStringBufferAppend
String concatenation as argument to `StringBuilder.append()` call
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/realtime/impl/RealtimeSegmentStatsHistory.java`
#### Snippet
```java
      StringBuilder sb = new StringBuilder();
      sb.append("nRows=" + getNumRowsConsumed()).append(",nMinutes=" + getNumSeconds())
          .append(",memUsed=" + getMemUsedBytes());

      for (Map.Entry<String, ColumnStats> entry : _colNameToStats.entrySet()) {
```

### StringConcatenationInsideStringBufferAppend
String concatenation as argument to `StringBuilder.append()` call
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/customobject/QuantileDigest.java`
#### Snippet
```java

    for (Map.Entry<Integer, Collection<Node>> entry : nodesByLevel.asMap().entrySet()) {
      builder.append("\tsubgraph level_" + entry.getKey() + " {\n").append("\t\trank = same;\n");

      for (Node node : entry.getValue()) {
```

## RuleId[id=OptionalIsPresent]
### OptionalIsPresent
Can be replaced with single expression in functional style
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/rules/impl/InvertedSortedIndexJointRule.java`
#### Snippet
```java
      return Pair.of(nESIWithIdx, fixedLenBitset);
    }).min(Comparator.comparing(Pair::getLeft));
    if (optimal.isPresent()) {
      return PredicateParseResult.PredicateParseResultBuilder.aPredicateParseResult()
          .setCandidateDims(optimal.get().getRight())
```

## RuleId[id=UNCHECKED_WARNING]
### UNCHECKED_WARNING
Unchecked assignment: 'java.util.ArrayList' to 'java.util.List'
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/logical/LogicalPlanner.java`
#### Snippet
```java
  public LogicalPlanner(HepProgram program, Context context) {
    super(program, context);
    _traitDefs = new ArrayList();
  }

```

### UNCHECKED_WARNING
Unchecked assignment: 'java.util.ArrayList' to 'java.util.ArrayList'
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-hadoop/src/main/java/org/apache/pinot/plugin/ingestion/batch/hadoop/HadoopSegmentGenerationJobRunner.java`
#### Snippet
```java
    }

    ArrayList<File> validPluginDirectories = new ArrayList();

    for (String pluginsDirPath : pluginDirectories) {
```

### UNCHECKED_WARNING
Unchecked assignment: 'java.util.HashSet' to 'java.util.Set'
in `pinot-query-planner/src/main/java/org/apache/calcite/rel/rules/PinotWindowExchangeNodeInsertRule.java`
#### Snippet
```java

    if (windowGroup.orderKeys.getKeys().size() == windowGroup.keys.asList().size()) {
      Set<Integer> partitionByKeyList = new HashSet<>(windowGroup.keys.toList());
      Set<Integer> orderByKeyList = new HashSet<>(windowGroup.orderKeys.getKeys());
      isPartitionByOnly = partitionByKeyList.equals(orderByKeyList);
```

### UNCHECKED_WARNING
Unchecked assignment: 'java.util.HashSet' to 'java.util.Set'
in `pinot-query-planner/src/main/java/org/apache/calcite/rel/rules/PinotWindowExchangeNodeInsertRule.java`
#### Snippet
```java
    if (windowGroup.orderKeys.getKeys().size() == windowGroup.keys.asList().size()) {
      Set<Integer> partitionByKeyList = new HashSet<>(windowGroup.keys.toList());
      Set<Integer> orderByKeyList = new HashSet<>(windowGroup.orderKeys.getKeys());
      isPartitionByOnly = partitionByKeyList.equals(orderByKeyList);
    }
```

### UNCHECKED_WARNING
Unchecked assignment: 'java.util.ArrayList' to 'java.util.List'
in `pinot-query-planner/src/main/java/org/apache/calcite/rel/rules/PinotReduceAggregateFunctionsRule.java`
#### Snippet
```java
    final RelBuilder relBuilder = ruleCall.builder();
    relBuilder.push(oldAggRel.getInput());
    final List<RexNode> inputExprs = new ArrayList<>(relBuilder.fields());

    // create new aggregate function calls and rest of project list together
```

### UNCHECKED_WARNING
Unchecked assignment: 'org.apache.pinot.plugin.metrics.dropwizard.DropwizardSettableGauge' to 'org.apache.pinot.plugin.metrics.dropwizard.DropwizardSettableGauge'
in `pinot-plugins/pinot-metrics/pinot-dropwizard/src/main/java/org/apache/pinot/plugin/metrics/dropwizard/DropwizardMetricsRegistry.java`
#### Snippet
```java
  public <T> PinotGauge<T> newGauge(PinotMetricName name, final PinotGauge<T> gauge) {
    final String metricName = name.getMetricName().toString();
    return (gauge == null) ? new DropwizardGauge<T>((DropwizardSettableGauge) _metricRegistry.gauge(metricName))
        : new DropwizardGauge<T>(_metricRegistry.gauge(metricName, () -> (DropwizardSettableGauge) gauge.getGauge()));
  }
```

### UNCHECKED_WARNING
Unchecked assignment: 'org.apache.pinot.plugin.metrics.dropwizard.DropwizardSettableGauge' to 'org.apache.pinot.plugin.metrics.dropwizard.DropwizardSettableGauge'
in `pinot-plugins/pinot-metrics/pinot-dropwizard/src/main/java/org/apache/pinot/plugin/metrics/dropwizard/DropwizardMetricsRegistry.java`
#### Snippet
```java
    final String metricName = name.getMetricName().toString();
    return (gauge == null) ? new DropwizardGauge<T>((DropwizardSettableGauge) _metricRegistry.gauge(metricName))
        : new DropwizardGauge<T>(_metricRegistry.gauge(metricName, () -> (DropwizardSettableGauge) gauge.getGauge()));
  }

```

### UNCHECKED_WARNING
Unchecked assignment: 'java.util.Map' to 'java.util.Map'
in `pinot-spi/src/main/java/org/apache/pinot/spi/data/readers/BaseRecordExtractor.java`
#### Snippet
```java
  @Nullable
  protected Object convertMap(Object value) {
    Map<Object, Object> map = (Map) value;
    if (map.isEmpty()) {
      return null;
```

### UNCHECKED_WARNING
Unchecked assignment: 'java.util.ArrayList' to 'java.util.ArrayList'
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-spark-3.2/src/main/java/org/apache/pinot/plugin/ingestion/batch/spark3/SparkSegmentGenerationJobRunner.java`
#### Snippet
```java
    }

    ArrayList<File> validPluginDirectories = new ArrayList();

    for (String pluginsDirPath : pluginDirectories) {
```

### UNCHECKED_WARNING
Unchecked assignment: 'java.lang.Class' to 'java.lang.Class'
in `pinot-spi/src/main/java/org/apache/pinot/spi/data/readers/RecordReaderFactory.java`
#### Snippet
```java
    Class recordReaderConfigClass = PluginManager.get().loadClass(recordReaderConfigClassName);
    RecordReaderConfig recordReaderConfig =
        (RecordReaderConfig) JsonUtils.fileToObject(readerConfigFile, recordReaderConfigClass);
    return recordReaderConfig;
  }
```

### UNCHECKED_WARNING
Unchecked cast: 'java.lang.Object' to 'java.util.Map'
in `pinot-spi/src/main/java/org/apache/pinot/spi/data/readers/GenericRow.java`
#### Snippet
```java
      return null;
    } else if (value instanceof Map) {
      Map<String, Object> map = new HashMap<>((Map<String, Object>) value);
      for (Map.Entry<String, Object> entry : map.entrySet()) {
        entry.setValue(copy(entry.getValue()));
```

### UNCHECKED_WARNING
Unchecked call to 'add(E)' as a member of raw type 'java.util.List'
in `pinot-spi/src/main/java/org/apache/pinot/spi/data/readers/GenericRow.java`
#### Snippet
```java
      List list = new ArrayList(((Collection) value).size());
      for (Object object : (Collection) value) {
        list.add(copy(object));
      }
      return list;
```

### UNCHECKED_WARNING
Unchecked assignment: 'java.util.Map' to 'java.util.Map'
in `pinot-spi/src/main/java/org/apache/pinot/spi/data/readers/GenericRow.java`
#### Snippet
```java
  public static GenericRow fromBytes(byte[] buffer)
      throws IOException {
    Map<String, Object> fieldMap = JsonUtils.bytesToObject(buffer, Map.class);
    GenericRow genericRow = new GenericRow();
    genericRow.init(fieldMap);
```

### UNCHECKED_WARNING
Unchecked cast: 'capture' to 'T'
in `pinot-spi/src/main/java/org/apache/pinot/spi/config/ConfigUtils.java`
#### Snippet
```java
    }
    try {
      return (T) JsonUtils.jsonNodeToObject(jsonNode, config.getClass());
    } catch (IOException e) {
      throw new RuntimeException(String
```

### UNCHECKED_WARNING
Unchecked call to 'StreamMessage(T, int)' as a member of raw type 'org.apache.pinot.spi.stream.StreamMessage'
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/MessageBatch.java`
#### Snippet
```java
  class LegacyStreamMessage extends StreamMessage {
    public LegacyStreamMessage(byte[] value) {
      super(value, value.length);
    }
  }
```

### UNCHECKED_WARNING
Unchecked assignment: 'org.apache.pinot.spi.stream.MessageBatch.LegacyStreamMessage' to 'org.apache.pinot.spi.stream.StreamMessage'
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/MessageBatch.java`
#### Snippet
```java

  default StreamMessage<T> getStreamMessage(int index) {
    return new LegacyStreamMessage(getMessageBytesAtIndex(index));
  }

```

### UNCHECKED_WARNING
Unchecked call to 'decode(T, int, int, GenericRow)' as a member of raw type 'org.apache.pinot.spi.stream.StreamMessageDecoder'
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/StreamDataDecoderImpl.java`
#### Snippet
```java
    try {
      _reuse.clear();
      GenericRow row = _valueDecoder.decode(message.getValue(), 0, message.getLength(), _reuse);
      if (row != null) {
        if (message.getKey() != null) {
```

### UNCHECKED_WARNING
Unchecked call to 'init(Map, Set, String)' as a member of raw type 'org.apache.pinot.spi.stream.StreamMessageDecoder'
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/StreamDecoderProvider.java`
#### Snippet
```java
    try {
      StreamMessageDecoder decoder = PluginManager.get().createInstance(decoderClass);
      decoder.init(decoderProperties, fieldsToRead, streamConfig.getTopicName());
      return decoder;
    } catch (Exception e) {
```

### UNCHECKED_WARNING
Unchecked cast: 'java.lang.Class\>' to 'java.lang.Class'
in `pinot-spi/src/main/java/org/apache/pinot/spi/plugin/PluginManager.java`
#### Snippet
```java
    PluginClassLoader pluginClassLoader = PLUGIN_MANAGER._registry.get(new Plugin(pluginName));
    Class<T> loadedClass =
        (Class<T>) pluginClassLoader.loadClass(loadClassWithBackwardCompatibleCheck(className), true);
    Constructor<?> constructor;
    constructor = loadedClass.getConstructor(argTypes);
```

### UNCHECKED_WARNING
Unchecked cast: 'java.lang.Object' to 'T'
in `pinot-spi/src/main/java/org/apache/pinot/spi/plugin/PluginManager.java`
#### Snippet
```java
    constructor = loadedClass.getConstructor(argTypes);
    Object instance = constructor.newInstance(argValues);
    return (T) instance;
  }

```

### UNCHECKED_WARNING
Unchecked cast: 'java.lang.Class\>' to 'java.lang.Class'
in `pinot-spi/src/main/java/org/apache/pinot/spi/metrics/PinotMetricUtils.java`
#### Snippet
```java
        try {
          Class<? extends MetricsRegistryRegistrationListener> clazz =
              (Class<? extends MetricsRegistryRegistrationListener>) Class.forName(listenerClassName);
          Constructor<? extends MetricsRegistryRegistrationListener> defaultConstructor =
              clazz.getDeclaredConstructor();
```

### UNCHECKED_WARNING
Unchecked assignment: 'java.util.Map' to 'java.util.Map'
in `pinot-spi/src/main/java/org/apache/pinot/spi/ingestion/batch/IngestionJobLauncher.java`
#### Snippet
```java
      }
    }
    Map<String, Object> propertiesMap = (Map) properties;
    if (environmentValues != null) {
      for (String propertyName: propertiesMap.keySet()) {
```

### UNCHECKED_WARNING
Unchecked call to 'StreamMessage(byte\[\], T, StreamMessageMetadata, int)' as a member of raw type 'org.apache.pinot.spi.stream.StreamMessage'
in `pinot-plugins/pinot-stream-ingestion/pinot-kafka-2.0/src/main/java/org/apache/pinot/plugin/stream/kafka20/KafkaStreamMessage.java`
#### Snippet
```java
public class KafkaStreamMessage extends StreamMessage {
  public KafkaStreamMessage(@Nullable byte[] key, byte[] value, @Nullable StreamMessageMetadata metadata) {
    super(key, value, metadata, value.length);
  }

```

### UNCHECKED_WARNING
Unchecked call to 'decode(T, GenericRow)' as a member of raw type 'org.apache.pinot.spi.stream.StreamMessageDecoder'
in `pinot-plugins/pinot-stream-ingestion/pinot-kafka-2.0/src/main/java/org/apache/pinot/plugin/stream/kafka20/KafkaStreamLevelConsumer.java`
#### Snippet
```java
        final ConsumerRecord<Bytes, Bytes> record = _kafkaIterator.next();
        updateOffsets(record.partition(), record.offset());
        destination = _messageDecoder.decode(record.value().get(), destination);

        _currentCount++;
```

### UNCHECKED_WARNING
Unchecked assignment: 'org.apache.pinot.plugin.stream.kafka20.KafkaStreamMessage' to 'org.apache.pinot.spi.stream.StreamMessage'
in `pinot-plugins/pinot-stream-ingestion/pinot-kafka-2.0/src/main/java/org/apache/pinot/plugin/stream/kafka20/KafkaPartitionLevelConsumer.java`
#### Snippet
```java
          String key = messageAndOffset.key();
          byte[] keyBytes = key != null ? key.getBytes(StandardCharsets.UTF_8) : null;
          filtered.add(new KafkaStreamMessage(keyBytes, message.get(), rowMetadata));
        } else if (LOGGER.isDebugEnabled()) {
          LOGGER.debug("Tombstone message at offset: {}", offset);
```

### UNCHECKED_WARNING
Unchecked overriding: return type requires unchecked conversion. Found 'org.apache.pinot.spi.stream.StreamMessage', required 'org.apache.pinot.spi.stream.StreamMessage'
in `pinot-plugins/pinot-stream-ingestion/pinot-kafka-2.0/src/main/java/org/apache/pinot/plugin/stream/kafka20/KafkaMessageBatch.java`
#### Snippet
```java

  @Override
  public StreamMessage getMessageAtIndex(int index) {
    return _messageList.get(index);
  }
```

### UNCHECKED_WARNING
Unchecked overriding: return type requires unchecked conversion. Found 'org.apache.pinot.spi.stream.StreamMessage', required 'org.apache.pinot.spi.stream.StreamMessage\>'
in `pinot-plugins/pinot-stream-ingestion/pinot-kafka-2.0/src/main/java/org/apache/pinot/plugin/stream/kafka20/KafkaMessageBatch.java`
#### Snippet
```java

  @Override
  public StreamMessage getStreamMessage(int index) {
    return _messageList.get(index);
  }
```

### UNCHECKED_WARNING
Unchecked cast: 'java.lang.Class\>' to 'java.lang.Class'
in `pinot-common/src/main/java/org/apache/pinot/sql/parsers/rewriter/QueryRewriterFactory.java`
#### Snippet
```java
  private static QueryRewriter getQueryRewriter(String queryRewriterClassName)
      throws Exception {
    final Class<QueryRewriter> queryRewriterClass = (Class<QueryRewriter>) Class.forName(queryRewriterClassName);
    return (QueryRewriter) queryRewriterClass.getDeclaredConstructors()[0].newInstance();
  }
```

### UNCHECKED_WARNING
Unchecked assignment: 'java.util.ArrayList' to 'java.util.List'
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
    NameValuePair tableNameValuePair = new BasicNameValuePair(QueryParameters.TABLE_NAME, tableName);
    NameValuePair tableTypeValuePair = new BasicNameValuePair(QueryParameters.TABLE_TYPE, tableType.name());
    parameters = parameters == null ? new ArrayList<>() : new ArrayList<>(parameters);
    parameters.add(tableNameValuePair);
    parameters.add(tableTypeValuePair);
```

### UNCHECKED_WARNING
Unchecked call to 'ArrayList(Collection)' as a member of raw type 'java.util.ArrayList'
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
    NameValuePair tableNameValuePair = new BasicNameValuePair(QueryParameters.TABLE_NAME, tableName);
    NameValuePair tableTypeValuePair = new BasicNameValuePair(QueryParameters.TABLE_TYPE, tableType.name());
    parameters = parameters == null ? new ArrayList<>() : new ArrayList<>(parameters);
    parameters.add(tableNameValuePair);
    parameters.add(tableTypeValuePair);
```

### UNCHECKED_WARNING
Unchecked assignment: 'java.util.HashSet' to 'java.util.Set'
in `pinot-common/src/main/java/org/apache/pinot/common/utils/helix/HelixHelper.java`
#### Snippet
```java
  public static Set<InstanceConfig> getBrokerInstanceConfigsForTenant(List<InstanceConfig> instanceConfigs,
      String tenant) {
    return new HashSet<>(getInstancesConfigsWithTag(instanceConfigs, TagNameUtils.getBrokerTagForTenant(tenant)));
  }

```

### UNCHECKED_WARNING
Unchecked call to 'HashSet(Collection)' as a member of raw type 'java.util.HashSet'
in `pinot-common/src/main/java/org/apache/pinot/common/utils/helix/HelixHelper.java`
#### Snippet
```java
  public static Set<InstanceConfig> getBrokerInstanceConfigsForTenant(List<InstanceConfig> instanceConfigs,
      String tenant) {
    return new HashSet<>(getInstancesConfigsWithTag(instanceConfigs, TagNameUtils.getBrokerTagForTenant(tenant)));
  }

```

### UNCHECKED_WARNING
Unchecked cast: 'java.util.Map' to 'java.util.Map'
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/BaseTableDataManager.java`
#### Snippet
```java
      return new PinotConfiguration();
    }
    return new PinotConfiguration((Map<String, Object>) (Map) ConfigurationConverter.getMap(configuration));
  }
}
```

### UNCHECKED_WARNING
Unchecked assignment: 'java.util.List' to 'java.util.List'
in `pinot-core/src/main/java/org/apache/pinot/core/util/PeerServerSegmentFinder.java`
#### Snippet
```java
    if (clusterName == null) {
      _logger.error("ClusterName not found");
      return ListUtils.EMPTY_LIST;
    }
    final List<URI> onlineServerURIs = new ArrayList<>();
```

### UNCHECKED_WARNING
Unchecked assignment: 'java.util.concurrent.CompletableFuture\[\]' to 'java.util.concurrent.CompletableFuture\[\]'
in `pinot-core/src/main/java/org/apache/pinot/core/query/reduce/StreamingReduceService.java`
#### Snippet
```java
      throws Exception {
    int cnt = 0;
    CompletableFuture<Void>[] futures = new CompletableFuture[serverResponseMap.size()];
    // based on ideas from on https://stackoverflow.com/questions/19348248/waiting-on-a-list-of-future
    // and https://stackoverflow.com/questions/23301598/transform-java-future-into-a-completablefuture
```

### UNCHECKED_WARNING
Unchecked assignment: 'java.util.List' to 'java.util.List'. Reason: 'root' has raw type, so result of getChildOperators is erased
in `pinot-core/src/main/java/org/apache/pinot/core/query/executor/ServerQueryExecutorV1Impl.java`
#### Snippet
```java

    // Obtain the list of all possible segment plans after the combine root node
    List<? extends Operator> children = root.getChildOperators();
    for (Operator child : children) {
      int[] operatorId = {3};
```

### UNCHECKED_WARNING
Unchecked call to 'FutureTask(Callable)' as a member of raw type 'java.util.concurrent.FutureTask'
in `pinot-core/src/main/java/org/apache/pinot/core/query/scheduler/resources/QueryExecutorService.java`
#### Snippet
```java
  @Override
  public <T> Future<T> submit(Callable<T> task) {
    FutureTask futureTask = new FutureTask(task);
    execute(futureTask);
    return futureTask;
```

### UNCHECKED_WARNING
Unchecked assignment: 'java.util.concurrent.FutureTask' to 'java.util.concurrent.Future'
in `pinot-core/src/main/java/org/apache/pinot/core/query/scheduler/resources/QueryExecutorService.java`
#### Snippet
```java
    FutureTask futureTask = new FutureTask(task);
    execute(futureTask);
    return futureTask;
  }

```

### UNCHECKED_WARNING
Unchecked assignment: 'java.util.HashMap' to 'java.util.Map'
in `pinot-core/src/main/java/org/apache/pinot/core/minion/PinotTaskConfig.java`
#### Snippet
```java

  public static PinotTaskConfig fromHelixTaskConfig(TaskConfig helixTaskConfig) {
    Map<String, String> configs = new HashMap<>(helixTaskConfig.getConfigMap());

    // Inside Helix task config map, there are 3 extra Helix properties: TASK_COMMAND, TASK_ID, TASK_TARGET_PARTITION
```

### UNCHECKED_WARNING
Unchecked assignment: 'java.util.List' to 'java.util.List'
in `pinot-core/src/main/java/org/apache/pinot/core/operator/filter/predicate/PredicateUtils.java`
#### Snippet
```java
        } else {
          List<String> sortedValues =
              queryContext.getOrComputeSharedValue(List.class, Equivalence.identity().wrap(inPredicate), k -> {
                List<String> copyValues = new ArrayList<>(values);
                copyValues.sort(null);
```

### UNCHECKED_WARNING
Unchecked call to 'aggregate(int, AggregationResultHolder, Map)' as a member of raw type 'org.apache.pinot.core.query.aggregation.function.AggregationFunction'
in `pinot-core/src/main/java/org/apache/pinot/core/startree/executor/StarTreeAggregationExecutor.java`
#### Snippet
```java
    int length = valueBlock.getNumDocs();
    for (int i = 0; i < numAggregationFunctions; i++) {
      _aggregationFunctions[i].aggregate(length, _aggregationResultHolders[i],
          AggregationFunctionUtils.getBlockValSetMap(_aggregationFunctionColumnPairs[i], valueBlock));
    }
```

### UNCHECKED_WARNING
Unchecked cast: 'java.lang.Object' to 'java.util.List'
in `pinot-core/src/main/java/org/apache/pinot/core/operator/transform/function/GroovyTransformFunction.java`
#### Snippet
```java
      Object result = _groovyFunctionEvaluator.evaluate(_bindingValues);
      if (result instanceof List) {
        _floatValuesMV[i] = new FloatArrayList((List<Float>) result).toFloatArray();
      } else if (result instanceof float[]) {
        _floatValuesMV[i] = (float[]) result;
```

### UNCHECKED_WARNING
Unchecked cast: 'java.lang.Object' to 'java.util.List'
in `pinot-core/src/main/java/org/apache/pinot/core/operator/transform/function/GroovyTransformFunction.java`
#### Snippet
```java
      Object result = _groovyFunctionEvaluator.evaluate(_bindingValues);
      if (result instanceof List) {
        _longValuesMV[i] = new LongArrayList((List<Long>) result).toLongArray();
      } else if (result instanceof long[]) {
        _longValuesMV[i] = (long[]) result;
```

### UNCHECKED_WARNING
Unchecked assignment: 'java.util.function.BiFunction\[\]' to 'java.util.function.BiFunction\[\]'
in `pinot-core/src/main/java/org/apache/pinot/core/operator/transform/function/GroovyTransformFunction.java`
#### Snippet
```java
              argumentsStr));

      _transformToValuesFunctions = new BiFunction[_numGroovyArgs];
      _fetchElementFunctions = new BiFunction[_numGroovyArgs];
      initFunctions();
```

### UNCHECKED_WARNING
Unchecked assignment: 'java.util.function.BiFunction\[\]' to 'java.util.function.BiFunction\[\]'
in `pinot-core/src/main/java/org/apache/pinot/core/operator/transform/function/GroovyTransformFunction.java`
#### Snippet
```java

      _transformToValuesFunctions = new BiFunction[_numGroovyArgs];
      _fetchElementFunctions = new BiFunction[_numGroovyArgs];
      initFunctions();
    } else {
```

### UNCHECKED_WARNING
Unchecked cast: 'java.lang.Object' to 'java.util.List'
in `pinot-core/src/main/java/org/apache/pinot/core/operator/transform/function/GroovyTransformFunction.java`
#### Snippet
```java
      Object result = _groovyFunctionEvaluator.evaluate(_bindingValues);
      if (result instanceof List) {
        _doubleValuesMV[i] = new DoubleArrayList((List<Double>) result).toDoubleArray();
      } else if (result instanceof double[]) {
        _doubleValuesMV[i] = (double[]) result;
```

### UNCHECKED_WARNING
Unchecked cast: 'java.lang.Object' to 'java.util.List'
in `pinot-core/src/main/java/org/apache/pinot/core/operator/transform/function/GroovyTransformFunction.java`
#### Snippet
```java
      Object result = _groovyFunctionEvaluator.evaluate(_bindingValues);
      if (result instanceof List) {
        _stringValuesMV[i] = ((List<String>) result).toArray(new String[0]);
      } else if (result instanceof String[]) {
        _stringValuesMV[i] = (String[]) result;
```

### UNCHECKED_WARNING
Unchecked cast: 'java.lang.Object' to 'java.util.List'
in `pinot-core/src/main/java/org/apache/pinot/core/operator/transform/function/GroovyTransformFunction.java`
#### Snippet
```java
      Object result = _groovyFunctionEvaluator.evaluate(_bindingValues);
      if (result instanceof List) {
        _intValuesMV[i] = new IntArrayList((List<Integer>) result).toIntArray();
      } else if (result instanceof int[]) {
        _intValuesMV[i] = (int[]) result;
```

### UNCHECKED_WARNING
Unchecked call to 'addMeteredGlobalValue(M, long)' as a member of raw type 'org.apache.pinot.common.metrics.AbstractMetrics'
in `pinot-core/src/main/java/org/apache/pinot/core/accounting/PerQueryCPUMemAccountantFactory.java`
#### Snippet
```java
        if (_usedBytes > _criticalLevel) {
          _triggeringLevel = TriggeringLevel.HeapMemoryCritical;
          _metrics.addMeteredGlobalValue(_heapMemoryCriticalExceededMeter, 1);
        } else if (_usedBytes > _alarmingLevel) {
          _sleepTime = _alarmingSleepTime;
```

### UNCHECKED_WARNING
Unchecked call to 'setValueOfGlobalGauge(G, long)' as a member of raw type 'org.apache.pinot.common.metrics.AbstractMetrics'
in `pinot-core/src/main/java/org/apache/pinot/core/accounting/PerQueryCPUMemAccountantFactory.java`
#### Snippet
```java
            // Publish server heap usage metrics
            if (_publishHeapUsageMetric) {
              _metrics.setValueOfGlobalGauge(_memoryUsageGauge, _usedBytes);
            }
            // Clean inactive query stats
```

### UNCHECKED_WARNING
Unchecked call to 'addMeteredGlobalValue(M, long)' as a member of raw type 'org.apache.pinot.common.metrics.AbstractMetrics'
in `pinot-core/src/main/java/org/apache/pinot/core/accounting/PerQueryCPUMemAccountantFactory.java`
#### Snippet
```java
      private void interruptRunnerThread(Thread thread) {
        thread.interrupt();
        _metrics.addMeteredGlobalValue(_queryKilledMeter, 1);
        _numQueriesKilledConsecutively += 1;
      }
```

### UNCHECKED_WARNING
Unchecked call to 'addMeteredGlobalValue(M, long)' as a member of raw type 'org.apache.pinot.common.metrics.AbstractMetrics'
in `pinot-core/src/main/java/org/apache/pinot/core/accounting/PerQueryCPUMemAccountantFactory.java`
#### Snippet
```java
          killAllQueries();
          _triggeringLevel = TriggeringLevel.HeapMemoryPanic;
          _metrics.addMeteredGlobalValue(_heapMemoryPanicExceededMeter, 1);
          LOGGER.error("Heap used bytes {}, greater than _panicLevel {}, Killed all queries and triggered gc!",
              _usedBytes, _panicLevel);
```

### UNCHECKED_WARNING
Unchecked call to 'addMeteredGlobalValue(M, long)' as a member of raw type 'org.apache.pinot.common.metrics.AbstractMetrics'
in `pinot-core/src/main/java/org/apache/pinot/core/accounting/PerQueryCPUMemAccountantFactory.java`
#### Snippet
```java
            }
          }
          _metrics.addMeteredGlobalValue(_queryKilledMeter, killedCount);
          try {
            Thread.sleep(_normalSleepTime);
```

### UNCHECKED_WARNING
Unchecked assignment: 'java.util.Map' to 'java.util.Map'
in `pinot-plugins/pinot-input-format/pinot-parquet/src/main/java/org/apache/pinot/plugin/inputformat/parquet/ParquetNativeRecordExtractor.java`
#### Snippet
```java
  @Override
  public Object convertMap(Object value) {
    Map<Object, Object> map = (Map) value;
    if (map.isEmpty()) {
      return null;
```

### UNCHECKED_WARNING
Unchecked cast: 'java.lang.Object' to 'java.util.Collection'
in `pinot-plugins/pinot-input-format/pinot-protobuf/src/main/java/org/apache/pinot/plugin/inputformat/protobuf/ProtoBufRecordExtractor.java`
#### Snippet
```java
  protected Object convertMultiValue(Object value) {
    ProtoBufFieldInfo protoBufFieldInfo = (ProtoBufFieldInfo) value;
    Collection<Object> fieldValues = (Collection<Object>) protoBufFieldInfo.getFieldValue();

    if (fieldValues.isEmpty()) {
```

### UNCHECKED_WARNING
Unchecked cast: 'java.lang.Object' to 'java.util.Collection'
in `pinot-plugins/pinot-input-format/pinot-protobuf/src/main/java/org/apache/pinot/plugin/inputformat/protobuf/ProtoBufRecordExtractor.java`
#### Snippet
```java
  protected Object convertMap(Object value) {
    ProtoBufFieldInfo protoBufFieldInfo = (ProtoBufFieldInfo) value;
    Collection<Message> messages = (Collection<Message>) protoBufFieldInfo.getFieldValue();
    if (messages.isEmpty()) {
      return null;
```

### UNCHECKED_WARNING
Unchecked cast: 'java.lang.Object' to 'com.yammer.metrics.core.Gauge'
in `pinot-plugins/pinot-metrics/pinot-yammer/src/main/java/org/apache/pinot/plugin/metrics/yammer/YammerMetricsRegistry.java`
#### Snippet
```java
  public <T> PinotGauge<T> newGauge(PinotMetricName name, PinotGauge<T> gauge) {
    return new YammerGauge<T>((YammerSettableGauge<T>)
        _metricsRegistry.newGauge((MetricName) name.getMetricName(), (Gauge<T>) gauge.getGauge()));
  }

```

### UNCHECKED_WARNING
Unchecked call to 'decode(T, GenericRow)' as a member of raw type 'org.apache.pinot.spi.stream.StreamMessageDecoder'
in `pinot-plugins/pinot-stream-ingestion/pinot-pulsar/src/main/java/org/apache/pinot/plugin/stream/pulsar/PulsarStreamLevelConsumer.java`
#### Snippet
```java
      if (_reader.hasMessageAvailable()) {
        final Message<byte[]> record = _reader.readNext();
        destination = _messageDecoder.decode(record.getData(), destination);

        _currentCount++;
```

### UNCHECKED_WARNING
Unchecked assignment: 'java.util.Set' to 'java.util.Set'
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotRealtimeTableResource.java`
#### Snippet
```java
    }
    String tableNameWithType = controllerJobZKMetadata.get(CommonConstants.ControllerJob.TABLE_NAME_WITH_TYPE);
    Set<String> consumingSegmentCommitted = JsonUtils.stringToObject(
        controllerJobZKMetadata.get(CommonConstants.ControllerJob.CONSUMING_SEGMENTS_FORCE_COMMITTED_LIST), Set.class);
    Set<String> onlineSegmentsForTable =
```

### UNCHECKED_WARNING
Unchecked assignment: 'java.util.HashSet' to 'java.util.Set'
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotBrokerRestletResource.java`
#### Snippet
```java
    }
    Set<InstanceConfig> tenantBrokers =
        new HashSet<>(_pinotHelixResourceManager.getAllInstancesConfigsForBrokerTenant(tenantName));
    Set<InstanceInfo> instanceInfoSet = tenantBrokers.stream()
        .map(x -> new InstanceInfo(x.getInstanceName(), x.getHostName(), Integer.parseInt(x.getPort())))
```

### UNCHECKED_WARNING
Unchecked call to 'HashSet(Collection)' as a member of raw type 'java.util.HashSet'
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotBrokerRestletResource.java`
#### Snippet
```java
    }
    Set<InstanceConfig> tenantBrokers =
        new HashSet<>(_pinotHelixResourceManager.getAllInstancesConfigsForBrokerTenant(tenantName));
    Set<InstanceInfo> instanceInfoSet = tenantBrokers.stream()
        .map(x -> new InstanceInfo(x.getInstanceName(), x.getHostName(), Integer.parseInt(x.getPort())))
```

### UNCHECKED_WARNING
Unchecked assignment: 'java.util.HashSet' to 'java.util.Set'
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotBrokerRestletResource.java`
#### Snippet
```java
      }
      Set<InstanceConfig> tenantBrokers =
          new HashSet<>(_pinotHelixResourceManager.getBrokerInstancesConfigsFor(tableNamesWithType.get(0)));
      Set<InstanceInfo> instanceInfoSet = tenantBrokers.stream()
          .map(x -> new InstanceInfo(x.getInstanceName(), x.getHostName(), Integer.parseInt(x.getPort())))
```

### UNCHECKED_WARNING
Unchecked call to 'HashSet(Collection)' as a member of raw type 'java.util.HashSet'
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotBrokerRestletResource.java`
#### Snippet
```java
      }
      Set<InstanceConfig> tenantBrokers =
          new HashSet<>(_pinotHelixResourceManager.getBrokerInstancesConfigsFor(tableNamesWithType.get(0)));
      Set<InstanceInfo> instanceInfoSet = tenantBrokers.stream()
          .map(x -> new InstanceInfo(x.getInstanceName(), x.getHostName(), Integer.parseInt(x.getPort())))
```

### UNCHECKED_WARNING
Unchecked assignment: 'java.util.Map' to 'java.util.Map'
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotRunningQueryResource.java`
#### Snippet
```java
        }
        queriesByBroker.put(brokers.get(getInstanceKey(uri)).getInstanceName(),
            JsonUtils.stringToObject(getMethod.getResponseBodyAsString(), Map.class));
      } catch (Exception e) {
        LOGGER.error("Failed to get queries", e);
```

### UNCHECKED_WARNING
Unchecked call to 'collect(Collector)' as a member of raw type 'java.util.stream.Stream'
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotTableRestletResource.java`
#### Snippet
```java
    if (StringUtils.isNotEmpty(jobTypesString)) {
      try {
        jobTypesToFilter = new HashSet<>(java.util.Arrays.asList(StringUtils.split(jobTypesString, ','))).stream()
            .map(type -> ControllerJobType.valueOf(type)).collect(Collectors.toSet());
      } catch (IllegalArgumentException e) {
        throw new IllegalArgumentException("Valid Types are: " + validJobTypes);
```

### UNCHECKED_WARNING
Unchecked call to 'map(Function)' as a member of raw type 'java.util.stream.Stream'
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotTableRestletResource.java`
#### Snippet
```java
    if (StringUtils.isNotEmpty(jobTypesString)) {
      try {
        jobTypesToFilter = new HashSet<>(java.util.Arrays.asList(StringUtils.split(jobTypesString, ','))).stream()
            .map(type -> ControllerJobType.valueOf(type)).collect(Collectors.toSet());
      } catch (IllegalArgumentException e) {
        throw new IllegalArgumentException("Valid Types are: " + validJobTypes);
```

### UNCHECKED_WARNING
Unchecked call to 'HashSet(Collection)' as a member of raw type 'java.util.HashSet'
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotTableRestletResource.java`
#### Snippet
```java
    if (StringUtils.isNotEmpty(jobTypesString)) {
      try {
        jobTypesToFilter = new HashSet<>(java.util.Arrays.asList(StringUtils.split(jobTypesString, ','))).stream()
            .map(type -> ControllerJobType.valueOf(type)).collect(Collectors.toSet());
      } catch (IllegalArgumentException e) {
```

### UNCHECKED_WARNING
Unchecked assignment: 'java.util.HashSet' to 'java.util.Set'
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/SegmentStatusChecker.java`
#### Snippet
```java
    // Get the segments excluding the replaced segments which are specified in the segment lineage entries and cannot
    // be queried from the table.
    Set<String> segmentsExcludeReplaced = new HashSet<>(idealState.getPartitionSet());
    ZkHelixPropertyStore<ZNRecord> propertyStore = _pinotHelixResourceManager.getPropertyStore();
    SegmentLineage segmentLineage = SegmentLineageAccessHelper.getSegmentLineage(propertyStore, tableNameWithType);
```

### UNCHECKED_WARNING
Unchecked assignment: 'java.util.Map' to 'java.util.Map'
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/minion/PinotHelixTaskResourceManager.java`
#### Snippet
```java
        LOGGER.debug("Got resp: {} from worker: {}", resp, worker);
        if (StringUtils.isNotEmpty(resp)) {
          subtaskProgressMap.putAll(JsonUtils.stringToObject(resp, Map.class));
        }
      }
```

### UNCHECKED_WARNING
Unchecked assignment: 'java.util.ArrayList' to 'java.util.List'
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/PinotHelixResourceManager.java`
#### Snippet
```java
    // Get the segment list for this table
    IdealState is = _helixAdmin.getResourceIdealState(_helixClusterName, tableNameWithType);
    List<String> segmentList = new ArrayList<>(is.getPartitionSet());

    // Make a list of segment metadata for the given table
```

### UNCHECKED_WARNING
Unchecked assignment: 'java.util.ArrayList' to 'java.util.List'
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/PinotHelixResourceManager.java`
#### Snippet
```java
    String usernamePrefix = userConfig.getUserName() + "_" + userConfig.getComponentType();
    boolean isExists = Optional.ofNullable(ZKMetadataProvider.getAllUserConfig(_propertyStore)).orElseGet(() -> {
      return new ArrayList();
    }).contains(userConfig);
    if (isExists) {
```

### UNCHECKED_WARNING
Unchecked assignment: 'java.util.HashSet' to 'java.util.Set'
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/PinotHelixResourceManager.java`
#### Snippet
```java
      throw new IllegalStateException("Ideal state does not exist for table: " + tableNameWithType);
    }
    return new HashSet<>(idealState.getInstanceStateMap(segmentName).keySet());
  }

```

### UNCHECKED_WARNING
Unchecked assignment: 'java.util.ArrayList' to 'java.util.List'
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/PinotHelixResourceManager.java`
#### Snippet
```java
    IdealState idealState = getTableIdealState(tableNameWithType);
    Preconditions.checkState(idealState != null, "Failed to find ideal state for table: %s", tableNameWithType);
    List<String> segments = new ArrayList<>(idealState.getPartitionSet());
    if (startTimestamp == Long.MIN_VALUE && endTimestamp == Long.MAX_VALUE) {
      return shouldExcludeReplacedSegments ? excludeReplacedSegments(tableNameWithType, segments) : segments;
```

### UNCHECKED_WARNING
Unchecked cast: 'java.lang.Object' to 'java.util.List'
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/data/generator/PatternSeasonalGenerator.java`
#### Snippet
```java
    }

    List<Double> userValues = (List<Double>) obj;
    double[] values = new double[userValues.size()];
    for (int i = 0; i < userValues.size(); i++) {
```

### UNCHECKED_WARNING
Unchecked cast: 'java.lang.Object' to 'java.util.List\>\>'
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/data/generator/PatternMixtureGenerator.java`
#### Snippet
```java

  public PatternMixtureGenerator(Map<String, Object> templateConfig) {
    this(toGeneratorBins((List<List<Map<String, Object>>>) templateConfig.get("generatorBins"),
        (Map<String, Object>) templateConfig.get("defaults")));
  }
```

### UNCHECKED_WARNING
Unchecked cast: 'java.lang.Object' to 'java.util.Map'
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/data/generator/PatternMixtureGenerator.java`
#### Snippet
```java
  public PatternMixtureGenerator(Map<String, Object> templateConfig) {
    this(toGeneratorBins((List<List<Map<String, Object>>>) templateConfig.get("generatorBins"),
        (Map<String, Object>) templateConfig.get("defaults")));
  }

```

### UNCHECKED_WARNING
Unchecked cast: 'java.lang.Object' to 'java.util.List'
in `pinot-controller/src/main/java/org/apache/pinot/controller/recommender/data/generator/PatternStringGenerator.java`
#### Snippet
```java

  public PatternStringGenerator(Map<String, Object> templateConfig) {
    this(((List<String>) templateConfig.get("values")).toArray(new String[0]),
        PropertyConverter.toLong(templateConfig.getOrDefault("repetitions", 1)));
  }
```

### UNCHECKED_WARNING
Unchecked assignment: 'java.util.HashMap' to 'java.util.Map'
in `pinot-connectors/pinot-flink-connector/src/main/java/org/apache/pinot/connector/flink/common/MapGenericRowConverter.java`
#### Snippet
```java
  @Override
  public Map<String, Object> convertFromRow(GenericRow row) {
    return new HashMap(row.getFieldToValueMap());
  }
}
```

### UNCHECKED_WARNING
Unchecked call to 'HashMap(Map)' as a member of raw type 'java.util.HashMap'
in `pinot-connectors/pinot-flink-connector/src/main/java/org/apache/pinot/connector/flink/common/MapGenericRowConverter.java`
#### Snippet
```java
  @Override
  public Map<String, Object> convertFromRow(GenericRow row) {
    return new HashMap(row.getFieldToValueMap());
  }
}
```

### UNCHECKED_WARNING
Unchecked generics array creation for varargs parameter
in `pinot-connectors/pinot-flink-connector/src/main/java/org/apache/pinot/connector/flink/sink/FlinkSegmentWriter.java`
#### Snippet
```java
      batchConfigMapOverride.put(BatchConfigProperties.OUTPUT_DIR_URI, segmentDir.getAbsolutePath());
      batchConfigMapOverride.put(BatchConfigProperties.INPUT_FORMAT, BUFFER_FILE_FORMAT.toString());
      BatchIngestionConfig batchIngestionConfig = new BatchIngestionConfig(Lists.newArrayList(batchConfigMapOverride),
          _batchIngestionConfig.getSegmentIngestionType(), _batchIngestionConfig.getSegmentIngestionFrequency(),
          _batchIngestionConfig.getConsistentDataPush());
```

### UNCHECKED_WARNING
Unchecked assignment: 'java.util.Comparator' to 'java.util.Comparator'
in `pinot-tools/src/main/java/org/apache/pinot/tools/anonymizer/ArrayBasedGlobalDictionaries.java`
#### Snippet
```java

    void sort() {
      Arrays.sort(_origValues, 0, _index, _comparator);
    }

```

### UNCHECKED_WARNING
Unchecked cast: 'org.apache.pinot.spi.config.table.IndexConfig' to 'C'
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/index/FieldIndexConfigs.java`
#### Snippet
```java
      return indexType.getDefaultConfig();
    }
    return (C) config;
  }

```

### UNCHECKED_WARNING
Unchecked cast: 'org.apache.pinot.segment.spi.index.IndexReader' to 'I'
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/index/column/ColumnIndexContainer.java`
#### Snippet
```java
    @Override
    public <I extends IndexReader, T extends IndexType<?, I, ?>> I getIndex(T indexType) {
      return (I) _readersByIndex.get(indexType);
    }

```

### UNCHECKED_WARNING
Unchecked assignment: 'java.util.List' to 'java.lang.Iterable'
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/index/metadata/ColumnMetadataImpl.java`
#### Snippet
```java
           */
          partitionFunctionConfigMap.put(functionConfigKey,
              functionConfigValueObj instanceof List ? String.join(",", (List) functionConfigValueObj)
                  : functionConfigValueObj.toString());
        }
```

### UNCHECKED_WARNING
Unchecked assignment: 'java.util.concurrent.LinkedBlockingQueue' to 'java.util.concurrent.BlockingQueue'
in `pinot-broker/src/main/java/org/apache/pinot/broker/broker/BrokerManagedAsyncExecutorProvider.java`
#### Snippet
```java
  protected BlockingQueue<Runnable> getWorkQueue() {
    if (_queueSize == Integer.MAX_VALUE) {
      return new LinkedBlockingQueue();
    }
    return new ArrayBlockingQueue(_queueSize);
```

### UNCHECKED_WARNING
Unchecked assignment: 'java.util.concurrent.ArrayBlockingQueue' to 'java.util.concurrent.BlockingQueue'
in `pinot-broker/src/main/java/org/apache/pinot/broker/broker/BrokerManagedAsyncExecutorProvider.java`
#### Snippet
```java
      return new LinkedBlockingQueue();
    }
    return new ArrayBlockingQueue(_queueSize);
  }

```

### UNCHECKED_WARNING
Unchecked assignment: 'org.apache.pinot.broker.routing.segmentpruner.interval.IntervalTree.Node' to 'org.apache.pinot.broker.routing.segmentpruner.interval.IntervalTree.Node'
in `pinot-broker/src/main/java/org/apache/pinot/broker/routing/segmentpruner/interval/IntervalTree.java`
#### Snippet
```java
    List<Node<VALUE>> sortedNodes = new ArrayList<>();
    for (Map.Entry<Interval, List<VALUE>> entry : intervalToValuesMap.entrySet()) {
      sortedNodes.add(new Node(entry.getKey(), entry.getValue()));
    }
    Collections.sort(sortedNodes);
```

### UNCHECKED_WARNING
Unchecked call to 'Node(Interval, List)' as a member of raw type 'org.apache.pinot.broker.routing.segmentpruner.interval.IntervalTree.Node'
in `pinot-broker/src/main/java/org/apache/pinot/broker/routing/segmentpruner/interval/IntervalTree.java`
#### Snippet
```java
    List<Node<VALUE>> sortedNodes = new ArrayList<>();
    for (Map.Entry<Interval, List<VALUE>> entry : intervalToValuesMap.entrySet()) {
      sortedNodes.add(new Node(entry.getKey(), entry.getValue()));
    }
    Collections.sort(sortedNodes);
```

### UNCHECKED_WARNING
Unchecked assignment: 'org.apache.pinot.broker.routing.segmentpruner.interval.IntervalTree.Node' to 'org.apache.pinot.broker.routing.segmentpruner.interval.IntervalTree.Node'
in `pinot-broker/src/main/java/org/apache/pinot/broker/routing/segmentpruner/interval/IntervalTree.java`
#### Snippet
```java
    }

    Node<VALUE> node = _nodes.get(nodeIndex);
    Interval interval = node._interval;
    if (searchInterval.intersects(interval)) {
```

### UNCHECKED_WARNING
Unchecked cast: 'java.lang.Object' to 'org.apache.pinot.broker.routing.segmentpruner.interval.IntervalTree.Node'
in `pinot-broker/src/main/java/org/apache/pinot/broker/routing/segmentpruner/interval/IntervalTree.java`
#### Snippet
```java
      }

      Node<?> node = (Node<?>) o;

      return _interval.equals(node._interval);
```

### UNCHECKED_WARNING
Unchecked assignment: 'java.util.ArrayList' to 'java.util.ArrayList'
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-spark-2.4/src/main/java/org/apache/pinot/plugin/ingestion/batch/spark/SparkSegmentGenerationJobRunner.java`
#### Snippet
```java
    }

    ArrayList<File> validPluginDirectories = new ArrayList();

    for (String pluginsDirPath : pluginDirectories) {
```

### UNCHECKED_WARNING
Unchecked assignment: 'java.util.List\[\]' to 'java.util.List\[\]'
in `pinot-query-runtime/src/main/java/org/apache/pinot/query/runtime/operator/exchange/HashExchange.java`
#### Snippet
```java
  protected void route(List<SendingMailbox> destinations, TransferableBlock block)
      throws Exception {
    List<Object[]>[] destIdxToRows = new List[destinations.size()];
    for (Object[] row : block.getContainer()) {
      int partition = _keySelector.computeHash(row) % destinations.size();
```

### UNCHECKED_WARNING
Unchecked assignment: 'java.lang.ref.SoftReference\[\]' to 'java.lang.ref.SoftReference\[\]'
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkRoaringBitmapCreation.java`
#### Snippet
```java
      }
    } else {
      bitmapArrayReference = new SoftReference[_numBitmaps];
      _bitmapsArrayReference = new SoftReference<>(bitmapArrayReference);
    }
```

### UNCHECKED_WARNING
Unchecked assignment: 'java.lang.ref.SoftReference\[\]' to 'java.lang.ref.SoftReference\>\[\]'
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkRoaringBitmapCreation.java`
#### Snippet
```java
      }
    } else {
      offsetLengthPairArrayReference = new SoftReference[_numBitmaps];
      _offsetLengthPairsArrayReference = new SoftReference<>(offsetLengthPairArrayReference);
    }
```

### UNCHECKED_WARNING
Unchecked assignment: 'java.util.ArrayDeque' to 'java.util.Queue'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/utils/RealTimeRegexpMatcher.java`
#### Snippet
```java
   */
  public void regexMatchOnFST() {
    final Queue<Path> queue = new ArrayDeque();

    if (_automaton.getNumberOfStates() == 0) {
```

### UNCHECKED_WARNING
Unchecked assignment: 'java.util.ArrayList' to 'java.util.List'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/SegmentPushUtils.java`
#### Snippet
```java
          }
          RetryPolicies.exponentialBackoffRetryPolicy(attempts, retryWaitMs, 5).attempt(() -> {
            List<Header> reqHttpHeaders = new ArrayList<>(headers);
            try {
              reqHttpHeaders.add(new BasicHeader(FileUploadDownloadClient.CustomHeaders.DOWNLOAD_URI, segmentUriPath));
```

### UNCHECKED_WARNING
Unchecked call to 'ArrayList(Collection)' as a member of raw type 'java.util.ArrayList'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/SegmentPushUtils.java`
#### Snippet
```java
          }
          RetryPolicies.exponentialBackoffRetryPolicy(attempts, retryWaitMs, 5).attempt(() -> {
            List<Header> reqHttpHeaders = new ArrayList<>(headers);
            try {
              reqHttpHeaders.add(new BasicHeader(FileUploadDownloadClient.CustomHeaders.DOWNLOAD_URI, segmentUriPath));
```

### UNCHECKED_WARNING
Unchecked call to 'compareTo(T)' as a member of raw type 'java.lang.Comparable'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/upsert/merger/MinMerger.java`
#### Snippet
```java
  @Override
  public Object merge(Object previousValue, Object currentValue) {
    return ((Comparable) previousValue).compareTo((Comparable) currentValue) < 0 ? previousValue : currentValue;
  }
}
```

### UNCHECKED_WARNING
Unchecked call to 'compareTo(T)' as a member of raw type 'java.lang.Comparable'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/upsert/merger/MaxMerger.java`
#### Snippet
```java
  @Override
  public Object merge(Object previousValue, Object currentValue) {
    return ((Comparable) previousValue).compareTo((Comparable) currentValue) > 0 ? previousValue : currentValue;
  }
}
```

### UNCHECKED_WARNING
Unchecked call to 'getInt(int, T)' as a member of raw type 'org.apache.pinot.segment.spi.index.reader.ForwardIndexReader'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/loader/bloomfilter/BloomFilterHandler.java`
#### Snippet
```java
          case INT:
            for (int i = 0; i < numDocs; i++) {
              bloomFilterCreator.add(Integer.toString(forwardIndexReader.getInt(i, readerContext)));
            }
            break;
```

### UNCHECKED_WARNING
Unchecked call to 'getLong(int, T)' as a member of raw type 'org.apache.pinot.segment.spi.index.reader.ForwardIndexReader'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/loader/bloomfilter/BloomFilterHandler.java`
#### Snippet
```java
          case LONG:
            for (int i = 0; i < numDocs; i++) {
              bloomFilterCreator.add(Long.toString(forwardIndexReader.getLong(i, readerContext)));
            }
            break;
```

### UNCHECKED_WARNING
Unchecked call to 'getFloat(int, T)' as a member of raw type 'org.apache.pinot.segment.spi.index.reader.ForwardIndexReader'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/loader/bloomfilter/BloomFilterHandler.java`
#### Snippet
```java
          case FLOAT:
            for (int i = 0; i < numDocs; i++) {
              bloomFilterCreator.add(Float.toString(forwardIndexReader.getFloat(i, readerContext)));
            }
            break;
```

### UNCHECKED_WARNING
Unchecked call to 'getDouble(int, T)' as a member of raw type 'org.apache.pinot.segment.spi.index.reader.ForwardIndexReader'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/loader/bloomfilter/BloomFilterHandler.java`
#### Snippet
```java
          case DOUBLE:
            for (int i = 0; i < numDocs; i++) {
              bloomFilterCreator.add(Double.toString(forwardIndexReader.getDouble(i, readerContext)));
            }
            break;
```

### UNCHECKED_WARNING
Unchecked call to 'getString(int, T)' as a member of raw type 'org.apache.pinot.segment.spi.index.reader.ForwardIndexReader'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/loader/bloomfilter/BloomFilterHandler.java`
#### Snippet
```java
          case STRING:
            for (int i = 0; i < numDocs; i++) {
              bloomFilterCreator.add(forwardIndexReader.getString(i, readerContext));
            }
            break;
```

### UNCHECKED_WARNING
Unchecked call to 'getBytes(int, T)' as a member of raw type 'org.apache.pinot.segment.spi.index.reader.ForwardIndexReader'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/loader/bloomfilter/BloomFilterHandler.java`
#### Snippet
```java
          case BYTES:
            for (int i = 0; i < numDocs; i++) {
              bloomFilterCreator.add(BytesUtils.toHexString(forwardIndexReader.getBytes(i, readerContext)));
            }
            break;
```

### UNCHECKED_WARNING
Unchecked call to 'getIntMV(int, int\[\], T)' as a member of raw type 'org.apache.pinot.segment.spi.index.reader.ForwardIndexReader'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/loader/bloomfilter/BloomFilterHandler.java`
#### Snippet
```java
            for (int i = 0; i < numDocs; i++) {
              int[] buffer = new int[columnMetadata.getMaxNumberOfMultiValues()];
              int length = forwardIndexReader.getIntMV(i, buffer, readerContext);
              for (int j = 0; j < length; j++) {
                bloomFilterCreator.add(Integer.toString(buffer[j]));
```

### UNCHECKED_WARNING
Unchecked call to 'getLongMV(int, long\[\], T)' as a member of raw type 'org.apache.pinot.segment.spi.index.reader.ForwardIndexReader'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/loader/bloomfilter/BloomFilterHandler.java`
#### Snippet
```java
            for (int i = 0; i < numDocs; i++) {
              long[] buffer = new long[columnMetadata.getMaxNumberOfMultiValues()];
              int length = forwardIndexReader.getLongMV(i, buffer, readerContext);
              for (int j = 0; j < length; j++) {
                bloomFilterCreator.add(Long.toString(buffer[j]));
```

### UNCHECKED_WARNING
Unchecked call to 'getFloatMV(int, float\[\], T)' as a member of raw type 'org.apache.pinot.segment.spi.index.reader.ForwardIndexReader'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/loader/bloomfilter/BloomFilterHandler.java`
#### Snippet
```java
            for (int i = 0; i < numDocs; i++) {
              float[] buffer = new float[columnMetadata.getMaxNumberOfMultiValues()];
              int length = forwardIndexReader.getFloatMV(i, buffer, readerContext);
              for (int j = 0; j < length; j++) {
                bloomFilterCreator.add(Float.toString(buffer[j]));
```

### UNCHECKED_WARNING
Unchecked call to 'getDoubleMV(int, double\[\], T)' as a member of raw type 'org.apache.pinot.segment.spi.index.reader.ForwardIndexReader'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/loader/bloomfilter/BloomFilterHandler.java`
#### Snippet
```java
            for (int i = 0; i < numDocs; i++) {
              double[] buffer = new double[columnMetadata.getMaxNumberOfMultiValues()];
              int length = forwardIndexReader.getDoubleMV(i, buffer, readerContext);
              for (int j = 0; j < length; j++) {
                bloomFilterCreator.add(Double.toString(buffer[j]));
```

### UNCHECKED_WARNING
Unchecked call to 'getStringMV(int, String\[\], T)' as a member of raw type 'org.apache.pinot.segment.spi.index.reader.ForwardIndexReader'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/loader/bloomfilter/BloomFilterHandler.java`
#### Snippet
```java
            for (int i = 0; i < numDocs; i++) {
              String[] buffer = new String[columnMetadata.getMaxNumberOfMultiValues()];
              int length = forwardIndexReader.getStringMV(i, buffer, readerContext);
              for (int j = 0; j < length; j++) {
                bloomFilterCreator.add(buffer[j]);
```

### UNCHECKED_WARNING
Unchecked call to 'getBytesMV(int, byte\[\]\[\], T)' as a member of raw type 'org.apache.pinot.segment.spi.index.reader.ForwardIndexReader'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/loader/bloomfilter/BloomFilterHandler.java`
#### Snippet
```java
            for (int i = 0; i < numDocs; i++) {
              byte[][] buffer = new byte[columnMetadata.getMaxNumberOfMultiValues()][];
              int length = forwardIndexReader.getBytesMV(i, buffer, readerContext);
              for (int j = 0; j < length; j++) {
                bloomFilterCreator.add(BytesUtils.toHexString(buffer[j]));
```

### UNCHECKED_WARNING
Unchecked assignment: 'java.util.List' to 'java.util.List'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/store/TextIndexUtils.java`
#### Snippet
```java
      String stopWordKey) {
    if (columnProperties == null) {
      return Collections.EMPTY_LIST;
    }
    String includeWords = columnProperties.getOrDefault(stopWordKey, "");
```

### UNCHECKED_WARNING
Unchecked cast: 'java.lang.Object' to 'java.util.Collection'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/creator/TransformPipeline.java`
#### Snippet
```java
      decodedRow = _complexTypeTransformer.transform(decodedRow);
    }
    Collection<GenericRow> rows = (Collection<GenericRow>) decodedRow.getValue(GenericRow.MULTIPLE_RECORDS_KEY);
    if (rows != null) {
      for (GenericRow row : rows) {
```

### UNCHECKED_WARNING
Unchecked cast: 'org.apache.pinot.segment.spi.index.reader.ForwardIndexReader\>' to 'I'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/virtualcolumn/VirtualColumnIndexContainer.java`
#### Snippet
```java
  public <I extends IndexReader, T extends IndexType<?, I, ?>> I getIndex(T indexType) {
    if (indexType.equals(StandardIndexes.forward())) {
      return (I) _forwardIndex;
    }
    if (indexType.equals(StandardIndexes.inverted())) {
```

### UNCHECKED_WARNING
Unchecked cast: 'org.apache.pinot.segment.spi.index.reader.InvertedIndexReader\>' to 'I'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/virtualcolumn/VirtualColumnIndexContainer.java`
#### Snippet
```java
    }
    if (indexType.equals(StandardIndexes.inverted())) {
      return (I) _invertedIndex;
    }
    if (indexType.equals(StandardIndexes.dictionary())) {
```

### UNCHECKED_WARNING
Unchecked cast: 'org.apache.pinot.segment.spi.index.reader.Dictionary' to 'I'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/virtualcolumn/VirtualColumnIndexContainer.java`
#### Snippet
```java
    }
    if (indexType.equals(StandardIndexes.dictionary())) {
      return (I) _dictionary;
    }
    return null;
```

### UNCHECKED_WARNING
Unchecked assignment: 'java.util.HashMap' to 'java.util.Map'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/realtime/impl/RealtimeSegmentStatsHistory.java`
#### Snippet
```java
    private int _numSeconds;        // Number of seconds taken to consume them
    private long _memUsedBytes;          // Memory used for consumption (bytes)
    private Map<String, ColumnStats> _colNameToStats = new HashMap();

    public int getNumRowsConsumed() {
```

### UNCHECKED_WARNING
Unchecked assignment: 'java.util.Collection' to 'java.util.Collection'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/recordtransformer/ComplexTypeTransformer.java`
#### Snippet
```java
      record.putValue(GenericRow.MULTIPLE_RECORDS_KEY, list);
    } else {
      Collection<GenericRow> records = (Collection) value;
      List<GenericRow> list = new ArrayList<>();
      for (GenericRow innerRecord : records) {
```

### UNCHECKED_WARNING
Unchecked assignment: 'java.util.Map' to 'java.util.Map'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/recordtransformer/ComplexTypeTransformer.java`
#### Snippet
```java
      Object value = record.getValue(column);
      if (value instanceof Map) {
        Map<String, Object> map = (Map) record.removeValue(column);
        List<String> mapColumns = new ArrayList<>();
        for (Map.Entry<String, Object> entry : new ArrayList<>(map.entrySet())) {
```

### UNCHECKED_WARNING
Unchecked cast: 'java.lang.Object' to 'java.util.Map'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/recordtransformer/ComplexTypeTransformer.java`
#### Snippet
```java
          for (Object inner : collection) {
            if (inner instanceof Map) {
              Map<String, Object> innerMap = (Map<String, Object>) inner;
              flattenMap(column, innerMap, new ArrayList<>(innerMap.keySet()));
            }
```

### UNCHECKED_WARNING
Unchecked cast: 'java.lang.Object' to 'java.util.Map'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/recordtransformer/ComplexTypeTransformer.java`
#### Snippet
```java
          for (Object inner : array) {
            if (inner instanceof Map) {
              Map<String, Object> innerMap = (Map<String, Object>) inner;
              flattenMap(column, innerMap, new ArrayList<>(innerMap.keySet()));
            }
```

### UNCHECKED_WARNING
Unchecked cast: 'java.lang.Object' to 'java.util.Map'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/recordtransformer/ComplexTypeTransformer.java`
#### Snippet
```java
      String concatName = concat(path, field);
      if (value instanceof Map) {
        Map<String, Object> innerMap = (Map<String, Object>) map.remove(field);
        List<String> innerMapFields = new ArrayList<>();
        for (Map.Entry<String, Object> innerEntry : new ArrayList<>(innerMap.entrySet())) {
```

### UNCHECKED_WARNING
Unchecked cast: 'java.lang.Object' to 'java.util.Map'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/recordtransformer/ComplexTypeTransformer.java`
#### Snippet
```java
          for (Object inner : (Collection) value) {
            if (inner instanceof Map) {
              Map<String, Object> innerMap = (Map<String, Object>) inner;
              flattenMap(concatName, innerMap, new ArrayList<>(innerMap.keySet()));
            }
```

### UNCHECKED_WARNING
Unchecked cast: 'java.lang.Object' to 'java.util.Map'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/recordtransformer/ComplexTypeTransformer.java`
#### Snippet
```java
          for (Object inner : (Object[]) value) {
            if (inner instanceof Map) {
              Map<String, Object> innerMap = (Map<String, Object>) inner;
              flattenMap(concatName, innerMap, new ArrayList<>(innerMap.keySet()));
            }
```

### UNCHECKED_WARNING
Unchecked cast: 'java.lang.Object' to 'java.util.Map'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/recordtransformer/ComplexTypeTransformer.java`
#### Snippet
```java
    GenericRow copy = record.copy();
    if (obj instanceof Map) {
      Map<String, Object> map = (Map<String, Object>) obj;
      for (Map.Entry<String, Object> entry : map.entrySet()) {
        String flattenName = concat(column, entry.getKey());
```

### UNCHECKED_WARNING
Unchecked generics array creation for varargs parameter
in `pinot-plugins/pinot-segment-writer/pinot-segment-writer-file-based/src/main/java/org/apache/pinot/plugin/segmentwriter/filebased/FileBasedSegmentWriter.java`
#### Snippet
```java
      batchConfigMapOverride.put(BatchConfigProperties.OUTPUT_DIR_URI, segmentDir.getAbsolutePath());
      batchConfigMapOverride.put(BatchConfigProperties.INPUT_FORMAT, BUFFER_FILE_FORMAT.toString());
      BatchIngestionConfig batchIngestionConfig = new BatchIngestionConfig(Lists.newArrayList(batchConfigMapOverride),
          _batchIngestionConfig.getSegmentIngestionType(), _batchIngestionConfig.getSegmentIngestionFrequency(),
          _batchIngestionConfig.getConsistentDataPush());
```

## RuleId[id=DataFlowIssue]
### DataFlowIssue
Method invocation `getInputs` will produce `NullPointerException`
in `pinot-query-planner/src/main/java/org/apache/pinot/query/QueryEnvironment.java`
#### Snippet
```java
      return true;
    }
    for (RelNode input : relNode.getInputs()) {
      if (hasCorrelateNode(input)) {
        return true;
```

### DataFlowIssue
Method invocation `getClass` will produce `NullPointerException`
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/stage/SetOpNode.java`
#### Snippet
```java
        return MINUS;
      }
      throw new IllegalArgumentException("Unsupported set operation: " + setOp.getClass());
    }
  }
```

### DataFlowIssue
Method invocation `getKind` will produce `NullPointerException`
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/logical/RexExpression.java`
#### Snippet
```java
      return toRexExpression(rexCall);
    } else {
      throw new IllegalArgumentException("Unsupported RexNode type with SqlKind: " + rexNode.getKind());
    }
  }
```

### DataFlowIssue
Switch label `PinotSkewnessAggregateFunction.SKEWNESS` is unreachable
in `pinot-query-planner/src/main/java/org/apache/calcite/rel/rules/PinotReduceAggregateFunctionsRule.java`
#### Snippet
```java
    if (shouldReduce(oldCall)) {
      switch (oldCall.getAggregation().getName()) {
        case PinotSkewnessAggregateFunction.SKEWNESS:
          return reduceFourthMoment(oldAggRel, oldCall, newCalls, aggCallMapping, false);
        case PinotKurtosisAggregateFunction.KURTOSIS:
```

### DataFlowIssue
Switch label `PinotKurtosisAggregateFunction.KURTOSIS` is unreachable
in `pinot-query-planner/src/main/java/org/apache/calcite/rel/rules/PinotReduceAggregateFunctionsRule.java`
#### Snippet
```java
        case PinotSkewnessAggregateFunction.SKEWNESS:
          return reduceFourthMoment(oldAggRel, oldCall, newCalls, aggCallMapping, false);
        case PinotKurtosisAggregateFunction.KURTOSIS:
          return reduceFourthMoment(oldAggRel, oldCall, newCalls, aggCallMapping, true);
        case "COUNT":
```

### DataFlowIssue
Switch label `"COUNT"` is unreachable
in `pinot-query-planner/src/main/java/org/apache/calcite/rel/rules/PinotReduceAggregateFunctionsRule.java`
#### Snippet
```java
        case PinotKurtosisAggregateFunction.KURTOSIS:
          return reduceFourthMoment(oldAggRel, oldCall, newCalls, aggCallMapping, true);
        case "COUNT":
          return reduceCountDistinct(oldAggRel, oldCall, newCalls, aggCallMapping);
        default:
```

### DataFlowIssue
Method invocation `getReturnType` will produce `NullPointerException`
in `pinot-query-planner/src/main/java/org/apache/calcite/prepare/PinotCalciteCatalogReader.java`
#### Snippet
```java
            opBinding);
      } else {
        type = function.getReturnType(typeFactory);
      }
      return toSql(typeFactory, type);
```

### DataFlowIssue
Casting `left` to `Object[]` may produce `ClassCastException`
in `pinot-spi/src/main/java/org/apache/pinot/spi/utils/EqualityUtils.java`
#### Snippet
```java
        return Arrays.equals((byte[]) left, (byte[]) right);
      } else if (left.getClass().isArray() && right.getClass().isArray()) {
        return EqualityUtils.isEqual((Object[]) left, (Object[]) right);
      }
      return left.equals(right);
```

### DataFlowIssue
Method invocation `init` may produce `NullPointerException`
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/StreamConsumerFactoryProvider.java`
#### Snippet
```java
      ExceptionUtils.rethrow(e);
    }
    factory.init(streamConfig);
    return factory;
  }
```

### DataFlowIssue
Argument `file.list()` might be null
in `pinot-spi/src/main/java/org/apache/pinot/spi/filesystem/LocalPinotFS.java`
#### Snippet
```java
    File file = toFile(fileUri);
    if (!recursive) {
      return Arrays.stream(file.list()).map(s -> getFileMetadata(new File(file, s))).collect(Collectors.toList());
    } else {
      return Files.walk(Paths.get(fileUri)).filter(s -> !s.equals(file.toPath())).map(p -> getFileMetadata(p.toFile()))
```

### DataFlowIssue
Argument `file.list()` might be null
in `pinot-spi/src/main/java/org/apache/pinot/spi/filesystem/LocalPinotFS.java`
#### Snippet
```java
    File file = toFile(fileUri);
    if (!recursive) {
      return Arrays.stream(file.list()).map(s -> new File(file, s)).map(File::getAbsolutePath).toArray(String[]::new);
    } else {
      return Files.walk(Paths.get(fileUri)).
```

### DataFlowIssue
Method invocation `toString` may produce `NullPointerException`
in `pinot-plugins/pinot-minion-tasks/pinot-minion-builtin-tasks/src/main/java/org/apache/pinot/plugin/minion/tasks/BaseSingleSegmentConversionExecutor.java`
#### Snippet
```java
          TableNameBuilder.extractRawTableName(tableNameWithType));
      NameValuePair tableTypeParameter = new BasicNameValuePair(FileUploadDownloadClient.QueryParameters.TABLE_TYPE,
          TableNameBuilder.getTableTypeFromTableName(tableNameWithType).toString());
      List<NameValuePair> parameters = Arrays.asList(enableParallelPushProtectionParameter, tableNameParameter,
          tableTypeParameter);
```

### DataFlowIssue
Method invocation `name` may produce `NullPointerException`
in `pinot-plugins/pinot-minion-tasks/pinot-minion-builtin-tasks/src/main/java/org/apache/pinot/plugin/minion/tasks/SegmentConversionUtils.java`
#### Snippet
```java
    try (FileUploadDownloadClient fileUploadDownloadClient = new FileUploadDownloadClient(sslContext)) {
      URI uri = FileUploadDownloadClient
          .getStartReplaceSegmentsURI(new URI(uploadURL), rawTableName, tableType.name(), forceCleanup);
      SimpleHttpResponse response =
          fileUploadDownloadClient.startReplaceSegments(uri, startReplaceSegmentsRequest, authProvider);
```

### DataFlowIssue
Method invocation `toString` may produce `NullPointerException`
in `pinot-plugins/pinot-minion-tasks/pinot-minion-builtin-tasks/src/main/java/org/apache/pinot/plugin/minion/tasks/SegmentConversionUtils.java`
#### Snippet
```java
              endTimestamp, excludeOverlapping, authProvider);
      if (tableTypeToSegmentNames != null && !tableTypeToSegmentNames.isEmpty()) {
        List<String> allSegmentNameList = tableTypeToSegmentNames.get(tableType.toString());
        if (!CollectionUtils.isEmpty(allSegmentNameList)) {
          return new HashSet<>(allSegmentNameList);
```

### DataFlowIssue
Method invocation `name` may produce `NullPointerException`
in `pinot-plugins/pinot-minion-tasks/pinot-minion-builtin-tasks/src/main/java/org/apache/pinot/plugin/minion/tasks/SegmentConversionUtils.java`
#### Snippet
```java
    try (FileUploadDownloadClient fileUploadDownloadClient = new FileUploadDownloadClient(sslContext)) {
      URI uri = FileUploadDownloadClient
          .getEndReplaceSegmentsURI(new URI(uploadURL), rawTableName, tableType.name(), segmentLineageEntryId);
      SimpleHttpResponse response = fileUploadDownloadClient.endReplaceSegments(uri, socketTimeoutMs,
          endReplaceSegmentsRequest, authProvider);
```

### DataFlowIssue
Method invocation `toString` may produce `NullPointerException`
in `pinot-plugins/pinot-minion-tasks/pinot-minion-builtin-tasks/src/main/java/org/apache/pinot/plugin/minion/tasks/BaseMultipleSegmentsConversionExecutor.java`
#### Snippet
```java
            TableNameBuilder.extractRawTableName(tableNameWithType));
        NameValuePair tableTypeParameter = new BasicNameValuePair(FileUploadDownloadClient.QueryParameters.TABLE_TYPE,
            TableNameBuilder.getTableTypeFromTableName(tableNameWithType).toString());
        // RealtimeToOfflineSegmentsTask pushed segments to the corresponding offline table
        // TODO: This is not clean to put the override here, but let's think about it harder to see what is the proper
```

### DataFlowIssue
Method invocation `length` may produce `NullPointerException`
in `pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/TextTable.java`
#### Snippet
```java
      buf[i] = str.charAt(i);
    }
    for (int i = str.length(); i < size; i++) {
      buf[i] = padChar;
    }
```

### DataFlowIssue
Method invocation `substring` may produce `NullPointerException`
in `pinot-clients/pinot-java-client/src/main/java/org/apache/pinot/client/utils/ConnectionUtils.java`
#### Snippet
```java
    String userAgentFromProperties = userAgentProperties.getProperty(userAgentKey, "unknown");
    if (StringUtils.isNotEmpty(appId)) {
      return appId.substring(0, Math.min(APP_ID_MAX_CHARS, appId.length())) + "-" + userAgentFromProperties;
    }
    return userAgentFromProperties;
```

### DataFlowIssue
Method invocation `getBatchIngestionConfig` may produce `NullPointerException`
in `pinot-plugins/pinot-minion-tasks/pinot-minion-builtin-tasks/src/main/java/org/apache/pinot/plugin/minion/tasks/segmentgenerationandpush/SegmentGenerationAndPushTaskGenerator.java`
#### Snippet
```java
      }
      String batchSegmentIngestionType = IngestionConfigUtils.getBatchSegmentIngestionType(tableConfig);
      BatchIngestionConfig batchIngestionConfig = tableConfig.getIngestionConfig().getBatchIngestionConfig();
      List<Map<String, String>> batchConfigMaps = batchIngestionConfig.getBatchConfigMaps();
      for (Map<String, String> batchConfigMap : batchConfigMaps) {
```

### DataFlowIssue
Method invocation `getBatchConfigMaps` may produce `NullPointerException`
in `pinot-plugins/pinot-minion-tasks/pinot-minion-builtin-tasks/src/main/java/org/apache/pinot/plugin/minion/tasks/segmentgenerationandpush/SegmentGenerationAndPushTaskGenerator.java`
#### Snippet
```java
      String batchSegmentIngestionType = IngestionConfigUtils.getBatchSegmentIngestionType(tableConfig);
      BatchIngestionConfig batchIngestionConfig = tableConfig.getIngestionConfig().getBatchIngestionConfig();
      List<Map<String, String>> batchConfigMaps = batchIngestionConfig.getBatchConfigMaps();
      for (Map<String, String> batchConfigMap : batchConfigMaps) {
        try {
```

### DataFlowIssue
Dereference of `batchConfigMaps` may produce `NullPointerException`
in `pinot-plugins/pinot-minion-tasks/pinot-minion-builtin-tasks/src/main/java/org/apache/pinot/plugin/minion/tasks/segmentgenerationandpush/SegmentGenerationAndPushTaskGenerator.java`
#### Snippet
```java
      BatchIngestionConfig batchIngestionConfig = tableConfig.getIngestionConfig().getBatchIngestionConfig();
      List<Map<String, String>> batchConfigMaps = batchIngestionConfig.getBatchConfigMaps();
      for (Map<String, String> batchConfigMap : batchConfigMaps) {
        try {
          URI inputDirURI =
```

### DataFlowIssue
Method invocation `getKind` will produce `NullPointerException`
in `pinot-common/src/main/java/org/apache/pinot/sql/parsers/dml/DataManipulationStatementParser.java`
#### Snippet
```java
      return InsertIntoFile.parse(sqlNodeAndOptions);
    }
    throw new UnsupportedOperationException("Unsupported DML SqlKind - " + sqlNode.getKind());
  }
}
```

### DataFlowIssue
Method invocation `getConfigsForTaskType` may produce `NullPointerException`
in `pinot-plugins/pinot-minion-tasks/pinot-minion-builtin-tasks/src/main/java/org/apache/pinot/plugin/minion/tasks/mergerollup/MergeRollupTaskGenerator.java`
#### Snippet
```java

      // Sort merge levels based on bucket time period
      Map<String, String> taskConfigs = tableConfig.getTaskConfig().getConfigsForTaskType(taskType);
      Map<String, Map<String, String>> mergeLevelToConfigs = MergeRollupTaskUtils.getLevelToConfigMap(taskConfigs);
      List<Map.Entry<String, Map<String, String>>> sortedMergeLevelConfigs =
```

### DataFlowIssue
Method invocation `getConfigsForTaskType` may produce `NullPointerException`
in `pinot-plugins/pinot-minion-tasks/pinot-minion-builtin-tasks/src/main/java/org/apache/pinot/plugin/minion/tasks/mergerollup/MergeRollupTaskGenerator.java`
#### Snippet
```java

      // Task config is modified and some merge level got removed
      Map<String, String> taskConfigs = currentTableConfig.getTaskConfig().getConfigsForTaskType(getTaskType());
      Map<String, Map<String, String>> mergeLevelToConfigs = MergeRollupTaskUtils.getLevelToConfigMap(taskConfigs);
      Map<String, Long> tableToWatermark = _mergeRollupWatermarks.get(tableNameWithType);
```

### DataFlowIssue
Dereference of `((SqlIdentifier) fromNode)` may produce `NullPointerException`
in `pinot-common/src/main/java/org/apache/pinot/sql/parsers/CalciteSqlParser.java`
#### Snippet
```java
        tableNames.addAll(extractTableNamesFromNode(((SqlBasicCall) fromNode).getOperandList().get(0)));
      } else {
        tableNames.addAll(((SqlIdentifier) fromNode).names);
        tableNames.addAll(extractTableNamesFromNode(((SqlSelect) sqlNode).getWhere()));
      }
```

### DataFlowIssue
Variable is already assigned to this value
in `pinot-common/src/main/java/org/apache/pinot/sql/parsers/CalciteSqlParser.java`
#### Snippet
```java
        if (sqlType == null) {
          sqlType = PinotSqlType.DQL;
          statementNode = sqlNode;
        } else {
          throw new SqlCompilationException("SqlNode with executable statement already exist with type: " + sqlType);
```

### DataFlowIssue
Method invocation `toString` will produce `NullPointerException`
in `pinot-common/src/main/java/org/apache/pinot/common/utils/SqlResultComparator.java`
#### Snippet
```java
    for (SqlNode node : orderList) {
      String columnName =
          node instanceof SqlCall ? ((SqlCall) node).getOperandList().get(0).toString() : node.toString();
      orderByColumnNames.add(columnName);
    }
```

### DataFlowIssue
Method invocation `get` may produce `NullPointerException`
in `pinot-common/src/main/java/org/apache/pinot/common/utils/helix/PinotHelixPropertyStoreZnRecordProvider.java`
#### Snippet
```java

  public ZNRecord get(String name) {
    return _propertyStore.get(_pathPrefix + "/" + name, null, AccessOption.PERSISTENT);
  }

```

### DataFlowIssue
Method invocation `set` may produce `NullPointerException`
in `pinot-common/src/main/java/org/apache/pinot/common/utils/helix/PinotHelixPropertyStoreZnRecordProvider.java`
#### Snippet
```java

  public void set(String name, ZNRecord record) {
    _propertyStore.set(_pathPrefix + "/" + name, record, AccessOption.PERSISTENT);
  }

```

### DataFlowIssue
Method invocation `exists` may produce `NullPointerException`
in `pinot-common/src/main/java/org/apache/pinot/common/utils/helix/PinotHelixPropertyStoreZnRecordProvider.java`
#### Snippet
```java

  public boolean exist(String path) {
    return _propertyStore.exists(_pathPrefix + "/" + path, AccessOption.PERSISTENT);
  }

```

### DataFlowIssue
Method invocation `getPartitionSet` may produce `NullPointerException`
in `pinot-common/src/main/java/org/apache/pinot/common/utils/helix/HelixHelper.java`
#### Snippet
```java
      @Override
      public IdealState apply(IdealState idealState) {
        if (idealState.getPartitionSet().contains(resourceTag)) {
          idealState.getPartitionSet().remove(resourceTag);
          return idealState;
```

### DataFlowIssue
Method invocation `getTypeName` will produce `NullPointerException`
in `pinot-common/src/main/java/org/apache/pinot/common/utils/request/RequestUtils.java`
#### Snippet
```java
      }
    } else {
      switch (node.getTypeName()) {
        case BOOLEAN:
          literal.setBoolValue(node.booleanValue());
```

### DataFlowIssue
@Nullable method 'getAllUserInfo' always returns a non-null value
in `pinot-common/src/main/java/org/apache/pinot/common/metadata/ZKMetadataProvider.java`
#### Snippet
```java
  }

  @Nullable
  public static Map<String, UserConfig> getAllUserInfo(ZkHelixPropertyStore<ZNRecord> propertyStore) {
    return getAllUserConfig(propertyStore).stream()
```

### DataFlowIssue
Method invocation `stream` may produce `NullPointerException`
in `pinot-common/src/main/java/org/apache/pinot/common/metadata/ZKMetadataProvider.java`
#### Snippet
```java
  @Nullable
  public static Map<String, UserConfig> getAllUserInfo(ZkHelixPropertyStore<ZNRecord> propertyStore) {
    return getAllUserConfig(propertyStore).stream()
        .collect(Collectors.toMap(UserConfig::getUsernameWithComponent, u -> u));
  }
```

### DataFlowIssue
Method invocation `stream` may produce `NullPointerException`
in `pinot-common/src/main/java/org/apache/pinot/common/assignment/InstancePartitionsUtils.java`
#### Snippet
```java
      String tableNameWithType) {
    List<InstancePartitions> instancePartitions = ZKMetadataProvider.getAllInstancePartitions(propertyStore);
    instancePartitions.stream().filter(instancePartition -> instancePartition.getInstancePartitionsName()
            .startsWith(TableNameBuilder.extractRawTableName(tableNameWithType) + TIER_SUFFIX))
        .forEach(instancePartition -> {
```

### DataFlowIssue
Method invocation `getNumPartitions` may produce `NullPointerException`
in `pinot-common/src/main/java/org/apache/pinot/common/assignment/InstanceAssignmentConfigUtils.java`
#### Snippet
```java
    boolean minimizeDataMovement = segmentConfig.isMinimizeDataMovement();
    if (partitionColumn != null) {
      int numPartitions = tableConfig.getIndexingConfig().getSegmentPartitionConfig().getNumPartitions(partitionColumn);
      Preconditions.checkState(numPartitions > 0, "Number of partitions for column: %s is not properly configured",
          partitionColumn);
```

### DataFlowIssue
Method invocation `getIndexingConfig` may produce `NullPointerException`
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/RealtimeTableDataManager.java`
#### Snippet
```java

    // Start a new consuming segment
    if (!isValid(schema, tableConfig.getIndexingConfig())) {
      _logger.error("Not adding segment {}", segmentName);
      throw new RuntimeException("Mismatching schema/table config for " + _tableNameWithType);
```

### DataFlowIssue
Array access `tempSegmentFolder.listFiles()[0]` may produce `NullPointerException`
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/HLRealtimeSegmentDataManager.java`
#### Snippet
```java
          File destDir = new File(resourceDataDir, segmentZKMetadata.getSegmentName());
          FileUtils.deleteQuietly(destDir);
          FileUtils.moveDirectory(tempSegmentFolder.listFiles()[0], destDir);

          FileUtils.deleteQuietly(tempSegmentFolder);
```

### DataFlowIssue
Method invocation `isNullHandlingEnabled` may produce `NullPointerException`
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/HLRealtimeSegmentDataManager.java`
#### Snippet
```java
                indexLoadingConfig.isDirectRealtimeOffHeapAllocation(), serverMetrics))
            .setStatsHistory(realtimeTableDataManager.getStatsHistory())
            .setNullHandlingEnabled(indexingConfig.isNullHandlingEnabled()).build();
    _realtimeSegment = new MutableSegmentImpl(realtimeSegmentConfig, serverMetrics);

```

### DataFlowIssue
Method invocation `getSelectExpressions` may produce `NullPointerException`
in `pinot-core/src/main/java/org/apache/pinot/core/util/GapfillUtils.java`
#### Snippet
```java
      queryContext = queryContext.getSubquery();
    }
    List<ExpressionContext> expressionContexts = queryContext.getSelectExpressions();
    for (int i = 0; i < expressionContexts.size(); i++) {
      if (isGapfill(expressionContexts.get(i))) {
```

### DataFlowIssue
Argument `queryContext.getSubquery()` might be null
in `pinot-core/src/main/java/org/apache/pinot/core/util/GapfillUtils.java`
#### Snippet
```java
    } else if (gapfillType == GapfillType.GAP_FILL_AGGREGATE || gapfillType == GapfillType.AGGREGATE_GAP_FILL_AGGREGATE
        || gapfillType == GapfillType.GAP_FILL_SELECT) {
      return findGapfillExpressionContext(queryContext.getSubquery());
    } else {
      return null;
```

### DataFlowIssue
Argument `_dataSchema` might be null
in `pinot-core/src/main/java/org/apache/pinot/core/query/reduce/SelectionOnlyStreamingReducer.java`
#### Snippet
```java
    } else {
      // For empty data table map, construct empty result using the cached data schema for selection query
      DataSchema selectionDataSchema = SelectionOperatorUtils.getResultTableDataSchema(_dataSchema, selectionColumns);
      brokerResponseNative.setResultTable(new ResultTable(selectionDataSchema, Collections.emptyList()));
    }
```

### DataFlowIssue
Method invocation `getLimit` may produce `NullPointerException`
in `pinot-core/src/main/java/org/apache/pinot/core/query/reduce/BaseGapfillProcessor.java`
#### Snippet
```java
      _limitForGapfilledResult = queryContext.getLimit();
    } else {
      _limitForGapfilledResult = queryContext.getSubquery().getLimit();
    }

```

### DataFlowIssue
Method invocation `getFunction` may produce `NullPointerException`
in `pinot-core/src/main/java/org/apache/pinot/core/query/reduce/BaseGapfillProcessor.java`
#### Snippet
```java

    ExpressionContext timeseriesOn = GapfillUtils.getTimeSeriesOnExpressionContext(_gapFillSelection);
    _timeSeries = timeseriesOn.getFunction().getArguments();
  }

```

### DataFlowIssue
Method invocation `getSubquery` may produce `NullPointerException`
in `pinot-core/src/main/java/org/apache/pinot/core/query/reduce/BaseGapfillProcessor.java`
#### Snippet
```java
    QueryContext queryContext;
    if (_gapfillType == GapfillUtils.GapfillType.AGGREGATE_GAP_FILL_AGGREGATE) {
      queryContext = _queryContext.getSubquery().getSubquery();
    } else if (_gapfillType == GapfillUtils.GapfillType.GAP_FILL) {
      queryContext = _queryContext;
```

### DataFlowIssue
Method invocation `getAliasList` may produce `NullPointerException`
in `pinot-core/src/main/java/org/apache/pinot/core/query/reduce/BaseGapfillProcessor.java`
#### Snippet
```java
      queryContext = _queryContext.getSubquery();
    }
    List<String> aliasList = queryContext.getAliasList();
    Map<String, String> columnNameToAliasMap = new HashMap<>();
    for (int i = 0; i < aliasList.size(); i++) {
```

### DataFlowIssue
Variable is already assigned to this value
in `pinot-core/src/main/java/org/apache/pinot/core/query/reduce/ExecutionStatsAggregator.java`
#### Snippet
```java
      instanceName = tableName;
    } else {
      tableType = null;
      instanceName = null;
    }
```

### DataFlowIssue
Variable is already assigned to this value
in `pinot-core/src/main/java/org/apache/pinot/core/query/reduce/ExecutionStatsAggregator.java`
#### Snippet
```java
    } else {
      tableType = null;
      instanceName = null;
    }

```

### DataFlowIssue
Argument `schema` might be null
in `pinot-core/src/main/java/org/apache/pinot/core/query/optimizer/filter/NumericalFilterOptimizer.java`
#### Snippet
```java
              case LESS_THAN:
              case LESS_THAN_OR_EQUAL:
                return rewriteRangeExpression(filterExpression, kind, lhs, rhs, schema);
              default:
                break;
```

### DataFlowIssue
Method invocation `startQuery` may produce `NullPointerException`
in `pinot-core/src/main/java/org/apache/pinot/core/query/scheduler/PriorityScheduler.java`
#### Snippet
```java
            }, MoreExecutors.directExecutor());
            request.setResultFuture(queryFutureTask);
            request.getSchedulerGroup().startQuery();
            queryRequest.getTimerContext().getPhaseTimer(ServerQueryPhase.SCHEDULER_WAIT).stopAndRecord();
            _resourceManager.getQueryRunners().submit(queryFutureTask);
```

### DataFlowIssue
Method invocation `stopAndRecord` may produce `NullPointerException`
in `pinot-core/src/main/java/org/apache/pinot/core/query/scheduler/PriorityScheduler.java`
#### Snippet
```java
            request.setResultFuture(queryFutureTask);
            request.getSchedulerGroup().startQuery();
            queryRequest.getTimerContext().getPhaseTimer(ServerQueryPhase.SCHEDULER_WAIT).stopAndRecord();
            _resourceManager.getQueryRunners().submit(queryFutureTask);
          } catch (Throwable t) {
```

### DataFlowIssue
Method invocation `endQuery` may produce `NullPointerException`
in `pinot-core/src/main/java/org/apache/pinot/core/query/scheduler/PriorityScheduler.java`
#### Snippet
```java
              public void run() {
                executor.releaseWorkers();
                request.getSchedulerGroup().endQuery();
                _runningQueriesSemaphore.release();
                checkStopResourceManager();
```

### DataFlowIssue
Method invocation `hasColumn` may produce `NullPointerException`
in `pinot-core/src/main/java/org/apache/pinot/core/query/optimizer/statement/JsonStatementOptimizer.java`
#### Snippet
```java
        boolean hasJsonPathExpression = false;
        String columnName = expression.getIdentifier().getName();
        if (!schema.hasColumn(columnName)) {
          String[] parts = getIdentifierParts(expression.getIdentifier());
          if (parts.length > 1 && isValidJSONColumn(parts[0], schema)) {
```

### DataFlowIssue
Method invocation `hasColumn` may produce `NullPointerException`
in `pinot-core/src/main/java/org/apache/pinot/core/query/optimizer/statement/JsonStatementOptimizer.java`
#### Snippet
```java
          Expression right = operands.get(1);
          if (left.getType() == ExpressionType.IDENTIFIER && right.getType() == ExpressionType.LITERAL) {
            if (!schema.hasColumn(left.getIdentifier().getName())) {
              String[] parts = getIdentifierParts(left.getIdentifier());
              if (parts.length > 1 && isValidJSONColumn(parts[0], schema)) {
```

### DataFlowIssue
Method invocation `hasColumn` may produce `NullPointerException`
in `pinot-core/src/main/java/org/apache/pinot/core/query/optimizer/statement/JsonStatementOptimizer.java`
#### Snippet
```java
          Expression operand = operands.get(0);
          if (operand.getType() == ExpressionType.IDENTIFIER) {
            if (!schema.hasColumn(operand.getIdentifier().getName())) {
              String[] parts = getIdentifierParts(operand.getIdentifier());
              if (parts.length > 1 && isValidJSONColumn(parts[0], schema)) {
```

### DataFlowIssue
Method invocation `stream` may produce `NullPointerException`
in `pinot-core/src/main/java/org/apache/pinot/core/operator/query/SelectionPartiallyOrderedByAscOperator.java`
#### Snippet
```java
      List<ExpressionContext> expressions, BaseProjectOperator<?> projectOperator, int numSortedExpressions) {
    super(indexSegment, queryContext, expressions, projectOperator, numSortedExpressions);
    Preconditions.checkArgument(queryContext.getOrderByExpressions().stream()
            .filter(expr -> expr.getExpression().getType() == ExpressionContext.Type.IDENTIFIER)
            .findFirst()
```

### DataFlowIssue
Array access `docIds[rowId]` may produce `NullPointerException`
in `pinot-core/src/main/java/org/apache/pinot/core/operator/query/SelectionOrderByOperator.java`
#### Snippet
```java
          Object[] row = new Object[numExpressions];
          blockValueFetcher.getRow(rowId, row, 0);
          row[numOrderByExpressions] = docIds[rowId];
          for (int colId = 0; colId < numOrderByExpressions; colId++) {
            if (nullBitmaps[colId] != null && nullBitmaps[colId].contains(rowId)) {
```

### DataFlowIssue
Array access `docIds[i]` may produce `NullPointerException`
in `pinot-core/src/main/java/org/apache/pinot/core/operator/query/SelectionOrderByOperator.java`
#### Snippet
```java
          Object[] row = new Object[numExpressions];
          blockValueFetcher.getRow(i, row, 0);
          row[numOrderByExpressions] = docIds[i];
          SelectionOperatorUtils.addToPriorityQueue(row, _rows, _numRowsToKeep);
        }
```

### DataFlowIssue
Method invocation `forEach` may produce `NullPointerException`
in `pinot-core/src/main/java/org/apache/pinot/core/operator/transform/function/DistinctFromTransformFunction.java`
#### Snippet
```java
    if (isEmpty(leftNull)) {
      // Mark right null rows as distinct.
      rightNull.forEach((IntConsumer) i -> _intValuesSV[i] = _distinctResult);
      return _intValuesSV;
    }
```

### DataFlowIssue
Array index is out of bounds
in `pinot-core/src/main/java/org/apache/pinot/core/operator/transform/function/DistinctFromTransformFunction.java`
#### Snippet
```java
    if (isEmpty(leftNull)) {
      // Mark right null rows as distinct.
      rightNull.forEach((IntConsumer) i -> _intValuesSV[i] = _distinctResult);
      return _intValuesSV;
    }
```

### DataFlowIssue
Array index is out of bounds
in `pinot-core/src/main/java/org/apache/pinot/core/operator/transform/function/DistinctFromTransformFunction.java`
#### Snippet
```java
    if (isEmpty(rightNull)) {
      // Mark left null rows as distinct.
      leftNull.forEach((IntConsumer) i -> _intValuesSV[i] = _distinctResult);
      return _intValuesSV;
    }
```

### DataFlowIssue
Array index is out of bounds
in `pinot-core/src/main/java/org/apache/pinot/core/operator/transform/function/DistinctFromTransformFunction.java`
#### Snippet
```java
    RoaringBitmap xorNull = RoaringBitmap.xor(leftNull, rightNull);
    // For rows that with one null and one not null, mark them as distinct
    xorNull.forEach((IntConsumer) i -> _intValuesSV[i] = _distinctResult);
    RoaringBitmap andNull = RoaringBitmap.and(leftNull, rightNull);
    // For rows that are both null, mark them as not distinct.
```

### DataFlowIssue
Array index is out of bounds
in `pinot-core/src/main/java/org/apache/pinot/core/operator/transform/function/DistinctFromTransformFunction.java`
#### Snippet
```java
    RoaringBitmap andNull = RoaringBitmap.and(leftNull, rightNull);
    // For rows that are both null, mark them as not distinct.
    andNull.forEach((IntConsumer) i -> _intValuesSV[i] = _notDistinctResult);
    return _intValuesSV;
  }
```

### DataFlowIssue
Method invocation `contains` will produce `NullPointerException`
in `pinot-core/src/main/java/org/apache/pinot/core/operator/transform/function/GreatestTransformFunction.java`
#### Snippet
```java
      for (int j = 0; j < numDocs & j < values.getLeft().length; j++) {
        // If current value is not null, we process the data.
        if (curNull != null || !curNull.contains(j)) {
          // If existing maximum value is null, we set the value directly.
          if (nullBitmap != null && nullBitmap.contains(j)) {
```

### DataFlowIssue
Method invocation `contains` will produce `NullPointerException`
in `pinot-core/src/main/java/org/apache/pinot/core/operator/transform/function/LeastTransformFunction.java`
#### Snippet
```java
      for (int j = 0; j < numDocs & j < values.getLeft().length; j++) {
        // If current value is not null, we process the data.
        if (curNull != null || !curNull.contains(j)) {
          // If existing minimum value is null, we set the value directly.
          if (nullBitmap != null && nullBitmap.contains(j)) {
```

### DataFlowIssue
Array index is out of bounds
in `pinot-core/src/main/java/org/apache/pinot/core/operator/transform/function/ScalarTransformFunctionWrapper.java`
#### Snippet
```java
        int finalI = i;
        bitmap.forEach((IntConsumer) (j) -> {
          _nonLiteralValues[finalI][j] = null;
        });
      }
```

### DataFlowIssue
Method invocation `sendRequest` may produce `NullPointerException`
in `pinot-core/src/main/java/org/apache/pinot/core/transport/QueryRouter.java`
#### Snippet
```java
        // submission stats.
        _serverRoutingStatsManager.recordStatsAfterQuerySubmission(requestId, serverRoutingInstance.getInstanceId());
        serverChannels.sendRequest(rawTableName, asyncQueryResponse, serverRoutingInstance, entry.getValue(),
            timeoutMs);
        asyncQueryResponse.markRequestSubmitted(serverRoutingInstance);
```

### DataFlowIssue
Method invocation `toUpperCase` may produce `NullPointerException`
in `pinot-minion/src/main/java/org/apache/pinot/minion/api/resources/PinotTaskProgressResource.java`
#### Snippet
```java
        MinionTaskState minionTaskState = MinionTaskState.IN_PROGRESS;
        try {
          minionTaskState = MinionTaskState.valueOf(subTaskState.toUpperCase());
        } catch (IllegalArgumentException e) {
          LOGGER.warn("{} is not a valid subtask state, defaulting to IN_PROGRESS", subTaskState);
```

### DataFlowIssue
Method invocation `getDescriptorFile` may produce `NullPointerException`
in `pinot-plugins/pinot-input-format/pinot-protobuf/src/main/java/org/apache/pinot/plugin/inputformat/protobuf/ProtoBufRecordReader.java`
#### Snippet
```java
    _dataFile = dataFile;
    ProtoBufRecordReaderConfig protoBufRecordReaderConfig = (ProtoBufRecordReaderConfig) recordReaderConfig;
    Preconditions.checkNotNull(protoBufRecordReaderConfig.getDescriptorFile(),
        "Protocol Buffer schema descriptor file must be provided");
    Descriptors.Descriptor descriptor = buildProtoBufDescriptor(protoBufRecordReaderConfig);
```

### DataFlowIssue
Method invocation `substring` may produce `NullPointerException`
in `pinot-clients/pinot-jdbc-client/src/main/java/org/apache/pinot/client/controller/PinotControllerTransport.java`
#### Snippet
```java
    if (StringUtils.isNotEmpty(appId)) {
      return
          appId.substring(0, Math.min(org.apache.pinot.client.utils.ConnectionUtils.APP_ID_MAX_CHARS, appId.length()))
              + "-" + userAgentFromProperties;
    }
```

### DataFlowIssue
Method invocation `getFile` may produce `NullPointerException`
in `pinot-controller/src/main/java/org/apache/pinot/controller/ControllerStarter.java`
#### Snippet
```java
    conf.setHelixClusterName("quickstart");
    if (webappPath == null) {
      String path = ControllerStarter.class.getClassLoader().getResource("webapp").getFile();
      if (!path.startsWith("file://")) {
        path = "file://" + path;
```

### DataFlowIssue
Method invocation `toExternalForm` may produce `NullPointerException`
in `pinot-controller/src/main/java/org/apache/pinot/controller/ControllerConf.java`
#### Snippet
```java
    return Optional.ofNullable(getProperty(CONSOLE_WEBAPP_ROOT_PATH))

        .orElseGet(() -> ControllerConf.class.getClassLoader().getResource("webapp").toExternalForm());
  }

```

### DataFlowIssue
Method invocation `getPrimaryKeyColumns` may produce `NullPointerException`
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotUpsertRestletResource.java`
#### Snippet
```java
    // Estimated key space, it contains primary key columns.
    int bytesPerKey = 0;
    List<String> primaryKeys = schema.getPrimaryKeyColumns();

    if (primaryKeySize > 0) {
```

### DataFlowIssue
Method invocation `getComparisonColumns` may produce `NullPointerException`
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotUpsertRestletResource.java`
#### Snippet
```java
    // Here we only calculate the map content size. TODO: Add the map entry size and the array size within the map.
    int bytesPerValue = 60;
    List<String> comparisonColumns = tableConfig.getUpsertConfig().getComparisonColumns();
    if (comparisonColumns != null) {
      int bytesPerArrayElem = 8;  // object ref
```

### DataFlowIssue
Method invocation `isSuccessful` may produce `NullPointerException`
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotTenantRestletResource.java`
#### Snippet
```java
        break;
    }
    if (res.isSuccessful()) {
      return new SuccessResponse("Successfully deleted tenant " + tenantName);
    }
```

### DataFlowIssue
Argument `_pinotHelixResourceManager.getHelixInstanceConfig(instanceName)` might be null
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotControllerLogger.java`
#### Snippet
```java

  private String getInstanceBaseUri(String instanceName) {
    return InstanceUtils.getInstanceBaseUri(_pinotHelixResourceManager.getHelixInstanceConfig(instanceName));
  }
}
```

### DataFlowIssue
Method invocation `name` may produce `NullPointerException`
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotAccessControlUserRestletResource.java`
#### Snippet
```java
            ZkHelixPropertyStore<ZNRecord> propertyStore = _pinotHelixResourceManager.getPropertyStore();
            ComponentType componentType = Constants.validateComponentType(componentTypeStr);
            String usernameWithType = username + "_" + componentType.name();

            UserConfig userConfig = ZKMetadataProvider.getUserConfig(propertyStore, usernameWithType);
```

### DataFlowIssue
Method invocation `getTaskConfig` may produce `NullPointerException`
in `pinot-controller/src/main/java/org/apache/pinot/controller/util/TableIngestionStatusHelper.java`
#### Snippet
```java
    // Offline table ingestion status for ingestion via other task types is not supported.
    TableConfig tableConfig = pinotHelixResourceManager.getTableConfig(tableNameWithType);
    TableTaskConfig taskConfig = tableConfig.getTaskConfig();
    if (taskConfig == null
        || taskConfig.getConfigsForTaskType(MinionConstants.SegmentGenerationAndPushTask.TASK_TYPE) == null) {
```

### DataFlowIssue
Method invocation `isEmpty` may produce `NullPointerException`
in `pinot-controller/src/main/java/org/apache/pinot/controller/util/AutoAddInvertedIndex.java`
#### Snippet
```java
      // Handle auto-generated inverted index
      if (autoGeneratedInvertedIndex) {
        Preconditions.checkState(!invertedIndexColumns.isEmpty(), "Auto-generated inverted index list is empty");

        // NEW mode, skip
```

### DataFlowIssue
Method invocation `getStartTimeMs` may produce `NullPointerException`
in `pinot-controller/src/main/java/org/apache/pinot/controller/util/TableRetentionValidator.java`
#### Snippet
```java
        SegmentZKMetadata segmentMetadata =
            ZKMetadataProvider.getSegmentZKMetadata(_propertyStore, tableNameWithType, segmentName);
        long startTimeMs = segmentMetadata.getStartTimeMs();
        if (!TimeUtils.timeValueInValidRange(startTimeMs)) {
          errorMessages.add("Segment: " + segmentName + " has invalid start time in millis: " + startTimeMs);
```

### DataFlowIssue
Method invocation `getGroupId` may produce `NullPointerException`
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/realtime/PinotRealtimeSegmentManager.java`
#### Snippet
```java
          for (String instanceId : instancesToAssignRealtimeSegment) {
            InstanceZKMetadata instanceZKMetadata = _pinotHelixResourceManager.getInstanceZKMetadata(instanceId);
            String groupId = instanceZKMetadata.getGroupId(realtimeTableName);
            String partitionId = instanceZKMetadata.getPartition(realtimeTableName);
            listOfSegmentsToAddToInstances.add(Pair.of(
```

### DataFlowIssue
Method invocation `nonLeaderCleanUp` may produce `NullPointerException`
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/minion/PinotTaskManager.java`
#### Snippet
```java
    LOGGER.info("Cleaning up all task generators");
    for (String taskType : _taskGeneratorRegistry.getAllTaskTypes()) {
      _taskGeneratorRegistry.getTaskGenerator(taskType).nonLeaderCleanUp();
    }
  }
```

### DataFlowIssue
Method invocation `contains` may produce `NullPointerException`
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/PinotHelixResourceManager.java`
#### Snippet
```java
      if (!Message.MessageType.STATE_TRANSITION.name().equalsIgnoreCase(message.getMsgType()) || !sessionId.equals(
          message.getTgtSessionId()) || !resourceName.equals(message.getResourceName())
          || !resetPartitionNames.contains(message.getPartitionName())) {
        continue;
      }
```

### DataFlowIssue
Dereference of `resetPartitionNames` may produce `NullPointerException`
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/PinotHelixResourceManager.java`
#### Snippet
```java
    List<Message> resetMessages = new ArrayList<>();
    List<PropertyKey> messageKeys = new ArrayList<>();
    for (String partitionName : resetPartitionNames) {
      // send currentState to initialState message
      String msgId = UUID.randomUUID().toString();
```

### DataFlowIssue
Method invocation `stream` may produce `NullPointerException`
in `pinot-controller/src/main/java/org/apache/pinot/controller/helix/core/PinotHelixResourceManager.java`
#### Snippet
```java

  public boolean hasUser(String username, String component) {
    return ZKMetadataProvider.getAllUserConfig(_propertyStore).stream()
        .anyMatch(user -> user.isExist(username, ComponentType.valueOf(component)));
  }
```

### DataFlowIssue
Method invocation `openStream` may produce `NullPointerException`
in `pinot-connectors/pinot-flink-connector/src/main/java/org/apache/pinot/connector/flink/FlinkQuickStart.java`
#### Snippet
```java
    ClassLoader classLoader = FlinkQuickStart.class.getClassLoader();
    final URL resource = classLoader.getResource("starbucks-stores-world.csv");
    try (BufferedReader br = new BufferedReader(new InputStreamReader(resource.openStream()))) {
      String line = null;
      while ((line = br.readLine()) != null) {
```

### DataFlowIssue
Method invocation `getFormatSpec` may produce `NullPointerException`
in `pinot-compatibility-verifier/src/main/java/org/apache/pinot/compat/StreamOp.java`
#### Snippet
```java
              .forSchemaGet(schemaName));
      Schema schema = JsonUtils.stringToObject(schemaString, Schema.class);
      DateTimeFormatSpec dateTimeFormatSpec = schema.getSpecForTimeColumn(timeColumn).getFormatSpec();

      try (RecordReader csvRecordReader = RecordReaderFactory
```

### DataFlowIssue
@Nullable method 'apply' always returns a non-null value
in `pinot-tools/src/main/java/org/apache/pinot/tools/PinotNumReplicaChanger.java`
#### Snippet
```java
      } else {
        HelixHelper.updateIdealState(_helixManager, offlineTableName, new Function<IdealState, IdealState>() {
          @Nullable
          @Override
          public IdealState apply(IdealState idealState) {
```

### DataFlowIssue
Method invocation `getReplication` may produce `NullPointerException`
in `pinot-tools/src/main/java/org/apache/pinot/tools/PinotNumReplicaChanger.java`
#### Snippet
```java
    final String offlineTableName = TableNameBuilder.OFFLINE.tableNameWithType(tableName);
    final TableConfig offlineTableConfig = ZKMetadataProvider.getOfflineTableConfig(_propertyStore, offlineTableName);
    final int newNumReplicas = offlineTableConfig.getReplication();

    // Now get the idealstate, and get the number of replicas in it.
```

### DataFlowIssue
Method invocation `equals` may produce `NullPointerException`
in `pinot-tools/src/main/java/org/apache/pinot/tools/UpdateSegmentState.java`
#### Snippet
```java
    for (ZNRecord znRecord : tableConfigs) {
      TableConfig tableConfig = TableConfigUtils.fromZNRecord(znRecord);
      if (tableConfig.getTenantConfig().getServer().equals(_tenantName)) {
        tables.add(tableConfig.getTableName());
      }
```

### DataFlowIssue
Method invocation `getBatchIngestionConfig` may produce `NullPointerException`
in `pinot-tools/src/main/java/org/apache/pinot/tools/BootstrapTableTool.java`
#### Snippet
```java
      throws Exception {
    final List<Map<String, String>> batchConfigsMaps =
        tableConfig.getIngestionConfig().getBatchIngestionConfig().getBatchConfigMaps();
    for (Map<String, String> batchConfigsMap : batchConfigsMaps) {
      String inputDirURI = batchConfigsMap.get(BatchConfigProperties.INPUT_DIR_URI);
```

### DataFlowIssue
Method invocation `getBatchConfigMaps` may produce `NullPointerException`
in `pinot-tools/src/main/java/org/apache/pinot/tools/BootstrapTableTool.java`
#### Snippet
```java
      throws Exception {
    final List<Map<String, String>> batchConfigsMaps =
        tableConfig.getIngestionConfig().getBatchIngestionConfig().getBatchConfigMaps();
    for (Map<String, String> batchConfigsMap : batchConfigsMaps) {
      String inputDirURI = batchConfigsMap.get(BatchConfigProperties.INPUT_DIR_URI);
```

### DataFlowIssue
Dereference of `batchConfigsMaps` may produce `NullPointerException`
in `pinot-tools/src/main/java/org/apache/pinot/tools/BootstrapTableTool.java`
#### Snippet
```java
    final List<Map<String, String>> batchConfigsMaps =
        tableConfig.getIngestionConfig().getBatchIngestionConfig().getBatchConfigMaps();
    for (Map<String, String> batchConfigsMap : batchConfigsMaps) {
      String inputDirURI = batchConfigsMap.get(BatchConfigProperties.INPUT_DIR_URI);
      if (!new File(inputDirURI).exists()) {
```

### DataFlowIssue
Method invocation `toString` may produce `NullPointerException`
in `pinot-tools/src/main/java/org/apache/pinot/tools/BootstrapTableTool.java`
#### Snippet
```java
              spec.setInputDirURI(inputDir);
            } else {
              spec.setInputDirURI(resolvedInputDirURI.toString());
            }
          }
```

### DataFlowIssue
@Nullable method 'makeAuthProvider' always returns a non-null value
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AbstractBaseAdminCommand.java`
#### Snippet
```java
   * @return auth provider, or NullauthProvider if neither pass-thru token nor user info available
   */
  @Nullable
  static AuthProvider makeAuthProvider(AuthProvider provider, String tokenUrl, String authToken, String user,
      String password) {
```

### DataFlowIssue
Method invocation `getValidationConfig` may produce `NullPointerException`
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/OfflineSegmentIntervalCheckerCommand.java`
#### Snippet
```java
    // Collect segments with invalid start/end time
    List<String> segmentsWithInvalidIntervals = new ArrayList<>();
    if (SegmentIntervalUtils.eligibleForSegmentIntervalCheck(tableConfig.getValidationConfig())) {
      for (SegmentZKMetadata segmentZKMetadata : segmentsZKMetadata) {
        long startTimeMs = segmentZKMetadata.getStartTimeMs();
```

### DataFlowIssue
Dereference of `serverFiles` may produce `NullPointerException`
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StopProcessCommand.java`
#### Snippet
```java
      });

      for (File serverFile : serverFiles) {
        processes.put(serverFile.getName(), serverFile.getAbsolutePath());
      }
```

### DataFlowIssue
Dereference of `serverFiles` may produce `NullPointerException`
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StopProcessCommand.java`
#### Snippet
```java
      });

      for (File serverFile : serverFiles) {
        processes.put(serverFile.getName(), serverFile.getAbsolutePath());
      }
```

### DataFlowIssue
Dereference of `serverFiles` may produce `NullPointerException`
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StopProcessCommand.java`
#### Snippet
```java
      });

      for (File serverFile : serverFiles) {
        processes.put(serverFile.getName(), serverFile.getAbsolutePath());
      }
```

### DataFlowIssue
@Nullable method 'apply' always returns a non-null value
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/MoveReplicaGroup.java`
#### Snippet
```java
  private void applyIdealState(final Map<String, Map<String, String>> proposedIdealState) {
    HelixHelper.updateIdealState(_zkChanger.getHelixManager(), _tableName, new Function<IdealState, IdealState>() {
      @Nullable
      @Override
      public IdealState apply(@Nullable IdealState input) {
```

### DataFlowIssue
Method invocation `getRecord` may produce `NullPointerException`
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/MoveReplicaGroup.java`
#### Snippet
```java
      @Override
      public IdealState apply(@Nullable IdealState input) {
        Map<String, Map<String, String>> existingMapField = input.getRecord().getMapFields();

        for (Map.Entry<String, Map<String, String>> segmentEntry : proposedIdealState.entrySet()) {
```

### DataFlowIssue
Dereference of `_segmentDirectories` may produce `NullPointerException`
in `pinot-tools/src/main/java/org/apache/pinot/tools/anonymizer/PinotDataAndQueryAnonymizer.java`
#### Snippet
```java
    File segmentParentDirectory = new File(_segmentDir);
    _segmentDirectories = segmentParentDirectory.list();
    _numFilesToGenerate = _segmentDirectories.length;
    LOGGER.info("Total number of segments: " + _numFilesToGenerate);

```

### DataFlowIssue
Method invocation `size` will produce `NullPointerException`
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/memory/BasePinotLBuffer.java`
#### Snippet
```java
      return _buffer.m.address() + _buffer.m.size() - _buffer.address();
    } else {
      return _buffer.size();
    }
  }
```

### DataFlowIssue
Method invocation `getLeft` may produce `NullPointerException`
in `pinot-broker/src/main/java/org/apache/pinot/broker/routing/segmentpruner/interval/IntervalTree.java`
#### Snippet
```java
    while (count < sortedNodes.size()) {
      Pairs.IntPair indexPair = indexQueue.pollFirst();
      int start = indexPair.getLeft();
      int end = indexPair.getRight();

```

### DataFlowIssue
Argument `tableConfig` might be null
in `pinot-broker/src/main/java/org/apache/pinot/broker/routing/BrokerRoutingManager.java`
#### Snippet
```java
      String tableNameWithType = entry.getKey();
      TableConfig tableConfig = ZKMetadataProvider.getTableConfig(_propertyStore, tableNameWithType);
      String tableServerTag = getServerTagForTable(tableNameWithType, tableConfig);

      Map<String, ServerInstance> tenantServerMap = entry.getValue();
```

### DataFlowIssue
Method invocation `entrySet` may produce `NullPointerException`
in `pinot-query-runtime/src/main/java/org/apache/pinot/query/runtime/QueryRunner.java`
#### Snippet
```java
    Map<String, List<String>> tableToSegmentListMap = WorkerMetadata.getTableSegmentsMap(workerMetadata);
    List<ServerPlanRequestContext> requests = new ArrayList<>();
    for (Map.Entry<String, List<String>> tableEntry : tableToSegmentListMap.entrySet()) {
      String tableType = tableEntry.getKey();
      // ZkHelixPropertyStore extends from ZkCacheBaseDataAccessor so it should not cause too much out-of-the-box
```

### DataFlowIssue
Method invocation `size` may produce `NullPointerException`
in `pinot-query-runtime/src/main/java/org/apache/pinot/query/runtime/operator/LeafStageTransferableBlockOperator.java`
#### Snippet
```java
      DataSchema desiredDataSchema) {
    Collection<Object[]> resultRows = responseBlock.getRows();
    List<Object[]> extractedRows = new ArrayList<>(resultRows.size());
    if (resultRows instanceof List) {
      for (Object[] orgRow : resultRows) {
```

### DataFlowIssue
Method invocation `size` may produce `NullPointerException`
in `pinot-query-runtime/src/main/java/org/apache/pinot/query/runtime/operator/LeafStageTransferableBlockOperator.java`
#### Snippet
```java
      DataSchema desiredDataSchema, int[] columnIndices) {
    Collection<Object[]> resultRows = responseBlock.getRows();
    List<Object[]> extractedRows = new ArrayList<>(resultRows.size());
    if (resultRows instanceof List) {
      for (Object[] row : resultRows) {
```

### DataFlowIssue
Method invocation `finish` may produce `NullPointerException`
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkIndexedTable.java`
#### Snippet
```java
      }
    }
    mergedTable.finish(false);
  }

```

### DataFlowIssue
Argument `context` might be null
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkRawForwardIndexReader.java`
#### Snippet
```java
        VarByteChunkSVForwardIndexReaderV4.ReaderContext context = reader.createContext()) {
      for (int i = 0; i < state._records; i++) {
        bh.consume(reader.getBytes(i, context));
      }
    }
```

### DataFlowIssue
Dereference of `segments` may produce `NullPointerException`
in `pinot-perf/src/main/java/org/apache/pinot/perf/BenchmarkQueryEngine.java`
#### Snippet
```java

    File[] segments = new File(DATA_DIRECTORY, TABLE_NAME).listFiles();
    for (File segmentDir : segments) {
      SegmentMetadataImpl segmentMetadata = new SegmentMetadataImpl(segmentDir);
      _perfBenchmarkDriver.configureTable(TABLE_NAME);
```

### DataFlowIssue
Method `handleRequest` is too complex to analyze by data flow algorithm
in `pinot-broker/src/main/java/org/apache/pinot/broker/requesthandler/BaseBrokerRequestHandler.java`
#### Snippet
```java
  }

  private BrokerResponseNative handleRequest(long requestId, String query,
      @Nullable SqlNodeAndOptions sqlNodeAndOptions, JsonNode request, @Nullable RequesterIdentity requesterIdentity,
      RequestContext requestContext)
```

### DataFlowIssue
Method invocation `getFieldsForClpEncoding` may produce `NullPointerException`
in `pinot-plugins/pinot-input-format/pinot-clp-log/src/main/java/org/apache/pinot/plugin/inputformat/clplog/CLPLogRecordExtractor.java`
#### Snippet
```java
      // Remove the fields to be CLP-encoded to make it easier to work with them
      // in `extract`
      _fields.removeAll(_config.getFieldsForClpEncoding());
    }

```

### DataFlowIssue
Dereference of `segmentFiles` may produce `NullPointerException`
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/io/writer/impl/MmapMemoryManager.java`
#### Snippet
```java
        }
      });
      for (File file : segmentFiles) {
        if (file.delete()) {
          LOGGER.info("Deleted old file {}", file.getAbsolutePath());
```

### DataFlowIssue
Method invocation `getGeometryType` will produce `NullPointerException`
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/H3Utils.java`
#### Snippet
```java
      return Pair.of(fullCover, potentialCover);
    } else {
      throw new UnsupportedOperationException("Unexpected type: " + geometry.getGeometryType());
    }
  }
```

### DataFlowIssue
Method invocation `getArguments` may produce `NullPointerException`
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/SchemaUtils.java`
#### Snippet
```java
        if (transformFunction != null) {
          try {
            List<String> arguments = FunctionEvaluatorFactory.getExpressionEvaluator(fieldSpec).getArguments();
            Preconditions.checkState(!arguments.contains(column),
                "The arguments of transform function %s should not contain the destination column %s",
```

### DataFlowIssue
Casting `fieldSpec` to `DateTimeFieldSpec` may produce `ClassCastException`
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/SchemaUtils.java`
#### Snippet
```java
        }
        if (fieldSpec.getFieldType().equals(FieldSpec.FieldType.DATE_TIME)) {
          validateDateTimeFieldSpec((DateTimeFieldSpec) fieldSpec);
        }
      }
```

### DataFlowIssue
Switch label `"Point"` is unreachable
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/GeometrySerializer.java`
#### Snippet
```java
    int size = TYPE_SIZE;
    switch (geometry.getGeometryType()) {
      case "Point":
        size += COORDINATE_SIZE;
        break;
```

### DataFlowIssue
Switch label `"MultiPoint"` is unreachable
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/GeometrySerializer.java`
#### Snippet
```java
        size += COORDINATE_SIZE;
        break;
      case "MultiPoint":
        size += Integer.BYTES + geometry.getNumPoints() * COORDINATE_SIZE;
        break;
```

### DataFlowIssue
Switch label `"LineString"` is unreachable
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/GeometrySerializer.java`
#### Snippet
```java
        size += Integer.BYTES + geometry.getNumPoints() * COORDINATE_SIZE;
        break;
      case "LineString":
      case "LinearRing":
        // LinearRings are a subclass of LineString
```

### DataFlowIssue
Switch label `"LinearRing"` is unreachable
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/GeometrySerializer.java`
#### Snippet
```java
        break;
      case "LineString":
      case "LinearRing":
        // LinearRings are a subclass of LineString
        size += getPolylineByteSize(geometry, false);
```

### DataFlowIssue
Switch label `"MultiLineString"` is unreachable
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/GeometrySerializer.java`
#### Snippet
```java
        size += getPolylineByteSize(geometry, false);
        break;
      case "MultiLineString":
        size += getPolylineByteSize(geometry, true);
        break;
```

### DataFlowIssue
Switch label `"Polygon"` is unreachable
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/GeometrySerializer.java`
#### Snippet
```java
        size += getPolylineByteSize(geometry, true);
        break;
      case "Polygon":
        size += getPolygonByteSize(geometry, false);
        break;
```

### DataFlowIssue
Switch label `"MultiPolygon"` is unreachable
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/GeometrySerializer.java`
#### Snippet
```java
        size += getPolygonByteSize(geometry, false);
        break;
      case "MultiPolygon":
        size += getPolygonByteSize(geometry, true);
        break;
```

### DataFlowIssue
Switch label `"GeometryCollection"` is unreachable
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/GeometrySerializer.java`
#### Snippet
```java
        size += getPolygonByteSize(geometry, true);
        break;
      case "GeometryCollection":
        size += getGeometryCollectionByteSize(geometry);
        break;
```

### DataFlowIssue
Switch label `"Point"` is unreachable
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/GeometrySerializer.java`
#### Snippet
```java
  private static void writeGeometryByteBuffer(ByteBuffer byteBuffer, Geometry geometry) {
    switch (geometry.getGeometryType()) {
      case "Point":
        writePoint(byteBuffer, (Point) geometry);
        break;
```

### DataFlowIssue
Switch label `"MultiPoint"` is unreachable
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/GeometrySerializer.java`
#### Snippet
```java
        writePoint(byteBuffer, (Point) geometry);
        break;
      case "MultiPoint":
        writeMultiPoint(byteBuffer, (MultiPoint) geometry);
        break;
```

### DataFlowIssue
Switch label `"LineString"` is unreachable
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/GeometrySerializer.java`
#### Snippet
```java
        writeMultiPoint(byteBuffer, (MultiPoint) geometry);
        break;
      case "LineString":
      case "LinearRing":
        // LinearRings are a subclass of LineString
```

### DataFlowIssue
Switch label `"LinearRing"` is unreachable
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/GeometrySerializer.java`
#### Snippet
```java
        break;
      case "LineString":
      case "LinearRing":
        // LinearRings are a subclass of LineString
        writePolyline(byteBuffer, geometry, false);
```

### DataFlowIssue
Switch label `"MultiLineString"` is unreachable
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/GeometrySerializer.java`
#### Snippet
```java
        writePolyline(byteBuffer, geometry, false);
        break;
      case "MultiLineString":
        writePolyline(byteBuffer, geometry, true);
        break;
```

### DataFlowIssue
Switch label `"Polygon"` is unreachable
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/GeometrySerializer.java`
#### Snippet
```java
        writePolyline(byteBuffer, geometry, true);
        break;
      case "Polygon":
        writePolygon(byteBuffer, geometry, false);
        break;
```

### DataFlowIssue
Switch label `"MultiPolygon"` is unreachable
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/GeometrySerializer.java`
#### Snippet
```java
        writePolygon(byteBuffer, geometry, false);
        break;
      case "MultiPolygon":
        writePolygon(byteBuffer, geometry, true);
        break;
```

### DataFlowIssue
Switch label `"GeometryCollection"` is unreachable
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/GeometrySerializer.java`
#### Snippet
```java
        writePolygon(byteBuffer, geometry, true);
        break;
      case "GeometryCollection":
        writeGeometryCollection(byteBuffer, geometry);
        break;
```

### DataFlowIssue
Method invocation `getBatchIngestionConfig` may produce `NullPointerException`
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/IngestionUtils.java`
#### Snippet
```java
        "Must provide ingestionConfig in tableConfig for table: %s, for generating SegmentGeneratorConfig",
        tableConfig.getTableName());
    Preconditions.checkNotNull(tableConfig.getIngestionConfig().getBatchIngestionConfig(),
        "Must provide batchIngestionConfig in tableConfig for table: %s, for generating SegmentGeneratorConfig",
        tableConfig.getTableName());
```

### DataFlowIssue
Argument `tableConfig.getIngestionConfig().getBatchIngestionConfig()` might be null
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/IngestionUtils.java`
#### Snippet
```java
        tableConfig.getTableName());
    return generateSegmentGeneratorConfig(tableConfig, schema,
        tableConfig.getIngestionConfig().getBatchIngestionConfig());
  }

```

### DataFlowIssue
Dereference of `outputSymbolsBuffer` may produce `NullPointerException`
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/ImmutableFST.java`
#### Snippet
```java
      byte[] outputSymbolsBuffer = readRemaining(in, outputSymbolsLength);

      if (outputSymbolsBuffer.length > 0) {
        String outputSymbolsSerialized = new String(outputSymbolsBuffer);

```

### DataFlowIssue
Method invocation `getComparisonColumns` may produce `NullPointerException`
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/TableConfigUtils.java`
#### Snippet
```java

      // comparison column exists
      if (tableConfig.getUpsertConfig().getComparisonColumns() != null) {
        List<String> comparisonCols = tableConfig.getUpsertConfig().getComparisonColumns();
        for (String comparisonCol : comparisonCols) {
```

### DataFlowIssue
Method invocation `entrySet` may produce `NullPointerException`
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/TableConfigUtils.java`
#### Snippet
```java

    List<String> primaryKeyColumns = schema.getPrimaryKeyColumns();
    for (Map.Entry<String, UpsertConfig.Strategy> entry : partialUpsertStrategies.entrySet()) {
      String column = entry.getKey();
      UpsertConfig.Strategy columnStrategy = entry.getValue();
```

### DataFlowIssue
Method invocation `createContext` may produce `NullPointerException`
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/loader/invertedindex/H3IndexHandler.java`
#### Snippet
```java
    try (ForwardIndexReader forwardIndexReader = StandardIndexes.forward().getReaderFactory()
        .createIndexReader(segmentWriter, colIndexConf, columnMetadata);
        ForwardIndexReaderContext readerContext = forwardIndexReader.createContext();
        Dictionary dictionary = StandardIndexes.dictionary().getReaderFactory()
            .createIndexReader(segmentWriter, colIndexConf, columnMetadata);
```

### DataFlowIssue
Method invocation `getBytesValue` may produce `NullPointerException`
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/loader/invertedindex/H3IndexHandler.java`
#### Snippet
```java
      for (int i = 0; i < numDocs; i++) {
        int dictId = forwardIndexReader.getDictId(i, readerContext);
        h3IndexCreator.add(GeometrySerializer.deserialize(dictionary.getBytesValue(dictId)));
      }
      h3IndexCreator.seal();
```

### DataFlowIssue
The call to 'checkState' always fails, according to its method contracts
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/loader/ForwardIndexHandler.java`
#### Snippet
```java
      forwardIndexReadRawWriteDictHelper(column, existingColumnMetadata, reader, creator, numDocs, dictionaryCreator);
    } else {
      Preconditions.checkState(false, "Invalid dict-based read/write for column=" + column);
    }
  }
```

### DataFlowIssue
Method invocation `or` may produce `NullPointerException`
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/readers/RangeIndexReaderImpl.java`
#### Snippet
```java
    MutableRoaringBitmap matching = firstRangeId + 1 < lastRangeId ? new MutableRoaringBitmap() : null;
    for (int rangeId = firstRangeId + 1; rangeId < lastRangeId; rangeId++) {
      matching.or(getDocIds(rangeId));
    }
    return matching;
```

### DataFlowIssue
Dereference of `files` may produce `NullPointerException`
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/converter/SegmentV1V2ToV3FormatConverter.java`
#### Snippet
```java
    });

    for (File file : files) {
      LOGGER.info("Deleting stale v3 directory: {}", file);
      FileUtils.deleteQuietly(file);
```

### DataFlowIssue
Dereference of `files` may produce `NullPointerException`
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/converter/SegmentV1V2ToV3FormatConverter.java`
#### Snippet
```java
    SegmentFormatConverter converter = new SegmentV1V2ToV3FormatConverter();

    for (File file : files) {
      if (!file.isDirectory()) {
        System.out.println("Path: " + file + " is not a directory. Skipping...");
```

### DataFlowIssue
Dereference of `textIndexFiles` may produce `NullPointerException`
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/converter/SegmentV1V2ToV3FormatConverter.java`
#### Snippet
```java
      }
    });
    for (File textIndexFile : textIndexFiles) {
      File[] indexFiles = textIndexFile.listFiles();
      File v3LuceneIndexDir = new File(v3Dir, textIndexFile.getName());
```

### DataFlowIssue
Dereference of `indexFiles` may produce `NullPointerException`
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/converter/SegmentV1V2ToV3FormatConverter.java`
#### Snippet
```java
      File v3LuceneIndexDir = new File(v3Dir, textIndexFile.getName());
      v3LuceneIndexDir.mkdir();
      for (File indexFile : indexFiles) {
        File v3LuceneIndexFile = new File(v3LuceneIndexDir, indexFile.getName());
        Files.copy(indexFile.toPath(), v3LuceneIndexFile.toPath());
```

### DataFlowIssue
Dereference of `textIndexDocIdMappingFiles` may produce `NullPointerException`
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/converter/SegmentV1V2ToV3FormatConverter.java`
#### Snippet
```java
      }
    });
    for (File docIdMappingFile : textIndexDocIdMappingFiles) {
      File v3DocIdMappingFile = new File(v3Dir, docIdMappingFile.getName());
      Files.copy(docIdMappingFile.toPath(), v3DocIdMappingFile.toPath());
```

### DataFlowIssue
Method invocation `getValue` may produce `NullPointerException`
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/creator/TransformPipeline.java`
#### Snippet
```java
      decodedRow = _complexTypeTransformer.transform(decodedRow);
    }
    Collection<GenericRow> rows = (Collection<GenericRow>) decodedRow.getValue(GenericRow.MULTIPLE_RECORDS_KEY);
    if (rows != null) {
      for (GenericRow row : rows) {
```

### DataFlowIssue
Method invocation `toString` may produce `NullPointerException`
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/store/SegmentLocalFSDirectory.java`
#### Snippet
```java
    @Override
    public String toString() {
      return _segmentDirectory.toString();
    }

```

### DataFlowIssue
Method invocation `toString` may produce `NullPointerException`
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/store/SegmentLocalFSDirectory.java`
#### Snippet
```java
    @Override
    public String toString() {
      return _segmentDirectory.toString();
    }
  }
```

### DataFlowIssue
Method invocation `isVirtualColumn` may produce `NullPointerException`
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/creator/impl/SegmentColumnarIndexCreator.java`
#### Snippet
```java
            "Cannot create index for column: %s because it is not in schema", columnName);
      }
      if (fieldSpec.isVirtualColumn()) {
        LOGGER.warn("Ignoring index creation for virtual column " + columnName);
        continue;
```

### DataFlowIssue
Method invocation `toString` may produce `NullPointerException`
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/creator/impl/stats/SegmentPreIndexStatsCollectorImpl.java`
#### Snippet
```java

        if (statisticsCollector.getPartitionFunction() != null) {
          LOGGER.info("partitions: " + statisticsCollector.getPartitions().toString());
        }
        LOGGER.info("***********************************************");
```

### DataFlowIssue
Method invocation `getThriftClass` may produce `NullPointerException`
in `pinot-plugins/pinot-input-format/pinot-thrift/src/main/java/org/apache/pinot/plugin/inputformat/thrift/ThriftRecordReader.java`
#### Snippet
```java
    TBase tObject;
    try {
      _thriftClass = this.getClass().getClassLoader().loadClass(recordReaderConfig.getThriftClass());
      tObject = (TBase) _thriftClass.newInstance();
    } catch (Exception e) {
```

### DataFlowIssue
Dereference of `root.listFiles()` may produce `NullPointerException`
in `contrib/pinot-fmpp-maven-plugin/src/main/java/org/apache/pinot/fmpp/FMPPMojo.java`
#### Snippet
```java
      throws MojoFailureException, IOException {
    Report report = new Report();
    for (File file : root.listFiles()) {
      if (file.isDirectory()) {
        report.add(moveIfChanged(file, tmpPath));
```

### DataFlowIssue
Casting `value` to `Object[]` may produce `ClassCastException`
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/recordtransformer/ComplexTypeTransformer.java`
#### Snippet
```java
        }
      } else if (isNonPrimitiveArray(value)) {
        Object[] array = (Object[]) value;
        if (_fieldsToUnnest.contains(concatName)) {
          for (Object inner : (Object[]) value) {
```

### DataFlowIssue
Casting `value` to `Object[]` may produce `ClassCastException`
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/recordtransformer/ComplexTypeTransformer.java`
#### Snippet
```java
        Object[] array = (Object[]) value;
        if (_fieldsToUnnest.contains(concatName)) {
          for (Object inner : (Object[]) value) {
            if (inner instanceof Map) {
              Map<String, Object> innerMap = (Map<String, Object>) inner;
```

### DataFlowIssue
Casting `value` to `Integer` may produce `ClassCastException`
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/indexsegment/mutable/MutableSegmentImpl.java`
#### Snippet
```java
          switch (dataType.getStoredType()) {
            case INT:
              forwardIndex.setInt(docId, (Integer) value);
              break;
            case LONG:
```

### DataFlowIssue
Casting `value` to `Long` may produce `ClassCastException`
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/indexsegment/mutable/MutableSegmentImpl.java`
#### Snippet
```java
              break;
            case LONG:
              forwardIndex.setLong(docId, (Long) value);
              break;
            case FLOAT:
```

### DataFlowIssue
Casting `value` to `Float` may produce `ClassCastException`
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/indexsegment/mutable/MutableSegmentImpl.java`
#### Snippet
```java
              break;
            case FLOAT:
              forwardIndex.setFloat(docId, (Float) value);
              break;
            case DOUBLE:
```

### DataFlowIssue
Casting `value` to `Double` may produce `ClassCastException`
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/indexsegment/mutable/MutableSegmentImpl.java`
#### Snippet
```java
              break;
            case DOUBLE:
              forwardIndex.setDouble(docId, (Double) value);
              break;
            case BIG_DECIMAL:
```

### DataFlowIssue
Casting `value` to `BigDecimal` may produce `ClassCastException`
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/indexsegment/mutable/MutableSegmentImpl.java`
#### Snippet
```java
              break;
            case BIG_DECIMAL:
              forwardIndex.setBigDecimal(docId, (BigDecimal) value);
              break;
            case STRING:
```

### DataFlowIssue
Casting `value` to `String` may produce `ClassCastException`
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/indexsegment/mutable/MutableSegmentImpl.java`
#### Snippet
```java
              break;
            case STRING:
              forwardIndex.setString(docId, (String) value);
              break;
            case BYTES:
```

### DataFlowIssue
Casting `value` to `Comparable` may produce `ClassCastException`
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/indexsegment/mutable/MutableSegmentImpl.java`
#### Snippet
```java
              comparable = new ByteArray((byte[]) value);
            } else {
              comparable = (Comparable) value;
            }
            if (indexContainer._minValue == null) {
```

### DataFlowIssue
Casting `value` to `String` may produce `ClassCastException`
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/indexsegment/mutable/MutableSegmentImpl.java`
#### Snippet
```java
        if (textIndex != null) {
          try {
            textIndex.add((String) value);
          } catch (Exception e) {
            recordIndexingError(FieldConfig.IndexType.TEXT, e);
```

### DataFlowIssue
Casting `value` to `String` may produce `ClassCastException`
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/indexsegment/mutable/MutableSegmentImpl.java`
#### Snippet
```java
        if (jsonIndex != null) {
          try {
            jsonIndex.add((String) value);
          } catch (Exception e) {
            recordIndexingError(FieldConfig.IndexType.JSON, e);
```

### DataFlowIssue
Casting `value` to `byte[]` may produce `ClassCastException`
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/indexsegment/mutable/MutableSegmentImpl.java`
#### Snippet
```java
        if (h3Index != null) {
          try {
            h3Index.add(GeometrySerializer.deserialize((byte[]) value));
          } catch (Exception e) {
            recordIndexingError(FieldConfig.IndexType.H3, e);
```

## RuleId[id=DeprecatedIsStillUsed]
### DeprecatedIsStillUsed
Deprecated member 'putField' is still used
in `pinot-spi/src/main/java/org/apache/pinot/spi/data/readers/GenericRow.java`
#### Snippet
```java

  @Deprecated
  public void putField(String fieldName, @Nullable Object value) {
    _fieldToValueMap.put(fieldName, value);
  }
```

### DeprecatedIsStillUsed
Deprecated member 'setSegmentPushFrequency' is still used
in `pinot-spi/src/main/java/org/apache/pinot/spi/utils/builder/TableConfigBuilder.java`
#### Snippet
```java
   * @deprecated Use {@code segmentIngestionFrequency} from {@link IngestionConfig#getBatchIngestionConfig()}
   */
  public TableConfigBuilder setSegmentPushFrequency(String segmentPushFrequency) {
    _segmentPushFrequency = segmentPushFrequency;
    return this;
```

### DeprecatedIsStillUsed
Deprecated member '_segmentPushFrequency' is still used
in `pinot-spi/src/main/java/org/apache/pinot/spi/utils/builder/TableConfigBuilder.java`
#### Snippet
```java
  private String _deletedSegmentsRetentionPeriod = DEFAULT_DELETED_SEGMENTS_RETENTION_PERIOD;
  @Deprecated
  private String _segmentPushFrequency;
  @Deprecated
  private String _segmentPushType = DEFAULT_SEGMENT_PUSH_TYPE;
```

### DeprecatedIsStillUsed
Deprecated member 'setSegmentPushType' is still used
in `pinot-spi/src/main/java/org/apache/pinot/spi/utils/builder/TableConfigBuilder.java`
#### Snippet
```java
   * @deprecated Use {@code segmentIngestionType} from {@link IngestionConfig#getBatchIngestionConfig()}
   */
  public TableConfigBuilder setSegmentPushType(String segmentPushType) {
    if (REFRESH_SEGMENT_PUSH_TYPE.equalsIgnoreCase(segmentPushType)) {
      _segmentPushType = REFRESH_SEGMENT_PUSH_TYPE;
```

### DeprecatedIsStillUsed
Deprecated member '_segmentPushType' is still used
in `pinot-spi/src/main/java/org/apache/pinot/spi/utils/builder/TableConfigBuilder.java`
#### Snippet
```java
  private String _segmentPushFrequency;
  @Deprecated
  private String _segmentPushType = DEFAULT_SEGMENT_PUSH_TYPE;
  private String _segmentAssignmentStrategy = DEFAULT_SEGMENT_ASSIGNMENT_STRATEGY;
  private String _peerSegmentDownloadScheme;
```

### DeprecatedIsStillUsed
Deprecated member '_routingTableBuilderName' is still used
in `pinot-spi/src/main/java/org/apache/pinot/spi/config/table/RoutingConfig.java`
#### Snippet
```java
  // Replaced by _segmentPrunerTypes and _instanceSelectorType
  @Deprecated
  private final String _routingTableBuilderName;

  private final List<String> _segmentPrunerTypes;
```

### DeprecatedIsStillUsed
Deprecated member '_jsonIndexColumns' is still used
in `pinot-spi/src/main/java/org/apache/pinot/spi/config/table/IndexingConfig.java`
#### Snippet
```java
  private int _rangeIndexVersion = DEFAULT_RANGE_INDEX_VERSION;
  @Deprecated
  private List<String> _jsonIndexColumns;
  private Map<String, JsonIndexConfig> _jsonIndexConfigs;
  private List<String> _h3IndexColumns;
```

### DeprecatedIsStillUsed
Deprecated member '_streamConfigs' is still used
in `pinot-spi/src/main/java/org/apache/pinot/spi/config/table/IndexingConfig.java`
#### Snippet
```java
  private String _loadMode;
  @Deprecated // Moved to {@link IngestionConfig#getStreamIngestionConfig}
  private Map<String, String> _streamConfigs;
  private String _segmentFormatVersion;
  private FSTType _fstTypeForFSTIndex;
```

### DeprecatedIsStillUsed
Deprecated member '_segmentPushType' is still used
in `pinot-spi/src/main/java/org/apache/pinot/spi/config/table/SegmentsValidationAndRetentionConfig.java`
#### Snippet
```java
  private String _segmentPushFrequency; // DO NOT REMOVE, this is used in internal segment generation management
  @Deprecated
  private String _segmentPushType;
  private String _replication;
  // For high-level consumers, the number of replicas should be same as num server instances
```

### DeprecatedIsStillUsed
Deprecated member '_segmentPushFrequency' is still used
in `pinot-spi/src/main/java/org/apache/pinot/spi/config/table/SegmentsValidationAndRetentionConfig.java`
#### Snippet
```java
  private String _deletedSegmentsRetentionPeriod;
  @Deprecated
  private String _segmentPushFrequency; // DO NOT REMOVE, this is used in internal segment generation management
  @Deprecated
  private String _segmentPushType;
```

### DeprecatedIsStillUsed
Deprecated member 'getSegmentPushType' is still used
in `pinot-spi/src/main/java/org/apache/pinot/spi/config/table/SegmentsValidationAndRetentionConfig.java`
#### Snippet
```java
   * @deprecated Use {@code segmentIngestionType} from {@link IngestionConfig#getBatchIngestionConfig()}
   */
  public String getSegmentPushType() {
    return _segmentPushType;
  }
```

### DeprecatedIsStillUsed
Deprecated member 'getSegmentPushFrequency' is still used
in `pinot-spi/src/main/java/org/apache/pinot/spi/config/table/SegmentsValidationAndRetentionConfig.java`
#### Snippet
```java
   * @deprecated Use {@code segmentIngestionFrequency} from {@link IngestionConfig#getBatchIngestionConfig()}
   */
  public String getSegmentPushFrequency() {
    return _segmentPushFrequency;
  }
```

### DeprecatedIsStillUsed
Deprecated member 'TimeConverter' is still used
in `pinot-spi/src/main/java/org/apache/pinot/spi/utils/TimeConverter.java`
#### Snippet
```java
 * TimeConverter to convert value to/from milliseconds since epoch based on the given {@link TimeGranularitySpec}.
 */
public class TimeConverter {
  private final TimeGranularitySpec _timeGranularitySpec;

```

### DeprecatedIsStillUsed
Deprecated member 'getMessageAtIndex' is still used
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/MessageBatch.java`
#### Snippet
```java
   */
  @Deprecated
  T getMessageAtIndex(int index);

  // for backward-compatibility
```

### DeprecatedIsStillUsed
Deprecated member 'getNextStreamMessageOffsetAtIndex' is still used
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/MessageBatch.java`
#### Snippet
```java
   */
  @Deprecated
  long getNextStreamMessageOffsetAtIndex(int index);

  /**
```

### DeprecatedIsStillUsed
Deprecated member 'DEPRECATED_SEGMENT_FLUSH_DESIRED_SIZE' is still used
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/StreamConfigProperties.java`
#### Snippet
```java
   * Not included here is any heap memory used (currently inverted index uses heap memory for consuming partitions).
   */
  public static final String DEPRECATED_SEGMENT_FLUSH_DESIRED_SIZE = "realtime.segment.flush.desired.size";
  public static final String SEGMENT_FLUSH_THRESHOLD_SEGMENT_SIZE = "realtime.segment.flush.threshold.segment.size";

```

### DeprecatedIsStillUsed
Deprecated member 'DEPRECATED_SEGMENT_FLUSH_THRESHOLD_ROWS' is still used
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/StreamConfigProperties.java`
#### Snippet
```java
   * REALTIME_SEGMENT_FLUSH_TIME is reached first)
   */
  public static final String DEPRECATED_SEGMENT_FLUSH_THRESHOLD_ROWS = "realtime.segment.flush.threshold.size";
  public static final String SEGMENT_FLUSH_THRESHOLD_ROWS = "realtime.segment.flush.threshold.rows";

```

### DeprecatedIsStillUsed
Deprecated member 'CONFIG_OF_CONTROLLER_HTTPS_PORT' is still used
in `pinot-spi/src/main/java/org/apache/pinot/spi/utils/CommonConstants.java`
#### Snippet
```java
       */
      @Deprecated
      public static final String CONFIG_OF_CONTROLLER_HTTPS_PORT = "controller.port";

      public static final String CONFIG_OF_SEGMENT_UPLOAD_REQUEST_TIMEOUT_MS = "upload.request.timeout.ms";
```

### DeprecatedIsStillUsed
Deprecated member 'INSTANCE_ID_KEY' is still used
in `pinot-spi/src/main/java/org/apache/pinot/spi/utils/CommonConstants.java`
#### Snippet
```java
    public static class Instance {
      @Deprecated
      public static final String INSTANCE_ID_KEY = "instanceId";
      public static final String DATA_DIR_KEY = "dataDir";
      public static final String ADMIN_PORT_KEY = "adminPort";
```

### DeprecatedIsStillUsed
Deprecated member 'DEPRECATED_PREFIX_OF_CONFIG_OF_PINOT_CRYPTER' is still used
in `pinot-spi/src/main/java/org/apache/pinot/spi/utils/CommonConstants.java`
#### Snippet
```java
    public static final String DEPRECATED_PREFIX_OF_CONFIG_OF_SEGMENT_UPLOADER = "segment.uploader";
    @Deprecated
    public static final String DEPRECATED_PREFIX_OF_CONFIG_OF_PINOT_CRYPTER = "crypter";

    /**
```

### DeprecatedIsStillUsed
Deprecated member 'DEPRECATED_PREFIX_OF_CONFIG_OF_SEGMENT_UPLOADER' is still used
in `pinot-spi/src/main/java/org/apache/pinot/spi/utils/CommonConstants.java`
#### Snippet
```java
    public static final String DEPRECATED_PREFIX_OF_CONFIG_OF_SEGMENT_FETCHER_FACTORY = "segment.fetcher";
    @Deprecated
    public static final String DEPRECATED_PREFIX_OF_CONFIG_OF_SEGMENT_UPLOADER = "segment.uploader";
    @Deprecated
    public static final String DEPRECATED_PREFIX_OF_CONFIG_OF_PINOT_CRYPTER = "crypter";
```

### DeprecatedIsStillUsed
Deprecated member 'DEPRECATED_ENABLE_CASE_INSENSITIVE_KEY' is still used
in `pinot-spi/src/main/java/org/apache/pinot/spi/utils/CommonConstants.java`
#### Snippet
```java
    public static final boolean DEFAULT_ALLOW_TABLE_NAME_WITH_DATABASE = false;
    @Deprecated
    public static final String DEPRECATED_ENABLE_CASE_INSENSITIVE_KEY = "enable.case.insensitive.pql";

    public static final String DEFAULT_HYPERLOGLOG_LOG2M_KEY = "default.hyperloglog.log2m";
```

### DeprecatedIsStillUsed
Deprecated member 'DOWNLOAD_URL' is still used
in `pinot-spi/src/main/java/org/apache/pinot/spi/utils/CommonConstants.java`
#### Snippet
```java
      // Deprecated, but kept for backward-compatibility of reading old segments' ZK metadata
      @Deprecated
      public static final String DOWNLOAD_URL = "segment.realtime.download.url";
    }

```

### DeprecatedIsStillUsed
Deprecated member 'RESPONSE_FORMAT' is still used
in `pinot-spi/src/main/java/org/apache/pinot/spi/utils/CommonConstants.java`
#### Snippet
```java
        public static final String PRESERVE_TYPE = "preserveType";
        @Deprecated
        public static final String RESPONSE_FORMAT = "responseFormat";
        @Deprecated
        public static final String GROUP_BY_MODE = "groupByMode";
```

### DeprecatedIsStillUsed
Deprecated member 'DEPRECATED_PREFIX_OF_CONFIG_OF_PINOT_FS_FACTORY' is still used
in `pinot-spi/src/main/java/org/apache/pinot/spi/utils/CommonConstants.java`
#### Snippet
```java
    public static final String PREFIX_OF_CONFIG_OF_PINOT_CRYPTER = "pinot.minion.crypter";
    @Deprecated
    public static final String DEPRECATED_PREFIX_OF_CONFIG_OF_PINOT_FS_FACTORY = "storage.factory";
    @Deprecated
    public static final String DEPRECATED_PREFIX_OF_CONFIG_OF_SEGMENT_FETCHER_FACTORY = "segment.fetcher";
```

### DeprecatedIsStillUsed
Deprecated member 'DEPRECATED_PREFIX_OF_CONFIG_OF_SEGMENT_FETCHER_FACTORY' is still used
in `pinot-spi/src/main/java/org/apache/pinot/spi/utils/CommonConstants.java`
#### Snippet
```java
    public static final String DEPRECATED_PREFIX_OF_CONFIG_OF_PINOT_FS_FACTORY = "storage.factory";
    @Deprecated
    public static final String DEPRECATED_PREFIX_OF_CONFIG_OF_SEGMENT_FETCHER_FACTORY = "segment.fetcher";
    @Deprecated
    public static final String DEPRECATED_PREFIX_OF_CONFIG_OF_SEGMENT_UPLOADER = "segment.uploader";
```

### DeprecatedIsStillUsed
Deprecated member 'CONFIG_OF_CONTROLLER_HTTPS_ENABLED' is still used
in `pinot-spi/src/main/java/org/apache/pinot/spi/utils/CommonConstants.java`
#### Snippet
```java
       */
      @Deprecated
      public static final String CONFIG_OF_CONTROLLER_HTTPS_ENABLED = "enabled";

      /**
```

### DeprecatedIsStillUsed
Deprecated member 'GROUP_BY_MODE' is still used
in `pinot-spi/src/main/java/org/apache/pinot/spi/utils/CommonConstants.java`
#### Snippet
```java
        public static final String RESPONSE_FORMAT = "responseFormat";
        @Deprecated
        public static final String GROUP_BY_MODE = "groupByMode";
      }

```

### DeprecatedIsStillUsed
Deprecated member 'DEPRECATED_CONFIG_OF_METRICS_PREFIX_KEY' is still used
in `pinot-spi/src/main/java/org/apache/pinot/spi/utils/CommonConstants.java`
#### Snippet
```java
    public static final String CONFIG_OF_METRICS_PREFIX_KEY = "pinot.minion.metrics.prefix";
    @Deprecated
    public static final String DEPRECATED_CONFIG_OF_METRICS_PREFIX_KEY = "metricsPrefix";
    public static final String METRICS_REGISTRY_REGISTRATION_LISTENERS_KEY = "metricsRegistryRegistrationListeners";
    public static final String METRICS_CONFIG_PREFIX = "pinot.minion.metrics";
```

### DeprecatedIsStillUsed
Deprecated member 'removeOptionsFromSql' is still used
in `pinot-common/src/main/java/org/apache/pinot/sql/parsers/CalciteSqlParser.java`
#### Snippet
```java

  @Deprecated
  private static String removeOptionsFromSql(String sql) {
    Matcher matcher = OPTIONS_REGEX_PATTEN.matcher(sql);
    return matcher.replaceAll("");
```

### DeprecatedIsStillUsed
Deprecated member 'extractOptionsFromSql' is still used
in `pinot-common/src/main/java/org/apache/pinot/sql/parsers/CalciteSqlParser.java`
#### Snippet
```java

  @Deprecated
  private static List<String> extractOptionsFromSql(String sql) {
    List<String> results = new ArrayList<>();
    Matcher matcher = OPTIONS_REGEX_PATTEN.matcher(sql);
```

### DeprecatedIsStillUsed
Deprecated member 'extractOptionsMap' is still used
in `pinot-common/src/main/java/org/apache/pinot/sql/parsers/CalciteSqlParser.java`
#### Snippet
```java

  @Deprecated
  private static Map<String, String> extractOptionsMap(List<String> optionsStatements) {
    Map<String, String> options = new HashMap<>();
    for (String optionsStatement : optionsStatements) {
```

### DeprecatedIsStillUsed
Deprecated member 'getUploadSegmentHttpURI' is still used
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   */
  @Deprecated
  public static URI getUploadSegmentHttpURI(String host, int port)
      throws URISyntaxException {
    return getURI(HTTP, host, port, SEGMENT_PATH);
```

### DeprecatedIsStillUsed
Deprecated member 'sendSegmentJson' is still used
in `pinot-common/src/main/java/org/apache/pinot/common/utils/FileUploadDownloadClient.java`
#### Snippet
```java
   */
  @Deprecated
  public SimpleHttpResponse sendSegmentJson(URI uri, String jsonString)
      throws IOException, HttpErrorStatusException {
    return sendSegmentJson(uri, jsonString, null, null, HttpClient.DEFAULT_SOCKET_TIMEOUT_MS);
```

### DeprecatedIsStillUsed
Deprecated member 'OFFLINE_TABLE_ESTIMATED_SIZE' is still used
in `pinot-common/src/main/java/org/apache/pinot/common/metrics/ControllerGauge.java`
#### Snippet
```java
  // Estimated size of offline table
  @Deprecated // Instead use TABLE_TOTAL_SIZE_ON_SERVER
  OFFLINE_TABLE_ESTIMATED_SIZE("OfflineTableEstimatedSize", false),

  LARGEST_SEGMENT_SIZE_ON_SERVER("LargestSegmentSizeOnServer", false),
```

### DeprecatedIsStillUsed
Deprecated member 'addCallbackGaugeIfNeeded' is still used
in `pinot-common/src/main/java/org/apache/pinot/common/metrics/AbstractMetrics.java`
#### Snippet
```java
   */
  @Deprecated
  public void addCallbackGaugeIfNeeded(final String metricName, final Callable<Long> valueCallback) {
    if (!_gaugeValues.containsKey(metricName)) {
      synchronized (_gaugeValues) {
```

### DeprecatedIsStillUsed
Deprecated member 'addValueToGlobalGauge' is still used
in `pinot-common/src/main/java/org/apache/pinot/common/metrics/AbstractMetrics.java`
#### Snippet
```java
   */
  @Deprecated
  public void addValueToGlobalGauge(final G gauge, final long unitCount) {
    String gaugeName = gauge.getGaugeName();

```

### DeprecatedIsStillUsed
Deprecated member 'addCallbackTableGaugeIfNeeded' is still used
in `pinot-common/src/main/java/org/apache/pinot/common/metrics/AbstractMetrics.java`
#### Snippet
```java
   */
  @Deprecated
  public void addCallbackTableGaugeIfNeeded(final String tableName, final G gauge, final Callable<Long> valueCallback) {
    final String fullGaugeName = composeTableGaugeName(tableName, gauge);
    addCallbackGaugeIfNeeded(fullGaugeName, valueCallback);
```

### DeprecatedIsStillUsed
Deprecated member '_gaugeValues' is still used
in `pinot-common/src/main/java/org/apache/pinot/common/metrics/AbstractMetrics.java`
#### Snippet
```java
  // Since gauge metric itself is updatable now (https://github.com/apache/pinot/pull/9961), we can deprecate it.
  @Deprecated
  private final Map<String, AtomicLong> _gaugeValues = new ConcurrentHashMap<String, AtomicLong>();

  private final boolean _isTableLevelMetricsEnabled;
```

### DeprecatedIsStillUsed
Deprecated member 'addCallbackGauge' is still used
in `pinot-common/src/main/java/org/apache/pinot/common/metrics/AbstractMetrics.java`
#### Snippet
```java
   */
  @Deprecated
  public void addCallbackGauge(final String metricName, final Callable<Long> valueCallback) {
    PinotMetricUtils
        .makeGauge(_metricsRegistry, PinotMetricUtils.makePinotMetricName(_clazz, _metricPrefix + metricName),
```

### DeprecatedIsStillUsed
Deprecated member 'constructPropertyStorePathForMinionTaskMetadataDeprecated' is still used
in `pinot-common/src/main/java/org/apache/pinot/common/metadata/ZKMetadataProvider.java`
#### Snippet
```java

  @Deprecated
  public static String constructPropertyStorePathForMinionTaskMetadataDeprecated(String taskType,
      String tableNameWithType) {
    return StringUtil.join("/", PROPERTYSTORE_MINION_TASK_METADATA_PREFIX, taskType, tableNameWithType);
```

### DeprecatedIsStillUsed
Deprecated member 'getOffset' is still used
in `pinot-common/src/main/java/org/apache/pinot/common/protocols/SegmentCompletionProtocol.java`
#### Snippet
```java

      @Deprecated
      private long getOffset() {
        return _offset;
      }
```

### DeprecatedIsStillUsed
Deprecated member 'getOffset' is still used
in `pinot-common/src/main/java/org/apache/pinot/common/protocols/SegmentCompletionProtocol.java`
#### Snippet
```java

      @Deprecated
      private long getOffset() {
        return _offset;
      }
```

### DeprecatedIsStillUsed
Deprecated member 'DEPRECATED_LOG2M_KEY' is still used
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/DistinctCountSmartHLLAggregationFunction.java`
#### Snippet
```java
    static final int DEFAULT_LOG2M = 12;
    @Deprecated
    static final String DEPRECATED_LOG2M_KEY = "HLLLOG2M";

    int _threshold = DEFAULT_THRESHOLD;
```

### DeprecatedIsStillUsed
Deprecated member 'DEPRECATED_THRESHOLD_KEY' is still used
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/DistinctCountSmartHLLAggregationFunction.java`
#### Snippet
```java
    static final int DEFAULT_THRESHOLD = 100_000;
    @Deprecated
    static final String DEPRECATED_THRESHOLD_KEY = "HLLCONVERSIONTHRESHOLD";

    static final String LOG2M_KEY = "LOG2M";
```

### DeprecatedIsStillUsed
Deprecated member 'FastHLLAggregationFunction' is still used
in `pinot-core/src/main/java/org/apache/pinot/core/query/aggregation/function/FastHLLAggregationFunction.java`
#### Snippet
```java
 */
@Deprecated
public class FastHLLAggregationFunction extends BaseSingleInputAggregationFunction<HyperLogLog, Long> {
  public static final int DEFAULT_LOG2M = 8;
  private static final int BYTE_TO_CHAR_OFFSET = 129;
```

### DeprecatedIsStillUsed
Deprecated member 'COLLECTOR_TYPE_KEY' is still used
in `pinot-core/src/main/java/org/apache/pinot/core/common/MinionConstants.java`
#### Snippet
```java

    @Deprecated // Replaced by MERGE_TYPE_KEY
    public static final String COLLECTOR_TYPE_KEY = "collectorType";
  }

```

### DeprecatedIsStillUsed
Deprecated member 'toServerRoutingInstance' is still used
in `pinot-core/src/main/java/org/apache/pinot/core/transport/ServerInstance.java`
#### Snippet
```java
  // Does not require TLS until all servers guaranteed to be on TLS
  @Deprecated
  public ServerRoutingInstance toServerRoutingInstance(TableType tableType, boolean preferNettyTls) {
    if (preferNettyTls && _nettyTlsPort > 0) {
      return new ServerRoutingInstance(_instanceId, _hostname, _nettyTlsPort, tableType, true);
```

### DeprecatedIsStillUsed
Deprecated member 'hasDataAccess' is still used
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/access/AccessControl.java`
#### Snippet
```java
   */
  @Deprecated
  default boolean hasDataAccess(HttpHeaders httpHeaders, String tableName) {
    return hasAccess(tableName, AccessType.READ, httpHeaders, null);
  }
```

### DeprecatedIsStillUsed
Deprecated member 'DEPRECATED_SEGMENT_LEVEL_VALIDATION_INTERVAL_IN_SECONDS' is still used
in `pinot-controller/src/main/java/org/apache/pinot/controller/ControllerConf.java`
#### Snippet
```java
    // Deprecated as of 0.8.0
    @Deprecated
    public static final String DEPRECATED_SEGMENT_LEVEL_VALIDATION_INTERVAL_IN_SECONDS =
        "controller.segment.level.validation.intervalInSeconds";
    public static final String SEGMENT_LEVEL_VALIDATION_INTERVAL_PERIOD =
```

### DeprecatedIsStillUsed
Deprecated member 'DEPRECATED_REALTIME_SEGMENT_RELOCATOR_FREQUENCY' is still used
in `pinot-controller/src/main/java/org/apache/pinot/controller/ControllerConf.java`
#### Snippet
```java
    @Deprecated
    // RealtimeSegmentRelocator has been rebranded as SegmentRelocator
    public static final String DEPRECATED_REALTIME_SEGMENT_RELOCATOR_FREQUENCY =
        "controller.realtime.segment.relocator.frequency";
    // Deprecated as of 0.8.0
```

### DeprecatedIsStillUsed
Deprecated member 'DEPRECATED_MINION_INSTANCES_CLEANUP_TASK_MIN_OFFLINE_TIME_BEFORE_DELETION_SECONDS' is still used
in `pinot-controller/src/main/java/org/apache/pinot/controller/ControllerConf.java`
#### Snippet
```java
    // Deprecated as of 0.8.0
    @Deprecated
    public static final String DEPRECATED_MINION_INSTANCES_CLEANUP_TASK_MIN_OFFLINE_TIME_BEFORE_DELETION_SECONDS =
        "controller.minion.instances.cleanup.task.minOfflineTimeBeforeDeletionSeconds";
    @Deprecated
```

### DeprecatedIsStillUsed
Deprecated member 'DEPRECATED_REALTIME_SEGMENT_RELOCATION_INITIAL_DELAY_IN_SECONDS' is still used
in `pinot-controller/src/main/java/org/apache/pinot/controller/ControllerConf.java`
#### Snippet
```java
    @Deprecated
    // RealtimeSegmentRelocator has been rebranded as SegmentRelocator
    public static final String DEPRECATED_REALTIME_SEGMENT_RELOCATION_INITIAL_DELAY_IN_SECONDS =
        "controller.realtimeSegmentRelocation.initialDelayInSeconds";
    public static final String SEGMENT_RELOCATOR_INITIAL_DELAY_IN_SECONDS =
```

### DeprecatedIsStillUsed
Deprecated member 'DEPRECATED_SEGMENT_RELOCATOR_FREQUENCY_IN_SECONDS' is still used
in `pinot-controller/src/main/java/org/apache/pinot/controller/ControllerConf.java`
#### Snippet
```java
    // Deprecated as of 0.8.0
    @Deprecated
    public static final String DEPRECATED_SEGMENT_RELOCATOR_FREQUENCY_IN_SECONDS =
        "controller.segment.relocator.frequencyInSeconds";
    public static final String SEGMENT_RELOCATOR_FREQUENCY_PERIOD = "controller.segment.relocator.frequencyPeriod";
```

### DeprecatedIsStillUsed
Deprecated member 'DEPRECATED_REALTIME_SEGMENT_VALIDATION_FREQUENCY_IN_SECONDS' is still used
in `pinot-controller/src/main/java/org/apache/pinot/controller/ControllerConf.java`
#### Snippet
```java
    // Deprecated as of 0.8.0
    @Deprecated
    public static final String DEPRECATED_REALTIME_SEGMENT_VALIDATION_FREQUENCY_IN_SECONDS =
        "controller.realtime.segment.validation.frequencyInSeconds";
    public static final String REALTIME_SEGMENT_VALIDATION_FREQUENCY_PERIOD =
```

### DeprecatedIsStillUsed
Deprecated member 'MINION_INSTANCES_CLEANUP_TASK_FREQUENCY_PERIOD' is still used
in `pinot-controller/src/main/java/org/apache/pinot/controller/ControllerConf.java`
#### Snippet
```java
        "controller.minion.instances.cleanup.task.frequencyInSeconds";
    @Deprecated
    public static final String MINION_INSTANCES_CLEANUP_TASK_FREQUENCY_PERIOD =
        "controller.minion.instances.cleanup.task.frequencyPeriod";
    @Deprecated
```

### DeprecatedIsStillUsed
Deprecated member 'MINION_INSTANCES_CLEANUP_TASK_MIN_OFFLINE_TIME_BEFORE_DELETION_PERIOD' is still used
in `pinot-controller/src/main/java/org/apache/pinot/controller/ControllerConf.java`
#### Snippet
```java
        "controller.minion.instances.cleanup.task.minOfflineTimeBeforeDeletionSeconds";
    @Deprecated
    public static final String MINION_INSTANCES_CLEANUP_TASK_MIN_OFFLINE_TIME_BEFORE_DELETION_PERIOD =
        "controller.minion.instances.cleanup.task.minOfflineTimeBeforeDeletionPeriod";

```

### DeprecatedIsStillUsed
Deprecated member 'DEPRECATED_BROKER_RESOURCE_VALIDATION_FREQUENCY_IN_SECONDS' is still used
in `pinot-controller/src/main/java/org/apache/pinot/controller/ControllerConf.java`
#### Snippet
```java
    // Deprecated as of 0.8.0
    @Deprecated
    public static final String DEPRECATED_BROKER_RESOURCE_VALIDATION_FREQUENCY_IN_SECONDS =
        "controller.broker.resource.validation.frequencyInSeconds";
    public static final String BROKER_RESOURCE_VALIDATION_FREQUENCY_PERIOD =
```

### DeprecatedIsStillUsed
Deprecated member 'getMinionInstancesCleanupTaskMinOfflineTimeBeforeDeletionInSeconds' is still used
in `pinot-controller/src/main/java/org/apache/pinot/controller/ControllerConf.java`
#### Snippet
```java

  @Deprecated
  public int getMinionInstancesCleanupTaskMinOfflineTimeBeforeDeletionInSeconds() {
    return Optional.ofNullable(
        getProperty(ControllerPeriodicTasksConf.MINION_INSTANCES_CLEANUP_TASK_MIN_OFFLINE_TIME_BEFORE_DELETION_PERIOD))
```

### DeprecatedIsStillUsed
Deprecated member 'DEPRECATED_STATUS_CHECKER_WAIT_FOR_PUSH_TIME_IN_SECONDS' is still used
in `pinot-controller/src/main/java/org/apache/pinot/controller/ControllerConf.java`
#### Snippet
```java
    // Deprecated as of 0.8.0
    @Deprecated
    public static final String DEPRECATED_STATUS_CHECKER_WAIT_FOR_PUSH_TIME_IN_SECONDS =
        "controller.statuschecker.waitForPushTimeInSeconds";
    public static final String STATUS_CHECKER_WAIT_FOR_PUSH_TIME_PERIOD =
```

### DeprecatedIsStillUsed
Deprecated member 'DEPRECATED_TASK_MANAGER_FREQUENCY_IN_SECONDS' is still used
in `pinot-controller/src/main/java/org/apache/pinot/controller/ControllerConf.java`
#### Snippet
```java
    // Deprecated as of 0.8.0
    @Deprecated
    public static final String DEPRECATED_TASK_MANAGER_FREQUENCY_IN_SECONDS = "controller.task.frequencyInSeconds";
    public static final String TASK_MANAGER_FREQUENCY_PERIOD = "controller.task.frequencyPeriod";
    public static final String TASK_MANAGER_SKIP_LATE_CRON_SCHEDULE = "controller.task.skipLateCronSchedule";
```

### DeprecatedIsStillUsed
Deprecated member 'getMinionInstancesCleanupTaskInitialDelaySeconds' is still used
in `pinot-controller/src/main/java/org/apache/pinot/controller/ControllerConf.java`
#### Snippet
```java

  @Deprecated
  public long getMinionInstancesCleanupTaskInitialDelaySeconds() {
    return getProperty(ControllerPeriodicTasksConf.MINION_INSTANCES_CLEANUP_TASK_INITIAL_DELAY_SECONDS,
        ControllerPeriodicTasksConf.getRandomInitialDelayInSeconds());
```

### DeprecatedIsStillUsed
Deprecated member 'DEPRECATED_STATUS_CHECKER_FREQUENCY_IN_SECONDS' is still used
in `pinot-controller/src/main/java/org/apache/pinot/controller/ControllerConf.java`
#### Snippet
```java
    // Deprecated as of 0.8.0
    @Deprecated
    public static final String DEPRECATED_STATUS_CHECKER_FREQUENCY_IN_SECONDS =
        "controller.statuschecker.frequencyInSeconds";
    public static final String STATUS_CHECKER_FREQUENCY_PERIOD = "controller.statuschecker.frequencyPeriod";
```

### DeprecatedIsStillUsed
Deprecated member 'DEPRECATED_OFFLINE_SEGMENT_INTERVAL_CHECKER_FREQUENCY_IN_SECONDS' is still used
in `pinot-controller/src/main/java/org/apache/pinot/controller/ControllerConf.java`
#### Snippet
```java
    // Deprecated as of 0.8.0
    @Deprecated
    public static final String DEPRECATED_OFFLINE_SEGMENT_INTERVAL_CHECKER_FREQUENCY_IN_SECONDS =
        "controller.offline.segment.interval.checker.frequencyInSeconds";
    public static final String OFFLINE_SEGMENT_INTERVAL_CHECKER_FREQUENCY_PERIOD =
```

### DeprecatedIsStillUsed
Deprecated member 'DEPRECATED_TASK_METRICS_EMITTER_FREQUENCY_IN_SECONDS' is still used
in `pinot-controller/src/main/java/org/apache/pinot/controller/ControllerConf.java`
#### Snippet
```java
    // Deprecated as of 0.8.0
    @Deprecated
    public static final String DEPRECATED_TASK_METRICS_EMITTER_FREQUENCY_IN_SECONDS =
        "controller.minion.task.metrics.emitter.frequencyInSeconds";
    public static final String TASK_METRICS_EMITTER_FREQUENCY_PERIOD =
```

### DeprecatedIsStillUsed
Deprecated member 'getMinionInstancesCleanupTaskFrequencyInSeconds' is still used
in `pinot-controller/src/main/java/org/apache/pinot/controller/ControllerConf.java`
#### Snippet
```java

  @Deprecated
  public int getMinionInstancesCleanupTaskFrequencyInSeconds() {
    return Optional.ofNullable(getProperty(ControllerPeriodicTasksConf.MINION_INSTANCES_CLEANUP_TASK_FREQUENCY_PERIOD))
        .map(period -> (int) convertPeriodToSeconds(period)).orElseGet(
```

### DeprecatedIsStillUsed
Deprecated member 'DEPRECATED_RETENTION_MANAGER_FREQUENCY_IN_SECONDS' is still used
in `pinot-controller/src/main/java/org/apache/pinot/controller/ControllerConf.java`
#### Snippet
```java
    // Deprecated as of 0.8.0
    @Deprecated
    public static final String DEPRECATED_RETENTION_MANAGER_FREQUENCY_IN_SECONDS =
        "controller.retention.frequencyInSeconds";
    public static final String RETENTION_MANAGER_FREQUENCY_PERIOD = "controller.retention.frequencyPeriod";
```

### DeprecatedIsStillUsed
Deprecated member 'DEPRECATED_MINION_INSTANCES_CLEANUP_TASK_FREQUENCY_IN_SECONDS' is still used
in `pinot-controller/src/main/java/org/apache/pinot/controller/ControllerConf.java`
#### Snippet
```java
    // Deprecated as of 0.8.0
    @Deprecated
    public static final String DEPRECATED_MINION_INSTANCES_CLEANUP_TASK_FREQUENCY_IN_SECONDS =
        "controller.minion.instances.cleanup.task.frequencyInSeconds";
    @Deprecated
```

### DeprecatedIsStillUsed
Deprecated member '_partitionToOffsetMap' is still used
in `pinot-controller/src/main/java/org/apache/pinot/controller/util/ConsumingSegmentInfoReader.java`
#### Snippet
```java
    @Deprecated
    @JsonProperty("partitionToOffsetMap")
    public Map<String, String> _partitionToOffsetMap;
    @JsonProperty("partitionOffsetInfo")
    public PartitionOffsetInfo _partitionOffsetInfo;
```

### DeprecatedIsStillUsed
Deprecated member '_rawTableName' is still used
in `pinot-segment-spi/src/main/java/org/apache/pinot/segment/spi/index/metadata/SegmentMetadataImpl.java`
#### Snippet
```java

  @Deprecated
  private String _rawTableName;

  /**
```

### DeprecatedIsStillUsed
Deprecated member 'DEPRECATED_USE_LOCAL_DIRECTORY_SEQUENCE_ID' is still used
in `pinot-plugins/pinot-batch-ingestion/pinot-batch-ingestion-common/src/main/java/org/apache/pinot/plugin/ingestion/batch/common/SegmentGenerationTaskRunner.java`
#### Snippet
```java
  // Assign sequence ids to input files based at each local directory level
  @Deprecated
  public static final String DEPRECATED_USE_LOCAL_DIRECTORY_SEQUENCE_ID = "local.directory.sequence.id";
  public static final String USE_GLOBAL_DIRECTORY_SEQUENCE_ID = "use.global.directory.sequence.id";
  public static final String APPEND_UUID_TO_SEGMENT_NAME = "append.uuid.to.segment.name";
```

### DeprecatedIsStillUsed
Deprecated member 'shouldUseVarLengthDictionary' is still used
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/creator/impl/SegmentIndexCreationDriverImpl.java`
#### Snippet
```java
   */
  @Deprecated
  public static boolean shouldUseVarLengthDictionary(String columnName, Set<String> varLengthDictColumns,
      DataType columnStoredType, ColumnStatistics columnProfile) {
    return DictionaryIndexType.shouldUseVarLengthDictionary(
```

### DeprecatedIsStillUsed
Deprecated member 'getMaxTime' is still used
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/indexsegment/mutable/MutableSegmentImpl.java`
#### Snippet
```java
   */
  @Deprecated
  public long getMaxTime() {
    Long maxTime = IngestionUtils.extractTimeValue(_indexContainerMap.get(_timeColumnName)._maxValue);
    if (maxTime != null) {
```

### DeprecatedIsStillUsed
Deprecated member 'getMinTime' is still used
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/indexsegment/mutable/MutableSegmentImpl.java`
#### Snippet
```java
   */
  @Deprecated
  public long getMinTime() {
    Long minTime = IngestionUtils.extractTimeValue(_indexContainerMap.get(_timeColumnName)._minValue);
    if (minTime != null) {
```

## RuleId[id=SwitchStatementWithTooFewBranches]
### SwitchStatementWithTooFewBranches
'switch' statement has too few case labels (1), and should probably be replaced with an 'if' statement
in `pinot-query-planner/src/main/java/org/apache/pinot/query/type/TypeSystem.java`
#### Snippet
```java
    assert SqlTypeUtil.isNumeric(argumentType);

    switch (argumentType.getSqlTypeName()) {
      case DECIMAL: {
        // For BIG_DECIMAL, set the return type to BIG_DECIMAL. Check OSS issue #10318 for more details.
```

### SwitchStatementWithTooFewBranches
'switch' statement has too few case labels (1), and should probably be replaced with an 'if' statement
in `pinot-common/src/main/java/org/apache/pinot/common/function/scalar/StringFunctions.java`
#### Snippet
```java

    // TODO: Support more flags like MULTILINE, COMMENTS, etc.
    switch (flag) {
      case "i":
        patternFlag = Pattern.CASE_INSENSITIVE;
```

### SwitchStatementWithTooFewBranches
'switch' statement has too few case labels (1), and should probably be replaced with an 'if' statement
in `pinot-tools/src/main/java/org/apache/pinot/tools/QuickStartBase.java`
#### Snippet
```java
  protected static void publishStreamDataToKafka(String tableName, File dataDir)
      throws Exception {
    switch (tableName) {
      case "githubEvents":
        publishGithubEventsToKafka("githubEvents", new File(dataDir, "/rawdata/2021-07-21-few-hours.json"));
```

### SwitchStatementWithTooFewBranches
'switch' statement has too few case labels (1), and should probably be replaced with an 'if' statement
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ImportDataCommand.java`
#### Snippet
```java
    Map<String, String> fsConfigs = new HashMap<>();
    fsConfigs.putAll(IngestionConfigUtils.getConfigMapWithPrefix(additionalConfigs, String.format("fs.%s.", scheme)));
    switch (scheme) {
      case "s3":
        fsConfigs.putIfAbsent("region", System.getProperty("AWS_REGION", "us-west-2"));
```

### SwitchStatementWithTooFewBranches
'switch' statement has too few case labels (1), and should probably be replaced with an 'if' statement
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ImportDataCommand.java`
#### Snippet
```java
      return fsClassName;
    }
    switch (scheme) {
      case "s3":
        return "org.apache.pinot.plugin.filesystem.S3PinotFS";
```

### SwitchStatementWithTooFewBranches
'switch' statement has too few case labels (1), and should probably be replaced with an 'if' statement
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StreamAvroIntoKafkaCommand.java`
#### Snippet
```java
      for (GenericRecord genericRecord : reader) {
        byte[] bytes;
        switch (_outputFormat) {
          case "avro":
            ByteArrayOutputStream outputStream = new ByteArrayOutputStream();
```

### SwitchStatementWithTooFewBranches
'switch' statement has too few case labels (1), and should probably be replaced with an 'if' statement
in `pinot-broker/src/main/java/org/apache/pinot/broker/requesthandler/BaseBrokerRequestHandler.java`
#### Snippet
```java
    }
    Function function = expression.getFunctionCall();
    switch (function.getOperator()) {
      case "datetrunc":
        String granularString = function.getOperands().get(0).getLiteral().getStringValue().toUpperCase();
```

### SwitchStatementWithTooFewBranches
'switch' statement has too few case labels (1), and should probably be replaced with an 'if' statement
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/FST.java`
#### Snippet
```java
    FSTHeader header = FSTHeader.read(stream);

    switch (header._version) {
      case ImmutableFST.VERSION:
        return new ImmutableFST(stream, hasOutputSymbols, memoryManager);
```

### SwitchStatementWithTooFewBranches
'switch' statement has too few case labels (1), and should probably be replaced with an 'if' statement
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/TableConfigUtils.java`
#### Snippet
```java
      if (indexingConfigs != null) {
        List<String> noDictionaryColumns = indexingConfigs.getNoDictionaryColumns();
        switch (fieldConfig.getEncodingType()) {
          case DICTIONARY:
            if (noDictionaryColumns != null) {
```

## RuleId[id=RedundantCollectionOperation]
### RedundantCollectionOperation
Unnecessary 'containsKey()' check
in `pinot-plugins/pinot-stream-ingestion/pinot-kafka-2.0/src/main/java/org/apache/pinot/plugin/stream/kafka20/server/KafkaDataProducer.java`
#### Snippet
```java
      props.put("value.serializer", "org.apache.kafka.common.serialization.ByteArraySerializer");
    }
    if (props.containsKey("partitioner.class")) {
      props.remove("partitioner.class");
    }
```

### RedundantCollectionOperation
Unnecessary 'Arrays.asList()' call
in `pinot-perf/src/main/java/org/apache/pinot/perf/DictionaryDumper.java`
#### Snippet
```java
      ImmutableSegment immutableSegment = ImmutableSegmentLoader.load(indexDir, ReadMode.heap);
      Dictionary colDictionary = immutableSegment.getDictionary(args[1]);
      List<String> strIdList = Arrays.asList(args[2].split(","));

      for (String strId : strIdList) {
```

## RuleId[id=CatchMayIgnoreException]
### CatchMayIgnoreException
Empty `catch` block
in `pinot-clients/pinot-jdbc-client/src/main/java/org/apache/pinot/client/PinotConnection.java`
#### Snippet
```java
            return numVal;
        }
      } catch (NumberFormatException e) {
      }

```

### CatchMayIgnoreException
Empty `catch` block
in `pinot-clients/pinot-jdbc-client/src/main/java/org/apache/pinot/client/PinotConnection.java`
#### Snippet
```java
              return numVal;
          }
      } catch (NumberFormatException e) {
      }

```

## RuleId[id=MismatchedJavadocCode]
### MismatchedJavadocCode
Method is specified to return list but the return type is set
in `pinot-core/src/main/java/org/apache/pinot/core/transport/InstanceRequestHandler.java`
#### Snippet
```java

  /**
   * @return list of ids of the queries currently running on the server.
   */
  public Set<String> getRunningQueryIds() {
```

### MismatchedJavadocCode
Method is specified to return list but the return type is map
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/data/manager/TableDataManager.java`
#### Snippet
```java
   * and cached.
   *
   * @return List of {@link SegmentErrorInfo}
   */
  Map<String, SegmentErrorInfo> getSegmentErrors();
```

### MismatchedJavadocCode
Method is specified to return 'null' but its return type is primitive
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/FST.java`
#### Snippet
```java
   * Get output symbol for the given arc
   * @param arc Arc for which the output symbol is requested
   * @return Output symbol, null if not present
   */
  public abstract int getOutputSymbol(int arc);
```

### MismatchedJavadocCode
Method is specified to return list but the return type is set
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/creator/impl/stats/AbstractColumnStatisticsCollector.java`
#### Snippet
```java
   * Returns the partitions within which the column values exist.
   *
   * @return List of ranges for the column values.
   */
  @Nullable
```

## RuleId[id=CollectionAddAllCanBeReplacedWithConstructor]
### CollectionAddAllCanBeReplacedWithConstructor
'putAll()' call can be replaced with parametrized constructor call
in `pinot-spi/src/main/java/org/apache/pinot/spi/utils/IngestionConfigUtils.java`
#### Snippet
```java
  public static Map<String, Object> getPropsWithPrefix(Map<String, String> batchConfigMap, String prefix) {
    Map<String, Object> props = new HashMap<>();
    props.putAll(getConfigMapWithPrefix(batchConfigMap, prefix));
    return props;
  }
```

### CollectionAddAllCanBeReplacedWithConstructor
'putAll()' call can be replaced with parametrized constructor call
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ImportDataCommand.java`
#### Snippet
```java
  private Map<String, String> getPinotFSConfigs(String scheme, Map<String, String> additionalConfigs) {
    Map<String, String> fsConfigs = new HashMap<>();
    fsConfigs.putAll(IngestionConfigUtils.getConfigMapWithPrefix(additionalConfigs, String.format("fs.%s.", scheme)));
    switch (scheme) {
      case "s3":
```

## RuleId[id=UnnecessaryToStringCall]
### UnnecessaryToStringCall
Unnecessary `toString()` call
in `pinot-plugins/pinot-stream-ingestion/pinot-kafka-2.0/src/main/java/org/apache/pinot/plugin/stream/kafka20/server/KafkaDataServerStartable.java`
#### Snippet
```java
    final Map<String, Object> config = new HashMap<>();
    config.put(AdminClientConfig.BOOTSTRAP_SERVERS_CONFIG, "localhost:" + _port);
    config.put(AdminClientConfig.CLIENT_ID_CONFIG, "Kafka2AdminClient-" + UUID.randomUUID().toString());
    config.put(AdminClientConfig.REQUEST_TIMEOUT_MS_CONFIG, 15000);
    _adminClient = KafkaAdminClient.create(config);
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `pinot-common/src/main/java/org/apache/pinot/common/utils/http/HttpClient.java`
#### Snippet
```java
      reason = JsonUtils.stringToObject(entityStr, SimpleHttpErrorInfo.class).getError();
    } catch (Exception e) {
      reason = String.format("Failed to get a reason, exception: %s", e.toString());
    }
    String errorMessage = String.format("Got error status code: %d (%s) with reason: \"%s\" while sending request: %s",
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `pinot-core/src/main/java/org/apache/pinot/core/data/manager/realtime/PinotFSSegmentUploader.java`
#### Snippet
```java
    Callable<URI> uploadTask = () -> {
      URI destUri = new URI(StringUtil.join(File.separator, _segmentStoreUriStr, segmentName.getTableName(),
          segmentName.getSegmentName() + UUID.randomUUID().toString()));
      try {
        PinotFS pinotFS = PinotFSFactory.create(new URI(_segmentStoreUriStr).getScheme());
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `pinot-core/src/main/java/org/apache/pinot/core/operator/filter/TextContainsFilterOperator.java`
#### Snippet
```java
    StringBuilder stringBuilder = new StringBuilder(EXPLAIN_NAME).append("(indexLookUp:text_index");
    stringBuilder.append(",operator:").append(_predicate.getType());
    stringBuilder.append(",predicate:").append(_predicate.toString());
    return stringBuilder.append(')').toString();
  }
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `pinot-core/src/main/java/org/apache/pinot/core/operator/filter/TextMatchFilterOperator.java`
#### Snippet
```java
    StringBuilder stringBuilder = new StringBuilder(EXPLAIN_NAME).append("(indexLookUp:text_index");
    stringBuilder.append(",operator:").append(_predicate.getType());
    stringBuilder.append(",predicate:").append(_predicate.toString());
    return stringBuilder.append(')').toString();
  }
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `pinot-core/src/main/java/org/apache/pinot/core/operator/filter/BitmapBasedFilterOperator.java`
#### Snippet
```java
    if (predicate != null) {
      stringBuilder.append(",operator:").append(predicate.getType());
      stringBuilder.append(",predicate:").append(predicate.toString());
    }
    return stringBuilder.append(')').toString();
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `pinot-core/src/main/java/org/apache/pinot/core/operator/filter/JsonMatchFilterOperator.java`
#### Snippet
```java
    StringBuilder stringBuilder = new StringBuilder(EXPLAIN_NAME).append("(indexLookUp:json_index");
    stringBuilder.append(",operator:").append(_predicate.getType());
    stringBuilder.append(",predicate:").append(_predicate.toString());
    return stringBuilder.append(')').toString();
  }
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `pinot-core/src/main/java/org/apache/pinot/core/operator/filter/H3InclusionIndexFilterOperator.java`
#### Snippet
```java
    StringBuilder stringBuilder = new StringBuilder(EXPLAIN_NAME).append("(inclusionIndex:h3_index");
    stringBuilder.append(",operator:").append(_predicate.getType());
    stringBuilder.append(",predicate:").append(_predicate.toString());
    return stringBuilder.append(')').toString();
  }
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `pinot-core/src/main/java/org/apache/pinot/core/operator/filter/H3IndexFilterOperator.java`
#### Snippet
```java
    StringBuilder stringBuilder = new StringBuilder(EXPLAIN_NAME).append("(indexLookUp:h3_index");
    stringBuilder.append(",operator:").append(_predicate.getType());
    stringBuilder.append(",predicate:").append(_predicate.toString());
    return stringBuilder.append(')').toString();
  }
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `pinot-core/src/main/java/org/apache/pinot/core/transport/server/routing/stats/ServerRoutingStatsManager.java`
#### Snippet
```java
      stringBuilder.append(";").append(server).append("=").append(numInFlightRequests.toString()).append(",")
          .append(numInFlightRequestsEMA.toString()).append(",").append(latencyEMA.toString()).append(",")
          .append(score.toString());
    }

```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/resources/PinotControllerPeriodicTaskRestletResource.java`
#### Snippet
```java
        throw new WebApplicationException(
            "More than one table matches Table '" + tableName + "'. Matching names: " + matchingTableNamesWithType
                .toString());
      }

```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `pinot-controller/src/main/java/org/apache/pinot/controller/util/TableIngestionStatusHelper.java`
#### Snippet
```java
    if (!failedTasks.isEmpty()) {
      ingestionState = TableStatus.IngestionState.UNHEALTHY;
      errorMessage = "Follow ingestion tasks have failed: " + failedTasks.toString();
    }
    return new TableStatus.IngestionStatus(ingestionState.toString(), errorMessage);
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `pinot-controller/src/main/java/org/apache/pinot/controller/util/SegmentCompletionUtils.java`
#### Snippet
```java

  public static String generateSegmentFileName(String segmentNameStr) {
    return getSegmentNamePrefix(segmentNameStr) + UUID.randomUUID().toString();
  }
}
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `pinot-compatibility-verifier/src/main/java/org/apache/pinot/compat/StreamOp.java`
#### Snippet
```java
      config.put(AdminClientConfig.BOOTSTRAP_SERVERS_CONFIG,
          ClusterDescriptor.getInstance().getDefaultHost() + ":" + ClusterDescriptor.getInstance().getKafkaPort());
      config.put(AdminClientConfig.CLIENT_ID_CONFIG, "Kafka2AdminClient-" + UUID.randomUUID().toString());
      config.put(AdminClientConfig.REQUEST_TIMEOUT_MS_CONFIG, 15000);
      AdminClient adminClient = KafkaAdminClient.create(config);
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/DeleteTableCommand.java`
#### Snippet
```java

    if (!_exec) {
      LOGGER.warn("Dry Running Command: " + toString());
      LOGGER.warn("Use the -exec option to actually execute the command.");
      return true;
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/DeleteTableCommand.java`
#### Snippet
```java
    }

    LOGGER.info("Executing command: " + toString());
    try (FileUploadDownloadClient fileUploadDownloadClient = new FileUploadDownloadClient()) {
      fileUploadDownloadClient.getHttpClient().sendDeleteRequest(FileUploadDownloadClient
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartControllerCommand.java`
#### Snippet
```java
      throws Exception {
    try {
      LOGGER.info("Executing command: " + toString());
      Map<String, Object> controllerConf = getControllerConf();
      StartServiceManagerCommand startServiceManagerCommand =
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AddTableCommand.java`
#### Snippet
```java
      throws Exception {
    if (!_exec) {
      LOGGER.warn("Dry Running Command: " + toString());
      LOGGER.warn("Use the -exec option to actually execute the command.");
      return true;
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AddTableCommand.java`
#### Snippet
```java
    _controllerAddress = _controllerProtocol + "://" + _controllerHost + ":" + _controllerPort;

    LOGGER.info("Executing command: " + toString());

    String rawTableName = null;
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/DeleteSchemaCommand.java`
#### Snippet
```java

    if (!_exec) {
      LOGGER.warn("Dry Running Command: " + toString());
      LOGGER.warn("Use the -exec option to actually execute the command.");
      return true;
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/DeleteSchemaCommand.java`
#### Snippet
```java
    }

    LOGGER.info("Executing command: " + toString());
    try (FileUploadDownloadClient fileUploadDownloadClient = new FileUploadDownloadClient()) {
      fileUploadDownloadClient.getHttpClient().sendDeleteRequest(
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartServiceManagerCommand.java`
#### Snippet
```java
      throws Exception {
    try {
      LOGGER.info("Executing command: " + toString());
      if (!startPinotService("SERVICE_MANAGER", this::startServiceManager)) {
        return false;
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/OfflineSegmentIntervalCheckerCommand.java`
#### Snippet
```java
  public boolean execute()
      throws Exception {
    LOGGER.info("Executing command: " + toString());

    ZKHelixAdmin helixAdmin = new ZKHelixAdmin.Builder().setZkAddress(_zkAddress).build();
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartMinionCommand.java`
#### Snippet
```java
      throws Exception {
    try {
      LOGGER.info("Executing command: " + toString());
      Map<String, Object> minionConf = getMinionConf();
      StartServiceManagerCommand startServiceManagerCommand =
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/RealtimeProvisioningHelperCommand.java`
#### Snippet
```java

  private void displayOutputHeader(StringBuilder note) {
    System.out.println("\n============================================================\n" + toString());
    System.out.println(note.toString());
  }
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AnonymizeDataCommand.java`
#### Snippet
```java
                + "generating queries");

    System.out.println(usage.toString());
  }
}
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AnonymizeDataCommand.java`
#### Snippet
```java
        sb.append(column).append(" ");
      }
      System.out.println(sb.toString());
      // if the user has asked for extracting filter columns from a query file, then
      // we should simply return after doing that since the tool will be run subsequently
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartZookeeperCommand.java`
#### Snippet
```java
  public boolean execute()
      throws IOException {
    LOGGER.info("Executing command: " + toString());

    IDefaultNameSpace defaultNameSpace = new IDefaultNameSpace() {
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartBrokerCommand.java`
#### Snippet
```java
      throws Exception {
    try {
      LOGGER.info("Executing command: " + toString());
      Map<String, Object> brokerConf = getBrokerConf();
      StartServiceManagerCommand startServiceManagerCommand =
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AddSchemaCommand.java`
#### Snippet
```java

    if (!_exec) {
      LOGGER.warn("Dry Running Command: " + toString());
      LOGGER.warn("Use the -exec option to actually execute the command.");
      return true;
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AddSchemaCommand.java`
#### Snippet
```java

    File schemaFile = new File(_schemaFile);
    LOGGER.info("Executing command: " + toString());
    if (!schemaFile.exists()) {
      throw new FileNotFoundException("file does not exist, + " + _schemaFile);
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/OperateClusterConfigCommand.java`
#### Snippet
```java
      _controllerHost = NetUtils.getHostAddress();
    }
    LOGGER.info("Executing command: " + toString());
    if (StringUtils.isEmpty(_config) && !_operation.equalsIgnoreCase("GET")) {
      throw new UnsupportedOperationException("Empty config: " + _config);
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/GenerateDataCommand.java`
#### Snippet
```java
  public boolean execute()
      throws Exception {
    LOGGER.info("Executing command: " + toString());

    if ((_numRecords < 0) || (_numFiles < 0)) {
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AddTenantCommand.java`
#### Snippet
```java

    if (!_exec) {
      LOGGER.warn("Dry Running Command: " + toString());
      LOGGER.warn("Use the -exec option to actually execute the command.");
      return true;
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/AddTenantCommand.java`
#### Snippet
```java
    }

    LOGGER.info("Executing command: " + toString());
    Tenant tenant = new Tenant(_role, _name, _instanceCount, _offlineInstanceCount, _realtimeInstanceCount);
    String res = AbstractBaseAdminCommand
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/DeleteClusterCommand.java`
#### Snippet
```java
    String helixClusterName = "/" + _clusterName;

    LOGGER.info("Executing command: " + toString());
    if (!zkClient.exists(helixClusterName)) {
      LOGGER.error("Cluster {} does not exist.", _clusterName);
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StartServerCommand.java`
#### Snippet
```java
      throws Exception {
    try {
      LOGGER.info("Executing command: " + toString());
      Map<String, Object> serverConf = getServerConf();
      StartServiceManagerCommand startServiceManagerCommand =
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/StopProcessCommand.java`
#### Snippet
```java
  public boolean execute()
      throws Exception {
    LOGGER.info("Executing command: " + toString());

    Map<String, String> processes = new HashMap<String, String>();
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/index/loader/ForwardIndexHandler.java`
#### Snippet
```java
        break;
      default:
        throw new IllegalStateException("Unsupported storedType=" + storedType.toString() + " for column=" + column);
    }

```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/store/FilePerIndexDirectory.java`
#### Snippet
```java

    File filename = getFileFor(key._name, key._type);
    PinotDataBuffer buffer = mapForWrites(filename, sizeBytes, key._type.toString() + ".writer");
    _indexBuffers.put(key, buffer);
    return buffer;
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/store/FilePerIndexDirectory.java`
#### Snippet
```java

    Preconditions.checkArgument(segmentDirectory.exists(),
        "SegmentDirectory: " + segmentDirectory.toString() + " does not exist");
    Preconditions.checkArgument(segmentDirectory.isDirectory(),
        "SegmentDirectory: " + segmentDirectory.toString() + " is not a directory");
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/store/FilePerIndexDirectory.java`
#### Snippet
```java
        "SegmentDirectory: " + segmentDirectory.toString() + " does not exist");
    Preconditions.checkArgument(segmentDirectory.isDirectory(),
        "SegmentDirectory: " + segmentDirectory.toString() + " is not a directory");

    _segmentDirectory = segmentDirectory;
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/store/SingleFileIndexDirectory.java`
#### Snippet
```java

    Preconditions.checkArgument(segmentDirectory.exists(),
        "SegmentDirectory: " + segmentDirectory.toString() + " does not exist");
    Preconditions.checkArgument(segmentDirectory.isDirectory(),
        "SegmentDirectory: " + segmentDirectory.toString() + " is not a directory");
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/store/SingleFileIndexDirectory.java`
#### Snippet
```java
        "SegmentDirectory: " + segmentDirectory.toString() + " does not exist");
    Preconditions.checkArgument(segmentDirectory.isDirectory(),
        "SegmentDirectory: " + segmentDirectory.toString() + " is not a directory");

    _segmentDirectory = segmentDirectory;
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/store/SingleFileIndexDirectory.java`
#### Snippet
```java
      } else {
        throw new ConfigurationException(
            "Invalid map file key: " + key + ", segmentDirectory: " + _segmentDirectory.toString());
      }
    }
```

### UnnecessaryToStringCall
Unnecessary `toString()` call
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/startree/OffHeapStarTree.java`
#### Snippet
```java
        .add("aggregatedDocId", node.getAggregatedDocId()).add("numChildren", node.getNumChildren()).toString();
    stringBuilder.append(formattedOutput);
    System.out.println(stringBuilder.toString());

    if (!node.isLeaf()) {
```

## RuleId[id=InnerClassMayBeStatic]
### InnerClassMayBeStatic
Inner class `TokenLockManager` may be 'static'
in `pinot-core/src/main/java/org/apache/pinot/core/query/scheduler/tokenbucket/TokenSchedulerGroup.java`
#### Snippet
```java
  }

  private class TokenLockManager implements AutoCloseable {
    private final Lock _lock;

```

### InnerClassMayBeStatic
Inner class `QueryAccountingRunnable` may be 'static'
in `pinot-core/src/main/java/org/apache/pinot/core/query/scheduler/resources/BoundedAccountingExecutor.java`
#### Snippet
```java
  }

  private class QueryAccountingRunnable implements Runnable {
    private final Runnable _runnable;
    private final Semaphore _semaphore;
```

### InnerClassMayBeStatic
Inner class `CorsFilter` may be 'static'
in `pinot-controller/src/main/java/org/apache/pinot/controller/api/ControllerAdminApiApplication.java`
#### Snippet
```java
  }

  private class CorsFilter implements ContainerResponseFilter {
    @Override
    public void filter(ContainerRequestContext containerRequestContext,
```

### InnerClassMayBeStatic
Inner class `ControllerInfo` may be 'static'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ShowClusterInfoCommand.java`
#### Snippet
```java
  }

  class ControllerInfo {
    @JsonProperty("leaderName")
    public String _leaderName;
```

### InnerClassMayBeStatic
Inner class `SegmentInfo` may be 'static'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ShowClusterInfoCommand.java`
#### Snippet
```java
  }

  class SegmentInfo {
    @JsonProperty("name")
    public String _name;
```

### InnerClassMayBeStatic
Inner class `BrokerInfo` may be 'static'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ShowClusterInfoCommand.java`
#### Snippet
```java
  }

  class BrokerInfo {
    @JsonProperty("name")
    public String _name;
```

### InnerClassMayBeStatic
Inner class `ServerInfo` may be 'static'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/ShowClusterInfoCommand.java`
#### Snippet
```java
  }

  class ServerInfo {
    @JsonProperty("name")
    public String _name;
```

### InnerClassMayBeStatic
Inner class `SourceSegments` may be 'static'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/MoveReplicaGroup.java`
#### Snippet
```java
  }

  class SourceSegments {
    SourceSegments(String segment, int replicas) {
      _segment = segment;
```

### InnerClassMayBeStatic
Inner class `ServerInstance` may be 'static'
in `pinot-tools/src/main/java/org/apache/pinot/tools/admin/command/MoveReplicaGroup.java`
#### Snippet
```java
  }

  class ServerInstance {
    ServerInstance(String server, int segments) {
      _server = server;
```

### InnerClassMayBeStatic
Inner class `Node` may be 'static'
in `pinot-broker/src/main/java/org/apache/pinot/broker/routing/segmentpruner/interval/IntervalTree.java`
#### Snippet
```java
  }

  private class Node<VALUE> implements Comparable<Node> {
    private final Interval _interval;
    private final List<VALUE> _values;
```

### InnerClassMayBeStatic
Inner class `Path` may be 'static'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/utils/RealTimeRegexpMatcher.java`
#### Snippet
```java
   * Represents a path in the FST traversal directed by the automaton
   */
  public final class Path {
    public final State _state;
    public final MutableState _node;
```

### InnerClassMayBeStatic
Inner class `SegmentLock` may be 'static'
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/segment/store/SegmentLocalFSDirectory.java`
#### Snippet
```java
   * We want to prevent that.
   */
  class SegmentLock implements AutoCloseable {
    int _readers = 0;
    int _writers = 0;
```

## RuleId[id=SuspiciousMethodCalls]
### SuspiciousMethodCalls
'Map\>\>' may not contain keys of type 'QueryServerInstance'
in `pinot-query-planner/src/main/java/org/apache/pinot/query/planner/ExplainPlanStageVisitor.java`
#### Snippet
```java
            .get(node.getStageId())
            .getWorkerIdToSegmentsMap()
            .get(context._host))
        .append('\n');
  }
```

### SuspiciousMethodCalls
Suspicious call to 'Map.get()'
in `pinot-core/src/main/java/org/apache/pinot/core/query/reduce/GapfillProcessor.java`
#### Snippet
```java
        return GapfillUtils.getDefaultValue(dataType);
      } else if (fillType == GapfillUtils.FillType.FILL_PREVIOUS_VALUE) {
        Object[] row = _previousByGroupKey.get(key);
        if (row != null) {
          return row[columnIndex];
```

## RuleId[id=ConditionCoveredByFurtherCondition]
### ConditionCoveredByFurtherCondition
Condition 'e != null' covered by subsequent condition 'e instanceof SerializationException'
in `pinot-plugins/pinot-input-format/pinot-confluent-avro/src/main/java/org/apache/pinot/plugin/inputformat/avro/confluent/KafkaConfluentSchemaRegistryAvroMessageDecoder.java`
#### Snippet
```java

  private boolean isUnknownMagicByte(Throwable e) {
    return e != null && e instanceof SerializationException && e.getMessage() != null && e.getMessage().toLowerCase()
        .contains("unknown magic byte");
  }
```

### ConditionCoveredByFurtherCondition
Condition 'function instanceof TableMacro' covered by subsequent condition 'function instanceof TableFunction'
in `pinot-query-planner/src/main/java/org/apache/calcite/prepare/PinotCalciteCatalogReader.java`
#### Snippet
```java
    } else if (category.isTableFunction()) {
      predicate = function ->
          function instanceof TableMacro
              || function instanceof TableFunction;
    } else {
```

### ConditionCoveredByFurtherCondition
Condition 'function instanceof TableMacro' covered by subsequent condition 'function instanceof TableFunction'
in `pinot-query-planner/src/main/java/org/apache/calcite/prepare/PinotCalciteCatalogReader.java`
#### Snippet
```java
    } else {
      predicate = function ->
          !(function instanceof TableMacro
              || function instanceof TableFunction);
    }
```

### ConditionCoveredByFurtherCondition
Condition 'zoneId.equals(...)' covered by subsequent condition 'zoneId.equals(...)'
in `pinot-common/src/main/java/org/apache/pinot/common/function/TimeZoneKey.java`
#### Snippet
```java

  private static boolean isUtcEquivalentName(String zoneId) {
    return zoneId.equals("utc") || zoneId.equals("z") || zoneId.equals("ut") || zoneId.equals("uct") || zoneId
        .equals("ut") || zoneId.equals("gmt") || zoneId.equals("gmt0") || zoneId.equals("greenwich") || zoneId
        .equals("universal") || zoneId.equals("zulu");
```

### ConditionCoveredByFurtherCondition
Condition 'e != null' covered by subsequent condition 'e instanceof SerializationException'
in `pinot-plugins/pinot-input-format/pinot-protobuf/src/main/java/org/apache/pinot/plugin/inputformat/protobuf/KafkaConfluentSchemaRegistryProtoBufMessageDecoder.java`
#### Snippet
```java

  private boolean isUnknownMagicByte(Throwable e) {
    return e != null && e instanceof SerializationException && e.getMessage() != null && e.getMessage().toLowerCase()
        .contains("unknown magic byte");
  }
```

### ConditionCoveredByFurtherCondition
Condition 'iOException instanceof InterruptedIOException' covered by subsequent condition 'iOException instanceof UnknownHostException'
in `pinot-plugins/pinot-environment/pinot-azure/src/main/java/org/apache/pinot/plugin/provider/AzureEnvironmentProvider.java`
#### Snippet
```java
    final HttpRequestRetryHandler httpRequestRetryHandler =
        (iOException, executionCount, httpContext) -> !(executionCount >= _maxRetry
            || iOException instanceof InterruptedIOException || iOException instanceof UnknownHostException
            || iOException instanceof SSLException || HttpClientContext.adapt(httpContext)
            .getRequest() instanceof HttpEntityEnclosingRequest);
```

## RuleId[id=UnnecessaryContinue]
### UnnecessaryContinue
`continue` is unnecessary as the last statement in a loop
in `pinot-plugins/pinot-minion-tasks/pinot-minion-builtin-tasks/src/main/java/org/apache/pinot/plugin/minion/tasks/segmentgenerationandpush/SegmentGenerationAndPushTaskGenerator.java`
#### Snippet
```java
        } catch (Exception e) {
          LOGGER.error("Failed to construct inputFileURI for path: {}, parent directory URI: {}", file, inputDirURI, e);
          continue;
        }
      }
```

### UnnecessaryContinue
`continue` is unnecessary as the last statement in a loop
in `pinot-controller/src/main/java/org/apache/pinot/controller/util/TableIngestionStatusHelper.java`
#### Snippet
```java
          break;
        default:
          continue;
      }
    }
```

### UnnecessaryContinue
`continue` is unnecessary as the last statement in a loop
in `pinot-tools/src/main/java/org/apache/pinot/tools/BootstrapTableTool.java`
#### Snippet
```java
      } catch (Exception e) {
        LOGGER.error("Failed to query task endpoint", e);
        continue;
      }
    }
```

### UnnecessaryContinue
`continue` is unnecessary as the last statement in a loop
in `pinot-plugins/pinot-file-system/pinot-s3/src/main/java/org/apache/pinot/plugin/filesystem/S3PinotFS.java`
#### Snippet
```java
    for (S3Object s3Object : listObjectsV2Response.contents()) {
      if (s3Object.key().equals(prefix)) {
        continue;
      } else {
        isEmpty = false;
```

### UnnecessaryContinue
`continue` is unnecessary as the last statement in a loop
in `pinot-plugins/pinot-file-system/pinot-gcs/src/main/java/org/apache/pinot/plugin/filesystem/GcsPinotFS.java`
#### Snippet
```java
    for (Blob blob : page.iterateAll()) {
      if (blob.getName().equals(prefix)) {
        continue;
      } else {
        isEmpty = false;
```

## RuleId[id=CopyConstructorMissesField]
### CopyConstructorMissesField
Copy constructor does not copy field '_reason'
in `pinot-common/src/main/java/org/apache/pinot/common/protocols/SegmentCompletionProtocol.java`
#### Snippet
```java
      }

      public Params(Params params) {
        _offset = params.getOffset();
        _segmentName = params.getSegmentName();
```

### CopyConstructorMissesField
Copy constructor does not copy 7 fields
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/customobject/QuantileDigest.java`
#### Snippet
```java
  }

  public QuantileDigest(QuantileDigest quantileDigest) {
    this(quantileDigest.getMaxError(), quantileDigest.getAlpha());
    merge(quantileDigest);
```

## RuleId[id=ThrowableNotThrown]
### ThrowableNotThrown
Runtime exception instance `new RuntimeException()` is not thrown
in `pinot-core/src/main/java/org/apache/pinot/core/geospatial/transform/function/StPolygonFunction.java`
#### Snippet
```java
        _results[i] = GeometrySerializer.serialize(geometry);
      } catch (ParseException e) {
        new RuntimeException(String.format("Failed to parse geometry from string: %s", argumentValues[i]));
      }
    }
```

### ThrowableNotThrown
Checked exception instance `ExecutionException` is not thrown
in `pinot-clients/pinot-jdbc-client/src/main/java/org/apache/pinot/client/controller/response/TableResponse.java`
#### Snippet
```java
        return tableResponse;
      } catch (IOException e) {
        new ExecutionException(e);
      }

```

### ThrowableNotThrown
Checked exception instance `ExecutionException` is not thrown
in `pinot-clients/pinot-jdbc-client/src/main/java/org/apache/pinot/client/controller/response/SchemaResponse.java`
#### Snippet
```java
        return SchemaResponse.fromJson(jsonResponse);
      } catch (IOException e) {
        new ExecutionException(e);
      }

```

### ThrowableNotThrown
Checked exception instance `ExecutionException` is not thrown
in `pinot-clients/pinot-jdbc-client/src/main/java/org/apache/pinot/client/controller/response/ControllerTenantBrokerResponse.java`
#### Snippet
```java
        return tableResponse;
      } catch (IOException e) {
        new ExecutionException(e);
      }

```

## RuleId[id=EqualsWhichDoesntCheckParameterClass]
### EqualsWhichDoesntCheckParameterClass
`equals()` should check the class of its parameter
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/OffsetCriteria.java`
#### Snippet
```java

  @Override
  public boolean equals(Object o) {
    if (EqualityUtils.isSameReference(this, o)) {
      return true;
```

### EqualsWhichDoesntCheckParameterClass
`equals()` should check the class of its parameter
in `pinot-spi/src/main/java/org/apache/pinot/spi/stream/StreamConfig.java`
#### Snippet
```java

  @Override
  public boolean equals(Object o) {
    if (EqualityUtils.isSameReference(this, o)) {
      return true;
```

### EqualsWhichDoesntCheckParameterClass
`equals()` should check the class of its parameter
in `pinot-plugins/pinot-stream-ingestion/pinot-kafka-2.0/src/main/java/org/apache/pinot/plugin/stream/kafka20/KafkaPartitionLevelStreamConfig.java`
#### Snippet
```java

  @Override
  public boolean equals(Object o) {
    if (EqualityUtils.isSameReference(this, o)) {
      return true;
```

### EqualsWhichDoesntCheckParameterClass
`equals()` should check the class of its parameter
in `pinot-plugins/pinot-stream-ingestion/pinot-kafka-2.0/src/main/java/org/apache/pinot/plugin/stream/kafka20/KafkaStreamLevelStreamConfig.java`
#### Snippet
```java

  @Override
  public boolean equals(Object o) {
    if (EqualityUtils.isSameReference(this, o)) {
      return true;
```

### EqualsWhichDoesntCheckParameterClass
`equals()` should check the class of its parameter
in `pinot-common/src/main/java/org/apache/pinot/common/metadata/instance/InstanceZKMetadata.java`
#### Snippet
```java

  @Override
  public boolean equals(Object instanceMetadata) {
    if (isSameReference(this, instanceMetadata)) {
      return true;
```

### EqualsWhichDoesntCheckParameterClass
`equals()` should check the class of its parameter
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/automaton/StringUnionOperations.java`
#### Snippet
```java
     */
    @Override
    public boolean equals(Object obj) {
      final StateWithTransitionLabels other = (StateWithTransitionLabels) obj;
      return _isFinal == other._isFinal && Arrays.equals(_labels, other._labels) && referenceEquals(
```

### EqualsWhichDoesntCheckParameterClass
`equals()` should check the class of its parameter
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/mutablefst/MutableFSTImpl.java`
#### Snippet
```java

  @Override
  public boolean equals(Object o) {
    return MutableFSTUtils.fstEquals(this, o);
  }
```

### EqualsWhichDoesntCheckParameterClass
`equals()` should check the class of its parameter
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/mutablefst/MutableState.java`
#### Snippet
```java

  @Override
  public boolean equals(Object o) {
    return MutableFSTUtils.stateEquals(this, o);
  }
```

### EqualsWhichDoesntCheckParameterClass
`equals()` should check the class of its parameter
in `pinot-segment-local/src/main/java/org/apache/pinot/segment/local/utils/nativefst/mutablefst/MutableArc.java`
#### Snippet
```java

  @Override
  public boolean equals(Object obj) {
    return MutableFSTUtils.arcEquals(this, obj);
  }
```

## RuleId[id=BigDecimalMethodWithoutRoundingCalled]
### BigDecimalMethodWithoutRoundingCalled
'BigDecimal.setScale()' called without a rounding mode argument
in `pinot-clients/pinot-jdbc-client/src/main/java/org/apache/pinot/client/PinotResultSet.java`
#### Snippet
```java
    try {
      String value = getString(columnIndex);
      return value == null ? null : new BigDecimal(value).setScale(scale);
    } catch (Exception e) {
      throw new SQLException("Unable to fetch BigDecimal value", e);
```

## RuleId[id=CastCanBeRemovedNarrowingVariableType]
### CastCanBeRemovedNarrowingVariableType
Cast may be removed by changing the type of 'rows' to 'List'
in `pinot-core/src/main/java/org/apache/pinot/core/operator/combine/MinMaxValueBasedSelectionOrderByCombineOperator.java`
#### Snippet
```java
          // Results from LinearSelectionOrderByOperator
          assert rows instanceof List;
          segmentBoundaryValue = (Comparable) ((List<Object[]>) rows).get(rows.size() - 1)[0];
        }

```

